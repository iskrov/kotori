{"version":3,"file":"static/js/main.e3512a04.js","mappings":"+SA6MaA,EAAS,KApLnBC,EAAAA,EAAAA,UAVD,SAAAC,KAAcC,EAAAA,EAAAA,SAAA,KAAAD,GAAA,KALNE,SAAmB,EAMzBC,KAAKC,MAAwB,QAAhBC,EAAAA,QAASC,GACtBH,KAAKI,aAAeJ,KAAKC,MAAQ,GAAQI,EAAWC,kBAAiB,QACrEN,KAAKO,YAAcP,KAAKC,MAAQ,GAAQD,KAAKI,aAAY,UACzDJ,KAAKQ,OAAQC,EACbT,KAAKU,cAAe,EACpBV,KAAKW,mBAAqB,IAAIC,IAAI,CAChC,iCAEFZ,KAAKa,kBACP,GAAC,EAAAC,IAAA,mBAAAC,MAAA,eAAAC,GAAAC,EAAAA,EAAAA,UAED,YACE,IAAIjB,KAAKC,OAAUD,KAAKQ,MAAxB,CAIA,GAAIR,KAAKC,OAASD,KAAKQ,MAGrB,OAFAU,QAAQC,IAAI,mDACZnB,KAAKoB,wBAIP,WACwBf,EAAWgB,aAAarB,KAAKI,eACtCkB,eACLjB,EAAWkB,mBAAmBvB,KAAKI,aAAc,CAAEoB,eAAe,YAInDnB,EAAWgB,aAAarB,KAAKO,cACtCe,eACNjB,EAAWoB,mBAAmBzB,KAAKO,YAAa,wBAIxD,IAAMmB,QAAmBrB,EAAWgB,aAAarB,KAAKO,aAClDmB,EAAWJ,QAAUI,EAAWC,KAAO,gBACnCtB,EAAWoB,mBAAmBzB,KAAKO,YAAa,yBAE1D,CAAE,MAAOqB,GACPV,QAAQU,MAAM,+BAAgCA,EAChD,CA3BA,CA4BF,IA/B8B,OA+B7B,WA/B6B,OAAAZ,EAAAa,MAAC,KAADC,UAAA,EAF7B,IAE6B,CAAAhB,IAAA,wBAAAC,MAiC9B,WAAiC,IAADgB,EAAA,KAC9B,GAAK/B,KAAKC,OAAUD,KAAKQ,MAAzB,CAGA,IAAMwB,EAAed,QAAQe,KAC7Bf,QAAQe,KAAO,WAAqB,IAAD,IAAAC,EAAAJ,UAAAK,OAAhBC,EAAI,IAAAC,MAAAH,GAAAI,EAAA,EAAAA,EAAAJ,EAAAI,IAAJF,EAAIE,GAAAR,UAAAQ,GACrB,IAAMC,EAAUH,EAAKI,KAAK,KAG1B,IAAK,IAAMC,KAAqBV,EAAKpB,mBACnC,GAAI4B,EAAQG,SAASD,GACnB,OAKJT,EAAaH,MAAMX,QAASkB,EAC9B,CAhBsC,CAiBxC,GAAC,CAAAtB,IAAA,eAAAC,MAED,WACE,OAAO,IAAI4B,MAAOC,aACpB,GAAC,CAAA9B,IAAA,cAAAC,MAAA,eAAA8B,GAAA5B,EAAAA,EAAAA,UAED,UAA0B6B,EAAiBP,EAAiBQ,GAC1D,GAAK/C,KAAKD,UAAWC,KAAKC,MAE1B,IACE,IAAI+C,EAAchD,KAAKiD,eAAc,KAAKH,EAAMI,cAAa,KAAKX,EAC9DQ,IACFC,GAAQ,IAAQG,KAAKC,UAAUL,EAAM,KAAM,IAE7CC,GAAY,WAEN3C,EAAWoB,mBAAmBzB,KAAKO,YAAayC,EAAU,CAC9DK,SAAUhD,EAAAA,aAAwBiD,MAEtC,CAAE,MAAO1B,GACHA,aAAiB2B,OAAiC,gBAAvB3B,EAAc4B,MAA0BxD,KAAKC,MAC1EiB,QAAQe,KAAK,+DAEbf,QAAQU,MAAM,+BAAgCA,EAElD,CACF,IApByB,OAoBxB,SApBwB6B,EAAAC,EAAAC,GAAA,OAAAd,EAAAhB,MAAC,KAADC,UAAA,EAFxB,IAEwB,CAAAhB,IAAA,YAAAC,MAsBzB,SAAkB+B,GAChB,QAAK9C,KAAKD,UACI,UAAV+C,GAA+B,SAAVA,KACX,UAAVA,IAAsB9C,KAAKU,iBAC1BV,KAAKQ,OACHR,KAAKU,cACd,GAAC,CAAAI,IAAA,wBAAAC,MAED,SAA8BwB,GAC5B,IAAK,IAAME,KAAqBzC,KAAKW,mBACnC,GAAI4B,EAAQG,SAASD,GACnB,OAAO,EAGX,OAAO,CACT,GAAC,CAAA3B,IAAA,QAAAC,MAED,SAAawB,EAAiBQ,GACvB/C,KAAK4D,UAAU,gBACPC,IAATd,EACF7B,QAAQ4C,MAAMvB,EAASQ,GAEvB7B,QAAQ4C,MAAMvB,GAEhBvC,KAAK+D,YAAY,QAASxB,EAASQ,GACrC,GAAC,CAAAjC,IAAA,OAAAC,MAED,SAAYwB,EAAiBQ,GACtB/C,KAAK4D,UAAU,eACPC,IAATd,EACF7B,QAAQ8C,KAAKzB,EAASQ,GAEtB7B,QAAQ8C,KAAKzB,GAEfvC,KAAK+D,YAAY,OAAQxB,EAASQ,GACpC,GAAC,CAAAjC,IAAA,OAAAC,MAED,SAAYwB,EAAiBQ,GAEvB/C,KAAKiE,sBAAsB1B,UAIlBsB,IAATd,EACF7B,QAAQe,KAAKM,EAASQ,GAEtB7B,QAAQe,KAAKM,GAEfvC,KAAK+D,YAAY,OAAQxB,EAASQ,GACpC,GAAC,CAAAjC,IAAA,QAAAC,MAED,SAAawB,EAAiBQ,QACfc,IAATd,EACF7B,QAAQU,MAAMW,EAASQ,GAEvB7B,QAAQU,MAAMW,GAEhBvC,KAAK+D,YAAY,QAASxB,EAASQ,EACrC,GAAC,CAAAjC,IAAA,UAAAC,MAAA,eAAAmD,GAAAjD,EAAAA,EAAAA,UAED,YACE,GAAIjB,KAAKC,MACP,MAAO,sDAGT,IACE,aAAaI,EAAW8D,kBAAkBnE,KAAKO,YACjD,CAAE,MAAOqB,GAEP,OADAV,QAAQU,MAAM,2BAA4BA,GACpC,uBAAwBA,CAChC,CACF,IAXoB,OAWnB,WAXmB,OAAAsC,EAAArC,MAAC,KAADC,UAAA,EAFnB,IAEmB,CAAAhB,IAAA,SAAAC,MAapB,WACEf,KAAKD,SAAU,CACjB,GAAC,CAAAe,IAAA,UAAAC,MAED,WACEf,KAAKD,SAAU,CACjB,GAAC,CAAAe,IAAA,cAAAC,MAED,WACEf,KAAKU,cAAe,CACtB,GAAC,CAAAI,IAAA,eAAAC,MAED,WACEf,KAAKU,cAAe,CACtB,GAAC,CAAAI,IAAA,uBAAAC,MAED,SAA4BqD,GAC1BpE,KAAKW,mBAAmB0D,IAAID,EAC9B,GAAC,CAAAtD,IAAA,0BAAAC,MAED,SAA+BqD,GAC7BpE,KAAKW,mBAAmB2D,OAAOF,EACjC,MAKF,U,2kBCvMA,IAAMG,EAAY,WAAe,IAADC,EAAAC,EACxBC,EAA6B,qBAAXC,QAA0BA,OAAOC,SAASF,SAGlE,OAAIA,GAA0B,kBAAbA,GAA6C,cAAbA,GAAyC,kBAAbA,EAKzEA,GAAYA,EAAShC,SAAS,WACzB,yBAImB,OAArB8B,EAACK,EAAAA,QAAUC,aAAiB,OAAPL,EAApBD,EAAsBO,YAAF,EAApBN,EAA6BO,SAAiC,wBAT7D,uBAUX,EAuBMC,EAAgBV,IACtBrD,QAAQC,IAAI,sDAAuD8D,GAG5D,IAAMC,EAAMC,EAAAA,QAAMC,OAAO,CAC9BC,iBAAiB,EACjBC,QAAS,CACP,eAAgB,oBAElBC,QAAS,MAIX,GAAsB,qBAAXZ,OAAwB,CACjC,IAAMD,EAAWC,OAAOC,SAASF,SAChB,kBAAbA,GAA6C,cAAbA,GAAyC,kBAAbA,GAAgCA,EAAShC,SAAS,YAChHwC,EAAIM,SAASC,QAAU,wBACvBvE,QAAQC,IAAI,gCAAiC+D,EAAIM,SAASC,WAE1DP,EAAIM,SAASC,QAAUR,EACvB/D,QAAQC,IAAI,iCAAkC+D,EAAIM,SAASC,SAE/D,MACEP,EAAIM,SAASC,QAAUR,EAKzBC,EAAIQ,aAAaC,QAAQC,KAAI,SAACC,GAE1B3E,QAAQC,IAAI,2CAA4C,CACtDsE,QAASI,EAAOJ,QAChBK,IAAKD,EAAOC,IACZC,QAASF,EAAOJ,QAAO,GAAMI,EAAOJ,QAAUI,EAAOC,IAAQD,EAAOC,MAItE,IAAMpB,EAA6B,qBAAXC,QAA0BA,OAAOC,SAASF,SAC9DA,IAA0B,kBAAbA,GAA6C,cAAbA,GAAyC,kBAAbA,GAAgCA,EAAShC,SAAS,cAE7HmD,EAAOJ,QAAU,wBACjBvE,QAAQC,IAAI,oEAIV0E,EAAOJ,SAAWI,EAAOJ,QAAQ/C,SAAS,mBAC5CmD,EAAOJ,QAAUI,EAAOJ,QAAQO,QAAQ,UAAW,aAE3B,kBAAfH,EAAOC,KAAoBD,EAAOC,IAAIpD,SAAS,0BACxDmD,EAAOC,IAAMD,EAAOC,IAAIE,QAAQ,UAAW,aAI7C,IAAMC,EAAiBJ,EAAOJ,QAAO,GAAMI,EAAOJ,QAAUI,EAAOC,IAAQD,EAAOC,IAgBlF,OAfIG,GAAkBA,EAAeC,WAAW,0BAC9ChF,QAAQC,IAAI,oEACZ0E,EAAOJ,QAAU,wBAEbI,EAAOC,KAAOD,EAAOC,IAAIpD,SAAS,mBACpCmD,EAAOC,IAAMD,EAAOC,IAAIE,QAAQ,qBAAsB,MAI1D9E,QAAQC,IAAI,0CAA2C,CACrDsE,QAASI,EAAOJ,QAChBK,IAAKD,EAAOC,IACZC,QAASF,EAAOJ,QAAO,GAAMI,EAAOJ,QAAUI,EAAOC,IAAQD,EAAOC,MAG/DD,CACT,IACA,SAACjE,GACC,OAAOuE,QAAQC,OAAOxE,EACxB,IAIFsD,EAAIQ,aAAaC,QAAQC,IAAI,WAAD,IAAAS,GAAApF,EAAAA,EAAAA,UAC1B,UAAO4E,GACL,IAEE,IAGWS,EAGJC,EANDC,QAAcC,EAAAA,QAAaC,QAAQ,gBAGzC,GAAIF,EACFX,EAAOP,QAAQqB,cAAa,UAAaH,EACzC7G,EAAOmE,MAAM,iBAA6B,OAA9BwC,EAAiBT,EAAOe,aAAM,EAAbN,EAAepD,eAAa,IAAI2C,EAAOC,UAEpEnG,EAAOmE,MAAM,iCAA6C,OAA9CyC,EAAiCV,EAAOe,aAAM,EAAbL,EAAerD,eAAa,IAAI2C,EAAOC,KAUtF,OALID,EAAO9C,gBAAgB8D,kBAClBhB,EAAOP,QAAQ,gBACtB3F,EAAOmE,MAAM,uDAAuD+B,EAAOC,MAGtED,CACT,CAAE,MAAOjE,GAEP,OADAjC,EAAOiC,MAAM,wBAAyBA,GAC/BiE,CACT,CACF,IAAC,gBAAApC,GAAA,OAAA4C,EAAAxE,MAAA,KAAAC,UAAA,EA1B0B,IA2B3B,SAACF,GAEC,OADAjC,EAAOiC,MAAM,oBAAqBA,GAC3BuE,QAAQC,OAAOxE,EACxB,IAIFsD,EAAIQ,aAAaoB,SAASlB,KACxB,SAACkB,GAAc,IAADC,EAEZ,OADApH,EAAOmE,MAAM,iBAAiBgD,EAASE,OAAM,KAA0B,OAA1BD,EAAID,EAASjB,OAAOe,aAAM,EAAtBG,EAAwB7D,eAAa,IAAI4D,EAASjB,OAAOC,KACnGgB,CACT,GAAE,WAAD,IAAAG,GAAAhG,EAAAA,EAAAA,UACD,UAAOW,GAAW,IAADsF,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EACTC,EAAkBnG,EAAMiE,OAG9B,GAAIjE,EAAMW,UACNX,EAAMW,QAAQG,SAAS,kBACvBd,EAAMW,QAAQG,SAAS,SACvBd,EAAMW,QAAQG,SAAS,2BAMzB,OALA/C,EAAOiC,MAAM,wBAAyB,CACpCW,QAASX,EAAMW,QACfuD,IAAoB,MAAfiC,OAAe,EAAfA,EAAiBjC,IACtBc,OAAuB,MAAfmB,OAAe,EAAfA,EAAiBnB,SAEpBT,QAAQC,OAAO,CACpB7D,QAAS,2FACTyE,OAAQ,EACRgB,cAAepG,EAAMW,UAKzB,IAAKX,EAAMkF,SAKT,OAJAnH,EAAOiC,MAAM,gBAAiB,CAC5BkE,IAAoB,MAAfiC,OAAe,EAAfA,EAAiBjC,IACtBc,OAAuB,MAAfmB,OAAe,EAAfA,EAAiBnB,SAEpBT,QAAQC,OAAO,CACpB7D,QAAS,6DACTyE,OAAQ,IAYZ,GARArH,EAAOiC,MAAM,qBAAsB,CACjCoF,OAAsB,OAAhBE,EAAEtF,EAAMkF,eAAQ,EAAdI,EAAgBF,OACxBlB,IAAKiC,EAAgBjC,IACrBc,OAAQmB,EAAgBnB,OACxB7D,KAAoB,OAAhBoE,EAAEvF,EAAMkF,eAAQ,EAAdK,EAAgBpE,OAIO,OAAb,OAAdqE,EAAAxF,EAAMkF,eAAQ,EAAdM,EAAgBJ,UAAmBe,EAAgBE,OAAQ,CAC7DF,EAAgBE,QAAS,EACzBtI,EAAOqE,KAAK,sCAAsC+D,EAAgBjC,IAAG,mCAErE,IAEE,IAAMoC,QAAqBzB,EAAAA,QAAaC,QAAQ,iBAC1CyB,QAAoB1B,EAAAA,QAAaC,QAAQ,gBAE/C,IAAKwB,GAAgBC,EAInB,OAFAxI,EAAOsC,KAAK,2FACNmG,IACCjC,QAAQC,OAAO,CACpB7D,QAAS,uCACTyE,OAAQ,MAIZ,IAAKkB,EAIH,OAFAvI,EAAOsC,KAAK,sDACNmG,IACCjC,QAAQC,OAAO,CACpB7D,QAAS,yDACTyE,OAAQ,MAKZrH,EAAOqE,KAAK,4BACZrE,EAAOqE,KAAK,qDAAoDkE,EAAeA,EAAaG,UAAU,EAAG,IAAM,MAAQ,SACvH,IAAMvB,QAAiB3B,EAAAA,QAAMmD,KAAQ/D,IAAW,uBAAwB,CACtEgE,cAAeL,IAGjB,GAAIpB,EAAS/D,KAAKyF,aAAc,CAC9B7I,EAAOqE,KAAK,8DAENyC,EAAAA,QAAagC,QAAQ,eAAgB3B,EAAS/D,KAAKyF,cAErD1B,EAAS/D,KAAKwF,sBACV9B,EAAAA,QAAagC,QAAQ,gBAAiB3B,EAAS/D,KAAKwF,eAC1D5I,EAAOqE,KAAK,gDAId,IAAM0E,EAAiB5B,EAAS/D,KAAKyF,aACrCtD,EAAIM,SAASF,QAAQqD,OAAsB,cAAC,UAAaD,EACzD/I,EAAOqE,KAAK,gCAAgC+D,EAAgBjC,IAAG,oBAG/D,IAAM8C,EAAWC,EAAAA,EAAA,GACZd,GAAe,IAClBzC,QAAOuD,EAAAA,EAAA,GACFd,EAAgBzC,SAAO,IAC1BqB,cAAc,UAAW+B,MAK7B,OAAOvD,EAAAA,EAAAA,SAAMyD,EACf,CACF,CAAE,MAAOE,GAAoB,IAADC,EAAAC,EAQ1B,OANArJ,EAAOiC,MAAM,uBAAwB,CACnCW,QAASuG,EAAavG,QACtByE,OAA6B,OAAvB+B,EAAED,EAAahC,eAAQ,EAArBiC,EAAuB/B,OAC/BjE,KAA2B,OAAvBiG,EAAEF,EAAahC,eAAQ,EAArBkC,EAAuBjG,aAEzBqF,IACCjC,QAAQC,OAAO,CACpB7D,QAAS,6DACTyE,OAAQ,IACRgB,cAAec,EAAavG,SAEhC,CACF,CAGA,GAA+B,OAAb,OAAd8E,EAAAzF,EAAMkF,eAAQ,EAAdO,EAAgBL,QAAgB,CAClC,IAAMiC,EAAerH,EAAMkF,SAAS/D,KAEpC,GAAIkG,EAAaC,QAAU7G,MAAM8G,QAAQF,EAAaC,QAKpD,OAJAvJ,EAAOsC,KAAK,mBAAoB,CAC9BiH,OAAQD,EAAaC,OACrBpD,IAAKiC,EAAgBjC,MAEhBK,QAAQC,OAAO,CACpB7D,QAAS0G,EAAaG,QAAU,mBAChCF,OAAQD,EAAaC,OACrBlC,OAAQ,KAGd,CAGA,GAA+B,OAAb,OAAdM,EAAA1F,EAAMkF,eAAQ,EAAdQ,EAAgBN,SACF,OADgBO,EAC9B3F,EAAMkF,WAAc,OAANU,EAAdD,EAAgBxE,OAAhByE,EAAsB4B,QACgB,kBAA/BxH,EAAMkF,SAAS/D,KAAKqG,QAC3BxH,EAAMkF,SAAS/D,KAAKqG,OAAO1G,SAAS,wBAKtC,OAJA/C,EAAOiC,MAAM,4BAA6B,CACxCwH,OAAQxH,EAAMkF,SAAS/D,KAAKqG,OAC5BtD,IAAKiC,EAAgBjC,MAEhBK,QAAQC,OAAO,CACpB7D,QAAS,qDACTyF,cAAepG,EAAMkF,SAAS/D,KAAKqG,OACnCpC,OAAQ,MAKZ,IAAMqC,GAA6B,OAAd5B,EAAA7F,EAAMkF,WAAc,OAANY,EAAdD,EAAgB1E,WAAF,EAAd2E,EAAsB0B,UAAwB,OAAlBzB,EAAI/F,EAAMkF,WAAc,OAANc,EAAdD,EAAgB5E,WAAF,EAAd6E,EAAsBrF,UAAW,uCAMtF,OALA5C,EAAOiC,MAAM,YAAa,CACxBW,QAAS8G,EACTvD,IAAKiC,EAAgBjC,IACrBkB,OAAsB,OAAhBa,EAAEjG,EAAMkF,eAAQ,EAAde,EAAgBb,SAEnBb,QAAQC,OAAO,CACpB7D,QAAS8G,EACTrC,OAAsB,OAAhBc,EAAElG,EAAMkF,eAAQ,EAAdgB,EAAgBd,QAE5B,IAAC,gBAAAtD,GAAA,OAAAuD,EAAApF,MAAA,KAAAC,UAAA,EApKC,IAwKJ,IAAMsG,EAAM,eAAAkB,GAAArI,EAAAA,EAAAA,UAAG,YACb,IACEtB,EAAOqE,KAAK,+BAENyC,EAAAA,QAAa8C,WAAW,sBACxB9C,EAAAA,QAAa8C,WAAW,uBACxB9C,EAAAA,QAAa8C,WAAW,eAGvBrE,EAAIM,SAASF,QAAQqD,OAAOhC,aAIrC,CAAE,MAAO/E,GACPjC,EAAOiC,MAAM,eAAgBA,EAC/B,CACF,IAAC,kBAhBW,OAAA0H,EAAAzH,MAAA,KAAAC,UAAA,KAyEC0H,EAAa,CACxBC,WAAY,SAACC,GAAW,OACtBxE,EAAIyE,IAAI,oBAAqB,CAAED,OAAAA,GAAS,EAE1CE,SAAU,SAACC,GAAU,OACnB3E,EAAIyE,IAAI,oBAAoBE,EAAK,EAGnCC,YAAa,SAAC/G,GAAwB,OACpCmC,EAAIoD,KAAK,oBAAqBvF,EAAK,EAGrCgH,qBAAsB,SAAChH,GAatB,OAAKmC,EAAIoD,KAAK,gBAAiB,CAC9B0B,MAAOjH,EAAKiH,OAAS,GACrBC,QAAS,GACTC,kBAAmBnH,EAAKmH,kBACxBC,cAAepH,EAAKqH,GACpBC,gBAAiBtH,EAAKuH,KACtBC,cAAexH,EAAKwH,cACpBC,0BAA2B,IAC3BC,qBAAsB1H,EAAK2H,UAC3BC,mBAAoB5H,EAAK6H,OACzBC,WAAY9H,EAAK8H,aAAc,IAAIlI,MAAOC,cAC1CkI,UAAW/H,EAAK+H,UAChBC,KAAMhI,EAAKgI,MAAQ,GACnBC,cAAejI,EAAKiI,cACpBC,gBAAiBlI,EAAKkI,iBACtB,EAEFC,YAAa,SAACrB,EAAY9G,GAAwB,OAChDmC,EAAIiG,IAAI,oBAAoBtB,EAAM9G,EAAK,EAEzCqI,YAAa,SAACvB,GAAU,OACtB3E,EAAIZ,OAAO,oBAAoBuF,EAAK,EAEtCwB,cAAe,SAACC,GAAa,OAC3BpG,EAAIyE,IAAI,0BAA2B,CAAED,OAAQ,CAAE6B,EAAGD,IAAU,EAG9DE,sBAAuB,SAACC,EAAuB/B,GAA0C,OACvFxE,EAAIyE,IAAI,4BAA4B8B,EAAiB,CAAE/B,OAAAA,GAAS,GAIvDgC,EAAc,CACzBC,aAAc,SAACjC,GAA+D,OAC5ExE,EAAIyE,IAAI,iBAAkB,CAAED,OAAAA,GAAS,EAEvCkC,YAAa,SAAC/B,GAAU,OACtB3E,EAAIyE,IAAI,kBAAkBE,EAAK,EAEjCgC,eAAgB,SAAC9I,GAAiF,OAChGmC,EAAIoD,KAAK,iBAAkBvF,EAAK,EAElC+I,eAAgB,SAACjC,EAAY9G,GAAoF,OAC/GmC,EAAIiG,IAAI,kBAAkBtB,EAAM9G,EAAK,EAEvCgJ,eAAgB,SAAClC,GAAU,OACzB3E,EAAIZ,OAAO,kBAAkBuF,EAAK,GAIzBmC,EAAU,CACrBC,QAAS,WAAF,OAAQ/G,EAAIyE,IAAI,YAAY,EAEnCuC,cAAe,WAAF,IAAGC,EAAarK,UAAAK,OAAA,QAAA0B,IAAA/B,UAAA,GAAAA,UAAA,GAAG,EAAC,OAAKoD,EAAIyE,IAAI,mBAAoB,CAAED,OAAQ,CAAEyC,MAAAA,IAAU,EAExFC,gBAAiB,SAACC,GAAe,OAAKnH,EAAIyE,IAAI,aAAa0C,EAAO,WAAW,EAE7EC,UAAU,WAAD,IAAAC,GAAAtL,EAAAA,EAAAA,UAAE,UAAOuL,GAEhB,aADuBtH,EAAIoD,KAAK,YAAakE,IAC7BzJ,IAClB,IAHS,OAGR,SAHQY,GAAA,OAAA4I,EAAA1K,MAAA,KAAAC,UAAA,EAAC,GAKV2K,UAAU,WAAD,IAAAC,GAAAzL,EAAAA,EAAAA,UAAE,UAAO4I,EAAY8C,GAE5B,aADuBzH,EAAIiG,IAAI,aAAatB,EAAM8C,IAClC5J,IAClB,IAHS,OAGR,SAHQ6J,EAAAC,GAAA,OAAAH,EAAA7K,MAAA,KAAAC,UAAA,EAAC,GAKVgL,UAAU,WAAD,IAAAC,GAAA9L,EAAAA,EAAAA,UAAE,UAAO4I,GAChBlK,EAAOqE,KAAK,0CAA0C6F,GACtDlK,EAAOqE,KAAK,qCAAqC6F,GACjD,IAAM/C,QAAiB5B,EAAIZ,OAAO,aAAauF,GAE/C,OADAlK,EAAOqE,KAAK,4BAA6B8C,EAAS/D,MAC3C+D,EAAS/D,IAClB,IANS,OAMR,SANQiK,GAAA,OAAAD,EAAAlL,MAAA,KAAAC,UAAA,EAAC,IA+BZ,QAMY4J,E,cCrgBRuB,GAAc,EAAM,SAETC,IAAiB,OAAAC,EAAAtL,MAAC,KAADC,UAAA,UAAAqL,IAQ/B,OAR+BA,GAAAlM,EAAAA,EAAAA,UAAhC,YACOgM,IACCG,EAAAA,cACIA,EAAAA,OAERH,GAAc,EACdtN,EAAOqE,KAAK,8BAEhB,KAACnC,MAAA,KAAAC,UAAA,CA6CD,IAAMuL,EACiB,6BADjBA,EAEa,yBASNC,EAAiB,WAG5B,SAAAA,KAAsBxN,EAAAA,EAAAA,SAAA,KAAAwN,EAAC,CAAC,OAAA1N,EAAAA,EAAAA,SAAA0N,EAAA,EAAAxM,IAAA,oBAAAC,MAAA,eAAAwM,GAAAtM,EAAAA,EAAAA,UAexB,UAA+BuM,EAAkBC,GAI/C,UACQP,IACNvN,EAAOqE,KAAK,+BAAgC,CAAEyJ,eAAAA,IAG9C,IAAAC,EAAyDN,EAAAA,OAAcO,kBAAkB,CACvFH,SAAAA,IADMI,EAAuBF,EAAvBE,wBAAyBC,EAAmBH,EAAnBG,oBAIjC,IAAKD,IAA4BC,EAC/B,MAAM,IAAItK,MAAM,kDAkBlB,aAdMkD,EAAAA,QAAagC,QAAQ,6BACIgF,EAC7BtK,KAAKC,UAAU,CACbwK,wBAAAA,EACAJ,SAAAA,EACAC,eAAAA,KAIJ9N,EAAOqE,KAAK,2CAA4C,CACtD8J,0BAA2BD,EAAoB1L,OAC/C4L,8BAA+BH,EAAwBzL,SAGlD,CACL0L,oBAAAA,EACAD,wBAAAA,EAEJ,CAAE,MAAOhM,GAEP,MADAjC,EAAOiC,MAAM,mCAAoCA,GAC3C,IAAI2B,MAAM,sCAClB,CACF,IAxC8B,OAwC7B,SAxC6BE,EAAAC,GAAA,OAAA6J,EAAA1L,MAAC,KAADC,UAAA,EAfN,IAeM,CAAAhB,IAAA,qBAAAC,MAAA,eAAAiN,GAAA/M,EAAAA,EAAAA,UAgD9B,UACEwM,EACAQ,GAEA,UACQf,IACNvN,EAAOqE,KAAK,gCAAiC,CAAEyJ,eAAAA,IAG/C,IAAMS,QAAoBzH,EAAAA,QAAaC,QAAQ,6BAA6B+G,GAC5E,IAAKS,EACH,MAAM,IAAI3K,MAAM,gCAGlB,IAAA4K,EAA8ChL,KAAKiL,MAAMF,GAAjDN,EAAuBO,EAAvBP,wBAAyBJ,EAAQW,EAARX,SAGjC7N,EAAOqE,KAAK,sCAAuC,CACjDyJ,eAAAA,EACAM,8BAAsD,MAAvBH,OAAuB,EAAvBA,EAAyBzL,OACxDkM,2BAAgD,MAApBJ,OAAoB,EAApBA,EAAsB9L,OAClDmM,eAAwB,MAARd,OAAQ,EAARA,EAAUrL,SAI5B,IAAQoM,EAAuBnB,EAAAA,OAAcoB,mBAAmB,CAC9DZ,wBAAAA,EACAK,qBAAAA,EACAT,SAAAA,IAHMe,mBAMR,IAAKA,EACH,MAAM,IAAIhL,MAAM,iCAQlB,aAJMkD,EAAAA,QAAa8C,WAAW,6BAA6BkE,GAE3D9N,EAAOqE,KAAK,4CAA6C,CAAEyJ,eAAAA,IAEpDc,CACT,CAAE,MAAO3M,GAEP,MADAjC,EAAOiC,MAAM,uCAAwC,CAAE6L,eAAAA,EAAgB7L,MAAAA,IACjE,IAAI2B,MAAM,sCAAsC3B,EACxD,CACF,IA7C+B,OA6C9B,SA7C8B+B,EAAAiJ,GAAA,OAAAoB,EAAAnM,MAAC,KAADC,UAAA,EAhDD,IAgDC,CAAAhB,IAAA,aAAAC,MAAA,eAAA0N,GAAAxN,EAAAA,EAAAA,UAqD/B,UAAwBuM,EAAkBC,GAIxC,UACQP,IACNvN,EAAOqE,KAAK,wBAAyB,CAAEyJ,eAAAA,IAGvC,IAAMiB,EAAStB,EAAAA,OAAcuB,WAAW,CAAEnB,SAAAA,IAE1C,IAAKkB,IAAWA,EAAOE,mBAAqBF,EAAOG,kBACjD,MAAM,IAAItL,MAAM,2CAkBlB,aAdMkD,EAAAA,QAAagC,QAAQ,sBACHgF,EACtBtK,KAAKC,UAAU,CACbwL,iBAAkBF,EAAOE,iBACzBpB,SAAAA,EACAC,eAAAA,KAIJ9N,EAAOqE,KAAK,oCAAqC,CAC/C8K,wBAAyBJ,EAAOG,kBAAkB1M,OAClD4M,uBAAwBL,EAAOE,iBAAiBzM,SAG3C,CACL6M,aAAcN,EAAOG,kBACrBD,iBAAkBF,EAAOE,iBAE7B,CAAE,MAAOhN,GAEP,MADAjC,EAAOiC,MAAM,4BAA6BA,GACpC,IAAI2B,MAAM,+BAClB,CACF,IAtCuB,OAsCtB,SAtCsBsJ,EAAAG,GAAA,OAAAyB,EAAA5M,MAAC,KAADC,UAAA,EArDQ,IAqDR,CAAAhB,IAAA,cAAAC,MAAA,eAAAkO,GAAAhO,EAAAA,EAAAA,UA8CvB,UACEwM,EACAyB,GAEA,UACQhC,IACNvN,EAAOqE,KAAK,yBAA0B,CAAEyJ,eAAAA,IAGxC,IAAMS,QAAoBzH,EAAAA,QAAaC,QAAQ,sBAAsB+G,GACrE,IAAKS,EACH,MAAM,IAAI3K,MAAM,yBAGlB,IAAA4L,EAAuChM,KAAKiL,MAAMF,GAA1CU,EAAgBO,EAAhBP,iBAAkBpB,EAAQ2B,EAAR3B,SAG1B7N,EAAOqE,KAAK,+BAAgC,CAC1CyJ,eAAAA,EACAsB,uBAAwC,MAAhBH,OAAgB,EAAhBA,EAAkBzM,OAC1CiN,oBAAkC,MAAbF,OAAa,EAAbA,EAAe/M,OACpCmM,eAAwB,MAARd,OAAQ,EAARA,EAAUrL,SAI5B,IAAMkN,EAAcjC,EAAAA,OAAckC,YAAY,CAC5CV,iBAAAA,EACAM,cAAAA,EACA1B,SAAAA,IAUF,GAPA7N,EAAOqE,KAAK,4BAA6B,CACvCyJ,eAAAA,EACA8B,QAAyB,OAAhBF,EACTG,kBAAmBH,EACnBI,WAAYJ,EAAcK,OAAOC,KAAKN,GAAe,QAGlDA,EACH,MAAM,IAAI9L,MAAM,0BAGlB,IAAQqM,EAA8CP,EAA9CO,mBAAoBC,EAA0BR,EAA1BQ,WAAYC,EAAcT,EAAdS,UAOxC,aAJMrJ,EAAAA,QAAa8C,WAAW,sBAAsBkE,GAEpD9N,EAAOqE,KAAK,qCAAsC,CAAEyJ,eAAAA,IAE7C,CACLoC,WAAAA,EACAC,UAAAA,EACAF,mBAAAA,EAEJ,CAAE,MAAOhO,GAEP,MADAjC,EAAOiC,MAAM,gCAAiC,CAAE6L,eAAAA,EAAgB7L,MAAAA,IAC1D,IAAI2B,MAAM,+BAA+B3B,EACjD,CACF,IA1DwB,OA0DvB,SA1DuBmO,EAAAC,GAAA,OAAAf,EAAApN,MAAC,KAADC,UAAA,EA9CD,IA8CC,CAAAhB,IAAA,WAAAC,MAAA,eAAAkP,GAAAhP,EAAAA,EAAAA,UAkExB,UAAsBiP,EAAcC,EAAe3C,GACjD,IACE7N,EAAOqE,KAAK,oCAAqC,CAAEmM,MAAAA,IAGnD,IAAQtC,SAA8B7N,KAAK2N,kBAAkBH,EAAU2C,IAA/DtC,oBAGF/G,QAAiB5B,EAAIoD,KAAK,8BAA+B,CAC7DmF,eAAgB0C,EAChBC,4BAA6BvC,EAC7BqC,KAAAA,IAGoCjC,EAAyBnH,EAAS/D,KAAhEsN,6BAGF9B,QAA2BvO,KAAKwO,mBAAmB2B,EAAOlC,SAG1D/I,EAAIoD,KAAK,+BAAgC,CAC7CgI,WAAYxJ,EAAS/D,KAAKuN,WAC1B7C,eAAgB0C,EAChBI,2BAA4BhC,IAG9B5O,EAAOqE,KAAK,qCAAsC,CAChDmM,MAAAA,EACAK,yBAA0BjC,EAAmBpM,OAC7CsO,yBAA0BlC,EAAmBlG,UAAU,EAAG,IAAM,QAGlE1I,EAAOqE,KAAK,kDACd,CAAE,MAAOpC,GAEP,MADAjC,EAAOiC,MAAM,kCAAmCA,GAC1CA,CACR,CACF,IArCqB,OAqCpB,SArCoB8O,EAAAC,EAAAC,GAAA,OAAAX,EAAApO,MAAC,KAADC,UAAA,EAlEG,IAkEH,CAAAhB,IAAA,QAAAC,MAAA,eAAA8P,GAAA5P,EAAAA,EAAAA,UA6CrB,UAAmBkP,EAAe3C,GAChC,IAAK,IAADsD,EAAAC,EACFpR,EAAOqE,KAAK,wBAAyB,CAAEmM,MAAAA,IAGvC,IAAMa,QAAoBhR,KAAK2O,WAAWnB,EAAU2C,GAC9CjB,QAAsBhK,EAAIoD,KAAK,2BAA4B,CAC/DmF,eAAgB0C,EAChBc,0BAA2BD,EAAYhC,eAGzC,GAAuB,OAAnB8B,EAAC5B,EAAcnM,QAAd+N,EAAoBI,2BACvB,MAAM,IAAI3N,MAAM,sCAIlB,IAAM4N,QAAsBnR,KAAKsP,YAAYa,EAAOjB,EAAcnM,KAAKmO,4BAGjEE,QAAuBlM,EAAIoD,KAAK,4BAA6B,CACjEgI,WAAYpB,EAAcnM,KAAKuN,WAC/B7C,eAAgB0C,EAChBkB,+BAAgCF,EAAcvB,qBAGhD,GAAwB,OAApBmB,EAACK,EAAerO,QAAfgO,EAAqBvI,aACxB,MAAM,IAAIjF,MAAM,6CAKlB,OAFA5D,EAAOqE,KAAK,sCAAuC,CAAEmM,MAAAA,IAE9C,CACLZ,SAAS,EACT+B,KAAMF,EAAerO,KAAKuO,KAC1B9K,MAAO4K,EAAerO,KAAKyF,aAC3BqH,WAAYsB,EAActB,WAC1BC,UAAWqB,EAAcrB,UAE7B,CAAE,MAAOlO,GAEP,MADAjC,EAAOiC,MAAM,sBAAuB,CAAEuO,MAAAA,EAAOvO,MAAAA,IACvCA,CACR,CACF,IA1CkB,OA0CjB,SA1CiB2P,EAAAC,GAAA,OAAAX,EAAAhP,MAAC,KAADC,UAAA,EA7CG,IA6CH,CAAAhB,IAAA,wBAAAC,MAAA,eAAA0Q,GAAAxQ,EAAAA,EAAAA,UAgDlB,YACE,IAEE,OAAkB,cADGwF,EAAAA,QAAaC,QAAQ2G,GAE5C,CAAE,MAAOzL,GAEP,OADAjC,EAAOiC,MAAM,sCAAuCA,IAC7C,CACT,CACF,IARkC,OAQjC,WARiC,OAAA6P,EAAA5P,MAAC,KAADC,UAAA,EAhDhB,IAgDgB,CAAAhB,IAAA,oBAAAC,MAAA,eAAA2Q,GAAAzQ,EAAAA,EAAAA,UAclC,YACE,IACE,aAAawF,EAAAA,QAAaC,QAAQ2G,EACpC,CAAE,MAAOzL,GAEP,OADAjC,EAAOiC,MAAM,gCAAiCA,GACvC,IACT,CACF,IAP8B,OAO7B,WAP6B,OAAA8P,EAAA7P,MAAC,KAADC,UAAA,EAdI,IAcJ,CAAAhB,IAAA,kBAAAC,MAAA,eAAA4Q,GAAA1Q,EAAAA,EAAAA,UAY9B,YACE,UACQwF,EAAAA,QAAamL,YAAY,CAC7BvE,EACAA,IAIF,IACMwE,SADapL,EAAAA,QAAaqL,cACVC,QAAO,SAAAjR,GAAG,OAC9BA,EAAIoF,WAAW,sBACfpF,EAAIoF,WAAW,sBAAsB,IAGnC2L,EAAS1P,OAAS,UACdsE,EAAAA,QAAamL,YAAYC,IAGjClS,EAAOqE,KAAK,mCACd,CAAE,MAAOpC,GACPjC,EAAOiC,MAAM,8BAA+BA,EAC9C,CACF,IAtB4B,OAsB3B,WAtB2B,OAAA+P,EAAA9P,MAAC,KAADC,UAAA,EAZE,KAYF,EAAAhB,IAAA,cAAAC,MAzV5B,WAIE,OAHKuM,EAAkB0E,WACrB1E,EAAkB0E,SAAW,IAAI1E,GAE5BA,EAAkB0E,QAC3B,IAAC,CAV2B,GAwXjBC,EAAa3E,EAAkB4E,cCnctCC,EACQ,QADRA,EAEY,aAFZA,EAGO,WAyPAC,EAAmB,KA/O0BxS,EAAAA,EAAAA,UAH7B,SAAAyS,KAAAvS,EAAAA,EAAAA,SAAA,KAAAuS,GAAA,KACnBxC,WAAgC,KAAK,KACrCC,UAA+B,KAAK,KACpCwC,YAAuC,IAAIC,GAAM,GAAD,EAAAzR,IAAA,sBAAAC,MAExD,SAA4BgC,GAO1B,IALA,IAAMyP,EAAazP,EAAKiD,QAAQ,KAAM,KAAKA,QAAQ,KAAM,KACnDyM,EAASD,EAAWrQ,OAAS,IAAM,EAAI,EAAI,EAAKqQ,EAAWrQ,OAAS,EACpEuQ,EAASF,EAAa,IAAIG,OAAOF,GACjCG,EAASC,KAAKH,GACdI,EAAQ,IAAIC,WAAWH,EAAOzQ,QAC3B6Q,EAAI,EAAGA,EAAIJ,EAAOzQ,OAAQ6Q,IAAKF,EAAME,GAAKJ,EAAOK,WAAWD,GACrE,OAAOF,CACT,GAAC,CAAAhS,IAAA,aAAAC,MAMD,SAAkBoQ,GAA2C,IAAD+B,EAAAC,EAAAC,EAAAC,EAG1DhN,EAAkC8K,EAA1BtB,EAAUxJ,EAAVwJ,WAAYC,EAASzJ,EAATyJ,UAKpB9P,KAAK6P,WAAmC,kBAAfA,EAA0B7P,KAAKsT,oBAAoBzD,GAAcA,EAC1F7P,KAAK8P,UAAiC,kBAAdA,EAAyB9P,KAAKsT,oBAAoBxD,GAAaA,EACvF9P,KAAKsS,YAAYiB,QAEjB5T,EAAOqE,KAAK,iCAAkC,CAC5CwP,sBAAuBxT,KAAK6P,WAC5B4D,sBAAsC,OAAjBP,EAAElT,KAAK6P,aAAuB,OAAbsD,EAAfD,EAAiBQ,kBAAF,EAAfP,EAA8BjD,KACrDyD,qBAAsB3T,KAAK8P,UAC3B8D,qBAAoC,OAAhBR,EAAEpT,KAAK8P,YAAsB,OAAbuD,EAAdD,EAAgBM,kBAAF,EAAdL,EAA6BnD,MAEvD,GAAC,CAAApP,IAAA,iBAAAC,MAAA,eAAA8S,GAAA5S,EAAAA,EAAAA,UAOD,UAA4BqJ,GAC1B,IAAKtK,KAAK8P,UACR,MAAM,IAAIvM,MAAM,sCAGlB,IAAMuQ,EAAQ,UAAYxJ,EAAOjI,MAAM0R,KAAKzJ,GAAM9H,KAAK,KAAO,WAE9D,GAAIxC,KAAKsS,YAAY0B,IAAIF,GACvB,OAAO9T,KAAKsS,YAAY3I,IAAImK,GAG9B,IACE,IAAMG,QAAiBjU,KAAKkU,UAC1BlU,KAAK8P,UACLqC,EACA,GACA7H,GAKF,OAFAtK,KAAKsS,YAAY6B,IAAIL,EAAUG,GAC/BtU,EAAOmE,MAAM,kCACNmQ,CACT,CAAE,MAAOrS,GAEP,MADAjC,EAAOiC,MAAM,6BAA8BA,GACrC,IAAI2B,MAAM,8BAClB,CACF,IA1B2B,OA0B1B,SA1B0BE,GAAA,OAAAoQ,EAAAhS,MAAC,KAADC,UAAA,EAP1B,IAO0B,CAAAhB,IAAA,sBAAAC,MAAA,eAAAqT,GAAAnT,EAAAA,EAAAA,UAiC3B,UAAiCqJ,GAC/B,IAAKtK,KAAK8P,UACR,MAAM,IAAIvM,MAAM,sCAGlB,IAAMuQ,EAAQ,eAAiBxJ,EAAOjI,MAAM0R,KAAKzJ,GAAM9H,KAAK,KAAO,WAEnE,GAAIxC,KAAKsS,YAAY0B,IAAIF,GACvB,OAAO9T,KAAKsS,YAAY3I,IAAImK,GAG9B,IACE,IAAMO,QAAsBrU,KAAKkU,UAC/BlU,KAAK8P,UACLqC,EACA,GACA7H,GAKF,OAFAtK,KAAKsS,YAAY6B,IAAIL,EAAUO,GAC/B1U,EAAOmE,MAAM,uCACNuQ,CACT,CAAE,MAAOzS,GAEP,MADAjC,EAAOiC,MAAM,kCAAmCA,GAC1C,IAAI2B,MAAM,mCAClB,CACF,IA1BgC,OA0B/B,SA1B+BG,GAAA,OAAA0Q,EAAAvS,MAAC,KAADC,UAAA,EAjCL,IAiCK,CAAAhB,IAAA,iBAAAC,MAAA,eAAAuT,GAAArT,EAAAA,EAAAA,UAiChC,UAA4BqJ,GAC1B,IAAKtK,KAAK8P,UACR,MAAM,IAAIvM,MAAM,sCAGlB,IAAMuQ,EAAQ,UAAYxJ,EAAOjI,MAAM0R,KAAKzJ,GAAM9H,KAAK,KAAO,WAE9D,GAAIxC,KAAKsS,YAAY0B,IAAIF,GACvB,OAAO9T,KAAKsS,YAAY3I,IAAImK,GAG9B,IACE,IAAMS,QAAiBvU,KAAKkU,UAC1BlU,KAAK8P,UACLqC,EACA,GACA7H,GAKF,OAFAtK,KAAKsS,YAAY6B,IAAIL,EAAUS,GAC/B5U,EAAOmE,MAAM,kCACNyQ,CACT,CAAE,MAAO3S,GAEP,MADAjC,EAAOiC,MAAM,6BAA8BA,GACrC,IAAI2B,MAAM,8BAClB,CACF,IA1B2B,OA0B1B,SA1B0BI,GAAA,OAAA2Q,EAAAzS,MAAC,KAADC,UAAA,EAjCK,IAiCL,CAAAhB,IAAA,gBAAAC,MAgC3B,WACE,IAAKf,KAAK6P,WACR,MAAM,IAAItM,MAAM,sCAElB,OAAOvD,KAAK6P,UACd,GAAC,CAAA/O,IAAA,eAAAC,MAMD,WACE,IAAKf,KAAK8P,UACR,MAAM,IAAIvM,MAAM,sCAElB,OAAOvD,KAAK8P,SACd,GAAC,CAAAhP,IAAA,gBAAAC,MAMD,WACE,OAA2B,OAApBf,KAAK6P,YAA0C,OAAnB7P,KAAK8P,SAC1C,GAAC,CAAAhP,IAAA,QAAAC,MAKD,WAmBE,IAAK,IAAMD,KAjBPd,KAAK6P,aAEH7P,KAAK6P,sBAAsBkD,YAC7B/S,KAAK6P,WAAW2E,KAAK,GAEvBxU,KAAK6P,WAAa,MAGhB7P,KAAK8P,YAEH9P,KAAK8P,qBAAqBiD,YAC5B/S,KAAK8P,UAAU0E,KAAK,GAEtBxU,KAAK8P,UAAY,MAID9P,KAAKsS,YAAYmC,UAC7B3T,aAAeiS,YACjBjS,EAAI0T,KAAK,GAGbxU,KAAKsS,YAAYiB,QAEjB5T,EAAOqE,KAAK,6BACd,GAAC,CAAAlD,IAAA,YAAAC,MAAA,eAAA2T,GAAAzT,EAAAA,EAAAA,UAMD,UACE0T,EACA3Q,EACA7B,EACAmI,GAEA,IAEE,IAAMxJ,QAAY8T,OAAOC,OAAOC,UAC9B,MACAH,EACA,QACA,EACA,CAAC,YAAa,eAIVI,QAAoBH,OAAOC,OAAOG,WACtC,CACE9E,KAAM,OACN+E,KAAM,UACN3K,KAAMA,GAAQ,IAAIyI,WAAW,IAC7B/O,MAAM,IAAIkR,aAAcC,OAAOnR,IAEjClD,EACS,EAATqB,GAGF,OAAO,IAAI4Q,WAAWgC,EACxB,CAAE,MAAOnT,GAEP,MADAjC,EAAOiC,MAAM,6BAA8BA,GACrC,IAAI2B,MAAM,wBAClB,CACF,IAjCuB,OAiCtB,SAjCsBqJ,EAAAC,EAAAG,EAAA+C,GAAA,OAAA2E,EAAA7S,MAAC,KAADC,UAAA,EANtB,O,olBC9LH,IAAMsT,IAAcC,EAAAA,EAAAA,oBAA2CxR,GAMlDyR,GAA4C,SAAHjP,GAAsB,IAAhBkP,EAAQlP,EAARkP,SAC1DC,GAA8CC,EAAAA,EAAAA,WAAS,GAAMC,GAAAC,EAAAA,EAAAA,SAAAH,EAAA,GAAtDI,EAAeF,EAAA,GAAEG,EAAkBH,EAAA,GAC1CI,GAAkCL,EAAAA,EAAAA,WAAS,GAAKM,GAAAJ,EAAAA,EAAAA,SAAAG,EAAA,GAAzCE,EAASD,EAAA,GAAEE,EAAYF,EAAA,GAC9BG,GAAgDT,EAAAA,EAAAA,WAAS,GAAKU,GAAAR,EAAAA,EAAAA,SAAAO,EAAA,GAAvDE,EAAgBD,EAAA,GAAEE,EAAmBF,EAAA,GAC5CG,GAAwBb,EAAAA,EAAAA,UAAsB,MAAKc,GAAAZ,EAAAA,EAAAA,SAAAW,EAAA,GAA5ChF,EAAIiF,EAAA,GAAEC,EAAOD,EAAA,IAGpBE,EAAAA,EAAAA,YAAU,WACR,IAAMC,EAAe,eAAAzP,GAAAhG,EAAAA,EAAAA,UAAG,YACtB,IACEtB,EAAOqE,KAAK,yCAEZ,IAAMwC,QAAcC,EAAAA,QAAaC,QAAQ,gBACnCiQ,QAAmBlQ,EAAAA,QAAaC,QAAQ,QACxCkQ,QAAyBnQ,EAAAA,QAAaC,QAAQ,sBAC9CmQ,QAAwBpQ,EAAAA,QAAaC,QAAQ,qBAEnD,GAAIF,EAAO,CAOT,GANA7G,EAAOqE,KAAK,4CAEZkB,EAAIM,SAASF,QAAQqD,OAAOhC,cAAa,UAAaH,EAEtDqP,GAAmB,GAEfc,EACF,IACE,IAAMG,EAAW3T,KAAKiL,MAAMuI,GAC5BH,EAAQM,GACRnX,EAAOqE,KAAK,wCAAyC,CAAE+S,OAAQD,EAASjN,IAC1E,CAAE,MAAOmN,GACPrX,EAAOiC,MAAM,mCAAoCoV,GACjDR,EAAQ,KACV,MAECA,EAAQ,MAIX,IACMI,GAAoBC,GACtBzE,EAAiB6E,WAAW,CAC1BpH,WAAY+G,EACZ9G,UAAW+G,EACXjH,mBAAoB,KAEtBjQ,EAAOqE,KAAK,+CAEZrE,EAAOsC,KAAK,8EAEhB,CAAE,MAAOiV,GACPvX,EAAOiC,MAAM,kCAAmCsV,GAChD9E,EAAiBmB,OACnB,CAEF,MAEEsC,GAAmB,GACnBW,EAAQ,aACDtR,EAAIM,SAASF,QAAQqD,OAAOhC,cACnChH,EAAOqE,KAAK,gCAEhB,CAAE,MAAOpC,GACPjC,EAAOiC,MAAM,sCAAuCA,GAEpD,UACQ6E,EAAAA,QAAa8C,WAAW,sBACxB9C,EAAAA,QAAa8C,WAAW,uBACxB9C,EAAAA,QAAa8C,WAAW,eACvBrE,EAAIM,SAASF,QAAQqD,OAAOhC,oBAC7BsL,EAAWkF,kBACjB/E,EAAiBmB,OACnB,CAAE,MAAO6D,GACPzX,EAAOiC,MAAM,6BAA8BwV,EAC7C,CACF,CAAC,QACCnB,GAAa,GACbI,GAAoB,EACtB,CACF,IAAC,kBAtEoB,OAAApP,EAAApF,MAAA,KAAAC,UAAA,KAwErB4U,GACF,GAAG,IAGH,IAAMtO,EAAM,eAAAkB,GAAArI,EAAAA,EAAAA,UAAG,YACb,IACEtB,EAAOqE,KAAK,0BAA2B,CAAE+S,OAAY,MAAJzF,OAAI,EAAJA,EAAMzH,KACvDoM,GAAa,SAGPxP,EAAAA,QAAa8C,WAAW,sBACxB9C,EAAAA,QAAa8C,WAAW,uBACxB9C,EAAAA,QAAa8C,WAAW,cAGxB0I,EAAWkF,kBACjB/E,EAAiBmB,eAGVrO,EAAIM,SAASF,QAAQqD,OAAOhC,cACnChH,EAAOqE,KAAK,oCAEZwS,EAAQ,MACRX,GAAmB,GACnBlW,EAAOqE,KAAK,mDACd,CAAE,MAAOpC,GACPjC,EAAOiC,MAAM,wBAAyB,CACpCmV,OAAY,MAAJzF,OAAI,EAAJA,EAAMzH,GACd7C,OAAQpF,EAAMoF,OACdzE,QAASX,EAAMW,gBAIXkE,EAAAA,QAAa8C,WAAW,sBACxB9C,EAAAA,QAAa8C,WAAW,uBACxB9C,EAAAA,QAAa8C,WAAW,cAGxB0I,EAAWkF,kBACjB/E,EAAiBmB,eAGVrO,EAAIM,SAASF,QAAQqD,OAAOhC,cAEnC6P,EAAQ,MACRX,GAAmB,GACnBlW,EAAOqE,KAAK,8DACd,CAAC,QACCiS,GAAa,EACf,CACF,IAAC,kBA9CW,OAAA3M,EAAAzH,MAAA,KAAAC,UAAA,KAiDNuV,EAAU,eAAAC,GAAArW,EAAAA,EAAAA,UAAG,UAAOsW,GACxB,GAAKjG,EAEL,IACE,IAAMkG,EAAO3O,EAAAA,EAAA,GAAQyI,GAASiG,GAC9Bf,EAAQgB,SAEF/Q,EAAAA,QAAagC,QAAQ,OAAQtF,KAAKC,UAAUoU,IAClD7X,EAAOqE,KAAK,2BAA4BwT,EAC1C,CAAE,MAAO5V,GACPjC,EAAOiC,MAAM,+CAAgDA,EAC/D,CACF,IAAC,gBAZe6B,GAAA,OAAA6T,EAAAzV,MAAA,KAAAC,UAAA,KAeV2V,EAAW,eAAAC,GAAAzW,EAAAA,EAAAA,UAAG,UAAOkP,EAAe3C,GACxC,IACE7N,EAAOqE,KAAK,4BAA4BmM,GACxC8F,GAAa,GAGb,IAAM/G,QAAyC+C,EAAW0F,MAAMxH,EAAO3C,GAIvE4E,EAAiB6E,WAAW,CAC1BpH,WAAYX,EAAcW,WAC1BC,UAAWZ,EAAcY,UACzBF,mBAAoB,WAGhBnJ,EAAAA,QAAagC,QAAQ,qBAAsByG,EAAcW,kBACzDpJ,EAAAA,QAAagC,QAAQ,oBAAqByG,EAAcY,WAG9D5K,EAAIM,SAASF,QAAQqD,OAAOhC,cAAa,UAAauI,EAAc1I,MAEpE7G,EAAOqE,KAAK,0BAA2B,CAAE+S,OAAQ7H,EAAcoC,KAAKzH,KAGpE,IAAMiN,EAAQjO,EAAAA,EAAA,GACTqG,EAAcoC,MAAI,IACrBsG,WAAY1I,EAAcoC,KAAKsG,aAAc,IAAIjV,MAAOC,cACxDiV,WAAY3I,EAAcoC,KAAKuG,aAAc,IAAIlV,MAAOC,sBAIpD6D,EAAAA,QAAagC,QAAQ,eAAgByG,EAAc1I,aACnDC,EAAAA,QAAagC,QAAQ,OAAQtF,KAAKC,UAAU0T,IAElDN,EAAQM,GACRjB,GAAmB,EACrB,CAAE,MAAOjU,GAAa,IAADsF,EASnB,MARAvH,EAAOiC,MAAM,uBAAwB,CACnCuO,MAAAA,EACAnJ,OAAQpF,EAAMoF,OACdzE,QAASX,EAAMW,QACfuE,SAAwB,OAAhBI,EAAEtF,EAAMkF,eAAQ,EAAdI,EAAgBnE,OAG5BqP,EAAiBmB,QACX3R,CACR,CAAC,QACCqU,GAAa,EACf,CACF,IAAC,gBAlDgBvS,EAAAC,GAAA,OAAA+T,EAAA7V,MAAA,KAAAC,UAAA,KAqDXgW,EAAc,eAAAC,GAAA9W,EAAAA,EAAAA,UAAG,UAAOiP,EAAcC,EAAe3C,GACzD,IACE7N,EAAOqE,KAAK,mCAAmCmM,GAC/C8F,GAAa,SAGPhE,EAAW+F,SAAS9H,EAAMC,EAAO3C,GAEvC7N,EAAOqE,KAAK,iCACd,CAAE,MAAOpC,GAAa,IAADuF,EAOnB,MANAxH,EAAOiC,MAAM,8BAA+B,CAC1CuO,MAAAA,EACAnJ,OAAQpF,EAAMoF,OACdzE,QAASX,EAAMW,QACfuE,SAAwB,OAAhBK,EAAEvF,EAAMkF,eAAQ,EAAdK,EAAgBpE,OAEtBnB,CACR,CAAC,QACCqU,GAAa,EACf,CACF,IAAC,gBApBmBrJ,EAAAC,EAAAG,GAAA,OAAA+K,EAAAlW,MAAA,KAAAC,UAAA,KAuBdmW,EAAgB,eAAAC,GAAAjX,EAAAA,EAAAA,UAAG,YACvB,IAGE,IAAM6F,QAAiB5B,EAAIyE,IAAI,uBAC/B,OAAO7C,EAASE,QAAU,KAAOF,EAASE,OAAS,GACrD,CAAE,MAAOpF,GAEP,OADAjC,EAAOsC,KAAK,sDAAuDL,IAC5D,CACT,CACF,IAAC,kBAVqB,OAAAsW,EAAArW,MAAA,KAAAC,UAAA,KAYhBf,EAAQ,CACZ6U,gBAAAA,EACAI,UAAAA,EACAI,iBAAAA,EACA9E,KAAAA,EACAlJ,OAAAA,EACAiP,WAAAA,EACAI,YAAAA,EACAK,eAAAA,EACAG,iBAAAA,GAGF,OAAOE,EAAAA,EAAAA,KAAC/C,GAAYgD,SAAQ,CAACrX,MAAOA,EAAMwU,SAAEA,GAC9C,EAEa8C,GAAU,WACrB,IAAMC,GAAUC,EAAAA,EAAAA,YAAWnD,IAC3B,QAAgBvR,IAAZyU,EACF,MAAM,IAAI/U,MAAM,+CAElB,OAAO+U,CACT,E,oGCrJaE,GAA6B,CACxCC,QAAS,UACTC,aAAc,UACdC,YAAa,UACbC,UAAW,UACXC,eAAgB,UAChBC,WAAY,UACZC,QAAS,UACTC,KAAM,UACNC,KAAM,UACNC,cAAe,UACfC,aAAc,UACdC,OAAQ,UACRC,YAAa,UACbC,aAAc,UACd1X,MAAO,UACP2X,WAAY,UACZhK,QAAS,UACTiK,aAAc,UACdpV,QAAS,UACTqV,aAAc,UACdC,SAAU,UACVC,gBAAiB,UACjBC,UAAW,eACXC,OAAQ,qBACRC,UAAW,UACXC,UAAW,UACXC,QAAS,qBACTC,OAAQ,UACRC,YAAa,UACbC,aAAc,UACdC,eAAgB,UAEhBC,MAAO,UACPC,MAAO,UACPC,OAAQ,UACRC,QAAS,UACTC,QAAS,UACTC,QAAS,UACTC,QAAS,UACTC,QAAS,UACTC,QAAS,UACTC,QAAS,UACTC,QAAS,UACTC,QAAS,UAETC,SAAU,UACVC,kBAAmB,WAIRC,GAA4B,CACvC1C,QAAS,UACTC,aAAc,UACdC,YAAa,UACbC,UAAW,UACXC,eAAgB,UAChBC,WAAY,UACZC,QAAS,UACTC,KAAM,UACNC,KAAM,UACNC,cAAe,UACfC,aAAc,UACdC,OAAQ,UACRC,YAAa,UACbC,aAAc,UACd1X,MAAO,UACP2X,WAAY,UACZhK,QAAS,UACTiK,aAAc,UACdpV,QAAS,UACTqV,aAAc,UACdC,SAAU,UACVC,gBAAiB,UACjBC,UAAW,gBACXC,OAAQ,qBACRC,UAAW,UACXC,UAAW,UACXC,QAAS,qBACTC,OAAQ,UACRC,YAAa,UACbC,aAAc,UACdC,eAAgB,UAEhBC,MAAO,UACPC,MAAO,UACPC,OAAQ,UACRC,QAAS,UACTC,QAAS,UACTC,QAAS,UACTC,QAAS,UACTC,QAAS,UACTC,QAAS,UACTC,QAAS,UACTC,QAAS,UACTC,QAAS,UAETC,SAAU,UACVC,kBAAmB,WAGRE,GAA4B,CACvCC,aAAc,CACZC,QAAyB,QAAhBpb,EAAAA,QAASC,GAAe,cAAgB,SACjDob,OAAwB,QAAhBrb,EAAAA,QAASC,GAAe,qBAAuB,gBACvDqb,SAA0B,QAAhBtb,EAAAA,QAASC,GAAe,uBAAyB,gBAC3Dsb,KAAsB,QAAhBvb,EAAAA,QAASC,GAAe,mBAAqB,cACnDub,MAAuB,QAAhBxb,EAAAA,QAASC,GAAe,oBAAsB,gBAEvDwb,UAAW,CACTC,GAAI,GACJC,GAAI,GACJC,GAAI,GACJC,GAAI,GACJC,GAAI,GACJC,IAAK,GACLC,KAAM,GACNC,QAAS,IAEXC,YAAa,CACXC,MAAO,KACPC,OAAQ,IACRC,MAAO,MAETC,cAAe,CACbH,OAAQ,KACRC,OAAQ,EACRG,KAAM,OAIGC,GAAsB,CACjCC,KAAM,EACNf,GAAI,EACJC,GAAI,EACJC,GAAI,GACJC,GAAI,GACJC,GAAI,GACJC,IAAK,GACLC,KAAM,IAGKU,GAAgC,CAC3CD,KAAM,EACNd,GAAI,EACJC,GAAI,EACJC,GAAI,GACJC,GAAI,GACJC,IAAK,GACLY,KAAM,MAGKC,GAAsB,CACjCH,KAAM,CACJI,YAAa,cACbC,aAAc,CAAEC,MAAO,EAAGC,OAAQ,GAClCC,cAAe,EACfC,aAAc,EACdC,UAAW,GAEbxB,GAAI,CACFkB,YAAa,OACbC,aAAc,CAAEC,MAAO,EAAGC,OAAQ,GAClCC,cAAe,IACfC,aAAc,EACdC,UAAW,GAEbvB,GAAI,CACFiB,YAAa,OACbC,aAAc,CAAEC,MAAO,EAAGC,OAAQ,GAClCC,cAAe,GACfC,aAAc,EACdC,UAAW,GAEbtB,GAAI,CACFgB,YAAa,OACbC,aAAc,CAAEC,MAAO,EAAGC,OAAQ,IAClCC,cAAe,IACfC,aAAc,GACdC,UAAW,GAEbrB,GAAI,CACFe,YAAa,OACbC,aAAc,CAAEC,MAAO,EAAGC,OAAQ,IAClCC,cAAe,IACfC,aAAc,GACdC,UAAW,KAIFC,GAA4B,CACvCC,SAAU,CACRC,KAAM,IACNlB,OAAQ,IACRmB,KAAM,KAERC,OAAQ,CACNC,KAAM,OACNC,OAAQ,UACRC,QAAS,WACTC,UAAW,gBCpUf,IAAMC,IAAe1I,EAAAA,EAAAA,oBAA6CxR,GAMrDma,GAA8C,SAAH3X,GAAsB,IAAhBkP,EAAQlP,EAARkP,SACtD0I,EAAoBC,GAAAA,QAAWC,iBACrC3I,GAAoCC,EAAAA,EAAAA,UAA+B,SAAtBwI,GAA6BvI,GAAAC,EAAAA,EAAAA,SAAAH,EAAA,GAAnE4I,EAAU1I,EAAA,GAAE2I,EAAa3I,EAAA,GAChCI,GAAiDL,EAAAA,EAAAA,WAAS,GAAKM,GAAAJ,EAAAA,EAAAA,SAAAG,EAAA,GAAxDwI,EAAcvI,EAAA,GAAEwI,EAAsBxI,EAAA,IAE7CU,EAAAA,EAAAA,YAAU,WACR,IAAM+H,EAAmB,eAAAvX,GAAAhG,EAAAA,EAAAA,UAAG,YAC1B,IACE,IAAMwd,QAAuBhY,EAAAA,QAAaC,QAAQ,aAC9C+X,EACqB,WAAnBA,GACFF,GAAuB,GACvBF,EAAoC,SAAtBJ,KAEdM,GAAuB,GACvBF,EAAiC,SAAnBI,KAIhBF,GAAuB,GACvBF,EAAoC,SAAtBJ,GAElB,CAAE,MAAOrc,GACPV,QAAQU,MAAM,+CAAgDA,GAE9D2c,GAAuB,GACvBF,EAAoC,SAAtBJ,EAChB,CACF,IAAC,kBAtBwB,OAAAhX,EAAApF,MAAA,KAAAC,UAAA,KAuBzB0c,GACF,GAAG,CAACP,KAEJxH,EAAAA,EAAAA,YAAU,WAER,IAAMiI,EAAeR,GAAAA,QAAWS,mBAAkB,SAAArV,GAAsB,IAAnBsV,EAAWtV,EAAXsV,YAC/CN,GACFD,EAA8B,SAAhBO,EAElB,IACA,OAAO,kBAAMF,EAAaG,QAAS,CACrC,GAAG,CAACP,IAEJ,IAAMQ,EAAW,eAAAxH,GAAArW,EAAAA,EAAAA,UAAG,YAClB,IAAM8d,GAAiBX,EACvBC,EAAcU,GACdR,GAAuB,GACvB,UACQ9X,EAAAA,QAAagC,QAAQ,YAAasW,EAAgB,OAAS,QACnE,CAAE,MAAOnd,GACPV,QAAQU,MAAM,uCAAwCA,EACxD,CACF,IAAC,kBATgB,OAAA0V,EAAAzV,MAAA,KAAAC,UAAA,KAWXkd,EAAiB,eAAAtH,GAAAzW,EAAAA,EAAAA,UAAG,UAAOF,GAE/B,GADAwd,EAAuBxd,GACnBA,EAAO,CACTsd,EAAoC,SAAtBJ,GACd,UACQxX,EAAAA,QAAagC,QAAQ,YAAa,SAC1C,CAAE,MAAO7G,GACPV,QAAQU,MAAM,gDAAiDA,EACjE,CACF,MAIE,UACQ6E,EAAAA,QAAagC,QAAQ,YAAa2V,EAAa,OAAS,QAChE,CAAE,MAAOxc,GACPV,QAAQU,MAAM,gDAAiDA,EACjE,CAEJ,IAAC,gBAnBsB6B,GAAA,OAAAiU,EAAA7V,MAAA,KAAAC,UAAA,KAsBjBmd,EAAkB,CACtBC,OAFyBd,EAAajD,GAAiB3C,GAGvD4C,WAAAA,GACAsB,QAAAA,GACAE,aAAAA,GACAE,QAAAA,GACAQ,WAAAA,GACAc,WAAAA,GAGF,OACEjG,EAAAA,EAAAA,KAAC4F,GAAa3F,SAAQ,CAACrX,MAAO,CAAEke,MAAAA,EAAOH,YAAAA,EAAaK,cAAeb,EAAgBU,kBAAAA,GAAoBzJ,SACpGA,GAGP,EAEa6J,GAAc,WACzB,IAAM9G,GAAUC,EAAAA,EAAAA,YAAWwF,IAC3B,IAAKzF,EACH,MAAM,IAAI/U,MAAM,mDAElB,OAAO+U,CACT,E,+pBC5GA,IAAM+G,IAAiBC,EAAAA,EAAAA,aAA4C,SAAAjZ,EAKhEkZ,GAAS,IAJVhK,EAAQlP,EAARkP,SAAQiK,EAAAnZ,EACRoZ,mBAAAA,OAAkB,IAAAD,EAAG,EAACA,EACtBE,EAAqBrZ,EAArBqZ,sBACGC,GAAKC,EAAAA,GAAAA,SAAAvZ,EAAAwZ,IAEAZ,EAAUG,KAAVH,MAIFa,EAA+B,QAAhB5f,EAAAA,QAASC,GAAe,GAAK,GAE5C4f,EAAkC,QAAhB7f,EAAAA,QAASC,GAAe,IAAM,GAChD6f,EAAef,EAAMvC,QAAQV,GAM7BiE,EAA4B,CAChC,CACEC,cAJsBC,KAAKC,IAAIL,EAAkBM,GAAaP,GAAgBE,EAAeP,EAAqB,IAMpHC,GAGF,OACEvH,EAAAA,EAAAA,KAACmI,GAAAA,QAAUzX,GAAAA,GAAA,CACT0W,IAAKA,GACDI,GAAK,IACTD,sBAAuBO,EACvBM,8BAA8B,EAC9BC,0BAA0B,UAC1BC,oBAAqB,GAAGlL,SAEvBA,IAGP,IAEA8J,GAAeqB,YAAc,iBAE7B,Y,0BC6FMC,GAASC,EAAAA,QAAWxb,OAAO,CAC/Byb,UAAW,CACTC,KAAM,EACNC,gBAAiB,UACjBC,WAAYnc,EAAAA,QAAUoc,iBAExBC,OAAQ,CACNC,cAAe,MACfC,WAAY,SACZC,eAAgB,gBAChBC,QAAS,GACTC,kBAAmB,EACnBC,kBAAmB,UACnBT,gBAAiB,QAEnB/W,MAAO,CACLyX,SAAU,GACVC,WAAY,OACZC,MAAO,QAETC,YAAa,CACXN,QAAS,GAEXO,cAAe,CACbP,QAAS,GAEXQ,gBAAiB,CACfX,cAAe,MACfG,QAAS,EACTC,kBAAmB,EACnBC,kBAAmB,UACnBT,gBAAiB,QAEnBgB,aAAc,CACZC,gBAAiB,EACjBC,kBAAmB,GACnBrF,aAAc,GACdsF,iBAAkB,EAClBnB,gBAAiB,WAEnBoB,aAAc,CACZpB,gBAAiB,WAEnBqB,WAAY,CACVX,SAAU,GACVE,MAAO,QAETU,iBAAkB,CAChBV,MAAO,QAETW,iBAAkB,CAChBxB,KAAM,EACNO,eAAgB,SAChBD,WAAY,UAEdmB,YAAa,CACXC,UAAW,GACXf,SAAU,GACVE,MAAO,QAETc,cAAe,CACb3B,KAAM,EACNQ,QAAS,GACTP,gBAAiB,WAEnB2B,KAAM,CACJC,WAAYziB,EAAAA,QAAS0iB,OAAO,CAC1BC,IAAK,QACLC,QAAS,YACTC,QAAS,cAEXtB,SAAU,GACVE,MAAO,QAETqB,UAAW,CACTvB,SAAU,GACVE,MAAO,OACPsB,aAAc,GACdC,UAAW,UAEbC,UAAW,CACTR,WAAY,YACZlB,SAAU,GACVV,gBAAiB,OACjBY,MAAO,OACPL,QAAS,GACT1E,aAAc,GAEhBwG,OAAQ,CACN9B,QAAS,GACT+B,eAAgB,EAChBC,eAAgB,UAChBvC,gBAAiB,QAEnBwC,YAAa,CACXxC,gBAAiB,UACjBnE,aAAc,EACd0E,QAAS,GACTF,WAAY,UAEdoC,gBAAiB,CACf7B,MAAO,OACPD,WAAY,UAIhB,SArO4C,SAAHrb,GAA8B,IAAxBod,EAAOpd,EAAPod,QAASC,EAAOrd,EAAPqd,QACtDlO,GAAwBC,EAAAA,EAAAA,UAAiB,IAAGC,GAAAC,EAAAA,EAAAA,SAAAH,EAAA,GAArCkN,EAAIhN,EAAA,GAAEiO,EAAOjO,EAAA,GACpBI,GAA8BL,EAAAA,EAAAA,WAAkB,GAAKM,GAAAJ,EAAAA,EAAAA,SAAAG,EAAA,GAA9C8N,EAAO7N,EAAA,GAAE8N,EAAU9N,EAAA,GAC1BG,GAA4BT,EAAAA,EAAAA,UAA4C,OAAMU,GAAAR,EAAAA,EAAAA,SAAAO,EAAA,GAAvEnE,EAAMoE,EAAA,GAAE2N,EAAS3N,EAAA,IAExBM,EAAAA,EAAAA,YAAU,WACJgN,GACFM,GAEJ,GAAG,CAACN,EAAS1R,IAEb,IAAMgS,EAAS,eAAA9c,GAAAhG,EAAAA,EAAAA,UAAG,YAChB4iB,GAAW,GACX,IACE,IAAMG,QAAgBrkB,EAAOskB,UAG7B,GAAe,QAAXlS,EAAkB,CACpB,IAAMmS,EAAeF,EAClBG,MAAM,MACNpS,QAAO,SAAAqS,GACN,IAAMC,EAAW,IAAOtS,EAAO7O,cAAa,IAC5C,OAAOkhB,EAAK1hB,SAAS2hB,EACvB,IACC7hB,KAAK,MACRmhB,EAAQO,GAAgB,0BAC1B,MACEP,EAAQK,EAEZ,CAAE,MAAOpiB,GACPV,QAAQU,MAAM,uBAAwBA,GACtC+hB,EAAQ,wCACV,CAAC,QACCE,GAAW,EACb,CACF,IAAC,kBAxBc,OAAA5c,EAAApF,MAAA,KAAAC,UAAA,KA0BTwiB,EAAS,eAAAhb,GAAArI,EAAAA,EAAAA,UAAG,YAEhB0iB,EAAQ,0BACV,IAAC,kBAHc,OAAAra,EAAAzH,MAAA,KAAAC,UAAA,KAKT7B,EAAwB,QAAhBC,EAAAA,QAASC,GAEvB,OACEgY,EAAAA,EAAAA,KAACoM,GAAAA,QAAK,CACJC,cAAc,QACdC,aAAa,EACbhB,QAASA,EACTiB,eAAgBhB,EAAQnO,UAExBoP,EAAAA,EAAAA,MAACC,GAAAA,QAAY,CAACC,MAAOlE,GAAOE,UAAUtL,SAAA,EACpCoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,GAAOO,OAAO3L,SAAA,EACzB4C,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CAACF,MAAOlE,GAAOiB,YAAaoD,QAAStB,EAAQnO,UAC5D4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,QAAQvO,KAAM,GAAIggB,MAAM,YAEzCxJ,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,GAAO3W,MAAMuL,SAAC,sBAC3B4C,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CAACF,MAAOlE,GAAOkB,cAAemD,QAASjB,EAAUxO,UAChE4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,UAAUvO,KAAM,GAAIggB,MAAM,eAI7CgD,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,GAAOmB,gBAAgBvM,SAAA,EAClC4C,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CACfF,MAAO,CAAClE,GAAOoB,aAAyB,QAAXhQ,GAAoB4O,GAAOwB,cACxD6C,QAAS,WAAF,OAAQlB,EAAU,MAAM,EAACvO,UAEhC4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAO,CAAClE,GAAOyB,WAAuB,QAAXrQ,GAAoB4O,GAAO0B,kBAAkB9M,SAAC,WAEjF4C,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CACfF,MAAO,CAAClE,GAAOoB,aAAyB,UAAXhQ,GAAsB4O,GAAOwB,cAC1D6C,QAAS,WAAF,OAAQlB,EAAU,QAAQ,EAACvO,UAElC4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAO,CAAClE,GAAOyB,WAAuB,UAAXrQ,GAAsB4O,GAAO0B,kBAAkB9M,SAAC,cAEnF4C,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CACfF,MAAO,CAAClE,GAAOoB,aAAyB,SAAXhQ,GAAqB4O,GAAOwB,cACzD6C,QAAS,WAAF,OAAQlB,EAAU,OAAO,EAACvO,UAEjC4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAO,CAAClE,GAAOyB,WAAuB,SAAXrQ,GAAqB4O,GAAO0B,kBAAkB9M,SAAC,gBAElF4C,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CACfF,MAAO,CAAClE,GAAOoB,aAAyB,SAAXhQ,GAAqB4O,GAAOwB,cACzD6C,QAAS,WAAF,OAAQlB,EAAU,OAAO,EAACvO,UAEjC4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAO,CAAClE,GAAOyB,WAAuB,SAAXrQ,GAAqB4O,GAAO0B,kBAAkB9M,SAAC,cAInFqO,GACCe,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,GAAO2B,iBAAiB/M,SAAA,EACnC4C,EAAAA,EAAAA,KAACgN,GAAAA,QAAiB,CAACxjB,KAAK,QAAQggB,MAAM,aACtCxJ,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,GAAO4B,YAAYhN,SAAC,wBAGnC4C,EAAAA,EAAAA,KAACmI,GAAAA,QAAU,CAACuE,MAAOlE,GAAO8B,cAAclN,SACrCtV,GACC0kB,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAAAvP,SAAA,EACH4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,GAAOqC,UAAUzN,SAAC,2GAI/B4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,GAAOwC,UAAU5N,SAAC,yDAGjC4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,GAAO+B,KAAKnN,SAAEmN,OAKjCvK,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,GAAOyC,OAAO7N,UACzB4C,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CACfF,MAAOlE,GAAO4C,YACdyB,QAASV,EAAU/O,UAEnB4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,GAAO6C,gBAAgBjO,SAAC,uBAMjD,E,+kBC3HA,IA2LM6P,GAAY,SAACnG,GAAe,OAAK2B,EAAAA,QAAWxb,OAAO,CACvDigB,OAAQ,CACNlE,cAAe,MACfC,WAAY,SACZC,eAAgB,SAChBW,gBAAiB/C,EAAMvC,QAAQZ,GAC/BmG,kBAAmBhD,EAAMvC,QAAQX,GACjCa,aAAcqC,EAAMrC,aAAab,GACjCuJ,UAAW,IAEbC,cAAa1c,GAAA,CACXkY,gBAAiB9B,EAAMC,OAAOzG,SAC3BwG,EAAMnC,QAAQjB,IAEnB2J,eAAgB,CACdzE,gBAAiB9B,EAAMC,OAAOxF,UAEhC+L,eAAc5c,GAAA,CACZkY,gBAAiB9B,EAAMC,OAAO9a,SAC3B6a,EAAMnC,QAAQjB,IAEnB6J,WAAY,CACV/D,MAAO1C,EAAMC,OAAO5E,MACpBmH,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC4F,WAAY,MACZiB,WAAY1D,EAAM7D,WAAWC,aAAaG,SAC1CmK,WAAY1G,EAAMvC,QAAQb,IAE5B+J,aAAc,CACZjE,MAAO1C,EAAMC,OAAO/F,eAErB,EAEH,SA5N0D,SAAH9S,GAUhD,IATLwf,EAAIxf,EAAJwf,KACA1V,EAAK9J,EAAL8J,MACA3C,EAAQnH,EAARmH,SACA0C,EAAI7J,EAAJ6J,KACA4V,EAAezf,EAAfyf,gBACAC,EAAS1f,EAAT0f,UACAC,EAAO3f,EAAP2f,QAAOC,EAAA5f,EACPqT,SAAAA,OAAQ,IAAAuM,GAAQA,EAChBpB,EAAKxe,EAALwe,MAEAqB,EAKI7N,KAJFZ,EAAWyO,EAAXzO,YACAK,EAAcoO,EAAdpO,eACAG,EAAgBiO,EAAhBjO,iBACWkO,EAAWD,EAAtBlQ,UAGMiJ,EAAUG,KAAVH,MACF0B,EAASyE,GAAUnG,GAEzBzJ,GAAkCC,EAAAA,EAAAA,WAAS,GAAMC,GAAAC,EAAAA,EAAAA,SAAAH,EAAA,GAA1CQ,EAASN,EAAA,GAAEO,EAAYP,EAAA,GAC9BI,GAA8CL,EAAAA,EAAAA,UAAyB,MAAKM,GAAAJ,EAAAA,EAAAA,SAAAG,EAAA,GAArEsQ,EAAerQ,EAAA,GAAEsQ,EAAkBtQ,EAAA,GAC1CG,GAA8CT,EAAAA,EAAAA,WAAS,GAAKU,GAAAR,EAAAA,EAAAA,SAAAO,EAAA,GAArDoQ,EAAenQ,EAAA,GAAEoQ,EAAkBpQ,EAAA,IAG1CM,EAAAA,EAAAA,YAAU,WACR,IAAM+P,EAAY,eAAAvf,GAAAhG,EAAAA,EAAAA,UAAG,YACnB,IACEslB,GAAmB,GACnB,IAAME,QAAkBxO,IACxBoO,EAAmBI,GACnB9mB,EAAOqE,KAAK,yCAA0C,CAAEyiB,UAAAA,GAC1D,CAAE,MAAO7kB,GACPjC,EAAOiC,MAAM,yCAA0CA,GACvDykB,GAAmB,EACrB,CAAC,QACCE,GAAmB,EACrB,CACF,IAAC,kBAZiB,OAAAtf,EAAApF,MAAA,KAAAC,UAAA,KAclB0kB,GACF,GAAG,CAACvO,IAEJ,IAAMyO,EAAU,eAAApd,GAAArI,EAAAA,EAAAA,UAAG,YAKjB,GAAa,aAAT4kB,GAA4B,MAAJ3V,GAAAA,EAAMyW,OAIlC,GAAU,MAALxW,GAAAA,EAAOwW,OAAZ,CAMA,GAAa,aAATd,EAAqB,CACvB,IAAMe,EAAezW,EAAMwW,OAC3B,IAfiB,6BAeDE,KAAKD,GAEnB,YADO,MAAPZ,GAAAA,EAAU,gEAKZ,GAAIY,EAAazkB,OAAS,IAExB,YADO,MAAP6jB,GAAAA,EAAU,8BAGZ,GAAIY,EAAalkB,SAAS,MAExB,YADO,MAAPsjB,GAAAA,EAAU,iDAGd,CACA,GAAKxY,EAIL,GAAa,aAATqY,GAAuBrY,EAASrL,OAAS,EACpC,MAAP6jB,GAAAA,EAAU,mDADZ,CAIA,GAAa,aAATH,EAAqB,CACvB,GAAIrY,EAASrL,OAAS,IAEpB,YADO,MAAP6jB,GAAAA,EAAU,kDAGZ,IAAKF,EAEH,YADO,MAAPE,GAAAA,EAAU,gCAGd,CACA,GAAa,aAATH,GAAuBrY,IAAasY,EAKxC,GAAKM,EAKL,IACEnQ,GAAa,GAEbtW,EAAOqE,KAAK,mBAAmB6hB,EAAI,YAEtB,UAATA,QACIpO,EAAYtH,EAAO3C,SAEnBsK,EAAe5H,EAAOC,EAAO3C,GAG5B,MAATuY,GAAAA,GACF,CAAE,MAAOnkB,GACPjC,EAAOiC,MAAM,UAAUikB,EAAI,WAAYjkB,GAEvC,IAAIklB,EAAQ,4BAA+BjB,EAAI,sBAE1B,MAAjBjkB,EAAMoF,OACR8f,EAAW,+CACe,MAAjBllB,EAAMoF,OACXpF,EAAMW,SAAoC,kBAAlBX,EAAMW,QAChCukB,EAAWllB,EAAMW,QACRX,EAAMsH,QAAU7G,MAAM8G,QAAQvH,EAAMsH,UAC7C4d,EAAWllB,EAAMsH,OAAO1G,KAAK,OAEL,MAAjBZ,EAAMoF,QAAoC,wBAAlBpF,EAAMW,QACvCukB,EAAW,4EACe,MAAjBllB,EAAMoF,OACf8f,EAAW,6CACe,MAAjBllB,EAAMoF,QAAkBpF,EAAMW,QAAQG,SAAS,6BACxDokB,EAAW,oFACe,IAAjBllB,EAAMoF,OACf8f,EAAW,+EACFllB,EAAMW,UACfukB,EAAWllB,EAAMW,SAGZ,MAAPyjB,GAAAA,EAAUc,EACZ,CAAC,QACC7Q,GAAa,EACf,MA5CS,MAAP+P,GAAAA,EAAU,wDALH,MAAPA,GAAAA,EAAU,yBAZZ,MANS,MAAPA,GAAAA,EAAU,0BArBZ,MAFS,MAAPA,GAAAA,EAAU,wCAJH,MAAPA,GAAAA,EAAU,yBA+Fd,IAAC,kBArGe,OAAA1c,EAAAzH,MAAA,KAAAC,UAAA,KAuGVilB,EAAmBrN,GAAYyM,GAAenQ,GAAasQ,IAAoBF,EAErF,OAAIE,GAEA3B,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAO,CAAClE,EAAO0E,OAAQ1E,EAAO8E,eAAgBZ,GAAOtP,SAAA,EACzD4C,EAAAA,EAAAA,KAACgN,GAAAA,QAAiB,CAACxjB,KAAK,QAAQggB,MAAO1C,EAAMC,OAAO5E,SACpDnC,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO+E,WAAWnQ,SAAC,0BAKjC6Q,GASHjO,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CACfF,MAAO,CACLlE,EAAO0E,OACP0B,EAAmBpG,EAAO6E,eAAiB7E,EAAO4E,cAClDV,GAEFG,QAAS0B,EACThN,SAAUqN,EAAiBxR,SAE1BS,GAAamQ,GACZhO,EAAAA,EAAAA,KAACgN,GAAAA,QAAiB,CAACxjB,KAAK,QAAQggB,MAAO1C,EAAMC,OAAO5E,SAEpDnC,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO+E,WAAWnQ,SACnB,UAATsQ,EAAmB,UAAY,sBApBpC1N,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAO,CAAClE,EAAO0E,OAAQ1E,EAAO6E,eAAgBX,GAAOtP,UACzD4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAO,CAAClE,EAAO+E,WAAY/E,EAAOiF,cAAcrQ,SAAC,wBAwB/D,E,moBChLAyR,GAAWC,2BAIX,IAuKM7B,GAAY,SAACnG,GAAe,OAAK2B,EAAAA,QAAWxb,OAAO,CACvDyb,UAAW,CACTC,KAAM,EACNC,gBAAiB9B,EAAMC,OAAOpG,YAEhCoO,gBAAiB,CACfpG,KAAM,GAERqG,cAAe,CACbC,SAAU,EACV9F,QAASrC,EAAMvC,QAAQX,GACvBiF,WAAY/B,EAAMvC,QAAQV,IAE5BqL,YAAWxe,GAAAA,GAAA,CACTkY,gBAAiB9B,EAAMC,OAAOlG,KAC9B4D,aAAcqC,EAAMrC,aAAaZ,GACjCsF,QAASrC,EAAMvC,QAAQV,GACvBiH,aAAchE,EAAMvC,QAAQX,IACzBkD,EAAMnC,QAAQhB,IAAE,IACnBwL,YAAarI,EAAMb,WAAaa,EAAMC,OAAO9F,OAAS,cACtDmO,YAAatI,EAAMb,WAAa,EAAI,IAEtCoJ,cAAe,CACbpG,WAAY,UAEdqG,KAAM,CACJxK,MAAO,IACPC,OAAQ,IACR+F,aAAchE,EAAMvC,QAAQX,IAE9B/R,MAAO,CACLyX,SAAUxC,EAAM7D,WAAWO,UAAUO,KACrCwF,WAAY,OACZC,MAAO1C,EAAMC,OAAOjG,KACpB0J,WAAY1D,EAAM7D,WAAWC,aAAaI,KAC1CwH,aAAchE,EAAMvC,QAAQb,IAE9B6L,SAAU,CACRjG,SAAUxC,EAAM7D,WAAWO,UAAUI,GACrC4F,MAAO1C,EAAMC,OAAOhG,cACpByJ,WAAY1D,EAAM7D,WAAWC,aAAaC,QAC1C4H,UAAW,UAEbyE,SAAQ9e,GAAAA,GAAA,CACNkY,gBAAiB9B,EAAMC,OAAOlG,KAC9B4D,aAAcqC,EAAMrC,aAAaZ,GACjCsF,QAASrC,EAAMvC,QAAQV,GACvBiH,aAAchE,EAAMvC,QAAQX,IACzBkD,EAAMnC,QAAQhB,IAAE,IACnBwL,YAAarI,EAAMb,WAAaa,EAAMC,OAAO9F,OAAS,cACtDmO,YAAatI,EAAMb,WAAa,EAAI,IAEtCwJ,WAAY,CACV3E,aAAchE,EAAMvC,QAAQV,IAE9B6L,UAAW,CACTpG,SAAUxC,EAAM7D,WAAWO,UAAUM,IACrCyF,WAAY,OACZC,MAAO1C,EAAMC,OAAOjG,KACpB0J,WAAY1D,EAAM7D,WAAWC,aAAaI,KAC1CwH,aAAchE,EAAMvC,QAAQd,IAE9BkM,aAAc,CACZrG,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC6F,MAAO1C,EAAMC,OAAOhG,cACpByJ,WAAY1D,EAAM7D,WAAWC,aAAaC,SAE5CyM,eAAgB,CACd5G,cAAe,MACfC,WAAY,SACZL,gBAAiB9B,EAAMC,OAAO3F,WAC9BqD,aAAcqC,EAAMrC,aAAad,GACjCwF,QAASrC,EAAMvC,QAAQZ,GACvBmH,aAAchE,EAAMvC,QAAQX,GAC5BwL,YAAa,EACbD,YAAarI,EAAMC,OAAOtd,MAAQ,MAEpComB,UAAW,CACTrG,MAAO1C,EAAMC,OAAOtd,MACpB6f,SAAUxC,EAAM7D,WAAWO,UAAUE,GACrC8G,WAAY1D,EAAM7D,WAAWC,aAAaE,OAC1CoK,WAAY1G,EAAMvC,QAAQb,GAC1BiF,KAAM,GAERmH,eAAgB,CACdhF,aAAchE,EAAMvC,QAAQX,IAE9BmM,aAAc,CACZ/G,cAAe,MACfC,WAAY,SACZL,gBAAiB9B,EAAMC,OAAOvF,gBAC9BiD,aAAcqC,EAAMrC,aAAab,GACjCwL,YAAa,EACbD,YAAarI,EAAMC,OAAO9F,OAC1B6I,kBAAmBhD,EAAMvC,QAAQZ,GACjCoB,OAAQ,IAEViL,UAAW,CACTC,YAAanJ,EAAMvC,QAAQZ,IAE7BuM,MAAO,CACLvH,KAAM,EACNW,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC6G,WAAY1D,EAAM7D,WAAWC,aAAaC,QAC1CqG,MAAO1C,EAAMC,OAAOjG,MAEtBqP,QAAS,CACPhH,QAASrC,EAAMvC,QAAQd,IAEzB2M,YAAW1f,GAAA,CACTkY,gBAAiB9B,EAAMC,OAAOzG,QAC9BmE,aAAcqC,EAAMrC,aAAab,GACjCmB,OAAQ,GACRkE,WAAY,SACZC,eAAgB,SAChB4B,aAAchE,EAAMvC,QAAQX,IACzBkD,EAAMnC,QAAQjB,IAEnB2M,iBAAkB,CAChBrH,cAAe,MACfC,WAAY,SACZqH,eAAgBxJ,EAAMvC,QAAQX,IAEhC2M,YAAa,CACX5H,KAAM,EACN5D,OAAQ,EACR6D,gBAAiB9B,EAAMC,OAAO9F,QAEhCuP,YAAa,CACXzG,iBAAkBjD,EAAMvC,QAAQZ,GAChC2F,SAAUxC,EAAM7D,WAAWO,UAAUE,GACrC8F,MAAO1C,EAAMC,OAAOhG,cACpByJ,WAAY1D,EAAM7D,WAAWC,aAAaE,QAE5CqN,aAAY/f,GAAA,CACVsY,cAAe,MACfC,WAAY,SACZC,eAAgB,SAChBN,gBAAiB9B,EAAMC,OAAOnG,QAC9B6D,aAAcqC,EAAMrC,aAAab,GACjCmB,OAAQ,GACRqK,YAAa,EACbD,YAAarI,EAAMC,OAAO9F,QACvB6F,EAAMnC,QAAQjB,IAEnBgN,iBAAkB,CAChBpH,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC4F,WAAY,MACZC,MAAO1C,EAAMC,OAAOjG,KACpB0J,WAAY1D,EAAM7D,WAAWC,aAAaG,SAC1CmK,WAAY1G,EAAMvC,QAAQb,IAE5BiN,aAAYjgB,GAAAA,GAAA,CACVkY,gBAAiB9B,EAAMC,OAAOlG,KAC9B4D,aAAcqC,EAAMrC,aAAaZ,GACjCsF,QAASrC,EAAMvC,QAAQX,GACvBkH,aAAchE,EAAMvC,QAAQX,IACzBkD,EAAMnC,QAAQjB,IAAE,IACnByL,YAAarI,EAAMb,WAAaa,EAAMC,OAAO9F,OAAS,cACtDmO,YAAatI,EAAMb,WAAa,EAAI,IAEtC2K,aAAc,CACZtH,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC6F,MAAO1C,EAAMC,OAAOhG,cACpByJ,WAAY1D,EAAM7D,WAAWC,aAAaC,QAC1C4H,UAAW,SACXD,aAAchE,EAAMvC,QAAQZ,IAE9BkN,eAAgB,CACd7H,cAAe,MACfC,WAAY,SACZC,eAAgB,SAChBN,gBAAiB9B,EAAMC,OAAOxG,aAAe,KAC7CkE,aAAcqC,EAAMrC,aAAab,GACjCiG,gBAAiB/C,EAAMvC,QAAQZ,GAC/BmG,kBAAmBhD,EAAMvC,QAAQX,IAEnCkN,mBAAoB,CAClBxH,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC4F,WAAY,MACZC,MAAO1C,EAAMC,OAAOzG,QACpBkK,WAAY1D,EAAM7D,WAAWC,aAAaG,SAC1C4M,YAAanJ,EAAMvC,QAAQd,IAE7BsN,YAAa,CACX/H,cAAe,MACfC,WAAY,SACZC,eAAgB,SAChBN,gBAAiB9B,EAAMC,OAAOnG,QAC9B6D,aAAcqC,EAAMrC,aAAad,GACjCkG,gBAAiB/C,EAAMvC,QAAQb,GAC/BoG,kBAAmBhD,EAAMvC,QAAQZ,GACjC0G,UAAWvD,EAAMvC,QAAQX,GACzBoN,UAAW,UAEbC,gBAAiB,CACf3H,SAAUxC,EAAM7D,WAAWO,UAAUC,GACrC+F,MAAO1C,EAAMC,OAAOhG,cACpByJ,WAAY1D,EAAM7D,WAAWC,aAAaE,OAC1CoK,WAAY1G,EAAMvC,QAAQd,KAE3B,EAEH,SAlXoB,WAClB,IAAMyN,GAAaC,EAAAA,GAAAA,iBACAnD,EAAgB9N,KAA3BrC,UACAiJ,EAAUG,KAAVH,MACF0B,EAASyE,GAAUnG,GAEzBzJ,GAA0BC,EAAAA,EAAAA,UAAS,IAAGC,GAAAC,EAAAA,EAAAA,SAAAH,EAAA,GAA/BrF,EAAKuF,EAAA,GAAE6T,EAAQ7T,EAAA,GACtBI,GAAgCL,EAAAA,EAAAA,UAAS,IAAGM,GAAAJ,EAAAA,EAAAA,SAAAG,EAAA,GAArCtI,EAAQuI,EAAA,GAAEyT,EAAWzT,EAAA,GAC5BG,GAAkCT,EAAAA,EAAAA,WAAS,GAAMU,GAAAR,EAAAA,EAAAA,SAAAO,EAAA,GAA1CF,EAASG,EAAA,GAChBG,GAD8BH,EAAA,IACUV,EAAAA,EAAAA,WAAS,IAAMc,GAAAZ,EAAAA,EAAAA,SAAAW,EAAA,GAAhDmT,EAAYlT,EAAA,GAAEmT,EAAenT,EAAA,GACpCoT,GAAwClU,EAAAA,EAAAA,UAAwB,MAAKmU,GAAAjU,EAAAA,EAAAA,SAAAgU,EAAA,GAA9DtgB,EAAYugB,EAAA,GAAEC,EAAeD,EAAA,GACpCE,GAA0CrU,EAAAA,EAAAA,WAAS,GAAMsU,GAAApU,EAAAA,EAAAA,SAAAmU,EAAA,GAAlDE,EAAaD,EAAA,GAAEE,EAAgBF,EAAA,IAMtCtT,EAAAA,EAAAA,YAAU,WACJpN,GACFwgB,EAAgB,KAEpB,GAAG,CAAC1Z,EAAO3C,IAEX,IAAM0c,EAAiB,eAAA7jB,GAAApF,EAAAA,EAAAA,UAAG,YACxB4oB,EAAgB,6HAClB,IAAC,kBAFsB,OAAAxjB,EAAAxE,MAAA,KAAAC,UAAA,KAYvB,OACE6iB,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOE,UAAUtL,SAAA,EAC5BoP,EAAAA,EAAAA,MAACtF,GAAc,CACbwF,MAAOlE,EAAOuG,gBACdxH,sBAAuBiB,EAAOwG,cAC9B3G,0BAA0B,UAC1BD,8BAA8B,EAAMhL,SAAA,EAGpCoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAO0G,YAAY9R,SAAA,EAC9B4C,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAO6G,cAAcjS,UAChC4C,EAAAA,EAAAA,KAACgS,GAAAA,QAAK,CAACC,OAAQ3C,GAAM5C,MAAOlE,EAAO8G,KAAM4C,WAAW,eAEtDlS,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO3W,MAAMuL,SAAC,YAC3B4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO+G,SAASnS,SAAC,sCAIhCoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOgH,SAASpS,SAAA,EAC3BoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOiH,WAAWrS,SAAA,EAC7B4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOkH,UAAUtS,SAAC,aAC/B4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOmH,aAAavS,SAAC,qDAGnClM,IACCsb,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOoH,eAAexS,SAAA,EACjC4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,uBAAuBvO,KAAM,GAAIggB,MAAO1C,EAAMC,OAAOtd,SACpEuW,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOqH,UAAUzS,SAAElM,QAIpC8O,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAOsH,eAAe1S,UACjCoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOuH,aAAa3S,SAAA,EAC/B4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,eAAevO,KAAM,GAAIggB,MAAO1C,EAAMC,OAAOhG,cAAe2L,MAAOlE,EAAOwH,aACzFhQ,EAAAA,EAAAA,KAACmS,GAAAA,QAAS,CACRzF,MAAOlE,EAAO0H,MACdkC,YAAY,gBACZxpB,MAAOoP,EACPqa,aAAcjB,EACdkB,aAAa,gBACbC,eAAe,OACfC,aAAa,EACbC,qBAAsB3L,EAAMC,OAAO/F,qBAKzChB,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAOsH,eAAe1S,UACjCoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOuH,aAAa3S,SAAA,EAC/B4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,sBAAsBvO,KAAM,GAAIggB,MAAO1C,EAAMC,OAAOhG,cAAe2L,MAAOlE,EAAOwH,aAChGhQ,EAAAA,EAAAA,KAACmS,GAAAA,QAAS,CACRzF,MAAOlE,EAAO0H,MACdkC,YAAY,WACZxpB,MAAOyM,EACPgd,aAAchB,EACdqB,iBAAkBpB,EAClBiB,eAAe,OACfC,aAAa,EACbC,qBAAsB3L,EAAMC,OAAO/F,gBAErChB,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CACfC,QAAS,WAAF,OAAQ0E,GAAiBD,EAAa,EAC7C5E,MAAOlE,EAAO2H,QAAQ/S,UAEtB4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CACP/U,KAAMuZ,EAAe,kBAAoB,cACzC9nB,KAAM,GACNggB,MAAO1C,EAAMC,OAAOhG,wBAM5Bf,EAAAA,EAAAA,KAAC2S,GAAgB,CACfjF,KAAK,QACL1V,MAAOA,EACP3C,SAAUA,EACVuY,UAAW,WAETpmB,EAAOqE,KAAK,8BACd,EACAgiB,QAAS,SAACpkB,GACRioB,EAAgBjoB,EAClB,EACA8X,UAAWvJ,IAAU3C,GAAYwI,GAAamQ,EAC9CtB,MAAOlE,EAAO4H,eAGhB5D,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAO6H,iBAAiBjT,SAAA,EACnC4C,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAO+H,eACpBvQ,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOgI,YAAYpT,SAAC,QACjC4C,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAO+H,kBAGtB/D,EAAAA,EAAAA,MAACI,GAAAA,QAAgB,CACfF,MAAOlE,EAAOiI,aACd5D,QAASkF,EACTxQ,SAAU1D,GAAamQ,EAAY5Q,SAAA,EAEnC4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,cAAcvO,KAAM,GAAIggB,MAAM,aAC7CxJ,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOkI,iBAAiBtT,SAAC,gCAK1CoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOmI,aAAavT,SAAA,EAC/B4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOoI,aAAaxT,SAAC,4BAClCoP,EAAAA,EAAAA,MAACI,GAAAA,QAAgB,CAACC,QAnHC,WACzBqE,EAAW0B,SAAS,OAAQ,CAAEC,OAAQ,YACxC,EAiHuDnG,MAAOlE,EAAOqI,eAAezT,SAAA,EAC1E4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOsI,mBAAmB1T,SAAC,oBACxC4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,gBAAgBvO,KAAM,GAAIggB,MAAO1C,EAAMC,OAAOzG,iBAlIzDhY,MAiJV0X,EAAAA,EAAAA,KAAC8S,GAAS,CACRxH,QAASuG,EACTtG,QAAS,WAAF,OAAQuG,GAAiB,EAAM,MAI9C,E,+kBC7KAjD,GAAWC,2BAIX,IAyPM7B,GAAY,SAACnG,GAAe,OAAK2B,EAAAA,QAAWxb,OAAO,CACvDyb,UAAW,CACTC,KAAM,EACNC,gBAAiB9B,EAAMC,OAAOpG,YAEhCoO,gBAAiB,CACfpG,KAAM,GAERqG,cAAe,CACbC,SAAU,EACV9F,QAASrC,EAAMvC,QAAQX,GACvBiF,WAAY/B,EAAMvC,QAAQV,IAE5BkP,gBAAiB,CACf/J,cAAe,MACfC,WAAY,SACZ6B,aAAchE,EAAMvC,QAAQX,IAE9BoP,WAAUtiB,GAAA,CACRoU,MAAO,GACPC,OAAQ,GACRN,aAAc,GACdmE,gBAAiB9B,EAAMC,OAAOnG,QAC9BqI,WAAY,SACZC,eAAgB,UACbpC,EAAMnC,QAAQjB,IAEnBwL,YAAWxe,GAAAA,GAAA,CACTkY,gBAAiB9B,EAAMC,OAAOlG,KAC9B4D,aAAcqC,EAAMrC,aAAaZ,GACjCsF,QAASrC,EAAMvC,QAAQV,GACvBiH,aAAchE,EAAMvC,QAAQX,IACzBkD,EAAMnC,QAAQhB,IAAE,IACnBwL,YAAarI,EAAMb,WAAaa,EAAMC,OAAO9F,OAAS,cACtDmO,YAAatI,EAAMb,WAAa,EAAI,IAEtCoJ,cAAe,CACbpG,WAAY,UAEdgK,WAAY,CACVnO,MAAO,GACPC,OAAQ,GACRN,aAAc,GACdmE,gBAAiB9B,EAAMC,OAAOxG,aAAe,KAC7C0I,WAAY,SACZC,eAAgB,SAChB4B,aAAchE,EAAMvC,QAAQX,IAE9BsP,QAAS,CACP5J,SAAUxC,EAAM7D,WAAWO,UAAUO,KACrCwF,WAAY,OACZC,MAAO1C,EAAMC,OAAOjG,KACpB0J,WAAY1D,EAAM7D,WAAWC,aAAaI,KAC1CwH,aAAchE,EAAMvC,QAAQb,IAE9ByP,QAAS,CACP7J,SAAUxC,EAAM7D,WAAWO,UAAUI,GACrC4F,MAAO1C,EAAMC,OAAOhG,cACpByJ,WAAY1D,EAAM7D,WAAWC,aAAaC,QAC1C4H,UAAW,UAEbyE,SAAQ9e,GAAAA,GAAA,CACNkY,gBAAiB9B,EAAMC,OAAOlG,KAC9B4D,aAAcqC,EAAMrC,aAAaZ,GACjCsF,QAASrC,EAAMvC,QAAQV,GACvBiH,aAAchE,EAAMvC,QAAQX,IACzBkD,EAAMnC,QAAQhB,IAAE,IACnBwL,YAAarI,EAAMb,WAAaa,EAAMC,OAAO9F,OAAS,cACtDmO,YAAatI,EAAMb,WAAa,EAAI,IAEtCwJ,WAAY,CACV3E,aAAchE,EAAMvC,QAAQV,IAE9B6L,UAAW,CACTpG,SAAUxC,EAAM7D,WAAWO,UAAUM,IACrCyF,WAAY,OACZC,MAAO1C,EAAMC,OAAOjG,KACpB0J,WAAY1D,EAAM7D,WAAWC,aAAaI,KAC1CwH,aAAchE,EAAMvC,QAAQd,IAE9BkM,aAAc,CACZrG,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC6F,MAAO1C,EAAMC,OAAOhG,cACpByJ,WAAY1D,EAAM7D,WAAWC,aAAaC,SAE5CyM,eAAgB,CACd5G,cAAe,MACfC,WAAY,SACZL,gBAAiB9B,EAAMC,OAAO3F,WAC9BqD,aAAcqC,EAAMrC,aAAad,GACjCwF,QAASrC,EAAMvC,QAAQZ,GACvBmH,aAAchE,EAAMvC,QAAQX,GAC5BwL,YAAa,EACbD,YAAarI,EAAMC,OAAOtd,MAAQ,MAEpComB,UAAW,CACTrG,MAAO1C,EAAMC,OAAOtd,MACpB6f,SAAUxC,EAAM7D,WAAWO,UAAUE,GACrC8G,WAAY1D,EAAM7D,WAAWC,aAAaE,OAC1CoK,WAAY1G,EAAMvC,QAAQb,GAC1BiF,KAAM,GAERyK,iBAAkB,CAChBpK,cAAe,MACfC,WAAY,SACZL,gBAAiB9B,EAAMC,OAAO1F,cAAgByF,EAAMC,OAAO3P,QAAU,KACrEqN,aAAcqC,EAAMrC,aAAad,GACjCwF,QAASrC,EAAMvC,QAAQZ,GACvBmH,aAAchE,EAAMvC,QAAQX,GAC5BwL,YAAa,EACbD,YAAarI,EAAMC,OAAO3P,QAAU,MAEtCic,YAAa,CACX7J,MAAO1C,EAAMC,OAAO3P,QACpBkS,SAAUxC,EAAM7D,WAAWO,UAAUE,GACrC8G,WAAY1D,EAAM7D,WAAWC,aAAaE,OAC1C0H,aAAchE,EAAMvC,QAAQb,IAE9B4P,qBAAsB,CACpB3K,KAAM,EACN6E,WAAY1G,EAAMvC,QAAQb,IAE5B6P,oBAAqB,CACnBvK,cAAe,MACfC,WAAY,SACZoB,UAAWvD,EAAMvC,QAAQd,IAE3B+P,eAAgB,CACdhK,MAAO1C,EAAMC,OAAOzG,QACpBgJ,SAAUxC,EAAM7D,WAAWO,UAAUE,GACrC8G,WAAY1D,EAAM7D,WAAWC,aAAaE,OAC1C6M,YAAanJ,EAAMvC,QAAQd,IAE7BqM,eAAgB,CACdhF,aAAchE,EAAMvC,QAAQX,IAE9BmM,aAAc,CACZ/G,cAAe,MACfC,WAAY,SACZL,gBAAiB9B,EAAMC,OAAOvF,gBAC9BiD,aAAcqC,EAAMrC,aAAab,GACjCwL,YAAa,EACbD,YAAarI,EAAMC,OAAO9F,OAC1B6I,kBAAmBhD,EAAMvC,QAAQZ,GACjCoB,OAAQ,IAEViL,UAAW,CACTC,YAAanJ,EAAMvC,QAAQZ,IAE7BuM,MAAO,CACLvH,KAAM,EACNW,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC6G,WAAY1D,EAAM7D,WAAWC,aAAaC,QAC1CqG,MAAO1C,EAAMC,OAAOjG,MAEtBqP,QAAS,CACPhH,QAASrC,EAAMvC,QAAQd,IAEzBgQ,qBAAsB,CACpB7K,gBAAiB9B,EAAMC,OAAOnG,QAC9B6D,aAAcqC,EAAMrC,aAAad,GACjCwF,QAASrC,EAAMvC,QAAQZ,GACvBmH,aAAchE,EAAMvC,QAAQX,GAC5BwL,YAAa,EACbD,YAAarI,EAAMC,OAAO9F,QAE5ByS,kBAAmB,CACjBpK,SAAUxC,EAAM7D,WAAWO,UAAUE,GACrC6F,WAAY,MACZC,MAAO1C,EAAMC,OAAOjG,KACpB0J,WAAY1D,EAAM7D,WAAWC,aAAaG,SAC1CyH,aAAchE,EAAMvC,QAAQb,IAE9BiQ,gBAAiB,CACf3K,cAAe,MACfC,WAAY,SACZ6B,aAAchE,EAAMvC,QAAQd,IAE9BmQ,gBAAiB,CACftK,SAAUxC,EAAM7D,WAAWO,UAAUE,GACrC8G,WAAY1D,EAAM7D,WAAWC,aAAaC,QAC1CqK,WAAY1G,EAAMvC,QAAQb,IAE5BmN,eAAcngB,GAAA,CACZkY,gBAAiB9B,EAAMC,OAAOzG,QAC9BmE,aAAcqC,EAAMrC,aAAab,GACjCmB,OAAQ,GACRkE,WAAY,SACZC,eAAgB,SAChB4B,aAAchE,EAAMvC,QAAQX,IACzBkD,EAAMnC,QAAQjB,IAEnB2M,iBAAkB,CAChBrH,cAAe,MACfC,WAAY,SACZqH,eAAgBxJ,EAAMvC,QAAQX,IAEhC2M,YAAa,CACX5H,KAAM,EACN5D,OAAQ,EACR6D,gBAAiB9B,EAAMC,OAAO9F,QAEhCuP,YAAa,CACXzG,iBAAkBjD,EAAMvC,QAAQZ,GAChC2F,SAAUxC,EAAM7D,WAAWO,UAAUE,GACrC8F,MAAO1C,EAAMC,OAAOhG,cACpByJ,WAAY1D,EAAM7D,WAAWC,aAAaE,QAE5CqN,aAAY/f,GAAA,CACVsY,cAAe,MACfC,WAAY,SACZC,eAAgB,SAChBN,gBAAiB9B,EAAMC,OAAOnG,QAC9B6D,aAAcqC,EAAMrC,aAAab,GACjCmB,OAAQ,GACRqK,YAAa,EACbD,YAAarI,EAAMC,OAAO9F,QACvB6F,EAAMnC,QAAQjB,IAEnBgN,iBAAkB,CAChBpH,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC4F,WAAY,MACZC,MAAO1C,EAAMC,OAAOjG,KACpB0J,WAAY1D,EAAM7D,WAAWC,aAAaG,SAC1CmK,WAAY1G,EAAMvC,QAAQb,IAE5BmQ,UAASnjB,GAAAA,GAAA,CACPkY,gBAAiB9B,EAAMC,OAAOlG,KAC9B4D,aAAcqC,EAAMrC,aAAaZ,GACjCsF,QAASrC,EAAMvC,QAAQX,GACvBkH,aAAchE,EAAMvC,QAAQX,IACzBkD,EAAMnC,QAAQjB,IAAE,IACnByL,YAAarI,EAAMb,WAAaa,EAAMC,OAAO9F,OAAS,cACtDmO,YAAatI,EAAMb,WAAa,EAAI,IAEtC6N,UAAW,CACTxK,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC6F,MAAO1C,EAAMC,OAAOhG,cACpByJ,WAAY1D,EAAM7D,WAAWC,aAAaC,QAC1C4H,UAAW,SACXD,aAAchE,EAAMvC,QAAQZ,IAE9ByM,YAAa,CACXpH,cAAe,MACfC,WAAY,SACZC,eAAgB,SAChBN,gBAAiB9B,EAAMC,OAAOxG,aAAe,KAC7CkE,aAAcqC,EAAMrC,aAAab,GACjCiG,gBAAiB/C,EAAMvC,QAAQZ,GAC/BmG,kBAAmBhD,EAAMvC,QAAQX,IAEnCmQ,gBAAiB,CACfzK,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC4F,WAAY,MACZC,MAAO1C,EAAMC,OAAOzG,QACpBkK,WAAY1D,EAAM7D,WAAWC,aAAaG,SAC1C4M,YAAanJ,EAAMvC,QAAQd,KAE5B,EAEH,SA7fuB,WACrB,IAAMyN,GAAaC,EAAAA,GAAAA,iBACAnD,EAAgB9N,KAA3BrC,UACAiJ,EAAUG,KAAVH,MACF0B,EAASyE,GAAUnG,IAGzBxI,EAAAA,EAAAA,YAAU,WAER,OADAvV,QAAQC,IAAI,0BACL,WACLD,QAAQC,IAAI,2BACd,CACF,GAAG,IAEH,IAAAqU,GAAwBC,EAAAA,EAAAA,UAAS,IAAGC,GAAAC,EAAAA,EAAAA,SAAAH,EAAA,GAA7BtF,EAAIwF,EAAA,GAAEyW,EAAOzW,EAAA,GACpBI,GAA0BL,EAAAA,EAAAA,UAAS,IAAGM,GAAAJ,EAAAA,EAAAA,SAAAG,EAAA,GAA/B3F,EAAK4F,EAAA,GAAEwT,EAAQxT,EAAA,GACtBG,GAAgCT,EAAAA,EAAAA,UAAS,IAAGU,GAAAR,EAAAA,EAAAA,SAAAO,EAAA,GAArC1I,EAAQ2I,EAAA,GAAEqT,EAAWrT,EAAA,GAC5BG,GAA8Cb,EAAAA,EAAAA,UAAS,IAAGc,GAAAZ,EAAAA,EAAAA,SAAAW,EAAA,GAAnDwP,EAAevP,EAAA,GAAE6V,EAAkB7V,EAAA,GAC1CoT,GAAkClU,EAAAA,EAAAA,WAAS,GAAMmU,GAAAjU,EAAAA,EAAAA,SAAAgU,EAAA,GAA1C3T,EAAS4T,EAAA,GAChBE,GAD8BF,EAAA,IACUnU,EAAAA,EAAAA,WAAS,IAAMsU,GAAApU,EAAAA,EAAAA,SAAAmU,EAAA,GAAhDL,EAAYM,EAAA,GAAEL,EAAeK,EAAA,GACpCsC,GAAwC5W,EAAAA,EAAAA,UAAwB,MAAK6W,GAAA3W,EAAAA,EAAAA,SAAA0W,EAAA,GAA9DhjB,EAAYijB,EAAA,GAAEzC,EAAeyC,EAAA,GACpCC,GAA4C9W,EAAAA,EAAAA,UAAwB,MAAK+W,GAAA7W,EAAAA,EAAAA,SAAA4W,EAAA,GAAlEE,EAAcD,EAAA,GAAEE,EAAiBF,EAAA,IAGxC/V,EAAAA,EAAAA,YAAU,WACJpN,GACFwgB,EAAgB,MAEd4C,GACFC,EAAkB,KAEtB,GAAG,CAACxc,EAAMC,EAAO3C,EAAUsY,IAE3B,IAAM6G,EAAoB,eAAAtmB,GAAApF,EAAAA,EAAAA,UAAG,YAC3B4oB,EAAgB,0HAClB,IAAC,kBAFyB,OAAAxjB,EAAAxE,MAAA,KAAAC,UAAA,KAIpB8qB,EAAkB,WACtBvD,EAAW0B,SAAS,OAAQ,CAAEC,OAAQ,SACxC,EAKA,OACE7S,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAOE,UAAUtL,UAC5BoP,EAAAA,EAAAA,MAACtF,GAAc,CACbwF,MAAOlE,EAAOuG,gBACdxH,sBAAuBiB,EAAOwG,cAC9B3G,0BAA0B,UAC1BD,8BAA8B,EAAMhL,SAAA,EAGpC4C,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAOuK,gBAAgB3V,UAClC4C,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CACfF,MAAOlE,EAAOwK,WACdnG,QAAS4H,EAAgBrX,UAEzB4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,aAAavO,KAAM,GAAIggB,MAAO1C,EAAMC,OAAOjG,YAK9Dd,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAO0G,YAAY9R,UAC9BoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAO6G,cAAcjS,SAAA,EAChC4C,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAOyK,WAAW7V,UAC7B4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,aAAavO,KAAM,GAAIggB,MAAO1C,EAAMC,OAAOzG,aAE5DN,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO0K,QAAQ9V,SAAC,oBAC7B4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO2K,QAAQ/V,SAAC,oDAKjCoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOgH,SAASpS,SAAA,EAC3BoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOiH,WAAWrS,SAAA,EAC7B4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOkH,UAAUtS,SAAC,aAC/B4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOmH,aAAavS,SAAC,+CAGnClM,IACCsb,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOoH,eAAexS,SAAA,EACjC4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,uBAAuBvO,KAAM,GAAIggB,MAAO1C,EAAMC,OAAOtd,SACpEuW,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOqH,UAAUzS,SAAElM,OAInCojB,IACC9H,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAO4K,iBAAiBhW,SAAA,EACnC4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,2BAA2BvO,KAAM,GAAIggB,MAAO1C,EAAMC,OAAO3P,WACxEoV,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAO8K,qBAAqBlW,SAAA,EACvC4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO6K,YAAYjW,SAAEkX,KAClC9H,EAAAA,EAAAA,MAACI,GAAAA,QAAgB,CAACC,QAAS4H,EAAiB/H,MAAOlE,EAAO+K,oBAAoBnW,SAAA,EAC5E4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOgL,eAAepW,SAAC,iBACpC4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,gBAAgBvO,KAAM,GAAIggB,MAAO1C,EAAMC,OAAOzG,oBAMrEN,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAOsH,eAAe1S,UACjCoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOuH,aAAa3S,SAAA,EAC/B4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,iBAAiBvO,KAAM,GAAIggB,MAAO1C,EAAMC,OAAOhG,cAAe2L,MAAOlE,EAAOwH,aAC3FhQ,EAAAA,EAAAA,KAACmS,GAAAA,QAAS,CACRzF,MAAOlE,EAAO0H,MACdkC,YAAY,OACZxpB,MAAOmP,EACPsa,aAAc2B,EACdzB,eAAe,QACfC,aAAa,EACbC,qBAAsB3L,EAAMC,OAAO/F,qBAKzChB,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAOsH,eAAe1S,UACjCoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOuH,aAAa3S,SAAA,EAC/B4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,eAAevO,KAAM,GAAIggB,MAAO1C,EAAMC,OAAOhG,cAAe2L,MAAOlE,EAAOwH,aACzFhQ,EAAAA,EAAAA,KAACmS,GAAAA,QAAS,CACRzF,MAAOlE,EAAO0H,MACdkC,YAAY,gBACZxpB,MAAOoP,EACPqa,aAAcjB,EACdkB,aAAa,gBACbC,eAAe,OACfC,aAAa,EACbC,qBAAsB3L,EAAMC,OAAO/F,qBAKzChB,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAOsH,eAAe1S,UACjCoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOuH,aAAa3S,SAAA,EAC/B4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,sBAAsBvO,KAAM,GAAIggB,MAAO1C,EAAMC,OAAOhG,cAAe2L,MAAOlE,EAAOwH,aAChGhQ,EAAAA,EAAAA,KAACmS,GAAAA,QAAS,CACRzF,MAAOlE,EAAO0H,MACdkC,YAAY,WACZxpB,MAAOyM,EACPgd,aAAchB,EACdqB,iBAAkBpB,EAClBiB,eAAe,OACfC,aAAa,EACbC,qBAAsB3L,EAAMC,OAAO/F,gBAErChB,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CACfC,QAAS,WAAF,OAAQ0E,GAAiBD,EAAa,EAC7C5E,MAAOlE,EAAO2H,QAAQ/S,UAEtB4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CACP/U,KAAMuZ,EAAe,kBAAoB,cACzC9nB,KAAM,GACNggB,MAAO1C,EAAMC,OAAOhG,wBAM5Bf,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAOsH,eAAe1S,UACjCoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOuH,aAAa3S,SAAA,EAC/B4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,sBAAsBvO,KAAM,GAAIggB,MAAO1C,EAAMC,OAAOhG,cAAe2L,MAAOlE,EAAOwH,aAChGhQ,EAAAA,EAAAA,KAACmS,GAAAA,QAAS,CACRzF,MAAOlE,EAAO0H,MACdkC,YAAY,mBACZxpB,MAAO+kB,EACP0E,aAAc4B,EACdvB,iBAAkBpB,EAClBiB,eAAe,OACfC,aAAa,EACbC,qBAAsB3L,EAAMC,OAAO/F,qBAMzCwL,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOiL,qBAAqBrW,SAAA,EACvC4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOkL,kBAAkBtW,SAAC,4BACvCoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOmL,gBAAgBvW,SAAA,EAClC4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CACP/U,KAAM1C,EAASrL,QAAU,EAAI,mBAAqB,kBAClDR,KAAM,GACNggB,MAAOnU,EAASrL,QAAU,EAAI8c,EAAMC,OAAO3P,QAAU0P,EAAMC,OAAO/F,gBAEpEhB,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAO,CAAClE,EAAOoL,gBAAiB,CAAEpK,MAAOnU,EAASrL,QAAU,EAAI8c,EAAMC,OAAO3P,QAAU0P,EAAMC,OAAO/F,eAAgB5D,SAAC,8BAI7HoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOmL,gBAAgBvW,SAAA,EAClC4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CACP/U,KAAM1C,IAAasY,GAAmBtY,EAASrL,OAAS,EAAI,mBAAqB,kBACjFR,KAAM,GACNggB,MAAOnU,IAAasY,GAAmBtY,EAASrL,OAAS,EAAI8c,EAAMC,OAAO3P,QAAU0P,EAAMC,OAAO/F,gBAEnGhB,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAO,CAAClE,EAAOoL,gBAAiB,CAAEpK,MAAOnU,IAAasY,GAAmBtY,EAASrL,OAAS,EAAI8c,EAAMC,OAAO3P,QAAU0P,EAAMC,OAAO/F,eAAgB5D,SAAC,2BAM9J4C,EAAAA,EAAAA,KAAC2S,GAAgB,CACfjF,KAAK,WACL3V,KAAMA,EACNC,MAAOA,EACP3C,SAAUA,EACVsY,gBAAiBA,EACjBC,UAAW,WAET8D,EAAgB,MAChB6C,EAAkB,4EAClBxrB,QAAQC,IAAI,4CACd,EACA6kB,QAAS,SAACpkB,GAERV,QAAQC,IAAI,sCAAuCS,GACnD8qB,EAAkB,MAClB7C,EAAgBjoB,EAClB,EACA8X,SAAU1D,GAAamQ,KAAiBsG,EACxC5H,MAAOlE,EAAOqI,kBAGhBrE,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAO6H,iBAAiBjT,SAAA,EACnC4C,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAO+H,eACpBvQ,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOgI,YAAYpT,SAAC,QACjC4C,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAO+H,kBAGtB/D,EAAAA,EAAAA,MAACI,GAAAA,QAAgB,CACfF,MAAOlE,EAAOiI,aACd5D,QAAS2H,EACTjT,SAAU1D,GAAamQ,EAAY5Q,SAAA,EAEnC4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,cAAcvO,KAAM,GAAIggB,MAAM,aAC7CxJ,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOkI,iBAAiBtT,SAAC,gCAK1CoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOqL,UAAUzW,SAAA,EAC5B4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOsL,UAAU1W,SAAC,8BAC/BoP,EAAAA,EAAAA,MAACI,GAAAA,QAAgB,CAACC,QAAS4H,EAAiB/H,MAAOlE,EAAO4H,YAAYhT,SAAA,EACpE4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOuL,gBAAgB3W,SAAC,aACrC4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,gBAAgBvO,KAAM,GAAIggB,MAAO1C,EAAMC,OAAOzG,oBAMzE,EC5QA,IAAMoU,IAAQC,EAAAA,GAAAA,WAgBd,SAdsB,WACpB,OACEnI,EAAAA,EAAAA,MAACkI,GAAME,UAAS,CACdC,iBAAiB,WACjBC,cAAe,CACbC,aAAa,GACb3X,SAAA,EAEF4C,EAAAA,EAAAA,KAAC0U,GAAMM,OAAM,CAACjd,KAAK,QAAQkd,UAAWC,MACtClV,EAAAA,EAAAA,KAAC0U,GAAMM,OAAM,CAACjd,KAAK,WAAWkd,UAAWE,OAG/C,E,oQCkKA,SADmC,KAhKkB1tB,EAAAA,EAAAA,UAR5B,SAAA2tB,KAAAztB,EAAAA,EAAAA,SAAA,KAAAytB,GAAA,KACfC,MAA2B,CACjCC,oBAAoB,EACpBC,qBAAqB,EACrBC,aAAa,EACbC,gBAAiB,GACjB,KAEMC,eAAuC,IAAK,GAAD,EAAA/sB,IAAA,qBAAAC,MAAA,eAAA+sB,GAAA7sB,EAAAA,EAAAA,UAKnD,YAEE,GAAIjB,KAAK6tB,qBACD7tB,KAAK6tB,oBAMb,GAAI7tB,KAAKwtB,MAAMG,aAAgBhrB,KAAKorB,MAAQ/tB,KAAKwtB,MAAMI,gBADnC,IAElBjuB,EAAOmE,MAAM,yDADf,CAMA9D,KAAK6tB,eAAiB7tB,KAAKguB,iBAE3B,UACQhuB,KAAK6tB,cACb,CAAC,QACC7tB,KAAK6tB,eAAiB,IACxB,CATA,CAUF,IAtBwB,OAsBvB,WAtBuB,OAAAC,EAAAjsB,MAAC,KAADC,UAAA,EAL2B,IAK3B,CAAAhB,IAAA,iBAAAC,MAAA,eAAAktB,GAAAhtB,EAAAA,EAAAA,UA2BxB,YACEtB,EAAOqE,KAAK,oCACZ,IAAMkqB,EAAYvrB,KAAKorB,MAEvB,UAEQ/tB,KAAKmuB,2BAGLnuB,KAAKouB,mBAEXpuB,KAAKwtB,MAAMG,aAAc,EACzB3tB,KAAKwtB,MAAMI,gBAAkBjrB,KAAKorB,MAElC,IAAMxQ,EAAW5a,KAAKorB,MAAQG,EAC9BvuB,EAAOqE,KAAK,qCAAqCuZ,EAAQ,KAC3D,CAAE,MAAO3b,GAGP,MAFAjC,EAAOiC,MAAM,+BAAgCA,GAC7C5B,KAAKwtB,MAAMG,aAAc,EACnB/rB,CACR,CACF,IArB4B,OAqB3B,WArB2B,OAAAqsB,EAAApsB,MAAC,KAADC,UAAA,EA3BJ,IA2BI,CAAAhB,IAAA,qBAAAC,MAAA,eAAAstB,GAAAptB,EAAAA,EAAAA,UA0B5B,YACE,IAKE,GAJAtB,EAAOmE,MAAM,2CAGiBwqB,GAAAA,2BACTC,QAGnB,OAFA5uB,EAAOsC,KAAK,yDACZjC,KAAKwtB,MAAMC,oBAAqB,GAIlCztB,KAAKwtB,MAAMC,oBAAqB,EAChC9tB,EAAOmE,MAAM,2CACf,CAAE,MAAOlC,GAGP,MAFAjC,EAAOiC,MAAM,uCAAwCA,GACrD5B,KAAKwtB,MAAMC,oBAAqB,EAC1B7rB,CACR,CACF,IAnBgC,OAmB/B,WAnB+B,OAAAysB,EAAAxsB,MAAC,KAADC,UAAA,EA1BJ,IA0BI,CAAAhB,IAAA,mBAAAC,MAAA,eAAAytB,GAAAvtB,EAAAA,EAAAA,UAwBhC,YACE,IACEtB,EAAOmE,MAAM,gDAEPwqB,GAAMG,kBAAkB,CAC5BC,oBAAoB,EACpBC,sBAAsB,EACtBC,mBAAmB,EACnBC,4BAA4B,EAC5BC,yBAAyB,IAG3B9uB,KAAKwtB,MAAME,qBAAsB,EACjC/tB,EAAOmE,MAAM,oCACf,CAAE,MAAOlC,GAGP,MAFAjC,EAAOiC,MAAM,gCAAiCA,GAC9C5B,KAAKwtB,MAAME,qBAAsB,EAC3B9rB,CACR,CACF,IAnB8B,OAmB7B,WAnB6B,OAAA4sB,EAAA3sB,MAAC,KAADC,UAAA,EAxBE,IAwBF,CAAAhB,IAAA,kBAAAC,MAwB9B,WACE,O,6WAAA8H,CAAA,GAAY7I,KAAKwtB,MACnB,GAAC,CAAA1sB,IAAA,sBAAAC,MAKD,WACE,OAAOf,KAAKwtB,MAAMC,oBAAsBztB,KAAKwtB,MAAME,mBACrD,GAAC,CAAA5sB,IAAA,iBAAAC,MAAA,eAAAguB,GAAA9tB,EAAAA,EAAAA,UAKD,YACEjB,KAAKwtB,MAAMG,aAAc,EACzB3tB,KAAKwtB,MAAMI,gBAAkB,QACvB5tB,KAAKgvB,oBACb,IAJoB,OAInB,WAJmB,OAAAD,EAAAltB,MAAC,KAADC,UAAA,EALnB,IAKmB,CAAAhB,IAAA,wBAAAC,MASpB,WAME,IAAMgtB,EAAMprB,KAAKorB,MACjB,MAAO,CACLJ,YAAa3tB,KAAKwtB,MAAMG,YACxBC,gBAAiB5tB,KAAKwtB,MAAMI,gBAC5BqB,qBAAsBjvB,KAAKwtB,MAAMI,gBAAkB,EAAIG,EAAM/tB,KAAKwtB,MAAMI,iBAAmB,EAC3FsB,kBAAmBlvB,KAAKmvB,sBAE5B,GAAC,CAAAruB,IAAA,UAAAC,MAKD,WACEf,KAAKwtB,MAAQ,CACXC,oBAAoB,EACpBC,qBAAqB,EACrBC,aAAa,EACbC,gBAAiB,GAEnB5tB,KAAK6tB,eAAiB,KACtBluB,EAAOmE,MAAM,mCACf,M,0BC1KWsrB,GAAwC,CAEnD,CAAE5rB,KAAM,OAAQ0M,KAAM,eAGtB,CAAE1M,KAAM,QAAS0M,KAAM,UAAWmf,OAAQ,iBAC1C,CAAE7rB,KAAM,QAAS0M,KAAM,UAAWmf,OAAQ,kBAC1C,CAAE7rB,KAAM,QAAS0M,KAAM,UAAWmf,OAAQ,aAC1C,CAAE7rB,KAAM,QAAS0M,KAAM,UAAWmf,OAAQ,UAG1C,CAAE7rB,KAAM,QAAS0M,KAAM,UAAWmf,OAAQ,SAC1C,CAAE7rB,KAAM,QAAS0M,KAAM,UAAWmf,OAAQ,UAC1C,CAAE7rB,KAAM,QAAS0M,KAAM,UAAWmf,OAAQ,iBAG1C,CAAE7rB,KAAM,QAAS0M,KAAM,SAAUmf,OAAQ,UACzC,CAAE7rB,KAAM,QAAS0M,KAAM,SAAUmf,OAAQ,UAGzC,CAAE7rB,KAAM,QAAS0M,KAAM,SAAUmf,OAAQ,WAGzC,CAAE7rB,KAAM,QAAS0M,KAAM,UAAWmf,OAAQ,SAG1C,CAAE7rB,KAAM,QAAS0M,KAAM,aAAcmf,OAAQ,UAC7C,CAAE7rB,KAAM,QAAS0M,KAAM,aAAcmf,OAAQ,YAG7C,CAAE7rB,KAAM,QAAS0M,KAAM,UAAWmf,OAAQ,cAC1C,CAAE7rB,KAAM,QAAS0M,KAAM,UAAWmf,OAAQ,eAG1C,CAAE7rB,KAAM,QAAS0M,KAAM,WAAYmf,OAAQ,SAG3C,CAAE7rB,KAAM,QAAS0M,KAAM,SAAUmf,OAAQ,eAGzC,CAAE7rB,KAAM,QAAS0M,KAAM,UAAWmf,OAAQ,UAG1C,CAAE7rB,KAAM,QAAS0M,KAAM,SAAUmf,OAAQ,gBAGzC,CAAE7rB,KAAM,QAAS0M,KAAM,QAASmf,OAAQ,SAGxC,CAAE7rB,KAAM,QAAS0M,KAAM,QAASmf,OAAQ,eAGxC,CAAE7rB,KAAM,QAAS0M,KAAM,SAAUmf,OAAQ,UAGzC,CAAE7rB,KAAM,QAAS0M,KAAM,UAAWmf,OAAQ,UAG1C,CAAE7rB,KAAM,QAAS0M,KAAM,UAAWmf,OAAQ,UAG1C,CAAE7rB,KAAM,QAAS0M,KAAM,YAAamf,OAAQ,UAG5C,CAAE7rB,KAAM,QAAS0M,KAAM,SAAUmf,OAAQ,WAGzC,CAAE7rB,KAAM,QAAS0M,KAAM,UAAWmf,OAAQ,YAuBrC,SAASC,GAAqBC,GACnC,OAAOH,GAAoBI,MAAK,SAAAC,GAAI,OAAIA,EAAKjsB,OAAS+rB,CAAY,GACpE,C,+kBCrEO,IAAMG,GAAiC,CAE5CC,gBD6DO,OC1DPC,oBAAqB,SACrBC,mBAAmB,EAGnBC,uBAAuB,EAGvBC,sBAAsB,EACtBC,uBAAuB,EACvBC,kBAAmB,QAGnBC,kBAAkB,EAClBC,qBAAqB,EAGrBC,iBAAiB,EACjBC,sBAAsB,GAGlBC,GAAuB,wBAgR7B,SAF+B,KAxQuC1wB,EAAAA,EAAAA,UAHjD,SAAA2wB,KAAAzwB,EAAAA,EAAAA,SAAA,KAAAywB,GAAA,KACXC,SAAQ3nB,GAAA,GAAsB6mB,IAAgB,KAC9Ce,aAAc,EAAM,KACpBC,UAAmD,IAAI9vB,GAAM,GAAD,EAAAE,IAAA,aAAAC,MAAA,eAAA4vB,GAAA1vB,EAAAA,EAAAA,UAKpE,YACE,GAAIjB,KAAKywB,YACP,OAAOzwB,KAAKwwB,SAGd,IACE,IAAMI,QAAuBnqB,EAAAA,QAAaC,QAAQ4pB,IAElD,GAAIM,EAAgB,CAClB,IAAMC,EAAS1tB,KAAKiL,MAAMwiB,GAGpBE,EAAqBD,EAAOL,UAAYK,EAG9C7wB,KAAKwwB,SAAQ3nB,GAAAA,GAAA,GACR6mB,IACA1vB,KAAK+wB,iBAAiBD,IAG3BnxB,EAAOqE,KAAK,iDACd,YAEQhE,KAAKgxB,aAAahxB,KAAKwwB,UAC7B7wB,EAAOqE,KAAK,sDAEhB,CAAE,MAAOitB,GACP,IAAMrvB,EAAQqvB,aAAe1tB,MAAQ0tB,EAAM,IAAI1tB,MAAM2tB,OAAOD,IAC5DtxB,EAAOiC,MAAM,6CAA8CA,GAC3D5B,KAAKwwB,SAAQ3nB,GAAA,GAAQ6mB,GACvB,CAGA,OADA1vB,KAAKywB,aAAc,EACZzwB,KAAKwwB,QACd,IAlCgB,OAkCf,WAlCe,OAAAG,EAAA9uB,MAAC,KAADC,UAAA,EALoD,IAKpD,CAAAhB,IAAA,cAAAC,MAuChB,WACE,OAAA8H,GAAA,GAAY7I,KAAKwwB,SACnB,GAAC,CAAA1vB,IAAA,aAAAC,MAKD,SAAyCD,GACvC,OAAOd,KAAKwwB,SAAS1vB,EACvB,GAAC,CAAAA,IAAA,gBAAAC,MAAA,eAAAowB,GAAAlwB,EAAAA,EAAAA,UAKD,UACEH,EACAC,GAEA,IAEE,IAAMqwB,EAAiBpxB,KAAKqxB,sBAAsBvwB,EAAKC,GAGvDf,KAAKwwB,SAAQ3nB,GAAAA,GAAA,GACR7I,KAAKwwB,UAAQ,IAAAc,EAAAA,EAAAA,SAAA,GACfxwB,EAAMswB,UAIHpxB,KAAKgxB,aAAahxB,KAAKwwB,UAG7BxwB,KAAKuxB,kBAEL5xB,EAAOqE,KAAK,sCAAsCktB,OAAOpwB,GAAI,MAAMC,EACrE,CAAE,MAAOkwB,GACP,IAAMrvB,EAAQqvB,aAAe1tB,MAAQ0tB,EAAM,IAAI1tB,MAAM2tB,OAAOD,IAE5D,MADAtxB,EAAOiC,MAAM,8CAA8CsvB,OAAOpwB,GAAI,IAAKc,GACrEA,CACR,CACF,IA1BmB,OA0BlB,SA1BkB6B,EAAAC,GAAA,OAAAytB,EAAAtvB,MAAA,KAAAC,UAAA,EALlB,IAKkB,CAAAhB,IAAA,iBAAAC,MAAA,eAAAywB,GAAAvwB,EAAAA,EAAAA,UA+BnB,UAAqB0L,GACnB,IAEE,IAAM8kB,EAAmBzxB,KAAK+wB,iBAAiBpkB,GAG/C3M,KAAKwwB,SAAQ3nB,GAAAA,GAAA,GACR7I,KAAKwwB,UACLiB,SAICzxB,KAAKgxB,aAAahxB,KAAKwwB,UAG7BxwB,KAAKuxB,kBAEL5xB,EAAOqE,KAAK,mDACd,CAAE,MAAOitB,GACP,IAAMrvB,EAAQqvB,aAAe1tB,MAAQ0tB,EAAM,IAAI1tB,MAAM2tB,OAAOD,IAE5D,MADAtxB,EAAOiC,MAAM,+CAAgDA,GACvDA,CACR,CACF,IAvBoB,OAuBnB,SAvBmB+B,GAAA,OAAA6tB,EAAA3vB,MAAC,KAADC,UAAA,EA/BD,IA+BC,CAAAhB,IAAA,kBAAAC,MAAA,eAAA2wB,GAAAzwB,EAAAA,EAAAA,UA4BpB,YACE,IACEjB,KAAKwwB,SAAQ3nB,GAAA,GAAQ6mB,UACf1vB,KAAKgxB,aAAahxB,KAAKwwB,UAC7BxwB,KAAKuxB,kBACL5xB,EAAOqE,KAAK,+CACd,CAAE,MAAOitB,GACP,IAAMrvB,EAAQqvB,aAAe1tB,MAAQ0tB,EAAM,IAAI1tB,MAAM2tB,OAAOD,IAE5D,MADAtxB,EAAOiC,MAAM,8CAA+CA,GACtDA,CACR,CACF,IAXqB,OAWpB,WAXoB,OAAA8vB,EAAA7vB,MAAC,KAADC,UAAA,EA5BD,IA4BC,CAAAhB,IAAA,iBAAAC,MAAA,eAAA4wB,GAAA1wB,EAAAA,EAAAA,UAgBrB,YACE,IAAM2wB,EAAa,CACjBC,QA5ImB,MA6InBC,WAAW,IAAInvB,MAAOC,cACtB4tB,SAAUxwB,KAAKwwB,UAEjB,OAAOrtB,KAAKC,UAAUwuB,EAAY,KAAM,EAC1C,IAPoB,OAOnB,WAPmB,OAAAD,EAAA9vB,MAAC,KAADC,UAAA,EAhBC,IAgBD,CAAAhB,IAAA,iBAAAC,MAAA,eAAAgxB,GAAA9wB,EAAAA,EAAAA,UAYpB,UAAqB+wB,GACnB,IACE,IAAMC,EAAW9uB,KAAKiL,MAAM4jB,GAE5B,IAAKC,EAASzB,SACZ,MAAM,IAAIjtB,MAAM,qDAIlB,IAAM2uB,EAAoBlyB,KAAK+wB,iBAAiBkB,EAASzB,gBACnDxwB,KAAKmyB,eAAeD,GAE1BvyB,EAAOqE,KAAK,mDACd,CAAE,MAAOitB,GACP,IAAMrvB,EAAQqvB,aAAe1tB,MAAQ0tB,EAAM,IAAI1tB,MAAM2tB,OAAOD,IAE5D,MADAtxB,EAAOiC,MAAM,+CAAgDA,GACvD,IAAI2B,MAAM,8BAAgC3B,EAAMW,QACxD,CACF,IAlBoB,OAkBnB,SAlBmBqK,GAAA,OAAAmlB,EAAAlwB,MAAC,KAADC,UAAA,EAZA,IAYA,CAAAhB,IAAA,YAAAC,MAuBpB,SAAUqxB,GAAyD,IAADrwB,EAAA,KAIhE,OAHA/B,KAAK0wB,UAAUrsB,IAAI+tB,GAGZ,WACLrwB,EAAK2uB,UAAUpsB,OAAO8tB,EACxB,CACF,GAAC,CAAAtxB,IAAA,mBAAAC,MAKD,WACE,IAAMsxB,EAAc3iB,OAAOC,KAAK3P,KAAKwwB,UAE/B8B,EADc5iB,OAAOC,KAAK+f,IACA3d,QAAO,SAAAjR,GAAG,OAAKuxB,EAAY3vB,SAAS5B,EAAI,IAExE,MAAO,CACLyxB,eAAgBD,EAAYnwB,OAAS,EACrCmwB,YAAAA,EAEJ,GAAC,CAAAxxB,IAAA,eAAAC,MAAA,eAAAyxB,GAAAvxB,EAAAA,EAAAA,UAID,UAA2BuvB,GACzB,IAAMiC,EAAe,CACnBZ,QAxMmB,MAyMnBC,WAAW,IAAInvB,MAAOC,cACtB4tB,SAAAA,SAGI/pB,EAAAA,QAAagC,QAAQ6nB,GAAsBntB,KAAKC,UAAUqvB,GAClE,IAR0B,OAQzB,SARyB5lB,GAAA,OAAA2lB,EAAA3wB,MAAC,KAADC,UAAA,EAJzB,IAIyB,CAAAhB,IAAA,mBAAAC,MAU1B,SAAyByvB,GACvB,IAAMkC,EAAiC,CAAC,EAExC,QAAArsB,KAA2BqJ,OAAOijB,QAAQnC,GAAW,CAAC,IAADvpB,GAAA0O,EAAAA,EAAAA,SAAAtP,EAAA,GAAzCvF,EAAGmG,EAAA,GAAElG,EAAKkG,EAAA,GACpB,IACE,IAAMmqB,EAAiBpxB,KAAKqxB,sBAC1BvwB,EACAC,GAEF2xB,EAAU5xB,GAAOswB,CACnB,CAAE,MAAOH,GACP,IAAMrvB,EAAQqvB,aAAe1tB,MAAQ0tB,EAAM,IAAI1tB,MAAM2tB,OAAOD,IAC5DtxB,EAAOsC,KAAK,qCAAqCnB,EAAG,KAAKc,EAAMW,QAAO,mBAEtE,IAAMqwB,EAAelD,GAAiB5uB,GACtC4xB,EAAU5xB,GAAO8xB,CACnB,CACF,CAEA,OAAOF,CACT,GAAC,CAAA5xB,IAAA,wBAAAC,MAED,SACED,EACAC,GAEA,OAAQD,GACN,IAAK,kBACH,GAAqB,kBAAVC,IAAwBuuB,GAAqBvuB,IAAoB,SAAVA,EAChE,MAAM,IAAIwC,MAAM,0BAA0BxC,GAE5C,OAAOA,EAET,IAAK,oBACH,GAAqB,kBAAVA,IAAuB,gBAAgB8lB,KAAK9lB,GACrD,MAAM,IAAIwC,MAAM,wBAAwBxC,GAE1C,OAAOA,EAET,QAEE,UAAWA,WAAiB2uB,GAAiB5uB,GAC3C,MAAM,IAAIyC,MAAM,qBAAqBzC,EAAG,qBAAqB4uB,GAAiB5uB,GAAI,gBAAgBC,GAEpG,OAAOA,EAEb,GAAC,CAAAD,IAAA,kBAAAC,MAED,WAAiC,IAAD8xB,EAAA,KAC9B7yB,KAAK0wB,UAAUoC,SAAQ,SAAAV,GACrB,IACEA,EAASS,EAAKE,cAChB,CAAE,MAAO9B,GACP,IAAMrvB,EAAQqvB,aAAe1tB,MAAQ0tB,EAAM,IAAI1tB,MAAM2tB,OAAOD,IAC5DtxB,EAAOiC,MAAM,gDAAiDA,EAChE,CACF,GACF,MC5TK,IAAKoxB,GAAkB,SAAlBA,GAAkB,OAAlBA,EAAkB,sBAAlBA,EAAkB,0BAAlBA,EAAkB,4BAAlBA,EAAkB,0BAAlBA,EAAkB,0CAAlBA,EAAkB,0CAAlBA,EAAkB,sCAAlBA,CAAkB,MAwL9B,SADsB,KA3KOpzB,EAAAA,EAAAA,UAFV,SAAAqzB,KAAAnzB,EAAAA,EAAAA,SAAA,KAAAmzB,GAAA,KACTC,YAAmB,KAAK,KACxBzC,aAAc,CAAM,GAAD,EAAA3vB,IAAA,aAAAC,MAAA,eAAA4vB,GAAA1vB,EAAAA,EAAAA,UAK3B,YACE,IAAIjB,KAAKywB,YAAT,CAEA,IACE,GAAoB,QAAhBvwB,EAAAA,QAASC,GAAc,CAEzB,IAAQgzB,EAAYC,EAAQ,MAApBD,QACRnzB,KAAKkzB,YAAcC,EACnBxzB,EAAOqE,KAAK,wDACd,MACErE,EAAOqE,KAAK,uDAEhB,CAAE,MAAOpC,GACPjC,EAAOsC,KAAK,0EACd,CAEAjC,KAAKywB,aAAc,CAfS,CAgB9B,IAjBwB,OAiBvB,WAjBuB,OAAAE,EAAA9uB,MAAC,KAADC,UAAA,EALG,IAKH,CAAAhB,IAAA,kBAAAC,MAAA,eAAAsyB,GAAApyB,EAAAA,EAAAA,UAsBxB,YACE,IAEE,aADuBqyB,GAAgBP,eACvBjD,qBAClB,CAAE,MAAOluB,GAEP,OADAjC,EAAOsC,KAAK,wEACL,CACT,CACF,IAR6B,OAQ5B,WAR4B,OAAAoxB,EAAAxxB,MAAC,KAADC,UAAA,EAtBL,IAsBK,CAAAhB,IAAA,SAAAC,MAAA,eAAAwyB,GAAAtyB,EAAAA,EAAAA,UAa7B,YAAyF,IAA5EuyB,EAAwB1xB,UAAAK,OAAA,QAAA0B,IAAA/B,UAAA,GAAAA,UAAA,GAAGkxB,GAAmBS,aACzD,IAKE,SAJMzzB,KAAKiX,qBAGajX,KAAK0zB,mBAG3B,YADA/zB,EAAOmE,MAAM,wDAIf,GAAoB,QAAhB5D,EAAAA,QAASC,GAEX,OAGEH,KAAKkzB,kBAEDlzB,KAAK2zB,kBAAkBH,GAG7BxzB,KAAK4zB,yBAAyBJ,GAGhC7zB,EAAOmE,MAAM,8CAA8C0vB,EAC7D,CAAE,MAAO5xB,GACPjC,EAAOiC,MAAM,qDAAsDA,EACrE,CACF,IA5BY,OA4BX,WA5BW,OAAA2xB,EAAA1xB,MAAC,KAADC,UAAA,EAbiB,IAajB,CAAAhB,IAAA,oBAAAC,MAAA,eAAA8yB,GAAA5yB,EAAAA,EAAAA,UAiCZ,UAAgCuyB,GAC9B,GAAKxzB,KAAKkzB,YAEV,OAAQM,GACN,KAAKR,GAAmBc,gBAChB9zB,KAAKkzB,YAAYa,iBACvB,MACF,KAAKf,GAAmBgB,kBAChBh0B,KAAKkzB,YAAYe,YAAYj0B,KAAKkzB,YAAYgB,oBAAoBC,OACxE,MACF,KAAKnB,GAAmBS,mBAChBzzB,KAAKkzB,YAAYe,YAAYj0B,KAAKkzB,YAAYgB,oBAAoBE,QACxE,MACF,KAAKpB,GAAmBqB,kBAChBr0B,KAAKkzB,YAAYe,YAAYj0B,KAAKkzB,YAAYgB,oBAAoBI,OACxE,MACF,KAAKtB,GAAmBuB,0BAChBv0B,KAAKkzB,YAAYsB,kBAAkBx0B,KAAKkzB,YAAYuB,yBAAyBC,SACnF,MACF,KAAK1B,GAAmB2B,0BAChB30B,KAAKkzB,YAAYsB,kBAAkBx0B,KAAKkzB,YAAYuB,yBAAyBG,SACnF,MACF,KAAK5B,GAAmB6B,wBAChB70B,KAAKkzB,YAAYsB,kBAAkBx0B,KAAKkzB,YAAYuB,yBAAyBlxB,OACnF,MACF,cACQvD,KAAKkzB,YAAYe,YAAYj0B,KAAKkzB,YAAYgB,oBAAoBE,QAE9E,IA5B+B,OA4B9B,SA5B8B3wB,GAAA,OAAAowB,EAAAhyB,MAAC,KAADC,UAAA,EAjCnB,IAiCmB,CAAAhB,IAAA,2BAAAC,MAiC/B,SAAiCyyB,GAC/B,IAAIjW,EAEJ,OAAQiW,GACN,KAAKR,GAAmBc,UACtBvW,EAAW,GACX,MACF,KAAKyV,GAAmBgB,YACtBzW,EAAW,GACX,MACF,KAAKyV,GAAmBS,aACtBlW,EAAW,GACX,MACF,KAAKyV,GAAmBqB,YACtB9W,EAAW,GACX,MACF,KAAKyV,GAAmBuB,oBACtBhX,EAAW,IACX,MACF,KAAKyV,GAAmB2B,oBACtBpX,EAAW,IACX,MACF,KAAKyV,GAAmB6B,kBACtBtX,EAAW,IACX,MACF,QACEA,EAAW,GAGfuX,GAAAA,QAAUC,QAAQxX,EACpB,GAAC,CAAAzc,IAAA,YAAAC,MAAA,eAAAi0B,GAAA/zB,EAAAA,EAAAA,UAKD,YACE,OAAOjB,KAAKi1B,OAAOjC,GAAmBc,UACxC,IAFe,OAEd,WAFc,OAAAkB,EAAAnzB,MAAC,KAADC,UAAA,EALd,IAKc,CAAAhB,IAAA,QAAAC,MAAA,eAAAm0B,GAAAj0B,EAAAA,EAAAA,UAIf,YACE,OAAOjB,KAAKi1B,OAAOjC,GAAmBgB,YACxC,IAFW,OAEV,WAFU,OAAAkB,EAAArzB,MAAC,KAADC,UAAA,EAJI,IAIJ,CAAAhB,IAAA,SAAAC,MAAA,eAAAo0B,GAAAl0B,EAAAA,EAAAA,UAIX,YACE,OAAOjB,KAAKi1B,OAAOjC,GAAmBS,aACxC,IAFY,OAEX,WAFW,OAAA0B,EAAAtzB,MAAC,KAADC,UAAA,EAJD,IAIC,CAAAhB,IAAA,QAAAC,MAAA,eAAAq0B,GAAAn0B,EAAAA,EAAAA,UAIZ,YACE,OAAOjB,KAAKi1B,OAAOjC,GAAmBqB,YACxC,IAFW,OAEV,WAFU,OAAAe,EAAAvzB,MAAC,KAADC,UAAA,EAJC,IAID,CAAAhB,IAAA,UAAAC,MAAA,eAAAs0B,GAAAp0B,EAAAA,EAAAA,UAIX,YACE,OAAOjB,KAAKi1B,OAAOjC,GAAmBuB,oBACxC,IAFa,OAEZ,WAFY,OAAAc,EAAAxzB,MAAC,KAADC,UAAA,EAJF,IAIE,CAAAhB,IAAA,UAAAC,MAAA,eAAAu0B,GAAAr0B,EAAAA,EAAAA,UAIb,YACE,OAAOjB,KAAKi1B,OAAOjC,GAAmB2B,oBACxC,IAFa,OAEZ,WAFY,OAAAW,EAAAzzB,MAAC,KAADC,UAAA,EAJA,IAIA,CAAAhB,IAAA,QAAAC,MAAA,eAAAw0B,GAAAt0B,EAAAA,EAAAA,UAIb,YACE,OAAOjB,KAAKi1B,OAAOjC,GAAmB6B,kBACxC,IAFW,OAEV,WAFU,OAAAU,EAAA1zB,MAAC,KAADC,UAAA,EAJE,O,+kBC3Jf,IAAM0zB,GAAkC,QAAhBt1B,EAAAA,QAASC,GAoI3BilB,GAAY,SAACnG,EAAiBtd,EAAc8zB,GAChD,IAoBMC,EApBmB,WACvB,OAAQD,GACN,IAAK,YACH,MAAO,CACL1U,gBAAiB9B,EAAMC,OAAOtG,UAC9BmE,YAAakC,EAAMC,OAAOtG,WAE9B,IAAK,SACH,MAAO,CACLmI,gBAAiB9B,EAAMC,OAAOjF,OAC9B8C,YAAakC,EAAMC,OAAOjF,QAE9B,QACE,MAAO,CACL8G,gBAAiB9B,EAAMC,OAAOzG,QAC9BsE,YAAakC,EAAMC,OAAOzG,SAGlC,CAEsBkd,GAEtB,OAAO/U,EAAAA,QAAWxb,OAAO,CACvByb,UAAW,CACT+U,SAAU,YAEZC,gBAAehtB,GAAAA,GAAA,CACb+T,aAAcjb,EAAO,GAClBsd,EAAMnC,QAAQf,IAAE,IACnBgB,YAAa2Y,EAAc3Y,cAE7BsI,OAAQ,CACNpI,MAAOtb,EACPub,OAAQvb,EACRib,aAAcjb,EAAO,EACrBof,gBAAiB2U,EAAc3U,gBAC/BM,eAAgB,SAChBD,WAAY,SACZ0U,SAAU,UAEZC,UAAW,CACT9Y,MAAO,OACPC,OAAQ,OACRmE,eAAgB,SAChBD,WAAY,UAEd1H,SAAU,CACRqH,gBAAiB9B,EAAMC,OAAOxF,SAC9Bsc,QAAS,IAEXC,KAAM,CACJtU,MAAO1C,EAAMC,OAAOpF,YAG1B,EAEA,SA3LkE,SAAHzT,GAQxD,IAPL2e,EAAO3e,EAAP2e,QAAOkR,EAAA7vB,EACP4vB,KAAAA,OAAI,IAAAC,EAAG,MAAKA,EAAAC,EAAA9vB,EACZ1E,KAAAA,OAAI,IAAAw0B,EAAG,GAAEA,EACTtR,EAAKxe,EAALwe,MAAKoB,EAAA5f,EACLqT,SAAAA,OAAQ,IAAAuM,GAAQA,EAAAmQ,EAAA/vB,EAChBovB,QAAAA,OAAO,IAAAW,EAAG,UAASA,EAAAC,EAAAhwB,EACnBiwB,OAAAA,OAAM,IAAAD,EAAG,yBAAwBA,EAEzBpX,EAAUG,KAAVH,MACF0B,EAASyE,GAAUnG,EAAOtd,EAAM8zB,GAEhCc,GAAYC,EAAAA,EAAAA,QAAO,IAAIC,GAAAA,QAASC,MAAM,IAAIC,QAC1CC,GAAYJ,EAAAA,EAAAA,QAAO,IAAIC,GAAAA,QAASC,MAAM,IAAIC,QAC1CE,GAAaL,EAAAA,EAAAA,QAAO,IAAIC,GAAAA,QAASC,MAAM,IAAIC,SAGjDlgB,EAAAA,EAAAA,YAAU,WACR,IAAMqgB,EAAQL,GAAAA,QAASM,KACrBN,GAAAA,QAASO,SAAS,CAChBP,GAAAA,QAASQ,OAAOL,EAAW,CACzBM,QAAS,KACT3Z,SAAU,IACViY,gBAAAA,KAEFiB,GAAAA,QAASQ,OAAOL,EAAW,CACzBM,QAAS,EACT3Z,SAAU,IACViY,gBAAAA,QASN,OAJK9b,GACHod,EAAMK,QAGD,kBAAML,EAAMM,MAAO,CAC5B,GAAG,CAAC1d,EAAUkd,IAEd,IA0CMS,EAAWR,EAAWS,YAAY,CACtCC,WAAY,CAAC,EAAG,GAChBC,YAAa,CAAC,OAAQ,WAGxB,OACErf,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAO,CAAClE,EAAOE,UAAWgE,GAAOtP,UACrC4C,EAAAA,EAAAA,KAACse,GAAAA,QAAS3R,KAAI,CACZD,MAAO,CACLlE,EAAOkV,gBACP,CACE4B,UAAW,CAAC,CAAEC,MAAOd,MAEvBrhB,UAEF4C,EAAAA,EAAAA,KAACse,GAAAA,QAAS3R,KAAI,CACZD,MAAO,CACLlE,EAAO0E,OACP3L,GAAYiH,EAAOjH,SACnB,CACE+d,UAAW,CACT,CAAEC,MAAOnB,GACT,CAAEoB,OAAQN,MAGd9hB,UAEF4C,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CACfF,MAAOlE,EAAOoV,UACd/Q,QAlCU,WACdtL,GACJsL,GACF,EAgCU4S,UAxEY,WAChBle,IAGJme,GAActc,SAEdkb,GAAAA,QAASqB,SAAS,CAChBrB,GAAAA,QAASsB,OAAOxB,EAAW,CACzBW,QAAS,IACT1B,gBAAAA,KAEFiB,GAAAA,QAASQ,OAAOJ,EAAY,CAC1BK,QAAS,EACT3Z,SAAU,IACViY,gBAAAA,OAED2B,QACL,EAwDUa,WAtDa,WACjBte,GAEJ+c,GAAAA,QAASqB,SAAS,CAChBrB,GAAAA,QAASsB,OAAOxB,EAAW,CACzBW,QAAS,EACTe,QAAS,IACTC,SAAU,EACV1C,gBAAAA,KAEFiB,GAAAA,QAASQ,OAAOJ,EAAY,CAC1BK,QAAS,EACT3Z,SAAU,IACViY,gBAAAA,OAED2B,OACL,EAuCUzd,SAAUA,EACVye,cAAe,GACf7B,OAAQA,EAAO/gB,UAEf4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CACP/U,KAAM+lB,EACNt0B,KAAa,GAAPA,EACNggB,MAAOhB,EAAOsV,KAAKtU,eAOjC,E,gDC/HMyW,GAAuB,oBAAAA,KAAAt4B,EAAAA,EAAAA,SAAA,KAAAs4B,EAAA,QAAAx4B,EAAAA,EAAAA,SAAAw4B,EAAA,EAAAt3B,IAAA,uBAAAC,MAe3B,WACE,MAAyB,qBAAX6T,QACkB,qBAAlBA,OAAOC,QACqB,oBAA5BD,OAAOC,OAAOX,SAC9B,GAAC,CAAApT,IAAA,cAAAC,MAAA,eAAAs3B,GAAAp3B,EAAAA,EAAAA,UAKD,YACE,IAEE,IAAIq3B,EAA4B,KAShC,GANEA,EADkB,QAAhBp4B,EAAAA,QAASC,GACEo4B,aAAa7xB,QAAQ0xB,EAAwBI,qBAGvC/xB,EAAAA,QAAaC,QAAQ0xB,EAAwBI,eAGlD,CAId,IAFA,IAAMC,EAAe5lB,KAAKylB,GACpBhuB,EAAO,IAAIyI,WAAW0lB,EAAat2B,QAChC6Q,EAAI,EAAGA,EAAIylB,EAAat2B,OAAQ6Q,IACvC1I,EAAK0I,GAAKylB,EAAaxlB,WAAWD,GAEpC,OAAO1I,CACT,CAGA,IAAMouB,EAAU9jB,OAAO+jB,gBAAgB,IAAI5lB,WAAWqlB,EAAwBQ,cAGxEC,EAAYx2B,MAAM0R,KAAK2kB,GACvBI,EAAgBC,KAAK7H,OAAO8H,aAAYn3B,MAAnBqvB,OAAuB2H,IAUlD,MAPoB,QAAhB34B,EAAAA,QAASC,GACXo4B,aAAa9vB,QAAQ2vB,EAAwBI,cAAeM,SAEtDryB,EAAAA,QAAagC,QAAQ2vB,EAAwBI,cAAeM,GAGpEn5B,EAAOqE,KAAK,0CACL00B,CACT,CAAE,MAAO92B,GAEP,MADAjC,EAAOiC,MAAM,qCAAsCA,GAC7C,IAAI2B,MAAM,uCAClB,CACF,IA1CyB,OA0CxB,WA1CwB,OAAA80B,EAAAx2B,MAAC,KAADC,UAAA,EALxB,IAKwB,CAAAhB,IAAA,sBAAAC,MAAA,eAAAk4B,GAAAh4B,EAAAA,EAAAA,UA+CzB,UAAkCyI,GAChC,IAAK1J,KAAKk5B,uBACR,MAAM,IAAI31B,MAAM,gCAGlB,IAAQ41B,EAA8EzvB,EAA9EyvB,WAAY7uB,EAAkEZ,EAAlEY,KAAI8uB,EAA8D1vB,EAA5D2vB,WAAAA,OAAU,IAAAD,EAAGhB,EAAwBkB,mBAAkBF,EAEjF,IAEE,IAAMG,EAAU,IAAIrkB,YACdskB,QAAoB5kB,OAAOC,OAAOC,UACtC,MACAykB,EAAQpkB,OAAOgkB,GACf,UACA,EACA,CAAC,cAIGM,EAAiBnvB,UAActK,KAAK05B,eAmB1C,aAhBkB9kB,OAAOC,OAAOX,UAC9B,CACEhE,KAAM,SACN5F,KAAMmvB,EACNJ,WAAYA,EACZpkB,KAAM,WAERukB,EACA,CACEtpB,KAAMkoB,EAAwBuB,UAC9Bx3B,OAAQi2B,EAAwBwB,aAElC,EACA,CAAC,UAAW,WAIhB,CAAE,MAAOh4B,GAEP,MADAjC,EAAOiC,MAAM,mCAAoCA,GAC3C,IAAI2B,MAAM,wBAClB,CACF,IA3CiC,OA2ChC,SA3CgCE,GAAA,OAAAw1B,EAAAp3B,MAAC,KAADC,UAAA,EA/CR,IA+CQ,CAAAhB,IAAA,mBAAAC,MAAA,eAAA84B,GAAA54B,EAAAA,EAAAA,UAiDjC,YACE,IAAKmR,EAAiB0nB,gBACpB,MAAM,IAAIv2B,MAAM,sCAElB,IAAMuM,EAAYsC,EAAiB2nB,eAE7BplB,QAAYC,OAAOC,OAAOC,UAAU,MAAOhF,EAAW,QAAQ,EAAO,CAAC,cAiB5E,aAhBwB8E,OAAOC,OAAOX,UACpC,CACEhE,KAAM,OACN+E,KAAM,UAEN3K,KAAM,IAAIyI,WAAW,IACrB/O,MAAM,IAAIkR,aAAcC,OAAOijB,EAAwB4B,cAEzDrlB,EACA,CACEzE,KAAMkoB,EAAwBuB,UAC9Bx3B,OAAQi2B,EAAwBwB,aAElC,EACA,CAAC,UAAW,UAAW,UAAW,aAGtC,IAxB8B,OAwB7B,WAxB6B,OAAAC,EAAAh4B,MAAC,KAADC,UAAA,EAjDG,IAiDH,CAAAhB,IAAA,mBAAAC,MAAA,eAAAk5B,GAAAh5B,EAAAA,EAAAA,UA6B9B,YACE,aAAa2T,OAAOC,OAAOqlB,YACzB,CAAEhqB,KAAMkoB,EAAwBuB,UAAWx3B,OAAQi2B,EAAwBwB,aAC3E,EACA,CAAC,UAAW,WAEhB,IAN8B,OAM7B,WAN6B,OAAAK,EAAAp4B,MAAC,KAADC,UAAA,EA7BA,IA6BA,CAAAhB,IAAA,eAAAC,MAAA,eAAAo5B,GAAAl5B,EAAAA,EAAAA,UAW9B,UAA2BH,GACzB,IAAMs5B,QAAYxlB,OAAOC,OAAO/E,UAAU,MAAOhP,GACjD,OAAO,IAAIiS,WAAWqnB,EACxB,IAH0B,OAGzB,SAHyB12B,GAAA,OAAAy2B,EAAAt4B,MAAC,KAADC,UAAA,EAXI,IAWJ,CAAAhB,IAAA,eAAAC,MAAA,eAAAs5B,GAAAp5B,EAAAA,EAAAA,UAQ1B,UAA2Bq5B,EAAqBC,EAAsB3vB,GACpE,IAAM4vB,QAAgB5lB,OAAOC,OAAO4lB,QAClC,CAAEvqB,KAAMkoB,EAAwBuB,UAAWvvB,GAAIQ,GAC/C2vB,QACMv6B,KAAK06B,aAAaJ,IAE1B,OAAO,IAAIvnB,WAAWynB,EACxB,IAP0B,OAOzB,SAPyB72B,EAAAiJ,EAAAC,GAAA,OAAAwtB,EAAAx4B,MAAC,KAADC,UAAA,EARA,IAQA,CAAAhB,IAAA,iBAAAC,MAAA,eAAA45B,GAAA15B,EAAAA,EAAAA,UAY1B,UAAqBgJ,GACnB,IAAKjK,KAAKk5B,uBACR,MAAM,IAAI31B,MAAM,6CAGlB,IAEE,IAAMg3B,QAAkBv6B,KAAK46B,mBAEvBN,QAAiBt6B,KAAK66B,mBAGtBzwB,EAAKwK,OAAO+jB,gBAAgB,IAAI5lB,WAAWqlB,EAAwB0C,YACnElwB,EAASgK,OAAO+jB,gBAAgB,IAAI5lB,WAAWqlB,EAAwB0C,YAGvEvB,EAAU,IAAIrkB,YACd6lB,QAAsBnmB,OAAOC,OAAO4lB,QACxC,CACEvqB,KAAMkoB,EAAwBuB,UAC9BvvB,GAAIA,GAENkwB,EACAf,EAAQpkB,OAAOlL,IAIXuwB,QAAgBx6B,KAAKg7B,aAAaV,EAAUC,EAAW3vB,GAGvDqwB,EAAiB,IAAIloB,WAAWgoB,GAChCG,EAAkBnC,KAAK7H,OAAO8H,aAAYn3B,MAAnBqvB,QAAMiK,EAAAA,GAAAA,SAAiBF,KAC9CG,EAAWrC,KAAK7H,OAAO8H,aAAYn3B,MAAnBqvB,QAAMiK,EAAAA,GAAAA,SAAiB/wB,KACvCixB,EAAetC,KAAK7H,OAAO8H,aAAYn3B,MAAnBqvB,QAAMiK,EAAAA,GAAAA,SAAiBvwB,KAC3C0wB,EAAgBvC,KAAK7H,OAAO8H,aAAYn3B,MAAnBqvB,QAAMiK,EAAAA,GAAAA,SAAiBX,KAIlD,OAFA76B,EAAOqE,KAAK,kCAEL,CACLu3B,iBAAkBL,EAClB9wB,GAAIgxB,EACJI,WAAYF,EACZ1wB,OAAQywB,EACR3wB,UAAW0tB,EAAwBuB,UAEvC,CAAE,MAAO/3B,GAEP,MADAjC,EAAOiC,MAAM,qBAAsBA,GAC7B,IAAI2B,MAAM,4BAClB,CACF,IAjDoB,OAiDnB,SAjDmByJ,GAAA,OAAA2tB,EAAA94B,MAAC,KAADC,UAAA,EAZM,IAYN,CAAAhB,IAAA,iBAAAC,MAAA,eAAA06B,GAAAx6B,EAAAA,EAAAA,UAsDpB,UACEs6B,EACAnxB,EACA+uB,EACA7uB,GAEA,IAAKtK,KAAKk5B,uBACR,MAAM,IAAI31B,MAAM,6CAGlB,IAEE,IAQIs1B,EAREkC,EAAgB,IAAIhoB,WACxBF,KAAK0oB,GAAkBpX,MAAM,IAAIuX,KAAI,SAAAC,GAAI,OAAIA,EAAK1oB,WAAW,EAAE,KAE3D2oB,EAAU,IAAI7oB,WAClBF,KAAKzI,GAAI+Z,MAAM,IAAIuX,KAAI,SAAAC,GAAI,OAAIA,EAAK1oB,WAAW,EAAE,KAMjD4lB,EADEvuB,EACU,IAAIyI,WACdF,KAAKvI,GAAM6Z,MAAM,IAAIuX,KAAI,SAAAC,GAAI,OAAIA,EAAK1oB,WAAW,EAAE,WAGnCjT,KAAK05B,cAIzB,IAAM54B,QAAYd,KAAK67B,oBAAoB,CAAE1C,WAAAA,EAAY7uB,KAAMuuB,IAGzDiD,QAAsBlnB,OAAOC,OAAOknB,QACxC,CACE7rB,KAAMkoB,EAAwBuB,UAC9BvvB,GAAIwxB,GAEN96B,EACAi6B,GAKIiB,GADU,IAAIC,aACaC,OAAOJ,GAGxC,OADAn8B,EAAOqE,KAAK,kCACLg4B,CACT,CAAE,MAAOp6B,GAEP,MADAjC,EAAOiC,MAAM,qBAAsBA,GAC7B,IAAI2B,MAAM,4DAClB,CACF,IApDoB,OAoDnB,SApDmBwM,EAAAC,EAAAU,EAAAC,GAAA,OAAA8qB,EAAA55B,MAAC,KAADC,UAAA,EAtDA,IAsDA,CAAAhB,IAAA,mBAAAC,MAAA,eAAAo7B,GAAAl7B,EAAAA,EAAAA,UAyDpB,UACEs6B,EACAnxB,EACA+uB,EACA7uB,GAEA,IAEE,aADMtK,KAAKo8B,eAAeb,EAAkBnxB,EAAI+uB,EAAY7uB,IACrD,CACT,CAAE,MAAO1I,GACP,OAAO,CACT,CACF,IAZsB,OAYrB,SAZqBgP,EAAAW,EAAAC,EAAA6qB,GAAA,OAAAF,EAAAt6B,MAAC,KAADC,UAAA,EAzDF,IAyDE,CAAAhB,IAAA,sBAAAC,MAAA,eAAAu7B,GAAAr7B,EAAAA,EAAAA,UAiBtB,YACE,IACsB,QAAhBf,EAAAA,QAASC,IACXo4B,aAAahvB,WAAW6uB,EAAwBI,eAChDD,aAAahvB,WAAW6uB,EAAwBmE,mCAE1C91B,EAAAA,QAAa8C,WAAW6uB,EAAwBI,qBAChD/xB,EAAAA,QAAa8C,WAAW6uB,EAAwBmE,4BAExD58B,EAAOqE,KAAK,0BACd,CAAE,MAAOpC,GACPjC,EAAOiC,MAAM,mCAAoCA,EACnD,CACF,IAbyB,OAaxB,WAbwB,OAAA06B,EAAAz6B,MAAC,KAADC,UAAA,EAjBH,IAiBG,CAAAhB,IAAA,uBAAAC,MAkBzB,WAAmD,IAA9BoB,EAAcL,UAAAK,OAAA,QAAA0B,IAAA/B,UAAA,GAAAA,UAAA,GAAG,GAC9B06B,EAAU,yEACVC,EAAc7nB,OAAO+jB,gBAAgB,IAAI5lB,WAAW5Q,IAE1D,OAAOE,MAAM0R,KAAK0oB,GACff,KAAI,SAAAgB,GAAI,OAAIF,EAAQE,EAAOF,GAAe,IAC1Ch6B,KAAK,GACV,GAAC,CAAA1B,IAAA,iBAAAC,MAAA,eAAA47B,GAAA17B,EAAAA,EAAAA,UAKD,YACE,IACE,IAAM27B,EAAc,qDACdC,EAAa,8BAEbC,QAAkB98B,KAAK+8B,eAAeH,EAAaC,GAQnDttB,SAPkBvP,KAAKo8B,eAC3BU,EAAUvB,iBACVuB,EAAU1yB,GACVyyB,EACAC,EAAUxyB,SAGkBsyB,EAE9B,OADAj9B,EAAOqE,KAAK,mBAAoBuL,EAAU,SAAW,UAC9CA,CACT,CAAE,MAAO3N,GAEP,OADAjC,EAAOiC,MAAM,0BAA2BA,IACjC,CACT,CACF,IApBoB,OAoBnB,WApBmB,OAAA+6B,EAAA96B,MAAC,KAADC,UAAA,EALnB,KAKmB,CAlVO,GAAvBs2B,GACoBuB,UAAY,UADhCvB,GAEoBwB,WAAa,IAFjCxB,GAGoB0C,UAAY,GAHhC1C,GAIoBQ,YAAc,GAJlCR,GAKoBkB,mBAAqB,IALzClB,GAMoB4B,YAAc,gBANlC5B,GASoBI,cAAgB,uBATpCJ,GAUoBmE,0BAA4B,wBAgW/C,IAAMS,GAAmB,IAAI5E,GACpC,YCnWA,IAAM6E,IAAoB5nB,EAAAA,EAAAA,oBAAkDxR,GAM/Dq5B,GAAwD,SAAH72B,GAAsB,IAAhBkP,EAAQlP,EAARkP,SACtEC,GAAwCC,EAAAA,EAAAA,WAAS,GAAMC,GAAAC,EAAAA,EAAAA,SAAAH,EAAA,GAAhD2nB,EAAYznB,EAAA,GAAE0nB,EAAe1nB,EAAA,GACpCI,GAA8CL,EAAAA,EAAAA,WAAS,GAAKM,GAAAJ,EAAAA,EAAAA,SAAAG,EAAA,GAArDunB,EAAetnB,EAAA,GAAEunB,EAAkBvnB,EAAA,GAC1CG,GAAoCT,EAAAA,EAAAA,WAAS,GAAMU,GAAAR,EAAAA,EAAAA,SAAAO,EAAA,GAA5CqnB,EAAUpnB,EAAA,GAAEqnB,EAAarnB,EAAA,GAChCG,GAAoCb,EAAAA,EAAAA,UAAwB,MAAKc,GAAAZ,EAAAA,EAAAA,SAAAW,EAAA,GAA1D6iB,EAAU5iB,EAAA,GAAEknB,EAAalnB,EAAA,GAChCoT,GAA0DlU,EAAAA,EAAAA,UAAS,GAAEmU,GAAAjU,EAAAA,EAAAA,SAAAgU,EAAA,GAA9D+T,EAAqB9T,EAAA,GAAE+T,EAAwB/T,EAAA,GACtDE,GAA4CrU,EAAAA,EAAAA,UAAwB,MAAKsU,GAAApU,EAAAA,EAAAA,SAAAmU,EAAA,GAAlE8T,EAAc7T,EAAA,GAAE8T,EAAiB9T,EAAA,GACxCsC,GAAwC5W,EAAAA,EAAAA,UAAgC,MAAK6W,GAAA3W,EAAAA,EAAAA,SAAA0W,EAAA,GAAtEyR,EAAYxR,EAAA,GAAEyR,EAAezR,EAAA,GAG9B0R,EAAwB,8BACxBC,EAAwB,2BACxBC,EAAsB,8BAKtBC,GAAmBC,EAAAA,EAAAA,cAAWn9B,EAAAA,EAAAA,UAAC,YACnC,IACE,IAAMo9B,QAAuB53B,EAAAA,QAAaC,QAAQs3B,GAC5CM,QAAyB73B,EAAAA,QAAaC,QAAQu3B,GAEpDX,IAAwC,SAAnBe,GAA6BC,IAGlD,IAAMC,QAAsB93B,EAAAA,QAAaC,QAAQw3B,GAC7CK,GACFZ,EAAyBa,SAASD,EAAe,IAErD,CAAE,MAAO38B,GACPjC,EAAOiC,MAAM,4CAA6CA,GAC1D07B,GAAmB,EACrB,CACF,IAAG,IAKGmB,GAAkBL,EAAAA,EAAAA,aAAY,WAAD,IAAA90B,GAAArI,EAAAA,EAAAA,UAAC,UAAOy9B,GACzC,IACE,IAAKA,GAAUA,EAAOv8B,OAAS,EAC7B,MAAM,IAAIoB,MAAM,6CAKlB,WAD0By5B,GAAiB2B,kBAEzC,MAAM,IAAIp7B,MAAM,8EAIlB,IACM+6B,QAAyBtB,GAAiBD,eADvB,mCACwD2B,SAG3Ej4B,EAAAA,QAAagC,QAAQu1B,EAAuB,cAC5Cv3B,EAAAA,QAAagC,QAAQw1B,EAAuB96B,KAAKC,UAAUk7B,IAEjEhB,GAAmB,GACnBG,EAAciB,GACdlB,GAAc,GACdJ,GAAgB,GAGhBwB,IAEAj/B,EAAOqE,KAAK,2CACd,CAAE,MAAOpC,GAEP,MADAjC,EAAOiC,MAAM,4BAA6BA,GACpCA,CACR,CACF,IAAC,gBAAA6B,GAAA,OAAA6F,EAAAzH,MAAA,KAAAC,UAAA,EAjCmC,GAiCjC,IAKG+8B,GAAmBT,EAAAA,EAAAA,aAAY,WAAD,IAAA9mB,GAAArW,EAAAA,EAAAA,UAAC,UAAOy9B,GAC1C,IACE,IAAKA,EACH,OAAO,EAIT,IAAMI,QAA6Br4B,EAAAA,QAAaC,QAAQu3B,GACxD,IAAKa,EAEH,OADAn/B,EAAOiC,MAAM,wDACN,EAGT,IAAM08B,EAAmBn7B,KAAKiL,MAAM0wB,GAWpC,MAAsB,4CARM9B,GAAiBZ,eAC3CkC,EAAiB/C,iBACjB+C,EAAiBl0B,GACjBs0B,EACAJ,EAAiBh0B,QAKjBmzB,EAAciB,GACdlB,GAAc,GACdJ,GAAgB,GAChBwB,IAEAj/B,EAAOqE,KAAK,sCACL,IAEPrE,EAAOsC,KAAK,iDACL,EAEX,CAAE,MAAOL,GAEP,OADAjC,EAAOiC,MAAM,4BAA6BA,IACnC,CACT,CACF,IAAC,gBAAA8B,GAAA,OAAA4T,EAAAzV,MAAA,KAAAC,UAAA,EAxCoC,GAwClC,IAKGi9B,GAAiBX,EAAAA,EAAAA,cAAY,WACjCX,EAAc,MACdD,GAAc,GACdJ,GAAgB,GAChBS,EAAkB,MAEdC,IACFkB,aAAalB,GACbC,EAAgB,OAGlBp+B,EAAOqE,KAAK,qBACd,GAAG,CAAC85B,IAKEmB,GAAkBb,EAAAA,EAAAA,cAAWn9B,EAAAA,EAAAA,UAAC,YAClC,UAEQwF,EAAAA,QAAa8C,WAAWy0B,SACxBv3B,EAAAA,QAAa8C,WAAW00B,SACxBx3B,EAAAA,QAAa8C,WAAW20B,SAGxBlB,GAAiBkC,sBAGvBH,IACAzB,GAAmB,GAEnB39B,EAAOqE,KAAK,2BACd,CAAE,MAAOpC,GAEP,MADAjC,EAAOiC,MAAM,oCAAqCA,GAC5CA,CACR,CACF,IAAG,CAACm9B,IAKEH,GAAoBR,EAAAA,EAAAA,cAAY,WAChCN,GACFkB,aAAalB,GAGf,IAAMqB,EAAUx8B,KAAKorB,MAAiC,GAAxB2P,EAA6B,IAC3DG,EAAkBsB,GAElB,IAAMC,EAAQC,YAAW,WACvB1/B,EAAOqE,KAAK,iCACZ+6B,GACF,GAA2B,GAAxBrB,EAA6B,KAEhCK,EAAgBqB,EAClB,GAAG,CAAC1B,EAAuBI,EAAciB,IAKnCO,GAAgBlB,EAAAA,EAAAA,cAAY,WAC5Bb,IACFqB,IACAj/B,EAAOqE,KAAK,gCAEhB,GAAG,CAACu5B,EAAYqB,IAKVW,GAA0BnB,EAAAA,EAAAA,cAAY,WAC1C,OAAKR,GAAmBL,EAINpd,KAAKC,IAAI,EAAGD,KAAKqf,OAAO5B,EAAiBj7B,KAAKorB,OAAS,MAHhE,CAKX,GAAG,CAAC6P,EAAgBL,IAKdkC,GAAmCrB,EAAAA,EAAAA,aAAY,WAAD,IAAArmB,GAAA9W,EAAAA,EAAAA,UAAC,UAAOy+B,GAC1D/B,EAAyB+B,GACzB,UACQj5B,EAAAA,QAAagC,QAAQy1B,EAAqBwB,EAAQC,WAC1D,CAAE,MAAO/9B,GACPjC,EAAOiC,MAAM,6CAA8CA,EAC7D,CACF,IAAC,gBAAA+B,GAAA,OAAAoU,EAAAlW,MAAA,KAAAC,UAAA,EAPoD,GAOlD,IAKGi7B,GAAiBqB,EAAAA,EAAAA,aAAY,WAAD,IAAAlmB,GAAAjX,EAAAA,EAAAA,UAAC,UAAOgJ,GACxC,IAAKkvB,EACH,MAAM,IAAI51B,MAAM,6CAGlB,aAAay5B,GAAiBD,eAAe9yB,EAASkvB,EACxD,IAAC,gBAAAvsB,GAAA,OAAAsL,EAAArW,MAAA,KAAAC,UAAA,EANkC,GAMhC,CAACq3B,IAKEiD,GAAiBgC,EAAAA,EAAAA,aAAY,WAAD,IAAAwB,GAAA3+B,EAAAA,EAAAA,UAAC,UAAOs6B,EAA0BnxB,EAAYE,GAC9E,IAAK6uB,EACH,MAAM,IAAI51B,MAAM,6CAGlB,aAAay5B,GAAiBZ,eAAeb,EAAkBnxB,EAAI+uB,EAAY7uB,EACjF,IAAC,gBAAAuC,EAAAG,EAAA+C,GAAA,OAAA6vB,EAAA/9B,MAAA,KAAAC,UAAA,EANkC,GAMhC,CAACq3B,KAGJ1iB,EAAAA,EAAAA,YAAU,WACR0nB,GACF,GAAG,CAACA,KAGJ1nB,EAAAA,EAAAA,YAAU,WACR,OAAO,WACDqnB,GACFkB,aAAalB,EAEjB,CACF,GAAG,CAACA,IAEJ,IAAM/8B,EAAgC,CAEpCo8B,aAAAA,EACAE,gBAAAA,EACAE,WAAAA,EAGAkB,gBAAAA,EACAI,iBAAAA,EACAE,eAAAA,EACAE,gBAAAA,EAGAlC,eAAAA,EACAX,eAAAA,EAGAsB,sBAAAA,EACAmC,kBAAmBJ,EACnBH,cAAAA,EACAC,wBAAAA,GAGF,OACEpnB,EAAAA,EAAAA,KAAC8kB,GAAkB7kB,SAAQ,CAACrX,MAAOA,EAAMwU,SACtCA,GAGP,EAKauqB,GAAgB,WAC3B,IAAMxnB,GAAUC,EAAAA,EAAAA,YAAW0kB,IAC3B,IAAK3kB,EACH,MAAM,IAAI/U,MAAM,0DAElB,OAAO+U,CACT,E,ymBC9TA,IAAMkd,GAAkC,QAAhBt1B,EAAAA,QAASC,GAgI3BilB,GAAY,SAACnG,GAAe,OAAK2B,EAAAA,QAAWxb,OAAO,CACvDyb,UAAShY,GAAAA,GAAA,CACPkY,gBAAiB9B,EAAMC,OAAOlG,KAC9B4D,aAAcqC,EAAMrC,aAAaZ,GACjCsF,QAASrC,EAAMvC,QAAQX,GACvB0M,eAAgBxJ,EAAMvC,QAAQb,GAC9BqG,iBAAkBjD,EAAMvC,QAAQd,IAC7BqD,EAAMnC,QAAQhB,IAAE,IACnBwL,YAAarI,EAAMC,OAAO7F,YAC1BkO,YAAatI,EAAMb,WAAa,EAAI,EACpC0X,SAAU,WAEZiK,QAAS,CACPhf,gBAAiB9B,EAAMb,WACnBa,EAAMC,OAAOnE,QACbkE,EAAMC,OAAO1E,SAEnB0G,OAAQ,CACNC,cAAe,MACfE,eAAgB,gBAChBD,WAAY,aACZ6B,aAAchE,EAAMvC,QAAQZ,IAE9BkkB,cAAe,CACblf,KAAM,GAERmf,KAAM,CACJxe,SAAUxC,EAAM7D,WAAWO,UAAUE,GACrC8F,MAAO1C,EAAMC,OAAOhG,cACpByJ,WAAY1D,EAAM7D,WAAWC,aAAaE,OAC1C0H,aAAchE,EAAMvC,QAAQd,GAAK,GAEnCskB,KAAM,CACJze,SAAUxC,EAAM7D,WAAWO,UAAUC,GACrC+F,MAAO1C,EAAMC,OAAO/F,aACpBwJ,WAAY1D,EAAM7D,WAAWC,aAAaC,SAE5C6kB,eAAgB,CACdpf,gBAAiB9B,EAAMC,OAAOhF,YAC9B0C,aAAcqC,EAAMrC,aAAaC,KACjCyE,QAASrC,EAAMvC,QAAQb,GACvB8J,WAAY1G,EAAMvC,QAAQZ,IAE5B9R,MAAO,CACLyX,SAAUxC,EAAM7D,WAAWO,UAAUK,GACrC0F,WAAY,MACZC,MAAO1C,EAAMC,OAAOjG,KACpBgK,aAAchE,EAAMvC,QAAQZ,GAC5B6G,WAAY1D,EAAM7D,WAAWC,aAAaG,SAC1C4kB,WAAYnhB,EAAM7D,WAAWgB,YAAYC,MAAQ4C,EAAM7D,WAAWO,UAAUK,IAE9E/R,QAAS,CACPwX,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC6F,MAAO1C,EAAMC,OAAOhG,cACpB+J,aAAchE,EAAMvC,QAAQX,GAC5BqkB,WAAYnhB,EAAM7D,WAAWgB,YAAYE,OAAS2C,EAAM7D,WAAWO,UAAUG,GAC7E6G,WAAY1D,EAAM7D,WAAWC,aAAaC,SAE5C+kB,cAAe,CACblf,cAAe,MACfmf,SAAU,OACVrd,aAAchE,EAAMvC,QAAQb,IAE9BrP,IAAK,CACHuU,gBAAiB9B,EAAMb,WAAaa,EAAMC,OAAOpE,QAAUmE,EAAMC,OAAOxG,aAAe,KACvFkE,aAAcqC,EAAMrC,aAAaC,KACjCoF,kBAAmBhD,EAAMvC,QAAQZ,GACjCkG,gBAAiB/C,EAAMvC,QAAQb,GAC/BuM,YAAanJ,EAAMvC,QAAQb,GAC3BoH,aAAchE,EAAMvC,QAAQb,GAC5B0L,YAAa,EACbD,YAAarI,EAAMb,WAAaa,EAAMC,OAAOrE,QAAUoE,EAAMC,OAAOxG,aAAe,MAErF6nB,QAAS,CACP9e,SAAUxC,EAAM7D,WAAWO,UAAUC,GACrC+F,MAAO1C,EAAMb,WAAaa,EAAMC,OAAOjG,KAAOgG,EAAMC,OAAOzG,QAC3DkK,WAAY1D,EAAM7D,WAAWC,aAAaE,OAC1CmG,WAAY,OAEd8e,kBAAmB,CACjBzf,gBAAiB9B,EAAMC,OAAOxE,QAC9BkC,aAAcqC,EAAMrC,aAAaC,KACjCoF,kBAAmBhD,EAAMvC,QAAQZ,GACjCkG,gBAAiB/C,EAAMvC,QAAQb,GAC/BuM,YAAanJ,EAAMvC,QAAQb,GAC3BoH,aAAchE,EAAMvC,QAAQb,IAE9B4kB,aAAc,CACZhf,SAAUxC,EAAM7D,WAAWO,UAAUC,GACrC+F,MAAO1C,EAAMC,OAAOhG,cACpByJ,WAAY1D,EAAM7D,WAAWC,aAAaE,QAE5CmlB,WAAY,CACV9K,SAAU,WACV+K,OAAQ,EACRC,KAAM,EACNC,MAAO,EACP3jB,OAAQ,EACR6D,gBAAiB9B,EAAMC,OAAOzG,QAC9BqoB,uBAAwB7hB,EAAMrC,aAAaZ,GAC3C+kB,wBAAyB9hB,EAAMrC,aAAaZ,KAE7C,EAEH,SAhOgD,SAAH3V,GAAmC,IAA7B26B,EAAK36B,EAAL26B,MAAOhc,EAAO3e,EAAP2e,QAASH,EAAKxe,EAALwe,MACzD5F,EAAUG,KAAVH,MACF0B,EAASyE,GAAUnG,GACzBzJ,GAAkCC,EAAAA,EAAAA,WAAS,GAAMC,GAAAC,EAAAA,EAAAA,SAAAH,EAAA,GAA1CyrB,EAASvrB,EAAA,GAAEwrB,EAAYxrB,EAAA,GACxB6gB,GAAYC,EAAAA,EAAAA,QAAO,IAAIC,GAAAA,QAASC,MAAM,IAAIC,QAQ1CwK,GAAgBC,EAAAA,GAAAA,SACQ,kBAArBJ,EAAMn2B,YAA0Bw2B,EAAAA,GAAAA,SAASL,EAAMn2B,YAAcm2B,EAAMn2B,WAC1E,gBAGIy2B,GAAgBF,EAAAA,GAAAA,SACQ,kBAArBJ,EAAMn2B,YAA0Bw2B,EAAAA,GAAAA,SAASL,EAAMn2B,YAAcm2B,EAAMn2B,WAC1E,UA6BI02B,EAAgB,CACpB9J,UAAW,CAAC,CAAEC,MAAOnB,IACrBP,QAASO,EAAUe,YAAY,CAC7BC,WAAY,CAAC,IAAM,GACnBC,YAAa,CAAC,GAAK,MAIvB,OACErf,EAAAA,EAAAA,KAACse,GAAAA,QAAS3R,KAAI,CAACD,MAAO,CAAC0c,EAAe1c,GAAOtP,UAC3CoP,EAAAA,EAAAA,MAAC6c,GAAAA,QAAS,CACR3c,MAAO,CACLlE,EAAOE,UACPogB,GAAatgB,EAAOof,SAEtB/a,QArBc,WACdA,GACFA,EAAQgc,EAEZ,EAkBMpJ,UA1CgB,WACpBsJ,GAAa,GACbzK,GAAAA,QAASsB,OAAOxB,EAAW,CACzBW,QAAS,IACT1B,gBAAAA,GACAyC,QAAS,IACTC,SAAU,IACTf,OACL,EAmCMa,WAjCiB,WACrBkJ,GAAa,GACbzK,GAAAA,QAASsB,OAAOxB,EAAW,CACzBW,QAAS,EACT1B,gBAAAA,GACAyC,QAAS,IACTC,SAAU,IACTf,OACL,EA0BMb,OAAO,eAAc/gB,SAAA,EAGrBoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOO,OAAO3L,SAAA,EACzBoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOqf,cAAczqB,SAAA,EAChC4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOsf,KAAM3J,OAAO,eAAc/gB,SAAE4rB,KACjDhpB,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOuf,KAAK3qB,SAAE+rB,OAE5BN,EAAMl2B,YACLqN,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAOwf,eAAe5qB,UACjC4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,gBAAgBvO,KAAM,GAAIggB,MAAO1C,EAAMC,OAAOjF,cAMlE+mB,EAAMh3B,QACLmO,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO3W,MAAOssB,OAAO,gBAAgBmL,cAAe,EAAElsB,SAChEyrB,EAAMh3B,SAKXmO,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CACHL,MAAOlE,EAAO1W,QACdw3B,cAAe,EACfnL,OAAO,kBAAiB/gB,SAtFT,SAACtL,GAA8C,IAA7By3B,EAAiB5/B,UAAAK,OAAA,QAAA0B,IAAA/B,UAAA,GAAAA,UAAA,GAAG,IAC3D,OAAKmI,EACDA,EAAQ9H,QAAUu/B,EAAkBz3B,EAC9BA,EAAQ5B,UAAU,EAAGq5B,GAAU,MAFpB,YAGvB,CAoFSC,CAAeX,EAAM/2B,WAIvB+2B,EAAMj2B,MAAQi2B,EAAMj2B,KAAK5I,OAAS,IACjCwiB,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAO0f,cAAe/J,OAAO,iBAAgB/gB,SAAA,CACvDyrB,EAAMj2B,KAAK62B,MAAM,EAAG,GAAGlG,KAAI,SAAClvB,EAAUq1B,GAAa,IAAAC,EAAA,OAClD3pB,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAAwDD,MAAOlE,EAAOnU,IAAK8pB,OAAM,QAAe,OAAfwL,EAASt1B,EAAI3C,IAAEi4B,EAAID,GAAQtsB,UAC/G4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO4f,QAAQhrB,SAAE/I,EAAI0D,QADtB8wB,EAAMn3B,GAAE,SAAQ2C,EAAI3C,IAAMg4B,GAAK,IAAIr1B,EAAI0D,KAE9C,IAER8wB,EAAMj2B,KAAK5I,OAAS,IACnBgW,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAA+BD,MAAOlE,EAAO6f,kBAAkBjrB,UAClEoP,EAAAA,EAAAA,MAACO,EAAAA,QAAI,CAACL,MAAOlE,EAAO8f,aAAalrB,SAAA,CAAC,IAAEyrB,EAAMj2B,KAAK5I,OAAS,MAD5C6+B,EAAMn3B,GAAE,kBAQ5BsO,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAO+f,iBAI5B,EC5HA,IAqBMtb,GAAY,SAACnG,GAAe,OAAK2B,EAAAA,QAAWxb,OAAO,CACvD8b,OAAQ,CACNH,gBAAiB9B,EAAMC,OAAOlG,KAC9BiJ,kBAAmBhD,EAAMvC,QAAQX,GACjCiG,gBAAiB/C,EAAMvC,QAAQX,GAC/BwF,kBAAmB,EACnBC,kBAAmBvC,EAAMC,OAAO9F,OAChCgI,WAAY,UAEdpX,MAAO,CACLyX,SAAUxC,EAAM7D,WAAWO,UAAUK,GACrC0F,WAAY,OACZC,MAAO1C,EAAMC,OAAOjG,KACpB0J,WAAY1D,EAAM7D,WAAWC,aAAaI,MAE5CsmB,mBAAoB,CAClB5gB,cAAe,MACfC,WAAY,SACZoB,UAAWvD,EAAMvC,QAAQd,GACzBqG,kBAAmBhD,EAAMvC,QAAQb,GACjCmG,gBAAiB/C,EAAMvC,QAAQd,GAC/BmF,gBAAiB9B,EAAMC,OAAOxG,cAAgBuG,EAAMC,OAAOzG,QAAU,KACrEmE,aAAc,IAEhBolB,cAAe,CACbvgB,SAAUxC,EAAM7D,WAAWO,UAAUC,GACrC+F,MAAO1C,EAAMC,OAAOzG,QACpBkN,WAAY1G,EAAMvC,QAAQd,GAC1B+G,WAAY1D,EAAM7D,WAAWC,aAAaE,SAE3C,EAEH,SArDkD,SAAHlV,GAIxC,IAHL2D,EAAK3D,EAAL2D,MAAKi4B,EAAA57B,EACL67B,uBAAAA,OAAsB,IAAAD,GAAQA,EAAAE,EAAA97B,EAC9B27B,cAAAA,OAAa,IAAAG,EAAG,qBAAoBA,EAE5BljB,EAAUG,KAAVH,MACF0B,EAASyE,GAAUnG,GAEzB,OACE0F,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOO,OAAO3L,SAAA,EACzB4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO3W,MAAMuL,SAAEvL,IAC3Bk4B,IACCvd,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOohB,mBAAmBxsB,SAAA,EACrC4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,mBAAmBvO,KAAM,GAAIggB,MAAO1C,EAAMC,OAAOzG,WAChEN,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOqhB,cAAczsB,SAAEysB,SAK9C,ECVA,IAAMI,GAAqC,CACzCC,QAAS,CACP,wCACA,uCACA,0DACA,wEACA,2CACA,8DACA,0CACA,8DACA,qDACA,sDACA,sDACA,8DACA,yCACA,6CACA,6CACA,uDACA,oDACA,+DAEFC,UAAW,CACT,0CACA,iDACA,wDACA,0EACA,uDACA,2DACA,sDACA,0DACA,2DACA,gDACA,oDACA,uDACA,oDACA,2DACA,wDACA,qDACA,iDACA,4DAEFC,QAAS,CACP,wCACA,6DACA,2CACA,sDACA,mDACA,gDACA,qDACA,4DACA,4DACA,mDACA,oDACA,2DACA,yDACA,2DACA,yDACA,0DACA,2DACA,6DAEFC,SAAU,CACR,oCACA,0DACA,6DACA,6DACA,+CACA,+DACA,kDACA,yDACA,sEACA,yDACA,kEACA,wDACA,8DACA,mDACA,wEACA,gEACA,yDACA,+DAOCC,GAAU,SAAVA,GAAU,OAAVA,EAAU,kBAAVA,EAAU,sBAAVA,EAAU,kBAAVA,EAAU,qBAAVA,CAAU,EAAVA,IAAU,IAUf,SAASC,KACP,IACMC,GADM,IAAIhgC,MACCigC,WAEjB,OAAID,GAAQ,GAAKA,EAAO,GACfF,GAAWI,QACTF,GAAQ,IAAMA,EAAO,GACvBF,GAAWK,UACTH,GAAQ,IAAMA,EAAO,GACvBF,GAAWM,QAEXN,GAAWO,SAEtB,CA2BO,SAASC,KAEC,IADfC,EAAgBphC,UAAAK,OAAA,QAAA0B,IAAA/B,UAAA,GAAAA,UAAA,GAAG,QAEbqhC,EAAaT,KACbU,EAAgBhB,GAAee,GAG/BE,EA5BR,SAA0BC,EAAqBH,GAO7C,IANA,IAEMI,GAFQ,IAAI5gC,MACO6gC,eACCL,EAGtBluB,EAAO,EACFjC,EAAI,EAAGA,EAAIuwB,EAAKphC,OAAQ6Q,IAE/BiC,GAASA,GAAQ,GAAKA,EADTsuB,EAAKtwB,WAAWD,GAE7BiC,GAAOA,EAGT,OAAOkL,KAAKsjB,IAAIxuB,GAAQquB,CAC1B,CAcoBI,CAAiBN,EAAcjhC,OAAQghC,GAGzD,MAAO,CACLQ,aAHmBP,EAAcC,GAAWr9B,QAAQ,aAAck9B,GAKtE,CCzIA,IAmSM9d,GAAY,SAACnG,GAAe,OAAK2B,EAAAA,QAAWxb,OAAO,CACvDyb,UAAW,CACTC,KAAM,EACNC,gBAAiB9B,EAAMC,OAAOpG,YAEhCoO,gBAAiB,CACfpG,KAAM,GAERwB,iBAAkB,CAChBxB,KAAM,EACNO,eAAgB,SAChBD,WAAY,SACZL,gBAAiB9B,EAAMC,OAAOpG,YAEhC8qB,kBAAmB,CACjB3hB,kBAAmBhD,EAAMvC,QAAQX,GACjCiF,WAAY/B,EAAMvC,QAAQZ,GAC1BoE,cAAejB,EAAMvC,QAAQX,IAE/B8nB,aAAc,CACZ9iB,gBAAiB9B,EAAMC,OAAOlG,KAC9B4D,aAAcqC,EAAMrC,aAAaZ,GACjCsF,QAASrC,EAAMvC,QAAQX,GACvBsB,UAAW4B,EAAMb,WAAa,EAAI,EAClCrB,YAAakC,EAAMC,OAAOrF,OAC1BmD,aAAc,CAAEC,MAAO,EAAGC,OAAQ+B,EAAMb,WAAa,EAAI,GACzDjB,cAAe8B,EAAMb,WAAa,IAAO,IACzChB,aAAc6B,EAAMb,WAAa,EAAI,EACrCkJ,YAAarI,EAAMb,WAAaa,EAAMC,OAAO9F,OAAS,cACtDmO,YAAatI,EAAMb,WAAa,EAAI,GAEtC0lB,gBAAiB,CACf1iB,WAAY,cAEd2iB,SAAU,CACRtiB,SAAUxC,EAAM7D,WAAWO,UAAUK,GACrC0F,WAAY,MACZC,MAAO1C,EAAMC,OAAOjG,KACpB0J,WAAY1D,EAAM7D,WAAWC,aAAaG,SAC1C4kB,WAAYnhB,EAAM7D,WAAWgB,YAAYC,MAAQ4C,EAAM7D,WAAWO,UAAUK,IAG9EikB,KAAM,CACJxe,SAAUxC,EAAM7D,WAAWO,UAAUI,GACrC4F,MAAO1C,EAAMC,OAAOhG,cACpBsJ,UAAWvD,EAAMvC,QAAQb,GACzB8G,WAAY1D,EAAM7D,WAAWC,aAAaC,QAC1C8kB,WAAYnhB,EAAM7D,WAAWgB,YAAYE,OAAS2C,EAAM7D,WAAWO,UAAUI,IAE/EioB,eAAgB,CACd7iB,cAAe,MACfE,eAAgB,SAChBD,WAAY,SACZa,kBAAmBhD,EAAMvC,QAAQX,GACjCiG,gBAAiB/C,EAAMvC,QAAQX,GAC/BkoB,IAAKhlB,EAAMvC,QAAQZ,IAErBooB,SAAU,CACRnjB,gBAAiB9B,EAAMC,OAAOlG,KAC9B4D,aAAc,GACd0E,QAASrC,EAAMvC,QAAQX,GACvBqF,WAAY,SACZnE,MAAO,MACPI,UAAW4B,EAAMb,WAAa,EAAI,EAClCrB,YAAakC,EAAMC,OAAO7E,MAC1B2C,aAAc,CAAEC,MAAO,EAAGC,OAAQ+B,EAAMb,WAAa,EAAI,GACzDjB,cAAe8B,EAAMb,WAAa,GAAM,IACxChB,aAAc6B,EAAMb,WAAa,EAAI,EACrCkJ,YAAarI,EAAMb,WAAaa,EAAMC,OAAO9F,OAAS,cACtDmO,YAAatI,EAAMb,WAAa,EAAI,GAEtC+lB,WAAY,CACVpjB,gBAAiB9B,EAAMb,WAAaa,EAAMC,OAAOlG,KAAO,UACxDsO,YAAarI,EAAMb,WAAaa,EAAMC,OAAO9F,OAAS,UACtDmO,YAAa,GAEf6c,SAAU,CACRnhB,aAAchE,EAAMvC,QAAQb,IAE9BwoB,UAAW,CACT5iB,SAAUxC,EAAM7D,WAAWO,UAAUM,IACrCyF,WAAY,OACZC,MAAO1C,EAAMC,OAAOzG,QACpBkK,WAAY1D,EAAM7D,WAAWC,aAAaI,KAC1CwH,aAAchE,EAAMvC,QAAQd,IAE9B0oB,YAAa,CACX3iB,MAAO,WAET4iB,UAAW,CACT5iB,MAAO1C,EAAMC,OAAOtG,WAEtB4rB,UAAW,CACT/iB,SAAUxC,EAAM7D,WAAWO,UAAUC,GACrC+F,MAAO1C,EAAMC,OAAOhG,cACpByJ,WAAY1D,EAAM7D,WAAWC,aAAaE,OAC1C2H,UAAW,SACXhG,OAAQ,GACRkjB,WAAY,IAEdqE,cAAe,CACbtjB,cAAe,MACfE,eAAgB,gBAChBD,WAAY,SACZa,kBAAmBhD,EAAMvC,QAAQX,GACjCiF,WAAY/B,EAAMvC,QAAQX,GAC1BmE,cAAejB,EAAMvC,QAAQb,IAE/B6oB,aAAc,CACZjjB,SAAUxC,EAAM7D,WAAWO,UAAUK,GACrC0F,WAAY,OACZC,MAAO1C,EAAMC,OAAOjG,KACpB0J,WAAY1D,EAAM7D,WAAWC,aAAaI,MAE5CkpB,WAAY,CACVljB,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC6F,MAAO1C,EAAMC,OAAOzG,QACpBkK,WAAY1D,EAAM7D,WAAWC,aAAaG,UAE5CopB,eAAgB,CACd9jB,KAAM,EACNO,eAAgB,SAChBD,WAAY,SACZE,QAASrC,EAAMvC,QAAQX,GACvByG,UAAWvD,EAAMvC,QAAQT,KAE3B4oB,UAAW,CACTpjB,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC6F,MAAO1C,EAAMC,OAAOhG,cACpBsJ,UAAWvD,EAAMvC,QAAQZ,GACzBmH,aAAchE,EAAMvC,QAAQX,GAC5B4G,WAAY1D,EAAM7D,WAAWC,aAAaC,SAE5CwpB,YAAa,CACX/jB,gBAAiB9B,EAAMC,OAAOzG,QAC9BuJ,gBAAiB/C,EAAMvC,QAAQZ,GAC/BmG,kBAAmBhD,EAAMvC,QAAQV,GACjCY,aAAc,GACd4F,UAAWvD,EAAMvC,QAAQZ,IAE3BipB,gBAAiB,CACfpjB,MAAO1C,EAAMb,WAAaa,EAAMC,OAAOpG,WAAamG,EAAMC,OAAO5E,MACjEmH,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC4F,WAAY,OACZiB,WAAY1D,EAAM7D,WAAWC,aAAaI,MAG5CupB,cAAe,CACb/iB,kBAAmBhD,EAAMvC,QAAQX,GACjCiG,gBAAiB/C,EAAMvC,QAAQX,IAEjCkpB,UAAW,CACTxjB,SAAUxC,EAAM7D,WAAWO,UAAUK,GACrC0F,WAAY,OACZC,MAAO1C,EAAMC,OAAOjG,KACpB0J,WAAY1D,EAAM7D,WAAWC,aAAaI,KAC1CwH,aAAchE,EAAMvC,QAAQZ,GAC5BoH,UAAW,UAEbgiB,qBAAsB,CACpB/jB,cAAe,MACfE,eAAgB,gBAChBD,WAAY,UAEd+jB,WAAY,CACVpkB,gBAAiB9B,EAAMC,OAAOlG,KAC9B4D,aAAc,GACd0E,QAASrC,EAAMvC,QAAQZ,GACvBsF,WAAY,SACZC,eAAgB,SAChBpE,MAAO,MACPI,UAAW4B,EAAMb,WAAa,EAAI,EAClCrB,YAAakC,EAAMC,OAAOrF,OAC1BmD,aAAc,CAAEC,MAAO,EAAGC,OAAQ+B,EAAMb,WAAa,EAAI,GACzDjB,cAAe8B,EAAMb,WAAa,IAAO,IACzChB,aAAc6B,EAAMb,WAAa,EAAI,EACrCkJ,YAAarI,EAAMb,WAAaa,EAAMC,OAAO9F,OAAS,cACtDmO,YAAatI,EAAMb,WAAa,EAAI,GAEtCgnB,SAAU,CACRniB,aAAchE,EAAMvC,QAAQd,IAE9BypB,UAAW,CACT5jB,SAAUxC,EAAM7D,WAAWO,UAAUC,GACrC+F,MAAO1C,EAAMC,OAAOhG,cACpByJ,WAAY1D,EAAM7D,WAAWC,aAAaE,OAC1C2H,UAAW,WAGZ,EAEH,SA1dmB,WACjB,IAAMmG,GAAaC,EAAAA,GAAAA,iBACXhY,EAAS+G,KAAT/G,KACA2N,EAAUG,KAAVH,MACAke,EAAiB2C,KAAjB3C,aACFxc,EAASyE,GAAUnG,GAUzBzJ,GAA0CC,EAAAA,EAAAA,UAAyB,IAAGC,GAAAC,EAAAA,EAAAA,SAAAH,EAAA,GAA/D8vB,EAAa5vB,EAAA,GAAE6vB,EAAgB7vB,EAAA,GACtCI,GAA0BL,EAAAA,EAAAA,UAAS,CACjC+vB,aAAc,EACdC,cAAe,EACfC,gBAAiB,IACjB3vB,GAAAJ,EAAAA,EAAAA,SAAAG,EAAA,GAJK6vB,EAAK5vB,EAAA,GAAE6vB,EAAQ7vB,EAAA,GAKtBG,GAA8BT,EAAAA,EAAAA,WAAS,GAAKU,GAAAR,EAAAA,EAAAA,SAAAO,EAAA,GAArC0N,EAAOzN,EAAA,GAAE0N,EAAU1N,EAAA,GAC1BG,GAAoCb,EAAAA,EAAAA,WAAS,GAAMc,GAAAZ,EAAAA,EAAAA,SAAAW,EAAA,GAA5CuvB,EAAUtvB,EAAA,GAAEuvB,EAAavvB,EAAA,GAG1BwvB,GAA6BC,EAAAA,EAAAA,UAAQ,WACzC,OAAO/C,GAjBC,MAAJ3xB,GAAAA,EAAM20B,UACD30B,EAAK20B,UAAU9hB,MAAM,KAAK,GAE5B,QAeT,GAAG,CAAK,MAAJ7S,OAAI,EAAJA,EAAM20B,YAGJC,GAAmBF,EAAAA,EAAAA,UAAQ,WAC/B,OAAI7I,EACKmI,EAGFA,EAAcvzB,QAAO,SAAAivB,GAAK,OAC9BA,EAAMj2B,KAAKykB,MAAK,SAAChjB,GAAQ,MA5CP,kBA4CYA,EAAI0D,IAAyB,GAAC,GAEjE,GAAG,CAACo1B,EAAenI,KAGnBgJ,EAAAA,GAAAA,gBACEC,EAAAA,aAAkB,WAEhBC,GAIF,GAAG,MAIL5vB,EAAAA,EAAAA,YAAU,WACR,GAAI6uB,EAAcnjC,OAAS,EAAG,CAE5B,IAAMmkC,EAAMhB,EAAc5J,KAAI,SAAAsF,GAAK,OAAIA,EAAMn3B,EAAE,IACzC08B,GAASpL,EAAAA,GAAAA,SAAO,IAAIv6B,IAAI0lC,IAC1BA,EAAInkC,SAAWokC,EAAUpkC,QAC3BxC,EAAOsC,KAAK,4CAA6C,CAAEqkC,IAAAA,EAAKC,UAAAA,GAEpE,CACF,GAAG,CAACjB,KAGJ7uB,EAAAA,EAAAA,YAAU,WACR,GAAIyvB,EAAiB/jC,OAAS,EAAG,CAE/B,IAAMqkC,EAAeN,EAAiBxK,KAAI,SAAAsF,GAAK,OAAIA,EAAMn3B,EAAE,IACrD48B,GAAkBtL,EAAAA,GAAAA,SAAO,IAAIv6B,IAAI4lC,IACnCA,EAAarkC,SAAWskC,EAAmBtkC,QAC7CxC,EAAOsC,KAAK,sDAAuD,CAAEukC,aAAAA,EAAcC,mBAAAA,GAEvF,CACF,GAAG,CAACP,IAEJ,IAAMG,EAAS,eAAAhgC,GAAApF,EAAAA,EAAAA,UAAG,YAChB,IAAK,IAADylC,EAAAC,EACF9iB,GAAW,GAGX,IAAM+iB,QAAsB1hC,EAAIyE,IAAI,uBACpCi8B,EAAS,CACPJ,aAAcoB,EAAc7jC,KAAK8jC,cACjCpB,cAAemB,EAAc7jC,KAAK+jC,eAClCpB,gBAAiBkB,EAAc7jC,KAAKgkC,oBAItC,IAAMC,QAAwB9hC,EAAIyE,IAAI,iBAAkB,CACtDD,OAAQ,CACNyC,MAAO,EACP86B,KAAM,qBAGJtU,EAAUtwB,MAAM8G,QAAQ69B,EAAgBjkC,MAC1CikC,EAAgBjkC,KACc,OADV2jC,EACC,OADDC,EACnBK,EAAgBjkC,WAAI,EAApB4jC,EAAsBhU,SAAO+T,EAAI,GACtCnB,EAAiB5S,EAEnB,CAAE,MAAO/wB,GAAa,IAADsF,EAAAC,EAEnBxH,EAAOiC,MAAM,uCAAwC,CACnDW,QAASX,EAAMW,QACfyE,OAAsB,OAAhBE,EAAEtF,EAAMkF,eAAQ,EAAdI,EAAgBF,OACxBjE,KAAoB,OAAhBoE,EAAEvF,EAAMkF,eAAQ,EAAdK,EAAgBpE,OAItBmkC,GAAAA,QAAMC,MAAM,QAAS,2BAEzB,CAAC,QACCtjB,GAAW,GACXiiB,GAAc,EAChB,CACF,IAAC,kBAvCc,OAAAz/B,EAAAxE,MAAA,KAAAC,UAAA,KA4DTslC,EAAkB,SAACC,EAAgB76B,GAEvC,IASM86B,EATsC,CAC1CC,SAAU,6BACVC,QAAS,4BACTC,SAAU,qCACVC,SAAU,2CACVC,KAAM,kCAImBN,GAC3Bhe,EAAW0B,SAAS,SAAU,CAC5B6c,UAAWP,EACXQ,QAASr7B,EACTs7B,gBAAiBR,GAErB,EAEA,OAAI1jB,IAAYiiB,GAEZ1tB,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAO2B,iBAAiB/M,UACnC4C,EAAAA,EAAAA,KAACgN,GAAAA,QAAiB,CAACxjB,KAAK,QAAQggB,MAAO1C,EAAMC,OAAOzG,QAAS6d,OAAO,yBAMxE3R,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOE,UAAUtL,SAAA,EAC5B4C,EAAAA,EAAAA,KAAC4vB,GAAY,CAAC/9B,MAAM,UAEpB2a,EAAAA,EAAAA,MAACtF,GAAc,CACbwF,MAAOlE,EAAOuG,gBACd8gB,eACkB,QAAhB9nC,EAAAA,QAASC,IACPgY,EAAAA,EAAAA,KAAC8vB,GAAAA,QAAc,CAACpC,WAAYA,EAAYqC,UAtDhC,WAChBpC,GAAc,GACdO,GACF,EAmDwEnnB,OAAQ,CAACD,EAAMC,OAAOzG,SAAU0vB,UAAWlpB,EAAMC,OAAOzG,eACpH5U,EACL0R,SAAA,EAED4C,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAOijB,kBAAkBruB,UACpC4C,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAOkjB,aAAatuB,UAC/BoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOmjB,gBAAgBvuB,SAAA,EAClC4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOojB,SAASxuB,SAAEwwB,EAAapC,gBAC5CxrB,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOsf,KAAK1qB,UAAE6rB,EAAAA,GAAAA,SAAO,IAAIz+B,KAAQ,0BAK9CgiB,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOqjB,eAAezuB,SAAA,EACzCoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOujB,SAAS3uB,SAAA,EAC3B4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,OAAOvO,KAAM,GAAIggB,MAAO1C,EAAMC,OAAOzG,QAASoM,MAAOlE,EAAOyjB,YAC3EjsB,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO0jB,UAAU9uB,SAAEowB,EAAMH,gBACtCrtB,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO6jB,UAAUjvB,SAAC,gBAEjCoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAO,CAAClE,EAAOujB,SAAUvjB,EAAOwjB,YAAY5uB,SAAA,EAChD4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,QAAQvO,KAAM,GAAIggB,MAAM,UAAUkD,MAAOlE,EAAOyjB,YAC/DjsB,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAO,CAAClE,EAAO0jB,UAAW1jB,EAAO2jB,aAAa/uB,SAAEowB,EAAMF,iBAC5DttB,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO6jB,UAAUjvB,SAAC,eAEjCoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOujB,SAAS3uB,SAAA,EAC3B4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,WAAWvO,KAAM,GAAIggB,MAAO1C,EAAMC,OAAOtG,UAAWiM,MAAOlE,EAAOyjB,YACjFjsB,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAO,CAAClE,EAAO0jB,UAAW1jB,EAAO4jB,WAAWhvB,SAAEowB,EAAMD,mBAC1DvtB,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO6jB,UAAUjvB,SAAC,gBAKnCoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOqkB,cAAczvB,SAAA,EAChC4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOskB,UAAU1vB,SAAC,oCAC/BoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOukB,qBAAqB3vB,SAAA,EACvCoP,EAAAA,EAAAA,MAACI,GAAAA,QAAgB,CACfF,MAAOlE,EAAOwkB,WACdngB,QAAS,WAAF,OAAQoiB,EAAgB,WAAY,YAAY,EACvDjP,cAAe,GAAI5iB,SAAA,EAEnB4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,gBAAgBvO,KAAM,GAAIggB,MAAM,UAAUkD,MAAOlE,EAAOykB,YACvEjtB,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO0kB,UAAU9vB,SAAC,iBAGjCoP,EAAAA,EAAAA,MAACI,GAAAA,QAAgB,CACfF,MAAOlE,EAAOwkB,WACdngB,QAAS,WAAF,OAAQoiB,EAAgB,UAAW,aAAa,EACvDjP,cAAe,GAAI5iB,SAAA,EAEnB4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,eAAevO,KAAM,GAAIggB,MAAM,UAAUkD,MAAOlE,EAAOykB,YACtEjtB,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO0kB,UAAU9vB,SAAC,mBAGjCoP,EAAAA,EAAAA,MAACI,GAAAA,QAAgB,CACfF,MAAOlE,EAAOwkB,WACdngB,QAAS,WAAF,OAAQoiB,EAAgB,WAAY,OAAO,EAClDjP,cAAe,GAAI5iB,SAAA,EAEnB4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,eAAevO,KAAM,GAAIggB,MAAM,UAAUkD,MAAOlE,EAAOykB,YACtEjtB,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO0kB,UAAU9vB,SAAC,iBAGjCoP,EAAAA,EAAAA,MAACI,GAAAA,QAAgB,CACfF,MAAOlE,EAAOwkB,WACdngB,QAAS,WAAF,OAAQoiB,EAAgB,WAAY,SAAS,EACpDjP,cAAe,GAAI5iB,SAAA,EAEnB4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,gBAAgBvO,KAAM,GAAIggB,MAAM,UAAUkD,MAAOlE,EAAOykB,YACvEjtB,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO0kB,UAAU9vB,SAAC,iBAGjCoP,EAAAA,EAAAA,MAACI,GAAAA,QAAgB,CACfF,MAAOlE,EAAOwkB,WACdngB,QAAS,WAAF,OAAQoiB,EAAgB,OAAQ,OAAO,EAC9CjP,cAAe,GAAI5iB,SAAA,EAEnB4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,0BAA0BvO,KAAM,GAAIggB,MAAM,UAAUkD,MAAOlE,EAAOykB,YACjFjtB,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO0kB,UAAU9vB,SAAC,uBAKrCoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAO8jB,cAAclvB,SAAA,EAChC4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO+jB,aAAanvB,SAAC,gBAClC4C,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CAACC,QAhIM,WAC5BqE,EAAW0B,SAAS,UAAW,CAAEC,OAAQ,eAC3C,EA8HuDzV,UAC/C4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOgkB,WAAWpvB,SAAC,iBAInC2wB,EAAiB/jC,OAAS,GACzBgW,EAAAA,EAAAA,KAACiwB,GAAW,CAEVpH,MAAOkF,EAAiB,GACxBlhB,QAAS,WAAF,OArIWqjB,EAqIcnC,EAAiB,GAAGr8B,QAnI1Dwf,EAAW0B,SAAS,qBAAsB,CAAEsd,QAASA,EAAQ1I,aAFtC,IAAC0I,CAqIqC,GAAC,cAFrCnC,EAAiB,GAAGr8B,KAKzC8a,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOikB,eAAervB,SAAA,EACjC4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,eAAevO,KAAMsd,EAAMvC,QAAQT,IAAK0F,MAAO1C,EAAMC,OAAOxF,YAC3EvB,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOkkB,UAAUtvB,SAAC,4BAC/B4C,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CACfF,MAAOlE,EAAOmkB,YACd9f,QAtJe,WAEvBqE,EAAW0B,SAAS,SACtB,EAmJoCxV,UAE1B4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOokB,gBAAgBxvB,SAAC,+BAOjD,E,eCpTM+yB,GAAgD,SAAHjiC,GAM5C,IAADkiC,EAAAliC,EALJ4W,MAAAA,OAAK,IAAAsrB,EAAG,OAAMA,EAAAC,EAAAniC,EACd6W,OAAAA,OAAM,IAAAsrB,EAAG,GAAEA,EAAAC,EAAApiC,EACXuW,aAAAA,OAAY,IAAA6rB,EAAG,EAACA,EAChB5jB,EAAKxe,EAALwe,MAAK6jB,EAAAriC,EACLsiC,SAAAA,OAAQ,IAAAD,GAAOA,EAEPzpB,EAAUG,KAAVH,MACF0B,EAASyE,GAAUnG,GACnB2pB,GAAgBpS,EAAAA,EAAAA,QAAO,IAAIC,GAAAA,QAASC,MAAM,IAAIC,SAEpDlgB,EAAAA,EAAAA,YAAU,WACR,GAAIkyB,EAAU,CACZ,IAAME,EAAYpS,GAAAA,QAASM,KACzBN,GAAAA,QAASO,SAAS,CAChBP,GAAAA,QAASQ,OAAO2R,EAAe,CAC7B1R,QAAS,EACT3Z,SAAU,IACViY,iBAAiB,IAEnBiB,GAAAA,QAASQ,OAAO2R,EAAe,CAC7B1R,QAAS,EACT3Z,SAAU,IACViY,iBAAiB,OAKvB,OADAqT,EAAU1R,QACH,kBAAM0R,EAAUzR,MAAO,CAChC,CACF,GAAG,CAACuR,EAAUC,IAEd,IAAM7nB,EAAkB4nB,EACpBC,EAActR,YAAY,CACxBC,WAAY,CAAC,EAAG,GAChBC,YAAa,CACXvY,EAAMC,OAAOjE,UAAYgE,EAAMC,OAAOzE,QACtCwE,EAAMC,OAAOhE,mBAAqB+D,EAAMC,OAAOxE,WAGnDuE,EAAMC,OAAOjE,UAAYgE,EAAMC,OAAOzE,QAE1C,OACEtC,EAAAA,EAAAA,KAACse,GAAAA,QAAS3R,KAAI,CACZD,MAAO,CACLlE,EAAO1F,SACP,CACEgC,MAAAA,EACAC,OAAAA,EACAN,aAAAA,EACAmE,gBAAAA,GAEF8D,IAIR,EAGaikB,GAAgC,WAC3C,IAAQ7pB,EAAUG,KAAVH,MACF0B,EAASyE,GAAUnG,GAEzB,OACE0F,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOooB,oBAAoBxzB,SAAA,EACtCoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOqoB,kBAAkBzzB,SAAA,EACpC4C,EAAAA,EAAAA,KAACmwB,GAAc,CAACrrB,MAAM,MAAMC,OAAQ,MACpC/E,EAAAA,EAAAA,KAACmwB,GAAc,CAACrrB,MAAO,GAAIC,OAAQ,SAErC/E,EAAAA,EAAAA,KAACmwB,GAAc,CAACrrB,MAAM,OAAOC,OAAQ,GAAI2H,MAAO,CAAErC,UAAWvD,EAAMvC,QAAQb,OAC3E1D,EAAAA,EAAAA,KAACmwB,GAAc,CAACrrB,MAAM,MAAMC,OAAQ,GAAI2H,MAAO,CAAErC,UAAWvD,EAAMvC,QAAQd,OAC1EzD,EAAAA,EAAAA,KAACmwB,GAAc,CAACrrB,MAAM,MAAMC,OAAQ,GAAI2H,MAAO,CAAErC,UAAWvD,EAAMvC,QAAQd,OAC1E+I,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOsoB,kBAAkB1zB,SAAA,EACpC4C,EAAAA,EAAAA,KAACmwB,GAAc,CAACrrB,MAAO,GAAIC,OAAQ,MACnC/E,EAAAA,EAAAA,KAACmwB,GAAc,CAACrrB,MAAO,GAAIC,OAAQ,UAI3C,EAEagsB,GAA6B,WACxC,IAAQjqB,EAAUG,KAAVH,MACF0B,EAASyE,GAAUnG,GAEzB,OACE0F,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOwoB,iBAAiB5zB,SAAA,EAEnCoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOyoB,eAAe7zB,SAAA,EACjC4C,EAAAA,EAAAA,KAACmwB,GAAc,CAACrrB,MAAO,GAAIC,OAAQ,GAAIN,aAAc,MACrDzE,EAAAA,EAAAA,KAACmwB,GAAc,CAACrrB,MAAO,IAAKC,OAAQ,MACpC/E,EAAAA,EAAAA,KAACmwB,GAAc,CAACrrB,MAAO,GAAIC,OAAQ,GAAIN,aAAc,SAIvDzE,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAO0oB,aAAa9zB,SAC9BlT,MAAM0R,KAAK,CAAE5R,OAAQ,KAAM,SAACmnC,EAAGzH,GAAK,OACnC1pB,EAAAA,EAAAA,KAACmwB,GAAc,CAEbrrB,MAAO,GACPC,OAAQ,GACRN,aAAc,EACdiI,MAAO,CAAE0kB,OAAQ,IAJZ1H,EAKL,QAKZ,EAEa2H,GAA6B,WACxC,IAAQvqB,EAAUG,KAAVH,MACF0B,EAASyE,GAAUnG,GAEzB,OACE9G,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAO8oB,iBAAiBl0B,SAClClT,MAAM0R,KAAK,CAAE5R,OAAQ,IAAK,SAACmnC,EAAGzH,GAAK,OAClCld,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAAaD,MAAOlE,EAAO+oB,YAAYn0B,SAAA,EAC1CoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOgpB,gBAAgBp0B,SAAA,EAClC4C,EAAAA,EAAAA,KAACmwB,GAAc,CAACrrB,MAAO,GAAIC,OAAQ,GAAIN,aAAc,MACrD+H,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOipB,gBAAgBr0B,SAAA,EAClC4C,EAAAA,EAAAA,KAACmwB,GAAc,CAACrrB,MAAM,MAAMC,OAAQ,MACpC/E,EAAAA,EAAAA,KAACmwB,GAAc,CAACrrB,MAAM,MAAMC,OAAQ,GAAI2H,MAAO,CAAErC,UAAWvD,EAAMvC,QAAQd,aAG9EzD,EAAAA,EAAAA,KAACmwB,GAAc,CAACrrB,MAAO,GAAIC,OAAQ,GAAIN,aAAc,OAR5CilB,EASJ,KAIf,EAEMzc,GAAY,SAACnG,GACC4qB,GAAAA,QAAWlgC,IAAI,UAAzBsT,MAER,OAAO2D,EAAAA,QAAWxb,OAAO,CACvB6V,SAAU,CACR6a,SAAU,UAEZiT,oBAAqB,CACnBhoB,gBAAiB9B,EAAMC,OAAOlG,KAC9BsI,QAASrC,EAAMvC,QAAQZ,GACvBoG,iBAAkBjD,EAAMvC,QAAQZ,GAChC2M,eAAgBxJ,EAAMvC,QAAQb,GAC9Be,aAAcqC,EAAMvC,QAAQb,GAC5B0L,YAAa,EACbD,YAAarI,EAAMC,OAAO9F,QAE5B4vB,kBAAmB,CACjB7nB,cAAe,MACfE,eAAgB,gBAChBD,WAAY,SACZ6B,aAAchE,EAAMvC,QAAQb,IAE9BotB,kBAAmB,CACjB9nB,cAAe,MACfE,eAAgB,gBAChBD,WAAY,SACZoB,UAAWvD,EAAMvC,QAAQZ,IAE3BqtB,iBAAkB,CAChBpoB,gBAAiB9B,EAAMC,OAAOlG,KAC9BsI,QAASrC,EAAMvC,QAAQZ,GACvBytB,OAAQtqB,EAAMvC,QAAQZ,GACtBc,aAAcqC,EAAMvC,QAAQb,IAE9ButB,eAAgB,CACdjoB,cAAe,MACfE,eAAgB,gBAChBD,WAAY,SACZ6B,aAAchE,EAAMvC,QAAQZ,IAE9ButB,aAAc,CACZloB,cAAe,MACfmf,SAAU,OACVjf,eAAgB,gBAElBooB,iBAAkB,CAChBnoB,QAASrC,EAAMvC,QAAQZ,IAEzB4tB,YAAa,CACXvoB,cAAe,MACfE,eAAgB,gBAChBD,WAAY,SACZY,gBAAiB/C,EAAMvC,QAAQZ,GAC/ByF,kBAAmB,EACnBC,kBAAmBvC,EAAMC,OAAO9F,QAElCuwB,gBAAiB,CACfxoB,cAAe,MACfC,WAAY,SACZN,KAAM,GAER8oB,gBAAiB,CACfjkB,WAAY1G,EAAMvC,QAAQZ,GAC1BgF,KAAM,IAGZ,EChLA,IAAMgpB,GAAmB,gBAmVnB1kB,GAAY,SAACnG,GAAe,OAAK2B,EAAAA,QAAWxb,OAAO,CACvDyb,UAAW,CACTC,KAAM,EACNC,gBAAiB9B,EAAMC,OAAOpG,YAGhCixB,gBAAiB,CACf9nB,kBAAmBhD,EAAMvC,QAAQZ,GACjCkG,gBAAiB/C,EAAMvC,QAAQb,GAC/BkF,gBAAiB9B,EAAMC,OAAOlG,KAC9BuI,kBAAmB,EACnBC,kBAAmBvC,EAAMC,OAAO9F,QAElC4wB,UAAW,CACT7oB,cAAe,MACfC,WAAY,SACZL,gBAAiB9B,EAAMC,OAAOvF,gBAC9BiD,aAAcqC,EAAMvC,QAAQb,GAC5BoG,kBAAmBhD,EAAMvC,QAAQb,GACjC0L,YAAa,EACbD,YAAarI,EAAMC,OAAO9F,QAE5B6wB,WAAY,CACV7hB,YAAanJ,EAAMvC,QAAQb,IAE7BquB,YAAa,CACXppB,KAAM,EACNkB,gBAAiB/C,EAAMvC,QAAQb,GAC/B4F,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC6F,MAAO1C,EAAMC,OAAOjG,KACpB0J,WAAY1D,EAAM7D,WAAWC,aAAaC,SAE5C+kB,cAAe,CACbre,gBAAiB/C,EAAMvC,QAAQb,GAC/BoG,kBAAmBhD,EAAMvC,QAAQd,GACjCmF,gBAAiB9B,EAAMC,OAAOlG,KAC9BuI,kBAAmB,EACnBC,kBAAmBvC,EAAMC,OAAO9F,QAElC+wB,QAAS,CACPnoB,gBAAiB/C,EAAMvC,QAAQd,GAC/BqG,kBAAmBhD,EAAMvC,QAAQZ,GACjCc,aAAcqC,EAAMvC,QAAQX,GAC5BwL,YAAa,EACbD,YAAarI,EAAMC,OAAO9F,OAC1B2H,gBAAiB9B,EAAMb,WAAaa,EAAMC,OAAOpE,QAAUmE,EAAMC,OAAO1E,QACxE4N,YAAanJ,EAAMvC,QAAQb,IAE7BuuB,gBAAiB,CACfrpB,gBAAiB9B,EAAMC,OAAOzG,QAC9B6O,YAAarI,EAAMC,OAAOzG,SAE5B8nB,QAAS,CACP9e,SAAUxC,EAAM7D,WAAWO,UAAUE,GACrC8F,MAAO1C,EAAMC,OAAOhG,cACpByJ,WAAY1D,EAAM7D,WAAWC,aAAaC,SAE5C+uB,gBAAiB,CACf1oB,MAAO1C,EAAMC,OAAOpF,UACpB6I,WAAY1D,EAAM7D,WAAWC,aAAaG,UAE5C8uB,gBAAiB,CACfxpB,KAAM,EACNO,eAAgB,SAChBD,WAAY,SACZL,gBAAiB9B,EAAMC,OAAOpG,YAEhCyxB,kBAAmB,CACjBzpB,KAAM,EACNC,gBAAiB9B,EAAMC,OAAOpG,WAC9BkI,WAAY/B,EAAMvC,QAAQb,IAE5B+oB,eAAgB,CACd9jB,KAAM,EACNO,eAAgB,SAChBD,WAAY,SACZE,QAASrC,EAAMvC,QAAQX,IAEzB8oB,UAAW,CACTpjB,SAAUxC,EAAM7D,WAAWO,UAAUI,GACrC4F,MAAO1C,EAAMC,OAAOhG,cACpBsJ,UAAWvD,EAAMvC,QAAQZ,GACzBoH,UAAW,SACXP,WAAY1D,EAAM7D,WAAWC,aAAaG,UAE5CgvB,aAAc,CACZ/oB,SAAUxC,EAAM7D,WAAWO,UAAUE,GACrC8F,MAAO1C,EAAMC,OAAOhG,cACpBsJ,UAAWvD,EAAMvC,QAAQb,GACzBqH,UAAW,SACXjB,kBAAmBhD,EAAMvC,QAAQV,GACjC2G,WAAY1D,EAAM7D,WAAWC,aAAaC,SAE5CmvB,YAAa,CACXvqB,cAAejB,EAAMvC,QAAQX,IAE/B2uB,aAAc,CACZznB,aAAchE,EAAMvC,QAAQZ,IAE9B6uB,WAAY,CACVlpB,SAAUxC,EAAM7D,WAAWO,UAAUI,GACrC2F,WAAY,OACZC,MAAO1C,EAAMC,OAAOjG,KACpBgJ,kBAAmBhD,EAAMvC,QAAQX,GACjCiG,gBAAiB/C,EAAMvC,QAAQb,GAC/BkF,gBAAiB9B,EAAMb,WAAaa,EAAMC,OAAOnE,QAAUkE,EAAMC,OAAO1E,QACxEmI,WAAY1D,EAAM7D,WAAWC,aAAaI,MAE5CmvB,kBAAmB,CAEjB5pB,WAAY/B,EAAMvC,QAAQX,GAC1BmE,cAA+B,QAAhBhgB,EAAAA,QAASC,GAAe,IAAM,KAE/C0qC,kBAAmB,CACjBjV,SAAU,WACV+K,OAAwB,QAAhBzgC,EAAAA,QAASC,GAAe,IAAM,IACtC0gC,MAAO5hB,EAAMvC,QAAQX,GACrBkB,MAAO,GACPC,OAAQ,GACRN,aAAc,GACdmE,gBAAiB9B,EAAMC,OAAOzG,QAC9B4I,eAAgB,SAChBD,WAAY,SACZ/D,UAAW,EACXN,YAAakC,EAAMC,OAAOrF,OAC1BmD,aAAc,CAAEC,MAAO,EAAGC,OAAQ,GAClCC,cAAe,GACfC,aAAc,EACd0tB,OAAQ,MAET,EAEH,SA9csB,WACpB,IAAMzhB,GAAaC,EAAAA,GAAAA,iBACXrK,EAAUG,KAAVH,MACAke,EAAiB2C,KAAjB3C,aACFxc,EAASyE,GAAUnG,GAGzBzJ,GAA8BC,EAAAA,EAAAA,UAAyB,IAAGC,GAAAC,EAAAA,EAAAA,SAAAH,EAAA,GAAnDmd,EAAOjd,EAAA,GAAEq1B,EAAUr1B,EAAA,GAC1BI,GAA8CL,EAAAA,EAAAA,UAAyB,IAAGM,GAAAJ,EAAAA,EAAAA,SAAAG,EAAA,GAAnEk1B,EAAej1B,EAAA,GAAEk1B,EAAkBl1B,EAAA,GAC1CG,GAAkCT,EAAAA,EAAAA,WAAS,GAAKU,GAAAR,EAAAA,EAAAA,SAAAO,EAAA,GAAzCF,EAASG,EAAA,GAAEF,EAAYE,EAAA,GAC9BG,GAAwCb,EAAAA,EAAAA,WAAS,GAAMc,GAAAZ,EAAAA,EAAAA,SAAAW,EAAA,GAAhD40B,EAAY30B,EAAA,GAAE40B,EAAe50B,EAAA,GACpCoT,GAAsClU,EAAAA,EAAAA,UAAS,IAAGmU,GAAAjU,EAAAA,EAAAA,SAAAgU,EAAA,GAA3CyhB,EAAWxhB,EAAA,GAAEyhB,EAAczhB,EAAA,GAClCE,GAA0CrU,EAAAA,EAAAA,UAAmB,IAAGsU,GAAApU,EAAAA,EAAAA,SAAAmU,EAAA,GAAzDwhB,EAAavhB,EAAA,GAAEwhB,EAAgBxhB,EAAA,GACtCsC,GAAwC5W,EAAAA,EAAAA,UAAmB,IAAG6W,GAAA3W,EAAAA,EAAAA,SAAA0W,EAAA,GAAvDmf,EAAYlf,EAAA,GAAEmf,EAAenf,EAAA,GAG9Bof,GAAgBlV,EAAAA,EAAAA,QAAmB,MACnCmV,GAAiBnV,EAAAA,EAAAA,QAAO,CAAEoV,OAAQ,IAClCC,GAAsBrV,EAAAA,EAAAA,SAAO,GAG7BsV,GAAqB1N,EAAAA,EAAAA,cAAY,WACjCsN,EAAc/U,UAEhBkV,EAAoBlV,SAAU,EAElC,GAAG,IAGGoV,EAAY,eAAA1lC,GAAApF,EAAAA,EAAAA,UAAG,YACnB,IAAK,IAAD+qC,EAAAC,EACFh2B,GAAa,GAEb,IAAMnP,QAAiB0C,EAAWC,WAAW,CAAC,GAExC1G,EAAOV,MAAM8G,QAAQrC,EAAS/D,MAChC+D,EAAS/D,KACc,OADVipC,EACC,OADDC,EACZnlC,EAAS/D,WAAI,EAAbkpC,EAAetZ,SAAOqZ,EAAI,GAC/BjB,EAAWhoC,EACb,CAAE,MAAOnB,GACPV,QAAQU,MAAM,iCAAkCA,GAChDslC,GAAAA,QAAMC,MAAM,QAAS,iCACvB,CAAC,QACClxB,GAAa,GACbk1B,GAAgB,EAClB,CACF,IAAC,kBAjBiB,OAAA9kC,EAAAxE,MAAA,KAAAC,UAAA,KAoBZoqC,EAAS,eAAAjlC,GAAAhG,EAAAA,EAAAA,UAAG,YAChB,IACE,IAAM6F,QAAiBkF,EAAQC,UAC/Bs/B,EAAiBzkC,EAAS/D,KAAK24B,KAAI,SAAClvB,GAAQ,OAAKA,EAAI0D,IAAI,IAC3D,CAAE,MAAOtO,GACPV,QAAQU,MAAM,sBAAuBA,EACvC,CACF,IAAC,kBAPc,OAAAqF,EAAApF,MAAA,KAAAC,UAAA,KAUTqqC,GAAwB/N,EAAAA,EAAAA,cAAY,WACxC,GAAIyN,EAAoBlV,SAAW+U,EAAc/U,SAAWqU,EAAgB7oC,OAAS,EAAG,CACtF,IAAMi9B,EAAQC,YAAW,WACvB,IAC0C,IAAD+M,EAAvC,GAAIT,EAAehV,QAAQiV,OAAS,EACb,OAArBQ,EAAAV,EAAc/U,UAAdyV,EAAuBC,SAAS,CAC9BC,EAAGX,EAAehV,QAAQiV,OAC1BjD,UAAU,IAGdkD,EAAoBlV,SAAU,CAChC,CAAE,MAAO/0B,GACPV,QAAQC,IAAI,qCAAsCS,GAClDiqC,EAAoBlV,SAAU,CAChC,CACF,GAAG,KAEH,OAAO,kBAAMqI,aAAaI,EAAO,CACnC,CACF,GAAG,CAAC4L,KAGJ7E,EAAAA,GAAAA,iBACE/H,EAAAA,EAAAA,cAAY,WAEV,IAAMgB,EAAQC,YAAW,WACvB0M,IACAG,GACF,GAAG,KAEH,OAAO,WACLlN,aAAaI,GACb0M,GACF,CACF,GAAG,MAILr1B,EAAAA,EAAAA,YAAU,WACR81B,GACF,GAAG,CAACnB,EAAaI,EAAc7Y,EAASwK,KAGxC1mB,EAAAA,EAAAA,YAAU,WACR01B,GACF,GAAG,CAACA,IAGJ,IAMMI,EAAgB,WACpB,IAAIC,GAAgBrR,EAAAA,GAAAA,SAAOxI,GAG3B,GAAIyY,EAAYzkB,OAAQ,CACtB,IAAMrb,EAAQ8/B,EAAYqB,cAC1BD,EAAmBA,EAAiBz6B,QAAO,SAAAivB,GAAK,OAC9CA,EAAMh3B,MAAMyiC,cAAc/pC,SAAS4I,IACnC01B,EAAM/2B,QAAQwiC,cAAc/pC,SAAS4I,EAAM,GAE/C,CAGIkgC,EAAarpC,OAAS,IACxBqqC,EAAmBA,EAAiBz6B,QAAO,SAAAivB,GAAK,OAC9CwK,EAAakB,OAAM,SAAAC,GAAe,OAChC3L,EAAMj2B,KAAKykB,MAAK,SAAAod,GAAS,OAAIA,EAAU18B,OAASy8B,CAAe,GAAC,GACjE,KAKAxP,IACHqP,EAAmBA,EAAiBz6B,QAAO,SAAAivB,GAAK,OAC7CA,EAAMj2B,KAAKykB,MAAK,SAAAod,GAAS,OAAIA,EAAU18B,OAAS45B,EAAgB,GAAC,KAKtEmB,EAAmBuB,EACrB,EA+CAjgB,GAA8C9W,EAAAA,EAAAA,WAAS,GAAM+W,GAAA7W,EAAAA,EAAAA,SAAA4W,EAAA,GAAtDsgB,EAAergB,EAAA,GAAEsgB,EAAkBtgB,EAAA,GAGpCugB,GAAe3O,EAAAA,EAAAA,cAAY,SAAC4O,GAChC,IAAQC,EAAkBD,EAAME,YAAxBD,cACRtB,EAAehV,QAAQiV,OAASqB,EAAcX,EAG9CQ,EAAmBG,EAAcX,EAAI,IACvC,GAAG,IAGGa,GAAc/O,EAAAA,EAAAA,cAAY,WAC1BsN,EAAc/U,SAChB+U,EAAc/U,QAAQ0V,SAAS,CAC7BC,EAAG,EACH3D,UAAU,GAGhB,GAAG,IAEH,OACEhkB,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOE,UAAUtL,SAAA,EAC5B4C,EAAAA,EAAAA,KAAC4vB,GAAY,CAAC/9B,MAAM,aAEpBmO,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAOopB,gBAAgBx0B,UAClCoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOqpB,UAAUz0B,SAAA,EAC5B4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,SAASvO,KAAMsd,EAAM7D,WAAWO,UAAUK,GAAI2F,MAAO1C,EAAMC,OAAOhG,cAAe2L,MAAOlE,EAAOspB,cAC9G9xB,EAAAA,EAAAA,KAACmS,GAAAA,QAAS,CACRzF,MAAOlE,EAAOupB,YACd3f,YAAY,oBACZxpB,MAAOqqC,EACP5gB,aAAc6gB,EACdzgB,qBAAsB3L,EAAMC,OAAOhG,gBAEpCkyB,GACCjzB,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CAACC,QAAS,WAAF,OAAQqmB,EAAe,GAAG,EAAC91B,UAClD4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,eAAevO,KAAMsd,EAAM7D,WAAWO,UAAUK,GAAI2F,MAAO1C,EAAMC,OAAOhG,kBAEvF,UAIPoyB,EAAcnpC,OAAS,IACtBgW,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAO0f,cAAc9qB,UAChC4C,EAAAA,EAAAA,KAACmI,GAAAA,QAAU,CAAC8sB,YAAU,EAACC,gCAAgC,EAAM93B,SAC1D+1B,EAAc5P,KAAI,SAAAlvB,GAAG,OACpB2L,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CAEfF,MAAO,CACLlE,EAAOwpB,QACPqB,EAAa9oC,SAAS8J,IAAQmU,EAAOypB,iBAEvCplB,QAAS,WAAF,OAjGH,SAACxY,GACbg/B,EAAa9oC,SAAS8J,GACxBi/B,EAAgBD,EAAaz5B,QAAO,SAAAu7B,GAAC,OAAIA,IAAM9gC,CAAG,KAElDi/B,EAAgB,GAAD8B,QAAApS,EAAAA,GAAAA,SAAKqQ,GAAY,CAAEh/B,IAEtC,CA2F6BghC,CAAUhhC,EAAI,EAAC+I,UAE9BoP,EAAAA,EAAAA,MAACO,EAAAA,QAAI,CACHL,MAAO,CACLlE,EAAO4f,QACPiL,EAAa9oC,SAAS8J,IAAQmU,EAAO0pB,iBACrC90B,SAAA,CACH,IACG/I,MAbCA,EAeY,SAM3B2L,EAAAA,EAAAA,KAACkH,GAAc,CACbwF,MAAO,CAAE/D,KAAM,GACfpB,sBAAuB,CAAE0H,SAAU,GACnC4gB,gBACE7vB,EAAAA,EAAAA,KAAC8vB,GAAAA,QAAc,CACbpC,WAAYqF,EACZhD,UA9JQ,WAChBiD,GAAgB,GAChBY,GACF,EA4JU7sB,OAAQ,CAACD,EAAMC,OAAOzG,SACtB0vB,UAAWlpB,EAAMC,OAAOzG,UAG5Bg1B,SAAUV,EACVtsB,oBAAqB,GAAGlL,SAEvBS,GACCmC,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAO4pB,kBAAkBh1B,SACnClT,MAAM0R,KAAK,CAAE5R,OAAQ,IAAK,SAACmnC,EAAGzH,GAAK,OAClC1pB,EAAAA,EAAAA,KAAC2wB,GAAmB,eAAkBjH,EAAW,OAIrD1pB,EAAAA,EAAAA,KAAAu1B,EAAAA,SAAA,CAAAn4B,SAC8B,IAA3By1B,EAAgB7oC,QACfwiB,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOikB,eAAervB,SAAA,EACjC4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,kBAAkBvO,KAA0B,IAApBsd,EAAMvC,QAAQT,IAAW0F,MAAO1C,EAAMC,OAAOxF,YACpFvB,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOkkB,UAAUtvB,SAAC,8BAC/B4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO6pB,aAAaj1B,SAC9B61B,GAAeI,EAAarpC,OAAS,IAAMg7B,GAAgBxK,EAAQnD,MAAK,SAAApY,GAAC,OAAIA,EAAErM,KAAKykB,MAAK,SAAA8d,GAAC,OAAEA,EAAEp9B,OAAS45B,EAAgB,GAAC,IACrH,6DACA,oDAIR3xB,EAAAA,EAAAA,KAAAu1B,EAAAA,SAAA,CAAAn4B,SA7HW,WACrB,IAAMo4B,EAA6C,CAAC,EAkBpD,OAhBA3C,EAAgBlY,SAAQ,SAAAkO,GACtB,IAAMf,EAAO,IAAIt9B,KAAKq+B,EAAMn2B,YACtB+iC,GAAYxM,EAAAA,GAAAA,SAAOnB,EAAM,aAE1B0N,EAAQC,KACXD,EAAQC,GAAa,IAGvBD,EAAQC,GAAWC,KAAK7M,EAC1B,IAEiBtxB,OAAOijB,QAAQgb,GAASjS,KAAI,SAAApyB,GAAA,IAAAgO,GAAA3B,EAAAA,EAAAA,SAAArM,EAAA,GAAgB,MAAO,CAClEU,MADkDsN,EAAA,GAElDvU,KAF2DuU,EAAA,GAG5D,GAGH,CA0Gew2B,GAAiBpS,KAAI,SAACqS,EAASC,GAAY,OAC1CrpB,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAAqBD,MAAOlE,EAAO+pB,aAAan1B,SAAA,EACnD4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOgqB,WAAWp1B,SAAEw4B,EAAQ/jC,QACxC+jC,EAAQhrC,KAAK24B,KAAI,SAACsF,EAAOiN,GAAU,OAClC91B,EAAAA,EAAAA,KAACiwB,GAAW,CAEVpH,MAAOA,EACPhc,QAAS,WAAF,OA3IJ,SAACgc,GACxB9/B,QAAQC,IAAI,iBAAkB6/B,EAAMn3B,IACpCwf,EAAW0B,SAAS,qBAAsB,CAAEsd,QAASrH,EAAMn3B,GAAG81B,YAChE,CAwIqCuO,CAAiBlN,EAAM,GAAC,iBAFjBA,EAAMn3B,GAAE,IAAIokC,EAGlC,MAPKF,EAAQ/jC,MASZ,UASlB6iC,IACC10B,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CACfF,MAAOlE,EAAOkqB,kBACd7lB,QAASmoB,EACThV,cAAe,GAAI5iB,UAEnB4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CACP/U,KAAK,aACLvO,KAAM,GACNggB,MAAO1C,EAAMC,OAAO5E,YAMhC,E,gWC1WO,IAAM6zB,GAAW,SAAAC,GAKtB,SAAAD,EAAY5rC,EAAiB8rC,GAAyC,IAADtsC,EAAvByB,EAAI1B,UAAAK,OAAA,QAAA0B,IAAA/B,UAAA,GAAAA,UAAA,GAAG,eAQA,OARchC,EAAAA,EAAAA,SAAA,KAAAquC,IACjEpsC,EAAAusC,GAAA,KAAAH,EAAA,CAAM5rC,KACD2N,KAAO,cACZnO,EAAKyB,KAAOA,EACZzB,EAAK+vB,UAAY,IAAInvB,KACrBZ,EAAKssC,MAAQA,EAGb3+B,OAAO6+B,eAAcxsC,EAAOosC,EAAYK,WAAWzsC,CACrD,CAAC,OAAA0sC,EAAAA,EAAAA,SAAAN,EAAAC,IAAAxuC,EAAAA,EAAAA,SAAAuuC,EAAA,EAAArtC,IAAA,sBAAAC,MAKD,WACE,OAAUf,KAAKwD,KAAI,KAAKxD,KAAKuC,OAC/B,GAAC,CAAAzB,IAAA,eAAAC,MAKD,WACE,MAAO,CACLyC,KAAMxD,KAAKwD,KACXjB,QAASvC,KAAKuC,QACduvB,UAAW9xB,KAAK8xB,UAAUlvB,cAC1ByrC,MAAOruC,KAAKquC,MACZK,MAAO1uC,KAAK0uC,MAEhB,IAAC,CAlCqB,EAkCrBC,E,OAAAA,SAlC8BprC,QAwCpBqrC,GAAmB,SAAAC,GAC9B,SAAAD,EAAYrsC,EAAiB8rC,GAAkB,IAADxb,EAGe,OAHf/yB,EAAAA,EAAAA,SAAA,KAAA8uC,IAC5C/b,EAAAyb,GAAA,KAAAM,EAAA,CAAMrsC,EAAS8rC,EAAO,0BACjBn+B,KAAO,sBACZR,OAAO6+B,eAAc1b,EAAO+b,EAAoBJ,WAAW3b,CAC7D,CAAC,OAAA4b,EAAAA,EAAAA,SAAAG,EAAAC,IAAAjvC,EAAAA,EAAAA,SAAAgvC,EAAA,CAL6B,CAAST,IAW5BW,GAAY,SAAAC,GAGvB,SAAAD,EAAYvsC,EAAiBysC,EAAqBX,GAAkB,IAADY,EAIb,OAJanvC,EAAAA,EAAAA,SAAA,KAAAgvC,IACjEG,EAAAX,GAAA,KAAAQ,EAAA,CAAMvsC,EAAS8rC,EAAO,mBACjBn+B,KAAO,eACZ++B,EAAKD,WAAaA,EAClBt/B,OAAO6+B,eAAcU,EAAOH,EAAaN,WAAWS,CACtD,CAAC,OAAAR,EAAAA,EAAAA,SAAAK,EAAAC,IAAAnvC,EAAAA,EAAAA,SAAAkvC,EAAA,CARsB,CAASX,KAcF,SAAAe,GAC9B,SAAAC,EAAY5sC,EAAiB8rC,GAAkB,IAADe,EAGe,OAHftvC,EAAAA,EAAAA,SAAA,KAAAqvC,IAC5CC,EAAAd,GAAA,KAAAa,EAAA,CAAM5sC,EAAS8rC,EAAO,0BACjBn+B,KAAO,sBACZR,OAAO6+B,eAAca,EAAOD,EAAoBX,WAAWY,CAC7D,EAACX,EAAAA,EAAAA,SAAAU,EAAAD,IAAAtvC,EAAAA,EAAAA,SAAAuvC,EAAA,EAL6B,CAAShB,IAWjB,SAAAkB,GACtB,SAAAC,EAAY/sC,EAAiB8rC,GAAkB,IAADkB,EAGO,OAHPzvC,EAAAA,EAAAA,SAAA,KAAAwvC,IAC5CC,EAAAjB,GAAA,KAAAgB,EAAA,CAAM/sC,EAAS8rC,EAAO,kBACjBn+B,KAAO,cACZR,OAAO6+B,eAAcgB,EAAOD,EAAYd,WAAWe,CACrD,EAACd,EAAAA,EAAAA,SAAAa,EAAAD,IAAAzvC,EAAAA,EAAAA,SAAA0vC,EAAA,CALqB,CAASnB,IAWF,SAAAqB,GAC7B,SAAAC,EAAYltC,EAAiB8rC,GAAkB,IAADqB,EAGc,OAHd5vC,EAAAA,EAAAA,SAAA,KAAA2vC,IAC5CC,EAAApB,GAAA,KAAAmB,EAAA,CAAMltC,EAAS8rC,EAAO,0BACjBn+B,KAAO,qBACZR,OAAO6+B,eAAcmB,EAAOD,EAAmBjB,WAAWkB,CAC5D,EAACjB,EAAAA,EAAAA,SAAAgB,EAAAD,IAAA5vC,EAAAA,EAAAA,SAAA6vC,EAAA,CAL4B,CAAStB,IAWT,SAAAwB,GAC7B,SAAAC,EAAYrtC,EAAiB8rC,GAAkB,IAADwB,EAGc,OAHd/vC,EAAAA,EAAAA,SAAA,KAAA8vC,IAC5CC,EAAAvB,GAAA,KAAAsB,EAAA,CAAMrtC,EAAS8rC,EAAO,yBACjBn+B,KAAO,qBACZR,OAAO6+B,eAAcsB,EAAOD,EAAmBpB,WAAWqB,CAC5D,EAACpB,EAAAA,EAAAA,SAAAmB,EAAAD,IAAA/vC,EAAAA,EAAAA,SAAAgwC,EAAA,CAL4B,CAASzB,ICjGkC,IAuCpE2B,IAAYlwC,EAAAA,EAAAA,UAAA,SAAAkwC,KAAAhwC,EAAAA,EAAAA,SAAA,KAAAgwC,EAAA,UAAAhvC,IAAA,WAAAC,MAGhB,SAAgBgC,GACd/C,KAAK+vC,cAAc1rC,IAAItB,EACzB,GAAC,CAAAjC,IAAA,QAAAC,MAED,SAAagC,GACP/C,KAAK+vC,cAAc/7B,IAAIjR,KACzBA,EAAKyR,KAAK,GACVxU,KAAK+vC,cAAczrC,OAAOvB,GAE9B,GAAC,CAAAjC,IAAA,WAAAC,MAED,WACEf,KAAK+vC,cAAcjd,SAAQ,SAAA/vB,GAAI,OAAIA,EAAKyR,KAAK,EAAE,IAC/CxU,KAAK+vC,cAAcx8B,OACrB,KAjBIu8B,GACWC,cAAiC,IAAInvC,IAsB/C,IAAMovC,GAAY,WAIvB,SAAAA,KAAsBlwC,EAAAA,EAAAA,SAAA,KAAAkwC,GAAA,KAFdlW,eAAgB,CAED,CAAC,OAAAl6B,EAAAA,EAAAA,SAAAowC,EAAA,EAAAlvC,IAAA,aAAAC,MAAA,eAAA4vB,GAAA1vB,EAAAA,EAAAA,UAaxB,YACE,IACsB,QAAhBf,EAAAA,QAASC,KACXR,EAAOqE,KAAK,uDACNoJ,GAAAA,MACNzN,EAAOqE,KAAK,kDAGdhE,KAAK85B,eAAgB,EACrBn6B,EAAOqE,KAAK,yCACd,CAAE,MAAOpC,GAEP,MADAjC,EAAOiC,MAAM,qCAAsCA,GAC7C,IAAIusC,GAAY,+BAAgCvsC,EACxD,CACF,IAduB,OActB,WAdsB,OAAA+uB,EAAA9uB,MAAC,KAADC,UAAA,EAbC,IAaD,CAAAhB,IAAA,oBAAAC,MAAA,eAAAwM,GAAAtM,EAAAA,EAAAA,UAqBvB,UAA+BuM,GAC7BxN,KAAKiwC,oBAEL,IACEtwC,EAAOmE,MAAM,gCAEb,IAAM4K,EAAStB,GAAAA,OAAcO,kBAAkB,CAAEH,SAAAA,IAEjD,IAAKkB,IAAWA,EAAOd,0BAA4Bc,EAAOb,oBACxD,MAAM,IAAIsgC,GAAY,mDAIxB,OADAxuC,EAAOmE,MAAM,4CACN,CACL+J,oBAAqBa,EAAOb,oBAC5BqiC,YAAaxhC,EAAOd,wBAExB,CAAE,MAAOhM,GAEP,GADAjC,EAAOiC,MAAM,mCAAoCA,GAC7CA,aAAiBusC,GACnB,MAAMvsC,EAER,MAAM,IAAIusC,GAAY,sCAAuCvsC,EAC/D,CACF,IAxB8B,OAwB7B,SAxB6B6B,GAAA,OAAA8J,EAAA1L,MAAC,KAADC,UAAA,EArBP,IAqBO,CAAAhB,IAAA,qBAAAC,MAAA,eAAAiN,GAAA/M,EAAAA,EAAAA,UAiC9B,UACEuM,EACA0iC,EACAppC,GAEA9G,KAAKiwC,oBAEL,IACEtwC,EAAOmE,MAAM,iCAEb,IAAM4K,EAAStB,GAAAA,OAAcoB,mBAAmB,CAC9ChB,SAAAA,EACAI,wBAAyBsiC,EACzBjiC,qBAAsBnH,EAASmH,uBAGjC,IAAKS,IAAWA,EAAOyhC,qBAAuBzhC,EAAOoB,UACnD,MAAM,IAAIq+B,GAAY,0DAOxB,OAHA2B,GAAa93B,SAAStJ,EAAOoB,WAE7BnQ,EAAOmE,MAAM,6CACN,CACLqsC,mBAAoBzhC,EAAOyhC,mBAC3BrgC,UAAWpB,EAAOoB,UAEtB,CAAE,MAAOlO,GAEP,GADAjC,EAAOiC,MAAM,oCAAqCA,GAC9CA,aAAiBusC,GACnB,MAAMvsC,EAER,MAAM,IAAIusC,GAAY,uCAAwCvsC,EAChE,CACF,IAnC+B,OAmC9B,SAnC8B8B,EAAAC,EAAAiJ,GAAA,OAAAoB,EAAAnM,MAAC,KAADC,UAAA,EAjCD,IAiCC,CAAAhB,IAAA,aAAAC,MAAA,eAAA0N,GAAAxN,EAAAA,EAAAA,UA0C/B,UAAwBuM,GACtBxN,KAAKiwC,oBAEL,IACEtwC,EAAOmE,MAAM,yBAEb,IAAM4K,EAAStB,GAAAA,OAAcuB,WAAW,CAAEnB,SAAAA,IAE1C,IAAKkB,IAAWA,EAAOE,mBAAqBF,EAAO0hC,kBACjD,MAAM,IAAIjC,GAAY,4CAIxB,OADAxuC,EAAOmE,MAAM,qCACN,CACLssC,kBAAmB1hC,EAAO0hC,kBAC1BF,YAAaxhC,EAAOE,iBAExB,CAAE,MAAOhN,GAEP,GADAjC,EAAOiC,MAAM,4BAA6BA,GACtCA,aAAiBusC,GACnB,MAAMvsC,EAER,MAAM,IAAIusC,GAAY,+BAAgCvsC,EACxD,CACF,IAxBuB,OAwBtB,SAxBsBiL,GAAA,OAAA4B,EAAA5M,MAAC,KAADC,UAAA,EA1CQ,IA0CR,CAAAhB,IAAA,cAAAC,MAAA,eAAAkO,GAAAhO,EAAAA,EAAAA,UAiCvB,UACEuM,EACA0iC,EACAppC,GAEA9G,KAAKiwC,oBAEL,IACEtwC,EAAOmE,MAAM,0BAEb,IAAM4K,EAAStB,GAAAA,OAAckC,YAAY,CACvC9B,SAAAA,EACAoB,iBAAkBshC,EAClBG,mBAAoBvpC,EAASupC,qBAG/B,IAAK3hC,IAAWA,EAAO4hC,yBAA2B5hC,EAAOmB,aAAenB,EAAOoB,UAC7E,MAAM,IAAI8+B,GAAoB,sDAQhC,OAJAkB,GAAa93B,SAAStJ,EAAOmB,YAC7BigC,GAAa93B,SAAStJ,EAAOoB,WAE7BnQ,EAAOmE,MAAM,sCACN,CACLwsC,uBAAwB5hC,EAAO4hC,uBAC/BzgC,WAAYnB,EAAOmB,WACnBC,UAAWpB,EAAOoB,UAEtB,CAAE,MAAOlO,GAEP,GADAjC,EAAOiC,MAAM,6BAA8BA,GACvCA,aAAiBgtC,GACnB,MAAMhtC,EAER,GAAIA,aAAiBusC,GACnB,MAAMvsC,EAER,MAAM,IAAIusC,GAAY,gCAAiCvsC,EACzD,CACF,IAxCwB,OAwCvB,SAxCuBoL,EAAA+C,EAAAC,GAAA,OAAAf,EAAApN,MAAC,KAADC,UAAA,EAjCD,IAiCC,CAAAhB,IAAA,kBAAAC,MAAA,eAAAwvC,GAAAtvC,EAAAA,EAAAA,UAgDxB,UAA6B6O,EAAuB0gC,GAClD,IACE7wC,EAAOmE,MAAM,uCAGb,IAAM2sC,QAAczwC,KAAK0wC,QAAQF,EAAa7pB,OAAO8lB,cAAe,IAG9DkE,QAAgB3wC,KAAK4wC,KAAK9gC,EAAW2gC,EAAO,eAAgB,IAG5DI,EAAU7wC,KAAK8wC,WAAWL,GAOhC,OAJAX,GAAa93B,SAASy4B,GACtBX,GAAa93B,SAAS24B,GAEtBhxC,EAAOmE,MAAM,mCACN,CACL2sC,MAAAA,EACAE,QAAAA,EACAE,QAAAA,EAEJ,CAAE,MAAOjvC,GAEP,MADAjC,EAAOiC,MAAM,8BAA+BA,GACtC,IAAIusC,GAAY,8BAA+BvsC,EACvD,CACF,IA3B4B,OA2B3B,SA3B2B8O,EAAAC,GAAA,OAAA4/B,EAAA1uC,MAAC,KAADC,UAAA,EAhDJ,IAgDI,CAAAhB,IAAA,cAAAC,MAgC5B,WACE,IACE+uC,GAAaiB,WACbpxC,EAAOmE,MAAM,+BACf,CAAE,MAAOlC,GACPjC,EAAOiC,MAAM,uCAAwCA,EACvD,CACF,GAAC,CAAAd,IAAA,0BAAAC,MAKD,WACE,OAAOf,KAAK85B,aACd,GAAC,CAAAh5B,IAAA,oBAAAC,MAID,WACE,IAAKf,KAAK85B,cACR,MAAM,IAAIqU,GAAY,0DAE1B,GAAC,CAAArtC,IAAA,UAAAC,MAAA,eAAAiwC,GAAA/vC,EAAAA,EAAAA,UAED,UAAsBonB,EAAe4oB,GAGnC,IACMluC,GADU,IAAImS,aACCC,OAAOkT,GACtBpT,QAAaL,OAAOC,OAAOq8B,OAAO,UAAWnuC,GACnD,OAAO,IAAIgQ,WAAWkC,EAAK2sB,MAAM,EAAGqP,GACtC,IAPqB,OAOpB,SAPoBrgC,EAAAW,GAAA,OAAAy/B,EAAAnvC,MAAC,KAADC,UAAA,EAFpB,IAEoB,CAAAhB,IAAA,OAAAC,MAAA,eAAAowC,GAAAlwC,EAAAA,EAAAA,UASrB,UACE0T,EACArK,EACAtG,EACA7B,GAEA,IACE,IAAMrB,QAAY8T,OAAOC,OAAOC,UAAU,MAAOH,EAAK,QAAQ,EAAO,CAAC,eAChEy8B,GAAa,IAAIl8B,aAAcC,OAAOnR,GAEtC+Q,QAAoBH,OAAOC,OAAOG,WACtC,CACE9E,KAAM,OACN+E,KAAM,UACN3K,KAAAA,EACAtG,KAAMotC,GAERtwC,EACS,EAATqB,GAGF,OAAO,IAAI4Q,WAAWgC,EACxB,CAAE,MAAOnT,GACP,MAAM,IAAIusC,GAAY,yBAA0BvsC,EAClD,CACF,IAzBkB,OAyBjB,SAzBiB4P,EAAA6qB,EAAAgV,EAAAC,GAAA,OAAAH,EAAAtvC,MAAC,KAADC,UAAA,EATG,IASH,CAAAhB,IAAA,aAAAC,MA2BlB,SAAmB+R,GACjB,OAAOzQ,MAAM0R,KAAKjB,GACf4oB,KAAI,SAAA6V,GAAC,OAAIA,EAAE5R,SAAS,IAAI6R,SAAS,EAAG,IAAI,IACxChvC,KAAK,GACV,IAAC,EAAA1B,IAAA,cAAAC,MA5RD,WAIE,OAHKivC,EAAah+B,WAChBg+B,EAAah+B,SAAW,IAAIg+B,GAEvBA,EAAah+B,QACtB,IAAC,CAXsB,GCsTZy/B,IDhBezB,GAAa99B,cCxUT,WAW9B,SAAAw/B,KAAsB5xC,EAAAA,EAAAA,SAAA,KAAA4xC,GAAA,KARdC,eAA2C,IAAIp/B,IAAM,KACrDq/B,gBAA+C,IAAIr/B,IAAM,KAGhDs/B,mBAAqB,IAAe,KACpCC,2BAA6B,IAAK,KAClCC,2BAA6B,kBAG5C/xC,KAAKgyC,aAAehC,GAAa99B,aACnC,CAAC,OAAAtS,EAAAA,EAAAA,SAAA8xC,EAAA,EAAA5wC,IAAA,uBAAAC,MAAA,eAAAkxC,GAAAhxC,EAAAA,EAAAA,UAaD,UAAkCixC,GAChC,GAAoB,MAAfA,IAAAA,EAAiBvrB,OACpB,MAAO,CAAEwrB,OAAO,GAGlB,IACExyC,EAAOqE,KAAK,2CAA2CkuC,EAAe,KAGtE,IAAME,EAAmBpyC,KAAKqyC,gBAAgBH,GAG9C,GAAIlyC,KAAKsyC,cAAcF,GAGrB,OAFAzyC,EAAOsC,KAAK,qDACNjC,KAAKuyC,kBACJ,CACLJ,OAAO,EACPK,OAAQ,SAKZ,IAAMC,QAAmBzyC,KAAK0yC,uBAAuBN,GAErD,GAAIK,EAAWljC,SAAWkjC,EAAWhC,MAAO,CAE1C,IACM+B,EADWxyC,KAAK2yC,gBAAgBF,EAAWhC,OACvB,aAAe,WAYzC,MAVe,aAAX+B,QAEIxyC,KAAK4yC,cAAcH,EAAWhC,MAAOgC,EAAWpmC,QAAUomC,EAAW5iC,WAAa4iC,EAAWl+B,gBAG7FvU,KAAK6yC,kBAAkBJ,EAAWhC,OAG1C9wC,EAAOqE,KAAK,oDAAoDyuC,EAAWpmC,QAAO,KAAKmmC,EAAM,KAEtF,CACLL,OAAO,EACP1B,MAAOgC,EAAWhC,MAClBpkC,QAASomC,EAAWpmC,QACpBmmC,OAAAA,EAEJ,CAIA,OADA7yC,EAAOqE,KAAK,mDACL,CAAEmuC,OAAO,EAElB,CAAE,MAAOvwC,GAEP,OADAjC,EAAOiC,MAAM,uDAAwDA,GAC9D,CAAEuwC,OAAO,EAClB,CACF,IAvDiC,OAuDhC,SAvDgC1uC,GAAA,OAAAwuC,EAAApwC,MAAC,KAADC,UAAA,EAbhC,IAagC,CAAAhB,IAAA,yBAAAC,MAAA,eAAA+xC,GAAA7xC,EAAAA,EAAAA,UA4DjC,UAAqC8xC,GACnC,IAAM7kB,EAAYvrB,KAAKorB,MAEvB,IAEE,IAAMud,QAAsBtrC,KAAKgzC,yBAEjC,GAA6B,IAAzB1H,EAAcnpC,OAChB,MAAO,CAAEoN,SAAS,EAAO3N,MAAO,6BAIlC,IAAK,IAAM4K,KAAO8+B,EAChB,IAEE,GAAI3oC,KAAKorB,MAAQG,EAAYluB,KAAK8xC,2BAA4B,CAC5DnyC,EAAOsC,KAAK,wDACZ,KACF,CAGA,IAAMwwC,QAAmBzyC,KAAKgyC,aAAaiB,aAAazmC,EAAI3C,GAAIkpC,GAEhE,GAAIN,EAAWljC,QAAS,CAEtB,IAAMgF,QAAiBvU,KAAKgyC,aAAakB,eAAeT,EAAW5iC,WAAarD,EAAI3C,IAEpF,MAAO,CACL0F,SAAS,EACTkhC,MAAOjkC,EAAI3C,GACXwC,QAASG,EAAI0D,KACbL,WAAY4iC,EAAW5iC,WACvB0E,SAAAA,EAEJ,CACF,CAAE,MAAO3S,GAEHA,aAAiBgtC,GACnBjvC,EAAOmE,MAAM,uDAAuD0I,EAAI3C,GAAE,KAAKjI,EAAMW,SAErF5C,EAAOsC,KAAK,kDAAkDuK,EAAI3C,GAAE,IAAKjI,GAE3E,QACF,CAIF,IAAMuxC,EAAcxwC,KAAKorB,MAAQG,EAGjC,OAFAvuB,EAAOqE,KAAK,6DAA6DmvC,EAAW,OAE7E,CAAE5jC,SAAS,EAAO3N,MAAO,wBAElC,CAAE,MAAOA,GACP,IAAMuxC,EAAcxwC,KAAKorB,MAAQG,EAGjC,OAFAvuB,EAAOiC,MAAM,sDAAsDuxC,EAAW,OAAQvxC,GAElFA,aAAiBktC,GACZ,CAAEv/B,SAAS,EAAO3N,MAAO,uCACvBA,aAAiBusC,GACnB,CAAE5+B,SAAS,EAAO3N,MAAO,iCAG3B,CAAE2N,SAAS,EAAO3N,MAAO,+BAClC,CACF,IAhEoC,OAgEnC,SAhEmC8B,GAAA,OAAAovC,EAAAjxC,MAAC,KAADC,UAAA,EA5DH,IA4DG,CAAAhB,IAAA,yBAAAC,MAAA,eAAAqyC,GAAAnyC,EAAAA,EAAAA,UAqEpC,YACE,IAKE,OADAtB,EAAOqE,KAAK,mEACL,EACT,CAAE,MAAOpC,GAEP,OADAjC,EAAOiC,MAAM,6DAA8DA,GACpE,EACT,CACF,IAXoC,OAWnC,WAXmC,OAAAwxC,EAAAvxC,MAAC,KAADC,UAAA,EArEA,IAqEA,CAAAhB,IAAA,gBAAAC,MAAA,eAAAsyC,GAAApyC,EAAAA,EAAAA,UAgBpC,UAA4BwvC,EAAepkC,EAAiBwD,EAAwB0E,GAAsC,IAADxS,EAAA,KACvH,UAEQ/B,KAAK6yC,kBAAkBpC,GAG7B,IAAM6C,EAA2B,CAC/B7C,MAAAA,EACApkC,QAAAA,EACAwD,WAAAA,EACA0E,SAAAA,EACAg/B,UAAW,IAAI5wC,KACf6wC,UAAW,IAAI7wC,KAAKA,KAAKorB,MAAQ/tB,KAAK6xC,qBAGxC7xC,KAAK2xC,eAAex9B,IAAIs8B,EAAO6C,GAG/B,IAAMG,EAAYpU,YAAW,WAC3Bt9B,EAAK8wC,kBAAkBpC,EACzB,GAAGzwC,KAAK6xC,oBAER7xC,KAAK4xC,gBAAgBz9B,IAAIs8B,EAAOgD,GAEhC9zC,EAAOqE,KAAK,kDAAkDqI,EAAO,gBAAgBrM,KAAK6xC,mBAAqB,IAAI,KACrH,CAAE,MAAOjwC,GAEP,MADAjC,EAAOiC,MAAM,kDAAmDA,GAC1DA,CACR,CACF,IA7B2B,OA6B1B,SA7B0B+B,EAAAiJ,EAAAC,EAAAG,GAAA,OAAAqmC,EAAAxxC,MAAC,KAADC,UAAA,EAhBS,IAgBT,CAAAhB,IAAA,oBAAAC,MAAA,eAAA2yC,GAAAzyC,EAAAA,EAAAA,UAkC3B,UAAgCwvC,GAC9B,IACE,IAAMkD,EAAU3zC,KAAK2xC,eAAehoC,IAAI8mC,GACpCkD,IAEFA,EAAQ9jC,WAAW2E,KAAK,GACxBm/B,EAAQp/B,SAASC,KAAK,GAEtBxU,KAAK2xC,eAAertC,OAAOmsC,GAC3B9wC,EAAOqE,KAAK,sDAAsD2vC,EAAQtnC,UAI5E,IAAMonC,EAAYzzC,KAAK4xC,gBAAgBjoC,IAAI8mC,GACvCgD,IACFzU,aAAayU,GACbzzC,KAAK4xC,gBAAgBttC,OAAOmsC,GAEhC,CAAE,MAAO7uC,GACPjC,EAAOiC,MAAM,oDAAqDA,EACpE,CACF,IArB+B,OAqB9B,SArB8BmO,GAAA,OAAA2jC,EAAA7xC,MAAC,KAADC,UAAA,EAlCJ,IAkCI,CAAAhB,IAAA,kBAAAC,MA0B/B,SAAuB0vC,GACrB,IAAMkD,EAAU3zC,KAAK2xC,eAAehoC,IAAI8mC,GACxC,QAAKkD,MAKDA,EAAQH,UAAY,IAAI7wC,QAC1B3C,KAAK6yC,kBAAkBpC,IAChB,GAIX,GAAC,CAAA3vC,IAAA,mBAAAC,MAKD,SAAwB0vC,GACtB,OAAKzwC,KAAK2yC,gBAAgBlC,IAGnBzwC,KAAK2xC,eAAehoC,IAAI8mC,IAFtB,IAGX,GAAC,CAAA3vC,IAAA,oBAAAC,MAKD,WACE,IAAM4wC,EAAgC,GAEtC,QAAAtrC,KAA+BrG,KAAK2xC,eAAgB,CAAC,IAAD1qC,GAAA0O,EAAAA,EAAAA,SAAAtP,EAAA,GAAxCoqC,EAAKxpC,EAAA,GAAE0sC,EAAO1sC,EAAA,GACpBjH,KAAK2yC,gBAAgBlC,IACvBkB,EAAe9D,KAAK8F,EAExB,CAEA,OAAOhC,CACT,GAAC,CAAA7wC,IAAA,kBAAAC,MAAA,eAAA6yC,GAAA3yC,EAAAA,EAAAA,UAKD,YACE,IACEtB,EAAOsC,KAAK,qEAGZ,IAAM4xC,EAASxxC,MAAM0R,KAAK/T,KAAK2xC,eAAehiC,QAC9C,IAAK,IAAM8gC,KAASoD,QACZ7zC,KAAK6yC,kBAAkBpC,SAIzBzwC,KAAKgyC,aAAa8B,cAExBn0C,EAAOqE,KAAK,yEACd,CAAE,MAAOpC,GACPjC,EAAOiC,MAAM,iDAAkDA,EACjE,CACF,IAjB6B,OAiB5B,WAjB4B,OAAAgyC,EAAA/xC,MAAC,KAADC,UAAA,EAL5B,IAK4B,CAAAhB,IAAA,kBAAAC,MAsB7B,SAAwBgyC,GACtB,OAAOA,EACJtG,cACA9lB,OACA3gB,QAAQhG,KAAK+xC,2BAA4B,IACzC/rC,QAAQ,OAAQ,IACrB,GAAC,CAAAlF,IAAA,gBAAAC,MAKD,SAAsBqxC,GAOpB,MANqB,CACnB,8BACA,iBACA,oBAGkB5iB,MAAK,SAAAukB,GAAK,OAAI3B,EAAiB1vC,SAASqxC,EAAM,GACpE,GAAC,CAAAjzC,IAAA,UAAAC,MAAA,eAAAizC,GAAA/yC,EAAAA,EAAAA,UAKD,YACE,IACEtB,EAAOqE,KAAK,+CAGZ,IAAM6vC,EAASxxC,MAAM0R,KAAK/T,KAAK2xC,eAAehiC,QAC9C,IAAK,IAAM8gC,KAASoD,QACZ7zC,KAAK6yC,kBAAkBpC,GAI/B,IAAK,IAAMgD,KAAazzC,KAAK4xC,gBAAgBn9B,SAC3CuqB,aAAayU,GAEfzzC,KAAK4xC,gBAAgBr+B,QAErB5T,EAAOqE,KAAK,yCACd,CAAE,MAAOpC,GACPjC,EAAOiC,MAAM,8CAA+CA,EAC9D,CACF,IApBoB,OAoBnB,WApBmB,OAAAoyC,EAAAnyC,MAAC,KAADC,UAAA,EALnB,KAKmB,EAAAhB,IAAA,cAAAC,MAjTpB,WAIE,OAHK2wC,EAAoB1/B,WACvB0/B,EAAoB1/B,SAAW,IAAI0/B,GAE9BA,EAAoB1/B,QAC7B,IAAC,CApB6B,GAwVuBE,eCHjDkT,GAAY,SAACnG,GACjB,IAAAg1B,EAA0BpK,GAAAA,QAAWlgC,IAAI,UAAjCsT,EAAKg3B,EAALh3B,MACFi3B,GADeD,EAAN/2B,OACGD,EAAQ,KAIpBk3B,EAAmBD,EAAY,IAAMj3B,EAA4B,EAAnBgC,EAAMvC,QAAQZ,GAC5Ds4B,EAAkBF,EAAYj1B,EAAMvC,QAAQV,GAAKiD,EAAMvC,QAAQZ,GAG/Du4B,EAAiBF,EAAuC,EAAnBl1B,EAAMvC,QAAQb,GACnDy4B,EAAcn0B,KAAKo0B,IACvBF,EAAiB,EACjBH,EAAY,GAAK,IAGnB,OAAOtzB,EAAAA,QAAWxb,OAAO,CACvByb,UAAW,CACTC,KAAM,EACNC,gBAAiB9B,EAAMC,OAAOpG,YAGhCswB,eAAgB,CACdjoB,cAAe,MACfE,eAAgB,gBAChBD,WAAY,SACZa,kBAAmBmyB,EACnBpyB,gBAAiB/C,EAAMvC,QAAQZ,GAC/ByF,kBAAmB,EACnBC,kBAAmBvC,EAAMC,OAAO9F,OAChCo7B,SAAUL,EACVhrB,UAAW,SACXlM,MAAO,QAETw3B,UAAW,CACThzB,SAAUxC,EAAM7D,WAAWO,UAAUI,GACrC2F,WAAY,OACZC,MAAO1C,EAAMC,OAAOjG,KACpB0J,WAAY1D,EAAM7D,WAAWC,aAAaI,MAE5Ci5B,SAAU,CACRzyB,kBAAmBhD,EAAMvC,QAAQb,GACjCmG,gBAAiB/C,EAAMvC,QAAQZ,GAC/BiF,gBAAiB9B,EAAMC,OAAOlG,KAC9BuwB,OAAQtqB,EAAMvC,QAAQZ,GACtBc,aAAc,EACd43B,SAAUL,EACVhrB,UAAW,SACXlM,MAAOi3B,EAAYC,EAAmB,QAExCQ,SAAU,CACRxzB,cAAe,MACfE,eAAgB,eAChB4B,aAAchE,EAAMvC,QAAQb,IAE9B+4B,YAAa,CACXnzB,SAAUyyB,EAAYj1B,EAAM7D,WAAWO,UAAUE,GAAKoD,EAAM7D,WAAWO,UAAUC,GACjF+F,MAAO1C,EAAMC,OAAOhG,cACpByJ,WAAY1D,EAAM7D,WAAWC,aAAaG,SAC1CyB,MAAOq3B,EACPpxB,UAAW,UAEb2xB,cAAe,CACb1zB,cAAe,MACfmf,SAAU,OACVjf,eAAgB,gBAElByzB,aAAc,CACZ73B,MAAOq3B,EACPp3B,OAAQo3B,EACRjzB,eAAgB,SAChBD,WAAY,SACZmG,YAAa,EACbD,YAAa,cACb1K,aAAc,EACd2sB,OAAQ,GAEVwL,qBAAsB,CACpBh0B,gBAAiB9B,EAAMC,OAAOzG,QAC9B6O,YAAarI,EAAMC,OAAOzG,QAC1BmE,aAAc,IAEhBo4B,QAAS,CACPvzB,SAAUyyB,EAAYj1B,EAAM7D,WAAWO,UAAUE,GAAKoD,EAAM7D,WAAWO,UAAUC,GACjF+F,MAAO1C,EAAMC,OAAOjG,KACpB0J,WAAY1D,EAAM7D,WAAWC,aAAaC,SAE5C25B,gBAAiB,CACftzB,MAAO1C,EAAMb,WAAaa,EAAMC,OAAOpG,WAAamG,EAAMC,OAAO5E,MACjEoH,WAAY,OACZiB,WAAY1D,EAAM7D,WAAWC,aAAaI,MAE5Cy5B,eAAgB,CACdj4B,MAAO,EACPC,OAAQ,EACRN,aAAc,EACdmE,gBAAiB9B,EAAMC,OAAOtG,UAC9Bgd,SAAU,WACV+K,OAAQuT,EAAY,EAAI,GAE1BiB,uBAAwB,CACtBp0B,gBAAiB9B,EAAMb,WAAaa,EAAMC,OAAOpG,WAAamG,EAAMC,OAAO5E,OAE7E86B,sBAAuB,CACrB9zB,QAASrC,EAAMvC,QAAQZ,GACvBqF,cAAe,MACfE,eAAgB,gBAChBD,WAAY,SACZiC,eAAgB,EAChB9B,kBAAmB,EACnB+F,YAAarI,EAAMC,OAAO9F,OAC1B2H,gBAAiB9B,EAAMC,OAAOlG,KAC9Bw7B,SAAUL,EACVhrB,UAAW,SACXlM,MAAOi3B,EAAYC,EAAmB,QAExCkB,iBAAkB,CAChB5zB,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC4F,WAAY,OACZC,MAAO1C,EAAMC,OAAOjG,KACpB0J,WAAY1D,EAAM7D,WAAWC,aAAaI,MAE5C65B,UAAW,CACTv0B,gBAAiB9B,EAAMC,OAAOzG,QAC9B6I,QAASrC,EAAMvC,QAAQb,GACvBe,aAAc,IAEhB0tB,gBAAiB,CACfxpB,KAAM,EACNO,eAAgB,SAChBD,WAAY,SACZL,gBAAiB9B,EAAMC,OAAOpG,YAEhCyxB,kBAAmB,CACjBzpB,KAAM,EACNC,gBAAiB9B,EAAMC,OAAOpG,YAEhCy8B,iBAAkB,CAChBz0B,KAAM,EACN0zB,SAAUL,EACVhrB,UAAW,SACXlM,MAAOi3B,EAAYC,EAAmB,QAExCvP,eAAgB,CACd9jB,KAAM,EACNO,eAAgB,SAChBD,WAAY,SACZE,QAASrC,EAAMvC,QAAQX,GACvBuJ,UAAW4uB,EAAY,IAAM,KAE/BrP,UAAW,CACTpjB,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC6F,MAAO1C,EAAMC,OAAOhG,cACpBsJ,UAAWvD,EAAMvC,QAAQZ,GACzBmH,aAAchE,EAAMvC,QAAQX,GAC5BmH,UAAW,SACXP,WAAY1D,EAAM7D,WAAWC,aAAaC,SAE5Ck6B,aAAc,CACZz0B,gBAAiB9B,EAAMC,OAAOzG,QAC9BuJ,gBAAiB/C,EAAMvC,QAAQZ,GAC/BmG,kBAAmBhD,EAAMvC,QAAQV,GACjCY,aAAc,IAEhB64B,iBAAkB,CAChB9zB,MAAO1C,EAAMb,WAAaa,EAAMC,OAAOpG,WAAamG,EAAMC,OAAO5E,MACjEmH,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC4F,WAAY,OACZiB,WAAY1D,EAAM7D,WAAWC,aAAaI,MAE5CgvB,YAAa,CACXnpB,QAASrC,EAAMvC,QAAQZ,GACvBoE,cAA+B,QAAhBhgB,EAAAA,QAASC,GAAe,GAAK,IAE9C+mB,gBAAiB,CACfpG,KAAM,GAERqG,cAAe,CACbC,SAAU,GAEZsuB,qBAAsB,CACpBpwB,UAAW4uB,EAAY,IAAM,KAE/BrJ,kBAAmB,CACjBjV,SAAU,WACV+K,OAAwB,QAAhBzgC,EAAAA,QAASC,GAAe,IAAM,IACtC0gC,MAAO5hB,EAAMvC,QAAQX,GACrBkB,MAAO,GACPC,OAAQ,GACRN,aAAc,GACdmE,gBAAiB9B,EAAMC,OAAOzG,QAC9B4I,eAAgB,SAChBD,WAAY,SACZ/D,UAAW,EACXN,YAAakC,EAAMC,OAAOrF,OAC1BmD,aAAc,CAAEC,MAAO,EAAGC,OAAQ,GAClCC,cAAe,GACfC,aAAc,EACd0tB,OAAQ,MAGd,EAEA,SAjiBuB,WACrB,IAAMzhB,GAAaC,EAAAA,GAAAA,iBACXrK,EAAUG,KAAVH,MACF0B,EAASyE,GAAUnG,GAEzBzJ,GAAwCC,EAAAA,EAAAA,UAAS,IAAI9S,MAAO+S,GAAAC,EAAAA,EAAAA,SAAAH,EAAA,GAArDmgC,EAAYjgC,EAAA,GAAEkgC,EAAelgC,EAAA,GACpCI,GAAwCL,EAAAA,EAAAA,UAAS,IAAI9S,MAAOoT,GAAAJ,EAAAA,EAAAA,SAAAG,EAAA,GAArD+/B,EAAY9/B,EAAA,GAAE+/B,EAAe//B,EAAA,GACpCG,GAAoCT,EAAAA,EAAAA,UAAyB,IAAGU,GAAAR,EAAAA,EAAAA,SAAAO,EAAA,GAAzD6/B,EAAU5/B,EAAA,GAAE6/B,EAAa7/B,EAAA,GAChCG,GAA4Eb,EAAAA,EAAAA,UAAyB,IAAGc,GAAAZ,EAAAA,EAAAA,SAAAW,EAAA,GAAjG2/B,EAA8B1/B,EAAA,GAAE2/B,EAAiC3/B,EAAA,GACxEoT,GAAkClU,EAAAA,EAAAA,WAAS,GAAKmU,GAAAjU,EAAAA,EAAAA,SAAAgU,EAAA,GAAzC3T,EAAS4T,EAAA,GAAE3T,EAAY2T,EAAA,GAC9BE,GAAsDrU,EAAAA,EAAAA,WAAS,GAAMsU,GAAApU,EAAAA,EAAAA,SAAAmU,EAAA,GAA9DqsB,EAAmBpsB,EAAA,GAAEqsB,EAAsBrsB,EAAA,GAClDsC,GAAwC5W,EAAAA,EAAAA,WAAS,GAAM6W,GAAA3W,EAAAA,EAAAA,SAAA0W,EAAA,GAAhD6e,EAAY5e,EAAA,GAAE6e,EAAe7e,EAAA,GAGpCC,GAA8C9W,EAAAA,EAAAA,WAAS,GAAM+W,GAAA7W,EAAAA,EAAAA,SAAA4W,EAAA,GAAtDsgB,EAAergB,EAAA,GAAEsgB,EAAkBtgB,EAAA,GACpCkf,GAAgBlV,EAAAA,EAAAA,QAAY,MAG5BuW,GAAe3O,EAAAA,EAAAA,cAAY,SAAC4O,GAChC,IAAQC,EAAkBD,EAAME,YAAxBD,cAGRH,EAAmBG,EAAcX,EAAI,IACvC,GAAG,IAGGa,GAAc/O,EAAAA,EAAAA,cAAY,WAC1BsN,EAAc/U,SAChB+U,EAAc/U,QAAQ0V,SAAS,CAC7BC,EAAG,EACH3D,UAAU,GAGhB,GAAG,KAGHlyB,EAAAA,EAAAA,YAAU,WACR,IAAM4/B,EAAqB,eAAAhwC,GAAApF,EAAAA,EAAAA,UAAG,YAC5B,IAAM0wC,EAAiBF,GAAoB6E,oBAC3CF,EAAuBzE,EAAexvC,OAAS,EACjD,IAAC,kBAH0B,OAAAkE,EAAAxE,MAAA,KAAAC,UAAA,KAK3Bu0C,IAEA,IAAME,EAAWC,YAAYH,EAAuB,KAEpD,OAAO,kBAAMI,cAAcF,EAAU,CACvC,GAAG,IAEH,IAAMG,GAAiB1Q,EAAAA,EAAAA,UAAQ,WAE7B,OAAO+P,CACT,GAAG,CAACA,EAAYI,KAEhBhQ,EAAAA,GAAAA,gBACEC,EAAAA,aAAkB,WAChB2F,IAEI8J,GACFc,EAA4Bd,EAEhC,GAAG,CAACA,MAGNp/B,EAAAA,EAAAA,YAAU,WAEJo/B,GACFc,EAA4Bd,EAEhC,GAAG,CAACA,KAGJp/B,EAAAA,EAAAA,YAAU,WACJo/B,GAAgBE,EAAW5zC,OAAS,GAEtCw0C,EAA4Bd,EAEhC,GAAG,CAACM,IAEJ,IAMMpK,EAAY,eAAA9kC,GAAAhG,EAAAA,EAAAA,UAAG,YACnB,IACEgV,GAAa,GAGb,IAAM2gC,QAA2BptC,EAAWC,WAAW,CACrD0C,MAAO,IACP0qC,gBAAgB,IAEZlkB,EAAUtwB,MAAM8G,QAAQytC,EAAmB7zC,MAC7C6zC,EAAmB7zC,KACnB6zC,EAAmB7zC,KAAK4vB,SAAW,GACvCqjB,EAAcrjB,SAGRgkB,EAA4Bd,EACpC,CAAE,MAAOj0C,GACPV,QAAQU,MAAM,iCAAkCA,GAChDslC,GAAAA,QAAMC,MAAM,QAAS,iCACvB,CAAC,QACClxB,GAAa,GACbk1B,GAAgB,EAClB,CACF,IAAC,kBAvBiB,OAAAlkC,EAAApF,MAAA,KAAAC,UAAA,KA0BZomC,EAAY9B,EAAAA,aAAkB,WAClC+E,GAAgB,GAChBY,GACF,GAAG,CAAC8J,IAGEc,EAA2B,eAAArtC,GAAArI,EAAAA,EAAAA,UAAG,UAAOg/B,GACzC,IAAK,IAAD+L,EAAAC,EAEI9K,GAAgBC,EAAAA,GAAAA,SAAOnB,EAAM,cAG7Bn5B,QAAiB0C,EAAWC,WAAW,CAE3CqtC,WAAY3V,EACZ4V,SAAU5V,EACV0V,gBAAgB,IAGZlkB,EAAUtwB,MAAM8G,QAAQrC,EAAS/D,MACnC+D,EAAS/D,KACc,OADVipC,EACC,OADDC,EACZnlC,EAAS/D,WAAI,EAAbkpC,EAAetZ,SAAOqZ,EAAI,GAC/BkK,EAAkCvjB,EACpC,CAAE,MAAO/wB,GACPV,QAAQU,MAAM,oCAAmCw/B,EAAAA,GAAAA,SAAOnB,EAAM,cAAiBr+B,GAC/Es0C,EAAkC,GACpC,CACF,IAAC,gBArBgCzyC,GAAA,OAAA6F,EAAAzH,MAAA,KAAAC,UAAA,KAwC3Bk1C,EAAoB,WAExB,IAAM7V,GAAgBC,EAAAA,GAAAA,SAAOyU,EAAc,cAC3CxsB,EAAW0B,SAAS,SAAU,CAC5B8qB,aAAc1U,GAElB,EAOM8V,EAAY,SAACC,GACjB,IAAMC,GAAY/V,EAAAA,GAAAA,SAAO8V,EAAK,KACxBE,EAAkBV,EAAelnB,MAAK,SAAAwR,GAC1C,IACE,IAAMqW,GAAYhW,EAAAA,GAAAA,SAASL,EAAMn2B,YACjC,OAAOwsC,EAAUC,gBAAkBJ,EAAII,eAChCD,EAAUE,aAAeL,EAAIK,YAC7BF,EAAUG,YAAcN,EAAIM,SACrC,CAAE,MAAOpgC,GAEP,OADAlW,QAAQU,MAAM,2CAA2Co/B,EAAMn2B,WAAcuM,IACtE,CACT,CACF,IAEMqgC,GAAaC,EAAAA,GAAAA,SAAUR,EAAKrB,GAElC,OACElxB,EAAAA,EAAAA,MAACI,GAAAA,QAAgB,CACfF,MAAO,CACLlE,EAAOm0B,aACP2C,GAAc92B,EAAOo0B,sBAEvB/vB,QAAS,WACP8wB,EAAgBoB,GAEhBP,EAA4BO,EAC9B,EAAE3hC,SAAA,EAEF4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAO,CACXlE,EAAOq0B,QACPyC,GAAc92B,EAAOs0B,iBACrB1/B,SACC4hC,IAGFC,IAAmBj/B,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAO,CAC/BlE,EAAOu0B,eACPuC,GAAc92B,EAAOw0B,4BAI7B,EAUA,OACExwB,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOE,UAAUtL,SAAA,EAC5B4C,EAAAA,EAAAA,KAAC4vB,GAAY,CACX/9B,MAAM,WACNk4B,uBAAwBiU,EACxBnU,cAAc,wBAGhBrd,EAAAA,EAAAA,MAACtF,GAAc,CACbwF,MAAO,CAAE/D,KAAM,GACfpB,sBAAuB,CAAE0H,SAAU,GACnC4gB,gBACE7vB,EAAAA,EAAAA,KAAC8vB,GAAAA,QAAc,CACbpC,WAAYqF,EACZhD,UAAWA,EACXhpB,OAAQ,CAACD,EAAMC,OAAOzG,SACtB0vB,UAAWlpB,EAAMC,OAAOzG,UAG5Bg1B,SAAUV,EACVxtB,IAAKmsB,EAAcn2B,SAAA,EAEnBoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOyoB,eAAe7zB,SAAA,EACjC4C,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CAACC,QAnGA,WACxB,IAAM2yB,EAAgB,IAAIh1C,KAAKgzC,GAC/BgC,EAAcC,SAASD,EAAcJ,WAAa,GAClD3B,EAAgB+B,EAClB,EA+FqDpiC,UAC3C4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,eAAevO,KAAMsd,EAAM7D,WAAWO,UAAUM,IAAK0F,MAAO1C,EAAMC,OAAOjG,UAG1Fd,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO8zB,UAAUl/B,UAC3B6rB,EAAAA,GAAAA,SAAOuU,EAAc,gBAGxBx9B,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CAACC,QArGJ,WACpB,IAAM6yB,EAAY,IAAIl1C,KAAKgzC,GAC3BkC,EAAUD,SAASC,EAAUN,WAAa,GAC1C3B,EAAgBiC,EAClB,EAiGiDtiC,UACvC4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,kBAAkBvO,KAAMsd,EAAM7D,WAAWO,UAAUM,IAAK0F,MAAO1C,EAAMC,OAAOjG,aAI/F0L,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAO+zB,SAASn/B,SAAA,EAC3B4C,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAOg0B,SAASp/B,SAC1B,CAAC,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,OAAOmmB,KAAI,SAACwb,GAAG,OACzD/+B,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAAWL,MAAOlE,EAAOi0B,YAAYr/B,SAAE2hC,GAAjCA,EAA4C,OAI3D/+B,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAOk0B,cAAct/B,SAzLnB,WACrB,IAAM4hB,GAAQ2gB,EAAAA,GAAAA,SAAanC,GACrBoC,GAAMC,EAAAA,GAAAA,SAAWrC,GACvB,OAAOsC,EAAAA,GAAAA,SAAkB,CAAE9gB,MAAAA,EAAO4gB,IAAAA,GACpC,CAsLWG,GAAiBxc,KAAI,SAACwb,GAAG,OACxB/+B,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAAAvP,SACF0hC,EAAUC,IADFA,EAAIt0C,cAER,UAKb+hB,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOy0B,sBAAsB7/B,SAAA,EACxC4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO00B,iBAAiB9/B,UAClC6rB,EAAAA,GAAAA,SAAOyU,EAAc,yBAGxB19B,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CACfF,MAAOlE,EAAO20B,UACdtwB,QAASgyB,EAAkBzhC,UAE3B4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,MAAMvO,KAAMsd,EAAM7D,WAAWO,UAAUM,IAAK0F,MAAO1C,EAAMb,WAAaa,EAAMC,OAAOpG,WAAamG,EAAMC,OAAO5E,aAI/HtE,GACC2O,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAO4pB,kBAAkBh1B,SAAA,EACpC4C,EAAAA,EAAAA,KAAC+wB,GAAgB,IAChB7mC,MAAM0R,KAAK,CAAE5R,OAAQ,IAAK,SAACmnC,EAAGzH,GAAK,OAClC1pB,EAAAA,EAAAA,KAAC2wB,GAAmB,eAAkBjH,EAAW,QAIrD1pB,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAO40B,iBAAiBhgC,SACQ,IAA1C0gC,EAA+B9zC,QAC9BwiB,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOikB,eAAervB,SAAA,EACjC4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,mBAAmBvO,KAA0B,IAApBsd,EAAMvC,QAAQT,IAAW0F,MAAO1C,EAAMC,OAAOxF,YACrFvB,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOkkB,UAAUtvB,SAC3B,8BAEH4C,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CACfF,MAAOlE,EAAO60B,aACdxwB,QAASgyB,EAAkBzhC,UAE3B4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO80B,iBAAiBlgC,SAAC,uBAI1C4C,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAO+0B,qBAAqBngC,UACvC4C,EAAAA,EAAAA,KAACggC,GAAAA,QAAQ,CACPp1C,KAAMkzC,EACNmC,WAnGI,SAAH9gC,GAAA,IAAM+gC,EAAI/gC,EAAJ+gC,KAAMxW,EAAKvqB,EAALuqB,MAAK,OAChC1pB,EAAAA,EAAAA,KAACiwB,GAAW,CACVpH,MAAOqX,EACPrzB,QAAS,WAAF,OAnDegc,EAmDUqX,OAjDlChvB,EAAW0B,SAAS,qBAAsB,CAAEsd,QAASrH,EAAMn3B,GAAG81B,aAFvC,IAACqB,CAmDe,GAAC,kBACfqX,EAAKxuC,GAAE,IAAIg4B,EAClC,EA+FYyW,aAAc,SAACD,EAAMxW,GAAK,uBAAsBwW,EAAKxuC,GAAE,IAAIg4B,CAAK,EAChEniB,sBAAuB,CAACiB,EAAO8pB,YAAa,CAAEvqB,cAAe,KAC7Dq4B,eAAe,EACfC,qBAAqB,WAShC3L,IACC10B,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CACfF,MAAOlE,EAAOkqB,kBACd7lB,QAASmoB,EACThV,cAAe,GAAI5iB,UAEnB4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CACP/U,KAAK,aACLvO,KAAM,GACNggB,MAAO1C,EAAMC,OAAO5E,YAMhC,ECzLA,SAD4B,KAlLY1a,EAAAA,EAAAA,UAFf,SAAA64C,KAAA34C,EAAAA,EAAAA,SAAA,KAAA24C,GAAA,KACfhoB,aAAc,EAAM,KACpBioB,wBAAyB,CAAM,GAAD,EAAA53C,IAAA,aAAAC,MAAA,eAAA4vB,GAAA1vB,EAAAA,EAAAA,UAOtC,YACE,IACE,OAAIjB,KAAKywB,cAET9wB,EAAOqE,KAAK,0DACZhE,KAAKywB,aAAc,IAHU,CAK/B,CAAE,MAAO7uB,GAEP,OADAjC,EAAOiC,MAAM,8CAA+CA,IACrD,CACT,CACF,IAXgB,OAWf,WAXe,OAAA+uB,EAAA9uB,MAAC,KAADC,UAAA,EAPsB,IAOtB,CAAAhB,IAAA,qBAAAC,MAAA,eAAA43C,GAAA13C,EAAAA,EAAAA,UAkBhB,YACE,IAIE,OAFAtB,EAAOqE,KAAK,wDAEL,CACLuqB,SAAS,EACTqqB,aAAa,EACb5xC,OAAQ,UAEZ,CAAE,MAAOpF,GAEP,OADAjC,EAAOiC,MAAM,uDAAwDA,GAC9D,CACL2sB,SAAS,EACTqqB,aAAa,EACb5xC,OAAQ,SAEZ,CACF,IAlBwB,OAkBvB,WAlBuB,OAAA2xC,EAAA92C,MAAC,KAADC,UAAA,EAlBR,IAkBQ,CAAAhB,IAAA,wBAAAC,MAAA,eAAA83C,GAAA53C,EAAAA,EAAAA,UAyBxB,YACE,IACE,IAAMuvB,QAAiB8C,GAAgBP,cAGvC,IAAKvC,EAAST,uBAAyBS,EAASR,sBAG9C,OAFArwB,EAAOqE,KAAK,8DACZhE,KAAK04C,wBAAyB,GACvB,EAIT,IAAAI,EAAyBtoB,EAASP,kBAAkB9L,MAAM,KAAKuX,IAAIqd,QAAOC,GAAArjC,EAAAA,EAAAA,SAAAmjC,EAAA,GAAnEG,EAAKD,EAAA,GAAEtZ,EAAOsZ,EAAA,GAErB,OAAIE,MAAMD,IAAUC,MAAMxZ,IAAYuZ,EAAQ,GAAKA,EAAQ,IAAMvZ,EAAU,GAAKA,EAAU,IACxF//B,EAAOiC,MAAM,gDAAgD4uB,EAASP,oBAC/D,IAITjwB,KAAK04C,wBAAyB,EAC9B/4C,EAAOqE,KAAK,qDAAqDwsB,EAASP,kBAAiB,iBAKpF,EACT,CAAE,MAAOruB,GAEP,OADAjC,EAAOiC,MAAM,2DAA4DA,IAClE,CACT,CACF,IA/B2B,OA+B1B,WA/B0B,OAAAi3C,EAAAh3C,MAAC,KAADC,UAAA,EAzBH,IAyBG,CAAAhB,IAAA,sBAAAC,MAAA,eAAAo4C,GAAAl4C,EAAAA,EAAAA,UAoC3B,YACE,IACEjB,KAAK04C,wBAAyB,EAC9B/4C,EAAOqE,KAAK,6DAId,CAAE,MAAOpC,GACPjC,EAAOiC,MAAM,yDAA0DA,EACzE,CACF,IAVyB,OAUxB,WAVwB,OAAAu3C,EAAAt3C,MAAC,KAADC,UAAA,EApCE,IAoCF,CAAAhB,IAAA,6BAAAC,MAAA,eAAAq4C,GAAAn4C,EAAAA,EAAAA,UAezB,YACE,IACE,IAAMuvB,QAAiB8C,GAAgBP,cAEnCvC,EAASR,uBAAyBQ,EAAST,2BAEvC/vB,KAAKq5C,8BAGLr5C,KAAKs5C,sBAGb35C,EAAOqE,KAAK,sDACd,CAAE,MAAOpC,GACPjC,EAAOiC,MAAM,gEAAiEA,EAChF,CACF,IAhBgC,OAgB/B,WAhB+B,OAAAw3C,EAAAv3C,MAAC,KAADC,UAAA,EAfP,IAeO,CAAAhB,IAAA,eAAAC,MAAA,eAAAw4C,GAAAt4C,EAAAA,EAAAA,UAqBhC,YACE,IAEE,OAAO,CACT,CAAE,MAAOW,GAEP,OADAjC,EAAOiC,MAAM,uDAAwDA,IAC9D,CACT,CACF,IARkB,OAQjB,WARiB,OAAA23C,EAAA13C,MAAC,KAADC,UAAA,EArBc,IAqBd,CAAAhB,IAAA,sBAAAC,MAAA,eAAAy4C,GAAAv4C,EAAAA,EAAAA,UAalB,YACE,IAEE,MAAO,SACT,CAAE,MAAOW,GAEP,OADAjC,EAAOiC,MAAM,yDAA0DA,GAChE,QACT,CACF,IARyB,OAQxB,WARwB,OAAA43C,EAAA33C,MAAC,KAADC,UAAA,EAbP,IAaO,CAAAhB,IAAA,uBAAAC,MAAA,eAAA04C,GAAAx4C,EAAAA,EAAAA,UAazB,YACE,IAGE,WAFuBqyB,GAAgBP,eAEzBhD,qBAEZ,YADAmX,GAAAA,QAAMC,MAAM,yBAA0B,oDAIxCD,GAAAA,QAAMC,MACJ,gCACA,mGACA,CAAC,CAAEluB,KAAM,QAGXtZ,EAAOqE,KAAK,iDACd,CAAE,MAAOpC,GACPjC,EAAOiC,MAAM,0DAA2DA,EAC1E,CACF,IAnB0B,OAmBzB,WAnByB,OAAA63C,EAAA53C,MAAC,KAADC,UAAA,EAbD,IAaC,CAAAhB,IAAA,2BAAAC,MAwB1B,WACE,OAAOf,KAAK04C,sBACd,MCzKF,IAAMgB,IAAkBrkC,EAAAA,EAAAA,oBAAgDxR,GAM3D81C,GAAoD,SAAHtzC,GAAsB,IAAhBkP,EAAQlP,EAARkP,SAClEC,GAAgCC,EAAAA,EAAAA,UAAuBia,IAAiBha,GAAAC,EAAAA,EAAAA,SAAAH,EAAA,GAAjEgb,EAAQ9a,EAAA,GAAEkkC,EAAWlkC,EAAA,GAC5BI,GAAkCL,EAAAA,EAAAA,WAAS,GAAKM,GAAAJ,EAAAA,EAAAA,SAAAG,EAAA,GAAzCE,EAASD,EAAA,GAAEE,EAAYF,EAAA,GAC9BG,GAA0BT,EAAAA,EAAAA,UAAwB,MAAKU,GAAAR,EAAAA,EAAAA,SAAAO,EAAA,GAAhDtU,EAAKuU,EAAA,GAAE0jC,EAAQ1jC,EAAA,IAGtBM,EAAAA,EAAAA,YAAU,WACR,IAAMqjC,EAAkB,eAAA7yC,GAAAhG,EAAAA,EAAAA,UAAG,YACzB,IACEgV,GAAa,GACb4jC,EAAS,MAET,IAAME,QAAuBzmB,GAAgBrc,aAC7C2iC,EAAYG,GAEZp6C,EAAOqE,KAAK,sDACd,CAAE,MAAOitB,GACP,IAAM5nB,EAAe4nB,aAAe1tB,MAAQ0tB,EAAI1uB,QAAU,gCAC1D5C,EAAOiC,MAAM,oDAAqDqvB,GAClE4oB,EAASxwC,GAGTuwC,EAAYlqB,GACd,CAAC,QACCzZ,GAAa,EACf,CACF,IAAC,kBAnBuB,OAAAhP,EAAApF,MAAA,KAAAC,UAAA,KAqBxBg4C,GACF,GAAG,KAGHrjC,EAAAA,EAAAA,YAAU,WAMR,OALoB6c,GAAgB0mB,WAAU,SAACC,GAC7CL,EAAYK,GACZt6C,EAAOmE,MAAM,sDACf,GAGF,GAAG,IAGH,IAAMo2C,EAAa,eAAA5wC,GAAArI,EAAAA,EAAAA,UAAG,UACpBH,EACAC,GAEA,IACE84C,EAAS,YACHvmB,GAAgB4mB,cAAcp5C,EAAKC,GAG7B,yBAARD,GAA0C,0BAARA,GAA2C,sBAARA,UACjEq5C,GAAoBC,6BAC1Bz6C,EAAOqE,KAAK,yDAAyDlD,EAAG,WAI5E,CAAE,MAAOmwB,GACP,IAAM5nB,EAAe4nB,aAAe1tB,MAAQ0tB,EAAI1uB,QAAO,oBAAuBzB,EAG9E,MAFAnB,EAAOiC,MAAM,8CAA8Cd,EAAG,IAAKmwB,GACnE4oB,EAASxwC,GACH4nB,CACR,CACF,IAAC,gBArBkBxtB,EAAAC,GAAA,OAAA4F,EAAAzH,MAAA,KAAAC,UAAA,KAwBbqwB,EAAc,eAAA7a,GAAArW,EAAAA,EAAAA,UAAG,UAAO0L,GAC5B,IACEktC,EAAS,YACHvmB,GAAgBnB,eAAexlB,EAEvC,CAAE,MAAOskB,GACP,IAAM5nB,EAAe4nB,aAAe1tB,MAAQ0tB,EAAI1uB,QAAU,4BAG1D,MAFA5C,EAAOiC,MAAM,+CAAgDqvB,GAC7D4oB,EAASxwC,GACH4nB,CACR,CACF,IAAC,gBAXmBttB,GAAA,OAAA2T,EAAAzV,MAAA,KAAAC,UAAA,KAcdu4C,EAAe,eAAA3iC,GAAAzW,EAAAA,EAAAA,UAAG,YACtB,IACE44C,EAAS,YACHvmB,GAAgB+mB,kBAEtB16C,EAAOqE,KAAK,+CACd,CAAE,MAAOitB,GACP,IAAM5nB,EAAe4nB,aAAe1tB,MAAQ0tB,EAAI1uB,QAAU,2BAG1D,MAFA5C,EAAOiC,MAAM,8CAA+CqvB,GAC5D4oB,EAASxwC,GACH4nB,CACR,CACF,IAAC,kBAZoB,OAAAvZ,EAAA7V,MAAA,KAAAC,UAAA,KAefw4C,EAAc,eAAAviC,GAAA9W,EAAAA,EAAAA,UAAG,YACrB,IACE44C,EAAS,MACT,IAAMjoB,QAAmB0B,GAAgBgnB,iBAEzC,OADA36C,EAAOqE,KAAK,oDACL4tB,CACT,CAAE,MAAOX,GACP,IAAM5nB,EAAe4nB,aAAe1tB,MAAQ0tB,EAAI1uB,QAAU,4BAG1D,MAFA5C,EAAOiC,MAAM,+CAAgDqvB,GAC7D4oB,EAASxwC,GACH4nB,CACR,CACF,IAAC,kBAZmB,OAAAlZ,EAAAlW,MAAA,KAAAC,UAAA,KAedy4C,EAAc,eAAAriC,GAAAjX,EAAAA,EAAAA,UAAG,UAAO+wB,GAC5B,IACE6nB,EAAS,YACHvmB,GAAgBinB,eAAevoB,GAErCryB,EAAOqE,KAAK,mDACd,CAAE,MAAOitB,GACP,IAAM5nB,EAAe4nB,aAAe1tB,MAAQ0tB,EAAI1uB,QAAU,4BAG1D,MAFA5C,EAAOiC,MAAM,+CAAgDqvB,GAC7D4oB,EAASxwC,GACH4nB,CACR,CACF,IAAC,gBAZmBrkB,GAAA,OAAAsL,EAAArW,MAAA,KAAAC,UAAA,KAmBd04C,EAAqC,CACzChqB,SAAAA,EACAxa,UAAAA,EACApU,MAAAA,EACAs4C,cAAAA,EACA/nB,eAAAA,EACAkoB,gBAAAA,EACAC,eAAAA,EACAC,eAAAA,EACAE,WAbiB,SAA+B35C,GAChD,OAAO0vB,EAAS1vB,EAClB,GAcA,OACEqX,EAAAA,EAAAA,KAACuhC,GAAgBthC,SAAQ,CAACrX,MAAOy5C,EAAajlC,SAC3CA,GAGP,EAEamlC,GAAc,WACzB,IAAMpiC,GAAUC,EAAAA,EAAAA,YAAWmhC,IAC3B,QAAgB71C,IAAZyU,EACF,MAAM,IAAI/U,MAAM,sDAElB,OAAO+U,CACT,ECtJA,IA2FM8M,GAAY,SAACnG,GAAe,OAAK2B,EAAAA,QAAWxb,OAAO,CACvDyb,UAAW,CACTM,cAAe,MACfC,WAAY,SACZY,gBAAiB/C,EAAMvC,QAAQZ,GAC/BmG,kBAAmBhD,EAAMvC,QAAQX,GACjCgF,gBAAiB9B,EAAMC,OAAOlG,KAC9BuI,kBAAmB,EACnBC,kBAAmBvC,EAAMC,OAAO9F,OAChCkM,UAAW,IAEbq1B,kBAAmB,CACjB3kB,QAAS,IAEX4kB,wBAAyB,CAEzB,EACAC,YAAa,CACX15B,cAAe,MACfC,WAAY,SACZN,KAAM,GAERg6B,cAAe,CACb79B,MAAO,GACPC,OAAQ,GACRN,aAAcqC,EAAMrC,aAAab,GACjCgF,gBAAiB9B,EAAMC,OAAOxG,aAAe,KAC7C2I,eAAgB,SAChBD,WAAY,SACZgH,YAAanJ,EAAMvC,QAAQZ,IAE7Bi/B,cAAe,CACbj6B,KAAM,GAER9W,MAAO,CACLyX,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC6G,WAAY1D,EAAM7D,WAAWC,aAAaG,SAC1CmG,MAAO1C,EAAMC,OAAOjG,KACpBgK,aAAchE,EAAMvC,QAAQd,IAE9Bo/B,cAAe,CACbr5B,MAAO1C,EAAMC,OAAOhG,eAEtBwO,SAAU,CACRjG,SAAUxC,EAAM7D,WAAWO,UAAUE,GACrC8G,WAAY1D,EAAM7D,WAAWC,aAAaC,QAC1CqG,MAAO1C,EAAMC,OAAOhG,cACpBknB,WAAY,IAEd6a,iBAAkB,CAChBt5B,MAAO1C,EAAMC,OAAO9F,QAEtB8hC,aAAc,CACZ/5B,cAAe,MACfC,WAAY,SACZuE,WAAY1G,EAAMvC,QAAQZ,IAE5Bq/B,iBAAkB,CAChBx1B,WAAY1G,EAAMvC,QAAQb,KAE3B,EAEH,SAzJgD,SAAHxV,GAWtC,IAVL2D,EAAK3D,EAAL2D,MACA0d,EAAQrhB,EAARqhB,SACA0zB,EAAQ/0C,EAAR+0C,SACAC,EAAah1C,EAAbg1C,cACAC,EAAYj1C,EAAZi1C,aACAt2B,EAAO3e,EAAP2e,QAAOiB,EAAA5f,EACPqT,SAAAA,OAAQ,IAAAuM,GAAQA,EAChBpB,EAAKxe,EAALwe,MAAK02B,EAAAl1C,EACLm1C,YAAAA,OAAW,IAAAD,GAAQA,EACnBjlB,EAAMjwB,EAANiwB,OAEQrX,EAAUG,KAAVH,MACF0B,EAASyE,GAAUnG,GASnBw8B,IAAkBz2B,IAAYtL,EAEpC,OACEiL,EAAAA,EAAAA,MAACI,GAAAA,QAAgB,CACfF,MAAO,CACLlE,EAAOE,UACPnH,GAAYiH,EAAOg6B,mBAClBc,GAAiB96B,EAAOi6B,wBACzB/1B,GAEFG,QAjBgB,YACbtL,GAAYsL,IACf6S,GAAc6jB,YACd12B,IAEJ,EAaItL,UAAW+hC,EACXtjB,cAAesjB,EAAgB,GAAM,EACrCnlB,OAAQA,EACRqlB,kBAAmBF,EAAgB,SAAW,OAC9CG,mBAAoBl0B,EAAc1d,EAAK,KAAK0d,EAAa1d,EACzD6xC,kBAAmBJ,EAAgB,kCAA+B53C,EAAU0R,SAAA,EAE5EoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOk6B,YAAYtlC,SAAA,CAC7B6lC,IACCjjC,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAOm6B,cAAcvlC,UAChC4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CACP/U,KAAMkrC,EACNz5C,KAAM,GACNggB,MAAOjI,EAAWuF,EAAMC,OAAOxF,SAAY2hC,GAAiBp8B,EAAMC,OAAOzG,aAK/EkM,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOo6B,cAAcxlC,SAAA,EAChC4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CACHL,MAAO,CACLlE,EAAO3W,MACP0P,GAAYiH,EAAOq6B,eACnBzlC,SAEDvL,IAGF0d,IACCvP,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CACHL,MAAO,CACLlE,EAAO+G,SACPhO,GAAYiH,EAAOs6B,kBACnB1lC,SAEDmS,WAMT/C,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOu6B,aAAa3lC,SAAA,CAC9B+lC,EAEAE,GAAeC,IACdtjC,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAOw6B,iBAAiB5lC,UACnC4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CACP/U,KAAK,kBACLvO,KAAM,GACNggB,MAAOjI,EAAWuF,EAAMC,OAAOxF,SAAWuF,EAAMC,OAAOhG,uBAOrE,E,eClDA,SAjDsD,SAAH7S,GAS5C,IARL2D,EAAK3D,EAAL2D,MACA0d,EAAQrhB,EAARqhB,SACA0zB,EAAQ/0C,EAAR+0C,SACAr6C,EAAKsF,EAALtF,MACA+6C,EAAaz1C,EAAby1C,cAAa71B,EAAA5f,EACbqT,SAAAA,OAAQ,IAAAuM,GAAQA,EAChBpB,EAAKxe,EAALwe,MACAyR,EAAMjwB,EAANiwB,OAEQrX,EAAUG,KAAVH,MAQF88B,GACJ5jC,EAAAA,EAAAA,KAAC6jC,GAAAA,QAAM,CACLC,WAAY,CACVC,MAAOj9B,EAAMC,OAAOxE,QACpByhC,KAAMl9B,EAAMC,OAAOzG,QAAU,MAE/B2jC,WAAYr7C,EAAQke,EAAMC,OAAOzG,QAAUwG,EAAMC,OAAO1E,QACxD6hC,oBAAqBp9B,EAAMC,OAAOxE,QAClCohC,cAAeA,EACf/6C,MAAOA,EACP2Y,SAAUA,EACVkiC,mBAAuB5xC,EAAK,UAC5B2xC,kBAAkB,SAClBW,mBAAoB,CAAEC,QAASx7C,KAInC,OACEoX,EAAAA,EAAAA,KAACqkC,GAAW,CACVxyC,MAAOA,EACP0d,SAAUA,EACV0zB,SAAUA,EACVE,aAAcS,EACd/2B,QA7BiB,WACdtL,GACHoiC,GAAe/6C,EAEnB,EA0BI2Y,SAAUA,EACVmL,MAAOA,EACPyR,OAAQA,GAGd,EC7BA,IA8IMlR,GAAY,SAACnG,GAAe,OAAK2B,EAAAA,QAAWxb,OAAO,CACvDq3C,eAAgB,CACdr7B,WAAY,YAEds7B,aAAc,CACZj7B,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC6G,WAAY1D,EAAM7D,WAAWC,aAAaC,QAC1CqG,MAAO1C,EAAMC,OAAOhG,cACpBgK,UAAW,SAEby5B,qBAAsB,CACpBh7B,MAAO1C,EAAMC,OAAOxF,UAEtBkjC,gBAAiB,CACfC,UAAW,SACXl7B,MAAO1C,EAAMC,OAAO/F,cAEtB2jC,eAAgB,CACdh8B,KAAM,EACNC,gBAAiB9B,EAAMC,OAAOpG,YAEhCikC,YAAa,CACX57B,cAAe,MACfC,WAAY,SACZC,eAAgB,gBAChBY,kBAAmBhD,EAAMvC,QAAQX,GACjCiG,gBAAiB/C,EAAMvC,QAAQZ,GAC/ByF,kBAAmB,EACnBC,kBAAmBvC,EAAMC,OAAO9F,OAChC2H,gBAAiB9B,EAAMC,OAAOlG,MAEhCgkC,WAAY,CACV//B,MAAO,IAETggC,WAAY,CACVx7B,SAAUxC,EAAM7D,WAAWO,UAAUI,GACrC4G,WAAY1D,EAAM7D,WAAWC,aAAaI,KAC1CkG,MAAO1C,EAAMC,OAAOjG,KACpBiK,UAAW,UAEbg6B,aAAc,CACZjgC,MAAO,GACPmE,WAAY,YAEd+7B,eAAgB,CACd17B,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC6G,WAAY1D,EAAM7D,WAAWC,aAAaG,SAC1CmG,MAAO1C,EAAMC,OAAOzG,SAEtB2kC,YAAa,CACXt8B,KAAM,GAERu8B,WAAY,CACVl8B,cAAe,MACfC,WAAY,SACZC,eAAgB,gBAChBW,gBAAiB/C,EAAMvC,QAAQX,GAC/BkG,kBAAmBhD,EAAMvC,QAAQX,GACjCgF,gBAAiB9B,EAAMC,OAAOlG,KAC9BuI,kBAAmB,EACnBC,kBAAmBvC,EAAMC,OAAO9F,OAChCkM,UAAW,IAEbg4B,mBAAoB,CAClBv8B,gBAAiB9B,EAAMC,OAAOxG,aAAe,MAE/C6kC,mBAAoB,CAClBvnB,QAAS,IAEXwnB,cAAe,CACb18B,KAAM,GAER28B,YAAa,CACXh8B,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC6G,WAAY1D,EAAM7D,WAAWC,aAAaG,SAC1CmG,MAAO1C,EAAMC,OAAOjG,MAEtBykC,oBAAqB,CACnB/7B,MAAO1C,EAAMC,OAAOzG,SAEtBklC,oBAAqB,CACnBh8B,MAAO1C,EAAMC,OAAOxF,UAEtBkkC,eAAgB,CACdn8B,SAAUxC,EAAM7D,WAAWO,UAAUE,GACrC8G,WAAY1D,EAAM7D,WAAWC,aAAaC,QAC1CqG,MAAO1C,EAAMC,OAAOhG,cACpBsJ,UAAWvD,EAAMvC,QAAQd,IAE3BiiC,uBAAwB,CACtBl8B,MAAO1C,EAAMC,OAAOxF,WAErB,EAEH,SA5O0D,SAAHrT,GAWhD,IAVL2D,EAAK3D,EAAL2D,MACA0d,EAAQrhB,EAARqhB,SACA0zB,EAAQ/0C,EAAR+0C,SACA0C,EAAOz3C,EAAPy3C,QACAC,EAAa13C,EAAb03C,cACAjC,EAAaz1C,EAAby1C,cAAa71B,EAAA5f,EACbqT,SAAAA,OAAQ,IAAAuM,GAAQA,EAChBpB,EAAKxe,EAALwe,MACAyR,EAAMjwB,EAANiwB,OAAM0nB,EAAA33C,EACNkkB,YAAAA,OAAW,IAAAyzB,EAAG,mBAAkBA,EAExB/+B,EAAUG,KAAVH,MACF0B,EAASyE,GAAUnG,GACzBzJ,GAA4CC,EAAAA,EAAAA,WAAS,GAAMC,GAAAC,EAAAA,EAAAA,SAAAH,EAAA,GAApDyoC,EAAcvoC,EAAA,GAAEwoC,EAAiBxoC,EAAA,GAElCyoC,EAAiBL,EAAQM,MAAK,SAAAC,GAAM,OAAIA,EAAOt9C,QAAUg9C,CAAa,IACtEO,GAA4B,MAAdH,OAAc,EAAdA,EAAgBI,QAASh0B,EAavC+wB,GACJnjC,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAO87B,eAAelnC,UACjC4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CACHL,MAAO,CACLlE,EAAO+7B,aACPhjC,GAAYiH,EAAOg8B,sBAClBwB,GAAkBx9B,EAAOi8B,iBAC1BrnC,SAED+oC,MAmDP,OACE35B,EAAAA,EAAAA,MAAA+oB,EAAAA,SAAA,CAAAn4B,SAAA,EACE4C,EAAAA,EAAAA,KAACqkC,GAAW,CACVxyC,MAAOA,EACP0d,SAAUA,EACV0zB,SAAUA,EACVE,aAAcA,EACdt2B,QAzEc,WACbtL,GACHwkC,GAAkB,EAEtB,EAsEMxkC,SAAUA,EACVmL,MAAOA,EACP22B,aAAa,EACbllB,OAAQA,KAGVne,EAAAA,EAAAA,KAACoM,GAAAA,QAAK,CACJd,QAASw6B,EACTz5B,cAAc,QACdg6B,kBAAkB,YAClB95B,eAAgB,WAAF,OAAQw5B,GAAkB,EAAM,EAAC3oC,UAE/CoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOm8B,eAAevnC,SAAA,EAEjCoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOo8B,YAAYxnC,SAAA,EAC9B4C,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAOq8B,cAEpB7kC,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOs8B,WAAW1nC,SAAEvL,KAEjCmO,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CACfF,MAAOlE,EAAOu8B,aACdl4B,QAAS,WAAF,OAAQk5B,GAAkB,EAAM,EACvCtC,mBAAmB,QACnBD,kBAAkB,SAAQpmC,UAE1B4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOw8B,eAAe5nC,SAAC,eAKxC4C,EAAAA,EAAAA,KAACggC,GAAAA,QAAQ,CACPp1C,KAAM+6C,EACNxF,aAAc,SAACD,GAAI,OAAKA,EAAKt3C,KAAK,EAClCq3C,WAvFW,SAAHnxC,GAAA,IAAMoxC,EAAIpxC,EAAJoxC,KAAI,OAC1B1zB,EAAAA,EAAAA,MAACI,GAAAA,QAAgB,CACfF,MAAO,CACLlE,EAAO08B,WACPhF,EAAKt3C,QAAUg9C,GAAiBp9B,EAAO28B,mBACvCjF,EAAK3+B,UAAYiH,EAAO48B,oBAE1Bv4B,QAAS,WAAF,OAhCiBjkB,EAgCUs3C,EAAKt3C,MA/BzC+6C,EAAc/6C,QACdm9C,GAAkB,GAFO,IAACn9C,CAgCqB,EAC7C2Y,SAAU2+B,EAAK3+B,SACfiiC,kBAAkB,SAClBC,mBAAoBvD,EAAKkG,MACzBjC,mBAAoB,CAAEmC,SAAUpG,EAAKt3C,QAAUg9C,GAAgBxoC,SAAA,EAE/DoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAO68B,cAAcjoC,SAAA,EAChC4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CACHL,MAAO,CACLlE,EAAO88B,YACPpF,EAAKt3C,QAAUg9C,GAAiBp9B,EAAO+8B,oBACvCrF,EAAK3+B,UAAYiH,EAAOg9B,qBACxBpoC,SAED8iC,EAAKkG,QAGPlG,EAAK3wB,WACJvP,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CACHL,MAAO,CACLlE,EAAOi9B,eACPvF,EAAK3+B,UAAYiH,EAAOk9B,wBACxBtoC,SAED8iC,EAAK3wB,cAKX2wB,EAAKt3C,QAAUg9C,IACd5lC,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CACP/U,KAAK,mBACLvO,KAAM,GACNggB,MAAO1C,EAAMC,OAAOzG,YAGP,EA6CXoM,MAAOlE,EAAOy8B,YACd78B,8BAA8B,EAC9Bm+B,SAAS,WAMrB,E,ulBCvJA,IAiDMt5B,GAAY,SAACnG,GAAe,OAChC2B,EAAAA,QAAWxb,OAAO,CAChByb,UAAShY,GAAA,CACP4f,eAAgBxJ,EAAMvC,QAAQb,GAC9BqG,iBAAkBjD,EAAMvC,QAAQZ,GAChCiF,gBAAiB9B,EAAMC,OAAOlG,KAC9B4D,aAAcqC,EAAMrC,aAAab,GACjC+Z,SAAU,UACP7W,EAAMnC,QAAQjB,IAEnBqF,OAAQ,CACNC,cAAe,MACfC,WAAY,SACZY,gBAAiB/C,EAAMvC,QAAQb,GAC/BoG,kBAAmBhD,EAAMvC,QAAQZ,GACjCiF,gBAAiB9B,EAAMC,OAAOlG,KAC9BuI,kBAAmB,EACnBC,kBAAmBvC,EAAMC,OAAO9F,QAElCulC,gBAAiB,CACfx9B,cAAe,MACfC,WAAY,SACZN,KAAM,GAER89B,WAAY,CACVx2B,YAAanJ,EAAMvC,QAAQZ,IAE7B+iC,eAAgB,CACd/9B,KAAM,GAER9W,MAAO,CACLyX,SAAUxC,EAAM7D,WAAWO,UAAUI,GACrC4G,WAAY1D,EAAM7D,WAAWC,aAAaI,KAC1CkG,MAAO1C,EAAMC,OAAOjG,MAEtB6lC,aAAc,CACZn5B,WAAY1G,EAAMvC,QAAQZ,IAE5B4L,SAAU,CACRjG,SAAUxC,EAAM7D,WAAWO,UAAUE,GACrC8F,MAAO1C,EAAMC,OAAOhG,cACpByM,WAAY1G,EAAMvC,QAAQb,GAC1ByF,QAASrC,EAAMvC,QAAQd,IAEzBmjC,kBAAmB,CACjB98B,kBAAmBhD,EAAMvC,QAAQZ,GACjCoE,cAAejB,EAAMvC,QAAQZ,IAE/Bg/B,cAAe,CACb79B,MAAO,GACPC,OAAQ,GACRN,aAAcqC,EAAMrC,aAAad,GACjCiF,gBAAiB9B,EAAMC,OAAOxG,aAAe,KAC7C2I,eAAgB,SAChBD,WAAY,SACZgH,YAAanJ,EAAMvC,QAAQZ,IAE7B7R,QAAS,CACPgY,kBAAmBhD,EAAMvC,QAAQZ,GACjCoE,cAAejB,EAAMvC,QAAQb,GAC7BkF,gBAAiB9B,EAAMC,OAAOlG,OAE/B,EAEL,SAjHwD,SAAH3S,GAQ9C,IAPL2D,EAAK3D,EAAL2D,MACA0d,EAAQrhB,EAARqhB,SACAuO,EAAI5vB,EAAJ4vB,KACA1gB,EAAQlP,EAARkP,SACmBypC,GADX34C,EACR44C,YAAmB54C,EACnB64C,mBAAAA,OAAiB,IAAAF,GAAOA,EACxBF,EAAYz4C,EAAZy4C,aAEQ7/B,EAAUG,KAAVH,MACF0B,EAASyE,GAAUnG,GACzBzJ,GAAoCC,EAAAA,EAAAA,UAASypC,GAAkBxpC,GAAAC,EAAAA,EAAAA,SAAAH,EAAA,GAA9CE,EAAA,GAAeA,EAAA,GAiBhC,OACEiP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOE,UAAUtL,SAAA,EAC5BoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOO,OAAO3L,SAAA,CACxB0gB,IACC9d,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAM+lB,EAAMt0B,KAAM,GAAIggB,MAAO1C,EAAMC,OAAOhG,cAAe2L,MAAOlE,EAAOi+B,cAEnFj6B,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOk+B,eAAetpC,SAAA,EACjC4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO3W,MAAMuL,SAAEvL,IAC3B0d,IAAYvP,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO+G,SAASnS,SAAEmS,OAE7Co3B,IACC3mC,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAOm+B,aAAavpC,SAC9BupC,QAIP3mC,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAOo+B,kBAAkBxpC,SAAEA,MAG9C,E,+kBCzBA,IAoUM6P,GAAY,SAACnG,GAAe,OAAK2B,EAAAA,QAAWxb,OAAO,CACvDyb,UAAW,CACTC,KAAM,EACNC,gBAAiB9B,EAAMC,OAAOpG,YAEhCqO,cAAe,CACbjH,cAAe,KAEjBi/B,cAAe,CACb99B,eAAgB,SAChBD,WAAY,UAEdmB,YAAa,CACXC,UAAWvD,EAAMvC,QAAQZ,GACzB2F,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC6F,MAAO1C,EAAMC,OAAOhG,cACpByJ,WAAY1D,EAAM7D,WAAWC,aAAaC,SAE5C4F,OAAQ,CACNC,cAAe,MACfC,WAAY,SACZC,eAAgB,gBAChBY,kBAAmBhD,EAAMvC,QAAQX,GACjCiF,WAAY/B,EAAMvC,QAAQV,GAC1BkE,cAAejB,EAAMvC,QAAQX,GAC7BwF,kBAAmB,EACnBC,kBAAmBvC,EAAMC,OAAO9F,QAElC+R,WAAUtiB,GAAA,CACRoU,MAAO,GACPC,OAAQ,GACRN,aAAc,GACdmE,gBAAiB9B,EAAMC,OAAOlG,KAC9BqI,eAAgB,SAChBD,WAAY,UACTnC,EAAMnC,QAAQjB,IAEnBujC,YAAa,CACX39B,SAAUxC,EAAM7D,WAAWO,UAAUK,GACrC0F,WAAY,OACZC,MAAO1C,EAAMC,OAAOjG,KACpB0J,WAAY1D,EAAM7D,WAAWC,aAAaI,MAE5C4jC,aAAc,CACZpiC,MAAO,IAETqiC,aAAc,CACZriC,MAAO,GACPC,OAAQ,GACRN,aAAc,GACdmE,gBAAiB9B,EAAMC,OAAOzG,QAC9B4I,eAAgB,SAChBD,WAAY,UAEdm+B,iBAAkB,CAChB99B,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC4F,WAAY,OACZC,MAAO1C,EAAMC,OAAOpG,WACpB6J,WAAY1D,EAAM7D,WAAWC,aAAaI,MAE5C+jC,WAAY,CACV/9B,SAAUxC,EAAM7D,WAAWO,UAAUE,GACrC8G,WAAY1D,EAAM7D,WAAWC,aAAaE,QAE5CkkC,SAAU,CACRh+B,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC6F,MAAO1C,EAAMC,OAAOhG,cACpByJ,WAAY1D,EAAM7D,WAAWC,aAAaC,SAE5CokC,YAAa,CACXj+B,SAAUxC,EAAM7D,WAAWO,UAAUE,GACrC8F,MAAO1C,EAAMC,OAAOhG,cACpByJ,WAAY1D,EAAM7D,WAAWC,aAAaC,SAE5CqkC,cAAe,CACbziC,OAAQ+B,EAAMvC,QAAQR,MAExB2uB,kBAAmB,CACjBjV,SAAU,WACV+K,OAAQ,GACRE,MAAO,GACPiK,OAAQ,KAEV8U,uBAAsB/2C,GAAA,CACpBoU,MAAO,GACPC,OAAQ,GACRN,aAAc,GACdmE,gBAAiB9B,EAAMC,OAAOzG,QAC9B4I,eAAgB,SAChBD,WAAY,UACTnC,EAAMnC,QAAQf,KAElB,EAEH,SAlaiC,WAAO,IAAD8jC,EAC/Bx2B,GAAaC,EAAAA,GAAAA,iBACnBpD,EAAyB7N,KAAjB/G,EAAI4U,EAAJ5U,KAAMlJ,EAAM8d,EAAN9d,OACd03C,EAAiE1gC,KAAzDH,EAAK6gC,EAAL7gC,MAAOH,EAAWghC,EAAXhhC,YAAaK,EAAa2gC,EAAb3gC,cAAeH,EAAiB8gC,EAAjB9gC,kBAC3C+gC,EAA+CrF,KAAvClqB,EAAQuvB,EAARvvB,SAAU0pB,EAAa6F,EAAb7F,cAAelkC,EAAS+pC,EAAT/pC,UAC3B2K,EAASyE,GAAUnG,GACzBzJ,GAAwCC,EAAAA,EAAAA,WAAS,GAAMC,GAAAC,EAAAA,EAAAA,SAAAH,EAAA,GAAhD01B,EAAYx1B,EAAA,GAAEy1B,EAAez1B,EAAA,GAG9Bg2B,EAAgBtF,EAAAA,OAAkB,MACxCtwB,GAA8CL,EAAAA,EAAAA,WAAS,GAAMM,GAAAJ,EAAAA,EAAAA,SAAAG,EAAA,GAAtD+2B,EAAe92B,EAAA,GAAE+2B,EAAkB/2B,EAAA,GACpCiqC,EAAqB5Z,EAAAA,OAAa,IAAI3P,GAAAA,QAASC,MAAM,IAAIC,QAqB/D,GAAI3gB,EACF,OACEmC,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAOE,UAAUtL,UAC5B4C,EAAAA,EAAAA,KAACqxB,GAAgB,MAMvB,IAAMyW,EAAoC7wB,GAAoBsM,KAAI,SAAAjM,GAAI,MAAK,CACzE1uB,MAAO0uB,EAAKjsB,KACZ+6C,MAAO9uB,EAAKvf,KACZwX,SAAU+H,EAAKJ,OAAM,GAAMI,EAAKJ,YAAWxrB,EAC5C,IAEKq8C,EAAa,eAAA75C,GAAApF,EAAAA,EAAAA,UAAG,YAIpB,GAFkB0D,OAAOw7C,QAAQ,sCAG/B,IACExgD,EAAOqE,KAAK,kDACNoE,IACNzI,EAAOqE,KAAK,gDACd,CAAE,MAAOpC,GACPjC,EAAOiC,MAAM,0CAA2CA,GACxD+C,OAAOwiC,MAAM,wCACf,CAEJ,IAAC,kBAdkB,OAAA9gC,EAAAxE,MAAA,KAAAC,UAAA,KAiBbomC,EAAY9B,EAAAA,aAAkB,WAClC+E,GAAgB,GAEhB9L,YAAW,WACT8L,GAAgB,EAClB,GAAG,IACL,GAAG,IAEH,OACExmB,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOE,UAAUtL,SAAA,EAC5B4C,EAAAA,EAAAA,KAAC4vB,GAAY,CAAC/9B,MAAM,cACpB2a,EAAAA,EAAAA,MAACtF,GAAc,CACbE,IAAKmsB,EACL7mB,MAAOlE,EAAOE,UACdnB,sBAAuBiB,EAAOwG,cAC9B5G,8BAA8B,EAC9BktB,SAnEe,SAACT,GACpB,IACMoT,EADUpT,EAAME,YAAYD,cAAcX,EACnB,IAEzB8T,IAAevT,IACjBC,EAAmBsT,GACnB3pB,GAAAA,QAASQ,OAAO+oB,EAAoB,CAClC9oB,QAASkpB,EAAa,EAAI,EAC1B7iC,SAAU,IACViY,iBAAiB,IAChB2B,QAEP,EAwDM1W,oBAAqB,GACrBunB,gBACE7vB,EAAAA,EAAAA,KAAC8vB,GAAAA,QAAc,CACbpC,WAAYqF,EACZhD,UAAWA,EACXhpB,OAAQ,CAACD,EAAMC,OAAOzG,SACtB0vB,UAAWlpB,EAAMC,OAAOzG,UAE3BlD,SAAA,EAGHoP,EAAAA,EAAAA,MAAC07B,GAAe,CACdr2C,MAAM,UACNisB,KAAK,SAAQ1gB,SAAA,EAEb4C,EAAAA,EAAAA,KAACqkC,GAAW,CACVxyC,MAAM,UACN0d,UAAc,MAAJpW,OAAI,EAAJA,EAAMnB,QAAS,qBACzBirC,SAAS,OACTE,cACEnjC,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAO2+B,aAAa/pC,UAC/B4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO4+B,iBAAiBhqC,UAC9B,MAAJjE,GAAW,OAAPuuC,EAAJvuC,EAAMnB,YAAF,EAAJ0vC,EAAaS,OAAO,GAAGp9C,gBAAiB,WAMjDiV,EAAAA,EAAAA,KAACqkC,GAAW,CACVxyC,MAAM,WACN0d,SAAS,2BACT0zB,SAAS,UACTp2B,QAASk7B,EACT1E,aAAa,QAKjBrjC,EAAAA,EAAAA,KAACkoC,GAAe,CACdr2C,MAAM,2BACNisB,KAAK,WAAU1gB,UAEf4C,EAAAA,EAAAA,KAACooC,GAAgB,CACfv2C,MAAM,mBACN0d,SAAS,mCACT0zB,SAAS,QACT0C,QAASmC,EACTlC,cAAevtB,EAASb,gBACxBmsB,cAAe,SAAC/6C,GAAK,OAAKm5C,EAAc,kBAAmBn5C,EAAM,OAKrE4jB,EAAAA,EAAAA,MAAC07B,GAAe,CACdr2C,MAAM,qBACNisB,KAAK,mBAAkB1gB,SAAA,EAEvB4C,EAAAA,EAAAA,KAACqkC,GAAW,CACVxyC,MAAM,OACN0d,SAAS,kCACT0zB,SAAS,WACTp2B,QAAS,WAAF,OAAQqE,EAAW0B,SAAS,gBAAgB,EACnDywB,aAAa,KAGfrjC,EAAAA,EAAAA,KAACqoC,GAAc,CACbx2C,MAAM,YACN0d,SAAS,uBACT0zB,SAAS,YACTr6C,MAAOyvB,EAASN,iBAChB4rB,cAAe,SAAC/6C,GAAK,OAAKm5C,EAAc,mBAAoBn5C,EAAM,KAGpEoX,EAAAA,EAAAA,KAACqoC,GAAc,CACbx2C,MAAM,gBACN0d,SAAS,mCACT0zB,SAAS,MACTr6C,MAAOyvB,EAASL,oBAChB2rB,cAAe,SAAC/6C,GAAK,OAAKm5C,EAAc,sBAAuBn5C,EAAM,QAKzE4jB,EAAAA,EAAAA,MAAC07B,GAAe,CACdr2C,MAAM,eACNisB,KAAK,WAAU1gB,SAAA,EAEf4C,EAAAA,EAAAA,KAACqoC,GAAc,CACbx2C,MAAM,YACN0d,SAAUvI,EAAgB,2BAA6B,kBACvDi8B,SAAS,OACTr6C,MAAOke,EAAMb,WACb09B,cAAe,WACT38B,GAAeH,GAAkB,GACrCF,GACF,EACApF,SAAUyF,KAGZhH,EAAAA,EAAAA,KAACqoC,GAAc,CACbx2C,MAAM,mBACN0d,SAAS,8BACT0zB,SAAS,iBACTr6C,MAAOoe,EACP28B,cAAe98B,KAGjB7G,EAAAA,EAAAA,KAACqoC,GAAc,CACbx2C,MAAM,kBACN0d,SAAS,4CACT0zB,SAAS,gBACTr6C,MAAOyvB,EAASV,sBAChBgsB,cAAe,SAAC/6C,GAAK,OACnBm5C,EAAc,wBAAyBn5C,EAAM,KAIjDoX,EAAAA,EAAAA,KAACqoC,GAAc,CACbx2C,MAAM,kBACN0d,SAAS,sCACT0zB,SAAS,eACTr6C,MAAOyvB,EAASJ,gBAChB0rB,cAAe,SAAC/6C,GAAK,OACnBm5C,EAAc,kBAAmBn5C,EAAM,KAI3CoX,EAAAA,EAAAA,KAACqoC,GAAc,CACbx2C,MAAM,uBACN0d,SAAS,2DACT0zB,SAAS,cACTr6C,MAAOyvB,EAASH,qBAChByrB,cAAe,SAAC/6C,GAAK,OACnBm5C,EAAc,uBAAwBn5C,EAAM,QAMlD4jB,EAAAA,EAAAA,MAAC07B,GAAe,CACdr2C,MAAM,gBACNisB,KAAK,gBAAe1gB,SAAA,EAEpB4C,EAAAA,EAAAA,KAACqoC,GAAc,CACbx2C,MAAM,qBACN0d,SAAS,4BACT0zB,SAAS,gBACTr6C,MAAOyvB,EAAST,qBAChB+rB,cAAe,SAAC/6C,GAAK,OAAKm5C,EAAc,uBAAwBn5C,EAAM,KAGxEoX,EAAAA,EAAAA,KAACqoC,GAAc,CACbx2C,MAAM,kBACN0d,SAAS,oCACT0zB,SAAS,OACTr6C,MAAOyvB,EAASR,sBAChB8rB,cAAe,SAAC/6C,GAAK,OAAKm5C,EAAc,wBAAyBn5C,EAAM,IAGxEyvB,EAASR,wBACR7X,EAAAA,EAAAA,KAACqkC,GAAW,CACVxyC,MAAM,gBACN0d,SAAQ,qBAAuB8I,EAASP,kBACxCmrB,SAAS,QACTE,cACEnjC,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO8+B,SAASlqC,SAAEib,EAASP,oBAE1CjL,QAAS,WAEPkiB,GAAAA,QAAMC,MAAM,cAAe,oDAC7B,EACAqU,aAAa,QAMnB72B,EAAAA,EAAAA,MAAC07B,GAAe,CACdr2C,MAAM,QACNisB,KAAK,qBAAoB1gB,SAAA,EAEzB4C,EAAAA,EAAAA,KAACqkC,GAAW,CACVxyC,MAAM,UACN0d,SAAS,sBACT0zB,SAAS,eACTE,cACEnjC,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO++B,YAAYnqC,SAAC,aAIrC4C,EAAAA,EAAAA,KAACqkC,GAAW,CACVxyC,MAAM,iBACN0d,SAAS,0BACT0zB,SAAS,gBACTp2B,QAAS,WACPkiB,GAAAA,QAAMC,MAAM,iBAAkB,yCAChC,EACAqU,aAAa,KAGfrjC,EAAAA,EAAAA,KAACqkC,GAAW,CACVxyC,MAAM,mBACN0d,SAAS,4BACT0zB,SAAS,WACTp2B,QAAS,WACPkiB,GAAAA,QAAMC,MAAM,mBAAoB,2CAClC,EACAqU,aAAa,QAKjBrjC,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAOg/B,oBAItBxnC,EAAAA,EAAAA,KAACse,GAAAA,QAAS3R,KAAI,CACZD,MAAO,CACLlE,EAAOkqB,kBACP,CACE7U,QAASgqB,EACTvoB,UAAW,CAAC,CACVC,MAAOsoB,EAAmB1oB,YAAY,CACpCC,WAAY,CAAC,EAAG,GAChBC,YAAa,CAAC,GAAK,SAK3BipB,cAAe5T,EAAkB,OAAS,OAAOt3B,UAEjD4C,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CACfF,MAAOlE,EAAOi/B,uBACd56B,QA/Rc,WAAO,IAADonB,EACH,OAArBA,EAAAV,EAAc/U,UAAdyV,EAAuBC,SAAS,CAAEC,EAAG,EAAG3D,UAAU,GACpD,EA8RMxQ,cAAe,GAAI5iB,UAEnB4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,aAAavO,KAAM,GAAIggB,MAAO1C,EAAMC,OAAOpG,mBAKlE,E,+kBC5VA,IAAM4nC,IAAMC,EAAAA,GAAAA,WA4FNC,GAAqB,SAAC3hC,GAAe,OAAK2B,EAAAA,QAAWxb,OAAO,CAChEyb,UAAW,CACTC,KAAM,GAER+/B,YAAWh4C,GAAAA,GAAA,CACTkY,gBAAiB9B,EAAMC,OAAOlG,KAC9BsK,eAAgBrE,EAAMC,OAAO7F,YAC7BgK,eAAgB,EAChBnG,OAAwB,QAAhBhd,EAAAA,QAASC,GAAe,GAAK,GACrC+f,cAA+B,QAAhBhgB,EAAAA,QAASC,GAAe,GAAK,EAC5C6gB,WAAY,EACZiB,kBAAmBhD,EAAMvC,QAAQb,IAC9BoD,EAAMnC,QAAQf,IAAE,IAEnBmG,iBAAkBjD,EAAMvC,QAAQZ,GAChCmH,aAA8B,QAAhB/iB,EAAAA,QAASC,GAAe8e,EAAMvC,QAAQX,GAAKkD,EAAMvC,QAAQZ,GACvEc,aAAcqC,EAAMrC,aAAaZ,GACjC4Z,SAAU,WACVgL,KAAM,EACNC,MAAO,EACPF,OAAQ,IAEVmgB,iBAAkB,CAChBr/B,SAAUxC,EAAM7D,WAAWO,UAAUC,GACrC+G,WAAY1D,EAAM7D,WAAWC,aAAaE,OAC1C0H,aAA8B,QAAhB/iB,EAAAA,QAASC,GAAe,EAAI8e,EAAMvC,QAAQd,GACxD4G,UAAWvD,EAAMvC,QAAQd,IAE3BmlC,gBAAiB,CACf/+B,gBAAiB/C,EAAMvC,QAAQd,GAC/BgB,aAAcqC,EAAMrC,aAAad,IAEnCklC,aAAc,CACZprB,SAAU,WACV+K,OAAwB,QAAhBzgC,EAAAA,QAASC,GAAe,IAAM,GACtCgpB,UAAW,SACX2hB,OAAQ,MAET,EAEH,SA5HyB,SAAHzkC,GAA+C,IAAzCgjB,EAAUhjB,EAAVgjB,WAClBpK,EAAUG,KAAVH,MACF0B,EAASigC,GAAmB3hC,IAGlCxI,EAAAA,EAAAA,YAAU,WACR,IAAMwqC,EAAY,eAAAh6C,GAAAhG,EAAAA,EAAAA,UAAG,YACnB,IACEtB,EAAOqE,KAAK,6DACNk9C,GAAoBlyB,qBAE1B,IAAMmyB,EAAUD,GAAoBE,wBACpCzhD,EAAOqE,KAAK,8CAA+Cm9C,EAC7D,CAAE,MAAOv/C,GACPjC,EAAOiC,MAAM,2CAA4CA,EAC3D,CACF,IAAC,kBAViB,OAAAqF,EAAApF,MAAA,KAAAC,UAAA,KAelB,OAHAm/C,IAGO,WACLC,GAAoBG,SACtB,CACF,GAAG,IAEH,IAAMC,GAAoBljB,EAAAA,EAAAA,cAAY,WACpCz+B,EAAOqE,KAAK,iFAGIk9C,GAAoB/xB,wBAElCxvB,EAAOsC,KAAK,uEACZi/C,GAAoBlyB,qBAAqBuyB,OAAM,SAAA3/C,GAC7CjC,EAAOiC,MAAM,qDAAsDA,EACrE,KAIFynB,EAAW0B,SAAS,SACtB,GAAG,CAAC1B,IAEJ,OACE1E,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOE,UAAUtL,SAAA,EAC5BoP,EAAAA,EAAAA,MAAC+7B,GAAI3zB,UAAS,CACZE,cAAe,SAAF3jB,GAAA,IAAKk4C,EAAKl4C,EAALk4C,MAAK,MAAQ,CAC7Bt0B,aAAa,EACbu0B,sBAAuBxiC,EAAMC,OAAO/E,aACpCunC,wBAAyBziC,EAAMC,OAAO9E,eACtCymC,YAAalgC,EAAOkgC,YACpBC,iBAAkBngC,EAAOmgC,iBACzBC,gBAAiBpgC,EAAOogC,gBACxBY,WAAY,SAAFrqC,GAAiC,IACrCsqC,EADSC,EAAOvqC,EAAPuqC,QAASlgC,EAAKrK,EAALqK,MAAOhgB,EAAI2V,EAAJ3V,KAO7B,MALmB,SAAf6/C,EAAMtxC,KAAiB0xC,EAAWC,EAAU,OAAS,eACjC,YAAfL,EAAMtxC,KAAoB0xC,EAAWC,EAAU,OAAS,eACzC,aAAfL,EAAMtxC,KAAqB0xC,EAAWC,EAAU,WAAa,mBAC9C,aAAfL,EAAMtxC,OAAqB0xC,EAAWC,EAAU,MAAQ,eAE5DD,GACEzpC,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAM0xC,EAAUjgD,KAAMkgD,EAAUlgD,EAAO,EAAIA,EAAMggB,MAAOA,KADnDxJ,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAO,CAAC5H,MAAMtb,EAAMub,OAAOvb,IAEzD,EACD,EAAE4T,SAAA,EAEH4C,EAAAA,EAAAA,KAACuoC,GAAIvzB,OAAM,CAACjd,KAAK,OAAOkd,UAAW00B,GAAYhE,QAAS,CAAEiE,YAAa,WACvE5pC,EAAAA,EAAAA,KAACuoC,GAAIvzB,OAAM,CAACjd,KAAK,UAAUkd,UAAW40B,GAAelE,QAAS,CAAEiE,YAAa,cAC7E5pC,EAAAA,EAAAA,KAACuoC,GAAIvzB,OAAM,CAACjd,KAAK,WAAWkd,UAAW60B,GAAgBnE,QAAS,CAAEiE,YAAa,eAC/E5pC,EAAAA,EAAAA,KAACuoC,GAAIvzB,OAAM,CAACjd,KAAK,WAAWkd,UAAW80B,GAAgBpE,QAAS,CAAEiE,YAAa,kBAIjF5pC,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAOqgC,aAAazrC,UAC/B4C,EAAAA,EAAAA,KAACgqC,GAAoB,CACnBn9B,QAASs8B,EACTrrB,KAAK,MACLt0B,KAAM,GACN8zB,QAAQ,UACRa,OAAO,2BAKjB,EC3EO,IAAM8rB,GAA8B,CAEzCC,oBAAoB,EAEpBC,4BAA4B,EAC5BC,2BAA2B,EAC3BC,gCAAgC,EAChCC,6BAA6B,EAG7BC,2BAA2B,EAC3BC,qBAAqB,GAOVC,GAA+C,CAM5D,EAKO,SAASC,GAA6C/hD,GAE3D,YAAmC+C,IAA/B++C,GAAsB9hD,GACjB8hD,GAAsB9hD,GAIxBshD,GAActhD,EACvB,CA8BO,SAASgiD,KACd,OAAOD,GAAe,qBACxB,C,+kBCsZA,SArcyB,WAavB,SAAAE,KAAcjjD,EAAAA,EAAAA,SAAA,KAAAijD,GAAA,KAHGC,WAAa,EAAE,KACfC,WAAa,IAG5BtjD,EAAOqE,KAAK,sEACd,CAAC,OAAApE,EAAAA,EAAAA,SAAAmjD,EAAA,EAAAjiD,IAAA,kBAAAC,MAAA,eAAAmiD,GAAAjiD,EAAAA,EAAAA,UAKD,UACEkiD,GAE+B,IAD/BrF,EAA6Bh8C,UAAAK,OAAA,QAAA0B,IAAA/B,UAAA,GAAAA,UAAA,GAAG,CAAC,EAG/BshD,EAIEtF,EAJFsF,cAAaC,EAIXvF,EAHFwF,gBAAAA,OAAe,IAAAD,EAAG,EAACA,EACQE,GAEzBzF,EAFF0F,qBAEE1F,EADF2F,0BAAAA,OAAwB,IAAAF,GAAOA,EAGjC5jD,EAAOqE,KACL,qDAAqDm/C,EAArD,iBACcC,EAAgBA,EAAc5gD,KAAK,MAAQ,eADzD,uBAEqB8gD,EAFrB,2BAGyBG,GAG3B,IAEML,GAAiBA,EAAcjhD,OAAS,GAC1CnC,KAAK0jD,uBAAuBN,GAI9B,IACE,aAAapjD,KAAK2jD,sBAAsBR,EAAeC,EAAeK,EACxE,CACA,MAAOG,GAAoB,IAADC,EAExB,GAAsC,OAAb,OAArBA,EAAAD,EAAa98C,eAAQ,EAArB+8C,EAAuB78C,QAEzB,OADArH,EAAOqE,KAAK,4DACChE,KAAK8jD,uBAAuBX,EAAeC,EAAeK,GAIzE,MAAMzjD,KAAK+jD,0BAA0BH,EACvC,CACF,CACA,MAAOhiD,GAQL,MANAjC,EAAOiC,MAAM,sDAAuD,CAClEW,QAASX,EAAMW,QACfixB,KAAM5xB,EAAM4xB,MAAQ,UACpB4vB,cAAAA,EACAY,UAAWb,IAEPvhD,CACR,CACF,IAjD4B,OAiD3B,SAjD2B6B,GAAA,OAAAy/C,EAAArhD,MAAC,KAADC,UAAA,EAL3B,IAK2B,CAAAhB,IAAA,yBAAAC,MAsD5B,SAA+BqiD,GAC7B,GAAIA,EAAcjhD,OAAS,EACzB,MAAMnC,KAAK+jD,0BAA0B,CACnCvwB,KAAM,aACNjxB,QAAQ,mDAAoD6gD,EAAcjhD,SAK9E,IAAM8hD,EAAeb,EAAcrxC,QAAO,SAAAvO,GACxC,MAAgB,SAATA,IAAoB8rB,GAAqB9rB,EAClD,IAEA,GAAIygD,EAAa9hD,OAAS,EACxB,MAAMnC,KAAK+jD,0BAA0B,CACnCvwB,KAAM,aACNjxB,QAAQ,2BAA4B0hD,EAAazhD,KAAK,MAAK,0CAGjE,GAAC,CAAA1B,IAAA,wBAAAC,MAAA,eAAAmjD,GAAAjjD,EAAAA,EAAAA,UAKD,UACEkiD,EACAC,GAE+B,IAADe,EAD9BV,IAAiC3hD,UAAAK,OAAA,QAAA0B,IAAA/B,UAAA,KAAAA,UAAA,GAG3BsiD,QAAiBpkD,KAAKqkD,gBAAgBlB,GAGxCC,GAAiBA,EAAcjhD,OAAS,IAC1CiiD,EAASE,OAAO,sBAAuBnhD,KAAKC,UAAUggD,IACtDzjD,EAAOqE,KAAK,oCAAoCb,KAAKC,UAAUggD,KAIjE,IAAM58C,QAAcC,EAAAA,QAAaC,QAAQ,gBACzC,IAAKF,EACH,MAAMxG,KAAK+jD,0BAA0B,CACnCvwB,KAAM,iBACNjxB,QAAS,mCAIb5C,EAAOqE,KAAK,oEAEZ,IAAM8C,QAAiBy9C,EAAcj8C,KACnC,yBACA87C,EACA,CACE9+C,QAAS,CACP,cAAgB,UAAWkB,GAE7BjB,QAAS,MAYb,OARA5F,EAAOqE,KACL,sEAC8C,OAAxBmgD,EAAAr9C,EAAS/D,KAAKyhD,iBAAU,EAAxBL,EAA0BhiD,SAAU,UAI9BnC,KAAKykD,8BAA8B39C,EAAS/D,KAAM0gD,EAGlF,IA7CmC,OA6ClC,SA7CkC//C,EAAAC,GAAA,OAAAugD,EAAAriD,MAAC,KAADC,UAAA,EALlC,IAKkC,CAAAhB,IAAA,kBAAAC,MAAA,eAAA2jD,GAAAzjD,EAAAA,EAAAA,UAkDnC,UAA8BkiD,GAC5B,IAAMiB,EAAW,IAAIv9C,SAErB,GAAoB,QAAhB3G,EAAAA,QAASC,GAAc,CACzBR,EAAOqE,KAAK,gDACZ,IAAM8C,QAAiB69C,MAAMxB,GACvByB,QAAa99C,EAAS89C,OACtBC,EAAQ,aAAgBliD,KAAKorB,MAAK,QAClC+2B,EAAW,yBAEjBV,EAASE,OAAO,OAAQ,IAAIS,KAAK,CAACH,GAAOC,EAAU,CACjDrxB,KAAMsxB,KAGRnlD,EAAOqE,KAAK,8BAA8B6gD,EAAQ,WAAWC,EAAQ,WAAWF,EAAKjjD,KACvF,KAAO,CAAC,IAADqjD,EAECC,QAAiB5kD,EAAWgB,aAAa8hD,GAC/C,IAAK8B,EAAS3jD,OACZ,MAAMtB,KAAK+jD,0BAA0B,CACnCvwB,KAAM,aACNjxB,QAAQ,yBAA0B4gD,IAItC,IAAM+B,EAAMD,EAASC,IACfC,EAAoC,OAAvBH,EAAGE,EAAI/gC,MAAM,KAAKihC,YAAK,EAApBJ,EAAsBvY,cACtC4Y,EAAWrlD,KAAKslD,kBAAkBH,GAClCN,EAAWK,EAAI/gC,MAAM,KAAKihC,OAAK,aAAiBziD,KAAKorB,MAAK,IAAIo3B,EAGnEf,EAAiBE,OAAO,OAAQ,CAC/BY,IAAAA,EACAh1C,KAAM20C,EACNrxB,KAAM6xB,IAGR1lD,EAAOqE,KAAK,qCAAqC6gD,EAAQ,WAAWQ,EACtE,CAEA,OAAOjB,CACT,IAzC6B,OAyC5B,SAzC4Bx3C,GAAA,OAAA83C,EAAA7iD,MAAC,KAADC,UAAA,EAlDM,IAkDN,CAAAhB,IAAA,oBAAAC,MA8C7B,SAA0BwkD,GAYxB,MAX6C,CAC3C,IAAO,YACP,IAAO,aACP,IAAO,YACP,IAAO,YACP,IAAO,YACP,IAAO,YACP,KAAQ,aACR,KAAQ,cAGOA,GAAa,QAAU,WAC1C,GAAC,CAAAzkD,IAAA,gCAAAC,MAAA,eAAAykD,GAAAvkD,EAAAA,EAAAA,UAKD,UAA4C8B,EAAW0gD,GAAkE,IAADgC,EAAAC,EAAAC,EAAAC,EAEhHC,EAAuC,CAC3CrB,WAAYzhD,EAAKyhD,YAAc,GAC/BsB,uBAAwB/iD,EAAK+iD,6BAA0BjiD,EACvDkiD,WAAuC,kBAApBhjD,EAAKgjD,WAA0BhjD,EAAKgjD,WAAa,GACpEC,aAAc3jD,MAAM8G,QAAQpG,EAAKijD,cAAgBjjD,EAAKijD,aAAe,GACrEC,gBAAiB5jD,MAAM8G,QAAQpG,EAAKkjD,iBAAmBljD,EAAKkjD,gBAAkB,GAC9EC,oBAAyD,kBAA7BnjD,EAAKmjD,oBAAmCnjD,EAAKmjD,oBAAsB,GAC/FC,gBAAet9C,GAAA,CACbu9C,oBAAwC,OAApBX,EAAA1iD,EAAKojD,sBAAe,EAApBV,EAAsBW,qBAAsB,GAChEC,sBAA0C,OAApBX,EAAA3iD,EAAKojD,sBAAe,EAApBT,EAAsBW,uBAAwB,EACpEC,aAAiC,OAApBX,EAAA5iD,EAAKojD,sBAAe,EAApBR,EAAsBW,cAAe,GAC/CvjD,EAAKojD,kBAKZ,GAAIrD,MAA0BW,GAA4BoC,EAAgBrB,WAAW79B,OACnF,IACEhnB,EAAOqE,KAAK,gEAAgE6hD,EAAgBrB,WAAU,KAGtG,IAAM+B,QAAqB9U,GAAoB+U,qBAAqBX,EAAgBrB,YACpFqB,EAAgBY,oBAAsBF,EAEtC5mD,EAAOqE,KAAK,6CAA8CuiD,GAEtDA,EAAapU,OACfxyC,EAAOqE,KAAK,uCAAuCuiD,EAAal6C,QAAO,KAAKk6C,EAAa/T,OAAM,WAGzFxyC,KAAK0mD,0BAA0BH,IAErC5mD,EAAOqE,KAAK,iEAAiE6hD,EAAgBrB,WAAU,IAE3G,CAAE,MAAO5iD,GACPjC,EAAOiC,MAAM,uCAAwCA,GAErDikD,EAAgBY,oBAAsB,CAAEtU,OAAO,EACjD,KACK,CACL0T,EAAgBY,oBAAsB,CAAEtU,OAAO,GAC/C,IAAMwU,EAAU7D,KAEX+C,EAAgBrB,WAAW79B,OAAS,+BAAiC,6BADtE,kCAEJhnB,EAAOqE,KAAK,4BAA4B2iD,EAC1C,CAWA,OARAhnD,EAAOqE,KACL,mDACmB6hD,EAAgBM,gBAAgBC,mBAAmBQ,QAAQ,GAD9E,2BAEyBf,EAAgBM,gBAAgBE,qBAAoB,IAAIR,EAAgBM,gBAAgBG,YAFjH,0BAGwBT,EAAgBK,oBAAoBU,QAAQ,GAHpE,4BAI2D,OAAnChB,EAAAC,EAAgBY,0BAAmB,EAAnCb,EAAqCzT,SAAS,IAGjE0T,CACT,IA3D2C,OA2D1C,SA3D0Ch5C,EAAAG,GAAA,OAAAw4C,EAAA3jD,MAAC,KAADC,UAAA,EAL1C,IAK0C,CAAAhB,IAAA,4BAAAC,MAAA,eAAA8lD,GAAA5lD,EAAAA,EAAAA,UAgE3C,UAAwC6lD,GACtC,IACE,GAAyB,UAArBA,EAAUtU,OAIZ,YAFA7yC,EAAOsC,KAAK,iDAKV6kD,EAAUrW,QACa,aAArBqW,EAAUtU,OACZ7yC,EAAOqE,KAAK,wCAAwC8iD,EAAUz6C,SAEhC,eAArBy6C,EAAUtU,QACnB7yC,EAAOqE,KAAK,0CAA0C8iD,EAAUz6C,SAItE,CAAE,MAAOzK,GACPjC,EAAOiC,MAAM,yCAA0CA,EAEzD,CACF,IAtBuC,OAsBtC,SAtBsCmO,GAAA,OAAA82C,EAAAhlD,MAAC,KAADC,UAAA,EAhEI,IAgEJ,CAAAhB,IAAA,yBAAAC,MAAA,eAAAgmD,GAAA9lD,EAAAA,EAAAA,UA6BvC,UACEkiD,EACAC,GAE+B,IAD/BK,IAAiC3hD,UAAAK,OAAA,QAAA0B,IAAA/B,UAAA,KAAAA,UAAA,GAEjC,IAEE,IAAMoG,QAAqBzB,EAAAA,QAAaC,QAAQ,iBAChD,IAAKwB,EACH,MAAMlI,KAAK+jD,0BAA0B,CACnCvwB,KAAM,iBACNjxB,QAAS,yCAIb5C,EAAOqE,KAAK,yCAGZ,IAAMgjD,QAAwB7hD,EAAAA,QAAMmD,KAAK,uBAAwB,CAC/DC,cAAeL,IAGjB,GAAI8+C,EAAgBjkD,KAAKyF,aAWvB,aATM/B,EAAAA,QAAagC,QAAQ,eAAgBu+C,EAAgBjkD,KAAKyF,cAE5Dw+C,EAAgBjkD,KAAKwF,sBACjB9B,EAAAA,QAAagC,QAAQ,gBAAiBu+C,EAAgBjkD,KAAKwF,gBAGnE5I,EAAOqE,KAAK,iEAGChE,KAAK2jD,sBAAsBR,EAAeC,EAAeK,GAEtE,MAAMzjD,KAAK+jD,0BAA0B,CACnCvwB,KAAM,iBACNjxB,QAAS,mDAGf,CAAE,MAAOuG,GAEP,MADAnJ,EAAOiC,MAAM,wBAAyBkH,GAChC9I,KAAK+jD,0BAA0B,CACnCvwB,KAAM,iBACNjxB,QAAS,wDAEb,CACF,IA/CoC,OA+CnC,SA/CmCyN,EAAAU,GAAA,OAAAq2C,EAAAllD,MAAC,KAADC,UAAA,EA7BG,IA6BH,CAAAhB,IAAA,4BAAAC,MAoDpC,SAAkCa,GAAiC,IAADsF,EAChE,GAAItF,EAAM4xB,MAAQ5xB,EAAMW,QACtB,OAAOX,EAGT,IAAIqlD,EAAwC,UACxC59C,EAAe,8BAEnB,GAAIzH,EAAMkF,SAAU,CAAC,IAADogD,EAEZlgD,EAASpF,EAAMkF,SAASE,OACxBoC,GAA4B,OAAnB89C,EAAAtlD,EAAMkF,SAAS/D,WAAI,EAAnBmkD,EAAqB99C,SAAUxH,EAAMkF,SAAS04C,WAE9C,MAAXx4C,GACFigD,EAAY,iBACZ59C,EAAe,yBACK,MAAXrC,GACTigD,EAAY,aACZ59C,EAAeD,GAAU,oBAChBpC,GAAU,KACnBigD,EAAY,SACZ59C,EAAeD,GAAU,iBAEzB69C,EAAY,UACZ59C,EAAeD,GAAM,QAAYpC,EAAM,SAE3C,MAAWpF,EAAM+D,SAEfshD,EAAY,UACZ59C,EAAe,0CAGfA,EAAezH,EAAMW,SAAW,yBAGlC,MAAO,CACLixB,KAAMyzB,EACN1kD,QAAS8G,EACT89C,SAAuB,OAAdjgD,EAAAtF,EAAMkF,eAAQ,EAAdI,EAAgBnE,OAAQnB,EAErC,GAAC,CAAAd,IAAA,uBAAAC,MAKD,SAA4B2N,GAIzB,IAAD04C,EAMIC,EALEtB,EAAar3C,EAAOq3C,WACpBuB,EAAqB54C,EAAOy3C,gBAAgBG,YAAc,EAC5D53C,EAAOy3C,gBAAgBE,qBAAuB33C,EAAOy3C,gBAAgBG,YACrE,EAGEiB,EAA4B,GA8BlC,OA5BIxB,GAAc,IAAOuB,EAAqB,GAC5CD,EAAU,YACDtB,GAAc,IAAOuB,EAAqB,GACnDD,EAAU,OACDtB,GAAc,IAAOuB,EAAqB,IACnDD,EAAU,OACVE,EAAgB1Z,KAAK,wDAErBwZ,EAAU,OACVE,EAAgB1Z,KAAK,wCACrB0Z,EAAgB1Z,KAAK,yCACjBn/B,EAAOs3C,aAAa7jD,OAAS,GAC/BolD,EAAgB1Z,KAAK,2CAIrByZ,EAAqB,IACvBC,EAAgB1Z,KAAK,mEAGlBn/B,EAAOo3C,wBACVyB,EAAgB1Z,KAAK,gEAGO,OAA9BuZ,EAAI14C,EAAO+3C,sBAAPW,EAA4BjV,OAC9BoV,EAAgB1Z,KAAK,yBAAwBn/B,EAAO+3C,oBAAoBp6C,SAAW,YAG9E,CACLg7C,QAAAA,EACAtB,WAAAA,EACAwB,gBAAAA,EAEJ,IAAC,EAAAzmD,IAAA,cAAAC,MA7bD,WAIE,OAHKgiD,EAAoB/wC,WACvB+wC,EAAoB/wC,SAAW,IAAI+wC,GAE9BA,EAAoB/wC,QAC7B,IAAC,CARsB,GAocuBE,c,8lBC/ehD,IAAMs1C,GAAyC,CAC7CC,QAAS,eACTC,WAAW,EACXC,WAAY,aACZC,0BAA0B,EAC1BC,YAAa,GAqWf,SAvV0B,SAAC/J,GACzB,IAAMgK,EAAgBznD,EAAWC,kBAAoB,cAC/CynD,EAAal/C,GAAAA,GAAA,GAAQ2+C,IAAoB1J,GAC/CtoC,GAAkCC,EAAAA,EAAAA,UAAiC,MAAKC,GAAAC,EAAAA,EAAAA,SAAAH,EAAA,GAAjEwyC,EAAStyC,EAAA,GAAEuyC,EAAYvyC,EAAA,GAC9BI,GAAsCL,EAAAA,EAAAA,WAAS,GAAMM,GAAAJ,EAAAA,EAAAA,SAAAG,EAAA,GAA9CoyC,EAAWnyC,EAAA,GAAEoyC,EAAcpyC,EAAA,GAClCG,GAAkDT,EAAAA,EAAAA,UAAS,GAAEU,GAAAR,EAAAA,EAAAA,SAAAO,EAAA,GAAtDkyC,EAAiBjyC,EAAA,GAAEkyC,EAAoBlyC,EAAA,GAC9CG,GAAgCb,EAAAA,EAAAA,UAAwB,MAAKc,GAAAZ,EAAAA,EAAAA,SAAAW,EAAA,GAAtDgyC,EAAQ/xC,EAAA,GAAEgyC,EAAWhyC,EAAA,GAC5BoT,GAAkDlU,EAAAA,EAAAA,WAAS,GAAMmU,GAAAjU,EAAAA,EAAAA,SAAAgU,EAAA,GAA1D6+B,EAAiB5+B,EAAA,GAAE6+B,EAAoB7+B,EAAA,GAC9CE,GAA0BrU,EAAAA,EAAAA,UAAuB,MAAKsU,GAAApU,EAAAA,EAAAA,SAAAmU,EAAA,GAA/CloB,EAAKmoB,EAAA,GAAE8vB,EAAQ9vB,EAAA,GAChB2+B,GAAWlyB,EAAAA,EAAAA,QAA8B,MACzCmyB,GAAenyB,EAAAA,EAAAA,QAAe,GAC9BoyB,GAAuBpyB,EAAAA,EAAAA,QAA+B,MACtDqyB,GAA4BryB,EAAAA,EAAAA,SAAO,GACnCsyB,GAAwBtyB,EAAAA,EAAAA,SAAO,IAGrC/f,EAAAA,EAAAA,YAAU,WACRmyC,EAAqBjyB,QAAUqxB,CACjC,GAAG,CAACA,KAGJvxC,EAAAA,EAAAA,YAAU,WACR9W,EAAOmE,MAAM,kDAAkDskD,EAAiB,IAClF,GAAG,CAACA,KAGJ3xC,EAAAA,EAAAA,YAAU,WACR,OAAO,WACL9W,EAAOqE,KAAK,uEACR0kD,EAAS/xB,UACXh3B,EAAOqE,KAAK,yDACZyyC,cAAciS,EAAS/xB,SACvB+xB,EAAS/xB,QAAU,MAGjBiyB,EAAqBjyB,UACvBh3B,EAAOsC,KAAK,sFACZ2mD,EAAqBjyB,QAAQoyB,qBAC1BxH,OAAM,SAAAnqC,GAAC,OAAIzX,EAAOiC,MAAM,gDAAiDwV,EAAE,IAC9EwxC,EAAqBjyB,QAAU,KAEnC,CACF,GAAG,IAEH,IAAMqyB,GAAsC5qB,EAAAA,EAAAA,cAAWn9B,EAAAA,EAAAA,UAAC,YACtD,GAAI4nD,EAA0BlyB,QAC5Bh3B,EAAOmE,MAAM,mEADf,CAIA+kD,EAA0BlyB,SAAU,EACpCkjB,EAAS,MAET,IACEl6C,EAAOqE,KAAK,iEACZ,IAAAilD,QAAkC36B,GAAAA,0BAA1BC,EAAO06B,EAAP16B,QAASvnB,EAAMiiD,EAANjiD,OAGjB,GAFArH,EAAOqE,KAAK,kEAAkEuqB,EAAO,YAAYvnB,EAAM,KAEnGunB,QACID,GAAMG,kBAAkB,CAC5BC,oBAAoB,EACpBC,sBAAsB,EACtBG,yBAAyB,EACzBF,mBAAmB,EACnBC,4BAA4B,IAE9BlvB,EAAOqE,KAAK,2EACZykD,GAAqB,OAChB,CACL,IAAMS,EAAkB,IAAI3lD,MAAM,yDAClC5D,EAAOsC,KAAK,uEACZ43C,EAASqP,GACTT,GAAqB,EACvB,CACF,CAAE,MAAO7mD,GACP,IAAMqvB,EAAMrvB,aAAiB2B,MAAQ3B,EAAQ,IAAI2B,MAAM,mDACvD5D,EAAOiC,MAAM,iEAAkEqvB,GAC/E4oB,EAAS5oB,GACTw3B,GAAqB,EACvB,CAAC,QACCI,EAA0BlyB,SAAU,CACtC,CAhCA,CAiCF,IAAG,IAEGwyB,EAAwB,eAAAliD,GAAAhG,EAAAA,EAAAA,UAAG,YACX,QAAhBf,EAAAA,QAASC,YACWE,EAAWgB,aAAaymD,IACjCxmD,SACX3B,EAAOqE,KAAK,sCAAsC8jD,SAC5CznD,EAAWkB,mBAAmBumD,EAAe,CAAEtmD,eAAe,KAG1E,IAAC,kBAR6B,OAAAyF,EAAApF,MAAA,KAAAC,UAAA,KAWxBsnD,GAAgBhrB,EAAAA,EAAAA,cAAWn9B,EAAAA,EAAAA,UAAC,YAChC,GAAK+mD,EAAL,CAKAroD,EAAOqE,KAAK,+BACZmkD,GAAe,GAGf,IAAMkB,EAAgBV,EAAahyB,QAAUxW,KAAKqf,OAAO78B,KAAKorB,MAAQ46B,EAAahyB,SAAW,KAAQ,EACtGh3B,EAAOqE,KAAK,uCAAuCqlD,EAAa,KAG5DX,EAAS/xB,UACX8f,cAAciS,EAAS/xB,SACvB+xB,EAAS/xB,QAAU,MAIrB0xB,EAAqBgB,GACrBV,EAAahyB,QAAU,EAEvB,UACQqxB,EAAUe,qBAChB,IAAM7D,EAAM8C,EAAUsB,SACtB3pD,EAAOqE,KAAK,2BAA2BkhD,EAAG,eAAemE,EAAa,KACtEd,EAAYrD,GACZ+C,EAAa,KACf,CAAE,MAAOh3B,GACP,IAAMrvB,EAAQqvB,aAAe1tB,MAAQ0tB,EAAM,IAAI1tB,MAAM,4BACrD5D,EAAOiC,MAAM,sCAAuCA,GACpDi4C,EAASj4C,GACT2mD,EAAY,KACd,CA9BA,MAFE5oD,EAAOsC,KAAK,oDAiChB,IAAG,CAAC+lD,IAGEuB,GAAiBnrB,EAAAA,EAAAA,cAAWn9B,EAAAA,EAAAA,UAAC,YAKjC,GAJA44C,EAAS,MACTl6C,EAAOqE,KAAK,yDAGPwkD,EAGD,OAFA7oD,EAAOiC,MAAM,qGACbi4C,EAAS,IAAIt2C,MAAM,oFAIvB,GAAI2kD,EACAvoD,EAAOsC,KAAK,0FAIhB,IAEMymD,EAAS/xB,UACX8f,cAAciS,EAAS/xB,SACvB+xB,EAAS/xB,QAAU,MAGrBh3B,EAAOqE,KAAK,oEACNmlD,IACNxpD,EAAOqE,KAAK,iEACNsqB,GAAMG,kBAAkB,CAC5BC,oBAAoB,EACpBC,sBAAsB,EACtBC,mBAAmB,EACnBC,4BAA4B,EAC5BC,yBAAyB,IAI3B,IAAM06B,EAAgBzB,EAAcN,SAAW,eACzC3J,EAA+Bj1C,GAAA,GAChCylB,GAAAA,wBAA8Bk7B,IAGf,QAAhBtpD,EAAAA,QAASC,KAEX29C,EAAQ2L,IAAM,CAAE3E,SAAU,2BAG5BnlD,EAAOqE,KAAK,sDACZ,IAAmB0lD,SAAuBp7B,GAAAA,UAAgBq7B,YAAY7L,IAA9DkK,UACRC,EAAayB,GAGbrB,EAAqB,GACrB,IAAMt6B,EAAMprB,KAAKorB,MACjB46B,EAAahyB,QAAU5I,EACvBpuB,EAAOqE,KAAK,6CAA6C+pB,GAEzDo6B,GAAe,GACfI,EAAY,MAEZ5oD,EAAOqE,KAAK,kDAEZ0kD,EAAS/xB,QAAU6f,aAAY,WAC7B,IAAMoT,EAAcjnD,KAAKorB,MAGzB,IAAK46B,EAAahyB,QAMhB,OALAh3B,EAAOsC,KAAK,yFACRymD,EAAS/xB,UACX8f,cAAciS,EAAS/xB,SACvB+xB,EAAS/xB,QAAU,OAKvB,IAAMkzB,EAAU1pC,KAAKqf,OAAOoqB,EAAcjB,EAAahyB,SAAW,KAClEh3B,EAAOqE,KAAK,uBAAuB4lD,EAAW,WAAWjB,EAAahyB,QAAO,aAAakzB,EAAO,KAG7FA,GAAW,GAAKA,EAAU,MAC5BxB,EAAqBwB,GAErBlqD,EAAOsC,KAAK,wDAAwD4nD,EAAO,0BAIzE9B,EAAcF,aACdE,EAAcF,YAAc,GAC5BgC,GAAW9B,EAAcF,cAC3BloD,EAAOqE,KAAK,yBAAyB6lD,EAAO,eACxCnB,EAAS/xB,UACX8f,cAAciS,EAAS/xB,SACvB+xB,EAAS/xB,QAAU,MAErByyB,IAEJ,GAAG,KAEHzpD,EAAOqE,KAAK,2DACd,CAAE,MAAOitB,GACP,IAAMrvB,EAAQqvB,aAAe1tB,MAAQ0tB,EAAM,IAAI1tB,MAAM,6BACrD5D,EAAOiC,MAAM,gDAAiDA,GAC9Di4C,EAASj4C,GACTumD,GAAe,GACfQ,EAAahyB,QAAU,EACnB+xB,EAAS/xB,UACX8f,cAAciS,EAAS/xB,SACvB+xB,EAAS/xB,QAAU,KAEvB,CACF,IAAG,CAACuxB,EAAaH,EAAcN,QAASM,EAAcF,YAAauB,EAAeD,KAG9D/qB,EAAAA,EAAAA,cAAY,WAC9B,GAAKuqB,EAAahyB,QAAlB,CAKA,IAAM5I,EAAMprB,KAAKorB,MACX87B,EAAU1pC,KAAKqf,OAAOzR,EAAM46B,EAAahyB,SAAW,KAC1Dh3B,EAAOqE,KAAK,wCAAwC+pB,EAAG,YAAY46B,EAAahyB,QAAO,cAAckzB,EAAO,KAG5GxB,EAAqBwB,GAGjB9B,EAAcF,aACdE,EAAcF,YAAc,GAC5BgC,GAAW9B,EAAcF,cAC3BloD,EAAOqE,KAAK,uCAAuC+jD,EAAcF,YAAW,iCAC5EuB,IAdF,MAFEzpD,EAAOsC,KAAK,qEAkBhB,GAAG,CAAC8lD,EAAcF,YAAauB,KAI/B3yC,EAAAA,EAAAA,YAAU,WACR,IAAIqzC,GAAY,EAEVC,EAA6B,eAAAryC,GAAAzW,EAAAA,EAAAA,UAAG,aAChC8mD,EAAcH,0BAA6BY,EAiB3CA,GAAqBT,EAAcL,YAAcQ,IAAgBY,EAAsBnyB,QACpFmzB,IACHnqD,EAAOqE,KAAK,uHACZ8kD,EAAsBnyB,SAAU,EAChC4yB,KAEOf,GAAqBT,EAAcL,WAAaQ,EACzDvoD,EAAOmE,MAAM,kHACJ0kD,IAAsBT,EAAcL,UAC7C/nD,EAAOmE,MAAM,mGACJ0kD,GAAqBT,EAAcL,WAAaoB,EAAsBnyB,SAC/Eh3B,EAAOmE,MAAM,gHA1BR+kD,EAA0BlyB,QAM7Bh3B,EAAOmE,MAAM,gHALbnE,EAAOqE,KAAK,uHAGZglD,IAwBN,IAAC,kBA/BkC,OAAAtxC,EAAA7V,MAAA,KAAAC,UAAA,KAmCnC,OAFAioD,IAEO,WACLD,GAAY,CACd,CACF,GAAG,CACD/B,EAAcH,yBACdG,EAAcL,UACdc,EACAN,EACAc,EACAO,IAGF,IAAMS,GAAuB5rB,EAAAA,EAAAA,aAAY,WAAD,IAAArmB,GAAA9W,EAAAA,EAAAA,UAAC,UAAOikD,GAC9C,GAAIA,GAAuB,QAAhBhlD,EAAAA,QAASC,GAChB,WAC2BE,EAAWgB,aAAa6jD,IAClC5jD,SACT3B,EAAOqE,KAAK,yCAAyCkhD,SAC/C7kD,EAAW4pD,YAAY/E,GAErC,CAAE,MAAOj0B,GACLtxB,EAAOiC,MAAM,mCAAmCsjD,EAAOj0B,EAC3D,CAEN,IAAC,gBAAAxtB,GAAA,OAAAsU,EAAAlW,MAAA,KAAAC,UAAA,EAZwC,GAYtC,IAEH,MAAO,CACLomD,YAAAA,EACAE,kBAAAA,EACAE,SAAAA,EACAiB,eAAAA,EACAH,cAAAA,EACAY,qBAAAA,EACAxB,kBAAAA,EACA5mD,MAAAA,EAEJ,EC5KA,SA7KkC,SAAHyE,GAQqC,IAPlE6jD,EAAM7jD,EAAN6jD,OACAxmC,EAAOrd,EAAPqd,QACAymC,EAAS9jD,EAAT8jD,UACAC,EAAmB/jD,EAAnB+jD,oBACAC,EAAiBhkD,EAAjBgkD,kBACAC,EAAoBjkD,EAApBikD,qBACAC,EAAclkD,EAAdkkD,eAEMC,GAAKh0B,EAAAA,EAAAA,QAAyB,MACpChhB,GAAgCC,EAAAA,EAAAA,UAA0B,gBAAeC,GAAAC,EAAAA,EAAAA,SAAAH,EAAA,GAAlEi1C,EAAQ/0C,EAAA,GAAEg1C,EAAWh1C,EAAA,GAC5BI,GAAkCL,EAAAA,EAAAA,UAAwB,MAAKM,GAAAJ,EAAAA,EAAAA,SAAAG,EAAA,GAAxD60C,EAAS50C,EAAA,GAAE60C,EAAY70C,EAAA,IAE9BU,EAAAA,EAAAA,YAAU,WAWR,OATAhQ,EAAAA,QAAaC,QAAQ,gBAAgBmkD,MAAK,SAAArkD,GACpCA,EACFokD,EAAapkD,GAEb7G,EAAOsC,KAAK,mDAEhB,IAGO,WACDuoD,EAAG7zB,UACLh3B,EAAOqE,KAAK,4DACZwmD,EAAG7zB,QAAQm0B,QAAU,KACrBN,EAAG7zB,QAAQo0B,QAAU,KACrBP,EAAG7zB,QAAQq0B,UAAY,KACvBR,EAAG7zB,QAAQs0B,OAAS,KACpBT,EAAG7zB,QAAQu0B,QACXV,EAAG7zB,QAAU,KAEjB,CACF,GAAG,IAEH,IAAMw0B,GAAU/sB,EAAAA,EAAAA,cAAWn9B,EAAAA,EAAAA,UAAC,YAC1B,GAAIupD,EAAG7zB,SAAW6zB,EAAG7zB,QAAQy0B,aAAeC,UAAUC,KAIpD,OAHA3rD,EAAOqE,KAAK,gCACZ0mD,EAAY,kBACN,MAANR,GAAAA,KAIF,GAAiB,eAAbO,EAAJ,CAKA,IAAIjkD,EAAQmkD,EAMZ,GALKnkD,IACH7G,EAAOqE,KAAK,sDACZwC,QAAcC,EAAAA,QAAaC,QAAQ,kBAGhCF,EAKH,OAJA7G,EAAOiC,MAAM,uEACb8oD,EAAY,SACQ,MAApBJ,GAAAA,EAAuB,6CACvBpjB,GAAAA,QAAMC,MAAM,uBAAwB,oEAGtCyjB,EAAapkD,GAEbkkD,EAAY,cACZ/qD,EAAOqE,KAAK,sCAEZ,IAAMunD,ExCzEqB,WAC3B,IAAM7mD,EAA6B,qBAAXC,QAA0BA,OAAOC,SAASF,SAGlE,OAAIA,GAA0B,kBAAbA,GAA6C,cAAbA,GAAyC,kBAAbA,EAKzEA,GAAYA,EAAShC,SAAS,WACvB,sBAIE6B,IAECyB,QAAQ,QAAS,MAXpB,qBAYf,CwCwDsBwlD,GAClB7rD,EAAOqE,KAAK,8BAA8BunD,GAE1C,IACE,IAAME,EAAS,IAAIJ,UAAaE,EAAS,sBACzCf,EAAG7zB,QAAU80B,EAEbA,EAAOR,OAAS,WACdtrD,EAAOqE,KAAK,wBACZ0mD,EAAY,aAEZe,EAAOC,KAAKvoD,KAAKC,UAAU,CAAEowB,KAAM,OAAQhtB,MAAAA,KACrC,MAAN0jD,GAAAA,GACF,EAEAuB,EAAOT,UAAY,SAAChe,GAClB,IACE,IAAMzqC,EAAUY,KAAKiL,MAAM4+B,EAAMjqC,MACjCpD,EAAOmE,MAAM,8BAA+BvB,GACnC,MAAT4nD,GAAAA,EAAY5nD,GAES,uBAAjBA,EAAQixB,KACS,MAAnB42B,GAAAA,EAAsB7nD,EAAQ0W,MACJ,qBAAjB1W,EAAQixB,KACA,MAAjB62B,GAAAA,EAAoB9nD,EAAQ0W,KAAM1W,EAAQopD,eAChB,UAAjBppD,EAAQixB,MACjB7zB,EAAOiC,MAAM,0BAA2BW,EAAQA,SAC5B,MAApB+nD,GAAAA,EAAuB/nD,EAAQA,UAEL,WAAjBA,EAAQixB,MACjB7zB,EAAOqE,KAAK,2BAA4BzB,EAAQA,SAClC,MAAdgoD,GAAAA,EAAiBhoD,EAAQA,UACC,sBAAjBA,EAAQixB,MACjB7zB,EAAOqE,KAAK,+BAAgCzB,EAAQiB,KAIxD,CAAE,MAAO4T,GACPzX,EAAOiC,MAAM,qCAAsCwV,GAC/B,MAApBkzC,GAAAA,EAAuB,0CACzB,CACF,EAEAmB,EAAOV,QAAU,SAACa,GAGhBjsD,EAAOiC,MAAM,yBAA0BgqD,GACvClB,EAAY,SACQ,MAApBJ,GAAAA,EAAuB,gDAEzB,EAEAmB,EAAOX,QAAU,SAAC9d,GAChBrtC,EAAOqE,KAAK,oBAAqB,CAAER,KAAMwpC,EAAMxpC,KAAMmjD,OAAQ3Z,EAAM2Z,SACnE6D,EAAG7zB,QAAU,KAEI,UAAb8zB,GACCC,EAAY,gBAEV,MAAPhnC,GAAAA,EAAU,CAAElgB,KAAMwpC,EAAMxpC,KAAMmjD,OAAQ3Z,EAAM2Z,QAE9C,CACF,CAAE,MAAOvvC,GACLzX,EAAOiC,MAAM,iEAAkEwV,GAC/EszC,EAAY,SACQ,MAApBJ,GAAAA,EAAuB,4DACvBE,EAAG7zB,QAAU,IACjB,CAvFA,MAFEh3B,EAAOqE,KAAK,oDA0FhB,IAAG,CAAC2mD,EAAWF,EAAUP,EAAQxmC,EAASymC,EAAWC,EAAqBC,EAAmBC,EAAsBC,IAE7GsB,GAAaztB,EAAAA,EAAAA,cAAY,WACzBosB,EAAG7zB,UACLh3B,EAAOqE,KAAK,uCACZwmD,EAAG7zB,QAAQu0B,QAGf,GAAG,IAEGY,GAAc1tB,EAAAA,EAAAA,cAAY,SAAC77B,GAC/B,IAAIioD,EAAG7zB,SAAW6zB,EAAG7zB,QAAQy0B,aAAeC,UAAUC,KAcpD,OAFA3rD,EAAOsC,KAAK,wDAEL,EAbP,IACE,IAAM8pD,EAA6B,kBAAZxpD,EAAuBA,EAAUY,KAAKC,UAAUb,GAGvE,OAFAioD,EAAG7zB,QAAQ+0B,KAAKK,GAChBpsD,EAAOmE,MAAM,0BAA2BioD,IACjC,CACT,CAAE,MAAOnqD,GAGP,OAFAjC,EAAOiC,MAAM,oCAAqCA,GAC9B,MAApB0oD,GAAAA,EAAuB,sCAChB,CACT,CAMJ,GAAG,CAACA,IAEJ,MAAO,CACLG,SAAAA,EACAU,QAAAA,EACAU,WAAAA,EACAC,YAAAA,EAEJ,EClJO,IAAME,GAAwB,SAAH3lD,GAKC,IAJjC4lD,EAAuB5lD,EAAvB4lD,wBACAC,EAAQ7lD,EAAR6lD,SAAQC,EAAA9lD,EACRqhD,UAAAA,OAAS,IAAAyE,GAAQA,EACjBC,EAAU/lD,EAAV+lD,WAGQ57B,EAAakqB,KAAblqB,SAGRhb,GAAoDC,EAAAA,EAAAA,UAAmB,IAAGC,GAAAC,EAAAA,EAAAA,SAAAH,EAAA,GAAnE62C,EAAkB32C,EAAA,GAAE42C,EAAqB52C,EAAA,GAChDI,GAAgEL,EAAAA,EAAAA,UAAS,IAAGM,GAAAJ,EAAAA,EAAAA,SAAAG,EAAA,GAArEy2C,EAAwBx2C,EAAA,GAAEy2C,EAA2Bz2C,EAAA,GAC5DG,GAA0DT,EAAAA,EAAAA,WAAS,GAAMU,GAAAR,EAAAA,EAAAA,SAAAO,EAAA,GAAlEu2C,EAAqBt2C,EAAA,GAAEu2C,EAAwBv2C,EAAA,GACtDG,GAA8Db,EAAAA,EAAAA,UAAqC,MAAKc,GAAAZ,EAAAA,EAAAA,SAAAW,EAAA,GAAjGq2C,EAAuBp2C,EAAA,GAAEq2C,EAA0Br2C,EAAA,GAC1DoT,GAAgDlU,EAAAA,EAAAA,WAAS,GAAMmU,GAAAjU,EAAAA,EAAAA,SAAAgU,EAAA,GAAxDkjC,EAAgBjjC,EAAA,GAAEkjC,EAAmBljC,EAAA,GAI5CE,GAAgDrU,EAAAA,EAAAA,UAAiB+a,EAASb,iBAAgB5F,GAAApU,EAAAA,EAAAA,SAAAmU,EAAA,GAAnFijC,EAAgBhjC,EAAA,GAAEijC,EAAmBjjC,EAAA,IAG5CtT,EAAAA,EAAAA,YAAU,WACRu2C,EAAoBx8B,EAASb,iBAC7BhwB,EAAOqE,KAAK,qDAAqDwsB,EAASb,gBAC5E,GAAG,CAACa,EAASb,kBAGb,IAAMiH,GAAYJ,EAAAA,EAAAA,QAAO,IAAIC,GAAAA,QAASC,MAAM,IAAIC,QAC1Cs2B,GAAYz2B,EAAAA,EAAAA,QAAO,IAAIC,GAAAA,QAASC,MAAM,IAAIC,QAC1Cu2B,GAAY12B,EAAAA,EAAAA,QAAO,IAAIC,GAAAA,QAASC,MAAM,IAAIC,QAGhDw2B,EASIC,GAAkB,CACpBxF,0BAA0B,EAC1BF,UAAWA,IAVXQ,EAAWiF,EAAXjF,YACAE,EAAiB+E,EAAjB/E,kBACAE,EAAQ6E,EAAR7E,SACAiB,EAAc4D,EAAd5D,eACAH,EAAa+D,EAAb/D,cACAY,EAAoBmD,EAApBnD,qBACAxB,EAAiB2E,EAAjB3E,kBACO6E,EAAcF,EAArBvrD,MAOFyqB,GAAwC5W,EAAAA,EAAAA,WAAS,GAAM6W,GAAA3W,EAAAA,EAAAA,SAAA0W,EAAA,GAAhDihC,EAAYhhC,EAAA,GAAEihC,EAAejhC,EAAA,GACpCC,GAA0C9W,EAAAA,EAAAA,UAAsB,IAAI7U,KAAM4rB,GAAA7W,EAAAA,EAAAA,SAAA4W,EAAA,GAAnEihC,GAAahhC,EAAA,GAAEihC,GAAgBjhC,EAAA,GACtCkhC,IAAsDj4C,EAAAA,EAAAA,WAAS,GAAMk4C,IAAAh4C,EAAAA,EAAAA,SAAA+3C,GAAA,GAA9DE,GAAmBD,GAAA,GAAEE,GAAsBF,GAAA,GAG5CG,IAAet3B,EAAAA,EAAAA,SAAO,GACtBu3B,IAAoBv3B,EAAAA,EAAAA,SAAO,IAGjC/f,EAAAA,EAAAA,YAAU,WACJyxC,GACFzxB,GAAAA,QAASM,KACPN,GAAAA,QAASO,SAAS,CAChBP,GAAAA,QAASQ,OAAOL,EAAW,CAAEM,QAAS,IAAK3Z,SAAU,IAAKiY,gBAAiC,QAAhBt1B,EAAAA,QAASC,KACpFs2B,GAAAA,QAASQ,OAAOL,EAAW,CAAEM,QAAS,EAAG3Z,SAAU,IAAKiY,gBAAiC,QAAhBt1B,EAAAA,QAASC,QAEpFg3B,QACFV,GAAAA,QAASM,KACPN,GAAAA,QAASu3B,QAAQ,IAAK,CACpBv3B,GAAAA,QAASO,SAAS,CAChBP,GAAAA,QAASQ,OAAOg2B,EAAW,CAAE/1B,QAAS,EAAG3Z,SAAU,IAAKiY,gBAAiC,QAAhBt1B,EAAAA,QAASC,KAClFs2B,GAAAA,QAASQ,OAAOg2B,EAAW,CAAE/1B,QAAS,EAAG3Z,SAAU,IAAKiY,gBAAiC,QAAhBt1B,EAAAA,QAASC,OAEpFs2B,GAAAA,QAASO,SAAS,CAChBP,GAAAA,QAASQ,OAAOi2B,EAAW,CAAEh2B,QAAS,EAAG3Z,SAAU,IAAKiY,gBAAiC,QAAhBt1B,EAAAA,QAASC,KAClFs2B,GAAAA,QAASQ,OAAOi2B,EAAW,CAAEh2B,QAAS,EAAG3Z,SAAU,IAAKiY,gBAAiC,QAAhBt1B,EAAAA,QAASC,UAGtFg3B,UAEFP,EAAUq3B,gBACVr3B,EAAUs3B,SAAS,GACnBjB,EAAUgB,gBACVhB,EAAUiB,SAAS,GACnBhB,EAAUe,gBACVf,EAAUgB,SAAS,GAEvB,GAAG,CAAChG,EAAatxB,EAAWq2B,EAAWC,IAGvC,IAAMiB,IAAuB/vB,EAAAA,EAAAA,cAAY,SAAC/0B,GACxC1J,EAAOiC,MAAM,iCAAkCyH,GAC3CykD,GAAan3B,UACf42B,GAAgB,GAChBf,EAA4B,kCAEhC,GAAG,IAEG4B,IAA0BhwB,EAAAA,EAAAA,cAAY,SAACnlB,GAC3CtZ,EAAOmE,MAAM,oCAAqCmV,GAC9C60C,GAAan3B,SACf61B,GAA4B,SAAA6B,GAAI,OAAIA,EAAOp1C,CAAI,GAEnD,GAAG,IAEGq1C,IAAwBlwB,EAAAA,EAAAA,cAAY,SAACnlB,EAAcs1C,GACvD5uD,EAAOqE,KAAK,0BAA0BiV,EAAI,WAAWs1C,GACjDT,GAAan3B,SACf61B,EAA4BvzC,EAAO,IAEvC,GAAG,IAGHu1C,GAKIC,GAA0B,CAC5BrE,oBAAqBgE,GACrB/D,kBAAmBiE,GACnBhE,qBAAsB6D,GACtBjE,OAAQ,WAAF,OAAQvqD,EAAOqE,KAAK,8CAA8C,EACxE0f,QAAS,SAACspB,GAAK,OAAKrtC,EAAOqE,KAAK,8CAA+CgpC,EAAM,IAPzE0hB,IAFJF,GAAR/D,SACyB+D,GAAzBrD,QAC+BqD,GAA/B3C,YAC0B2C,GAA1B1C,aAUFr1C,EAAAA,EAAAA,YAAU,WAcR,OAbAq3C,GAAan3B,SAAU,EACvBh3B,EAAOqE,KAAK,uCAGZsoD,EAAsB,IACtBE,EAA4B,IAC5BE,GAAyB,GACzBE,EAA2B,MAC3BE,GAAoB,GAEpBiB,GAAkBp3B,SAAU,EAC5Bk3B,IAAuB,GAEhB,WACLluD,EAAOqE,KAAK,oEACZ8pD,GAAan3B,SAAU,EACvB+3B,IACF,CACF,GAAG,KAGHj4C,EAAAA,EAAAA,YAAU,WACR,GAAI+xC,EAAmB,CACrB,IAAMmG,EAAO,eAAA1nD,GAAAhG,EAAAA,EAAAA,UAAG,YACdtB,EAAOqE,KAAK,sEACZ,UACQsqB,GAAMG,kBAAkB,CAC5BC,oBAAoB,EACpBC,sBAAsB,EACtBC,mBAAmB,EACnBC,4BAA4B,IAE9BlvB,EAAOqE,KAAK,6EACd,CAAE,MAAOitB,GACPtxB,EAAOiC,MAAM,0EAA2EqvB,EAC1F,CACF,IAAC,kBAbY,OAAAhqB,EAAApF,MAAA,KAAAC,UAAA,KAcb6sD,GACF,CACF,GAAG,CAACnG,IAGJ,IAAMoG,IAAaxwB,EAAAA,EAAAA,cAAY,WAC7Bz+B,EAAOqE,KAAK,yFACR8pD,GAAan3B,UACXuxB,GACFkB,IAAgB7H,OAAM,SAAAtwB,GAAG,OACvBtxB,EAAOiC,MAAM,8CAA+CqvB,EAAI,IAGpEi7B,IAEJ,GAAG,CAAChE,EAAakB,EAAe8C,IAG1B2C,IAAyBzwB,EAAAA,EAAAA,cAAY,WACzC,GAAK0vB,GAAan3B,UAAWo3B,GAAkBp3B,QAA/C,CAEA,IAAMm4B,EAAiBzC,EAAmB7pD,KAAK,MAAMmkB,OACrD,GAAKmoC,EAAL,CAKAf,GAAkBp3B,SAAU,EAC5Bk3B,IAAuB,GAEvB,IAAM9H,GAAoC,MAAvB4G,OAAuB,EAAvBA,EAAyB5G,aAAc,EACpDwI,EAA0C,MAAvB5B,OAAuB,EAAvBA,EAAyB7G,uBAElDnmD,EAAOqE,KACL,mCAAmC8qD,EAAezmD,UAAU,EAAG,IAA/D,qBACe09C,EAAWa,QAAQ,GAAE,gBAAe2H,GAAoB,YAGzE12B,GAActoB,UACd08C,EAAwB6C,EAAgBxG,QAAYzkD,EAAW0qD,EAAkBxI,EAdjF,MAFEpmD,EAAOsC,KAAK,2BAJgD,CAqBhE,GAAG,CAACoqD,EAAoBM,EAAyBrE,EAAU2D,IA2BrD8C,GAAc,eAAAzlD,GAAArI,EAAAA,EAAAA,UAAG,UAAOikD,EAAa31B,GACzC,GAAKu+B,GAAan3B,UAAW62B,GAAcx5C,IAAIkxC,GAA/C,CAKAuI,IAAiB,SAAAY,GAAI,OAAI,IAAIztD,IAAIytD,GAAMhqD,IAAI6gD,EAAI,IAC/CwH,GAAyB,GACzBF,EAA4B,iBAE5B,IAAK,IAADwC,EACFrvD,EAAOqE,KAAK,+CAA+CkhD,EAAG,mBAAmB31B,GAGjF,IAAM6zB,EAAiC,SAAjB7zB,OAA0B1rB,EAAY,CAAC0rB,GACvD7gB,QAAeugD,GAAoBC,gBAAgBhK,EAAK,CAC5D9B,cAAAA,EACAE,gBAAiB,EACjBE,sBAAsB,EACtBC,0BAA0B,IAG5B,IAAKqK,GAAan3B,QAEhB,YADAh3B,EAAOqE,KAAK,+EAKd4oD,EAA2Bl+C,GAG3B,IAAMygD,EAAoBF,GAAoBG,qBAAqB1gD,GAE7D81C,EAA8B,OAApBwK,EAAGtgD,EAAO81C,iBAAU,EAAjBwK,EAAmBroC,OACtC,GAAI69B,EAAY,CAAC,IAAD4C,EAEd,GAA8B,OAA9BA,EAAI14C,EAAO+3C,sBAAPW,EAA4BjV,MAAO,CAErC,IAAMkd,EA9DwB,SAAC7K,EAAoB8K,GACzD,GAAsB,MAAjBA,IAAAA,EAAmBjjD,QAAS,OAAO,EAGxC,IAAMkjD,EAAY,SAACt2C,GACjB,OAAOA,EAAKwzB,cAAczmC,QAAQ,aAAc,GAClD,EAEMwpD,EAAuBD,EAAU/K,GACjCpS,EAAmBmd,EAAUD,EAAkBjjD,SAG/CojD,EAAeD,IAAyBpd,EAQ9C,OANIqd,EACF9vD,EAAOqE,KAAK,oEAAoEwrD,EAAoB,sBAAsBpd,EAAgB,KAE1IzyC,EAAOqE,KAAK,iEAAiEwrD,EAAoB,iBAAiBpd,EAAgB,KAG7Hqd,CACT,CAyCmCC,CAA8BlL,EAAY91C,EAAO+3C,qBAE5E,GAAI4I,EAAoB,CACtB1vD,EAAOqE,KAAK,8DAA8DwgD,EAAU,4BACpF,IAAMhS,EAA+C,aAAtC9jC,EAAO+3C,oBAAoBjU,OAAwB,YAAc,cAUhF,OATAga,EAA4B,cAAcha,EAAM,sBAGhDnT,YAAW,WACLyuB,GAAan3B,SACf61B,EAA4B,GAEhC,GAAG,IAGL,CACE7sD,EAAOqE,KAAK,yEAAyEwgD,EAAU,IAGnG,CAGA,IAAMmL,EAAwBnL,EAAWlE,OAAO,GAAGp9C,cAAgBshD,EAAW5iB,MAAM,GAEpFjiC,EAAOqE,KACL,qDACUwgD,EAAWn8C,UAAU,EAAG,IADlC,qBAEeqG,EAAOq3C,WAAWa,QAAQ,GAFzC,gBAGal4C,EAAOo3C,wBAA0Bv2B,GAH9C,cAIY4/B,EAAkB9H,QAJ9B,mBAKiB34C,EAAOs3C,aAAa7jD,QAInCgtD,EAAkB5H,gBAAgBplD,OAAS,GAC7CxC,EAAOqE,KAAK,4BAA4BmrD,EAAkB5H,gBAAgB/kD,KAAK,OAIjF8pD,GAAsB,SAAA+B,GACpB,IAAMuB,EAAW,GAAAriB,QAAApS,EAAAA,GAAAA,SAAOkzB,GAAI,CAAEsB,IAI9B,GAHAhwD,EAAOqE,KAAK,iDAAiD4rD,EAAYztD,OAAM,uBAAuBwtD,EAAqB,KAGvHn/B,EAASJ,iBAAmBg8B,EAAY,CAC1C,IAAMyD,EAAgBD,EAAYptD,KAAK,MACvC7C,EAAOqE,KAAK,yEAAyE6rD,EAAa,KAElGxwB,YAAW,WACT+sB,EAAWyD,EACb,GAAG,EACL,CAEA,OAAOD,CACT,IAEApD,EAA4B,GAC9B,MACEA,EAA4B,uCAC5B7sD,EAAOsC,KAAK,wDAGhB,CAAE,MAAOL,GACPjC,EAAOiC,MAAM,yCAA0CA,GACnDksD,GAAan3B,SACf61B,EAA4B,WAAU5qD,EAAMW,SAAW,wBAE3D,CAAC,QACKurD,GAAan3B,SACf+1B,GAAyB,GAI3B,UACQ1C,EAAqB9E,GAC3BvlD,EAAOqE,KAAK,2CAA2CkhD,EACzD,CAAE,MAAO4K,GACPnwD,EAAOiC,MAAM,kDAAkDsjD,EAAG,IAAK4K,EACzE,CACF,CAjHA,MAFEnwD,EAAOqE,KAAK,6BAA6BkhD,EAAG,+CAoHhD,IAAC,gBAtHmBzhD,EAAAC,GAAA,OAAA4F,EAAAzH,MAAA,KAAAC,UAAA,MAyHpB2U,EAAAA,EAAAA,YAAU,WACR,GAAI6xC,IAAaJ,IAAgBsF,GAAcx5C,IAAIs0C,IAAaE,EAAmB,CAEjF,GAAyB,SAArBuE,IAAgCz9B,GAAqBy9B,GAIvD,OAHAptD,EAAOiC,MAAM,+BAA+BmrD,GAC5C7lB,GAAAA,QAAMC,MAAM,2BAA4B,sDACxC6lB,EAAoB,QAItBrtD,EAAOqE,KACL,oDAAoDskD,EAApD,kBACiByE,EAAgB,8BAGnCgC,GAAezG,EAAUyE,EAC3B,CACF,GAAG,CAACzE,EAAUJ,EAAasF,GAAehF,EAAmBuE,IAE7D,IAAMgD,GAAc,eAAAz4C,GAAArW,EAAAA,EAAAA,UAAG,YACrB,IAAKunD,EAGH,OAFAthB,GAAAA,QAAMC,MAAM,uBAAwB,wDACpCxnC,EAAOsC,KAAK,2CAId,GAAIimD,EAAa,CACfvoD,EAAOqE,KAAK,kEACZ6zB,GAActc,SACd,UACQ6tC,GACR,CAAE,MAAOxnD,GACPjC,EAAOiC,MAAM,oDAAqDA,EACpE,CACF,KAAO,CACL,GAAI6qD,EAIF,OAHA9sD,EAAOqE,KAAK,gFACZ6zB,GAAczzB,eACd8iC,GAAAA,QAAMC,MAAM,aAAc,8DAK5B4mB,GAAkBp3B,SAAU,EAE5Bh3B,EAAOqE,KAAK,8DACZ6zB,GAAcm4B,QACd,UACQzG,GACR,CAAE,MAAO3nD,GACPjC,EAAOiC,MAAM,wDAAyDA,GACtEslC,GAAAA,QAAMC,MAAM,2BAA4B,qDAC1C,CACF,CACF,IAAC,kBAnCmB,OAAA7vB,EAAAzV,MAAA,KAAAC,UAAA,KA0DdmuD,IAAuB/H,IAAgBuE,GAAyBJ,EAAmBlqD,OAAS,EAElG,MAAO,CAELkqD,mBAAAA,EACAC,sBAAAA,EACAC,yBAAAA,EACAE,sBAAAA,EACAE,wBAAAA,EACAE,iBAAAA,EACAC,oBAAAA,EACAC,iBAAAA,EACAO,aAAAA,EACAM,oBAAAA,GACAqC,oBAAAA,GAGAr5B,UAAAA,EACAq2B,UAAAA,EACAC,UAAAA,EAGAhF,YAAAA,EACAE,kBAAAA,EACAE,SAAAA,EACAE,kBAAAA,EACA6E,eAAAA,EAGA0C,eAAAA,GACAlB,uBAAAA,GACAD,WAAAA,GACAsB,qBApD2B,SAAC3gC,GACxBD,GAAqBC,IAAkC,SAAjBA,GACxCy9B,EAAoBz9B,GACpB5vB,EAAOqE,KAAK,wBAAwBurB,IAEpC5vB,EAAOiC,MAAM,0BAA0B2tB,EAE3C,EA8CE4gC,eA5CqB,SAACC,GAGtB,OAFajwC,KAAKqf,MAAM4wB,EAAU,IAEpB,KADDA,EAAU,IACAzwB,WAAW6R,SAAS,EAAG,IAChD,EAyCE6e,aAtCmB,SAACp3C,GACpB,OAAOA,EAAKjT,QAAQ,yBAAsB,IAAI2gB,MAChD,EAsCF,E,0lBCvfA,IAAgB2pC,GAAkBzmB,GAAAA,QAAWlgC,IAAI,UAAzCuT,OAGFsY,GAAkC,QAAhBt1B,EAAAA,QAASC,GAkB3BowD,IAAcjxC,EAAAA,EAAAA,aAA6C,SAAAjZ,EAS9DkZ,GAAS,IARVhK,EAAQlP,EAARkP,SACAkO,EAAOpd,EAAPod,QACAC,EAAOrd,EAAPqd,QAAO8sC,EAAAnqD,EACPoqD,WAAAA,OAAU,IAAAD,EAAG,CAAC,GAAK,GAAK,IAAIA,EAAAE,EAAArqD,EAC5BsqD,iBAAAA,OAAgB,IAAAD,EAAG,EAACA,EAAAE,EAAAvqD,EACpBwqD,iBAAAA,OAAgB,IAAAD,GAAOA,EAAAE,EAAAzqD,EACvB0qD,gBAAAA,OAAe,IAAAD,EAAG,GAAGA,EACrBjsC,EAAKxe,EAALwe,MAEQ5F,EAAUG,KAAVH,MACF0B,EAASyE,GAAUnG,GAEnB+xC,GAAax6B,EAAAA,EAAAA,QAAO,IAAIC,GAAAA,QAASC,MAAM45B,KAAgB35B,QACvDs6B,GAAmBz6B,EAAAA,EAAAA,QAAO,IAAIC,GAAAA,QAASC,MAAM,IAAIC,QACjDu6B,GAAe16B,EAAAA,EAAAA,QAAO,GACtB26B,GAAmB36B,EAAAA,EAAAA,QAAOm6B,GAC1BS,GAAoB56B,EAAAA,EAAAA,QAAO,IAAIC,GAAAA,QAASC,MAAM,IAAIC,QAElD06B,EAAqBZ,EAAW/0B,KAAI,SAAA41B,GAAK,OAAIhB,IAAiB,EAAIgB,EAAM,KAE9EC,EAAAA,EAAAA,qBAAoBhyC,GAAK,iBAAO,CAC9BiyC,OAAQ,SAAC3vB,GACHA,GAAS,GAAKA,EAAQwvB,EAAmBlvD,SAC3CgvD,EAAiBx6B,QAAUkL,EAC3BpL,GAAAA,QAASsB,OAAOi5B,EAAY,CAC1B95B,QAASm6B,EAAmBxvB,GAC5BrM,gBAAAA,KACC2B,QAEP,EACA+zB,MAAO,WACLxnC,GACF,EACD,KAEDjN,EAAAA,EAAAA,YAAU,WACJgN,GAEFgT,GAAAA,QAASqB,SAAS,CAChBrB,GAAAA,QAASsB,OAAOi5B,EAAY,CAC1B95B,QAASm6B,EAAmBV,GAC5Bn7B,gBAAAA,KAEFiB,GAAAA,QAASQ,OAAOg6B,EAAkB,CAChC/5B,QAAS,EACT3Z,SAAU,IACViY,gBAAAA,OAED2B,QACHg6B,EAAiBx6B,QAAUg6B,GAG3Bl6B,GAAAA,QAASqB,SAAS,CAChBrB,GAAAA,QAASsB,OAAOi5B,EAAY,CAC1B95B,QAASo5B,GACT96B,gBAAAA,KAEFiB,GAAAA,QAASQ,OAAOg6B,EAAkB,CAChC/5B,QAAS,EACT3Z,SAAU,IACViY,gBAAAA,OAED2B,OAEP,GAAG,CAAC1T,EAASktC,IAGb,IAAMc,GAAiBrzB,EAAAA,EAAAA,aACrB3H,GAAAA,QAASuW,MACP,CAAC,CAAEE,YAAa,CAAEwkB,aAAcN,KAChC,CACE57B,iBAAiB,EACjBpD,SAAU,SAAC4a,GAET,GAAK6jB,EAAL,CAEA,IAAQa,EAAiB1kB,EAAME,YAAvBwkB,aACRR,EAAav6B,QAAU+6B,CAHM,CAI/B,IAGJ,CAACb,EAAkBO,IAGfO,GAAuBvzB,EAAAA,EAAAA,cAAY,SAAC4O,GACxC,GAAK6jB,GAED7jB,EAAME,YAAY0kB,WAAaC,EAAAA,MAAMC,OAAQ,CAC/C,IAAAC,EAAoC/kB,EAAME,YAAlCwkB,EAAYK,EAAZL,aAAcM,EAASD,EAATC,UAChBC,EAAWZ,EAAmBF,EAAiBx6B,SAAW+6B,EAGhEN,EAAkBlD,SAAS,GAG3B,IAAIgE,EAAkBf,EAAiBx6B,QAEvC,GAAIq7B,EAAY,KAGd,IADAE,EAAkB/xC,KAAKo0B,IAAI4c,EAAiBx6B,QAAU,EAAG06B,EAAmBlvD,OAAS,MAC7DkvD,EAAmBlvD,OAAS,GAAKuvD,EAAe,IAEtE,YADAhuC,SAGG,GAAIsuC,GAAa,IAEtBE,EAAkB/xC,KAAKC,IAAI+wC,EAAiBx6B,QAAU,EAAG,OACpD,CAEL,IAAIw7B,EAAcC,IAUlB,GATAf,EAAmBv+B,SAAQ,SAACw+B,EAAOzvB,GACjC,IAAMwwB,EAAWlyC,KAAKsjB,IAAIwuB,EAAWX,GACjCe,EAAWF,IACbA,EAAcE,EACdH,EAAkBrwB,EAEtB,IAGIowB,EAA2B,GAAhB3B,GAEb,YADA5sC,GAGJ,CAEAytC,EAAiBx6B,QAAUu7B,EAC3Bz7B,GAAAA,QAASsB,OAAOi5B,EAAY,CAC1B95B,QAASm6B,EAAmBa,GAC5B18B,gBAAAA,KACC2B,OACL,CACF,GAAG,CAAC05B,EAAkBQ,EAAoB3tC,EAASstC,IAMnD,IAAKvtC,EACH,OAAO,KAIT,IAAM6uC,EAAqB77B,GAAAA,QAASpyB,IAAI2sD,EAAYI,GAE9CnnD,GACJ0a,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOE,UAAUtL,SAAA,EAE5B4C,EAAAA,EAAAA,KAACo6C,GAAAA,QAAwB,CAACvtC,QAdF,WAC1BtB,GACF,EAY2DnO,UACrD4C,EAAAA,EAAAA,KAACse,GAAAA,QAAS3R,KAAI,CACZD,MAAO,CACLlE,EAAO6xC,SACP,CACEx8B,QAASi7B,EAAiB35B,YAAY,CACpCC,WAAY,CAAC,EAAG,GAChBC,YAAa,CAAC,EAAGu5B,YAO3B54C,EAAAA,EAAAA,KAACs6C,EAAAA,kBAAiB,CAChBhB,eAAgBA,EAChBE,qBAAsBA,EACtB5xD,QAAS8wD,EAAiBt7C,UAE1BoP,EAAAA,EAAAA,MAAC8R,GAAAA,QAAS3R,KAAI,CACZD,MAAO,CACLlE,EAAO+xC,YACP7tC,EACA,CACE4S,UAAW,CAAC,CAAEu5B,WAAYsB,MAE5B/8C,SAAA,EAEF4C,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAOgyC,UACpBx6C,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAO1W,QAAQsL,SACzBA,YAOX,MAAoB,QAAhBrV,EAAAA,QAASC,IAETgY,EAAAA,EAAAA,KAACoM,GAAAA,QAAK,CACJE,aAAW,EACXhB,QAASA,EACTe,cAAc,OACdE,eAAgBhB,EAAQnO,SAEvBtL,IAKAA,CACT,IAEMmb,GAAY,SAACnG,GAAe,OAAK2B,EAAAA,QAAWxb,OAAO,CACvDyb,UAAW,CACTC,KAAM,EACNO,eAAgB,YAElBmxC,SAAQ3pD,GAAAA,GAAA,GACH+X,EAAAA,QAAWgyC,oBAAkB,IAChC7xC,gBAAiB9B,EAAMC,OAAOlF,UAEhC04C,YAAW7pD,GAAA,CACTkY,gBAAiB9B,EAAMC,OAAOnG,QAC9B85C,oBAAqB5zC,EAAMrC,aAAaX,IACxC62C,qBAAsB7zC,EAAMrC,aAAaX,IACzCqJ,UAA2B,GAAhBgrC,GACXyC,UAA2B,IAAhBzC,IACRrxC,EAAMnC,QAAQd,IAEnB22C,OAAQ,CACN11C,MAAO,GACPC,OAAQ,EACR6D,gBAAiB9B,EAAMC,OAAO9F,OAC9BwD,aAAc,EACduM,UAAW,SACX3G,UAAWvD,EAAMvC,QAAQZ,GACzBmH,aAAchE,EAAMvC,QAAQX,IAE9B9R,QAAS,CACP6W,KAAM,EACNmB,kBAAmBhD,EAAMvC,QAAQX,GACjCmE,cAAejB,EAAMvC,QAAQV,KAE9B,EAEH,Y,+kBCxPA,IA4KMoJ,GAAY,SAACnG,GAAe,OAAK2B,EAAAA,QAAWxb,OAAO,CACvDyb,UAAW,CACT4H,eAAgBxJ,EAAMvC,QAAQZ,IAEhCk3C,SAAQnqD,GAAA,CACNsY,cAAe,MACfC,WAAY,SACZC,eAAgB,gBAChBN,gBAAiB9B,EAAMC,OAAOlG,KAC9B4D,aAAcqC,EAAMrC,aAAab,GACjCkG,kBAAmBhD,EAAMvC,QAAQX,GACjCiG,gBAAiB/C,EAAMvC,QAAQX,GAC/BwL,YAAa,EACbD,YAAarI,EAAMC,OAAO9F,OAC1BkM,UAAW,IACRrG,EAAMnC,QAAQjB,IAEnBo3C,iBAAkB,CAChBj9B,QAAS,GACTjV,gBAAiB9B,EAAMC,OAAOxF,UAEhCw5C,gBAAiB,CACf/xC,cAAe,MACfC,WAAY,SACZN,KAAM,GAERg6B,cAAe,CACb79B,MAAO,GACPC,OAAQ,GACRN,aAAcqC,EAAMrC,aAAab,GACjCgF,gBAAiB9B,EAAMC,OAAOxG,aAAe,KAC7C2I,eAAgB,SAChBD,WAAY,SACZgH,YAAanJ,EAAMvC,QAAQZ,IAE7Bi/B,cAAe,CACbj6B,KAAM,GAERqyC,cAAe,CACb1xC,SAAUxC,EAAM7D,WAAWO,UAAUE,GACrC8F,MAAO1C,EAAMC,OAAOhG,cACpByJ,WAAY1D,EAAM7D,WAAWC,aAAaE,OAC1C0H,aAAchE,EAAMvC,QAAQd,IAE9Bw3C,aAAc,CACZ3xC,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC6F,MAAO1C,EAAMC,OAAOjG,KACpB0J,WAAY1D,EAAM7D,WAAWC,aAAaG,UAE5C63C,qBAAsB,CACpB1xC,MAAO1C,EAAMC,OAAOxF,UAEtB45C,aAAc,CACZxyC,KAAM,GAERi8B,YAAa,CACX95B,aAAchE,EAAMvC,QAAQX,IAE9BkhC,WAAY,CACVx7B,SAAUxC,EAAM7D,WAAWO,UAAUK,GACrC0F,WAAY,OACZC,MAAO1C,EAAMC,OAAOjG,KACpB0J,WAAY1D,EAAM7D,WAAWC,aAAaI,KAC1CwH,aAAchE,EAAMvC,QAAQd,IAE9B23C,cAAe,CACb9xC,SAAUxC,EAAM7D,WAAWO,UAAUE,GACrC8F,MAAO1C,EAAMC,OAAOhG,cACpByJ,WAAY1D,EAAM7D,WAAWC,aAAaC,SAE5CyuB,gBAAiB,CACf9mB,aAAchE,EAAMvC,QAAQX,IAE9By3C,mBAAoB,CAClBryC,cAAe,MACfC,WAAY,SACZL,gBAAiB9B,EAAMC,OAAOvF,gBAC9BiD,aAAcqC,EAAMrC,aAAab,GACjCwL,YAAa,EACbD,YAAarI,EAAMC,OAAO9F,OAC1B6I,kBAAmBhD,EAAMvC,QAAQZ,GACjCwJ,UAAW,IAEb2kB,WAAY,CACV7hB,YAAanJ,EAAMvC,QAAQb,IAE7BquB,YAAa,CACXppB,KAAM,EACNW,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC6F,MAAO1C,EAAMC,OAAOjG,KACpB0J,WAAY1D,EAAM7D,WAAWC,aAAaC,QAC1C0G,gBAAiB/C,EAAMvC,QAAQZ,IAEjCyH,YAAa,CACXjC,QAASrC,EAAMvC,QAAQd,GACvB+J,WAAY1G,EAAMvC,QAAQb,IAE5B43C,aAAc,CACZhyC,SAAUxC,EAAM7D,WAAWO,UAAUE,GACrC8F,MAAO1C,EAAMC,OAAOhG,cACpByJ,WAAY1D,EAAM7D,WAAWC,aAAaC,QAC1C2H,aAAchE,EAAMvC,QAAQZ,GAC5BoH,UAAW,UAEbwwC,aAAc,CACZ5yC,KAAM,GAER6yC,aAAc,CACZxyC,cAAe,MACfC,WAAY,SACZC,eAAgB,gBAChBW,gBAAiB/C,EAAMvC,QAAQX,GAC/BkG,kBAAmBhD,EAAMvC,QAAQZ,GACjCc,aAAcqC,EAAMrC,aAAad,GACjCmH,aAAchE,EAAMvC,QAAQd,GAC5B0J,UAAW,IAEbsuC,qBAAsB,CACpB7yC,gBAAiB9B,EAAMC,OAAOxG,aAAe,KAC7C6O,YAAa,EACbD,YAAarI,EAAMC,OAAOxG,aAAe,MAE3Cm7C,aAAc,CACZ/yC,KAAM,GAERgzC,aAAc,CACZryC,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC6F,MAAO1C,EAAMC,OAAOjG,KACpB0J,WAAY1D,EAAM7D,WAAWC,aAAaG,SAC1CyH,aAAchE,EAAMvC,QAAQd,IAE9Bm4C,qBAAsB,CACpBpyC,MAAO1C,EAAMC,OAAOzG,SAEtB8W,aAAc,CACZ9N,SAAUxC,EAAM7D,WAAWO,UAAUE,GACrC8F,MAAO1C,EAAMC,OAAOhG,cACpByJ,WAAY1D,EAAM7D,WAAWC,aAAaC,SAE5C04C,qBAAsB,CACpBryC,MAAO1C,EAAMC,OAAOzG,SAEtBw7C,mBAAoB,CAClBtuC,WAAY1G,EAAMvC,QAAQZ,IAE5Bo4C,WAAY,CACV9yC,WAAY,SACZC,eAAgB,SAChBW,gBAAiB/C,EAAMvC,QAAQR,MAEjCi4C,eAAgB,CACd1yC,SAAUxC,EAAM7D,WAAWO,UAAUI,GACrC4F,MAAO1C,EAAMC,OAAOhG,cACpByJ,WAAY1D,EAAM7D,WAAWC,aAAaG,SAC1CgH,UAAWvD,EAAMvC,QAAQZ,GACzBmH,aAAchE,EAAMvC,QAAQd,IAE9Bw4C,kBAAmB,CACjB3yC,SAAUxC,EAAM7D,WAAWO,UAAUE,GACrC8F,MAAO1C,EAAMC,OAAO/F,aACpBwJ,WAAY1D,EAAM7D,WAAWC,aAAaC,UAE3C,EAEH,SAhV0D,SAAHjV,GAIhD,IAHL0mD,EAAgB1mD,EAAhB0mD,iBACAsH,EAAgBhuD,EAAhBguD,iBAAgBpuC,EAAA5f,EAChBqT,SAAAA,OAAQ,IAAAuM,GAAQA,EAERhH,EAAUG,KAAVH,MACF0B,EAASyE,GAAUnG,GACzBzJ,GAAwCC,EAAAA,EAAAA,WAAS,GAAMC,GAAAC,EAAAA,EAAAA,SAAAH,EAAA,GAAhD8+C,EAAY5+C,EAAA,GAAE6+C,EAAe7+C,EAAA,GACpCI,GAAsCL,EAAAA,EAAAA,UAAS,IAAGM,GAAAJ,EAAAA,EAAAA,SAAAG,EAAA,GAA3Cs1B,EAAWr1B,EAAA,GAAEs1B,EAAct1B,EAAA,GAG5Bg+C,IAFiBv9B,EAAAA,EAAAA,QAAuB,M9BiDzC,SAAyBjH,GAC9B,IAAMilC,EAAWplC,GAAoBgvB,MAAK,SAAA3uB,GAAI,OAAIA,EAAKjsB,OAAS+rB,CAAY,IAC5E,GAAIilC,EACF,MAAsB,SAAlBA,EAAShxD,KAAwBgxD,EAAStkD,KACvCskD,EAASnlC,OAAYmlC,EAAStkD,KAAI,KAAKskD,EAASnlC,OAAM,IAAMmlC,EAAStkD,KAI9E,IAAMukD,EAAWllC,EAAapL,MAAM,KAAK,GACnCuwC,EAAQtlC,GAAoBgvB,MAAK,SAAA3uB,GAAI,OAAIA,EAAKjsB,KAAK0C,WAAWuuD,EAAW,IAAI,IACnF,OAAOC,EAASA,EAAMrlC,OAAYqlC,EAAMxkD,KAAI,KAAKwkD,EAAMrlC,OAAM,IAAMqlC,EAAMxkD,KAAQ,IACnF,C8B1D+BykD,CAAgB5H,IAAqB,eAG5D6H,EAAoBxlC,GAAoBrd,QAAO,SAAAyiD,GACnD,IAAKppB,EAAYzkB,OAAQ,OAAO,EAEhC,IAAMrb,EAAQ8/B,EAAYqB,cAC1B,OACE+nB,EAAStkD,KAAKu8B,cAAc/pC,SAAS4I,IACrCkpD,EAAShxD,KAAKipC,cAAc/pC,SAAS4I,IACpCkpD,EAASnlC,QAAUmlC,EAASnlC,OAAOod,cAAc/pC,SAAS4I,EAE/D,IAuDA,OACEqZ,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOE,UAAUtL,SAAA,EAC5BoP,EAAAA,EAAAA,MAACI,GAAAA,QAAgB,CACfF,MAAO,CAAClE,EAAOqyC,SAAUt5C,GAAYiH,EAAOsyC,kBAC5CjuC,QAnDqB,WACpBtL,GACH66C,GAAgB,EAEpB,EAgDM76C,SAAUA,EACVkiC,mBAAkB,qBAAuBmY,EAAoB,mBAC7DpY,kBAAkB,SAClBE,kBAAkB,gCAA+BtmC,SAAA,EAEjDoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOuyC,gBAAgB39C,SAAA,EAClC4C,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAOm6B,cAAcvlC,UAChC4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CACP/U,KAAK,WACLvO,KAAM,GACNggB,MAAOjI,EAAWuF,EAAMC,OAAOxF,SAAWuF,EAAMC,OAAOzG,aAEpDkM,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOo6B,cAAcxlC,SAAA,EACvC4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOwyC,cAAc59C,SAAC,cAAe4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAO,CAC7DlE,EAAOyyC,aACP15C,GAAYiH,EAAO0yC,sBACnB99C,SACCw+C,WAGA57C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CACd/U,KAAK,eACLvO,KAAM,GACNggB,MAAOjI,EAAWuF,EAAMC,OAAOxF,SAAWuF,EAAMC,OAAOhG,oBAExCf,EAAAA,EAAAA,KAACo4C,GAAW,CAC7B9sC,QAAS6wC,EACT5wC,QAzEsB,WAC1B6wC,GAAgB,GAChBlpB,EAAe,GACjB,EAuEMolB,WAAY,CAAC,GAAK,IAClBE,iBAAkB,EAAEp7C,UAEpBoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAO2yC,aAAa/9C,SAAA,EAC/BoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOo8B,YAAYxnC,SAAA,EAC9B4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOs8B,WAAW1nC,SAAC,qBAAsB4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO4yC,cAAch+C,SAAC,+DAGpF4C,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAOopB,gBAAgBx0B,UACzCoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAO6yC,mBAAmBj+C,SAAA,EACrC4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CACP/U,KAAK,SACLvO,KAAM,GACNggB,MAAO1C,EAAMC,OAAOhG,cACpB2L,MAAOlE,EAAOspB,cACd9xB,EAAAA,EAAAA,KAACmS,GAAAA,QAAS,CACVzF,MAAOlE,EAAOupB,YACdnpC,MAAOqqC,EACP5gB,aAAc6gB,EACd9gB,YAAY,sBACZK,qBAAsB3L,EAAMC,OAAOhG,cACnC27C,cAAc,SACdlqC,aAAa,EACbD,eAAe,SACd0gB,EAAYjpC,OAAS,IACtBgW,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CACfC,QAAS,WAAF,OAAQqmB,EAAe,GAAG,EACjCxmB,MAAOlE,EAAO4C,YACdq4B,mBAAmB,eAAcrmC,UAEjC4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,eAAevO,KAAM,GAAIggB,MAAO1C,EAAMC,OAAOhG,uBAI5DkyB,EAAYzkB,SAClBhC,EAAAA,EAAAA,MAACO,EAAAA,QAAI,CAACL,MAAOlE,EAAO8yC,aAAal+C,SAAA,CAC9Bq/C,EAAkBzyD,OAAO,YAAuC,IAA7ByyD,EAAkBzyD,OAAe,GAAK,IAAI,aAEhFgW,EAAAA,EAAAA,KAACggC,GAAAA,QAAQ,CACTp1C,KAAM6xD,EACNtc,aAAc,SAACD,GAAI,OAAKA,EAAK70C,IAAI,EACjC40C,WA9GiB,SAAHnxC,GAAA,IAAMoxC,EAAIpxC,EAAJoxC,KAAI,OAChC1zB,EAAAA,EAAAA,MAACI,GAAAA,QAAgB,CACfF,MAAO,CACLlE,EAAOgzC,aACPtb,EAAK70C,OAASupD,GAAoBpsC,EAAOizC,sBAE3C5uC,QAAS,WAAF,OAvBmBuK,EAuBU8oB,EAAK70C,KAtB3C6wD,EAAiB9kC,GACjBglC,GAAgB,QAChBlpB,EAAe,IAHY,IAAC9b,CAuBoB,EAC9CqsB,mBAAkB,UAAYvD,EAAKnoC,KAAI,YACvCyrC,kBAAkB,SAAQpmC,SAAA,EAE1BoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOkzC,aAAat+C,SAAA,EAC/B4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAO,CACXlE,EAAOmzC,aACPzb,EAAK70C,OAASupD,GAAoBpsC,EAAOozC,sBACzCx+C,SACC8iC,EAAKhpB,OAAYgpB,EAAKnoC,KAAI,KAAKmoC,EAAKhpB,OAAM,IAAMgpB,EAAKnoC,QACjDiI,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAO,CAClBlE,EAAO4O,aACP8oB,EAAK70C,OAASupD,GAAoBpsC,EAAOqzC,sBACzCz+C,SACC8iC,EAAK70C,UAEF60C,EAAK70C,OAASupD,IACpB50C,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAOszC,mBAAmB1+C,UACrC4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,mBAAmBvO,KAAM,GAAIggB,MAAO1C,EAAMC,OAAOzG,cAGnD,EAoFXoM,MAAOlE,EAAO+yC,aACdnzC,8BAA8B,EAC9Bu0C,mBAnFe,WAAH,OACpBnwC,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOuzC,WAAW3+C,SAAA,EAC7B4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,iBAAiBvO,KAAM,GAAIggB,MAAO1C,EAAMC,OAAO/F,gBAAgBhB,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOwzC,eAAe5+C,SAAC,wBAAyB4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOyzC,kBAAkB7+C,SAAC,kCAC7K,EAiFCiL,0BAA0B,UAC1Bu0C,cAAe,SAAChyD,EAAM8+B,GAAK,MAAM,CAC/B1/B,OAAQ,GACRypC,OAAQ,GAAK/J,EACbA,MAAAA,EACD,EACDmzB,mBAAoB,GACpBC,oBAAqB,GACrBC,WAAY,YAMxB,E,+kBCxKA,IA2DMC,GAKD,SAAH9uD,GAAiBA,EAAX6hD,YAAgD,IAAnC+E,EAAS5mD,EAAT4mD,UAAWC,EAAS7mD,EAAT6mD,UAAWjuC,EAAK5Y,EAAL4Y,MACnCm2C,EAAe/yD,MAAM0R,KAAK,CAAE5R,OAAQ,KAAM,SAACmnC,EAAGt2B,GAElD,IAAMqiD,EAAYriD,EAAI,IAAM,EAAIi6C,EAAYC,EAG5C,OACE/0C,EAAAA,EAAAA,KAACse,GAAAA,QAAS3R,KAAI,CAEZD,MAAO,CACL,CACE5H,MAAO,EACP8D,gBAAiB9B,EAAMC,OAAOzG,QAC9ByJ,iBAAkB,EAClBtF,aAAc,KAEhB,CACEM,OAAQm4C,EAAU/9B,YAAY,CAC5BC,WAAY,CAAC,EAAG,GAChBC,YAAa,CAAC,EAAG,GAAqB,GAAhBrX,KAAKm1C,eAX5BtiD,EAiBX,IAEA,OACEmF,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAO,CACX1D,cAAe,MACfC,WAAY,SACZC,eAAgB,SAChBnE,OAAQ,GACRuL,eAAgBxJ,EAAMvC,QAAQb,IAC9BtG,SACC6/C,GAGP,EA+VMhwC,GAAY,SAACnG,GAAe,OAAK2B,EAAAA,QAAWxb,OAAO,CACvDyb,UAAW,CACTC,KAAM,EACNC,gBAAiB,eAInBw0C,OAAQ,CACNp0C,cAAe,MACfE,eAAgB,gBAChBD,WAAY,SACZa,kBAAmBhD,EAAMvC,QAAQX,GACjCiF,WAAY/B,EAAMvC,QAAQZ,GAC1BoE,cAAejB,EAAMvC,QAAQb,IAI/B25C,cAAe,CACbr0C,cAAe,MACfC,WAAY,SACZ6iB,IAAK,IAIPwxB,iBAAkB,CAChBh0C,SAAU,GACVC,WAAY,MACZC,MAAO1C,EAAMC,OAAOjG,KACpB0J,WAA4B,QAAhBziB,EAAAA,QAASC,GAAe,iBAAmB,UAIzDu1D,eAAgB,CACdp0C,QAAS,EACT1E,aAAc,GACdmE,gBAAiB9B,EAAMC,OAAOnG,QAC9BwO,YAAa,EACbD,YAAarI,EAAMC,OAAO9F,QAI5Bu8C,WAAY,CACVr0C,QAAS,EACT1E,aAAc,GACdmE,gBAAiB9B,EAAMC,OAAOnG,QAC9BwO,YAAa,EACbD,YAAarI,EAAMC,OAAO9F,QAI5Bw8C,yBAA0B,CACxBx0C,WAAY,SACZC,eAAgB,SAChBoH,eAAgBxJ,EAAMvC,QAAQX,IAIhC85C,OAAQ,CACN/0C,KAAM,GACNwE,UAAW,IAEbwwC,qBAAsB,CACpB74C,MAAO,IACPC,OAAQ,IACRN,aAAc,GACdmE,gBAAiB,0BACjBK,WAAY,SACZC,eAAgB,UAElB00C,gBAAiB,CACf94C,MAAO,GACPC,OAAQ,GACRN,aAAc,GACdwE,WAAY,SACZC,eAAgB,SAChBhE,UAAW,EACXN,YAAa,OACbC,aAAc,CAAEC,MAAO,EAAGC,OAAQ,GAClCC,cAAe,IACfC,aAAc,GAEhB44C,qBAAsB,CACpB50C,WAAY,SACZC,eAAgB,UAElB40C,SAAU,CACRh5C,MAAO,GACPC,OAAQ,GACR6D,gBAAiB,QACjBnE,aAAc,GAIhBs5C,oBAAqB,CACnBz0C,SAAU,GACVE,MAAO,UACPD,WAAY,MACZc,UAAWvD,EAAMvC,QAAQb,GACzBqH,UAAW,UAIbizC,eAActtD,GAAAA,GAAA,CACZkY,gBAAiB9B,EAAMC,OAAOlG,KAC9B4D,aAAcqC,EAAMrC,aAAaZ,GACjCkG,iBAAkBjD,EAAMvC,QAAQZ,GAChC0G,UAAWvD,EAAMvC,QAAQZ,GACzBmH,aAAchE,EAAMvC,QAAQX,IACzBkD,EAAMnC,QAAQhB,IAAE,IACnBwL,YAAarI,EAAMC,OAAO7F,YAC1BkO,YAAatI,EAAMb,WAAa,EAAI,EACpC0X,SAAU,SACVhV,KAAM,EACNwE,UAAW,MAEb8wC,iBAAkB,CAChBj1C,cAAe,MACfE,eAAgB,gBAChBD,WAAY,SACZa,kBAAmBhD,EAAMvC,QAAQX,GACjCiG,gBAAiB/C,EAAMvC,QAAQZ,GAC/BiF,gBAAiB9B,EAAMb,WAAaa,EAAMC,OAAOnE,QAAUkE,EAAMC,OAAO3E,OACxEgH,kBAAmB,EACnBC,kBAAmBvC,EAAMC,OAAO7F,aAElCg9C,yBAA0B,CACxBl1C,cAAe,MACfC,WAAY,UAEdk1C,gBAAiB,CACf70C,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC4F,WAAY,MACZC,MAAO1C,EAAMC,OAAOjG,KACpB0M,WAAY1G,EAAMvC,QAAQb,GAC1B8G,WAAY1D,EAAM7D,WAAWC,aAAaG,UAE5C+6C,gBAAiB,CACfx1C,gBAAiB9B,EAAMC,OAAOzG,QAC9BwJ,kBAAmBhD,EAAMvC,QAAQZ,GACjCkG,gBAAiB/C,EAAMvC,QAAQb,GAC/Be,aAAcqC,EAAMrC,aAAaC,MAEnC25C,wBAAyB,CACvBz1C,gBAAiB9B,EAAMC,OAAOxF,UAEhC+8C,oBAAqB,CACnB90C,MAAO1C,EAAMC,OAAOpF,UACpB2H,SAAUxC,EAAM7D,WAAWO,UAAUE,GACrC6F,WAAY,MACZiB,WAAY1D,EAAM7D,WAAWC,aAAaG,UAE5Ck7C,oBAAqB,CACnBj1C,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC6F,MAAO1C,EAAMC,OAAOjG,KACpBmnB,WAAYnhB,EAAM7D,WAAWgB,YAAYE,OAAS2C,EAAM7D,WAAWO,UAAUG,GAC7EwF,QAASrC,EAAMvC,QAAQX,GACvB+E,KAAM,EACN61C,kBAAmB,MACnBh0C,WAAY1D,EAAM7D,WAAWC,aAAaC,QAC1CyF,gBAAiB,eAInB61C,uBAAwB,CACtB35C,MAAO,OACPC,OAAQ,IACR6D,gBAAiB9B,EAAMC,OAAOnG,QAC9B6D,aAAc,GACd2K,YAAa,EACbD,YAAarI,EAAMC,OAAO9F,OAC1BoJ,UAAW,GACXoT,SAAU,YAEZihC,mBAAoB,CAClB/1C,KAAM,EACNW,SAAU,GACVE,MAAO1C,EAAMC,OAAOjG,KACpBmnB,WAAY,GACZ9e,QAAS,GACTq1C,kBAAmB,OAErBG,oBAAqB,CACnBh2C,KAAM,GAERi2C,qBAAsB,CACpBz1C,QAAS,GACTgE,UAAW,IAEb0xC,kBAAmB,CACjBv1C,SAAU,GACVE,MAAO1C,EAAMC,OAAOjG,KACpBmnB,WAAY,IAEd62B,mBAAoB,CAClBlE,UAAW,GACX9wC,kBAAmBhD,EAAMvC,QAAQX,GACjCmE,cAAejB,EAAMvC,QAAQb,IAE/Bq7C,oBAAqB,CACnBthC,SAAU,WACV+K,OAAQ1hB,EAAMvC,QAAQZ,GACtB+kB,MAAO5hB,EAAMvC,QAAQZ,IAIvBq7C,sBAAuB,CACrB30C,UAAWvD,EAAMvC,QAAQZ,GACzBkF,WAAY/B,EAAMvC,QAAQZ,GAC1BuH,eAAgB,EAChBC,eAAgBrE,EAAMC,OAAO7F,aAE/B+9C,kBAAmB,CACjB31C,SAAUxC,EAAM7D,WAAWO,UAAUE,GACrC6F,WAAY,MACZC,MAAO1C,EAAMC,OAAOhG,cACpB+J,aAAchE,EAAMvC,QAAQb,GAC5B8G,WAAY1D,EAAM7D,WAAWC,aAAaG,UAE5C67C,gBAAiB,CACfl2C,cAAe,MACfE,eAAgB,gBAChBD,WAAY,SACZY,gBAAiB/C,EAAMvC,QAAQb,GAC/BoG,kBAAmBhD,EAAMvC,QAAQZ,GACjCiF,gBAAiB9B,EAAMb,WAAaa,EAAMC,OAAOpE,QAAUmE,EAAMC,OAAO1E,QACxEoC,aAAcqC,EAAMrC,aAAad,GACjCmH,aAAchE,EAAMvC,QAAQd,GAC5B2L,YAAa,EACbD,YAAarI,EAAMC,OAAO7F,aAE5Bi+C,gBAAiB,CACf71C,SAAUxC,EAAM7D,WAAWO,UAAUE,GACrC8F,MAAO1C,EAAMC,OAAOjG,KACpB6H,KAAM,EACN6B,WAAY1D,EAAM7D,WAAWC,aAAaC,SAE5Ci8C,sBAAuB,CACrB91C,SAAUxC,EAAM7D,WAAWO,UAAUC,GACrC+F,MAAO1C,EAAMC,OAAOhG,cACpByM,WAAY1G,EAAMvC,QAAQb,GAC1B6F,WAAY,MACZiB,WAAY1D,EAAM7D,WAAWC,aAAaE,QAI5Ci8C,aAAc,CACZ12C,KAAM,EACNC,gBAAiB,qBACjBM,eAAgB,SAChBD,WAAY,UAEdkyC,aAAc,CACZvyC,gBAAiB9B,EAAMC,OAAOpG,WAC9B8D,aAAc,GACd0E,QAAS,GACTrE,MAAO,MACP81C,UAAW,OAEbhW,YAAa,CACX57B,cAAe,MACfE,eAAgB,gBAChBD,WAAY,SACZ6B,aAAc,IAEhBg6B,WAAY,CACVx7B,SAAU,GACVC,WAAY,OACZC,MAAO1C,EAAMC,OAAOjG,MAEtBw+C,iBAAkB,CAChBn2C,QAAS,IAEV,EAEH,SA/mB+D,SAAHra,GAyBrD,IAxBLolD,EAAkBplD,EAAlBolD,mBACAC,EAAqBrlD,EAArBqlD,sBACAC,EAAwBtlD,EAAxBslD,yBACAE,EAAqBxlD,EAArBwlD,sBACAE,EAAuB1lD,EAAvB0lD,wBACAE,EAAgB5lD,EAAhB4lD,iBACAE,EAAgB9lD,EAAhB8lD,iBAEAkD,GADYhpD,EAAZqmD,aACmBrmD,EAAnBgpD,qBAEAhD,GADShmD,EAAT2vB,UACS3vB,EAATgmD,WACAC,EAASjmD,EAATimD,UACAhF,EAAWjhD,EAAXihD,YACAE,EAAiBnhD,EAAjBmhD,kBACAI,EAAiBvhD,EAAjBuhD,kBACAuH,EAAc9oD,EAAd8oD,eACAlB,EAAsB5nD,EAAtB4nD,uBACAqB,EAAoBjpD,EAApBipD,qBACAC,EAAclpD,EAAdkpD,eACArD,EAAmB7lD,EAAnB6lD,oBACA4K,EAAezwD,EAAfywD,gBAEAC,GADO1wD,EAAPyc,QACezc,EAAf0wD,iBACAC,EAAsB3wD,EAAtB2wD,uBAEQ34C,EAAUG,KAAVH,MACF0B,EAASyE,GAAUnG,GACzBzJ,GAA0DC,EAAAA,EAAAA,WAAS,GAAMC,GAAAC,EAAAA,EAAAA,SAAAH,EAAA,GAAlEqiD,EAAsBniD,EAAA,GAAEoiD,EAAuBpiD,EAAA,GAChDqiD,GAAevhC,EAAAA,EAAAA,QAAO,IAAIC,GAAAA,QAASC,MAAM,IAAIC,SAGnDlgB,EAAAA,EAAAA,YAAU,WACR,GAAIyxC,EAAa,CACf,IAAM8P,EAAiBvhC,GAAAA,QAASM,KAC9BN,GAAAA,QAASO,SAAS,CAChBP,GAAAA,QAASQ,OAAO8gC,EAAc,CAC5B7gC,QAAS,IACT3Z,SAAU,IACViY,iBAAiB,IAEnBiB,GAAAA,QAASQ,OAAO8gC,EAAc,CAC5B7gC,QAAS,EACT3Z,SAAU,IACViY,iBAAiB,OAKvB,OADAwiC,EAAe7gC,QACR,kBAAM6gC,EAAe5gC,MAAO,CACrC,CACE2gC,EAAa7J,SAAS,EAE1B,GAAG,CAAChG,EAAa6P,IAGjB,IAAAjiD,GAAoCL,EAAAA,EAAAA,UAASkiD,GAAmB,IAAG5hD,GAAAJ,EAAAA,EAAAA,SAAAG,EAAA,GAA5DmiD,EAAUliD,EAAA,GAAEmiD,EAAaniD,EAAA,GAChCG,GAA0CT,EAAAA,EAAAA,WAAS,GAAMU,GAAAR,EAAAA,EAAAA,SAAAO,EAAA,GAAlDiiD,EAAahiD,EAAA,GAAEiiD,EAAgBjiD,EAAA,GAkChCkiD,EAA2BX,GAAmB,CAClDz+C,KAAM,OACNS,UAAWu2C,EACXqI,UAAU,GAINC,GAAkBn6B,EAAAA,EAAAA,cAAY,WAClC,GAAIw5B,GAA0BD,EAAiB,CAE7C,IAAIa,EACJ,GAAIL,EAEFK,EAAaP,MACR,CAEL,IAAIQ,EAAY,GAGZd,GAAmBA,EAAgBhxC,QACrC8xC,EAAU5qB,KAAK8pB,GAIbtL,EAAmBlqD,OAAS,GAC9Bs2D,EAAU5qB,KAAKwe,EAAmB7pD,KAAK,OAGzCg2D,EAAaC,EAAUj2D,KAAK,OAC9B,CAEAo1D,EAAuBY,GAGvBN,EAAcM,GACdJ,GAAiB,GAEjB9L,EAAsB,GACxB,KAAO,CAEL,IAAMoM,EAAoBrM,EAAmB7pD,KAAK,MAAMmkB,OACpD+xC,IACF7J,IAEAqJ,EAAcQ,GACdN,GAAiB,GAEjB9L,EAAsB,IAE1B,CACF,GAAG,CAACsL,EAAwBD,EAAiBM,EAAYE,EAAe9L,EAAoBwC,EAAwBvC,IAgBpH,OACE3nC,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOE,UAAUtL,SAAA,EAE5BoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAO40C,OAAOhgD,SAAA,EAEzB4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO80C,iBAAiBlgD,SAClC46C,EAAe/H,MAIlBzjC,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAO60C,cAAcjgD,SAAA,EAEhC4C,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CACfF,MAAOlE,EAAO+0C,eACd1wC,QAAS,WAAF,OAAQ8yC,GAAwB,EAAK,EAC5Cp+C,SAAUwuC,EAAY3yC,UAEtB4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CACP/U,KAAK,WACLvO,KAAM,GACNggB,MAAOumC,EAAcjpC,EAAMC,OAAOxF,SAAWuF,EAAMC,OAAOzG,aAK9DN,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CACfF,MAAOlE,EAAOg1C,WACd3wC,QAAS,WAAF,OAAQ8yC,GAAwB,EAAK,EAC5Cp+C,SAAUwuC,EAAY3yC,UAEtB4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CACP/U,KAAK,cACLvO,KAAM,GACNggB,MAAOumC,EAAcjpC,EAAMC,OAAOxF,SAAWuF,EAAMC,OAAOhG,yBAOlEf,EAAAA,EAAAA,KAACg9C,GAAqB,CACpBjN,YAAaA,EACb+E,UAAWA,EACXC,UAAWA,EACXjuC,MAAOA,KAIT9G,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAOi1C,yBAAyBrgD,UAC3C4C,EAAAA,EAAAA,KAACse,GAAAA,QAAS3R,KAAI,CAACD,MAAO,CACpBlE,EAAOm1C,qBACP,CAAEr+B,UAAW,CAAC,CAAEC,MAAOqgC,MACvBxiD,UACA4C,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CACfF,MAAO,CACLlE,EAAOo1C,gBACP,CAAEh1C,gBAAiBmnC,EAAc,UAAYjpC,EAAMC,OAAOzG,UAE5DuM,QAAS+qC,EACTr2C,UAAW8uC,EAAkBjzC,UAE7B4C,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAOq1C,qBAAqBzgD,SACtC2yC,GACC/vC,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAOs1C,YAEpB99C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,MAAMvO,KAAM,GAAIggB,MAAM,mBAQ/CxJ,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOu1C,oBAAoB3gD,SACrC2yC,EAAc,wBAA0B,qBAI3C/vC,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAOk1C,UAGpBlxC,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOw1C,eAAe5gD,SAAA,EAEjCoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOy1C,iBAAiB7gD,SAAA,EACnCoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAO01C,yBAAyB9gD,SAAA,EAC3C4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,gBAAgBvO,KAAM,GAAIggB,MAAO1C,EAAMC,OAAOzG,WAC7DN,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO21C,gBAAgB/gD,SAAC,mBAGvC4C,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CACfF,MAAO,CACLlE,EAAO41C,gBACP8B,EAAyB3+C,UAAYiH,EAAO61C,yBAE9CxxC,QAASuzC,EACT7+C,SAAU2+C,EAAyB3+C,SAASnE,SAE3C8iD,EAAyBC,UACxBngD,EAAAA,EAAAA,KAACgN,GAAAA,QAAiB,CAACxjB,KAAK,QAAQggB,MAAM,WAEtCxJ,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO81C,oBAAoBlhD,SAAC,eAM/C4C,EAAAA,EAAAA,KAACmS,GAAAA,QAAS,CACRzF,MAAOlE,EAAO+1C,oBACd31D,MA7Me,WAErB,GAAIo3D,EACF,OAAOF,EAIT,IAAIU,EAAe,GAoBnB,OAjBIhB,GAAmBA,EAAgBhxC,QACrCgyC,EAAa9qB,KAAK8pB,GAIhBtL,EAAmBlqD,OAAS,GAC9Bw2D,EAAa9qB,KAAKwe,EAAmB7pD,KAAK,OAIxCiqD,GACAF,GACAA,EAAyB5lC,QACI,kBAA7B4lC,GACFoM,EAAa9qB,KAAK0e,GAGboM,EAAan2D,KAAK,OAC3B,CAiLeo2D,GACPpuC,aAAc,SAACvR,GAERwzC,IACHyL,EAAcj/C,GACdm/C,GAAiB,GAErB,EACAS,WAAS,EACTtuC,YAAakiC,EAAwB,sBAAyBvE,EAAc,eAAiB,wCAC7Ft9B,qBAAsB3L,EAAMC,OAAOhG,cACnCy9C,kBAAkB,MAClBmC,UAAWrM,IAGZA,IACCt0C,EAAAA,EAAAA,KAACgN,GAAAA,QAAiB,CAChBxjB,KAAK,QACLggB,MAAO1C,EAAMC,OAAOzG,QACpBoM,MAAOlE,EAAOu2C,sBAKjBrK,IAA2C,MAAvBF,OAAuB,EAAvBA,EAAyB3G,eAAgB2G,EAAwB3G,aAAa7jD,OAAS,IAC1GgW,EAAAA,EAAAA,KAACmI,GAAAA,QAAU,CAACuE,MAAOlE,EAAOs2C,mBAAoB12C,8BAA8B,EAAMhL,UAChFoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOw2C,sBAAsB5hD,SAAA,EACxC4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOy2C,kBAAkB7hD,SAAC,gCACtCo3C,EAAwB3G,aAAatqB,KAAI,SAACq9B,EAAal3B,GAAK,OAC3Dld,EAAAA,EAAAA,MAACI,GAAAA,QAAgB,CAEfF,MAAOlE,EAAO02C,gBACdryC,QAAS,WACH+zC,EAAYvU,YAAcuU,EAAYvU,WAAW79B,SACnD2lC,EAAsB,CAACyM,EAAYvU,aACnCsI,GAAoB,GAExB,EAAEv3C,SAAA,EAEF4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO22C,gBAAgB/hD,SAAEwjD,EAAYvU,kBACtB3gD,IAA3Bk1D,EAAYhT,aACXphC,EAAAA,EAAAA,MAACO,EAAAA,QAAI,CAACL,MAAOlE,EAAO42C,sBAAsBhiD,SAAA,CACvC4K,KAAK64C,MAA+B,IAAzBD,EAAYhT,YAAkB,SAZzClkB,EAeY,aAQ7B1pB,EAAAA,EAAAA,KAACoM,GAAAA,QAAK,CACJC,cAAc,QACdC,aAAa,EACbhB,QAASo0C,EACTnzC,eAAgB,WAAF,OAAQozC,GAAwB,EAAM,EAACviD,UAErD4C,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAO62C,aAAajiD,UAC/BoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAO2yC,aAAa/9C,SAAA,EAC/BoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOo8B,YAAYxnC,SAAA,EAC9B4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOs8B,WAAW1nC,SAAC,qBAChC4C,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CACfF,MAAOlE,EAAO82C,iBACdzyC,QAAS,WAAF,OAAQ8yC,GAAwB,EAAM,EAACviD,UAE9C4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,QAAQvO,KAAM,GAAIggB,MAAO1C,EAAMC,OAAOjG,aAGzDd,EAAAA,EAAAA,KAAC8gD,GAAgB,CACflM,iBAAkBA,EAClBsH,iBAAkB,SAAC9kC,GACjB2gC,EAAqB3gC,GACrBuoC,GAAwB,EAC1B,aAOd,ECldA,IAWMoB,GAAmB,SAAChU,GACxBvlD,EAAOqE,KAAK,6CAA6CkhD,EAC3D,EAoIMvkC,GAASC,EAAAA,QAAWxb,OAAO,CAC/Byb,UAAW,CACTC,KAAM,KAIV,SAzHoD,SAAHza,GAa1C,IAZL8yD,EAAM9yD,EAAN8yD,OACAC,EAAY/yD,EAAZ+yD,aACAnN,EAAuB5lD,EAAvB4lD,wBACAC,EAAQ7lD,EAAR6lD,SACAE,EAAU/lD,EAAV+lD,WACAiN,EAAahzD,EAAbgzD,cACAC,EAAiBjzD,EAAjBizD,kBAAiBC,EAAAlzD,EACjBmzD,wBAAAA,OAAuB,IAAAD,GAAQA,EAChBE,GAAApzD,EAAfqxD,gBAAerxD,EACfqzD,uBAAAA,OAAqB,IAAAD,GAAOA,EAC5B9B,EAAetxD,EAAfsxD,gBACAC,EAAsBvxD,EAAtBuxD,uBAqDM+B,IAnCiBv7B,EAAAA,EAAAA,aAAY,WAAD,IAAAn3B,GAAAhG,EAAAA,EAAAA,UAChC,UAAOqnD,EAAkBkM,GACvB,IACE,IAAM9lD,QAAeugD,GAAoBC,gBAAgB5G,EAAU,CACjElF,cAAe,CAACoR,GAChB/Q,0BAA0B,IAE5B,IAAK/0C,EAEH,OADAwqD,GAAiB5Q,GACV,KAET,IAAQ9D,EAAoC91C,EAApC81C,WAAYiC,EAAwB/3C,EAAxB+3C,oBAGpB,OAAuB,MAAnBA,GAAAA,EAAqBtU,OACvBxyC,EAAOqE,KAAK,+BAA+ByiD,EAAoBp6C,QAAO,KAAKo6C,EAAoBjU,OAAM,KAErG7yC,EAAOqE,KAAK,6EACZk1D,GAAiB5Q,GACA,MAAjBgR,GAAAA,IACO,OAhFmB,SAAC5qD,GACnC,IAIgC04C,EAJ1BG,EAAkB,GACpB74C,EAAOq3C,WAAa,KACtBwB,EAAgB1Z,KAAK,iCAEnBn/B,EAAO+3C,qBACTc,EAAgB1Z,KAAK,yBAAiD,OAAlDuZ,EAAyB14C,EAAOkrD,yBAAkB,EAAzBxS,EAA2B/6C,SAG5E,CA0EQwtD,CAA4BnrD,GAC5BwqD,GAAiB5Q,GACV,CAAErvC,KAAMurC,GACjB,CAAE,MAAO5iD,GAGP,OAFAjC,EAAOiC,MAAM,4CAA6CA,GAC1Ds3D,GAAiB5Q,GACV,IACT,CACF,IAAC,gBAAA7kD,EAAAC,GAAA,OAAAuD,EAAApF,MAAA,KAAAC,UAAA,EA/BgC,GAgCjC,CAACw3D,IAGWtN,GAAsB,CAClCC,wBApDkC,SAAChzC,EAAcqvC,EAAmBiG,EAAkCxI,GACtGpmD,EAAOqE,KAAK,sDACW,MAAvBioD,GAAAA,EAA0BhzC,GACpB,MAANkgD,GAAAA,EAASlgD,EACX,EAiDEizC,SA/CmB,WACnBvsD,EAAOqE,KAAK,oCACJ,MAARkoD,GAAAA,GACF,EA6CEE,WA3CqB,SAACnzC,GACtBtZ,EAAOqE,KAAK,sCACF,MAAVooD,GAAAA,EAAanzC,EACf,EAyCEyuC,UAAWgS,IAA0BF,MAGvC/iD,EAAAA,EAAAA,YAAU,WACK,MAAb4iD,GAAAA,EAAgBM,EAAMzR,YAAc,YAAc,OACpD,GAAG,CAACyR,EAAMzR,YAAamR,IAEvB,IAAMS,GAAmB17B,EAAAA,EAAAA,cAAY,WACnC,IAAM0wB,EAAiB6K,EAAMtN,mBAAmB7pD,KAAK,MAAMmkB,OACvDmoC,IACU,MAAZsK,GAAAA,EAAetK,GACT,MAANqK,GAAAA,EAASrK,GAEb,GAAG,CAAC6K,EAAMtN,mBAAoB+M,EAAcD,IAE5C,OACEhhD,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,GAAOE,UAAUtL,UAC5B4C,EAAAA,EAAAA,KAAC4hD,GAAe,CACd7R,YAAayR,EAAMzR,YACnBmE,mBAAoBsN,EAAMtN,mBAC1BC,sBAAuBqN,EAAMrN,sBAC7BC,yBAA0BoN,EAAMpN,yBAChCE,sBAAuBkN,EAAMlN,sBAC7BE,wBAAyBgN,EAAMhN,wBAC/BE,iBAAkB8M,EAAM9M,iBACxBC,oBAAqB6M,EAAM7M,oBAC3BC,iBAAkB4M,EAAM5M,iBACxBO,aAAcqM,EAAMrM,aACpB2C,oBAAqB0J,EAAM1J,oBAC3Br5B,UAAW+iC,EAAM/iC,UACjBq2B,UAAW0M,EAAM1M,UACjBC,UAAWyM,EAAMzM,UACjB9E,kBAAmBuR,EAAMvR,kBACzBI,kBAAmBmR,EAAMnR,kBACzBuH,eAAgB4J,EAAM5J,eACtBlB,uBAAwBiL,EACxB5J,qBAAsByJ,EAAMzJ,qBAC5BC,eAAgBwJ,EAAMxJ,eACtBzsC,QAASwoC,EACTyL,gBAAiBA,EACjBC,uBAAwBA,KAIhC,E,+kBC/HA,IAAMpiC,GAAkC,QAAhBt1B,EAAAA,QAASC,GAiHpB65D,GAGR,SAAH/yD,GAAiC,IAA3BgzD,EAAUhzD,EAAVgzD,WAAYj1C,EAAO/d,EAAP+d,QACV/F,EAAUG,KAAVH,MACF0B,EAASyE,GAAUnG,GAEzBnJ,GAAoBL,EAAAA,EAAAA,UAAS,IAAIghB,GAAAA,QAASC,MAAM,IAAzCE,GAA4CjhB,EAAAA,EAAAA,SAAAG,EAAA,GAAnC,GAwBhB,IAtBAW,EAAAA,EAAAA,YAAU,WACR,GAAIwjD,EAAW93D,OAAS,EAAG,CACzB,IAAM20B,EAAQL,GAAAA,QAASM,KACrBN,GAAAA,QAASO,SAAS,CAChBP,GAAAA,QAASQ,OAAOL,EAAW,CACzBM,QAAS,IACT3Z,SAAU,KACViY,gBAAAA,KAEFiB,GAAAA,QAASQ,OAAOL,EAAW,CACzBM,QAAS,EACT3Z,SAAU,KACViY,gBAAAA,QAMN,OAFAsB,EAAMK,QAEC,kBAAML,EAAMM,MAAO,CAC5B,CACF,GAAG,CAAC6iC,EAAW93D,OAAQy0B,KAElBksB,MAAgD,IAAtBmX,EAAW93D,OACxC,OAAO,KAGT,IAAM+3D,EAAaD,EAAW,GAE9B,OACE9hD,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CACfF,MAAOlE,EAAOw5C,kBACdn1C,QAASA,EACTmT,cAAe,GAAI5iB,UAEnBoP,EAAAA,EAAAA,MAAC8R,GAAAA,QAAS3R,KAAI,CAACD,MAAO,CACpBlE,EAAOy5C,kBACP,CAAEr5C,gBAAiBm5C,EAAWG,WAC9B,CAAE5iC,UAAW,CAAC,CAAEC,MAAOd,MACvBrhB,SAAA,EACA4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,mBAAmBvO,KAAM,GAAIggB,MAAO1C,EAAMC,OAAOpG,aAC/DmhD,EAAW93D,OAAS,IACnBgW,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAO25C,cAAc/kD,UAChC4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO45C,kBAAkBhlD,SAAE0kD,EAAW93D,eAM/D,EAEMijB,GAAY,SAACnG,GAAe,OAAK2B,EAAAA,QAAWxb,OAAO,CACvDyb,UAAW,CACT4H,eAAgBxJ,EAAMvC,QAAQd,IAEhC4+C,UAAS3xD,GAAA,CACPsY,cAAe,MACfC,WAAY,SACZL,gBAAiB9B,EAAMC,OAAOlG,KAC9B4D,aAAc,GACd0E,QAASrC,EAAMvC,QAAQZ,GACvByL,YAAa,EACbD,YAAarI,EAAMC,OAAOzG,SACvBwG,EAAMnC,QAAQjB,IAEnB4+C,SAAU,CACRx9C,MAAO,EACPC,OAAQ,EACRN,aAAc,EACdwL,YAAanJ,EAAMvC,QAAQb,IAE7B5R,QAAS,CACP6W,KAAM,GAERI,OAAQ,CACNC,cAAe,MACfC,WAAY,SACZ6B,aAAc,GAEhBjZ,MAAO,CACLyX,SAAUxC,EAAM7D,WAAWO,UAAUE,GACrC6F,WAAY,MACZC,MAAO1C,EAAMC,OAAOzG,QACpBkK,WAAY1D,EAAM7D,WAAWC,aAAaG,SAC1CmK,WAAY,GAEdtZ,QAAS,CACPoV,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC4F,WAAY,MACZC,MAAO1C,EAAMC,OAAOjG,KACpB0J,WAAY1D,EAAM7D,WAAWC,aAAaE,OAC1C0H,aAAc,GAEhByE,SAAU,CACRjG,SAAUxC,EAAM7D,WAAWO,UAAUC,GACrC+F,MAAO1C,EAAMC,OAAOhG,cACpByJ,WAAY1D,EAAM7D,WAAWC,aAAaC,SAE5Co/C,iBAAkB,CAChB9kC,SAAU,YAEZ+kC,iBAAgB9xD,GAAA,CACdoU,MAAO,GACPC,OAAQ,GACRN,aAAc,GACdyE,eAAgB,SAChBD,WAAY,UACTnC,EAAMnC,QAAQjB,IAEnB++C,kBAAmB,CACjBhlC,SAAU,WACVilC,KAAM,EACNh6B,OAAQ,EACR9f,gBAAiB9B,EAAMC,OAAOtd,MAC9Bgb,aAAc,EACdk+C,SAAU,GACV59C,OAAQ,GACRmE,eAAgB,SAChBD,WAAY,SACZa,kBAAmB,GAErB84C,iBAAkB,CAChBt5C,SAAU,GACVC,WAAY,OACZC,MAAO1C,EAAMC,OAAOpG,WACpB6J,WAAY1D,EAAM7D,WAAWC,aAAaI,MAE5C0+C,kBAAmB,CACjBvkC,SAAU,WACVilC,IAAK57C,EAAMvC,QAAQX,GACnB8kB,MAAO5hB,EAAMvC,QAAQX,GACrB+uB,OAAQ,KAEVsvB,kBAAiBvxD,GAAAA,GAAA,CACfoU,MAAO,GACPC,OAAQ,GACRN,aAAc,GACdyE,eAAgB,SAChBD,WAAY,UACTnC,EAAMnC,QAAQf,IAAE,IACnB6Z,SAAU,aAEZ0kC,cAAe,CACb1kC,SAAU,WACVilC,KAAM,EACNh6B,OAAQ,EACR9f,gBAAiB9B,EAAMC,OAAOpG,WAC9B8D,aAAc,GACdk+C,SAAU,GACV59C,OAAQ,GACRmE,eAAgB,SAChBD,WAAY,SACZa,kBAAmB,EACnBsF,YAAa,EACbD,YAAarI,EAAMC,OAAOzG,SAE5B8hD,kBAAmB,CACjB94C,SAAU,GACVC,WAAY,OACZC,MAAO1C,EAAMC,OAAOzG,QACpBkK,WAAY1D,EAAM7D,WAAWC,aAAaI,OAE3C,E,eClRGu/C,GAAuB,oBAAAA,KAAAl7D,EAAAA,EAAAA,SAAA,KAAAk7D,GAAA,KAWnBC,WAAqC,IAAI1oD,IAAM,KAC/C2oD,cAAmC,IAAK,CAAD,OAAAt7D,EAAAA,EAAAA,SAAAo7D,EAAA,EAAAl6D,IAAA,gBAAAC,MAAA,eAAAo6D,GAAAl6D,EAAAA,EAAAA,UAK/C,UAA4BH,GAC1B,MAAoB,QAAhBZ,EAAAA,QAASC,GACJsG,EAAAA,QAAaC,QAAQ5F,GAErBs6D,GAAYC,aAAav6D,EAEpC,IAN2B,OAM1B,SAN0B2C,GAAA,OAAA03D,EAAAt5D,MAAC,KAADC,UAAA,EALoB,IAKpB,CAAAhB,IAAA,gBAAAC,MAAA,eAAAu6D,GAAAr6D,EAAAA,EAAAA,UAW3B,UACEH,EACAC,EACA+8C,GAEoB,QAAhB59C,EAAAA,QAASC,SACLsG,EAAAA,QAAagC,QAAQ3H,EAAKC,SAE1Bq6D,GAAYG,aAAaz6D,EAAKC,EAAO+8C,EAE/C,IAV2B,OAU1B,SAV0Bp6C,EAAAC,EAAAiJ,GAAA,OAAA0uD,EAAAz5D,MAAC,KAADC,UAAA,EAXA,IAWA,CAAAhB,IAAA,mBAAAC,MAAA,eAAAy6D,GAAAv6D,EAAAA,EAAAA,UAe3B,UAA+BH,GACT,QAAhBZ,EAAAA,QAASC,SACLsG,EAAAA,QAAa8C,WAAWzI,SAExBs6D,GAAYK,gBAAgB36D,EAEtC,IAN8B,OAM7B,SAN6B+L,GAAA,OAAA2uD,EAAA35D,MAAC,KAADC,UAAA,EAfH,IAeG,CAAAhB,IAAA,uBAAAC,MAW9B,WACE,MAAyB,qBAAX6T,QACkB,qBAAlBA,OAAOC,QACqB,oBAA5BD,OAAOC,OAAOX,SAC9B,GAAC,CAAApT,IAAA,2BAAAC,MAAA,eAAA26D,GAAAz6D,EAAAA,EAAAA,UAKD,YACE,MAAoB,QAAhBf,EAAAA,QAASC,IAGJi7D,GAAYO,kBAEvB,IANsC,OAMrC,WANqC,OAAAD,EAAA75D,MAAC,KAADC,UAAA,EALrC,IAKqC,CAAAhB,IAAA,mBAAAC,MAAA,eAAA66D,GAAA36D,EAAAA,EAAAA,UAWtC,YACE,GAAIjB,KAAKk7D,cACP,OAAOl7D,KAAKk7D,cAGd,IACE,IAAMW,QAAsB77D,KAAK87D,cAAcd,EAAwBe,aAEvE,OAAIF,GACF77D,KAAKk7D,cAAgBl7D,KAAKg8D,cAAcH,GACjC77D,KAAKk7D,gBAIdl7D,KAAKk7D,cAAgBtmD,OAAO+jB,gBAAgB,IAAI5lB,WAAWioD,EAAwBpiC,oBAE7E54B,KAAKi8D,cACTjB,EAAwBe,YACxB/7D,KAAKk8D,cAAcl8D,KAAKk7D,eACxB,CACEiB,uBAAuB,EACvBC,qBAAsB,6CAI1Bz8D,EAAOqE,KAAK,+CACLhE,KAAKk7D,cACd,CAAE,MAAOt5D,GAEP,MADAjC,EAAOiC,MAAM,gCAAiCA,GACxC,IAAI2B,MAAM,sCAClB,CACF,IA/B8B,OA+B7B,WA/B6B,OAAAq4D,EAAA/5D,MAAC,KAADC,UAAA,EAXQ,IAWR,CAAAhB,IAAA,sBAAAC,MAAA,eAAAs7D,GAAAp7D,EAAAA,EAAAA,UAoC9B,UAA0BwvC,EAAeD,GACvC,IAAKxwC,KAAKk5B,uBACR,MAAM,IAAI31B,MAAM,gCAGlB,IAEE,IAAM23D,QAAsBl7D,KAAKs8D,mBAI3BC,GADU,IAAIrnD,aACQC,OAAOq7B,GAG7BgsB,EAAsB,IAAIzpD,WAAWwpD,EAAYp6D,OAAS+4D,EAAc/4D,QAC9Eq6D,EAAoBroD,IAAIooD,EAAa,GACrCC,EAAoBroD,IAAI+mD,EAAeqB,EAAYp6D,QAGnD,IAAMq3B,QAAoB5kB,OAAOC,OAAOC,UACtC,MACA0nD,EACA,UACA,EACA,CAAC,cAIGC,EAAa7nD,OAAO+jB,gBAAgB,IAAI5lB,WAAWioD,EAAwBpiC,cAG3E8jC,QAAkB9nD,OAAOC,OAAOX,UACpC,CACEhE,KAAM,SACN5F,KAAMmyD,EACNpjC,WAAY2hC,EAAwB1hC,mBACpCrkB,KAAM,WAERukB,EACA,CACEtpB,KAAM8qD,EAAwBrhC,UAC9Bx3B,OAAQ64D,EAAwBphC,aAElC,EACA,CAAC,UAAW,UAAW,UAAW,cAIpC55B,KAAKi7D,WAAW9mD,IAAIs8B,EAAOisB,GAG3B,IAAMC,EAA+B,CACnClsB,MAAOA,EACPgsB,WAAYz8D,KAAKk8D,cAAcO,GAC/BpjC,WAAY2hC,EAAwB1hC,mBACpCia,UAAW5wC,KAAKorB,OASlB,aANM/tB,KAAK48D,kBAAkBD,GAG7BH,EAAoBhoD,KAAK,GAEzB7U,EAAOqE,KAAK,0CAA0CysC,IAC/C,CAET,CAAE,MAAO7uC,GAEP,OADAjC,EAAOiC,MAAM,2CAA2C6uC,EAAK,IAAK7uC,IAC3D,CACT,CACF,IAtEyB,OAsExB,SAtEwBoL,EAAA+C,GAAA,OAAAssD,EAAAx6D,MAAC,KAADC,UAAA,EApCK,IAoCL,CAAAhB,IAAA,gBAAAC,MAAA,eAAA87D,GAAA57D,EAAAA,EAAAA,UA2EzB,UAAoBwvC,EAAeD,GACjC,IAAKxwC,KAAKk5B,uBACR,MAAM,IAAI31B,MAAM,gCAGlB,IAEE,IAAMo5D,QAAsB38D,KAAK88D,iBAAiBrsB,GAClD,IAAKksB,EAEH,OADAh9D,EAAOsC,KAAK,qCAAqCwuC,IAC1C,EAIT,IAAMyqB,QAAsBl7D,KAAKs8D,mBAI3BC,GADU,IAAIrnD,aACQC,OAAOq7B,GAE7BgsB,EAAsB,IAAIzpD,WAAWwpD,EAAYp6D,OAAS+4D,EAAc/4D,QAC9Eq6D,EAAoBroD,IAAIooD,EAAa,GACrCC,EAAoBroD,IAAI+mD,EAAeqB,EAAYp6D,QAEnD,IAAMq3B,QAAoB5kB,OAAOC,OAAOC,UACtC,MACA0nD,EACA,UACA,EACA,CAAC,cAGGC,EAAaz8D,KAAKg8D,cAAcW,EAAcF,YAE9CC,QAAkB9nD,OAAOC,OAAOX,UACpC,CACEhE,KAAM,SACN5F,KAAMmyD,EACNpjC,WAAYsjC,EAActjC,WAC1BpkB,KAAM,WAERukB,EACA,CACEtpB,KAAM8qD,EAAwBrhC,UAC9Bx3B,OAAQ64D,EAAwBphC,aAElC,EACA,CAAC,UAAW,UAAW,UAAW,cAUpC,OANA55B,KAAKi7D,WAAW9mD,IAAIs8B,EAAOisB,GAG3BF,EAAoBhoD,KAAK,GAEzB7U,EAAOqE,KAAK,qCAAqCysC,IAC1C,CAET,CAAE,MAAO7uC,GAEP,OADAjC,EAAOiC,MAAM,qCAAqC6uC,EAAK,IAAK7uC,IACrD,CACT,CACF,IA/DmB,OA+DlB,SA/DkBoO,EAAAU,GAAA,OAAAmsD,EAAAh7D,MAAC,KAADC,UAAA,EA3EM,IA2EN,CAAAhB,IAAA,+BAAAC,MAAA,eAAAg8D,GAAA97D,EAAAA,EAAAA,UAoEnB,UAAmCgJ,EAAiBwmC,GAClD,IAAMisB,EAAY18D,KAAKi7D,WAAWtxD,IAAI8mC,GACtC,IAAKisB,EACH,MAAM,IAAIn5D,MAAM,yCAAyCktC,GAG3D,OAAOzwC,KAAKg9D,eAAe/yD,EAASyyD,EACtC,IAPkC,OAOjC,SAPiC/rD,EAAAC,GAAA,OAAAmsD,EAAAl7D,MAAC,KAADC,UAAA,EApEf,IAoEe,CAAAhB,IAAA,+BAAAC,MAAA,eAAAk8D,GAAAh8D,EAAAA,EAAAA,UAYlC,UAAmCi8D,EAAgCzsB,GACjE,IAAMisB,EAAY18D,KAAKi7D,WAAWtxD,IAAI8mC,GACtC,IAAKisB,EACH,MAAM,IAAIn5D,MAAM,yCAAyCktC,GAG3D,OAAOzwC,KAAKm9D,eAAeD,EAAgBR,EAC7C,IAPkC,OAOjC,SAPiCnrD,EAAAC,GAAA,OAAAyrD,EAAAp7D,MAAC,KAADC,UAAA,EAZA,IAYA,CAAAhB,IAAA,oBAAAC,MAYlC,SAAkB0vC,GAChB,OAAOzwC,KAAKi7D,WAAWjnD,IAAIy8B,EAC7B,GAAC,CAAA3vC,IAAA,kBAAAC,MAKD,SAAgB0vC,GACdzwC,KAAKi7D,WAAW32D,OAAOmsC,GACvB9wC,EAAOqE,KAAK,uCAAuCysC,EACrD,GAAC,CAAA3vC,IAAA,8BAAAC,MAAA,eAAAq8D,GAAAn8D,EAAAA,EAAAA,UAKD,UAAkCwvC,GAChC,IAEEzwC,KAAKi7D,WAAW32D,OAAOmsC,SAGjBzwC,KAAKq9D,oBAAoB5sB,GAE/B9wC,EAAOqE,KAAK,6CAA6CysC,EAC3D,CAAE,MAAO7uC,GAEP,MADAjC,EAAOiC,MAAM,6CAA6C6uC,EAAK,IAAK7uC,GAC9DA,CACR,CACF,IAbiC,OAahC,SAbgCy6B,GAAA,OAAA+gC,EAAAv7D,MAAC,KAADC,UAAA,EALhC,IAKgC,CAAAhB,IAAA,qBAAAC,MAAA,eAAAu8D,GAAAr8D,EAAAA,EAAAA,UAkBjC,YACE,IAEEjB,KAAKi7D,WAAW1nD,QAGhBvT,KAAKk7D,cAAgB,WAGfl7D,KAAKu9D,iBAAiBvC,EAAwBe,mBAC9C/7D,KAAKu9D,iBAAiBvC,EAAwBwC,kBAEpD79D,EAAOqE,KAAK,uCACd,CAAE,MAAOpC,GAEP,MADAjC,EAAOiC,MAAM,uCAAwCA,GAC/CA,CACR,CACF,IAjBwB,OAiBvB,WAjBuB,OAAA07D,EAAAz7D,MAAC,KAADC,UAAA,EAlBS,IAkBT,CAAAhB,IAAA,iBAAAC,MAAA,eAAA08D,GAAAx8D,EAAAA,EAAAA,UAsBxB,UAA6BgJ,EAAiBoK,GAC5C,IAEE,IAAMimB,QAAiB1lB,OAAOC,OAAOqlB,YACnC,CACEhqB,KAAM8qD,EAAwBrhC,UAC9Bx3B,OAAQ64D,EAAwBphC,aAElC,EACA,CAAC,UAAW,YAIR8jC,EAAY9oD,OAAO+jB,gBAAgB,IAAI5lB,WAAWioD,EAAwBpiC,cAC1ExuB,EAAKwK,OAAO+jB,gBAAgB,IAAI5lB,WAAWioD,EAAwBlgC,YACnElwB,EAASgK,OAAO+jB,gBAAgB,IAAI5lB,WAAWioD,EAAwBlgC,YAGvEvB,EAAU,IAAIrkB,YACdqmB,QAAyB3mB,OAAOC,OAAO4lB,QAC3C,CACEvqB,KAAM8qD,EAAwBrhC,UAC9BvvB,GAAIA,GAENkwB,EACAf,EAAQpkB,OAAOlL,IAIXuxB,QAAmB5mB,OAAOC,OAAO8oD,QACrC,MACArjC,EACAjmB,EACA,CACEnE,KAAM8qD,EAAwBrhC,UAC9BvvB,GAAIQ,IAIR,MAAO,CACL2wB,iBAAkBv7B,KAAKk8D,cAAc,IAAInpD,WAAWwoB,IACpDqiC,aAAc59D,KAAKk8D,cAAc,IAAInpD,WAAWyoB,IAChDpxB,GAAIpK,KAAKk8D,cAAc9xD,GACvBE,KAAMtK,KAAKk8D,cAAcwB,GACzBhzD,UAAWswD,EAAwBrhC,UACnC/uB,OAAQ5K,KAAKk8D,cAActxD,GAG/B,CAAE,MAAOhJ,GAEP,MADAjC,EAAOiC,MAAM,2BAA4BA,GACnC,IAAI2B,MAAM,oBAClB,CACF,IApD4B,OAoD3B,SApD2B8tC,EAAAC,GAAA,OAAAmsB,EAAA57D,MAAC,KAADC,UAAA,EAtBJ,IAsBI,CAAAhB,IAAA,iBAAAC,MAAA,eAAA88D,GAAA58D,EAAAA,EAAAA,UAyD5B,UAA6Bi8D,EAAgCY,GAC3D,IAEE,IAAMviC,EAAmBv7B,KAAKg8D,cAAckB,EAAe3hC,kBACrDqiC,EAAe59D,KAAKg8D,cAAckB,EAAeU,cACjDxzD,EAAKpK,KAAKg8D,cAAckB,EAAe9yD,IACvCQ,EAAS5K,KAAKg8D,cAAckB,EAAetyD,QAG3C0vB,QAAiB1lB,OAAOC,OAAOkpD,UACnC,MACAH,EACAE,EACA,CACE5tD,KAAM8qD,EAAwBrhC,UAC9BvvB,GAAIQ,GAEN,CACEsF,KAAM8qD,EAAwBrhC,UAC9Bx3B,OAAQ64D,EAAwBphC,aAElC,EACA,CAAC,YAIGoC,QAAyBpnB,OAAOC,OAAOknB,QAC3C,CACE7rB,KAAM8qD,EAAwBrhC,UAC9BvvB,GAAIA,GAENkwB,EACAiB,GAKF,OADgB,IAAIU,aACLC,OAAOF,EAExB,CAAE,MAAOp6B,GAEP,MADAjC,EAAOiC,MAAM,2BAA4BA,GACnC,IAAI2B,MAAM,uDAClB,CACF,IA3C4B,OA2C3B,SA3C2By6D,EAAAC,GAAA,OAAAJ,EAAAh8D,MAAC,KAADC,UAAA,EAzDA,IAyDA,CAAAhB,IAAA,oBAAAC,MAAA,eAAAm9D,GAAAj9D,EAAAA,EAAAA,UAgD5B,UAAgC07D,GAC9B,IACE,IAAMwB,QAAwBn+D,KAAK87D,cAAcd,EAAwBwC,kBAInEY,GAHgCD,EAAkBh7D,KAAKiL,MAAM+vD,GAAmB,IAGpDpsD,QAAO,SAAA/N,GAAI,OAAIA,EAAKysC,QAAUksB,EAAclsB,KAAK,IACnF2tB,EAAavwB,KAAK8uB,SAEZ38D,KAAKi8D,cACTjB,EAAwBwC,iBACxBr6D,KAAKC,UAAUg7D,GACf,CACEjC,uBAAuB,EACvBC,qBAAsB,6CAG5B,CAAE,MAAOx6D,GAEP,MADAjC,EAAOiC,MAAM,kCAAmCA,GAC1CA,CACR,CACF,IArB+B,OAqB9B,SArB8By8D,GAAA,OAAAH,EAAAr8D,MAAC,KAADC,UAAA,EAhDH,IAgDG,CAAAhB,IAAA,mBAAAC,MAAA,eAAAu9D,GAAAr9D,EAAAA,EAAAA,UA0B/B,UAA+BwvC,GAC7B,IACE,IAAM8tB,QAAgBv+D,KAAK87D,cAAcd,EAAwBwC,kBACjE,OAAKe,GAIyBp7D,KAAKiL,MAAMmwD,GAC7BngB,MAAK,SAAAp6C,GAAI,OAAIA,EAAKysC,QAAUA,CAAK,KAJpC,IAKX,CAAE,MAAO7uC,GAEP,OADAjC,EAAOiC,MAAM,iCAAkCA,GACxC,IACT,CACF,IAb8B,OAa7B,SAb6B48D,GAAA,OAAAF,EAAAz8D,MAAC,KAADC,UAAA,EA1BC,IA0BD,CAAAhB,IAAA,sBAAAC,MAAA,eAAA09D,GAAAx9D,EAAAA,EAAAA,UAkB9B,UAAkCwvC,GAChC,IACE,IAAM8tB,QAAgBv+D,KAAK87D,cAAcd,EAAwBwC,kBACjE,IAAKe,EACH,OAGF,IACMH,EADwBj7D,KAAKiL,MAAMmwD,GACfxsD,QAAO,SAAA/N,GAAI,OAAIA,EAAKysC,QAAUA,CAAK,IAEjC,IAAxB2tB,EAAaj8D,aACTnC,KAAKu9D,iBAAiBvC,EAAwBwC,wBAE9Cx9D,KAAKi8D,cACTjB,EAAwBwC,iBACxBr6D,KAAKC,UAAUg7D,GACf,CACEjC,uBAAuB,EACvBC,qBAAsB,6CAI9B,CAAE,MAAOx6D,GAEP,MADAjC,EAAOiC,MAAM,oCAAqCA,GAC5CA,CACR,CACF,IA1BiC,OA0BhC,SA1BgC88D,GAAA,OAAAD,EAAA58D,MAAC,KAADC,UAAA,EAlBH,IAkBG,CAAAhB,IAAA,gBAAAC,MA6BjC,SAAsB49D,GACpB,IAAMlmC,EAAep2B,MAAM0R,KAAK4qD,GAAO,SAAAjiC,GAAI,OAAIxL,OAAO8H,aAAa0D,EAAK,IAAEl6B,KAAK,IAC/E,OAAOu2B,KAAKN,EACd,GAAC,CAAA33B,IAAA,gBAAAC,MAED,SAAsB69D,GACpB,IAAMnmC,EAAe5lB,KAAK+rD,GAC1B,OAAO,IAAI7rD,WAAW0lB,EAAat2B,QAAQu5B,KAAI,SAAC4N,EAAGt2B,GAAC,OAAKylB,EAAaxlB,WAAWD,EAAE,GACrF,IAAC,CAtgB0B,GAAvBgoD,GACoBrhC,UAAY,UADhCqhC,GAEoBphC,WAAa,IAFjCohC,GAGoBlgC,UAAY,GAHhCkgC,GAIoBpiC,YAAc,GAJlCoiC,GAKoB1hC,mBAAqB,IALzC0hC,GAQoBe,YAAc,iBARlCf,GASoBwC,iBAAmB,sBAigBtC,IAAMqB,GAA0B,IAAI7D,GCjiBmB,IA2MjD8D,GAAa,KArLJl/D,EAAAA,EAAAA,UAAA,SAAAm/D,KAAAj/D,EAAAA,EAAAA,SAAA,KAAAi/D,EAAA,KAAAj+D,IAAA,aAAAC,MAAA,eAAAi+D,GAAA/9D,EAAAA,EAAAA,UAIpB,YACE,IACEtB,EAAOqE,KAAK,wDACZ,IACM+G,SADiBiB,EAAQC,WACTlJ,MAAQ,GAE9B,OADApD,EAAOqE,KAAK,4BAA4B+G,EAAK5I,OAAM,iBAC5C4I,CACT,CAAE,MAAOnJ,GAEP,MADAjC,EAAOiC,MAAM,0BAA2BA,GAClCA,CACR,CACF,IAXgB,OAWf,WAXe,OAAAo9D,EAAAn9D,MAAC,KAADC,UAAA,EAJI,IAIJ,CAAAhB,IAAA,YAAAC,MAAA,eAAAwL,GAAAtL,EAAAA,EAAAA,UAgBhB,UAAgBiP,EAAcyR,GAC5B,IACEhiB,EAAOqE,KAAK,2CAA4C,CAAEkM,KAAAA,EAAMyR,MAAAA,IAEhE,IAAMs9C,QAAejzD,EAAQM,UAAU,CACrC4D,KAAMA,EAAKyW,OACXhF,MAAOA,GAAS,YAIlB,OADAhiB,EAAOqE,KAAK,0CAA2Ci7D,GAChDA,CACT,CAAE,MAAOr9D,GAEP,MADAjC,EAAOiC,MAAM,wBAAyBA,GAChCA,CACR,CACF,IAfe,OAed,SAfc6B,EAAAC,GAAA,OAAA6I,EAAA1K,MAAC,KAADC,UAAA,EAhBC,IAgBD,CAAAhB,IAAA,YAAAC,MAAA,eAAA2L,GAAAzL,EAAAA,EAAAA,UAoBf,UAAgB4I,EAAY8C,GAC1B,IACEhN,EAAOqE,KAAK,mCAAoC,CAAE6F,GAAAA,EAAI8C,QAAAA,IAEtD,IAAMuyD,QAAmBlzD,EAAQS,UAAU5C,EAAI8C,GAE/C,OADAhN,EAAOqE,KAAK,kCAAmCk7D,GACxCA,CACT,CAAE,MAAOt9D,GAEP,MADAjC,EAAOiC,MAAM,wBAAyBA,GAChCA,CACR,CACF,IAXe,OAWd,SAXc+B,EAAAiJ,GAAA,OAAAF,EAAA7K,MAAC,KAADC,UAAA,EApBA,IAoBA,CAAAhB,IAAA,YAAAC,MAAA,eAAAgM,GAAA9L,EAAAA,EAAAA,UAgBf,UAAgB4I,GACd,IACElK,EAAOqE,KAAK,mCAAoC,CAAE6F,GAAAA,UAE5CmC,EAAQc,UAAUjD,GACxBlK,EAAOqE,KAAK,8CACd,CAAE,MAAOpC,GAEP,MADAjC,EAAOiC,MAAM,wBAAyBA,GAChCA,CACR,CACF,IAVe,OAUd,SAVciL,GAAA,OAAAE,EAAAlL,MAAC,KAADC,UAAA,EAhBA,IAgBA,CAAAhB,IAAA,aAAAC,MAAA,eAAAo+D,GAAAl+D,EAAAA,EAAAA,UAef,UAAiB4I,GACf,IACElK,EAAOqE,KAAK,wCAAyC,CAAE6F,GAAAA,IAEvD,IACM2C,SADgBxM,KAAKo/D,cACPhhB,MAAK,SAAA9Q,GAAC,OAAIpc,OAAOoc,EAAEzjC,MAAQA,CAAE,KAAK,KAGtD,OADAlK,EAAOqE,KAAK,gCAAiCwI,GACtCA,CACT,CAAE,MAAO5K,GAEP,MADAjC,EAAOiC,MAAM,2BAA4BA,GACnCA,CACR,CACF,IAbgB,OAaf,SAbeoL,GAAA,OAAAmyD,EAAAt9D,MAAC,KAADC,UAAA,EAfD,IAeC,CAAAhB,IAAA,eAAAC,MAAA,eAAAs+D,GAAAp+D,EAAAA,EAAAA,UAkBhB,UAAmBqlC,GACjB,IACE3mC,EAAOqE,KAAK,0CAA2C,CAAEsiC,IAAAA,IAEzD,IACMv7B,SADgB/K,KAAKo/D,cACNrtD,QAAO,SAAAu7B,GAAC,OAAIhH,EAAI5jC,SAASwuB,OAAOoc,EAAEzjC,IAAI,IAG3D,OADAlK,EAAOqE,KAAK,4BAA4B+G,EAAK5I,OAAM,SAC5C4I,CACT,CAAE,MAAOnJ,GAEP,MADAjC,EAAOiC,MAAM,6BAA8BA,GACrCA,CACR,CACF,IAbkB,OAajB,SAbiBmO,GAAA,OAAAsvD,EAAAx9D,MAAC,KAADC,UAAA,EAlBF,IAkBE,CAAAhB,IAAA,sBAAAC,MAAA,eAAAu+D,GAAAr+D,EAAAA,EAAAA,UAkBlB,YACE,IAEE,OADAtB,EAAOqE,KAAK,iDACP8+C,MAKLnjD,EAAOsC,KAAK,mEACL,IALE,EAMX,CAAE,MAAOL,GAEP,MADAjC,EAAOiC,MAAM,oCAAqCA,GAC5CA,CACR,CACF,IAdyB,OAcxB,WAdwB,OAAA09D,EAAAz9D,MAAC,KAADC,UAAA,EAlBP,IAkBO,CAAAhB,IAAA,2BAAAC,MAAA,eAAAw+D,GAAAt+D,EAAAA,EAAAA,UAmBzB,UAA+BgJ,GAC7B,IAEE,OADAtK,EAAOqE,KAAK,sDACP8+C,MAKLnjD,EAAOsC,KAAK,sEACL,CAAEkwC,OAAO,IALP,CAAEA,OAAO,EAMpB,CAAE,MAAOvwC,GAEP,OADAjC,EAAOiC,MAAM,0CAA2CA,GACjD,CAAEuwC,OAAO,EAClB,CACF,IAd8B,OAc7B,SAd6BniC,GAAA,OAAAuvD,EAAA19D,MAAC,KAADC,UAAA,EAnBL,IAmBK,CAAAhB,IAAA,gBAAAC,MAAA,eAAAy+D,GAAAv+D,EAAAA,EAAAA,UAmB9B,YACE,IAEE,OADAtB,EAAOqE,KAAK,8CACP8+C,MAKLnjD,EAAOsC,KAAK,6DACL,IALE,EAMX,CAAE,MAAOL,GAEP,MADAjC,EAAOiC,MAAM,6BAA8BA,GACrCA,CACR,CACF,IAdmB,OAclB,WAdkB,OAAA49D,EAAA39D,MAAC,KAADC,UAAA,EAnBW,IAmBX,CAAAhB,IAAA,oBAAAC,MAAA,eAAA0+D,GAAAx+D,EAAAA,EAAAA,UAmBnB,UAAwBwvC,GACtB,IAEE,GADA9wC,EAAOqE,KAAK,4CAA6C,CAAEysC,MAAAA,KACtDqS,KACH,OAIFnjD,EAAOsC,KAAK,0DACd,CAAE,MAAOL,GAEP,MADAjC,EAAOiC,MAAM,iCAAkCA,GACzCA,CACR,CACF,IAbuB,OAatB,SAbsB8O,GAAA,OAAA+uD,EAAA59D,MAAC,KAADC,UAAA,EAnBJ,O,+kBCrKyC,IAqejD49D,GAA0B,KAjdV9/D,EAAAA,EAAAA,UAAA,SAAA+/D,KAAA7/D,EAAAA,EAAAA,SAAA,KAAA6/D,EAAA,KAAA7+D,IAAA,+BAAAC,MAAA,eAAA6+D,GAAA3+D,EAAAA,EAAAA,UAS3B,UACEgJ,GAEsE,IADtE41D,EAA4B/9D,UAAAK,OAAA,QAAA0B,IAAA/B,UAAA,GAAAA,UAAA,GAAG,KAE/B,IAAKmI,EACH,MAAO,CAAE61D,iBAAkB71D,EAAS81D,cAAeF,GAGrD,IACE,IAAM/Y,QAAkBgY,GAAWkB,yBAAyB/1D,GAC5D,GAAI68C,EAAU3U,OAAS2U,EAAUrW,OAA8B,aAArBqW,EAAUtU,OAAuB,CACzE7yC,EAAOqE,KAAK,6DAA6D8iD,EAAUz6C,QAAO,KAAKy6C,EAAUrW,MAAK,WAGxGquB,GAAWmB,kBAAkBnZ,EAAUrW,OAG7C,IAAIyvB,EAAiBj2D,EACrB,GAAI68C,EAAUz6C,QAAS,CAErB,IAAM8zD,EAAc,IAAIC,OAAOtZ,EAAUz6C,QAAQrG,QAAQ,yBAA0B,QAAS,MAC5Fk6D,EAAiBj2D,EAAQjE,QAAQm6D,EAAa,IAAIx5C,MACpD,CAEA,MAAO,CACLm5C,iBAAkBI,EAClBH,cAAejZ,EAAUrW,MAE7B,CACF,CAAE,MAAO7uC,GACPjC,EAAOiC,MAAM,0EAA2EA,EAC1F,CAGA,MAAO,CAAEk+D,iBAAkB71D,EAAS81D,cAAeF,EACrD,IAnC0C,OAmCzC,SAnCyCp8D,GAAA,OAAAm8D,EAAA/9D,MAAC,KAADC,UAAA,EATf,IASe,CAAAhB,IAAA,cAAAC,MAAA,eAAAs/D,GAAAp/D,EAAAA,EAAAA,UAwC1C,UACEq/D,GAE4B,IAD5BxiB,EAA2Bh8C,UAAAK,OAAA,QAAA0B,IAAA/B,UAAA,GAAAA,UAAA,GAAG,CAAC,EAEvBy+D,EAAiEziB,EAAjEyiB,YAAaC,EAAoD1iB,EAApD0iB,YAA4BC,EAAwB3iB,EAAvCiiB,cAGlC15D,EAAmEm6D,EAC/D,CAAEV,iBAAkBQ,EAAUr2D,QAAS81D,cAAe,YAChD//D,KAAK0gE,6BAA6BJ,EAAUr2D,QAAS,MAFvD61D,EAAgBz5D,EAAhBy5D,iBAAiCa,EAAqBt6D,EAApC05D,cAIpBa,EAAc/3D,GAAAA,GAAA,GACfy3D,GAAS,IACZr2D,QAAS61D,IAILe,EAAoBN,GAAeE,GAAuBE,EAGhE,OAAK7d,KAID+d,GAAqBhC,GAAwBiC,kBAAkBD,GAC1D7gE,KAAK+gE,qBAAqBH,EAAgBC,IAG/CA,IAAsBhC,GAAwBiC,kBAAkBD,IAClElhE,EAAOsC,KAAK,+BAA+B4+D,EAAiB,2DAGvD7gE,KAAKghE,kBAAkBJ,IAXrB5gE,KAAKihE,4BAA4BL,EAY5C,IAjCiB,OAiChB,SAjCgBl9D,GAAA,OAAA28D,EAAAx+D,MAAC,KAADC,UAAA,EAxCyB,IAwCzB,CAAAhB,IAAA,oBAAAC,MAAA,eAAAmgE,GAAAjgE,EAAAA,EAAAA,UAsCjB,UAAgCq/D,GAC9B,IACE,IAAMx5D,QAAiB0C,EAAWM,YAAY,CAC5CE,MAAOs2D,EAAUt2D,OAAS,GAC1BC,QAASq2D,EAAUr2D,QACnBY,WAAYy1D,EAAUz1D,aAAc,IAAIlI,MAAOC,cAC/CkI,UAAWw1D,EAAUx1D,UACrBC,KAAMu1D,EAAUv1D,MAAQ,KAK1B,OADApL,EAAOqE,KAAK,gCACL8C,EAAS/D,IAClB,CAAE,MAAOnB,GAEP,MADAjC,EAAOiC,MAAM,yCAA0CA,GACjD,IAAI2B,MAAM,iCAClB,CACF,IAjB+B,OAiB9B,SAjB8BI,GAAA,OAAAu9D,EAAAr/D,MAAC,KAADC,UAAA,EAtCd,IAsCc,CAAAhB,IAAA,8BAAAC,MAAA,eAAAogE,GAAAlgE,EAAAA,EAAAA,UAsB/B,UAA0Cq/D,GACxC,IACE,IAAMc,QAAYpkC,GAAiBqkC,eAAef,EAAUr2D,SACtDnD,QAAiB0C,EAAWM,YAAY,CAC5CE,MAAOs2D,EAAUt2D,OAAS,GAC1BC,QAAS,GACTY,WAAYy1D,EAAUz1D,aAAc,IAAIlI,MAAOC,cAC/CkI,UAAWw1D,EAAUx1D,UACrBC,KAAMu1D,EAAUv1D,MAAQ,GACxBb,kBAAmBk3D,EAAI7lC,iBACvBpxB,cAAei3D,EAAIh3D,GACnBG,cAAe62D,EAAI5lC,WACnB7wB,mBAAoBy2D,EAAIx2D,OACxBH,qBAAsB22D,EAAI12D,WAAa,YAGzC,OADA/K,EAAOqE,KAAK,4CACZ6E,GAAAA,GAAA,GACK/B,EAAS/D,MAAI,IAChBkH,QAASq2D,EAAUr2D,SAEvB,CAAE,MAAOrI,GAEP,MADAjC,EAAOiC,MAAM,qDAAsDA,GAC7D,IAAI2B,MAAM,2CAClB,CACF,IAxByC,OAwBxC,SAxBwCqJ,GAAA,OAAAu0D,EAAAt/D,MAAC,KAADC,UAAA,EAtBV,IAsBU,CAAAhB,IAAA,uBAAAC,MAAA,eAAAugE,GAAArgE,EAAAA,EAAAA,UA6BzC,UACEq/D,EACAC,GAEA,IAAK1B,GAAwBiC,kBAAkBP,GAC7C,MAAM,IAAIh9D,MAAM,6CAA6Cg9D,GAG/D,IAEE,IAAMzjC,QAAkB+hC,GAAwB0C,6BAC9CjB,EAAUr2D,QACVs2D,GAMIiB,SAFwB1C,GAAW2C,6BAChB3C,GAAW4C,iBACPtjB,MAAK,SAAC5xC,GAAQ,OAAKA,EAAI3C,KAAO02D,CAAW,KAEtE,IAAKiB,EACH,MAAM,IAAIj+D,MAAM,yBAAyBg9D,GAI3C,IAAMz5D,QAAiB0C,EAAWO,qBAAqB,CACrDC,MAAOs2D,EAAUt2D,OAAS,GAC1BE,kBAAmB4yB,EAAUvB,iBAC7BhxB,cAAeuyB,EAAU8gC,aACzBxzD,GAAI0yB,EAAU1yB,GACdE,KAAMwyB,EAAUxyB,KAChBI,UAAWoyB,EAAUpyB,UACrBG,WAAYy1D,EAAUz1D,aAAc,IAAIlI,MAAOC,cAC/CkI,UAAWw1D,EAAUx1D,UACrBC,KAAMu1D,EAAUv1D,MAAQ,GACxBH,OAAQkyB,EAAUlyB,OAClBI,cAAeu1D,EACft1D,gBAAiBu2D,EAAU33D,KAM7B,OAHAlK,EAAOqE,KAAK,8CAA8Cu8D,GAG1D13D,GAAAA,GAAA,GACK/B,EAAS/D,MAAI,IAChBkH,QAASq2D,EAAUr2D,QACnBe,cAAeu1D,GAEnB,CAAE,MAAO3+D,GAEP,MADAjC,EAAOiC,MAAM,6CAA8CA,GACrD,IAAI2B,MAAM,2CAClB,CACF,IApDkC,OAoDjC,SApDiCsJ,EAAAG,GAAA,OAAAs0D,EAAAz/D,MAAC,KAADC,UAAA,EA7BO,IA6BP,CAAAhB,IAAA,kCAAAC,MAAA,eAAA4gE,GAAA1gE,EAAAA,EAAAA,UAyDlC,UACEq/D,EACAC,GAEA,IAEE,IACMiB,SADmB1C,GAAW4C,iBACPtjB,MAAK,SAAC5xC,GAAQ,OAAKA,EAAI3C,KAAO02D,CAAW,IAEtE,IAAKiB,EACH,MAAM,IAAIj+D,MAAM,yBAAyBg9D,GAI3C,IAAMz5D,QAAiB0C,EAAWM,YAAY,CAC5CE,MAAOs2D,EAAUt2D,OAAS,GAC1BC,QAASq2D,EAAUr2D,QACnBY,WAAYy1D,EAAUz1D,aAAc,IAAIlI,MAAOC,cAC/CkI,UAAWw1D,EAAUx1D,UACrBC,KAAMu1D,EAAUv1D,MAAQ,GACxBC,cAAeu1D,EACft1D,gBAAiBu2D,EAAU33D,KAK7B,OAFAlK,EAAOqE,KAAK,4DAA4Du8D,GAExE13D,GAAAA,GAAA,GACK/B,EAAS/D,MAAI,IAChBiI,cAAeu1D,GAEnB,CAAE,MAAO3+D,GAEP,MADAjC,EAAOiC,MAAM,2DAA4DA,GACnE,IAAI2B,MAAM,iDAClB,CACF,IAlC6C,OAkC5C,SAlC4CwM,EAAAC,GAAA,OAAA2xD,EAAA9/D,MAAC,KAADC,UAAA,EAzDX,IAyDW,CAAAhB,IAAA,aAAAC,MAAA,eAAA6gE,GAAA3gE,EAAAA,EAAAA,UAuC7C,YAMsC,IANrB68C,EAMhBh8C,UAAAK,OAAA,QAAA0B,IAAA/B,UAAA,GAAAA,UAAA,GAAG,CAAC,EACH,IAEE,IACM+/D,SADmB/C,GAAW2C,uBACD/lC,KAAI,SAAClvB,GAAQ,OAAKA,EAAI3C,EAAE,IAGrD/C,QAAiB0C,EAAWC,WAAUZ,GAAAA,GAAC,CAAC,EACzCi1C,GAAO,IACVgkB,kBAAmBD,EACnBhrB,gBAAgB,KAGZlkB,EAAU7rB,EAAS/D,KAAK4vB,SAAW7rB,EAAS/D,KAGlD,OAAO/C,KAAK+hE,eAAepvC,EAC7B,CAAE,MAAO/wB,GAEP,MADAjC,EAAOiC,MAAM,iCAAkCA,GACzC,IAAI2B,MAAM,qCAClB,CACF,IA3BgB,OA2Bf,WA3Be,OAAAq+D,EAAA//D,MAAC,KAADC,UAAA,EAvC6B,IAuC7B,CAAAhB,IAAA,WAAAC,MAAA,eAAAihE,GAAA/gE,EAAAA,EAAAA,UAgChB,UAAe4I,GACb,IACE,IACMm3B,SADiBx3B,EAAWI,SAASC,IACpB9G,KAEvB,IAAKi+B,EAAO,OAAO,KAEnB,IAAMwL,QAAyBxsC,KAAK+hE,eAAe,CAAC/gC,IACpD,OAAOwL,EAAiBrqC,OAAS,EAAIqqC,EAAiB,GAAK,IAC7D,CAAE,MAAO5qC,GAEP,MADAjC,EAAOiC,MAAM,+BAA+BiI,EAAE,IAAKjI,GAC7C,IAAI2B,MAAM,mCAClB,CACF,IAbc,OAab,SAbamN,GAAA,OAAAsxD,EAAAngE,MAAC,KAADC,UAAA,EAhCE,IAgCF,CAAAhB,IAAA,iBAAAC,MAAA,eAAAkhE,GAAAhhE,EAAAA,EAAAA,UAkBd,UAA6B0xB,GAA8C,IAAD5wB,EAAA,KAGlEipC,EAAkBrY,EAIlBuvC,SADmBpD,GAAW2C,uBACJ/lC,KAAI,SAAClvB,GAAQ,OAAKA,EAAI3C,EAAE,IAElD2iC,QAAyBrmC,QAAQg8D,IACrCn3B,EAAgBtP,IAAI,WAAD,IAAAz0B,GAAAhG,EAAAA,EAAAA,UAAC,UAAO+/B,GACzB,OAAIA,EAAMh2B,eAAiBk3D,EAAax/D,SAASs+B,EAAMh2B,eAC9CjJ,EAAKqgE,sBAAsBphC,GAE7BA,CACT,IAAC,gBAAApwB,GAAA,OAAA3J,EAAApF,MAAA,KAAAC,UAAA,EALmB,KAQtB,OAAO0qC,EAAiBz6B,QAAO,SAAAivB,GAAK,OAAc,OAAVA,CAAc,GACxD,IAnB4B,OAmB3B,SAnB2BrwB,GAAA,OAAAsxD,EAAApgE,MAAC,KAADC,UAAA,EAlBd,IAkBc,CAAAhB,IAAA,wBAAAC,MAAA,eAAAshE,GAAAphE,EAAAA,EAAAA,UAwB5B,UAAoC+/B,GAClC,IAAMu/B,EAAcv/B,EAAMh2B,cAE1B,IAAKu1D,EAEH,OADA5gE,EAAOsC,KAAK,8CACL,KAGT,IAAK48D,GAAwBiC,kBAAkBP,GAE7C,OADA5gE,EAAOsC,KAAK,uDAAuDs+D,GAC5D,KAGT,IAEE,IAAKv/B,EAAM92B,oBAAsB82B,EAAM72B,gBAAkB62B,EAAM32B,gBAE7D,OADA1K,EAAOsC,KAAK,mDACL,KAGT,IAAM66B,EAAY,CAChBvB,iBAAkByF,EAAM92B,kBACxB0zD,aAAc58B,EAAMz2B,eAAiB,GACrCH,GAAI42B,EAAM72B,cACVG,KAAM02B,EAAM32B,gBACZK,UAAWs2B,EAAMv2B,sBAAwB,UACzCG,OAAQo2B,EAAMr2B,oBAAsBq2B,EAAM72B,eAGtC6xB,QAAyB6iC,GAAwByD,6BACrDxlC,EACAyjC,GAGF,OAAA13D,GAAAA,GAAA,GACKm4B,GAAK,IACR/2B,QAAS+xB,GAEb,CAAE,MAAOp6B,GAGP,OAFAjC,EAAOiC,MAAM,8CAA+CA,GAE5DiH,GAAAA,GAAA,GACKm4B,GAAK,IACR/2B,QAAS,2CAEb,CACF,IA9CmC,OA8ClC,SA9CkCsH,GAAA,OAAA8wD,EAAAxgE,MAAC,KAADC,UAAA,EAxBP,IAwBO,CAAAhB,IAAA,gBAAAC,MAAA,eAAAwhE,GAAAthE,EAAAA,EAAAA,UAmDnC,UAAoBqK,GAClB,IAEE,IACMu2D,SADmB/C,GAAW2C,uBACD/lC,KAAI,SAAClvB,GAAQ,OAAKA,EAAI3C,EAAE,IAErD/C,QAAiB0C,EAAW6B,cAAcC,EAAO,CACrDw2D,kBAAmBD,EACnBhrB,gBAAgB,IAGZlkB,EAAU7rB,EAAS/D,KAAK4vB,SAAW7rB,EAAS/D,KAClD,OAAO/C,KAAK+hE,eAAepvC,EAC7B,CAAE,MAAO/wB,GAEP,MADAjC,EAAOiC,MAAM,oCAAqCA,GAC5C,IAAI2B,MAAM,mCAClB,CACF,IAjBmB,OAiBlB,SAjBkBiO,GAAA,OAAA+wD,EAAA1gE,MAAC,KAADC,UAAA,EAnDgB,IAmDhB,CAAAhB,IAAA,cAAAC,MAAA,eAAAyhE,GAAAvhE,EAAAA,EAAAA,UAsBnB,UAAkB4I,EAAY8C,GAC5B,IAEE,GAA+B,kBAApBA,EAAQ1C,QAAsB,CACvC,IAAAw4D,QAAkDziE,KAAK0gE,6BAA6B/zD,EAAQ1C,SAApF61D,EAAgB2C,EAAhB3C,iBAAkBC,EAAa0C,EAAb1C,cAM1B,GAHApzD,EAAQ1C,QAAU61D,EAGdhd,MAA0Bid,GAAiBlB,GAAwBiC,kBAAkBf,GAAgB,CACvGpgE,EAAOqE,KAAK,0DAA0D6F,EAAE,aAAak2D,EAAa,KAElG,IAAMjjC,QAAkB+hC,GAAwB0C,6BAA6BzB,EAAkBC,GAEzFyB,SADmB1C,GAAW4C,iBACPtjB,MAAK,SAAC5xC,GAAQ,OAAKA,EAAI3C,KAAOk2D,CAAa,IAExE,IAAKyB,EACH,MAAM,IAAIj+D,MAAM,yBAAyBw8D,GAG3C,IAAM2C,EAAsB75D,GAAAA,GAAA,GACvB8D,GAAO,IACV1C,QAAS,GACTC,kBAAmB4yB,EAAUvB,iBAC7BhxB,cAAeuyB,EAAU8gC,aACzBxzD,GAAI0yB,EAAU1yB,GACdE,KAAMwyB,EAAUxyB,KAChBI,UAAWoyB,EAAUpyB,UACrBE,OAAQkyB,EAAUlyB,OAClBI,cAAe+0D,EACf90D,gBAAiBu2D,EAAU33D,KAI7B,OAAAhB,GAAAA,GAAA,UADuBW,EAAW0B,YAAYrB,EAAI64D,IAEpC3/D,MAAI,IAChBkH,QAAS61D,GAEb,CAGA,IAAKhd,KAAwB,CAC3BnjD,EAAOqE,KAAK,kBAAkB6F,EAAE,8BAChC,IAAMu3D,QAAYpkC,GAAiBqkC,eAAevB,GAC5C4C,EAA2B75D,GAAAA,GAAA,GAC5B8D,GAAO,IACV1C,QAAS,GACTC,kBAAmBk3D,EAAI7lC,iBACvBpxB,cAAei3D,EAAIh3D,GACnBG,cAAe62D,EAAI5lC,WACnB7wB,mBAAoBy2D,EAAIx2D,OACxBH,qBAAsB22D,EAAI12D,WAAa,YAGzC,OAAA7B,GAAAA,GAAA,UADuBW,EAAW0B,YAAYrB,EAAI64D,IAC7B3/D,MAAI,IAAEkH,QAAS61D,GACtC,CACF,CAKA,OAFAngE,EAAOqE,KAAK,iCAAiC6F,EAAE,YACxBL,EAAW0B,YAAYrB,EAAI8C,IAClC5J,IAClB,CAAE,MAAOnB,GAEP,MADAjC,EAAOiC,MAAM,kCAAkCiI,EAAE,IAAKjI,GAChD,IAAI2B,MAAM,iCAClB,CACF,IAnEiB,OAmEhB,SAnEgB84B,EAAAgV,GAAA,OAAAmxB,EAAA3gE,MAAC,KAADC,UAAA,EAtBE,IAsBF,CAAAhB,IAAA,cAAAC,MAAA,eAAA4hE,GAAA1hE,EAAAA,EAAAA,UAwEjB,UAAkB4I,GAChB,UACQL,EAAW4B,YAAY8lB,OAAOrnB,IACpClK,EAAOqE,KAAK,yBAAyBktB,OAAOrnB,GAC9C,CAAE,MAAOjI,GAEP,MADAjC,EAAOiC,MAAM,kCAAkCiI,EAAE,IAAKjI,GAChD,IAAI2B,MAAM,iCAClB,CACF,IARiB,OAQhB,SARgB+tC,GAAA,OAAAqxB,EAAA9gE,MAAC,KAADC,UAAA,EAxEA,O,+kBC5XnB,IAAM0lD,GAA0C,CAAC,EA8MjD,SA5MwB,SAACzkD,EAAmB+6C,GAC1C,IAAMiK,EAAal/C,GAAAA,GAAA,GAAQ2+C,IAAoB1J,GACvCjI,EAA8CkS,EAA9ClS,aAAc+sB,EAAgC7a,EAAhC6a,eAAgBC,EAAgB9a,EAAhB8a,YACtCrtD,GAAkCC,EAAAA,EAAAA,UAAwB1S,EAAK8G,IAAG6L,GAAAC,EAAAA,EAAAA,SAAAH,EAAA,GAA3DstD,EAASptD,EAAA,GAAEqtD,EAAYrtD,EAAA,GAC9BI,GAAgCL,EAAAA,EAAAA,WAAS,GAAMM,GAAAJ,EAAAA,EAAAA,SAAAG,EAAA,GAAxCwiD,EAAQviD,EAAA,GAAEitD,EAAWjtD,EAAA,GAC5BG,GAA0BT,EAAAA,EAAAA,UAAuB,MAAKU,GAAAR,EAAAA,EAAAA,SAAAO,EAAA,GAA/CtU,EAAKuU,EAAA,GAAE0jC,EAAQ1jC,EAAA,GAChB8sD,GAAYzsC,EAAAA,EAAAA,SAAO,GACnB0sC,GAAkB1sC,EAAAA,EAAAA,SAAO,GAGzB2sC,GAAiB3sC,EAAAA,EAAAA,QAAoBzzB,IAG3C0T,EAAAA,EAAAA,YAAU,WACR0sD,EAAexsC,QAAO9tB,GAAAA,GAAA,GACjB9F,GAAI,IACP8G,GAAIi5D,GAAa//D,EAAK8G,IAE1B,GAAG,CAAC9G,EAAM+/D,KAGVrsD,EAAAA,EAAAA,YAAU,WACR,OAAO,WACLwsD,EAAUtsC,SAAU,EAEpBusC,EAAgBvsC,SAAU,CAC5B,CACF,GAAG,IAGH,IAAMysC,GAAchlC,EAAAA,EAAAA,aAAY,WAAD,IAAA/3B,GAAApF,EAAAA,EAAAA,UAAC,UAAOoiE,GAErC,IAAKJ,EAAUtsC,SAAWusC,EAAgBvsC,QAExC,OADAh3B,EAAOsC,KAAK,6EACL,KAIT,IAAKohE,EAAYp5D,QAAQ0c,SAAW08C,EAAYr5D,MAAM2c,SAAW08C,EAAY/a,SAE3E,OADA3oD,EAAOsC,KAAK,+DACL,KAIT,IAQIo1C,EARAisB,EAAW,KASf,GARID,EAAY/a,WAAa+a,EAAY/a,SAASpiD,WAAW,SAC3Do9D,EAAWD,EAAY/a,SACd+a,EAAY/a,UACrB3oD,EAAOqE,KAAK,+EAKV6xC,EAAc,CAGhB,IAAA0tB,EAA2B1tB,EAAa1xB,MAAM,KAAKuX,IAAIqd,QAAOyqB,GAAA7tD,EAAAA,EAAAA,SAAA4tD,EAAA,GAAvDE,EAAID,EAAA,GAAEE,EAAKF,EAAA,GAAEtsB,EAAGssB,EAAA,GAEvBnsB,EADgB,IAAI10C,KAAKA,KAAKghE,IAAIF,EAAMC,EAAQ,EAAGxsB,EAAK,GAAI,EAAG,EAAG,IAC9Ct0C,cACpBjD,EAAOqE,KAAK,mCAAmC6xC,EAAY,uBAAuBwB,EACpF,MACEA,GAAY,IAAI10C,MAAOC,cACvBjD,EAAOqE,KAAK,oCAAoCqzC,GAGlD,IAAMipB,EAAY,CAChBt2D,MAAOq5D,EAAYr5D,MAAM2c,QAAM,cAAiBya,EAAAA,GAAAA,SAAO,IAAIz+B,KAAQ,oBACnEsH,QAASo5D,EAAYp5D,QAAQ0c,OAC7B9b,WAAYwsC,EACZvsC,UAAWw4D,QAAYz/D,EACvBkH,KAAMs4D,EAAYt4D,MAGpB,IAEE,IAAKk4D,EAAUtsC,SAAWusC,EAAgBvsC,QAExC,OADAh3B,EAAOsC,KAAK,kGACL,KAIT,GAAuB,OAAnBohE,EAAYx5D,GAAa,CAC3BlK,EAAOqE,KAAK,2CAA2Cq/D,EAAYx5D,UACxC61D,GAAwBx0D,YAAYm4D,EAAYx5D,GAAIy2D,GAE/E,OADA3gE,EAAOqE,KAAK,kCAAkCq/D,EAAYx5D,GAAE,aACrDw5D,EAAYx5D,EACrB,CACElK,EAAOqE,KAAK,qDAAsDs8D,GAClE,IAAMsD,QAAiBlE,GAAwB51D,YAAYw2D,GACrDuD,EAAQ3yC,OAAO0yC,EAAS/5D,IAK9B,OAJAlK,EAAOqE,KAAK,mDAAmD6/D,GAC3DZ,EAAUtsC,UAAYusC,EAAgBvsC,SACxCosC,EAAac,GAERA,CAEX,CAAE,MAAO5yC,GAEP,GAAIgyC,EAAUtsC,UAAYusC,EAAgBvsC,QAAS,CACjD,IAAM/0B,EAAQqvB,aAAe1tB,MAAQ0tB,EAAM,IAAI1tB,MAAM,8BACrD5D,EAAOiC,MAAM,0CAA2CA,GACxDi4C,EAASj4C,GACLihE,GACFA,EAAYjhE,EAEhB,MACIjC,EAAOsC,KAAK,iGAAkGgvB,GAGlH,MAAMA,CACR,CACF,IAAC,gBAAAxtB,GAAA,OAAA4C,EAAAxE,MAAA,KAAAC,UAAA,EAjF+B,GAiF7B,CAAC+gE,EAAahtB,IAGXiuB,GAAO1lC,EAAAA,EAAAA,aAAY,WAAD,IAAAn3B,GAAAhG,EAAAA,EAAAA,UAAC,UAAO8iE,EAAqCjmB,GACnE,IAAAx0C,EAAsDw0C,GAAW,CAAC,EAACkmB,EAAA16D,EAA3D26D,OAAAA,OAAM,IAAAD,GAAQA,EAAAE,EAAA56D,EAAE66D,kBAAAA,OAAiB,IAAAD,GAAQA,EAGjD,GAAI5L,EAEF,OADA34D,EAAOmE,MAAM,8DACN,KAIT,IAAKm/D,EAAUtsC,SAAWusC,EAAgBvsC,QAExC,OADAh3B,EAAOsC,KAAK,sEACL,KAGTtC,EAAOqE,KAAK,mBAAkBigE,EAAS,SAAW,UAAQ,sBAE1DjB,GAAY,GACZnpB,EAAS,MACT,IAAIuqB,EAAyB,KAE7B,IAEE,IACMC,EAAsBx7D,GAAAA,GAAA,GADRs6D,EAAexsC,SAG9BotC,GAsBL,OAlBAK,QAAgBhB,EAAYiB,GAC5B1kE,EAAOqE,KAAK,2CAA2CogE,EAAO,KAG1DnB,EAAUtsC,UAAYusC,EAAgBvsC,SACxB,OAAZytC,IACFrB,EAAaqB,IAGRH,GAAUE,GAAqBvB,GAClCjjE,EAAOqE,KAAK,yCACZ4+D,EAAewB,IAEfzkE,EAAOqE,KAAK,mBAAkBigE,EAAS,SAAW,UAAQ,uBAKzDG,CACT,CAAE,MAAOnzC,GAIP,GAHAtxB,EAAOiC,MAAM,+BAAgCqvB,IAGxCgzC,GAAUhB,EAAUtsC,UAAYusC,EAAgBvsC,SAAWksC,EAAa,CAC3E,IAAMjhE,EAAQqvB,aAAe1tB,MAAQ0tB,EAAM,IAAI1tB,MAAM,8BACrDs2C,EAASj4C,GACTihE,EAAYjhE,EACd,MAAWqiE,GACTtkE,EAAOqE,KAAK,2DAGd,OAAO,IACT,CAAC,QAEKi/D,EAAUtsC,SACZqsC,GAAY,EAEhB,CACF,IAAC,gBAAAt/D,EAAAC,GAAA,OAAAsD,EAAApF,MAAA,KAAAC,UAAA,EApEwB,GAoEtB,CAACshE,EAAa9K,EAAUsK,EAAgBC,IAc3C,OAXApsD,EAAAA,EAAAA,YAAU,WACR,OAAO,WAEL9W,EAAOqE,KAAK,4BAGZi/D,EAAUtsC,SAAU,EACpBusC,EAAgBvsC,SAAU,CAC5B,CACF,GAAG,IAEI,CACLmsC,UAAAA,EACAxK,SAAAA,EACAwL,KAAAA,EACAliE,MAAAA,EAEJ,E,+kBCvMA,IAAMkoC,GAAmB,gBAqdnB1kB,GAAY,SAACnG,GAAe,OAAK2B,EAAAA,QAAWxb,OAAO,CACvDyb,UAAW,CACTC,KAAM,EACNO,eAAgB,SAChBD,WAAY,UAEdo2C,aAAY3uD,GAAAA,GAAA,GACP+X,EAAAA,QAAWgyC,oBAAkB,IAChC7xC,gBAAiB,qBACjB+pB,OAAQ,IAEVw5B,iBAAkB,CAChBxjD,KAAM,EACN7D,MAAO,OACP6tB,OAAQ,GAEVy5B,kBAAmB,CACjBzjD,KAAM,EACN7D,MAAO,OACP8D,gBAAiB9B,EAAMC,OAAOpG,YAEhCikC,YAAa,CACX57B,cAAe,MACfE,eAAgB,gBAChBD,WAAY,SACZa,kBAAmBhD,EAAMvC,QAAQX,GACjCiF,WAA4B,QAAhB9gB,EAAAA,QAASC,GAAe,GAAK8e,EAAMvC,QAAQV,GACvDkE,cAAejB,EAAMvC,QAAQb,GAC7B0F,kBAAmB,EACnBC,kBAAmBvC,EAAMC,OAAO9F,OAChC2H,gBAAiB9B,EAAMC,OAAOpG,YAEhC0rD,YAAa,CACXvnD,MAAO,GACPC,OAAQ,EACR6D,gBAAiB9B,EAAMC,OAAO9F,OAC9BwD,aAAc,EACdgZ,SAAU,WACVilC,IAAqB,QAAhB36D,EAAAA,QAASC,GAAe,GAAK8e,EAAMvC,QAAQZ,GAChD8kB,KAAM,MACNjb,YAAa,IAEf/D,YAAW/Y,GAAA,CACToU,MAAO,GACPC,OAAQ,GACRN,aAAc,GACdmE,gBAAiB9B,EAAMC,OAAOlG,KAC9BqI,eAAgB,SAChBD,WAAY,SACZuE,WAAY,QACT1G,EAAMnC,QAAQjB,IAEnB4oD,gBAAiB,CACf3jD,KAAM,GAERwB,iBAAkB,CAChBxB,KAAM,EACNO,eAAgB,SAChBD,WAAY,SACZY,gBAAiB/C,EAAMvC,QAAQV,IAEjC0oD,cAAa77D,GAAAA,GAAA,GACR+X,EAAAA,QAAWgyC,oBAAkB,IAChC7xC,gBAAiB,qBACjBM,eAAgB,SAChBD,WAAY,SACZ0pB,OAAQ,IAEVvoB,YAAa,CACXC,UAAWvD,EAAMvC,QAAQZ,GACzB2F,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC6F,MAAO1C,EAAMC,OAAOjG,KACpB0J,WAAY1D,EAAM7D,WAAWC,aAAaC,SAE5C8jC,YAAa,CACX39B,SAAUxC,EAAM7D,WAAWO,UAAUI,GACrC2F,WAAY,MACZC,MAAO1C,EAAMC,OAAOjG,KACpB0J,WAAY1D,EAAM7D,WAAWC,aAAaG,WAE3C,EAEH,SAhiB+B,WAAO,IAADmpD,EAAAC,EAAAC,EAAAC,EACnCnlE,EAAOqE,KAAK,2CACZ,IAAQib,EAAUG,KAAVH,MACF0B,EAASyE,GAAUnG,GACnBoK,GAAaC,EAAAA,GAAAA,iBACbk4B,GAAQujB,EAAAA,GAAAA,YACN5nC,EAAiB2C,KAAjB3C,aAIFu8B,EAHehf,KAAblqB,SAG+BH,sBAGvC5Z,EAAAA,EAAAA,YAAU,WACJijD,EACF/5D,EAAOqE,KAAK,iFAEZrE,EAAOqE,KAAK,iFAEhB,GAAG,CAAC01D,IACJ,IAAM7jB,EAA2B,OAAf8uB,EAAGnjB,EAAM93C,aAAM,EAAZi7D,EAAc9uB,aAC7BitB,EAAwB,OAAf8B,EAAGpjB,EAAM93C,aAAM,EAAZk7D,EAAc9B,UAC1Bl7B,EAAwB,OAAfi9B,EAAGrjB,EAAM93C,aAAM,EAAZm7D,EAAcj9B,UAC1BC,EAAsB,OAAfi9B,EAAGtjB,EAAM93C,aAAM,EAAZo7D,EAAcj9B,SAG9BpxB,EAAAA,EAAAA,YAAU,WACJo/B,EACFl2C,EAAOqE,KAAK,qDAAqD6xC,GAEjEl2C,EAAOqE,KAAK,mDAGV8+D,EACFnjE,EAAOqE,KAAK,+CAA+C8+D,GAE3DnjE,EAAOqE,KAAK,qCAGV4jC,GAAaC,GACfloC,EAAOqE,KAAK,iCAAiC4jC,EAAS,UAAUC,EAAO,IAE3E,GAAG,CAACgO,EAAcitB,EAAWl7B,EAAWC,IAGxC,IAAAryB,GAAkCC,EAAAA,EAAAA,WAAS,GAAMC,GAAAC,EAAAA,EAAAA,SAAAH,EAAA,GAA1CQ,EAASN,EAAA,GAChBI,GAD8BJ,EAAA,IACUD,EAAAA,EAAAA,WAAS,IAAKM,GAAAJ,EAAAA,EAAAA,SAAAG,EAAA,GAA/CkvD,EAAYjvD,EAAA,GACnBG,GADoCH,EAAA,IACYN,EAAAA,EAAAA,WAAS,IAAMU,GAAAR,EAAAA,EAAAA,SAAAO,EAAA,GAAxD+uD,EAAgB9uD,EAAA,GAAE+uD,EAAmB/uD,EAAA,GAC5CG,GAAoCb,EAAAA,EAAAA,UAAwB,IAAGc,GAAAZ,EAAAA,EAAAA,SAAAW,EAAA,GAAxD2jD,EAAU1jD,EAAA,GAAE4uD,EAAa5uD,EAAA,GAChCoT,GAA0ClU,EAAAA,EAAAA,UAAS,QAAOmU,GAAAjU,EAAAA,EAAAA,SAAAgU,EAAA,GAG1DG,GAHoBF,EAAA,GAAkBA,EAAA,IAGZnU,EAAAA,EAAAA,UAAS,KAAGsU,GAAApU,EAAAA,EAAAA,SAAAmU,EAAA,GAA/B9f,EAAK+f,EAAA,GAAEq7C,EAAQr7C,EAAA,GACtBsC,GAA8B5W,EAAAA,EAAAA,UAAS,IAAG6W,GAAA3W,EAAAA,EAAAA,SAAA0W,EAAA,GAAnCpiB,EAAOqiB,EAAA,GAAE+4C,EAAU/4C,EAAA,GAC1BC,GAA8C9W,EAAAA,EAAAA,UAAS,IAAG+W,GAAA7W,EAAAA,EAAAA,SAAA4W,EAAA,GAAnD+4C,EAAe94C,EAAA,GAAE+4C,EAAkB/4C,EAAA,GAC1CkhC,GAAwBj4C,EAAAA,EAAAA,UAAmBoyB,EAAU,CAACA,GAAW,CAAC,YAAW8lB,GAAAh4C,EAAAA,EAAAA,SAAA+3C,EAAA,GAAtE3iD,EAAI4iD,EAAA,GAAE6X,EAAO7X,EAAA,GACpB8X,IAAgChwD,EAAAA,EAAAA,UAAwB,MAAKiwD,IAAA/vD,EAAAA,EAAAA,SAAA8vD,GAAA,GAAtDnd,GAAQod,GAAA,GAAEnd,GAAWmd,GAAA,GAC5BC,IAA4DlwD,EAAAA,EAAAA,WAAS,GAAMmwD,IAAAjwD,EAAAA,EAAAA,SAAAgwD,GAAA,GAA5CE,IAAFD,GAAA,GAA2BA,GAAA,KAGxDnvD,EAAAA,EAAAA,YAAU,WACR,GAAIqsD,EAAW,CACN,IAAMgD,EAAiB,eAAAz/D,GAAApF,EAAAA,EAAAA,UAAG,YAC9B,IAAK,IAAD8kE,EACFF,IAA0B,GAC1B,IACM7kC,SADiBx3B,EAAWI,SAAS40B,SAASskC,KAC7B//D,KAEvBpD,EAAOqE,KAAK,uDAAuDg9B,EAAMh3B,OACzEo7D,EAASpkC,EAAMh3B,OAAS,IACxB,IAAMg8D,EAAehlC,EAAM/2B,SAAW,GACtCo7D,EAAWW,GACXT,EAAmBS,GACnBR,GAAkB,OAAVO,EAAA/kC,EAAMj2B,WAAI,EAAVg7D,EAAYrqC,KAAI,SAAClvB,GAAQ,OAAKA,EAAI0D,IAAI,MAAK,CAAC,YACpDq4C,GAAYvnB,EAAMl2B,UACpB,CAAE,MAAOlJ,GACPjC,EAAOiC,MAAM,gDAAgDkhE,EAAS,IAAKlhE,EAE7E,CAAC,QACCikE,IAA0B,EAC5B,CACF,IAAC,kBAnB4B,OAAAx/D,EAAAxE,MAAA,KAAAC,UAAA,KAqB9BgkE,GACF,CACF,GAAG,CAAChD,IAEJ,IAAMmD,IAAazvC,EAAAA,EAAAA,SAAO,GAE1B0vC,GAGIC,IACFngC,EAAAA,EAAAA,UAAQ,WACN,IAAIogC,EAAcr7D,EAMlB,OALIoyB,IAAiBipC,EAAY1jE,SAASonC,IACxCs8B,EAAW,GAAA74B,QAAApS,EAAAA,GAAAA,SAAOirC,GAAW,CAAEt8B,MACrB3M,GAAgBipC,EAAY1jE,SAASonC,MAC/Cs8B,EAAcA,EAAYr0D,QAAO,SAAAu7B,GAAC,OAAIA,IAAMxD,EAAgB,KAEvD,CACLjgC,GAAIi5D,GAAa,KACjB94D,MAAAA,EACAC,QAAAA,EACAc,KAAMq7D,EACN9d,SAAAA,GAEJ,GAAG,CAACt+C,EAAOC,EAASc,EAAMu9C,GAAUnrB,IACpC,CACE0Y,aAAcA,EACd+sB,gBAAgBxkC,EAAAA,EAAAA,cAAY,SAACgmC,GACtB6B,GAAWtvC,SAIZytC,EACFzkE,EAAOqE,KAAK,uCAAuCogE,EAAO,uBAE1DzkE,EAAOsC,KAAK,6EAKVonB,EAAWg9C,aACbh9C,EAAWi9C,UAZX3mE,EAAOmE,MAAM,sDAcjB,GAAG,CAACulB,IACJw5C,aAAazkC,EAAAA,EAAAA,cAAY,SAACx8B,GACnBqkE,GAAWtvC,SAIhBh3B,EAAOiC,MAAM,8BAA+BA,GAC5CslC,GAAAA,QAAMC,MAAM,cAAe,kDAAmD,CAC5E,CAAEluB,KAAM,KAAM+L,QAAS,WACjBqE,EAAWg9C,aACbh9C,EAAWi9C,QAEf,MATA3mE,EAAOmE,MAAM,mDAWjB,GAAG,CAACulB,MAlDNivC,GAAQ4N,GAAR5N,SACAwL,GAAIoC,GAAJpC,MAqDFrtD,EAAAA,EAAAA,YAAU,WAER,OADAwvD,GAAWtvC,SAAU,EACd,WACLsvC,GAAWtvC,SAAU,CACvB,CACF,GAAG,KAGHlgB,EAAAA,EAAAA,YAAU,WACR,GAAKqsC,KAAL,CAIA,IAAMyjB,EAAc,eAAAt/D,GAAAhG,EAAAA,EAAAA,UAAG,YACrB,IACE,IAAMulE,QAAuB1H,GAAW2C,sBACxC0D,EAAcqB,EAChB,CAAE,MAAO5kE,GACPjC,EAAOiC,MAAM,qCAAsCA,EACrD,CACF,IAAC,kBAPmB,OAAAqF,EAAApF,MAAA,KAAAC,UAAA,KASpBykE,GAVA,MAFEpB,EAAc,GAalB,GAAG,IAEH,IAAMsB,IAA8BroC,EAAAA,EAAAA,cAAY,SAACsoC,GAG/C/mE,EAAOqE,KAAK,qEAMd,GAAG,IAGG81D,IAAmB17B,EAAAA,EAAAA,aAAY,WAAD,IAAA90B,GAAArI,EAAAA,EAAAA,UAAC,UAAO4uD,EAAuB8W,GACjE,GAAKV,GAAWtvC,UAAW2hC,GAA3B,CAEA34D,EAAOqE,KAAK,yCAGZ,IAAM4iE,EAAe9D,GAAawC,EAC9BA,EAAkB,OAASzV,EAC3BA,EAGAgX,EAAa78D,EACjB,GAAI6lD,IAAkB7lD,EAAO,CAC3B,IAAM88D,EAAQjX,EAAc1rC,MAAM,KAC5B4iD,EAAYD,EAAMllC,MAAM,EAAG,GAAGp/B,KAAK,MAAQskE,EAAM3kE,OAAS,EAAI,MAAQ,IAG5EijE,EADAyB,EAAaj/B,EAAeA,EAAS,IAAIm/B,EAAcA,EAEzD,CAGA1B,EAAWuB,GACPD,GAAepe,GAAYoe,GAE/BzB,GAAoB,GAEpB,UAEQpB,GAAK,CACT75D,QAAS28D,EACT58D,MAAO68D,GAEX,CAAE,MAAOjlE,GACPjC,EAAOiC,MAAM,qCAAsCA,EACrD,CAjC2C,CAkC7C,IAAC,gBAAA6B,EAAAC,GAAA,OAAA4F,EAAAzH,MAAA,KAAAC,UAAA,EAnCoC,GAmClC,CAACgiE,GAAM95D,EAAOsuD,GAAUwK,EAAWwC,IAGhC0B,IAA6B5oC,EAAAA,EAAAA,aAAY,WAAD,IAAA9mB,GAAArW,EAAAA,EAAAA,UAAC,UAAOgmE,GACpD,GAAKhB,GAAWtvC,UAAW2hC,GAA3B,CAEA34D,EAAOqE,KAAK,qDAGZ,IAAI6iE,EAAa78D,EACjB,GAAIi9D,IAAiBj9D,EAAO,CAC1B,IAAM88D,EAAQG,EAAa9iD,MAAM,KAC3B4iD,EAAYD,EAAMllC,MAAM,EAAG,GAAGp/B,KAAK,MAAQskE,EAAM3kE,OAAS,EAAI,MAAQ,IAG5EijE,EADAyB,EAAaE,EAEf,CAEA7B,GAAoB,GAEpB,UAEQpB,GAAK,CACT75D,QAASg9D,EACTj9D,MAAO68D,GAEX,CAAE,MAAOjlE,GACPjC,EAAOiC,MAAM,iDAAkDA,EACjE,CAxB2C,CAyB7C,IAAC,gBAAA+B,GAAA,OAAA2T,EAAAzV,MAAA,KAAAC,UAAA,EA1B8C,GA0B5C,CAACgiE,GAAM95D,EAAOsuD,KAEX4O,IAAuB9oC,EAAAA,EAAAA,cAAY,WAClC6nC,GAAWtvC,SAIhBh3B,EAAOqE,KAAK,uCACRqlB,EAAWg9C,aACbh9C,EAAWi9C,UALX3mE,EAAOmE,MAAM,4DAOjB,GAAG,CAACulB,IAGE89C,IAAc/oC,EAAAA,EAAAA,cAAY,WACzB6nC,GAAWtvC,SAIhBh3B,EAAOqE,KAAK,wCACRqlB,EAAWg9C,aACbh9C,EAAWi9C,UALX3mE,EAAOmE,MAAM,mDAOjB,GAAG,CAACulB,IAGE+9C,IAAiBhpC,EAAAA,EAAAA,aAAY,WAAD,IAAA1mB,GAAAzW,EAAAA,EAAAA,UAAC,UAAOy3D,GACxC,GAAKuN,GAAWtvC,QAAhB,CAIAh3B,EAAOqE,KAAK,sDAGZ,IAAIqjE,EAAWr9D,EACf,IAAKA,GAAS0uD,EAAmB,CAC/B,IAAMoO,EAAQpO,EAAkBv0C,MAAM,KAChC4iD,EAAYD,EAAMllC,MAAM,EAAG,GAAGp/B,KAAK,MAAQskE,EAAM3kE,OAAS,EAAI,MAAQ,IAG5EklE,EADuBN,EAEvB3B,EAFuB2B,EAGzB,CAeA,IAAMO,EAAW,CACft9D,MAAOq9D,EACPp9D,QAbE64D,GAAawC,EAEIA,EAAe,OAAO5M,EAGzBA,GAYlB,IACE,IAAM0L,QAAgBN,GAAKwD,EAAU,CACnCrD,QAAQ,IAGNG,EACFzkE,EAAOqE,KAAK,kDAAkDogE,GAO9DzkE,EAAOsC,KAAK,yDAEhB,CAAE,MAAOL,GACPjC,EAAOiC,MAAM,mCAAoCA,EACnD,CAlDA,MAFEjC,EAAOmE,MAAM,sDAqDjB,IAAC,gBAAA8I,GAAA,OAAA8K,EAAA7V,MAAA,KAAAC,UAAA,EAvDkC,GAuDhC,CAACgiE,GAAM95D,EAAO84D,EAAWwC,IAGtBiC,IAAqBnpC,EAAAA,EAAAA,cAAY,WACrC,OAAIk6B,GACK,CAAEr/C,KAAM,YAAaS,UAAU,EAAM4+C,UAAU,GAEpD2M,IAAqB3M,GAChB,CAAEr/C,KAAM,QAASS,UAAU,EAAM4+C,UAAU,GAE7C,CAAEr/C,KAAM,OAAQS,UAAU,EAAO4+C,UAAU,EACpD,GAAG,CAACA,GAAU2M,IAERuC,IAAwBppC,EAAAA,EAAAA,cAAY,WACxCz+B,EAAOqE,KAAK,gEACZqlB,EAAWi9C,QACb,GAAG,CAACj9C,IAEJ,OAAIrT,IAAcgvD,GAEdrgD,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOE,UAAUtL,SAAA,EAC5B4C,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAO62C,gBACpB7yC,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAO4jD,kBAAkBhvD,SAAA,EAEpCoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOo8B,YAAYxnC,SAAA,EAC9B4C,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAO6jD,eACpBrsD,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CACfF,MAAOlE,EAAOiB,YACdoD,QAASmiD,GACTM,QAAS,CAAE5M,IAAK,GAAIl6B,OAAQ,GAAIC,KAAM,GAAIC,MAAO,IAAKtrB,UAEtD4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CACP/U,KAAK,QACLvO,KAAM,GACNggB,MAAO1C,EAAMC,OAAOhG,sBAI1ByL,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAO2B,iBAAiB/M,SAAA,EACnC4C,EAAAA,EAAAA,KAACgN,GAAAA,QAAiB,CAACxjB,KAAK,QAAQggB,MAAO1C,EAAMC,OAAOzG,WACpDN,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO4B,YAAYhN,SAAC,kCAQzCoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOE,UAAUtL,SAAA,EAE1ButD,IAAa3qD,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAO62C,gBAEnCr/C,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAO2jD,iBAAiB/uD,SAClCyvD,GACCrgD,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAO4jD,kBAAkBhvD,SAAA,EAEpCoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOo8B,YAAYxnC,SAAA,EAC5ButD,IAAa3qD,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAO6jD,cAClC1B,IACC3qD,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOy+B,YAAY7pC,SAAC,kBAInC4C,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CACfF,MAAOlE,EAAOiB,YACdoD,QAASmiD,GACTM,QAAS,CAAE5M,IAAK,GAAIl6B,OAAQ,GAAIC,KAAM,GAAIC,MAAO,IAAKtrB,UAEtD4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CACP/U,KAAM4yD,EAAY,aAAe,QACjCnhE,KAAM,GACNggB,MAAO1C,EAAMC,OAAOhG,sBAM1ByL,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAO8jD,gBAAgBlvD,SAAA,EAClC4C,EAAAA,EAAAA,KAACuvD,GAAa,CACZzb,wBAAyBwa,GACzBva,SAAUgb,GACV9N,aAAcU,GACd1N,WAAYgb,GACZ1P,gBAAiB6P,KACjB7N,sBAAuBA,EACvBJ,kBAAmBkO,GACnB7P,gBAAiB2N,GAAmBr7D,EACpC2tD,uBAAwBoP,KAIzBlkB,OACC3qC,EAAAA,EAAAA,KAAC6hD,GAA0B,CACzBC,WAAYA,EACZj1C,QAAS,WAAF,OAAQqE,EAAW0B,SAAS,gBAAgB,WAM3DpG,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAO4jD,kBAAkBhvD,SAAA,EAEpCoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOo8B,YAAYxnC,SAAA,EAC9B4C,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAO6jD,eACpBrsD,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CACfF,MAAOlE,EAAOiB,YACdoD,QAASmiD,GACTM,QAAS,CAAE5M,IAAK,GAAIl6B,OAAQ,GAAIC,KAAM,GAAIC,MAAO,IAAKtrB,UAEtD4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CACP/U,KAAK,QACLvO,KAAM,GACNggB,MAAO1C,EAAMC,OAAOhG,sBAI1ByL,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAO2B,iBAAiB/M,SAAA,EACnC4C,EAAAA,EAAAA,KAACgN,GAAAA,QAAiB,CAACxjB,KAAK,QAAQggB,MAAO1C,EAAMC,OAAOzG,WACpDN,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO4B,YAAYhN,SAAC,oCAMxC+iD,KACC3zC,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAO+jD,cAAcnvD,SAAA,EAChC4C,EAAAA,EAAAA,KAACgN,GAAAA,QAAiB,CAACxjB,KAAK,QAAQggB,MAAO1C,EAAMC,OAAOzG,WACpDN,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO4B,YAAYhN,SAAC,yBAO3C,EC1eA,IAwKM6P,GAAY,SAACnG,EAAiBtd,GAClC,IAAM2f,EAAmB,UAAT3f,EAAmB,EAAa,UAATA,EAAmB,EAAI,EACxD8f,EAAoB,UAAT9f,EAAmB,GAAc,UAATA,EAAmB,GAAK,GAC3D+a,EAAmB,UAAT/a,EAAmB,EAAa,UAATA,EAAmB,EAAI,EAE9D,OAAOif,EAAAA,QAAWxb,OAAO,CACvByb,UAAW,CACTM,cAAe,MACfC,WAAY,SACZkf,SAAU,OACV2D,IAAKvnB,GAEPirD,eAAgB,CACdxmD,cAAe,MACfC,WAAY,UAEdo5C,UAAW,CACTr5C,cAAe,MACfC,WAAY,SACZa,kBAAmBX,EACnBU,gBAAiBV,EAAU,EAC3B1E,aAAc,GACdqnB,IAAK,GAEP2jC,cAAe,CACbnmD,SAAAA,EACAC,WAAY,MACZiB,WAAY1D,EAAM7D,WAAWC,aAAaE,QAE5CssD,cAAe,CAEf,GAEJ,EAEA,SA3M8D,SAAHxhE,GAMpD,IALLmG,EAAGnG,EAAHmG,IAAGs7D,EAAAzhE,EACH0hE,YAAAA,OAAW,IAAAD,GAAOA,EAAAE,EAAA3hE,EAClB4hE,kBAAAA,OAAiB,IAAAD,GAAOA,EACxBE,EAAe7hE,EAAf6hE,gBAAe/xC,EAAA9vB,EACf1E,KAAAA,OAAI,IAAAw0B,EAAG,SAAQA,EAEf,IAAK2sB,KACH,OAAO,KAET,IAAQ7jC,EAAUG,KAAVH,MACF0B,EAASyE,GAAUnG,EAAOtd,GAwD1BwmE,EArDuB,WAC3B,OAAQ37D,EAAI47D,gBACV,IAAK,WACH,MAAO,CACLzmD,MAAO,UACPsU,KAAM,mBACNsoB,MAAO,YAEX,IAAK,WACH,MAAO,CACL58B,MAAO,UACPsU,KAAM,SACNsoB,MAAO,YAEX,IAAK,SACH,MAAO,CACL58B,MAAO,UACPsU,KAAM,iBACNsoB,MAAO,UAEX,QACE,MAAO,CACL58B,MAAO,UACPsU,KAAM,iBACNsoB,MAAO,WAGf,CA0BqB8pB,GACfC,EAxBoB,WACxB,OAAQ97D,EAAI+7D,aACV,IAAK,SACH,MAAO,CACL5mD,MAAO,UACPsU,KAAM,MACNsoB,MAAO,UAEX,IAAK,SACH,MAAO,CACL58B,MAAO,UACPsU,KAAM,cACNsoB,MAAO,UAEX,QACE,MAAO,CACL58B,MAAO,UACPsU,KAAM,cACNsoB,MAAO,WAGf,CAGiBiqB,GAEjB,OACE7jD,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOE,UAAUtL,SAAA,CAE3B0yD,IACC9vD,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAOgnD,eAAepyD,UACjCoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAO,CAAClE,EAAO65C,UAAW,CAAEz5C,gBAAiBonD,EAAaxmD,MAAQ,OAAQpM,SAAA,EAC9E4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CACP/U,KAAMi4D,EAAalyC,KACnBt0B,KAAe,UAATA,EAAmB,GAAc,UAATA,EAAmB,GAAK,GACtDggB,MAAOwmD,EAAaxmD,QAEZ,UAAThgB,IACCwW,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAO,CAAClE,EAAOinD,cAAe,CAAEjmD,MAAOwmD,EAAaxmD,QAASpM,SAChE4yD,EAAa5pB,cAQxBpmC,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAOgnD,eAAepyD,UACjCoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAO,CAAClE,EAAO65C,UAAW,CAAEz5C,gBAAiBunD,EAAS3mD,MAAQ,OAAQpM,SAAA,EAC1E4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CACP/U,KAAMo4D,EAASryC,KACft0B,KAAe,UAATA,EAAmB,GAAc,UAATA,EAAmB,GAAK,GACtDggB,MAAO2mD,EAAS3mD,QAER,UAAThgB,IACCwW,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAO,CAAClE,EAAOinD,cAAe,CAAEjmD,MAAO2mD,EAAS3mD,QAASpM,SAC5D+yD,EAAS/pB,aAOjBwpB,GAAeG,IACd/vD,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CACfF,MAAOlE,EAAOknD,cACd7iD,QAAS,WAAF,OAAQkjD,EAAgB17D,EAAI3C,GAAG,EACtC+xC,mBAAmB,wBACnBD,kBAAkB,SAAQpmC,UAE1BoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAO,CAAClE,EAAO65C,UAAW,CAAEz5C,gBAAiB9B,EAAMC,OAAOzG,QAAU,OAAQlD,SAAA,EAChF4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CACP/U,KAAK,OACLvO,KAAe,UAATA,EAAmB,GAAc,UAATA,EAAmB,GAAK,GACtDggB,MAAO1C,EAAMC,OAAOzG,UAEZ,UAAT9W,IACCwW,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAO,CAAClE,EAAOinD,cAAe,CAAEjmD,MAAO1C,EAAMC,OAAOzG,UAAWlD,SAAC,iBAS7E/I,EAAIi8D,qBACHtwD,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAOgnD,eAAepyD,UACjCoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAO,CAAClE,EAAO65C,UAAW,CAAEz5C,gBAAiB,cAAoBxL,SAAA,EACrE4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CACP/U,KAAK,iBACLvO,KAAe,UAATA,EAAmB,GAAc,UAATA,EAAmB,GAAK,GACtDggB,MAAM,YAEE,UAAThgB,IACCwW,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAO,CAAClE,EAAOinD,cAAe,CAAEjmD,MAAO,YAAapM,SAAC,sBASlE/I,EAAIk8D,gBACHvwD,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAOgnD,eAAepyD,UACjCoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAO,CAAClE,EAAO65C,UAAW,CAAEz5C,gBAAiB,cAAoBxL,SAAA,EACrE4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CACP/U,KAAK,UACLvO,KAAe,UAATA,EAAmB,GAAc,UAATA,EAAmB,GAAK,GACtDggB,MAAM,YAEE,UAAThgB,IACCwW,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAO,CAAClE,EAAOinD,cAAe,CAAEjmD,MAAO,YAAapM,SAAC,oBASzE,E,+kBCjJA,IAyoBM6P,GAAY,SAACnG,GAAe,OAAK2B,EAAAA,QAAWxb,OAAO,CACvDyb,UAAW,CACTC,KAAM,EACNC,gBAAiB9B,EAAMC,OAAOpG,YAEhCE,KAAInQ,GAAA,CACFkY,gBAAiB9B,EAAMC,OAAOlG,KAC9BuwB,OAAQtqB,EAAMvC,QAAQX,GACtBuF,QAASrC,EAAMvC,QAAQV,GACvBY,aAAc,IACXqC,EAAMnC,QAAQjB,IAEnB7R,MAAO,CACLyX,SAAUxC,EAAM7D,WAAWO,UAAUK,GACrC0F,WAAY,OACZwB,UAAW,SACXD,aAAchE,EAAMvC,QAAQX,GAC5B4F,MAAO1C,EAAMC,OAAOjG,KACpB0J,WAAY1D,EAAM7D,WAAWC,aAAaI,MAE5CktD,YAAa,CACXlnD,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrCskB,WAAY,GACZld,UAAW,SACXD,aAAchE,EAAMvC,QAAQV,GAC5B2F,MAAO1C,EAAMC,OAAOhG,cACpByJ,WAAY1D,EAAM7D,WAAWC,aAAaC,SAI5CstD,iBAAkB,CAChB7nD,gBAAiB,UACjBuG,YAAa,UACbC,YAAa,EACb3K,aAAc,EACd0E,QAASrC,EAAMvC,QAAQX,GACvBkH,aAAchE,EAAMvC,QAAQV,IAE9B6sD,cAAe,CACb1nD,cAAe,MACfC,WAAY,SACZ6B,aAAchE,EAAMvC,QAAQZ,IAE9BgtD,aAAc,CACZrnD,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC4F,WAAY,OACZC,MAAO1C,EAAMC,OAAOtd,MACpB+jB,WAAY1G,EAAMvC,QAAQb,GAC1B8G,WAAY1D,EAAM7D,WAAWC,aAAaI,MAE5CstD,YAAa,CACXtnD,SAAUxC,EAAM7D,WAAWO,UAAUE,GACrC8F,MAAO,UACPye,WAAY,GACZnd,aAAchE,EAAMvC,QAAQb,GAC5B8G,WAAY1D,EAAM7D,WAAWC,aAAaC,SAE5C0tD,gBAAiB,CACfvnD,SAAUxC,EAAM7D,WAAWO,UAAUE,GACrC8F,MAAO,UACPye,WAAY,GACZ1e,WAAY,OACZuB,aAAchE,EAAMvC,QAAQZ,GAC5B6G,WAAY1D,EAAM7D,WAAWC,aAAaI,MAE5CwtD,YAAa,CACXzmD,UAAWvD,EAAMvC,QAAQb,IAE3BqtD,gBAAiB,CACfznD,SAAUxC,EAAM7D,WAAWO,UAAUE,GACrC6F,WAAY,MACZC,MAAO,UACPsB,aAAchE,EAAMvC,QAAQd,GAC5B+G,WAAY1D,EAAM7D,WAAWC,aAAaG,UAE5C2tD,WAAY,CACV1nD,SAAUxC,EAAM7D,WAAWO,UAAUE,GACrC8F,MAAO,UACPye,WAAY,GACZzd,WAAY1D,EAAM7D,WAAWC,aAAaC,QAC1CwF,KAAM,GAERsoD,eAAgB,CACdnmD,aAAc,EACd9B,cAAe,MACfC,WAAY,cAEdioD,cAAe,CACbpsD,MAAO,EACPC,OAAQ,EACRN,aAAc,EACdmE,gBAAiB,UACjByB,UAAW,EACX4F,YAAanJ,EAAMvC,QAAQd,IAI7B2P,iBAAgB1iB,GAAA,CACdiY,KAAM,EACNC,gBAAiB9B,EAAMC,OAAOlG,KAC9BuwB,OAAQtqB,EAAMvC,QAAQX,GACtBuF,QAASrC,EAAMvC,QAAQV,GACvBY,aAAc,GACdwE,WAAY,SACZC,eAAgB,UACbpC,EAAMnC,QAAQjB,IAEnBytD,YAAa,CACXrmD,aAAchE,EAAMvC,QAAQV,IAE9ButD,aAAc,CACZ9nD,SAAUxC,EAAM7D,WAAWO,UAAUM,IACrCyF,WAAY,OACZC,MAAO1C,EAAMC,OAAO3P,SAAW,UAC/B2T,UAAW,SACXD,aAAchE,EAAMvC,QAAQV,GAC5B2G,WAAY1D,EAAM7D,WAAWC,aAAaI,MAE5C+tD,eAAgB,CACdvsD,MAAO,OACPgG,aAAchE,EAAMvC,QAAQV,IAE9BytD,aAAc,CACZhoD,SAAUxC,EAAM7D,WAAWO,UAAUE,GACrC8F,MAAO1C,EAAMC,OAAOhG,cACpBwI,WAAY,MACZuB,aAAchE,EAAMvC,QAAQd,GAC5B+G,WAAY1D,EAAM7D,WAAWC,aAAaG,UAE5CkuD,aAAc,CACZjoD,SAAUxC,EAAM7D,WAAWO,UAAUI,GACrC4F,MAAO1C,EAAMC,OAAOjG,KACpByI,WAAY,OACZuB,aAAchE,EAAMvC,QAAQX,GAC5B4G,WAAY1D,EAAM7D,WAAWC,aAAaI,MAE5CkuD,oBAAqB,CACnB1sD,MAAO,OACPgG,aAAchE,EAAMvC,QAAQV,IAE9B4tD,uBAAwB,CACtBnoD,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC6F,MAAO1C,EAAMC,OAAOhG,cACpBgK,UAAW,SACXkd,WAAY,GACZzd,WAAY1D,EAAM7D,WAAWC,aAAaC,SAE5CuuD,eAAgB,CACd9oD,gBAAiB9B,EAAMC,OAAOzG,QAC9BwJ,kBAAmBhD,EAAMvC,QAAQV,GACjCgG,gBAAiB/C,EAAMvC,QAAQX,GAC/Ba,aAAc,EACdk+C,SAAU,KAEZgP,mBAAoB,CAClBnoD,MAAO1C,EAAMC,OAAOpG,WACpB2I,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC4F,WAAY,MACZwB,UAAW,SACXP,WAAY1D,EAAM7D,WAAWC,aAAaG,UAI5CuuD,yBAA0B,CACxBthD,eAAgBxJ,EAAMvC,QAAQZ,GAC9BsF,WAAY,UAEd4oD,eAAgB,CACd7oD,cAAe,MACfJ,gBAAiB,UACjBO,QAASrC,EAAMvC,QAAQZ,GACvBc,aAAc,EACd4F,UAAWvD,EAAMvC,QAAQZ,GACzBmuD,gBAAiB,EACjBC,gBAAiB,WAEnBC,mBAAoB,CAClB/hD,YAAanJ,EAAMvC,QAAQb,GAC3B2G,UAAW,GAEb4nD,mBAAoB,CAClBtpD,KAAM,EACNW,SAAUxC,EAAM7D,WAAWO,UAAUE,GACrC8F,MAAO,UACPye,WAAY,GACZzd,WAAY1D,EAAM7D,WAAWC,aAAaC,SAE5C+uD,uBAAwB,CACtB3oD,WAAY,MACZiB,WAAY1D,EAAM7D,WAAWC,aAAaG,UAI5C8uD,oBAAqB,CACnBrnD,aAAchE,EAAMvC,QAAQX,GAC5BgF,gBAAiB9B,EAAMC,OAAOnG,QAC9BuI,QAASrC,EAAMvC,QAAQZ,GACvBc,aAAc,GAEhB2tD,gBAAiB,CACf9oD,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC4F,WAAY,MACZuB,aAAchE,EAAMvC,QAAQZ,GAC5B6F,MAAO1C,EAAMC,OAAOjG,KACpB0J,WAAY1D,EAAM7D,WAAWC,aAAaG,UAE5CgvD,iBAAkB,CAChBrpD,cAAe,MACfC,WAAY,SACZC,eAAgB,iBAElBopD,eAAgB,CACd3pD,KAAM,EACNsH,YAAanJ,EAAMvC,QAAQZ,IAE7B4uD,gBAAiB,CACfjpD,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC4F,WAAY,MACZC,MAAO1C,EAAMC,OAAOjG,KACpB0J,WAAY1D,EAAM7D,WAAWC,aAAaE,QAE5CovD,sBAAuB,CACrBlpD,SAAUxC,EAAM7D,WAAWO,UAAUE,GACrC8F,MAAO1C,EAAMC,OAAOhG,cACpBsJ,UAAW,EACXG,WAAY1D,EAAM7D,WAAWC,aAAaC,SAI5CsvD,uBAAwB,CACtBpoD,UAAWvD,EAAMvC,QAAQZ,IAE3B+uD,mBAAoB,CAClBppD,SAAUxC,EAAM7D,WAAWO,UAAUE,GACrC6F,WAAY,MACZuB,aAAchE,EAAMvC,QAAQb,GAC5B8F,MAAO1C,EAAMC,OAAOjG,KACpB0J,WAAY1D,EAAM7D,WAAWC,aAAaG,UAE5CsvD,yBAA0B,CACxBrpD,SAAUxC,EAAM7D,WAAWO,UAAUE,GACrC8F,MAAO1C,EAAMC,OAAOhG,cACpB+J,aAAchE,EAAMvC,QAAQZ,GAC5B6G,WAAY1D,EAAM7D,WAAWC,aAAaC,SAE5CyvD,gBAAiB,CACf5pD,cAAe,MACfC,WAAY,SACZE,QAASrC,EAAMvC,QAAQZ,GACvBc,aAAc,EACd2K,YAAa,EACbD,YAAa,UACbvG,gBAAiB,aAEnBiqD,iBAAkB,CAChBrlD,WAAY1G,EAAMvC,QAAQb,GAC1B4F,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC6F,MAAO,UACPgB,WAAY1D,EAAM7D,WAAWC,aAAaG,SAC1CkG,WAAY,OAIduG,eAAgB,CACdhF,aAAchE,EAAMvC,QAAQX,IAE9BwiC,MAAO,CACL98B,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC4F,WAAY,MACZuB,aAAchE,EAAMvC,QAAQb,GAC5B8F,MAAO1C,EAAMC,OAAOjG,KACpB0J,WAAY1D,EAAM7D,WAAWC,aAAaG,UAE5C6M,MAAO,CACLd,YAAa,EACbD,YAAarI,EAAMC,OAAO9F,OAC1BwD,aAAc,EACd0E,QAASrC,EAAMvC,QAAQZ,GACvB2F,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrCiF,gBAAiB9B,EAAMC,OAAOlG,KAC9B2I,MAAO1C,EAAMC,OAAOjG,KACpB0J,WAAY1D,EAAM7D,WAAWC,aAAaC,SAE5C2vD,WAAY,CACV3jD,YAAa,WAEf4jD,WAAY,CACV5jD,YAAarI,EAAMC,OAAOtd,OAE5BupE,oBAAqB,CACnB3oD,UAAWvD,EAAMvC,QAAQd,GACzBqG,kBAAmBhD,EAAMvC,QAAQd,GACjCoG,gBAAiB,EACjBpF,aAAc,EACd0I,UAAW,IAEb8lD,kBAAmB,CACjBrqD,gBAAiB,WAEnBsqD,gBAAiB,CACftqD,gBAAiB,WAEnBuqD,eAAgB,CACd7pD,SAAUxC,EAAM7D,WAAWO,UAAUE,GACrC8G,WAAY1D,EAAM7D,WAAWC,aAAaC,QAC1C8kB,WAAY,IAEdmrC,sBAAuB,CACrB5pD,MAAO,WAET6pD,oBAAqB,CACnB7pD,MAAO1C,EAAMC,OAAOtd,OAEtB6pE,UAAW,CACTtqD,cAAe,MACfmf,SAAU,OACVjf,eAAgB,iBAElBqqD,YAAa,CACXzuD,MAAO,GACPC,OAAQ,GACRN,aAAc,GACdqG,aAAchE,EAAMvC,QAAQb,GAC5BwF,eAAgB,SAChBD,WAAY,SACZmG,YAAa,EACbD,YAAa,eAEfqkD,oBAAqB,CACnBrkD,YAAarI,EAAMC,OAAOjG,KAC1BsO,YAAa,GAGfqkD,gBAAiB,CACfzqD,cAAe,MACfE,eAAgB,gBAChB4B,aAAchE,EAAMvC,QAAQX,IAE9BsJ,OAAQ,CACNvE,KAAM,EACNQ,QAASrC,EAAMvC,QAAQX,GACvBa,aAAc,EACdwE,WAAY,SACZc,iBAAkBjD,EAAMvC,QAAQb,IAElC25B,aAAc,CACZz0B,gBAAiB9B,EAAMC,OAAOzG,SAEhCozD,aAAc,CACZ9qD,gBAAiB,cACjBwG,YAAa,EACbD,YAAarI,EAAMC,OAAOhG,eAE5BwM,WAAY,CACV/D,MAAO1C,EAAMC,OAAOpG,WACpB2I,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC4F,WAAY,MACZiB,WAAY1D,EAAM7D,WAAWC,aAAaG,UAE5CswD,iBAAkB,CAChBnqD,MAAO1C,EAAMC,OAAOhG,cACpBuI,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC4F,WAAY,MACZiB,WAAY1D,EAAM7D,WAAWC,aAAaG,WAE3C,EAEH,SAx/BsD,SAAHnV,GAK5C,IAJL0lE,EAAY1lE,EAAZ0lE,aACA7f,EAAQ7lD,EAAR6lD,SAAQ8f,EAAA3lE,EACR4lE,iBAAAA,OAAgB,IAAAD,EAAG,GAAEA,EAAAE,EAAA7lE,EACrB8lE,iBAAAA,OAAgB,IAAAD,GAAOA,EAEvB,IAAKppB,KACH,OAAO,KAET,IAAQ7jC,EAAUG,KAAVH,MACF0B,EAASyE,GAAUnG,GAEzBzJ,GAA8BC,EAAAA,EAAAA,UAAS,IAAGC,GAAAC,EAAAA,EAAAA,SAAAH,EAAA,GAAnCnJ,EAAOqJ,EAAA,GAAE02D,EAAU12D,EAAA,GAC1BI,GAAgDL,EAAAA,EAAAA,UAAS,IAAGM,GAAAJ,EAAAA,EAAAA,SAAAG,EAAA,GAArDu2D,EAAgBt2D,EAAA,GAAEu2D,EAAmBv2D,EAAA,GAC5CG,GAAoDT,EAAAA,EAAAA,UAAS,IAAGU,GAAAR,EAAAA,EAAAA,SAAAO,EAAA,GAAzDq2D,EAAkBp2D,EAAA,GAAEq2D,EAAqBr2D,EAAA,GAChDG,GAA0Cb,EAAAA,EAAAA,UAAS,WAAUc,GAAAZ,EAAAA,EAAAA,SAAAW,EAAA,GAAtDm2D,EAAal2D,EAAA,GAAEm2D,EAAgBn2D,EAAA,GACtCoT,GAAkClU,EAAAA,EAAAA,WAAS,GAAMmU,GAAAjU,EAAAA,EAAAA,SAAAgU,EAAA,GAA1C3T,EAAS4T,EAAA,GAAE3T,EAAY2T,EAAA,GAC9BE,GAA0CrU,EAAAA,EAAAA,WAAS,GAAKsU,GAAApU,EAAAA,EAAAA,SAAAmU,EAAA,GAAjD6iD,EAAa5iD,EAAA,GACpBsC,GADsCtC,EAAA,IACdtU,EAAAA,EAAAA,UAAkC,aAAnDm3D,GAA8Dj3D,EAAAA,EAAAA,SAAA0W,EAAA,GAAjD,GACpBE,GAAgD9W,EAAAA,EAAAA,WAAS,GAAM+W,GAAA7W,EAAAA,EAAAA,SAAA4W,EAAA,GAAtCsgD,GAAFrgD,EAAA,GAAqBA,EAAA,IAC5CkhC,GAAsCj4C,EAAAA,EAAAA,UAK5B,MAAKk4C,GAAAh4C,EAAAA,EAAAA,SAAA+3C,EAAA,GALRof,EAAWnf,EAAA,GAAEof,EAAcpf,EAAA,GA0B5Bqf,GAAkB5uC,EAAAA,EAAAA,cAAY,SAACluB,GACnC,OAAKA,EAAKyW,OAINzW,EAAK/N,OAAS,EACT,yCAGL+N,EAAK/N,OAAS,GACT,2CAGL8pE,EAAiBz8C,MAAK,SAAAy9C,GAAQ,OAAIA,EAASxgC,gBAAkBv8B,EAAKu8B,aAAa,IAC1E,sCAGF,KAfE,0BAgBX,GAAG,CAACw/B,IAKEiB,GAAiB9uC,EAAAA,EAAAA,cAAY,SAAC2U,GAClC,IAAKA,EAAOpsB,OACV,MAAO,oCAGT,GAAIosB,EAAO5wC,OAAS,EAClB,MAAO,kDAGT,GAAI4wC,EAAO5wC,OAAS,IAClB,MAAO,qDAKT,MADoB,CAAC,MAAO,MAAO,KAAM,MAAO,KAAM,KAAM,KAAM,KAAM,MAAO,KAAM,OAAQ,MAC7EO,SAASqwC,EAAOtG,cAAc9lB,QACrC,oEAGF,IACT,GAAG,IAKGwmD,GAAuB/uC,EAAAA,EAAAA,cAAY,SAAC2U,EAAgBq6B,GACxD,OAAKA,EAAazmD,OAIdosB,IAAWq6B,EACN,uBAGF,KAPE,uCAQX,GAAG,IAKGC,GAAkBjvC,EAAAA,EAAAA,cAAWn9B,EAAAA,EAAAA,UAAC,YAElC,IAAMqsE,EAAYN,EAAgB3gE,GAClC,GAAIihE,EACFpmC,GAAAA,QAAMC,MAAM,eAAgBmmC,OAD9B,CAKA,IAAMC,EAAcL,EAAeb,GACnC,GAAIkB,EACFrmC,GAAAA,QAAMC,MAAM,iBAAkBomC,OADhC,CAMA,IAAMC,EAAeL,EAAqBd,EAAkBE,GAC5D,GAAIiB,EACFtmC,GAAAA,QAAMC,MAAM,uBAAwBqmC,OADtC,CAKAv3D,GAAa,GAEb,IAAK,IAADw3D,EAAAC,EAAAC,EAAAC,EACI76B,EAASs5B,EAAiB1lD,OAEhChnB,EAAOqE,KAAK,qEAA4D,CACtEqI,QAASA,EAAQsa,OACjBknD,aAAc96B,EAAO5wC,OACrB2vB,WAAW,IAAInvB,MAAOC,gBAIxB,IAQIiL,EAREoE,EAAa3E,EAAkB4E,cAG/B47D,EAAmB,cAAiBzhE,EAAQsa,OAAO8lB,cAAczmC,QAAQ,OAAQ,KAAI,IAAIrD,KAAKorB,MAEpGpuB,EAAOqE,KAAK,+DAIZ,IAAK,IAAD+pE,EAAAC,EAEFngE,SADqBoE,EAAWtE,kBAAkBolC,EAAQ+6B,IAC7BjgE,oBAE7BlO,EAAOqE,KAAK,mDAAoD,CAC9DiqE,+BAAgCpgE,EAChCC,0BAA8C,OAArBigE,EAAElgE,QAAmB,EAAnBkgE,EAAqB5rE,OAChD+rE,0BAA8C,OAArBF,EAAEngE,QAAmB,EAAnBmgE,EAAqBpsC,MAAM,EAAG,IACzDusC,wBAAyBtgE,GAE7B,CAAE,MAAOjM,GAEP,MADAjC,EAAOiC,MAAM,gDAAiDA,GACxD,IAAI2B,MAAM,qCAAoC3B,aAAiB2B,MAAQ3B,EAAMW,QAAU2uB,OAAOtvB,IACtG,CAEAjC,EAAOqE,KAAK,kDAGZ,IAAMoqE,EAAc,CAClBh+D,4BAA6BvC,EAC7BwgE,SAAUhiE,EAAQsa,OAClBhF,MAAO8qD,GAGT9sE,EAAOqE,KAAK,sCAAuC,CACjDsqE,mCAAuD,OAArBb,EAAE5/D,QAAmB,EAAnB4/D,EAAqBtrE,OACzDosE,wCAAyC1gE,EACzC2gE,mCAAuD,OAArBd,EAAE7/D,QAAmB,EAAnB6/D,EAAqB9rC,MAAM,EAAG,IAClEysC,SAAUD,EAAYC,SACtB1sD,MAAOysD,EAAYzsD,QAIrB,IAWIpT,EATJ09B,SAFuB/mC,EAAIoD,KAAK,qCAAsC8lE,IAE0BrrE,KAA1DkL,EAAoBg+B,EAAlD57B,6BAAoDC,EAAU27B,EAAV37B,WAAsB27B,EAAVwiC,WAExE,IAAKxgE,EACH,MAAM,IAAI1K,MAAM,wCAGlB5D,EAAOqE,KAAK,0CAIZ,IAAK,IAAD0qE,EAAAC,EACFpgE,QAA2B0D,EAAWzD,mBAAmBs/D,EAAqB7/D,GAE9EtO,EAAOqE,KAAK,oDAAqD,CAC/D4qE,8BAA+BrgE,EAC/BiC,yBAA4C,OAApBk+D,EAAEngE,QAAkB,EAAlBmgE,EAAoBvsE,OAC9CsO,yBAA4C,OAApBk+D,EAAEpgE,QAAkB,EAAlBogE,EAAoB/sC,MAAM,EAAG,IACvDitC,uBAAwBtgE,GAE5B,CAAE,MAAO3M,GAEP,MADAjC,EAAOiC,MAAM,iDAAkDA,GACzD,IAAI2B,MAAM,sCAAqC3B,aAAiB2B,MAAQ3B,EAAMW,QAAU2uB,OAAOtvB,IACvG,CAEA,IAAK2M,EACH,MAAM,IAAIhL,MAAM,0CAGlB5D,EAAOqE,KAAK,+CAAgD,CAC1DiqE,+BAAgCpgE,EAChCC,0BAA8C,OAArB6/D,EAAE9/D,QAAmB,EAAnB8/D,EAAqBxrE,OAChD2sE,yBAA0BjhE,EAC1B+gE,8BAA+BrgE,EAC/BiC,yBAA4C,OAApBo9D,EAAEr/D,QAAkB,EAAlBq/D,EAAoBzrE,OAC9C4sE,wBAAyBxgE,IAITlM,MAAM0R,KAAK,CAAE5R,OAAQ,KAAM,kBAAMge,KAAKqf,MAAsB,IAAhBrf,KAAKm1C,SAAe,IAIlF31D,EAAOqE,KAAK,yCAA0C,CACpDiqE,+BAAgCpgE,EAChCC,0BAA2BD,EAAoB1L,OAC/C+rE,0BAA2BrgE,EAAoB+zB,MAAM,EAAG,IACxDgtC,8BAA+BrgE,EAC/BiC,yBAA0BjC,EAAmBpM,OAC7CsO,yBAA0BlC,EAAmBqzB,MAAM,EAAG,MAIxDjiC,EAAOqE,KAAK,8CAAqC,CAC/CiqE,+BAAgCpgE,EAChCihE,yBAA0BjhE,EAC1B+gE,8BAA+BrgE,EAC/BwgE,wBAAyBxgE,IAI3B,IAAMygE,EAAiB,SAACjsE,EAAcmN,GACpC,IAEE,IAAM++D,EAAiBlsE,EAAKiD,QAAQ,KAAM,KAAKA,QAAQ,KAAM,KAEvDsb,EAAU2tD,EAAe9sE,OAAS,EAClC+sE,EAAa5tD,EAAU2tD,EAAiB,IAAIt8D,OAAO,EAAI2O,GAAW2tD,EAClEE,EAAat8D,KAAKq8D,GACxBvvE,EAAOqE,KAAK,UAAKkM,EAAI,6BAA6Bi/D,EAAWhtE,OAAM,IACrE,CAAE,MAAOP,GAEP,MADAjC,EAAOiC,MAAM,UAAKsO,EAAI,6BAA8BtO,GAC9C,IAAI2B,MAAS2M,EAAI,iCACzB,CACF,EAEA,IACEvQ,EAAOqE,KAAK,iDACZgrE,EAAenhE,EAAqB,uBACpCmhE,EAAezgE,EAAoB,sBACnC5O,EAAOqE,KAAK,6CACd,CAAE,MAAOpC,GAEP,MADAjC,EAAOiC,MAAM,4BAA6BA,GACpC,IAAI2B,MAAM,kCAClB,CAEA,IAAM6rE,QAAuBlqE,EAAIoD,KAAK,sCAAuC,CAC3EgI,WAAYA,EACZC,2BAA4BhC,IAG9B,IAAK6gE,EAAersE,KAClB,MAAM,IAAIQ,MAAM,6CAOlB,IAAM8rE,EAAYD,EAAersE,KAC3B0tC,EAAQ4+B,EAAUC,OAGlBC,EAA8B,CAClC1lE,GAAI4mC,EACJ49B,SAAUgB,EAAUhB,SACpBmB,WAAYH,EAAUG,WACtB53D,WAAYy3D,EAAUz3D,WACtBC,WAAYw3D,EAAUx3D,WACtB43D,QAASJ,EAAUI,SAAW,EAC9BlH,YAAa,SACbH,eAAgBwE,EAChB8C,qBAAsB,GAGxB/vE,EAAOqE,KAAK,0CAA2CysC,GAGvDs8B,EAAe,CACb1gE,QAASA,EAAQsa,OACjBosB,OAAAA,EACA48B,UAAU,EACVnjE,IAAK+iE,IAIPnD,EAAW,IACXE,EAAoB,IACpBE,EAAsB,IACtBE,EAAiB,WACjBG,GAAoB,GAGpBxtC,YAAW,WACG,MAAZ0sC,GAAAA,EAAet7B,EACjB,GAAG,IAEL,CAAE,MAAO7uC,GAIP,GAHAjC,EAAOiC,MAAM,+BAAgCA,GAGzCA,GAA0B,kBAAVA,GAAsB,aAAcA,EAAO,CAAC,IAADguE,EAAAC,EACvD/oE,EAAYlF,EAAckF,SACpB,MAARA,GAAc,OAAN8oE,EAAR9oE,EAAU/D,OAAV6sE,EAAgBxmE,QAClBzJ,EAAOiC,MAAM,mCAAoCkF,EAAS/D,KAAKqG,QAErD,MAARtC,GAAc,OAAN+oE,EAAR/oE,EAAU/D,OAAV8sE,EAAgB3mE,QAClBvJ,EAAOiC,MAAM,6BAA8BkF,EAAS/D,KAAKmG,OAE7D,CAEAg+B,GAAAA,QAAMC,MACJ,kBACAvlC,aAAiB2B,MAAQ3B,EAAMW,QAAU,8BAE7C,CAAC,QACC0T,GAAa,EACf,CAtNA,CAPA,CANA,CAoOF,IAAG,CACD5J,EACAggE,EACAE,EACAE,EACAG,EACAI,EACAE,EACAC,EACApB,IAIF,OAAIe,GAEA30D,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAOE,UAAUtL,UAC5BoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAO4K,iBAAiBhW,SAAA,EACnC4C,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAO2oD,YAAY/zD,UAC9B4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CACP/U,KAAM48D,EAAY6C,SAAW,mBAAqB,mBAClDhuE,KAAM,GACNggB,MAAOmrD,EAAY6C,SAAW,UAAa1wD,EAAMC,OAAO3P,SAAW,eAIvE4I,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO4oD,aAAah0D,SAC9Bu3D,EAAY6C,SAAW,6BAA+B,wBAIxD7C,EAAY6C,UAAY7C,EAAYtgE,MACnC2L,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAOopD,yBAAyBx0D,UAC3C4C,EAAAA,EAAAA,KAAC23D,GAAkB,CACjBtjE,IAAKsgE,EAAYtgE,IACjBu7D,aAAa,EACbE,mBAAmB,EACnBtmE,KAAK,aAKXgjB,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAO6oD,eAAej0D,SAAA,EACjC4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO8oD,aAAal0D,SAAC,eAClC4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO+oD,aAAan0D,SAAEu3D,EAAYzgE,WAE/C8L,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO8oD,aAAal0D,SAAC,wBAClCoP,EAAAA,EAAAA,MAACO,EAAAA,QAAI,CAACL,MAAOlE,EAAO+oD,aAAan0D,SAAA,CAAC,IAAEu3D,EAAY/5B,OAAO,OAEtD+5B,EAAY6C,WACXhrD,EAAAA,EAAAA,MAAA+oB,EAAAA,SAAA,CAAAn4B,SAAA,EACE4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO8oD,aAAal0D,SAAC,qBAClC4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO+oD,aAAan0D,SAAC,iCAKxC4C,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAOgpD,oBAAoBp0D,UACtC4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOipD,uBAAuBr0D,SAAC,oKAM7Cu3D,EAAY6C,WACXhrD,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOqpD,eAAez0D,SAAA,EACjC4C,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAOwpD,mBAAmB50D,UACrC4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,UAAUvO,KAAM,GAAIggB,MAAM,eAE3CgD,EAAAA,EAAAA,MAACO,EAAAA,QAAI,CAACL,MAAOlE,EAAOypD,mBAAmB70D,SAAA,EACrC4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO0pD,uBAAuB90D,SAAC,eAAiB,4HAMnE4C,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CACfF,MAAOlE,EAAOkpD,eACd7kD,QAAS,WACP+nD,EAAe,MACH,MAAZhB,GAAAA,EAAee,EAAYzgE,QAC7B,EAAEkJ,UAEF4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOmpD,mBAAmBv0D,SAAC,qBAQhD4C,EAAAA,EAAAA,KAACmI,GAAAA,QAAU,CAACuE,MAAOlE,EAAOE,UAAUtL,UAClCoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAO3H,KAAKzD,SAAA,EACvB4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO3W,MAAMuL,SAAC,uBAE3B4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOgoD,YAAYpzD,SAAC,2KAMjCoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOiqD,uBAAuBr1D,SAAA,EACzC4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOkqD,mBAAmBt1D,SAAC,oBACxC4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOmqD,yBAAyBv1D,SAAC,qKAI9CoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOoqD,gBAAgBx1D,SAAA,EAClC4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CACP/U,KAAK,mBACLvO,KAAM,GACNggB,MAAM,aAERxJ,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOqqD,iBAAiBz1D,SAAC,gDAO1CoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOioD,iBAAiBrzD,SAAA,EACnCoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOkoD,cAActzD,SAAA,EAChC4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,UAAUvO,KAAM,GAAIggB,MAAO1C,EAAMC,OAAOtd,SACvDuW,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOmoD,aAAavzD,SAC9Bo3D,GAAiBR,EACd,2CACA,0CAKRh0D,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOooD,YAAYxzD,SAAC,sKAKjC4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOqoD,gBAAgBzzD,SAAC,4HAIrC4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOqoD,gBAAgBzzD,SAAC,wFAIrCoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOsoD,YAAY1zD,SAAA,EAC9B4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOuoD,gBAAgB3zD,SAAC,mCACrCoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOyoD,eAAe7zD,SAAA,EACjC4C,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAO0oD,iBACpBlxD,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOwoD,WAAW5zD,SAAC,+CAElCoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOyoD,eAAe7zD,SAAA,EACjC4C,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAO0oD,iBACpBlxD,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOwoD,WAAW5zD,SAAC,wDAElCoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOyoD,eAAe7zD,SAAA,EACjC4C,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAO0oD,iBACpBlxD,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOwoD,WAAW5zD,SAAC,wCAEjCo3D,GAAiBR,IAChBxnD,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOyoD,eAAe7zD,SAAA,EACjC4C,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAO0oD,iBACpBlxD,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOwoD,WAAW5zD,SAAC,mEAOxCoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOsH,eAAe1S,SAAA,EACjC4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO49B,MAAMhpC,SAAC,cAC3B4C,EAAAA,EAAAA,KAACmS,GAAAA,QAAS,CACRzF,MAAO,CACLlE,EAAO0H,MACPhc,GAAW2gE,EAAgB3gE,GAAWsU,EAAOuqD,WAAavqD,EAAOsqD,YAEnElqE,MAAOsL,EACPme,aAAc4hD,EACd7hD,YAAY,wCACZG,eAAe,QACfC,aAAa,EACb+W,UAAW,MAEbvpB,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAO,CACXlE,EAAOwqD,oBACP9+D,GAAW2gE,EAAgB3gE,GAAWsU,EAAO0qD,gBAAkB1qD,EAAOyqD,mBACtE71D,UACA4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAO,CACXlE,EAAO2qD,eACPj/D,GAAW2gE,EAAgB3gE,GAAWsU,EAAO6qD,oBAAsB7qD,EAAO4qD,uBAC1Eh2D,SACClJ,GAAW2gE,EAAgB3gE,GAAW2gE,EAAgB3gE,GAAWA,EAAU,6BAA0B,kCAM5GsY,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOsH,eAAe1S,SAAA,EACjC4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO49B,MAAMhpC,SAAC,uBAC3B4C,EAAAA,EAAAA,KAACmS,GAAAA,QAAS,CACRzF,MAAO,CACLlE,EAAO0H,MACPgkD,GAAoBa,EAAeb,GAAoB1rD,EAAOuqD,WAAavqD,EAAOsqD,YAEpFlqE,MAAOsrE,EACP7hD,aAAc8hD,EACd/hD,YAAY,6CACZG,eAAe,OACfC,aAAa,EACb+W,UAAW,OAEbvpB,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAO,CACXlE,EAAOwqD,oBACPkB,GAAoBa,EAAeb,GAAoB1rD,EAAO0qD,gBAAkB1qD,EAAOyqD,mBACvF71D,UACA4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAO,CACXlE,EAAO2qD,eACPe,GAAoBa,EAAeb,GAAoB1rD,EAAO6qD,oBAAsB7qD,EAAO4qD,uBAC3Fh2D,SACC82D,GAAoBa,EAAeb,GAAoBa,EAAeb,GAAoBA,EAAmB,sCAAmC,0CAMtJM,GAAiBR,IAChBxnD,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOsH,eAAe1S,SAAA,EACjC4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO49B,MAAMhpC,SAAC,+BAC3B4C,EAAAA,EAAAA,KAACmS,GAAAA,QAAS,CACRzF,MAAO,CACLlE,EAAO0H,MACPkkD,GAAsBY,EAAqBd,EAAkBE,GAAsB5rD,EAAOuqD,WAAavqD,EAAOsqD,YAEhHlqE,MAAOwrE,EACP/hD,aAAcgiD,EACdjiD,YAAY,kCACZG,eAAe,OACfC,aAAa,EACb+W,UAAW,OAEbvpB,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAO,CACXlE,EAAOwqD,oBACPoB,GAAsBY,EAAqBd,EAAkBE,GAAsB5rD,EAAO0qD,gBAAkB1qD,EAAOyqD,mBACnH71D,UACA4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAO,CACXlE,EAAO2qD,eACPiB,GAAsBY,EAAqBd,EAAkBE,GAAsB5rD,EAAO6qD,oBAAsB7qD,EAAO4qD,uBACvHh2D,SACCg3D,GAAsBY,EAAqBd,EAAkBE,GAC1DY,EAAqBd,EAAkBE,GACvCA,GAAsBF,IAAqBE,EACzC,uBACA,yCAQd5nD,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOsH,eAAe1S,SAAA,EACjC4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO49B,MAAMhpC,SAAC,eAC3B4C,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAO8qD,UAAUl2D,SA/jBjB,CACnB,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAojBsBmmB,KAAI,SAAC/Z,GAAK,OACtBxJ,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CAEfF,MAAO,CACLlE,EAAO+qD,YACP,CAAE3qD,gBAAiBY,GACnB8qD,IAAkB9qD,GAAShB,EAAOgrD,qBAEpC3mD,QAAS,WAAF,OAAQ0nD,EAAiB/qD,EAAM,EAACpM,SAEtCk3D,IAAkB9qD,IACjBxJ,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,YAAYvO,KAAM,GAAIggB,MAAO1C,EAAMC,OAAOpG,cATtD6I,EAWY,UAMzBgD,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOirD,gBAAgBr2D,SAAA,EAClC4C,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CACfF,MAAO,CAAClE,EAAO0E,OAAQ1E,EAAOkrD,cAC9B7mD,QAASknC,EACTxyC,SAAU1D,EAAUT,UAEpB4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOmrD,iBAAiBv2D,SAAC,cAGxC4C,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CACfF,MAAO,CAAClE,EAAO0E,OAAQ1E,EAAO60B,cAC9BxwB,QAASqoD,EACT3zD,SAAU1D,IAAc3J,IAAYggE,EAAiB92D,SAEpDS,GACCmC,EAAAA,EAAAA,KAACgN,GAAAA,QAAiB,CAACxD,MAAM,aAEzBxJ,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO+E,WAAWnQ,SAAC,+BAO9C,EC5oBA,IAoLM6P,GAAY,SAACnG,GAAe,OAAK2B,EAAAA,QAAWxb,OAAO,CACvDyb,UAAW,CACTC,KAAM,EACNC,gBAAiB9B,EAAMC,OAAOpG,YAEhC7O,QAAS,CACP6W,KAAM,EACNQ,QAASrC,EAAMvC,QAAQX,IAEzBmF,OAAQ,CACN+B,aAAchE,EAAMvC,QAAQV,GAC5BoF,WAAY,UAEdpX,MAAO,CACLyX,SAAUxC,EAAM7D,WAAWO,UAAUM,IACrCyF,WAAY,OACZC,MAAO1C,EAAMC,OAAOjG,KACpBiK,UAAW,SACXD,aAAchE,EAAMvC,QAAQb,GAC5B8G,WAAY1D,EAAM7D,WAAWC,aAAaI,MAE5CiM,SAAU,CACRjG,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC6F,MAAO1C,EAAMC,OAAOhG,cACpBgK,UAAW,SACXP,WAAY1D,EAAM7D,WAAWC,aAAaC,SAE5C2M,eAAgB,CACdhF,aAAchE,EAAMvC,QAAQV,IAE9BuiC,MAAO,CACL98B,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC4F,WAAY,MACZC,MAAO1C,EAAMC,OAAOjG,KACpBgK,aAAchE,EAAMvC,QAAQb,GAC5B8G,WAAY1D,EAAM7D,WAAWC,aAAaE,QAE5C8M,MAAO,CACLd,YAAa,EACbD,YAAarI,EAAMC,OAAO9F,OAC1BwD,aAAcqC,EAAMrC,aAAad,GACjCwF,QAASrC,EAAMvC,QAAQZ,GACvB2F,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC6F,MAAO1C,EAAMC,OAAOjG,KACpB8H,gBAAiB9B,EAAMC,OAAOvF,gBAC9BgJ,WAAY1D,EAAM7D,WAAWC,aAAaC,SAE5CmwD,UAAW,CACTtqD,cAAe,MACfmf,SAAU,OACV2D,IAAKhlB,EAAMvC,QAAQZ,IAErB4vD,YAAa,CACXzuD,MAAO,GACPC,OAAQ,GACRN,aAAc,GACdyE,eAAgB,SAChBD,WAAY,SACZmG,YAAa,EACbD,YAAa,eAEfqkD,oBAAqB,CACnBrkD,YAAarI,EAAMC,OAAOjG,KAC1BsO,YAAa,GAEfwoD,iBAAkB,CAChB9sD,aAAchE,EAAMvC,QAAQV,IAE9Bg0D,WAAY,CACV7uD,cAAe,MACfC,WAAY,SACZL,gBAAiB9B,EAAMC,OAAOlG,KAC9BsI,QAASrC,EAAMvC,QAAQZ,GACvBc,aAAcqC,EAAMrC,aAAad,GACjCyL,YAAa,EACbD,YAAarI,EAAMC,OAAO9F,QAE5B62D,kBAAmB,CACjBhzD,MAAO,GACPC,OAAQ,GACRN,aAAc,EACdwL,YAAanJ,EAAMvC,QAAQZ,IAE7Bo0D,eAAgB,CACdzuD,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC6F,MAAO1C,EAAMC,OAAOjG,KACpB0J,WAAY1D,EAAM7D,WAAWC,aAAaC,SAE5CswD,gBAAiB,CACfzqD,cAAe,MACfG,QAASrC,EAAMvC,QAAQX,GACvBkoB,IAAKhlB,EAAMvC,QAAQZ,GACnBuH,eAAgB,EAChBC,eAAgBrE,EAAMC,OAAO9F,OAC7B2H,gBAAiB9B,EAAMC,OAAOlG,MAEhCqM,OAAQ,CACNvE,KAAM,EACNkB,gBAAiB/C,EAAMvC,QAAQZ,GAC/BmG,kBAAmBhD,EAAMvC,QAAQX,GACjCa,aAAcqC,EAAMrC,aAAad,GACjCsF,WAAY,SACZC,eAAgB,SAChBiE,UAAW,IAEbumD,aAAc,CACZ9qD,gBAAiB9B,EAAMC,OAAOlG,KAC9BuO,YAAa,EACbD,YAAarI,EAAMC,OAAO9F,QAE5B0yD,iBAAkB,CAChBrqD,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC6F,MAAO1C,EAAMC,OAAOjG,KACpB0J,WAAY1D,EAAM7D,WAAWC,aAAaE,QAE5Ci6B,aAAc,CACZz0B,gBAAiB9B,EAAMC,OAAOzG,SAEhCg9B,iBAAkB,CAChBh0B,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC6F,MAAO1C,EAAMC,OAAOpF,UACpB6I,WAAY1D,EAAM7D,WAAWC,aAAaG,UAE5CgK,eAAgB,CACdwQ,QAAS,KAEV,EAEH,SApT0D,SAAH3vB,GAIhD,IAHL0lE,EAAY1lE,EAAZ0lE,aACA7f,EAAQ7lD,EAAR6lD,SAAQ8f,EAAA3lE,EACR4lE,iBAAAA,OAAgB,IAAAD,EAAG,GAAEA,EAEb/sD,EAAUG,KAAVH,MACF0B,EAASyE,GAAUnG,GAEzBzJ,GAA8BC,EAAAA,EAAAA,UAAS,IAAGC,GAAAC,EAAAA,EAAAA,SAAAH,EAAA,GAAnCnJ,EAAOqJ,EAAA,GAAE02D,EAAU12D,EAAA,GAC1BI,GAA0CL,EAAAA,EAAAA,UAAS,WAAUM,GAAAJ,EAAAA,EAAAA,SAAAG,EAAA,GAAtD22D,EAAa12D,EAAA,GAAE22D,EAAgB32D,EAAA,GACtCG,GAAkCT,EAAAA,EAAAA,WAAS,GAAMU,GAAAR,EAAAA,EAAAA,SAAAO,EAAA,GAA1CF,EAASG,EAAA,GAAEF,EAAYE,EAAA,GAqBxB62D,GAAkB5uC,EAAAA,EAAAA,cAAY,SAACluB,GACnC,OAAKA,EAAKyW,OAINzW,EAAK/N,OAAS,EACT,yCAGL+N,EAAK/N,OAAS,GACT,2CAGL8pE,EAAiBz8C,MAAK,SAAAy9C,GAAQ,OAAIA,EAASxgC,gBAAkBv8B,EAAKu8B,aAAa,IAC1E,sCAGF,KAfE,0BAgBX,GAAG,CAACw/B,IAKEoB,GAAkBjvC,EAAAA,EAAAA,cAAWn9B,EAAAA,EAAAA,UAAC,YAElC,IAAMqsE,EAAYN,EAAgB3gE,GAClC,GAAIihE,EACFpmC,GAAAA,QAAMC,MAAM,eAAgBmmC,OAD9B,CAKAr3D,GAAa,GAEb,IAEE,IAAMgpD,QAAejzD,EAAQM,UAAU,CACrC4D,KAAM7D,EAAQsa,OACdhF,MAAO8qD,IAGT9sE,EAAOqE,KAAK,uBAAwBi7D,GACxB,MAAZ8M,GAAAA,EAAe9M,GAGfmN,EAAW,IACXM,EAAiB,UAEnB,CAAE,MAAO9qE,GACPjC,EAAOiC,MAAM,gCAAiCA,GAC9CslC,GAAAA,QAAMC,MACJ,kBACAvlC,aAAiB2B,MAAQ3B,EAAMW,QAAU,uBAE7C,CAAC,QACC0T,GAAa,EACf,CA1BA,CA2BF,IAAG,CAAC5J,EAASogE,EAAeO,EAAiBjB,IAEvCoE,EAAY9jE,EAAQsa,SAAW3Q,EAErC,OACE2O,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOE,UAAUtL,SAAA,EAC5BoP,EAAAA,EAAAA,MAACrE,GAAAA,QAAU,CAACuE,MAAOlE,EAAO1W,QAASuW,0BAA0B,UAASjL,SAAA,EAEpEoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOO,OAAO3L,SAAA,EACzB4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO3W,MAAMuL,SAAC,wBAC3B4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO+G,SAASnS,SAAC,wDAMhCoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOsH,eAAe1S,SAAA,EACjC4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO49B,MAAMhpC,SAAC,cAC3B4C,EAAAA,EAAAA,KAACmS,GAAAA,QAAS,CACRzF,MAAOlE,EAAO0H,MACdtnB,MAAOsL,EACPme,aAAc4hD,EACd7hD,YAAY,+BACZK,qBAAsB3L,EAAMC,OAAOhG,cACnCwoB,UAAW,GACXhX,eAAe,QACfC,aAAa,EACbylD,WAAW,QAKfzrD,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOsH,eAAe1S,SAAA,EACjC4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO49B,MAAMhpC,SAAC,eAC3B4C,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAO8qD,UAAUl2D,SA5GjB,CACnB,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAiGsBmmB,KAAI,SAAC/Z,GAAK,OACtBxJ,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CAEfF,MAAO,CACLlE,EAAO+qD,YACP,CAAE3qD,gBAAiBY,GACnB8qD,IAAkB9qD,GAAShB,EAAOgrD,qBAEpC3mD,QAAS,WAAF,OAAQ0nD,EAAiB/qD,EAAM,EAACpM,SAEtCk3D,IAAkB9qD,IACjBxJ,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,YAAYvO,KAAM,GAAIggB,MAAM,WATxCA,EAWY,UAMzBgD,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOovD,iBAAiBx6D,SAAA,EACnC4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO49B,MAAMhpC,SAAC,aAC3BoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOqvD,WAAWz6D,SAAA,EAC7B4C,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAO,CAAClE,EAAOsvD,kBAAmB,CAAElvD,gBAAiB0rD,OAC3Dt0D,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOuvD,eAAe36D,SAAElJ,GAAW,4BAMtDsY,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOirD,gBAAgBr2D,SAAA,EAClC4C,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CACfF,MAAO,CAAClE,EAAO0E,OAAQ1E,EAAOkrD,cAC9B7mD,QAASknC,EACTxyC,SAAU1D,EAAUT,UAEpB4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOmrD,iBAAiBv2D,SAAC,cAGxC4C,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CACfF,MAAO,CACLlE,EAAO0E,OACP1E,EAAO60B,cACN26B,GAAaxvD,EAAO6E,gBAEvBR,QAASqoD,EACT3zD,UAAWy2D,EAAU56D,SAEpBS,GACCmC,EAAAA,EAAAA,KAACgN,GAAAA,QAAiB,CAACxD,MAAM,WAEzBxJ,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO80B,iBAAiBlgC,SAAC,sBAMlD,E,+kBCjLA,IAgOM6P,GAAY,SAACnG,GAAe,OAAK2B,EAAAA,QAAWxb,OAAO,CACvDyb,UAAShY,GAAA,CACPkY,gBAAiB9B,EAAMC,OAAOlG,KAC9B4D,aAAc,GACd0E,QAASrC,EAAMvC,QAAQX,GACvBkH,aAAchE,EAAMvC,QAAQZ,GAC5ByL,YAAa,EACbD,YAAarI,EAAMC,OAAO9F,QACvB6F,EAAMnC,QAAQjB,IAEnBw0D,gBAAiB,CACf/oD,YAAarI,EAAMC,OAAOzG,QAC1B8O,YAAa,GAEfrG,OAAQ,CACNC,cAAe,MACfE,eAAgB,gBAChBD,WAAY,SACZ6B,aAAchE,EAAMvC,QAAQZ,IAE9Bw0D,QAAS,CACPnvD,cAAe,MACfC,WAAY,SACZN,KAAM,GAERyvD,eAAgB,CACdtzD,MAAO,GACPC,OAAQ,GACRN,aAAc,EACdwL,YAAanJ,EAAMvC,QAAQb,IAE7B20D,WAAY,CACV1vD,KAAM,GAERzU,QAAS,CACPoV,SAAUxC,EAAM7D,WAAWO,UAAUI,GACrC2F,WAAY,MACZC,MAAO1C,EAAMC,OAAOjG,KACpB0J,WAAY1D,EAAM7D,WAAWC,aAAaG,SAC1CyH,aAAc,GAEhBwtD,QAAS,CACPhvD,SAAUxC,EAAM7D,WAAWO,UAAUE,GACrC8F,MAAO1C,EAAMC,OAAOhG,cACpByJ,WAAY1D,EAAM7D,WAAWC,aAAaC,SAE5Co1D,YAAa,CACXzuD,kBAAmBhD,EAAMvC,QAAQb,GACjCmG,gBAAiB,EACjBpF,aAAc,GACdmE,gBAAiB9B,EAAMC,OAAOlG,MAEhC23D,kBAAmB,CACjB5vD,gBAAiB9B,EAAMC,OAAOzG,SAEhC+mC,WAAY,CACV/9B,SAAUxC,EAAM7D,WAAWO,UAAUC,GACrC8F,WAAY,MACZC,MAAO1C,EAAMC,OAAOhG,cACpByJ,WAAY1D,EAAM7D,WAAWC,aAAaG,UAE5Co1D,iBAAkB,CAChBjvD,MAAO1C,EAAMC,OAAOpG,YAEtB+3D,QAAS,CACP1vD,cAAe,MACfE,eAAgB,gBAChB4B,aAAchE,EAAMvC,QAAQb,IAE9Bi1D,aAAc,CACZ3vD,cAAe,MACfC,WAAY,SACZa,kBAAmBhD,EAAMvC,QAAQZ,GACjCkG,gBAAiB/C,EAAMvC,QAAQb,GAC/Be,aAAc,EACdkE,KAAM,EACNoB,iBAAkB,EAClBb,eAAgB,UAElB0vD,aAAc,CACZhwD,gBAAiB,cACjBwG,YAAa,EACbD,YAAarI,EAAMC,OAAOzG,SAE5Bu4D,mBAAoB,CAClBjwD,gBAAiB9B,EAAMC,OAAOzG,SAEhCw4D,WAAY,CACVlwD,gBAAiB,cACjBwG,YAAa,EACbD,YAAarI,EAAMC,OAAO9F,QAE5B83D,aAAc,CACZnwD,gBAAiB,cACjBwG,YAAa,EACbD,YAAarI,EAAMC,OAAOtd,OAE5BuvE,iBAAkB,CAChB1vD,SAAUxC,EAAM7D,WAAWO,UAAUE,GACrC6F,WAAY,MACZC,MAAO1C,EAAMC,OAAOzG,QACpBkK,WAAY1D,EAAM7D,WAAWC,aAAaG,SAC1CmK,WAAY,GAEdyrD,uBAAwB,CACtBzvD,MAAO1C,EAAMC,OAAOpG,YAEtBu4D,0BAA2B,CACzB5vD,SAAUxC,EAAM7D,WAAWO,UAAUE,GACrC6F,WAAY,MACZC,MAAO1C,EAAMC,OAAOhG,cACpByJ,WAAY1D,EAAM7D,WAAWC,aAAaG,SAC1CmK,WAAY,GAEd2rD,WAAY,CACVnwD,cAAe,MACfC,WAAY,SACZL,gBAAiB9B,EAAMC,OAAOxG,cAAgBuG,EAAMC,OAAOzG,QAAU,KACrE6I,QAASrC,EAAMvC,QAAQb,GACvBe,aAAc,EACd4F,UAAWvD,EAAMvC,QAAQb,IAE3B01D,eAAgB,CACd9vD,SAAUxC,EAAM7D,WAAWO,UAAUE,GACrC8F,MAAO1C,EAAMC,OAAOzG,QACpBkK,WAAY1D,EAAM7D,WAAWC,aAAaC,QAC1CqK,WAAY1G,EAAMvC,QAAQd,GAC1BkF,KAAM,GAER0wD,aAAc,CACZrwD,cAAe,MACfC,WAAY,SACZL,gBAAiB9B,EAAMC,OAAOlG,KAC9BuO,YAAa,EACbD,YAAarI,EAAMC,OAAO9F,OAC1BkI,QAASrC,EAAMvC,QAAQb,GACvBe,aAAc,EACd4F,UAAWvD,EAAMvC,QAAQb,IAE3B41D,iBAAkB,CAChBhwD,SAAUxC,EAAM7D,WAAWO,UAAUE,GACrC8F,MAAO1C,EAAMC,OAAOhG,cACpByJ,WAAY1D,EAAM7D,WAAWC,aAAaC,QAC1CqK,WAAY1G,EAAMvC,QAAQd,GAC1BkF,KAAM,GAER0E,eAAgB,CACdwQ,QAAS,GACT1O,YAAarI,EAAMC,OAAO9F,SAE3B,EAEH,SAxXoD,SAAH/S,GAO1C,IAuGeqrE,EA7GpBllE,EAAGnG,EAAHmG,IACAmlE,EAAQtrE,EAARsrE,SACAC,EAAUvrE,EAAVurE,WACAC,EAAYxrE,EAAZwrE,aACAC,EAAMzrE,EAANyrE,OACAC,EAAQ1rE,EAAR0rE,SAEQ9yD,EAAUG,KAAVH,MACF0B,EAASyE,GAAUnG,GAEzBzJ,GAAkCC,EAAAA,EAAAA,WAAS,GAAMC,GAAAC,EAAAA,EAAAA,SAAAH,EAAA,GAA1CQ,EAASN,EAAA,GAAEO,EAAYP,EAAA,GAKxBs8D,EAAsB,eAAA/qE,GAAAhG,EAAAA,EAAAA,UAAG,YAC7BgV,GAAa,GACb,IACM07D,QACIE,EAAarlE,EAAI3C,UAEjB+nE,EAAWplE,EAAI3C,GAEzB,CAAE,MAAOjI,GACPjC,EAAOiC,MAAM,mCAAoCA,GACjDslC,GAAAA,QAAMC,MACJ,QACAvlC,aAAiB2B,MAAQ3B,EAAMW,QAAU,kCAE7C,CAAC,QACC0T,GAAa,EACf,CACF,IAAC,kBAjB2B,OAAAhP,EAAApF,MAAA,KAAAC,UAAA,KAoEtBmwE,EAAqB,eAAA3oE,GAAArI,EAAAA,EAAAA,UAAG,YAC5B,IACEC,QAAQC,IAAI,oCAAoCqL,EAAI0D,YAC9C6hE,EAASvlE,EAAI3C,IAGC,QAAhB3J,EAAAA,QAASC,GACXwE,OAAOwiC,MAAM,gDAEbD,GAAAA,QAAMC,MAAM,cAAe,+CAE/B,CAAE,MAAOvlC,GACPjC,EAAOiC,MAAM,wBAAyBA,GACtC,IAAMyH,EAAezH,aAAiB2B,MAAQ3B,EAAMW,QAAU,uBAE1C,QAAhBrC,EAAAA,QAASC,GACXwE,OAAOwiC,MAAM,UAAU99B,GAEvB69B,GAAAA,QAAMC,MAAM,QAAS99B,EAEzB,CACF,IAAC,kBArB0B,OAAAC,EAAAzH,MAAA,KAAAC,UAAA,KAmC3B,OAAKghD,MAKHn+B,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAO,CAAClE,EAAOE,UAAW8wD,GAAYhxD,EAAO0vD,iBAAiB96D,SAAA,EAElEoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOO,OAAO3L,SAAA,EACzBoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAO2vD,QAAQ/6D,SAAA,EAC1B4C,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAO,CAAClE,EAAO4vD,eAAgB,CAAExvD,gBAAiBvU,EAAI6tD,eAC5D11C,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAO6vD,WAAWj7D,SAAA,EAC7B4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOtU,QAAQkJ,SAAE/I,EAAI0D,QAClCyU,EAAAA,EAAAA,MAACO,EAAAA,QAAI,CAACL,MAAOlE,EAAO8vD,QAAQl7D,SAAA,CAAC,YArBnBm8D,EAqBuCllE,EAAI+mC,UApBhD,IAAI5wC,KAAK+uE,GACVQ,mBAAmB,QAAS,CACtCzO,KAAM,UACNC,MAAO,QACPxsB,IAAK,uBAqBH/+B,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAO,CAAClE,EAAO+vD,YAAaiB,GAAYhxD,EAAOgwD,mBAAmBp7D,UACtE4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAO,CAAClE,EAAO6+B,WAAYmyB,GAAYhxD,EAAOiwD,kBAAkBr7D,SACnEo8D,EAAW,SAAW,mBAM7BhtD,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOkwD,QAAQt7D,SAAA,EAE1B4C,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CACfF,MAAO,CAAClE,EAAOmwD,aAAcnwD,EAAOowD,aAAcY,GAAYhxD,EAAOqwD,oBACrEhsD,QAASgtD,EACTt4D,SAAU1D,EAAUT,SAEnBS,GACCmC,EAAAA,EAAAA,KAACgN,GAAAA,QAAiB,CAACxjB,KAAK,QAAQggB,MAAOgwD,EAAW1yD,EAAMC,OAAOpG,WAAamG,EAAMC,OAAOzG,WAEzFkM,EAAAA,EAAAA,MAAA+oB,EAAAA,SAAA,CAAAn4B,SAAA,EACE4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CACP/U,KAAMyhE,EAAW,UAAY,MAC7BhwE,KAAM,GACNggB,MAAOgwD,EAAW1yD,EAAMC,OAAOpG,WAAamG,EAAMC,OAAOzG,WAE3DN,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAO,CAAClE,EAAOwwD,iBAAkBQ,GAAYhxD,EAAOywD,wBAAwB77D,SAC/Eo8D,EAAW,aAAe,mBAOnChtD,EAAAA,EAAAA,MAACI,GAAAA,QAAgB,CACfF,MAAO,CAAClE,EAAOmwD,aAAcnwD,EAAOswD,YACpCjsD,QAAS,WAAF,OAAQ8sD,EAAOtlE,EAAI,EAC1BkN,SAAU1D,EAAUT,SAAA,EAEpB4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,SAASvO,KAAM,GAAIggB,MAAO1C,EAAMC,OAAOhG,iBACtDf,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO0wD,0BAA0B97D,SAAC,aAIjDoP,EAAAA,EAAAA,MAACI,GAAAA,QAAgB,CACfF,MAAO,CACLlE,EAAOmwD,aACPnwD,EAAOuwD,cACNS,GAAYhxD,EAAO6E,gBAEtBR,QAlJa,YACnB9jB,QAAQC,IAAI,kCAAkCqL,EAAI0D,KAAI,eAAeyhE,GAGhEA,GAee,QAAhBzxE,EAAAA,QAASC,GACOwE,OAAOw7C,QAAQ,oCACK3zC,EAAI0D,KAAI,oGAI5C+hE,IAGF/qC,GAAAA,QAAMC,MACJ,oBAAoB,oCACgB36B,EAAI0D,KAAI,kGAC5C,CACE,CAAE+I,KAAM,SAAU4L,MAAO,UACzB,CACE5L,KAAM,SACN4L,MAAO,cACPG,QAASitD,KA9BK,QAAhB/xE,EAAAA,QAASC,GACXwE,OAAOwiC,MAAM,8GAEbD,GAAAA,QAAMC,MACJ,oBACA,6GACA,CAAC,CAAEluB,KAAM,KAAM4L,MAAO,YA6B9B,EA0GQnL,SAAU1D,IAAc27D,EAASp8D,SAAA,EAEjC4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CACP/U,KAAK,QACLvO,KAAM,GACNggB,MAAQgwD,EAAwC1yD,EAAMC,OAAOtd,MAA1Cqd,EAAMC,OAAOhG,iBAElCf,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAO,CACXlE,EAAO0wD,0BACP,CAAE1vD,MAAQgwD,EAAwC1yD,EAAMC,OAAOtd,MAA1Cqd,EAAMC,OAAOhG,gBAClC3D,SAAC,iBAONo8D,IACChtD,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAO2wD,WAAW/7D,SAAA,EAC7B4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,qBAAqBvO,KAAM,GAAIggB,MAAO1C,EAAMC,OAAOzG,WAClEN,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO4wD,eAAeh8D,SAAC,8HAOtCo8D,IACAhtD,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAO6wD,aAAaj8D,SAAA,EAC/B4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,6BAA6BvO,KAAM,GAAIggB,MAAO1C,EAAMC,OAAOhG,iBAC1Ef,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO8wD,iBAAiBl8D,SAAC,wEA/FrC,IAsGX,E,+kBCtNA,IA4ZM6P,GAAY,SAACnG,GAAe,OAAK2B,EAAAA,QAAWxb,OAAO,CACvDyb,UAAW,CACTC,KAAM,EACNC,gBAAiB9B,EAAMC,OAAOpG,YAEhCq5D,aAAc,CACZhxD,cAAe,MACfJ,gBAAiB9B,EAAMC,OAAOlG,KAC9BuI,kBAAmB,EACnBC,kBAAmBvC,EAAMC,OAAO9F,QAElCg5D,IAAK,CACHtxD,KAAM,EACNK,cAAe,MACfC,WAAY,SACZC,eAAgB,SAChBW,gBAAiB/C,EAAMvC,QAAQZ,GAC/BmG,kBAAmBhD,EAAMvC,QAAQX,IAEnCs2D,UAAW,CACT9wD,kBAAmB,EACnBC,kBAAmBvC,EAAMC,OAAOzG,SAElC65D,QAAS,CACP3sD,WAAY1G,EAAMvC,QAAQb,GAC1B4F,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC6F,MAAO1C,EAAMC,OAAOhG,cACpByJ,WAAY1D,EAAM7D,WAAWC,aAAaC,SAE5Ci3D,cAAe,CACb5wD,MAAO1C,EAAMC,OAAOzG,QACpBkK,WAAY1D,EAAM7D,WAAWC,aAAaG,UAE5CvR,QAAS,CACP6W,KAAM,EACNQ,QAASrC,EAAMvC,QAAQZ,IAEzBwG,iBAAkB,CAChBxB,KAAM,EACNO,eAAgB,SAChBD,WAAY,UAEdmB,YAAa,CACXC,UAAWvD,EAAMvC,QAAQZ,GACzB2F,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC6F,MAAO1C,EAAMC,OAAOhG,cACpByJ,WAAY1D,EAAM7D,WAAWC,aAAaC,SAE5Ck3D,eAAgB,CACdrxD,cAAe,MACfC,WAAY,SACZC,eAAgB,gBAChBN,gBAAiB9B,EAAMC,OAAOlG,KAC9BsI,QAASrC,EAAMvC,QAAQZ,GACvBmH,aAAchE,EAAMvC,QAAQb,GAC5Be,aAAcqC,EAAMrC,aAAab,GACjCwL,YAAa,EACbD,YAAarI,EAAMC,OAAO9F,QAE5Bk3D,QAAS,CACPnvD,cAAe,MACfC,WAAY,SACZN,KAAM,GAERmvD,kBAAmB,CACjBhzD,MAAO,GACPC,OAAQ,GACRN,aAAc,EACdwL,YAAanJ,EAAMvC,QAAQZ,IAE7BzP,QAAS,CACPoV,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC6F,MAAO1C,EAAMC,OAAOjG,KACpB0J,WAAY1D,EAAM7D,WAAWC,aAAaC,SAE5Cm3D,gBAAiB,CACfnxD,QAASrC,EAAMvC,QAAQb,IAEzB+oB,eAAgB,CACd9jB,KAAM,EACNO,eAAgB,SAChBD,WAAY,SACZY,gBAAiB/C,EAAMvC,QAAQT,KAEjC4oB,UAAW,CACTpjB,SAAUxC,EAAM7D,WAAWO,UAAUI,GACrC4F,MAAO1C,EAAMC,OAAOhG,cACpByJ,WAAY1D,EAAM7D,WAAWC,aAAaG,SAC1CgH,UAAWvD,EAAMvC,QAAQZ,IAE3B0uB,aAAc,CACZ/oB,SAAUxC,EAAM7D,WAAWO,UAAUE,GACrC8F,MAAO1C,EAAMC,OAAOhG,cACpByJ,WAAY1D,EAAM7D,WAAWC,aAAaC,QAC1C4H,UAAW,SACXV,UAAWvD,EAAMvC,QAAQb,GACzBoG,kBAAmBhD,EAAMvC,QAAQV,IAEnC02D,IAAK,CACH98C,SAAU,WACV+K,OAAQ1hB,EAAMvC,QAAQV,GACtB6kB,MAAO5hB,EAAMvC,QAAQV,GACrBiB,MAAO,GACPC,OAAQ,GACRN,aAAc,GACdmE,gBAAiB9B,EAAMC,OAAOzG,QAC9B4I,eAAgB,SAChBD,WAAY,SACZ/D,UAAW,EACXN,YAAa,OACbC,aAAc,CAAEC,MAAO,EAAGC,OAAQ,GAClCC,cAAe,IACfC,aAAc,GAEhB+N,WAAY,CACVyK,SAAU,WACVilC,IAAK57C,EAAMvC,QAAQV,GACnB4kB,KAAM3hB,EAAMvC,QAAQZ,GACpBmB,MAAO,GACPC,OAAQ,GACRN,aAAc,GACdmE,gBAAiB9B,EAAMC,OAAOlG,KAC9BqI,eAAgB,SAChBD,WAAY,SACZ/D,UAAW,EACXN,YAAa,OACbC,aAAc,CAAEC,MAAO,EAAGC,OAAQ,GAClCC,cAAe,GACfC,aAAc,IAEf,EAEH,SAhiBgE,WAE9D,IAAK0lC,KACH,OAAO,KAET,IAAMz5B,GAAaC,EAAAA,GAAAA,iBACXrK,EAAUG,KAAVH,MACF0B,EAASyE,GAAUnG,GAGzBzJ,GAAsCC,EAAAA,EAAAA,UAAgB,IAAGC,GAAAC,EAAAA,EAAAA,SAAAH,EAAA,GAAlDm9D,EAAWj9D,EAAA,GAAEk9D,EAAcl9D,EAAA,GAClCI,GAAoCL,EAAAA,EAAAA,UAA4B,IAAGM,GAAAJ,EAAAA,EAAAA,SAAAG,EAAA,GAA5D+8D,EAAU98D,EAAA,GAAE+8D,EAAa/8D,EAAA,GAChCG,GAAgDT,EAAAA,EAAAA,UAAsB,IAAI7U,KAAMuV,GAAAR,EAAAA,EAAAA,SAAAO,EAAA,GAAzE68D,EAAgB58D,EAAA,GAAE68D,EAAmB78D,EAAA,GAC5CG,GAAkCb,EAAAA,EAAAA,WAAS,GAAKc,GAAAZ,EAAAA,EAAAA,SAAAW,EAAA,GAAzCN,EAASO,EAAA,GAAEN,EAAYM,EAAA,GAC9BoT,GAAwClU,EAAAA,EAAAA,WAAS,GAAMmU,GAAAjU,EAAAA,EAAAA,SAAAgU,EAAA,GAAhDuhB,EAAYthB,EAAA,GAAEuhB,EAAevhB,EAAA,GACpCE,GAAoDrU,EAAAA,EAAAA,WAAS,GAAMsU,GAAApU,EAAAA,EAAAA,SAAAmU,EAAA,GAA5DmpD,EAAkBlpD,EAAA,GAAEmpD,EAAqBnpD,EAAA,GAChDsC,GAAwD5W,EAAAA,EAAAA,WAAS,GAAM6W,GAAA3W,EAAAA,EAAAA,SAAA0W,EAAA,GAAhE8mD,EAAoB7mD,EAAA,GAAE8mD,EAAuB9mD,EAAA,GACpDC,GAAsC9W,EAAAA,EAAAA,UAA+B,WAAU+W,GAAA7W,EAAAA,EAAAA,SAAA4W,EAAA,GAAxE8mD,EAAW7mD,EAAA,GAAE8mD,EAAc9mD,EAAA,GAK5B+mD,GAAiBn1C,EAAAA,EAAAA,cAAWn9B,EAAAA,EAAAA,UAAC,YACjC,IAAK,IAADgrC,EACFtsC,EAAOqE,KAAK,mCAGZ,IAGMwvE,GAAwB,OAAbvnC,SAHM/mC,EAAIyE,IAAI,wBAGL5G,WAAI,EAAbkpC,EAAelhC,OAAQ,GACxC+nE,EAAcU,EAAS93C,KAAI,SAAClvB,GAAQ,OAAA3D,GAAAA,GAAA,GAC/B2D,GAAG,IACN3C,GAAI2C,EAAI8iE,OACR/G,YAAa,SACbH,eAAgB,WAChBsH,qBAAsB,GAAC,KAEzB/vE,EAAOqE,KAAK,UAAUwvE,EAASrxE,OAAM,eACvC,CAAE,MAAOP,GACPjC,EAAOiC,MAAM,6BAA8BA,GAC3CkxE,EAAc,GAChB,CACF,IAAG,IAKGW,GAAWr1C,EAAAA,EAAAA,cAAWn9B,EAAAA,EAAAA,UAAC,YAC3BgV,GAAa,GACb,IAEE,IAAMlL,QAAa+zD,GAAWM,aAC9BwT,EAAe7nE,SAGTwoE,GAER,CAAE,MAAO3xE,GACPjC,EAAOiC,MAAM,uBAAwBA,GACrCslC,GAAAA,QAAMC,MAAM,QAAS,sBACvB,CAAC,QACClxB,GAAa,EACf,CACF,IAAG,CAACs9D,IAKEG,GAAgBt1C,EAAAA,EAAAA,cAAWn9B,EAAAA,EAAAA,UAAC,YAChCkqC,GAAgB,SACVsoC,IACNtoC,GAAgB,EAClB,IAAG,CAACsoC,IAKEE,GAAyBv1C,EAAAA,EAAAA,cAAY,WACzCg1C,GAAwB,EAC1B,GAAG,IAKGQ,GAA0Bx1C,EAAAA,EAAAA,cAAY,SAAC6gC,GAC3C2T,GAAe,SAAAvkB,GAAI,SAAA9gB,QAAApS,EAAAA,GAAAA,SAAQkzB,GAAI,CAAE4Q,GAAS,IAC1CmU,GAAwB,GACxBzzE,EAAOqE,KAAK,uBAAwBi7D,EACtC,GAAG,IAKG4U,GAAkCz1C,EAAAA,EAAAA,cAAY,WAClDg1C,GAAwB,EAC1B,GAAG,IAKGU,GAA0B11C,EAAAA,EAAAA,aAAY,WAAD,IAAA9mB,GAAArW,EAAAA,EAAAA,UAAC,UAAOwvC,GACjD,IAcE,WAZuBkU,MAAM,kCAAmC,CAC9D/9C,OAAQ,OACRtB,QAAS,CACP,eAAgB,oBAElByuE,YAAa,UACbC,KAAM7wE,KAAKC,UAAU,CACnBksE,OAAQ7+B,EACR+B,OAAQ,gBAICyhC,GAIX,MAAM,IAAI1wE,MAAM,iCAHhByvE,GAAoB,SAAA3kB,GAAI,OAAI,IAAIztD,IAAI,GAAD2sC,QAAApS,EAAAA,GAAAA,SAAKkzB,GAAI,CAAE5d,IAAO,IACrD9wC,EAAOqE,KAAK,wBAAyBysC,EAIzC,CAAE,MAAO7uC,GAEP,MADAjC,EAAOiC,MAAM,iCAAkCA,GACzCA,CACR,CACF,IAAC,gBAAA6B,GAAA,OAAA6T,EAAAzV,MAAA,KAAAC,UAAA,EAzB2C,GAyBzC,IAKGoyE,GAA4B91C,EAAAA,EAAAA,aAAY,WAAD,IAAA1mB,GAAAzW,EAAAA,EAAAA,UAAC,UAAOwvC,GACnD,IAcE,WAZuBkU,MAAM,kCAAmC,CAC9D/9C,OAAQ,OACRtB,QAAS,CACP,eAAgB,oBAElByuE,YAAa,UACbC,KAAM7wE,KAAKC,UAAU,CACnBksE,OAAQ7+B,EACR+B,OAAQ,kBAICyhC,GAQX,MAAM,IAAI1wE,MAAM,mCAPhByvE,GAAoB,SAAA3kB,GAClB,IAAM8lB,EAAS,IAAIvzE,IAAIytD,GAEvB,OADA8lB,EAAO7vE,OAAOmsC,GACP0jC,CACT,IACAx0E,EAAOqE,KAAK,0BAA2BysC,EAI3C,CAAE,MAAO7uC,GAEP,MADAjC,EAAOiC,MAAM,mCAAoCA,GAC3CA,CACR,CACF,IAAC,gBAAA8B,GAAA,OAAAgU,EAAA7V,MAAA,KAAAC,UAAA,EA7B6C,GA6B3C,IAKGsyE,GAAsBh2C,EAAAA,EAAAA,cAAY,SAAC5xB,GAEvC06B,GAAAA,QAAMC,MAAM,WAAW,YAAa36B,EAAI6hE,SAAQ,4BAClD,GAAG,IAKGgG,GAAwBj2C,EAAAA,EAAAA,aAAY,WAAD,IAAArmB,GAAA9W,EAAAA,EAAAA,UAAC,UAAOwvC,GAC/C,IAEE,IAAM3pC,QAAiB5B,EAAIZ,OAAO,uBAAuBmsC,GAEjD,KAAI3pC,EAASE,QAAU,KAAOF,EAASE,OAAS,KAStD,MAAM,IAAIzD,MAAM,+BARhBuvE,GAAc,SAAAzkB,GAAI,OAAIA,EAAKt8C,QAAO,SAAAvF,GAAG,OAAIA,EAAI3C,KAAO4mC,CAAK,GAAC,IAC1DuiC,GAAoB,SAAA3kB,GAClB,IAAM8lB,EAAS,IAAIvzE,IAAIytD,GAEvB,OADA8lB,EAAO7vE,OAAOmsC,GACP0jC,CACT,IACAx0E,EAAOqE,KAAK,sBAAuBysC,EAIvC,CAAE,MAAO7uC,GAEP,MADAjC,EAAOiC,MAAM,+BAAgCA,GACvCA,CACR,CACF,IAAC,gBAAA+B,GAAA,OAAAoU,EAAAlW,MAAA,KAAAC,UAAA,EApByC,GAoBvC,IAKGwyE,GAAyBl2C,EAAAA,EAAAA,cAAY,SAACqS,GAC1CyiC,GAAsB,GACtBO,GACF,GAAG,CAACA,IAKEc,IAAiBn2C,EAAAA,EAAAA,cAAY,WACb,YAAhBi1C,EACFM,IAEAT,GAAsB,EAE1B,GAAG,CAACG,EAAaM,KAGjBl9D,EAAAA,EAAAA,YAAU,WACRg9D,GACF,GAAG,CAACA,IAKJ,IAAMe,IAAmBp2C,EAAAA,EAAAA,cAAY,SAAAlmB,GAAA,IAAGmgC,EAAIngC,EAAJmgC,KAAI,OAC1C1zB,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAO6xD,eAAej9D,SAAA,EACjCoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAO2vD,QAAQ/6D,SAAA,EAC1B4C,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAO,CAAClE,EAAOsvD,kBAAmB,CAAElvD,gBAAiBs3B,EAAK12B,WAChExJ,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOtU,QAAQkJ,SAAE8iC,EAAKnoC,WAErCiI,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CACfF,MAAOlE,EAAO8xD,gBACdztD,QAAS,WACPkiB,GAAAA,QAAMC,MACJ,aAAa,oCACuBkR,EAAKnoC,KAAI,KAC7C,CACE,CAAE+I,KAAM,SAAU4L,MAAO,UACzB,CACE5L,KAAM,SACN4L,MAAO,cACPG,QAAQ,WAAD,IAAAyvD,GAAAxzE,EAAAA,EAAAA,UAAE,YACP,UACQ69D,GAAWhyD,UAAUokB,OAAOmnB,EAAKxuC,KACvC+oE,GAAe,SAAAvkB,GAAI,OAAIA,EAAKt8C,QAAO,SAAAvF,GAAG,OAAIA,EAAI3C,KAAOwuC,EAAKxuC,EAAE,GAAC,GAC/D,CAAE,MAAOjI,GACPslC,GAAAA,QAAMC,MAAM,QAAS,uBACvB,CACF,IAPO,OAON,WAPM,OAAAstC,EAAA5yE,MAAA,KAAAC,UAAA,EAAC,KAWhB,EAAEyT,UAEF4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,QAAQvO,KAAM,GAAIggB,MAAO1C,EAAMC,OAAOtd,YAElD,GACN,CAAC+e,EAAQ1B,EAAMC,OAAOtd,QAKnB8yE,IAAkBt2C,EAAAA,EAAAA,cAAY,SAAAwB,GAAA,IAAGyY,EAAIzY,EAAJyY,KAAI,OACzClgC,EAAAA,EAAAA,KAACw8D,GAAa,CACZnoE,IAAK6rC,EACLs5B,SAAUoB,EAAiB/+D,IAAIqkC,EAAKxuC,IACpC+nE,WAAYkC,EACZjC,aAAcqC,EACdpC,OAAQsC,EACRrC,SAAUsC,GACV,GACD,CAACtB,EAAkBe,EAAyBI,EAA2BE,EAAqBC,IAG/F,OAAIlB,GAEAxuD,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOE,UAAUtL,SAAA,EAC5B4C,EAAAA,EAAAA,KAAC4vB,GAAY,CAAC/9B,MAAM,wBACpBmO,EAAAA,EAAAA,KAACy8D,GAAgB,CACf7I,aAAc6H,EACd1nB,SAAU2nB,EACV5H,iBAAkB0G,EAAYj3C,KAAI,SAAAlvB,GAAG,OAAIA,EAAI0D,IAAI,SAOrD+iE,GAEAtuD,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOE,UAAUtL,SAAA,EAC5B4C,EAAAA,EAAAA,KAAC4vB,GAAY,CAAC/9B,MAAM,uBACpBmO,EAAAA,EAAAA,KAAC08D,GAAc,CACb9I,aAAcuI,EACdpoB,SAAU,WAAF,OAAQgnB,GAAsB,EAAM,EAC5CjH,iBAAkB4G,EAAWn3C,KAAI,SAAAlvB,GAAG,OAAIA,EAAI6hE,QAAQ,IACpDlC,kBAAkB,QAOxBxnD,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOE,UAAUtL,SAAA,EAC5B4C,EAAAA,EAAAA,KAAC4vB,GAAY,CAAC/9B,MAAM,oBAGpB2a,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOwxD,aAAa58D,SAAA,EAC/BoP,EAAAA,EAAAA,MAACI,GAAAA,QAAgB,CACfF,MAAO,CAAClE,EAAOyxD,IAAqB,YAAhBiB,GAA6B1yD,EAAO0xD,WACxDrtD,QAAS,WAAF,OAAQsuD,EAAe,UAAU,EAAC/9D,SAAA,EAEzC4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CACP/U,KAAK,WACLvO,KAAM,GACNggB,MAAuB,YAAhB0xD,EAA4Bp0D,EAAMC,OAAOzG,QAAUwG,EAAMC,OAAOhG,iBAEzEf,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAO,CAAClE,EAAO2xD,QAAyB,YAAhBe,GAA6B1yD,EAAO4xD,eAAeh9D,SAAC,qBAKpFoP,EAAAA,EAAAA,MAACI,GAAAA,QAAgB,CACfF,MAAO,CAAClE,EAAOyxD,IAAqB,WAAhBiB,GAA4B1yD,EAAO0xD,WACvDrtD,QAAS,WAAF,OAAQsuD,EAAe,SAAS,EAAC/9D,SAAA,EAExC4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CACP/U,KAAK,SACLvO,KAAM,GACNggB,MAAuB,WAAhB0xD,EAA2Bp0D,EAAMC,OAAOzG,QAAUwG,EAAMC,OAAOhG,iBAExEf,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAO,CAAClE,EAAO2xD,QAAyB,WAAhBe,GAA4B1yD,EAAO4xD,eAAeh9D,SAAC,uBAOrF4C,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAO1W,QAAQsL,SACzBS,GACC2O,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAO2B,iBAAiB/M,SAAA,EACnC4C,EAAAA,EAAAA,KAACgN,GAAAA,QAAiB,CAACxjB,KAAK,QAAQggB,MAAO1C,EAAMC,OAAOzG,WACpDN,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO4B,YAAYhN,SAAC,wBAGnC4C,EAAAA,EAAAA,KAAAu1B,EAAAA,SAAA,CAAAn4B,SACmB,YAAhB89D,GACCl7D,EAAAA,EAAAA,KAACggC,GAAAA,QAAQ,CACPp1C,KAAM4vE,EACNv6B,WAAYo8B,GACZl8B,aAAc,SAACD,GAAI,OAAKnnB,OAAOmnB,EAAKxuC,GAAG,EACvCm+B,gBACE7vB,EAAAA,EAAAA,KAAC8vB,GAAAA,QAAc,CACbpC,WAAYqF,EACZhD,UAAWwrC,EACXx0D,OAAQ,CAACD,EAAMC,OAAOzG,WAG1Bq8C,oBACEnwC,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOikB,eAAervB,SAAA,EACjC4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,mBAAmBvO,KAAM,GAAIggB,MAAO1C,EAAMC,OAAOhG,iBAChEf,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOkkB,UAAUtvB,SAAC,yBAC/B4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO6pB,aAAaj1B,SAAC,oDAOxC4C,EAAAA,EAAAA,KAACggC,GAAAA,QAAQ,CACPp1C,KAAM8vE,EACNz6B,WAAYs8B,GACZp8B,aAAc,SAACD,GAAI,OAAKA,EAAKxuC,EAAE,EAC/Bm+B,gBACE7vB,EAAAA,EAAAA,KAAC8vB,GAAAA,QAAc,CACbpC,WAAYqF,EACZhD,UAAWwrC,EACXx0D,OAAQ,CAACD,EAAMC,OAAOzG,WAG1Bq8C,oBACEnwC,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOikB,eAAervB,SAAA,EACjC4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,iBAAiBvO,KAAM,GAAIggB,MAAO1C,EAAMC,OAAOhG,iBAC9Df,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOkkB,UAAUtvB,SAAC,wBAC/B4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO6pB,aAAaj1B,SAAC,+DAYhD4C,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CACfF,MAAOlE,EAAO+xD,IACd1tD,QAASuvD,GAAeh/D,UAExB4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,MAAMvO,KAAM,GAAIggB,MAAO1C,EAAMC,OAAOpF,eAIrD3B,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CACfF,MAAOlE,EAAOwK,WACdnG,QAAS,WAAF,OAAQqE,EAAWi9C,QAAQ,EAAC/wD,UAEnC4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,aAAavO,KAAM,GAAIggB,MAAO1C,EAAMC,OAAOjG,WAIlE,E,8lBChbA,IAAM5L,GAAe,CACnBynE,iBAAkB,0BAClBC,mBAAoB,qBACpBC,eAAgB,kBAMZC,IAAmBr1E,EAAAA,EAAAA,UAAA,SAAAq1E,KAAAn1E,EAAAA,EAAAA,SAAA,KAAAm1E,EAAA,KAAAn0E,IAAA,QAAAC,MAAA,eAAAm0E,GAAAj0E,EAAAA,EAAAA,UACvB,UAAYH,EAAaiC,GACvB,IACE,IAAMoyE,EAAahyE,KAAKC,UAAUL,SAC5B0D,EAAAA,QAAagC,QAAQ3H,EAAKq0E,EAClC,CAAE,MAAOvzE,GAEP,MADAjC,EAAOiC,MAAM,wCAAwCd,EAAG,IAAKc,GACvDA,CACR,CACF,IARW,OAQV,SARU6B,EAAAC,GAAA,OAAAwxE,EAAArzE,MAAC,KAADC,UAAA,EADY,IACZ,CAAAhB,IAAA,WAAAC,MAAA,eAAAq0E,GAAAn0E,EAAAA,EAAAA,UAUX,UAAeH,GACb,IACE,IAAMq0E,QAAmB1uE,EAAAA,QAAaC,QAAQ5F,GAC9C,OAAKq0E,EAGEhyE,KAAKiL,MAAM+mE,GAFT,IAGX,CAAE,MAAOvzE,GAEP,OADAjC,EAAOiC,MAAM,2CAA2Cd,EAAG,IAAKc,GACzD,IACT,CACF,IAXc,OAWb,SAXa+B,GAAA,OAAAyxE,EAAAvzE,MAAC,KAADC,UAAA,EAVH,IAUG,CAAAhB,IAAA,SAAAC,MAAA,eAAAs0E,GAAAp0E,EAAAA,EAAAA,UAad,UAAaH,GACX,UACQ2F,EAAAA,QAAa8C,WAAWzI,EAChC,CAAE,MAAOc,GAEP,MADAjC,EAAOiC,MAAM,yCAAyCd,EAAG,IAAKc,GACxDA,CACR,CACF,IAPY,OAOX,SAPWgL,GAAA,OAAAyoE,EAAAxzE,MAAC,KAADC,UAAA,EAbE,IAaF,CAAAhB,IAAA,QAAAC,MAAA,eAAAu0E,GAAAr0E,EAAAA,EAAAA,UASZ,YACE,IACE,IAAM0O,EAAOD,OAAO+E,OAAOpH,UACrB5G,EAAAA,QAAamL,YAAYjC,EACjC,CAAE,MAAO/N,GAEP,MADAjC,EAAOiC,MAAM,mCAAoCA,GAC3CA,CACR,CACF,IARW,OAQV,WARU,OAAA0zE,EAAAzzE,MAAC,KAADC,UAAA,EATC,MA6XDyzE,GAtWqB,WAOhC,SAAAC,KAAsB11E,EAAAA,EAAAA,SAAA,KAAA01E,GAAA,KAJdC,kBAA8C,KAAK,KACnDC,mBAAoB,EAAM,KAC1BC,mBAAkC,KAGxC31E,KAAK41E,eAAiB,IAAIX,GAC1Bj1E,KAAK61E,uBACP,CAAC,OAAAj2E,EAAAA,EAAAA,SAAA41E,EAAA,EAAA10E,IAAA,aAAAC,MAAA,eAAA4vB,GAAA1vB,EAAAA,EAAAA,UAYD,YACE,IACEtB,EAAOqE,KAAK,4CAGNhE,KAAK81E,oCAGL91E,KAAK+1E,yBAEXp2E,EAAOqE,KAAK,iDACd,CAAE,MAAOpC,GAEP,MADAjC,EAAOiC,MAAM,8CAA+CA,GACtDA,CACR,CACF,IAfuB,OAetB,WAfsB,OAAA+uB,EAAA9uB,MAAC,KAADC,UAAA,EAZtB,IAYsB,CAAAhB,IAAA,uBAAAC,MAAA,eAAAi1E,GAAA/0E,EAAAA,EAAAA,UAoBvB,UAAkCg1E,GAChC,IACE,IAAMC,EAA4CD,EAASv6C,KAAI,SAAAiY,GAAO,MAAK,CACzElD,MAAOkD,EAAQlD,MACfpkC,QAASsnC,EAAQtnC,QACjBknC,UAAWI,EAAQJ,UAAU3wC,cAC7B4wC,UAAWG,EAAQH,UAAU5wC,cAC7B6yE,kBAAmB9hC,EAAQ8hC,kBAC3BU,SAAUxiC,EAAQwiC,SAClBC,aAAcziC,EAAQyiC,aAAaxzE,cACnCyzE,YAAa1iC,EAAQ0iC,YACrBC,OAAQ3iC,EAAQ2iC,OACjB,UAEKt2E,KAAK41E,eAAeW,MAAMlpE,GAAaynE,iBAAkBoB,GAC/Dv2E,EAAOqE,KAAK,uBAAuBkyE,EAAgB/zE,OAAM,YAC3D,CAAE,MAAOP,GAEP,MADAjC,EAAOiC,MAAM,oCAAqCA,GAC5CA,CACR,CACF,IApBiC,OAoBhC,SApBgCiL,GAAA,OAAAmpE,EAAAn0E,MAAC,KAADC,UAAA,EApBV,IAoBU,CAAAhB,IAAA,0BAAAC,MAAA,eAAAy1E,GAAAv1E,EAAAA,EAAAA,UAyBjC,YAIgC,IAJK68C,EAA+Bh8C,UAAAK,OAAA,QAAA0B,IAAA/B,UAAA,GAAAA,UAAA,GAAG,CACrE20E,eAAe,EACfC,OAAQ,MACRC,sBAAsB,GAEtB,IACE,IAAMT,QAAwBl2E,KAAK41E,eAAegB,SAASvpE,GAAaynE,kBAExE,IAAKoB,GAA8C,IAA3BA,EAAgB/zE,OAEtC,OADAxC,EAAOqE,KAAK,0CACL,GAGT,IAAM+pB,EAAM,IAAIprB,KACV+zE,EAAS54B,EAAQ44B,QAAU,MAC3BG,EAAa,IAAIl0E,KAAKorB,EAAI+oD,UAAYJ,GAEtCK,EAAmC,GAEzC,IAAK,IAAMh0E,KAAQmzE,EACjB,IACE,IAAM3iC,EAAY,IAAI5wC,KAAKI,EAAKwwC,WAC1BC,EAAY,IAAI7wC,KAAKI,EAAKywC,WAC1B4iC,EAAe,IAAIzzE,KAAKI,EAAKqzE,cAGnC,GAAI7iC,EAAYsjC,EAAY,CAC1Bl3E,EAAOmE,MAAM,WAAWf,EAAK0tC,MAAK,+BAClC,QACF,CAGA,GAAI+C,EAAYzlB,EAAK,CACnBpuB,EAAOmE,MAAM,WAAWf,EAAK0tC,MAAK,+BAClC,QACF,CAGA,GAAIzwC,KAAKy1E,mBAAqB1yE,EAAK0yE,oBAAsBz1E,KAAKy1E,kBAAkBxgE,KAAM,CACpFtV,EAAOsC,KAAK,WAAWc,EAAK0tC,MAAK,mDACjC,QACF,CAEA,IAAMumC,EAAmC,CACvCvmC,MAAO1tC,EAAK0tC,MACZpkC,QAAStJ,EAAKsJ,QACdknC,UAAAA,EACAC,UAAAA,EACAiiC,kBAAmB1yE,EAAK0yE,kBACxBU,SAAUpzE,EAAKozE,SACfC,aAAAA,EACAC,YAAatzE,EAAKszE,YAClBC,OAAQvzE,EAAKuzE,QAGfS,EAAclpC,KAAKmpC,EACrB,CAAE,MAAOp1E,GAEP,GADAjC,EAAOsC,KAAK,wCAAwCc,EAAK0tC,MAAK,IAAK7uC,IAC9Dk8C,EAAQ64B,qBACX,MAAM/0E,CAEV,CAIF,OADAjC,EAAOqE,KAAK,aAAa+yE,EAAc50E,OAAM,gCACtC40E,CACT,CAAE,MAAOn1E,GAEP,GADAjC,EAAOiC,MAAM,uCAAwCA,GACjDk8C,EAAQ64B,qBACV,MAAO,GAET,MAAM/0E,CACR,CACF,IAzEoC,OAyEnC,WAzEmC,OAAA40E,EAAA30E,MAAC,KAADC,UAAA,EAzBH,IAyBG,CAAAhB,IAAA,wBAAAC,MAAA,eAAAk2E,GAAAh2E,EAAAA,EAAAA,UA8EpC,UAAmCwvC,GACjC,IACE,IAKMymC,SALiBl3E,KAAKm3E,wBAAwB,CAClDV,eAAe,EACfC,OAAQ,MACRC,sBAAsB,KAEU5kE,QAAO,SAAA4hC,GAAO,OAAIA,EAAQlD,QAAUA,CAAK,UACrEzwC,KAAKo3E,qBAAqBF,GAChCv3E,EAAOqE,KAAK,oCAAoCysC,EAClD,CAAE,MAAO7uC,GAEP,MADAjC,EAAOiC,MAAM,6CAA6C6uC,EAAK,IAAK7uC,GAC9DA,CACR,CACF,IAdkC,OAcjC,SAdiCoL,GAAA,OAAAiqE,EAAAp1E,MAAC,KAADC,UAAA,EA9EE,IA8EF,CAAAhB,IAAA,uBAAAC,MAAA,eAAAs2E,GAAAp2E,EAAAA,EAAAA,UAmBlC,YACE,UACQjB,KAAK41E,eAAe/2D,OAAOxR,GAAaynE,kBAC9Cn1E,EAAOqE,KAAK,+BACd,CAAE,MAAOpC,GAEP,MADAjC,EAAOiC,MAAM,oCAAqCA,GAC5CA,CACR,CACF,IARiC,OAQhC,WARgC,OAAAy1E,EAAAx1E,MAAC,KAADC,UAAA,EAnBC,IAmBD,CAAAhB,IAAA,uBAAAC,MAajC,WACE,OAAOf,KAAKy1E,iBACd,GAAC,CAAA30E,IAAA,oBAAAC,MAKD,WACE,OAAKf,KAAK21E,mBAOH,CACL2B,iBAAiB,EACjB/5D,UALU,IAAI5a,MACKm0E,UAAY92E,KAAK21E,mBAAmBmB,WAJhD,CAAEQ,iBAAiB,EAAO/5D,SAAU,KAU/C,GAAC,CAAAzc,IAAA,8BAAAC,MAAA,eAAAw2E,GAAAt2E,EAAAA,EAAAA,UAKD,YACE,IAEE,IAAMu2E,QAAe/wE,EAAAA,QAAaC,QAAQ2G,GAAa0nE,oBACvD,GAAIyC,EAGF,OAFAx3E,KAAKy1E,kBAAoBtyE,KAAKiL,MAAMopE,QACpC73E,EAAOmE,MAAM,yCAKf9D,KAAKy1E,wBAA0Bz1E,KAAKy3E,kCAG9BhxE,EAAAA,QAAagC,QACjB4E,GAAa0nE,mBACb5xE,KAAKC,UAAUpD,KAAKy1E,oBAGtB91E,EAAOqE,KAAK,mCACd,CAAE,MAAOpC,GACPjC,EAAOiC,MAAM,2CAA4CA,GAEzD5B,KAAKy1E,kBAAoB,IAC3B,CACF,IAzByC,OAyBxC,WAzBwC,OAAA8B,EAAA11E,MAAC,KAADC,UAAA,EALxC,IAKwC,CAAAhB,IAAA,4BAAAC,MAAA,eAAA22E,GAAAz2E,EAAAA,EAAAA,UA8BzC,YACE,IACE,IAAM02E,EAAWz3E,EAAAA,QAASC,GACpB0xB,EAAU3xB,EAAAA,QAAS03E,QAAQj4C,WAG7Bk4C,EAAmB,UACD,qBAAXlzE,QAA0BA,OAAOqmB,SAC1C6sD,EAAsBlzE,OAAOqmB,OAAO/N,MAAK,IAAItY,OAAOqmB,OAAO9N,QAI7D,IAMI46D,EANEC,EAAWC,KAAKC,iBAAiBC,kBAAkBC,SAGnD3jB,EAAWwjB,KAAKC,iBAAiBC,kBAAkBE,OAIrC,QAAhBl4E,EAAAA,QAASC,IAAqC,qBAAdk4E,YAClCP,EAAYO,UAAUP,WAIxB,IAAMQ,EAAkB,CACtBX,SAAAA,EACA9lD,QAAAA,EACAgmD,iBAAAA,EACAE,SAAAA,EACAvjB,SAAAA,EACAsjB,UAAAA,GAII7iE,QAAajV,KAAKu4E,gBAAgBD,GAExC,OAAAzvE,GAAAA,GAAA,GACKyvE,GAAe,IAClBrjE,KAAAA,GAEJ,CAAE,MAAOrT,GAEP,MADAjC,EAAOiC,MAAM,yCAA0CA,GACjDA,CACR,CACF,IA5CuC,OA4CtC,WA5CsC,OAAA81E,EAAA71E,MAAC,KAADC,UAAA,EA9BE,IA8BF,CAAAhB,IAAA,kBAAAC,MAAA,eAAAy3E,GAAAv3E,EAAAA,EAAAA,UAiDvC,UAA8B8B,GAC5B,IAKE,IAJA,IAAM01E,EAAat1E,KAAKC,UAAUL,GAG9BkS,EAAO,EACFjC,EAAI,EAAGA,EAAIylE,EAAWt2E,OAAQ6Q,IAAK,CAE1CiC,GAASA,GAAQ,GAAKA,EADTwjE,EAAWxlE,WAAWD,GAEnCiC,GAAOA,CACT,CAEA,OAAOkL,KAAKsjB,IAAIxuB,GAAM0qB,SAAS,GACjC,CAAE,MAAO/9B,GAEP,OADAjC,EAAOiC,MAAM,8BAA+BA,GACrC,SACT,CACF,IAjB6B,OAiB5B,SAjB4BmO,GAAA,OAAAyoE,EAAA32E,MAAC,KAADC,UAAA,EAjDU,IAiDV,CAAAhB,IAAA,wBAAAC,MAsB7B,WAAuC,IAADgB,EAAA,KACpC22E,GAAAA,QAASC,iBAAiB,UAAU,SAACC,GACnC,GAAqB,eAAjBA,EACF72E,EAAK2zE,mBAAoB,EACzB3zE,EAAK4zE,mBAAqB,IAAIhzE,KAC9BhD,EAAOmE,MAAM,gCACR,GAAqB,WAAjB80E,GAA6B72E,EAAK2zE,kBAAmB,CAC9D3zE,EAAK2zE,mBAAoB,EACzB,IAAMmD,EAAqB92E,EAAK4zE,oBAC5B,IAAIhzE,MAAOm0E,UAAY/0E,EAAK4zE,mBAAmBmB,UAC/C,EACJn3E,EAAOmE,MAAM,oCAAoC+0E,EAAkB,KACrE,CACF,GACF,GAAC,CAAA/3E,IAAA,yBAAAC,MAAA,eAAA+3E,GAAA73E,EAAAA,EAAAA,UAKD,YACE,IACE,IAAMg1E,QAAiBj2E,KAAKm3E,wBAAwB,CAClDV,eAAe,EACfC,OAAQ,MACRC,sBAAsB,IAElB5oD,EAAM,IAAIprB,KACVo0E,EAAgBd,EAASlkE,QAAO,SAAA4hC,GAAO,OAAIA,EAAQH,UAAYzlB,CAAG,IAEpEgpD,EAAc50E,OAAS8zE,EAAS9zE,eAC5BnC,KAAKo3E,qBAAqBL,GAChCp3E,EAAOqE,KAAK,eAAciyE,EAAS9zE,OAAS40E,EAAc50E,QAAM,6BAEpE,CAAE,MAAOP,GACPjC,EAAOiC,MAAM,sCAAuCA,EAEtD,CACF,IAlBoC,OAkBnC,WAlBmC,OAAAk3E,EAAAj3E,MAAC,KAADC,UAAA,EALnC,IAKmC,CAAAhB,IAAA,WAAAC,MAAA,eAAAg4E,GAAA93E,EAAAA,EAAAA,UAuBpC,YACE,UACQjB,KAAK41E,eAAeriE,QAC1BvT,KAAKy1E,kBAAoB,KACzBz1E,KAAK21E,mBAAqB,KAC1Bh2E,EAAOqE,KAAK,mCACd,CAAE,MAAOpC,GAEP,MADAjC,EAAOiC,MAAM,mCAAoCA,GAC3CA,CACR,CACF,IAVqB,OAUpB,WAVoB,OAAAm3E,EAAAl3E,MAAC,KAADC,UAAA,EAvBe,KAuBf,EAAAhB,IAAA,cAAAC,MA5UrB,WAIE,OAHKy0E,EAAsBxjE,WACzBwjE,EAAsBxjE,SAAW,IAAIwjE,GAEhCA,EAAsBxjE,QAC/B,IAAC,CAjB+B,GAsWyBE,cCgL9C8mE,GArkBgB,WAgB3B,SAAAC,KAAsBn5E,EAAAA,EAAAA,SAAA,KAAAm5E,GAAA,KAbdn/C,eAAgB,EAAM,KACtBo/C,gBAA6C,GAAG,KAGhDC,gBAAqC,CAC3CC,qBAAqB,EACrBC,2BAA2B,EAC3BC,eAAgB,GAChBC,qBAAsB,EACtBC,iBAAiB,EACjB5M,cAAe,YAIf5sE,KAAKgyC,aAAehC,GAAa99B,aACnC,CAAC,OAAAtS,EAAAA,EAAAA,SAAAq5E,EAAA,EAAAn4E,IAAA,aAAAC,MAAA,eAAA4vB,GAAA1vB,EAAAA,EAAAA,UAYD,YACE,GAAIjB,KAAK85B,cACPn6B,EAAOmE,MAAM,6CAIf,IACEnE,EAAOqE,KAAK,uCAGNhE,KAAKgyC,aAAa/6B,mBAClBs+D,GAAsBt+D,mBAGtBjX,KAAKy5E,sBAEXz5E,KAAK85B,eAAgB,EACrBn6B,EAAOqE,KAAK,4CACd,CAAE,MAAOpC,GAEP,MADAjC,EAAOiC,MAAM,yCAA0CA,GACjDA,CACR,CACF,IAtBuB,OAsBtB,WAtBsB,OAAA+uB,EAAA9uB,MAAC,KAADC,UAAA,EAZtB,IAYsB,CAAAhB,IAAA,kBAAAC,MAAA,eAAA24E,GAAAz4E,EAAAA,EAAAA,UA2BvB,UAA6B0E,GAC3B,IACO3F,KAAK85B,sBACF95B,KAAKiX,cAGbtX,EAAOqE,KAAK,wBAAwB2B,EAAQ0oE,UAG5C,IAAMoH,EAAoBF,GAAsBoE,uBAChD,IAAKlE,EACH,MAAM,IAAIlyE,MAAM,kDAIlBvD,KAAK45E,2BAA2Bj0E,GAGhC,IAAM8qC,EAAQzwC,KAAK65E,gBAInBl6E,EAAOqE,KAAK,4BAA4BysC,GAGxC,IAAMqpC,EAA6B,CACjCjwE,GAAI4mC,EACJ49B,SAAU1oE,EAAQ0oE,SAClBmB,WAAY7pE,EAAQ6pE,WACpB53D,YAAY,IAAIjV,MAAOC,cACvBiV,YAAY,IAAIlV,MAAOC,cACvB6sE,QAAS,EAGTsK,yBAA0B,kBAC1BxR,YAAa,SACbE,mBAAoBgN,EAAkBxgE,KAGtCmzD,eAAgBziE,EAAQyiE,eACxB4R,qBAAqB,IAAIr3E,MAAOC,cAChC8sE,qBAAsB,SAIlB1vE,KAAKi6E,eAAeH,GAG1B,IAAMxmC,EAAc,CAClB4mC,YAAa,0BACbC,UAAW,wBACXC,WAAY,IAAIz3E,KAAKA,KAAKorB,MAAQ,KAAgBnrB,eAkBpD,aAdM5C,KAAKq6E,qBAAqB,CAC9B7mD,KAAM,WACNid,MAAAA,EACA3e,UAAW,IAAInvB,KACf8yE,kBAAmBA,EAAkBxgE,KACrC23D,cAAejnE,EAAQyiE,eACvBkS,SAAU,CACRjuE,QAAS1G,EAAQ0oE,SACjBkM,WAAY,YAIhB56E,EAAOqE,KAAK,oCAAoCysC,GAEzC,CACLlhC,SAAS,EACT/C,IAAKstE,EACLU,aAAclnC,EAElB,CAAE,MAAO1xC,GAgBP,OAfAjC,EAAOiC,MAAM,+BAAgCA,SAGvC5B,KAAKq6E,qBAAqB,CAC9B7mD,KAAM,QACNid,MAAO9qC,EAAQ0oE,SACfv8C,UAAW,IAAInvB,KACf8yE,kBAAmB9vE,EAAQ8iE,mBAC3BmE,cAAejnE,EAAQyiE,eACvBkS,SAAU,CACR14E,MAAOA,aAAiB2B,MAAQ3B,EAAMW,QAAU,gBAChDk4E,UAAW,cAIR,CACLlrE,SAAS,EACT/C,IAAK,CAAC,EACN5K,MAAOA,aAAiB2B,MAAQ3B,EAAMW,QAAU,8BAEpD,CACF,IAhG4B,OAgG3B,SAhG2BkB,GAAA,OAAAi2E,EAAA73E,MAAC,KAADC,UAAA,EA3BL,IA2BK,CAAAhB,IAAA,wBAAAC,MAAA,eAAA25E,GAAAz5E,EAAAA,EAAAA,UAqG5B,UAAmC0E,GACjC,IACEhG,EAAOqE,KAAK,8BAA8B2B,EAAQ2pE,QAGlD,IAAMmG,EAAoBF,GAAsBoE,uBAChD,IAAKlE,EACH,MAAM,IAAIlyE,MAAM,4DAIlB,IAAMiJ,QAAYxM,KAAK26E,aAAah1E,EAAQ2pE,QAC5C,GAAI9iE,GAAOA,EAAIi8D,qBAAuBgN,EAAkBxgE,KACtD,MAAM,IAAI1R,MAAM,+BAKlB5D,EAAOqE,KAAK,6CAA6C2B,EAAQ2pE,QAG7D9iE,IACFA,EAAIwtE,qBAAsB,IAAIr3E,MAAOC,cACrC4J,EAAIkjE,sBAAwBljE,EAAIkjE,sBAAwB,GAAK,QACvD1vE,KAAK46E,gBAAgBpuE,IAI7B,IAAM8mC,EAAc,CAClB4mC,YAAa,0BACbC,UAAW,wBACXC,WAAY,IAAIz3E,KAAKA,KAAKorB,MAAQ,KAAgBnrB,eAiBpD,aAbM5C,KAAKq6E,qBAAqB,CAC9B7mD,KAAM,iBACNid,MAAO9qC,EAAQ2pE,OACfx9C,UAAW,IAAInvB,KACf8yE,kBAAmBA,EAAkBxgE,KACrC23D,eAAkB,MAAHpgE,OAAG,EAAHA,EAAK47D,iBAAkB,WACtCkS,SAAU,CACRO,qBAAwB,MAAHruE,OAAG,EAAHA,EAAKkjE,uBAAwB,KAItD/vE,EAAOqE,KAAK,0CAA0C2B,EAAQ2pE,QAEvD,CACL//D,SAAS,EACTirE,aAAclnC,EAElB,CAAE,MAAO1xC,GAgBP,OAfAjC,EAAOiC,MAAM,qCAAsCA,SAG7C5B,KAAKq6E,qBAAqB,CAC9B7mD,KAAM,QACNid,MAAO9qC,EAAQ2pE,OACfx9C,UAAW,IAAInvB,KACf8yE,kBAAmB9vE,EAAQ8iE,mBAC3BmE,cAAe,WACf0N,SAAU,CACR14E,MAAOA,aAAiB2B,MAAQ3B,EAAMW,QAAU,gBAChDk4E,UAAW,oBAIR,CACLlrE,SAAS,EACT3N,MAAOA,aAAiB2B,MAAQ3B,EAAMW,QAAU,wBAEpD,CACF,IAzEkC,OAyEjC,SAzEiCmB,GAAA,OAAAg3E,EAAA74E,MAAC,KAADC,UAAA,EArGN,IAqGM,CAAAhB,IAAA,kBAAAC,MAAA,eAAA+5E,GAAA75E,EAAAA,EAAAA,UA8ElC,UACE85E,EACAC,GAEA,IACEr7E,EAAOqE,KAAK,mCAAmC+2E,EAAUlxE,IAGzD,IAAM4rE,EAAoBF,GAAsBoE,uBAChD,IAAKlE,EACH,MAAM,IAAIlyE,MAAM,uDAIlB,IAAM03E,EAA6C,CACjD5M,SAAU0M,EAAU1M,SACpB6M,kBAAmBF,EACnBxL,WAAYuL,EAAUvL,WACtB/G,mBAAoBgN,EAAkBxgE,KACtCmzD,eAAgB,YAIZ15D,QAAe1O,KAAKm7E,gBAAgBF,GAmB1C,OAjBIvsE,EAAOa,UACT5P,EAAOqE,KAAK,qCAAqC+2E,EAAUlxE,GAAE,OAAO6E,EAAOlC,IAAI3C,UAGzE7J,KAAKq6E,qBAAqB,CAC9B7mD,KAAM,YACNid,MAAO/hC,EAAOlC,IAAI3C,GAClBioB,UAAW,IAAInvB,KACf8yE,kBAAmBA,EAAkBxgE,KACrC23D,cAAe,WACf0N,SAAU,CACRc,YAAaL,EAAUlxE,GACvBwxE,eAAe,IAAI14E,MAAOC,kBAKzB8L,CACT,CAAE,MAAO9M,GAEP,OADAjC,EAAOiC,MAAM,0CAA2CA,GACjD,CACL2N,SAAS,EACT/C,IAAK,CAAC,EACN5K,MAAOA,aAAiB2B,MAAQ3B,EAAMW,QAAU,mBAEpD,CACF,IAnD4B,OAmD3B,SAnD2BoB,EAAAiJ,GAAA,OAAAkuE,EAAAj5E,MAAC,KAADC,UAAA,EA9EM,IA8EN,CAAAhB,IAAA,mBAAAC,MAwD5B,SAAwBg6E,GAetB,MAAO,CACLO,YAAY,EACZP,UAAAA,EACAQ,cAAe,GACfC,iBAlBuB,CACvB,gCACA,4BACA,8BACA,8BACA,sCAcAC,MAXY,CACZ,iCACA,wCACA,qCASAC,gBAAgB,EAEpB,GAAC,CAAA56E,IAAA,gBAAAC,MAAA,eAAA46E,GAAA16E,EAAAA,EAAAA,UAKD,YACE,IAGE,OADAtB,EAAOmE,MAAM,0BACN,EACT,CAAE,MAAOlC,GAEP,OADAjC,EAAOiC,MAAM,kCAAmCA,GACzC,EACT,CACF,IAT0B,OASzB,WATyB,OAAA+5E,EAAA95E,MAAC,KAADC,UAAA,EALzB,IAKyB,CAAAhB,IAAA,aAAAC,MAAA,eAAAi+D,GAAA/9D,EAAAA,EAAAA,UAc1B,YACE,OAAOjB,KAAK47E,eACd,IAFuB,OAEtB,WAFsB,OAAA5c,EAAAn9D,MAAC,KAADC,UAAA,EAdG,IAcH,CAAAhB,IAAA,gBAAAC,MAAA,eAAA86E,GAAA56E,EAAAA,EAAAA,UAOvB,YACE,IACEtB,EAAOmE,MAAM,iCAGb,IAGMm2D,EAHiBxoB,GAAoB6E,oBAGU5a,KAAI,SAAAiY,GAAO,IAAAmoC,EAAA,MAAK,CACnEjyE,GAAI8pC,EAAQlD,MACZ49B,SAAU16B,EAAQtnC,QAClBmjE,WAAY,UACZ53D,WAAY+7B,EAAQJ,UAAU3wC,cAC9BiV,WAAY87B,EAAQyiC,aAAaxzE,cACjC6sE,QAAS,EAGTsK,yBAA0B,GAC1BxR,YAAa,SACbE,oBAAgE,OAA5CqT,EAAAvG,GAAsBoE,6BAAsB,EAA5CmC,EAA8C7mE,OAAQ,GAG1EmzD,eAAgB,WAChB4R,oBAAqBrmC,EAAQyiC,aAAaxzE,cAC1C8sE,qBAAsB,EACvB,IAGD,OADA/vE,EAAOmE,MAAM,SAASm2D,EAAW93D,OAAM,uBAChC83D,CACT,CAAE,MAAOr4D,GAEP,OADAjC,EAAOiC,MAAM,yCAA0CA,GAChD,EACT,CACF,IAjC0B,OAiCzB,WAjCyB,OAAAi6E,EAAAh6E,MAAC,KAADC,UAAA,EAPH,IAOG,CAAAhB,IAAA,cAAAC,MAAA,eAAAg7E,GAAA96E,EAAAA,EAAAA,UAsC1B,UAAyBwvC,GACvB,IAKE,MAJA9wC,EAAOqE,KAAK,0BAA0BysC,GAIhC,IAAIltC,MAAM,gEAClB,CAAE,MAAO3B,GAEP,MADAjC,EAAOiC,MAAM,iCAAiC6uC,EAAK,IAAK7uC,GAClDA,CACR,CACF,IAXwB,OAWvB,SAXuBiL,GAAA,OAAAkvE,EAAAl6E,MAAC,KAADC,UAAA,EAtCE,IAsCF,CAAAhB,IAAA,gBAAAC,MAAA,eAAAi7E,GAAA/6E,EAAAA,EAAAA,UAgBxB,UAA2BwvC,GACzB,IACE9wC,EAAOqE,KAAK,4BAA4BysC,GAGpCgB,GAAoBkB,gBAAgBlC,IAItC9wC,EAAOqE,KAAK,cAAcysC,EAAK,0DAGjC9wC,EAAOqE,KAAK,wCAAwCysC,EACtD,CAAE,MAAO7uC,GAEP,MADAjC,EAAOiC,MAAM,mCAAmC6uC,EAAK,IAAK7uC,GACpDA,CACR,CACF,IAjB0B,OAiBzB,SAjByBoL,GAAA,OAAAgvE,EAAAn6E,MAAC,KAADC,UAAA,EAhBF,IAgBE,CAAAhB,IAAA,YAAAC,MAAA,eAAAgM,GAAA9L,EAAAA,EAAAA,UAsB1B,UAAuBwvC,GAErB,WADqBzwC,KAAKi8E,gBAAgBxrC,IAExC,MAAM,IAAIltC,MAAM,gCAAgCktC,EAEpD,IALsB,OAKrB,SALqB1gC,GAAA,OAAAhD,EAAAlL,MAAC,KAADC,UAAA,EAtBI,IAsBJ,CAAAhB,IAAA,kBAAAC,MAAA,eAAAm7E,GAAAj7E,EAAAA,EAAAA,UAUtB,UAA6BwvC,GAC3B,IAYE,OAXA9wC,EAAOqE,KAAK,wBAAwBysC,GAGhCgB,GAAoBkB,gBAAgBlC,IACtC9wC,EAAOqE,KAAK,cAAcysC,EAAK,oDAI3BzwC,KAAKm8E,gBAAgB1rC,GAE3B9wC,EAAOqE,KAAK,oCAAoCysC,IACzC,CACT,CAAE,MAAO7uC,GAEP,OADAjC,EAAOiC,MAAM,+BAAgCA,IACtC,CACT,CACF,IAlB4B,OAkB3B,SAlB2BoO,GAAA,OAAAksE,EAAAr6E,MAAC,KAADC,UAAA,EAVN,IAUM,CAAAhB,IAAA,qBAAAC,MAuB5B,WACE,OAAAo6B,EAAAA,GAAAA,SAAWn7B,KAAKk5E,gBAClB,GAAC,CAAAp4E,IAAA,6BAAAC,MAKD,SAAmC4E,GACjC,IAAKA,EAAQ0oE,UAAY1oE,EAAQ0oE,SAAS1nD,OAAOxkB,OAAS,EACxD,MAAM,IAAIoB,MAAM,0CAGlB,IAAKoC,EAAQu1E,mBAAqBv1E,EAAQu1E,kBAAkBv0D,OAAOxkB,OAAS,EAC1E,MAAM,IAAIoB,MAAM,mDAGlB,IAAKoC,EAAQ6pE,aAAe7pE,EAAQ6pE,WAAW9a,MAAM,qBACnD,MAAM,IAAInxD,MAAM,sBAGlB,IAAKoC,EAAQ8iE,mBACX,MAAM,IAAIllE,MAAM,8BAEpB,GAAC,CAAAzC,IAAA,gBAAAC,MAKD,WACE,MAAM,cAAe4B,KAAKorB,MAAK,IAAI5N,KAAKm1C,SAAS31B,SAAS,IAAIy8C,OAAO,EAAG,EAC1E,GAAC,CAAAt7E,IAAA,uBAAAC,MAAA,eAAAs7E,GAAAp7E,EAAAA,EAAAA,UAKD,UAAmCwvC,EAAesC,GAKhD,OAFApzC,EAAOmE,MAAM,qCAAqC2sC,GAE3C,CACLypC,YAAa,0BACbC,UAAW,wBACXC,WAAY,IAAIz3E,KAAKA,KAAKorB,MAAQ,KAAgBnrB,cAEtD,IAVkC,OAUjC,SAViC8N,EAAAC,GAAA,OAAA0rE,EAAAx6E,MAAC,KAADC,UAAA,EALjC,IAKiC,CAAAhB,IAAA,iBAAAC,MAAA,eAAAu7E,GAAAr7E,EAAAA,EAAAA,UAelC,UAA6BuL,GAE3B7M,EAAOmE,MAAM,uBAAuB0I,EAAI3C,GAC1C,IAH4B,OAG3B,SAH2B+G,GAAA,OAAA0rE,EAAAz6E,MAAC,KAADC,UAAA,EAfM,IAeN,CAAAhB,IAAA,eAAAC,MAAA,eAAAw7E,GAAAt7E,EAAAA,EAAAA,UAQ5B,UAA2BwvC,GAGzB,OADA9wC,EAAOmE,MAAM,0BAA0B2sC,GAChC,IACT,IAJ0B,OAIzB,SAJyBl/B,GAAA,OAAAgrE,EAAA16E,MAAC,KAADC,UAAA,EARE,IAQF,CAAAhB,IAAA,kBAAAC,MAAA,eAAAy7E,GAAAv7E,EAAAA,EAAAA,UAS1B,UAA8BuL,GAC5BA,EAAIqL,YAAa,IAAIlV,MAAOC,cAE5BjD,EAAOmE,MAAM,wBAAwB0I,EAAI3C,GAC3C,IAJ6B,OAI5B,SAJ4B2H,GAAA,OAAAgrE,EAAA36E,MAAC,KAADC,UAAA,EATH,IASG,CAAAhB,IAAA,kBAAAC,MAAA,eAAA07E,GAAAx7E,EAAAA,EAAAA,UAS7B,UAA8BwvC,GAE5B9wC,EAAOmE,MAAM,wBAAwB2sC,EACvC,IAH6B,OAG5B,SAH4BpU,GAAA,OAAAogD,EAAA56E,MAAC,KAADC,UAAA,EATA,IASA,CAAAhB,IAAA,uBAAAC,MAAA,eAAA27E,GAAAz7E,EAAAA,EAAAA,UAQ7B,UAAmC+rC,GACjC,IACEhtC,KAAKk5E,gBAAgBrrC,KAAKb,GAGtBhtC,KAAKk5E,gBAAgB/2E,OAAS,MAChCnC,KAAKk5E,gBAAkBl5E,KAAKk5E,gBAAgBt3C,OAAO,MAIrDjiC,EAAOmE,MAAM,6BAA6BkpC,EAAMxZ,KAAI,YAAYwZ,EAAMyD,MACxE,CAAE,MAAO7uC,GACPjC,EAAOiC,MAAM,oCAAqCA,EACpD,CACF,IAdkC,OAcjC,SAdiCyvC,GAAA,OAAAqrC,EAAA76E,MAAC,KAADC,UAAA,EARL,IAQK,CAAAhB,IAAA,sBAAAC,MAAA,eAAA47E,GAAA17E,EAAAA,EAAAA,UAmBlC,YACE,IAEEtB,EAAOmE,MAAM,2BACf,CAAE,MAAOlC,GACPjC,EAAOiC,MAAM,mCAAoCA,EACnD,CACF,IAPiC,OAOhC,WAPgC,OAAA+6E,EAAA96E,MAAC,KAADC,UAAA,EAnBC,IAmBD,CAAAhB,IAAA,UAAAC,MAAA,eAAAizC,GAAA/yC,EAAAA,EAAAA,UAYjC,YACE,IACEtB,EAAOqE,KAAK,gCAEZhE,KAAKk5E,gBAAkB,GACvBl5E,KAAK85B,eAAgB,EAErBn6B,EAAOqE,KAAK,oCACd,CAAE,MAAOpC,GAEP,MADAjC,EAAOiC,MAAM,yCAA0CA,GACjDA,CACR,CACF,IAZoB,OAYnB,WAZmB,OAAAoyC,EAAAnyC,MAAC,KAADC,UAAA,EAZa,KAYb,EAAAhB,IAAA,cAAAC,MAjiBpB,WAIE,OAHKk4E,EAAiBjnE,WACpBinE,EAAiBjnE,SAAW,IAAIinE,GAE3BA,EAAiBjnE,QAC1B,IAAC,CAzB0B,GAqkBoBE,cCtZ3CkT,GAAY,SAACnG,GAAe,OAAK2B,EAAAA,QAAWxb,OAAO,CACvDyb,UAAW,CACTC,KAAM,EACNC,gBAAiB9B,EAAMC,OAAOpG,YAEhC7O,QAAS,CACP6W,KAAM,EACNQ,QAASrC,EAAMvC,QAAQV,GACvBqF,eAAgB,UAElBunD,iBAAkB,CAChBxnD,WAAY,SACZ6B,aAAchE,EAAMvC,QAAQV,IAE9B8sD,aAAc,CACZrnD,SAAUxC,EAAM7D,WAAWO,UAAUM,IACrCyF,WAAY,OACZC,MAAO1C,EAAMC,OAAOtd,MACpBshB,UAAW,SACXD,aAAchE,EAAMvC,QAAQZ,GAC5B6G,WAAY1D,EAAM7D,WAAWC,aAAaI,MAE5CmhE,eAAgB,CACdn7D,SAAUxC,EAAM7D,WAAWO,UAAUI,GACrC4F,MAAO1C,EAAMC,OAAOjG,KACpBiK,UAAW,SACXD,aAAchE,EAAMvC,QAAQZ,GAC5B6G,WAAY1D,EAAM7D,WAAWC,aAAaC,SAE5CuhE,iBAAkB,CAChBp7D,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC6F,MAAO1C,EAAMC,OAAOtd,MACpBshB,UAAW,SACXD,aAAchE,EAAMvC,QAAQZ,GAC5B6G,WAAY1D,EAAM7D,WAAWC,aAAaE,OAC1CwF,gBAAiB9B,EAAMC,OAAO3F,YAAc0F,EAAMC,OAAOtd,MAAQ,KACjE0f,QAASrC,EAAMvC,QAAQZ,GACvBc,aAAcqC,EAAMrC,aAAad,GACjCyL,YAAa,EACbD,YAAarI,EAAMC,OAAOtd,MAAQ,MAEpCk7E,eAAgB,CACdr7D,SAAUxC,EAAM7D,WAAWO,UAAUE,GACrC8F,MAAO1C,EAAMC,OAAOhG,cACpBgK,UAAW,SACXD,aAAchE,EAAMvC,QAAQV,GAC5B2G,WAAY1D,EAAM7D,WAAWC,aAAaC,SAE5CyhE,sBAAuB,CACrB95D,aAAchE,EAAMvC,QAAQV,IAE9BghE,kBAAmB,CACjBv7D,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC6F,MAAO1C,EAAMC,OAAOjG,KACpBgK,aAAchE,EAAMvC,QAAQb,GAC5B8G,WAAY1D,EAAM7D,WAAWC,aAAaE,QAE5C0hE,kBAAmB,CACjB11D,YAAa,EACbD,YAAarI,EAAMC,OAAO9F,OAC1BwD,aAAcqC,EAAMrC,aAAad,GACjCwF,QAASrC,EAAMvC,QAAQZ,GACvB2F,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC6F,MAAO1C,EAAMC,OAAOjG,KACpB8H,gBAAiB9B,EAAMC,OAAOvF,gBAC9BgJ,WAAY1D,EAAM7D,WAAWC,aAAaC,SAE5CswD,gBAAiB,CACfzqD,cAAe,MACfE,eAAgB,gBAChB4iB,IAAKhlB,EAAMvC,QAAQZ,IAErBuJ,OAAQ,CACNvE,KAAM,EACNkB,gBAAiB/C,EAAMvC,QAAQZ,GAC/BmG,kBAAmBhD,EAAMvC,QAAQX,GACjCa,aAAcqC,EAAMrC,aAAad,GACjCsF,WAAY,SACZC,eAAgB,SAChBiE,UAAW,IAEbumD,aAAc,CACZ9qD,gBAAiB9B,EAAMC,OAAOlG,KAC9BuO,YAAa,EACbD,YAAarI,EAAMC,OAAO9F,QAE5B0yD,iBAAkB,CAChBrqD,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC6F,MAAO1C,EAAMC,OAAOjG,KACpB0J,WAAY1D,EAAM7D,WAAWC,aAAaE,QAE5C21D,aAAc,CACZnwD,gBAAiB9B,EAAMC,OAAOtd,OAEhCs7E,iBAAkB,CAChBz7D,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC6F,MAAO1C,EAAMC,OAAO8G,SAAW/G,EAAMC,OAAO5E,MAC5CqI,WAAY1D,EAAM7D,WAAWC,aAAaG,UAE5CgK,eAAgB,CACdwQ,QAAS,IAEXg0C,eAAgB,CACd7oD,cAAe,MACfC,WAAY,SACZoB,UAAWvD,EAAMvC,QAAQV,GACzBsF,QAASrC,EAAMvC,QAAQZ,GACvBiF,gBAAiB9B,EAAMC,OAAOlG,KAC9B4D,aAAcqC,EAAMrC,aAAad,GACjCyL,YAAa,EACbD,YAAarI,EAAMC,OAAO9F,QAE5BgxD,mBAAoB,CAClB3oD,SAAUxC,EAAM7D,WAAWO,UAAUE,GACrC8F,MAAO1C,EAAMC,OAAOhG,cACpByM,WAAY1G,EAAMvC,QAAQb,GAC1BiF,KAAM,EACN6B,WAAY1D,EAAM7D,WAAWC,aAAaC,UAE3C,EAEH,SAnS8C,WAC5C,IAAM+N,GAAaC,EAAAA,GAAAA,iBACbk4B,GAAQujB,EAAAA,GAAAA,YACN9lD,EAAUG,KAAVH,MACF0B,EAASyE,GAAUnG,GAEzB0lD,EAAoCnjB,EAAM93C,OAAlC+mC,EAAKk0B,EAALl0B,MAAOpkC,EAAOs4D,EAAPt4D,QAAS8wE,EAAOxY,EAAPwY,QAGxB3nE,GAAoCC,EAAAA,EAAAA,WAAS,GAAMC,GAAAC,EAAAA,EAAAA,SAAAH,EAAA,GAA5C4nE,EAAU1nE,EAAA,GAAE2nE,EAAa3nE,EAAA,GAChCI,GAAgDL,EAAAA,EAAAA,UAAS,IAAGM,GAAAJ,EAAAA,EAAAA,SAAAG,EAAA,GAArDwnE,EAAgBvnE,EAAA,GAAEwnE,EAAmBxnE,EAAA,GAC5CG,GAA0DT,EAAAA,EAAAA,WAAS,GAAMU,GAAAR,EAAAA,EAAAA,SAAAO,EAAA,GAAlEsnE,EAAqBrnE,EAAA,GAAEsnE,EAAwBtnE,EAAA,GAGhDunE,EAA0B,WAAZP,EACdQ,EAAuBD,EACvBE,EAAuBD,EAAuBtxE,EAAU,UAE9DoK,EAAAA,EAAAA,YAAU,WACJknE,GACFF,GAAyB,EAE7B,GAAG,CAACE,IAKJ,IAAME,EAAY,eAAAx3E,GAAApF,EAAAA,EAAAA,UAAG,YACnB,GAAI08E,GAAwBL,IAAqBM,EAC/C12C,GAAAA,QAAMC,MACJ,wBAAwB,gBACRy2C,EAAoB,8BAHxC,CAQAP,GAAc,GAEd,IACMK,SACI1E,GAAiBlsE,UAAU2jC,GACjC9wC,EAAOqE,KAAK,sBAAuB,CAAEysC,MAAAA,EAAOpkC,QAAAA,YAEtCyyD,GAAWhyD,UAAU2jC,GAC3B9wC,EAAOqE,KAAK,uBAAwB,CAAEysC,MAAAA,EAAOpkC,QAAAA,KAG/C66B,GAAAA,QAAMC,MACJ,cAAc,IACV96B,EAAO,kCACX,CACE,CACE4M,KAAM,KACN+L,QAAS,WAAF,OAAQqE,EAAWi9C,QAAQ,IAI1C,CAAE,MAAO1kE,GACPjC,EAAOiC,MAAM,wBAAyBA,GACtCslC,GAAAA,QAAMC,MACJ,gBACAvlC,aAAiB2B,MAAQ3B,EAAMW,QAAU,0CAE7C,CAAC,QACC86E,GAAc,EAChB,CA/BA,CAgCF,IAAC,kBAvCiB,OAAAh3E,EAAAxE,MAAA,KAAAC,UAAA,KAgDZg8E,GAAaH,GAAwBL,IAAqBM,EAEhE,OACEj5D,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOE,UAAUtL,SAAA,EAC5B4C,EAAAA,EAAAA,KAAC4vB,GAAY,CAAC/9B,MAAM,gBAEpB2a,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAO1W,QAAQsL,SAAA,EAE1B4C,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAOioD,iBAAiBrzD,UACnC4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CACP/U,KAAMwtE,EAAc,iBAAmB,kBACvC/7E,KAAM,GACNggB,MAAO1C,EAAMC,OAAOtd,WAKxBuW,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOmoD,aAAavzD,SAC9BmoE,EAAc,qBAAuB,iBAGxC/4D,EAAAA,EAAAA,MAACO,EAAAA,QAAI,CAACL,MAAOlE,EAAOi8D,eAAernE,SAAA,CAAC,gDACYlJ,EAAQ,QAGvDqxE,IACCvlE,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOk8D,iBAAiBtnE,SAAC,oIAMxC4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOm8D,eAAevnE,SAAC,kCAKnCioE,IACC74D,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOo8D,sBAAsBxnE,SAAA,EACxCoP,EAAAA,EAAAA,MAACO,EAAAA,QAAI,CAACL,MAAOlE,EAAOq8D,kBAAkBznE,SAAA,CAAC,SAC9BqoE,EAAqB,oBAE9BzlE,EAAAA,EAAAA,KAACmS,GAAAA,QAAS,CACRzF,MAAOlE,EAAOs8D,kBACdl8E,MAAOu8E,EACP9yD,aAAc+yD,EACdhzD,YAAaqzD,EACbhzD,qBAAsB3L,EAAMC,OAAOhG,cACnCwR,eAAe,OACfC,aAAa,QAMnBhG,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOirD,gBAAgBr2D,SAAA,EAClC4C,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CACfF,MAAO,CAAClE,EAAO0E,OAAQ1E,EAAOkrD,cAC9B7mD,QA9DW,WACnBqE,EAAWi9C,QACb,EA6DU5sD,SAAU0jE,EAAW7nE,UAErB4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOmrD,iBAAiBv2D,SAAC,cAGxC4C,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CACfF,MAAO,CACLlE,EAAO0E,OACP1E,EAAOuwD,eACL4M,GAAaV,IAAez8D,EAAO6E,gBAEvCR,QAAS64D,EACTnkE,UAAWokE,GAAaV,EAAW7nE,SAElC6nE,GACCjlE,EAAAA,EAAAA,KAACgN,GAAAA,QAAiB,CAACxjB,KAAK,QAAQggB,MAAO1C,EAAMC,OAAO8G,WAEpD7N,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOu8D,iBAAiB3nE,SAAC,gBAM3CmoE,IACC/4D,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOqpD,eAAez0D,SAAA,EACjC4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,qBAAqBvO,KAAM,GAAIggB,MAAO1C,EAAMC,OAAOhG,iBAClEf,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOypD,mBAAmB70D,SAAC,uFAQpD,EC7KA,IA4IM6P,GAAY,SAACnG,GAAe,OAAK2B,EAAAA,QAAWxb,OAAO,CACvDyb,UAAW,CACToC,aAAchE,EAAMvC,QAAQZ,IAE9B9R,MAAO,CACLyX,SAAU,GACVC,WAAY,MACZC,MAAO1C,EAAMC,OAAOjG,KACpBgK,aAAchE,EAAMvC,QAAQb,GAC5B8J,WAAY1G,EAAMvC,QAAQd,IAE5BmiE,WAAY,CACV32D,SAAU,GAEZD,cAAe,CACblF,kBAAmBhD,EAAMvC,QAAQd,IAEnC0G,iBAAkB,CAChBnB,cAAe,MACfC,WAAY,SACZE,QAASrC,EAAMvC,QAAQZ,IAEzByG,YAAa,CACXoD,WAAY1G,EAAMvC,QAAQb,GAC1B8F,MAAO1C,EAAMC,OAAOhG,cACpBuI,SAAU,IAEZu8D,UAAW,CACTj9D,gBAAiB9B,EAAMC,OAAOnG,QAC9B6D,aAAcqC,EAAMrC,aAAad,GACjCwF,QAASrC,EAAMvC,QAAQb,GACvBuM,YAAanJ,EAAMvC,QAAQb,GAC3B0L,YAAa,EACbD,YAAarI,EAAMC,OAAO9F,OAC1B0hD,SAAU,KAEZmjB,kBAAmB,CACjBl9D,gBAAiB9B,EAAMC,OAAOzG,QAAU,KACxC6O,YAAarI,EAAMC,OAAOzG,SAE5BylE,kBAAmB,CACjBloD,QAAS,IAEXmoD,WAAY,CACV/8D,WAAY,cAEdg9D,UAAW,CACTj9D,cAAe,MACfC,WAAY,SACZ6B,aAAc,GAEhBo7D,QAAS,CACPj2D,YAAa,GAEf/b,QAAS,CACPoV,SAAU,GACVC,WAAY,MACZC,MAAO1C,EAAMC,OAAOjG,KACpB6H,KAAM,GAERw9D,gBAAiB,CACf38D,MAAO1C,EAAMC,OAAOzG,SAEtB8lE,gBAAiB,CACf58D,MAAO1C,EAAMC,OAAOhG,eAEtBslE,QAAS,CACP/8D,SAAU,GACVE,MAAO1C,EAAMC,OAAOhG,eAEtBulE,gBAAiB,CACf98D,MAAO1C,EAAMC,OAAOzG,QAAU,MAEhCimE,gBAAiB,CACf/8D,MAAO1C,EAAMC,OAAOhG,cAAgB,OAErC,EAEH,SA1N8D,SAAH7S,GAIpD,IAHLs4E,EAAWt4E,EAAXs4E,YACAnzC,EAAYnlC,EAAZmlC,aAAYozC,EAAAv4E,EACZw4E,QAAAA,OAAO,IAAAD,EAAG,GAAEA,EAEJ3/D,EAAUG,KAAVH,MACF0B,EAASyE,GAAUnG,GACzBzJ,GAAoCC,EAAAA,EAAAA,UAAsB,IAAGC,GAAAC,EAAAA,EAAAA,SAAAH,EAAA,GAAtDspE,EAAUppE,EAAA,GAAEqpE,EAAarpE,EAAA,GAChCI,GAAkCL,EAAAA,EAAAA,WAAS,GAAMM,GAAAJ,EAAAA,EAAAA,SAAAG,EAAA,GAA1CE,EAASD,EAAA,GAAEE,EAAYF,EAAA,IAE9BU,EAAAA,EAAAA,YAAU,WACRuoE,GACF,GAAG,IAEH,IAAMA,EAAc,eAAA/3E,GAAAhG,EAAAA,EAAAA,UAAG,YACrB,IACEgV,GAAa,GACb,IAAMnP,QAAiBkF,EAAQE,cAAc,GAC7C6yE,EAAcj4E,EAAS/D,KACzB,CAAE,MAAOnB,GACPjC,EAAOiC,MAAM,8BAA+BA,EAC9C,CAAC,QACCqU,GAAa,EACf,CACF,IAAC,kBAVmB,OAAAhP,EAAApF,MAAA,KAAAC,UAAA,KAsCdm9E,EAAiB,SAACC,GACtB,IAAMj/C,EAAO,IAAIt9B,KAAKu8E,GAChBnxD,EAAM,IAAIprB,KACVw8E,EAAah/D,KAAKqf,OAAOzR,EAAI+oD,UAAY72C,EAAK62C,WAAS,OAE7D,OAAmB,IAAfqI,EACK,QACiB,IAAfA,EACF,YACEA,EAAa,EACZA,EAAU,YAEbl/C,EAAKiyC,oBAEhB,EAEA,OAAIl8D,GAEA2O,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAO2B,iBAAiB/M,SAAA,EACnC4C,EAAAA,EAAAA,KAACgN,GAAAA,QAAiB,CAACxjB,KAAK,QAAQggB,MAAO1C,EAAMC,OAAOzG,WACpDN,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO4B,YAAYhN,SAAC,8BAKb,IAAtBupE,EAAW38E,OACN,MAIPwiB,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOE,UAAUtL,SAAA,EAC5B4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO3W,MAAMuL,SAAC,iBAC3B4C,EAAAA,EAAAA,KAACmI,GAAAA,QAAU,CACT8sB,YAAU,EACVC,gCAAgC,EAChCxoB,MAAOlE,EAAOo9D,WACdr+D,sBAAuBiB,EAAOwG,cAAc5R,SAE3CupE,EAAWpjD,KAAI,SAAClvB,GACf,IAAMirC,EAAajM,EAAahc,MAAK,SAAA4vD,GAAW,OAC9CA,EAAYv1E,KAAO2C,EAAI3C,IAAMu1E,EAAYlvE,KAAKu8B,gBAAkBjgC,EAAI0D,KAAKu8B,aAAa,IAElF4yC,EAAa7zC,EAAarpC,QAAU08E,IAAYpnC,EAEtD,OACEt/B,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CAEfF,MAAO,CACLlE,EAAOq9D,UACPvmC,GAAc92B,EAAOs9D,kBACrBoB,GAAc1+D,EAAOu9D,mBAEvBl5D,QAAS,WAAF,OA9EI,SAACxY,GAMtB,IAJmBg/B,EAAahc,MAAK,SAAA4vD,GAAW,OAC9CA,EAAYv1E,KAAO2C,EAAI3C,IAAMu1E,EAAYlvE,KAAKu8B,gBAAkBjgC,EAAI0D,KAAKu8B,aAAa,OAOpFjB,EAAarpC,QAAU08E,GAA3B,CAKA,IAAMS,EAAgB,CACpBz1E,GAAI2C,EAAI3C,GACRqG,KAAM1D,EAAI0D,KACVyR,MAAOnV,EAAImV,MACX/J,WAAYpL,EAAIoL,WAChBC,WAAYrL,EAAIqL,YAGlB8mE,EAAYW,EAXZ,CAYF,CAsD2BC,CAAe/yE,EAAI,EAClCkN,SAAU+9B,GAAc4nC,EACxBlnD,cAAe,GAAI5iB,UAEnBoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOw9D,WAAW5oE,SAAA,EAC7BoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOy9D,UAAU7oE,SAAA,EAC5B4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CACP/U,KAAK,WACLvO,KAAM,GACNggB,MAAOnV,EAAImV,OAAS1C,EAAMC,OAAOzG,QACjCoM,MAAOlE,EAAO09D,WAEhBlmE,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAO,CACXlE,EAAOtU,QACPorC,GAAc92B,EAAO29D,gBACrBe,GAAc1+D,EAAO49D,iBACrBhpE,SACC/I,EAAI0D,WAGTyU,EAAAA,EAAAA,MAACO,EAAAA,QAAI,CAACL,MAAO,CACXlE,EAAO69D,QACP/mC,GAAc92B,EAAO89D,gBACrBY,GAAc1+D,EAAO+9D,iBACrBnpE,SAAA,CACC0pE,EAAezyE,EAAIgzE,WAAW,WAAIhzE,EAAIizE,YAAY,eA/BlDjzE,EAAI3C,GAoCf,QAIR,E,+kBClJA,IAAM2rB,GAAkC,QAAhBt1B,EAAAA,QAASC,GAmQ3BilB,GAAY,SAACnG,GAAe,OAAK2B,EAAAA,QAAWxb,OAAO,CACvDyb,UAAW,CACToC,aAAchE,EAAMvC,QAAQZ,IAE9B4jE,eAAgB,CACd3sB,UAAW,GACX9vC,aAAchE,EAAMvC,QAAQZ,IAE9BukB,cAAe,CACblf,cAAe,MACfmf,SAAU,SACVlf,WAAY,SACZY,gBAAiB/C,EAAMvC,QAAQd,IAEjCpP,IAAK,CACH2U,cAAe,MACfC,WAAY,SACZL,gBAAiB9B,EAAMb,WAAaa,EAAMC,OAAOpE,QAAUmE,EAAMC,OAAOxG,aAAe,KACvFkE,aAAcqC,EAAMrC,aAAaC,KACjCoF,kBAAmBhD,EAAMvC,QAAQZ,GACjCkG,gBAAiB/C,EAAMvC,QAAQb,GAC/BuM,YAAanJ,EAAMvC,QAAQb,GAC3B0L,YAAa,EACbD,YAAarI,EAAMb,WAAaa,EAAMC,OAAOrE,QAAUoE,EAAMC,OAAOxG,aAAe,KACnF4M,UAAW,IAEbib,QAAS,CACP5e,MAAO1C,EAAMb,WAAaa,EAAMC,OAAOjG,KAAOgG,EAAMC,OAAOzG,QAC3DgJ,SAAUxC,EAAM7D,WAAWO,UAAUE,GACrCuM,YAAanJ,EAAMvC,QAAQb,GAC3B8G,WAAY1D,EAAM7D,WAAWC,aAAaE,OAC1CmG,WAAY,OAEdi+D,gBAAiB,CACfr+D,QAASrC,EAAMvC,QAAQd,GACvB+J,WAAY1G,EAAMvC,QAAQd,GAC1BgB,aAAcqC,EAAMrC,aAAaC,MAEnCoL,eAAgB,CACd9G,cAAe,MACfC,WAAY,SACZ6B,aAAchE,EAAMvC,QAAQb,IAE9BqM,aAAc,CACZpH,KAAM,EACNK,cAAe,MACfC,WAAY,SACZL,gBAAiB9B,EAAMC,OAAOvF,gBAC9B4N,YAAa,EACbD,YAAarI,EAAMC,OAAO9F,OAC1BwD,aAAcqC,EAAMrC,aAAab,GACjCkG,kBAAmBhD,EAAMvC,QAAQZ,GACjCwJ,UAAW,IAEb6C,UAAW,CACTC,YAAanJ,EAAMvC,QAAQb,IAE7BwM,MAAO,CACLvH,KAAM,EACNW,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC6F,MAAO1C,EAAMC,OAAOjG,KACpB0J,WAAY1D,EAAM7D,WAAWC,aAAaC,QAC1C0G,gBAAiB/C,EAAMvC,QAAQZ,IAEjCw5B,UAASzsC,GAAA,CACPoU,MAAO,GACPC,OAAQ,GACRN,aAAcqC,EAAMrC,aAAab,GACjCgF,gBAAiB9B,EAAMC,OAAOzG,QAC9B4I,eAAgB,SAChBD,WAAY,SACZuE,WAAY1G,EAAMvC,QAAQZ,IACvBmD,EAAMnC,QAAQjB,IAEnB2J,eAAgB,CACdzE,gBAAiB9B,EAAMC,OAAOxF,SAC9Bsc,QAAS,IAEX4pD,qBAAoB/2E,GAAA,CAClBkY,gBAAiB9B,EAAMC,OAAOlG,KAC9B4D,aAAcqC,EAAMrC,aAAad,GACjCwF,QAASrC,EAAMvC,QAAQZ,GACvBmH,aAAchE,EAAMvC,QAAQb,GAC5B0L,YAAa,EACbD,YAAarI,EAAMC,OAAO7F,aACvB4F,EAAMnC,QAAQjB,IAEnBgkE,iBAAkB,CAChBp+D,SAAUxC,EAAM7D,WAAWO,UAAUE,GACrC8F,MAAO1C,EAAMC,OAAOhG,cACpByJ,WAAY1D,EAAM7D,WAAWC,aAAaE,OAC1C0H,aAAchE,EAAMvC,QAAQb,IAE9BikE,mBAAoB,CAClB3+D,cAAe,OAEjB4+D,eAAgB,CACdh/D,gBAAiB9B,EAAMC,OAAOjF,OAAS,KACvC2C,aAAcqC,EAAMrC,aAAaC,KACjCoF,kBAAmBhD,EAAMvC,QAAQZ,GACjCkG,gBAAiB/C,EAAMvC,QAAQb,GAC/BuM,YAAanJ,EAAMvC,QAAQb,GAC3B0L,YAAa,EACbD,YAAarI,EAAMC,OAAOjF,OAAS,MAErC+lE,eAAgB,CACdv+D,SAAUxC,EAAM7D,WAAWO,UAAUE,GACrC8F,MAAO1C,EAAMC,OAAOjF,OACpB0I,WAAY1D,EAAM7D,WAAWC,aAAaE,QAE5C0kE,SAAU,CACRx+D,SAAUxC,EAAM7D,WAAWO,UAAUC,GACrC+F,MAAO1C,EAAMC,OAAOhG,cACpByJ,WAAY1D,EAAM7D,WAAWC,aAAaC,QAC1C8kB,WAAYnhB,EAAM7D,WAAWgB,YAAYE,OAAS2C,EAAM7D,WAAWO,UAAUC,IAE/EskE,iBAAkB,CAChB9+D,WAAY,WACZoB,UAAWvD,EAAMvC,QAAQd,IAE3BukE,YAAa,CACX1+D,SAAUxC,EAAM7D,WAAWO,UAAUC,GACrC+F,MAAO1C,EAAMC,OAAO/F,aACpBwJ,WAAY1D,EAAM7D,WAAWC,aAAaC,UAE3C,EAEH,SAxX0C,SAAHjV,GAMhC,IALL0E,EAAI1E,EAAJ0E,KACAq1E,EAAY/5E,EAAZ+5E,aAAYxB,EAAAv4E,EACZw4E,QAAAA,OAAO,IAAAD,EAAG,GAAEA,EAAA5gC,EAAA33C,EACZkkB,YAAAA,OAAW,IAAAyzB,EAAG,aAAYA,EAAAqiC,EAAAh6E,EAC1Bi6E,YAAAA,OAAW,IAAAD,EAAG,GAAEA,EAERphE,EAAUG,KAAVH,MACF0B,EAASyE,GAAUnG,GACzBzJ,GAAoCC,EAAAA,EAAAA,UAAS,IAAGC,GAAAC,EAAAA,EAAAA,SAAAH,EAAA,GAAzC+qE,EAAU7qE,EAAA,GAAE8qE,EAAa9qE,EAAA,GAChCI,GAA8CL,EAAAA,EAAAA,WAAS,GAAMM,GAAAJ,EAAAA,EAAAA,SAAAG,EAAA,GAAtD2qE,EAAe1qE,EAAA,GAAE2qE,EAAkB3qE,EAAA,GAC1CG,GAAsDT,EAAAA,EAAAA,UAAmB,IAAGU,GAAAR,EAAAA,EAAAA,SAAAO,EAAA,GAArEyqE,EAAmBxqE,EAAA,GAAEyqE,EAAsBzqE,EAAA,GAC5C0qE,GAAWrqD,EAAAA,EAAAA,QAAkB,MAC7BsqD,GAAWtqD,EAAAA,EAAAA,QAAO,IAAIC,GAAAA,QAASC,MAAM,IAAIC,QAGzCoqD,GAAsB/6C,EAAAA,EAAAA,UAAQ,kBAAMs6C,CAAW,GAAE,CAACA,KAGxD7pE,EAAAA,EAAAA,YAAU,WACR,GAAI8pE,EAAW55D,OAAQ,CACrB,IAAMq6D,EAAkBj2E,EAAK2wB,KAAI,SAAAlvB,GAAG,OAAIA,EAAI0D,KAAKu8B,aAAa,IACxDw0C,EAAWF,EAAoBhvE,QACnC,SAAAmvE,GAAU,OACRA,EAAWz0C,cAAc/pC,SAAS69E,EAAW9zC,iBAC5Cu0C,EAAgBt+E,SAASw+E,EAAWz0C,cAAc,IAEvDm0C,EAAuBK,GACvBP,EAAmBO,EAAS9+E,OAAS,GAGjC8+E,EAAS9+E,OAAS,GACpBs0B,GAAAA,QAASQ,OAAO6pD,EAAU,CACxB5pD,QAAS,EACT3Z,SAAU,IACViY,gBAAAA,KACC2B,OAEP,MACEupD,GAAmB,GACnBjqD,GAAAA,QAASQ,OAAO6pD,EAAU,CACxB5pD,QAAS,EACT3Z,SAAU,IACViY,gBAAAA,KACC2B,OAEP,GAAG,CAACopD,EAAYQ,IAEhB,IAAMI,EAAe,SAAC90E,GACpB,IAAM+0E,GAAc/0E,GAAWk0E,GAAY55D,OAAO8lB,cAElD,GAAK20C,EAAL,CAMA,GADwBr2E,EAAK2wB,KAAI,SAAAlvB,GAAG,OAAIA,EAAI0D,KAAKu8B,aAAa,IAC1C/pC,SAAS0+E,IAAer2E,EAAK5I,QAAU08E,EAGzD,OAFA2B,EAAc,SACdE,GAAmB,GAIrB,IAAMzhB,EAAc,CAAE/uD,KAAMkxE,EAAYv3E,GAAI,MAC5Cu2E,EAAa,GAAD7yC,QAAApS,EAAAA,GAAAA,SAAKpwB,GAAI,CAAEk0D,KACvBuhB,EAAc,IACdE,GAAmB,GAGnBrhD,YAAW,WAAO,IAADgiD,EACC,OAAhBA,EAAAR,EAASlqD,UAAT0qD,EAAkBC,OACpB,GAAG,IAlBH,CAmBF,EAEMC,EAAkB,SAACC,GACvB,IAAMC,EAAc12E,EAAKgH,QAAO,SAACu3B,EAAGzH,GAAK,OAAKA,IAAU2/C,CAAa,IACrEpB,EAAaqB,EACf,EA+BA,OACE98D,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOE,UAAWyV,OAAO,sBAAqB/gB,SAAA,EAEzD4C,EAAAA,EAAAA,KAACupE,GAAkB,CACjB/C,YAAa,SAACnyE,GAEZ,IAAMyyD,EAAc,CAClB/uD,KAAM1D,EAAI0D,KACVrG,GAAI2C,EAAI3C,GACR8X,MAAOnV,EAAImV,MACX/J,WAAYpL,EAAIoL,WAChBC,WAAYrL,EAAIqL,YAElBuoE,EAAa,GAAD7yC,QAAApS,EAAAA,GAAAA,SAAKpwB,GAAI,CAAEk0D,IACzB,EACAzzB,aAAczgC,EACd8zE,QAASA,IAIV9zE,EAAK5I,OAAS,IACbgW,EAAAA,EAAAA,KAACmI,GAAAA,QAAU,CACT8sB,YAAU,EACVC,gCAAgC,EAChCxoB,MAAOlE,EAAO++D,eACdhgE,sBAAuBiB,EAAO0f,cAC9B/J,OAAO,mBACP9V,0BAA0B,UAASjL,SAElCxK,EAAK2wB,KAAI,SAAClvB,EAAKq1B,GAAK,OACnBld,EAAAA,EAAAA,MAAC8R,GAAAA,QAAS3R,KAAI,CAEZD,MAAOlE,EAAOnU,IACd8pB,OAAM,YAAc9pB,EAAI0D,KAAI,IAAI2xB,EAAQtsB,SAAA,EAExCoP,EAAAA,EAAAA,MAACO,EAAAA,QAAI,CAACL,MAAOlE,EAAO4f,QAASjK,OAAM,YAAc9pB,EAAI0D,KAAOqF,SAAA,CAAC,IACzD/I,EAAI0D,SAERiI,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CACfF,MAAOlE,EAAOg/D,gBACd36D,QAAS,WAAF,OAAQu8D,EAAgB1/C,EAAM,EACrCvL,OAAM,qBAAuB9pB,EAAI0D,KAAI,IAAI2xB,EACzC+Z,mBAAkB,cAAgBpvC,EAAI0D,KACtCu3D,QAAS,CAAE5M,IAAK,EAAGl6B,OAAQ,EAAGC,KAAM,EAAGC,MAAO,GAAItrB,UAElD4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,eAAevO,KAAM,GAAIggB,MAAO1C,EAAMC,OAAOhG,oBAdzD1M,EAAI3C,GAAE,OAAU2C,EAAI3C,GAAE,OAAY2C,EAAI0D,KAAI,IAAI2xB,EAgBrC,OAMtBld,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOsH,eAAgBqO,OAAO,4BAA2B/gB,SAAA,EACpEoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOuH,aAAa3S,SAAA,EAC/B4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CACP/U,KAAK,mBACLvO,KAAM,GACNggB,MAAO1C,EAAMC,OAAOhG,cACpB2L,MAAOlE,EAAOwH,aAEhBhQ,EAAAA,EAAAA,KAACmS,GAAAA,QAAS,CACR/K,IAAKshE,EACLh8D,MAAOlE,EAAO0H,MACdtnB,MAAOw/E,EACP/1D,aAAcg2D,EACdmB,gBAAiB,WAAF,OAAQR,GAAc,EACrCS,WAhGa,SAACxqE,GACtB,IAAMtW,EAAMsW,EAAE81B,YAAYpsC,IAEd,UAARA,GAA2B,MAARA,GAAuB,MAARA,GACpB,MAAhBsW,EAAEyqE,gBAAFzqE,EAAEyqE,iBACFV,KACiB,cAARrgF,IAAwBy/E,GAAcx1E,EAAK5I,OAAS,GAE7Do/E,EAAgBx2E,EAAK5I,OAAS,EAElC,EAuFU2/E,QAjFe,WACnBvB,EAAW55D,QAAUg6D,EAAoBx+E,OAAS,GACpDu+E,GAAmB,EAEvB,EA8EUqB,OA5Ec,WAEtB1iD,YAAW,WACTqhD,GAAmB,EACrB,GAAG,IACL,EAwEUn2D,YAAaxf,EAAK5I,QAAU08E,EAAO,WAAcA,EAAO,QAAUt0D,EAClEK,qBAAsB3L,EAAMC,OAAOhG,cACnC27C,cAAc,OACdv+B,OAAO,kBACPwiC,SAAU/tD,EAAK5I,OAAS08E,EACxBl0D,aAAa,EACbD,eAAe,aAGnBvS,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CACfF,MAAO,CACLlE,EAAO20B,YACLirC,EAAW55D,QAAU5b,EAAK5I,QAAU08E,IAAYl+D,EAAO6E,gBAE3DR,QAAS,WAAF,OAAQm8D,GAAc,EAC7BznE,UAAW6mE,EAAW55D,QAAU5b,EAAK5I,QAAU08E,EAC/CvoD,OAAO,iBACPslB,mBAAmB,UACnB6rB,QAAS,CAAE5M,IAAK,EAAGl6B,OAAQ,EAAGC,KAAM,EAAGC,MAAO,GAAItrB,UAElD4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CACP/U,KAAK,MACLvO,KAAM,GACNggB,MAAO1C,EAAMC,OAAOpF,iBAMzB2mE,IACC97D,EAAAA,EAAAA,MAAC8R,GAAAA,QAAS3R,KAAI,CACZD,MAAO,CAAClE,EAAOi/D,qBAAsB,CAAE5pD,QAAS8qD,IAChDxqD,OAAO,wBAAuB/gB,SAAA,EAE9B4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOk/D,iBAAiBtqE,SAAC,kBACtC4C,EAAAA,EAAAA,KAACmI,GAAAA,QAAU,CACT8sB,YAAU,EACVC,gCAAgC,EAChC3tB,sBAAuBiB,EAAOm/D,mBAAmBvqE,SAEhDorE,EAAoBjlD,KAAI,SAACwlD,EAAYr/C,GAAK,OACzC1pB,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CAEfF,MAAOlE,EAAOo/D,eACd/6D,QAAS,WAAF,OAnIS,SAACk8D,GAC7BC,EAAaD,EACf,CAiI6Bc,CAAsBd,EAAW,EAChD5qD,OAAM,cAAgB4qD,EAAa3rE,UAEnCoP,EAAAA,EAAAA,MAACO,EAAAA,QAAI,CAACL,MAAOlE,EAAOq/D,eAAezqE,SAAA,CAAC,IAAE2rE,MAAkB,cALrCr/C,EAMF,SAO1B92B,EAAK5I,OAAS08E,GAAiC,IAAtB0B,EAAWp+E,SAAiBs+E,IACpDtoE,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOs/D,SAAU3pD,OAAO,sBAAqB/gB,SAAC,6EAM7D4C,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAOu/D,iBAAiB3qE,UACnCoP,EAAAA,EAAAA,MAACO,EAAAA,QAAI,CAACL,MAAOlE,EAAOw/D,YAAY5qE,SAAA,CAC7BxK,EAAK5I,OAAO,IAAE08E,EAAQ,eAKjC,E,+kBCxPA,IAAA5qC,GAAuDpK,GAAAA,QAAWlgC,IAAI,UA2hBhEyb,IA3hBqB6uB,GAAnBh3B,MAA0Cg3B,GAArB/2B,OA2hBX,SAAC+B,GAAe,OAAK2B,EAAAA,QAAWxb,OAAO,CACvDyb,UAAW,CACTC,KAAM,EACNC,gBAAiB9B,EAAMC,OAAOpG,YAEhCwJ,iBAAkB,CAChBxB,KAAM,EACNC,gBAAiB9B,EAAMC,OAAOpG,YAEhCmpE,eAAgB,CACdnhE,KAAM,EACNO,eAAgB,SAChBD,WAAY,SACZa,kBAAmBhD,EAAMvC,QAAQV,IAEnCuG,YAAa,CACXd,SAAUxC,EAAM7D,WAAWO,UAAUI,GACrC4F,MAAO1C,EAAMC,OAAOhG,cACpBsJ,UAAWvD,EAAMvC,QAAQX,GACzB4G,WAAY1D,EAAM7D,WAAWC,aAAaE,QAE5CwM,eAAgB,CACdjH,KAAM,EACNC,gBAAiB9B,EAAMC,OAAOpG,YAEhCopE,aAAc,CACZphE,KAAM,EACNO,eAAgB,SAChBD,WAAY,SACZa,kBAAmBhD,EAAMvC,QAAQV,IAEnCmmE,WAAY,CACV1gE,SAAUxC,EAAM7D,WAAWO,UAAUM,IACrCyF,WAAY,OACZC,MAAO1C,EAAMC,OAAOjG,KACpBuJ,UAAWvD,EAAMvC,QAAQX,GACzBkH,aAAchE,EAAMvC,QAAQZ,GAC5B6G,WAAY1D,EAAM7D,WAAWC,aAAaI,MAE5CuM,UAAW,CACTvG,SAAUxC,EAAM7D,WAAWO,UAAUI,GACrC4F,MAAO1C,EAAMC,OAAOhG,cACpBgK,UAAW,SACXD,aAAchE,EAAMvC,QAAQV,GAC5BokB,WAAYnhB,EAAM7D,WAAWgB,YAAYE,OAAS2C,EAAM7D,WAAWO,UAAUI,GAC7E4G,WAAY1D,EAAM7D,WAAWC,aAAaC,SAE5C8mE,YAAWv5E,GAAA,CACTsY,cAAe,MACfC,WAAY,SACZL,gBAAiB9B,EAAMC,OAAOzG,QAC9BuJ,gBAAiB/C,EAAMvC,QAAQX,GAC/BkG,kBAAmBhD,EAAMvC,QAAQV,GACjCY,aAAcqC,EAAMrC,aAAaZ,IAC9BiD,EAAMnC,QAAQhB,IAEnBumE,gBAAiB,CACf1gE,MAAO1C,EAAMC,OAAO5E,MACpBmH,SAAUxC,EAAM7D,WAAWO,UAAUI,GACrC2F,WAAY,MACZiE,WAAY1G,EAAMvC,QAAQb,GAC1B8G,WAAY1D,EAAM7D,WAAWC,aAAaG,UAE5C8mE,eAAcz5E,GAAAA,GAAA,CACZ+sB,SAAU,WACVilC,IAAqB,QAAhB36D,EAAAA,QAASC,GAAe,GAAK,EAClCygC,KAAM,EACNC,MAAO,EACP3jB,OAAQ,GACR6D,gBAAiB9B,EAAMC,OAAOlG,KAC9BmI,cAAe,MACfC,WAAY,SACZC,eAAgB,gBAChBY,kBAAmBhD,EAAMvC,QAAQX,GACjC+uB,OAAQ,KACL7rB,EAAMnC,QAAQf,IAAE,IACnBwF,kBAAmB,EACnBC,kBAAmBvC,EAAMC,OAAO9F,SAElCmpE,iBAAgB15E,GAAA,CACdoU,MAAO,GACPC,OAAQ,GACRN,aAAc,GACdmE,gBAAiB9B,EAAMC,OAAOpG,WAC9BuI,eAAgB,SAChBD,WAAY,UACTnC,EAAMnC,QAAQjB,IAEnB2mE,oBAAqB,CACnB1hE,KAAM,EACNW,SAAUxC,EAAM7D,WAAWO,UAAUI,GACrC2F,WAAY,MACZC,MAAO1C,EAAMC,OAAOjG,KACpBiK,UAAW,SACXhB,iBAAkBjD,EAAMvC,QAAQZ,GAChC6G,WAAY1D,EAAM7D,WAAWC,aAAaG,UAE5C6jC,aAAc,CACZpiC,MAAO,IAETwlE,WAAY,CACVthE,cAAe,MACfC,WAAY,SACZC,eAAgB,gBAChBY,kBAAmBhD,EAAMvC,QAAQX,GACjCiF,WAA4B,QAAhB9gB,EAAAA,QAASC,GAAe,GAAK8e,EAAMvC,QAAQX,GACvDmE,cAAejB,EAAMvC,QAAQX,GAC7BgF,gBAAiB9B,EAAMC,OAAOpG,YAEhCqS,WAAUtiB,GAAA,CACRoU,MAAO,GACPC,OAAQ,GACRN,aAAc,GACdmE,gBAAiB9B,EAAMC,OAAOlG,KAC9BqI,eAAgB,SAChBD,WAAY,UACTnC,EAAMnC,QAAQhB,IAEnB4mE,cAAe,CACbvhE,cAAe,MACf8iB,IAAKhlB,EAAMvC,QAAQZ,IAErB6mE,mBAAkB95E,GAAA,CAChBoU,MAAO,GACPC,OAAQ,GACRN,aAAc,GACdmE,gBAAiB9B,EAAMC,OAAOlG,KAC9BqI,eAAgB,SAChBD,WAAY,UACTnC,EAAMnC,QAAQhB,IAEnB8mE,mBAAoB,CAClB7hE,gBAAiB9B,EAAMC,OAAO3F,WAAa,MAE7CwkE,WAAY,CACVj9D,KAAM,GAER7W,QAAS,CACPgY,kBAAmBhD,EAAMvC,QAAQX,GACjCmE,cAAe,KAEjB2iE,YAAWh6E,GAAAA,GAAA,CACTkY,gBAAiB9B,EAAMC,OAAOlG,KAC9B4D,aAAcqC,EAAMrC,aAAaX,IACjCqF,QAASrC,EAAMvC,QAAQV,GACvBiH,aAAchE,EAAMvC,QAAQV,GAC5BmF,cAAe,MACfE,eAAgB,gBAChBD,WAAY,cACTnC,EAAMnC,QAAQf,IAAE,IACnBwL,YAAatI,EAAMb,WAAa,EAAI,EACpCkJ,YAAarI,EAAMC,OAAO9F,SAE5B4mB,cAAe,CACblf,KAAM,GAERgiE,SAAU,CACRrhE,SAAUxC,EAAM7D,WAAWO,UAAUO,KACrCwF,WAAY,OACZC,MAAO1C,EAAMC,OAAOjG,KACpBgK,aAAchE,EAAMvC,QAAQd,GAC5B+G,WAAY1D,EAAM7D,WAAWC,aAAaI,KAC1Ce,eAAgB,GAElBumE,aAAc,CACZthE,SAAUxC,EAAM7D,WAAWO,UAAUI,GACrC4F,MAAO1C,EAAMC,OAAOhG,cACpB+J,aAAchE,EAAMvC,QAAQb,GAC5B8G,WAAY1D,EAAM7D,WAAWC,aAAaE,QAE5CynE,cAAe,CACb7hE,cAAe,MACfC,WAAY,SACZL,gBAAiB9B,EAAMC,OAAOxG,aAAe,KAC7CuJ,kBAAmBhD,EAAMvC,QAAQZ,GACjCkG,gBAAiB/C,EAAMvC,QAAQb,GAC/Be,aAAcqC,EAAMrC,aAAaC,KACjCsM,UAAW,cAEbs2B,SAAU,CACRh+B,SAAUxC,EAAM7D,WAAWO,UAAUE,GACrC8F,MAAO1C,EAAMC,OAAOzG,QACpBiJ,WAAY,MACZiE,WAAY1G,EAAMvC,QAAQd,GAC1B+G,WAAY1D,EAAM7D,WAAWC,aAAaG,UAE5C2kB,eAAgB,CACd/e,WAAY,SACZL,gBAAiB9B,EAAMC,OAAOhF,YAAc,KAC5C+H,kBAAmBhD,EAAMvC,QAAQX,GACjCiG,gBAAiB/C,EAAMvC,QAAQZ,GAC/Bc,aAAcqC,EAAMrC,aAAaZ,GACjCuL,YAAa,EACbD,YAAarI,EAAMC,OAAOjF,OAAS,MAErCgpE,UAAW,CACTxhE,SAAUxC,EAAM7D,WAAWO,UAAUC,GACrC+F,MAAO1C,EAAMC,OAAOjF,OACpByH,WAAY,MACZc,UAAWvD,EAAMvC,QAAQd,GACzB+G,WAAY1D,EAAM7D,WAAWC,aAAaG,UAE5C0nE,aAAYr6E,GAAAA,GAAA,CACVkY,gBAAiB9B,EAAMC,OAAOlG,KAC9B4D,aAAcqC,EAAMrC,aAAaX,IACjCqF,QAASrC,EAAMvC,QAAQV,GACvBiH,aAAchE,EAAMvC,QAAQV,IACzBiD,EAAMnC,QAAQhB,IAAE,IACnByL,YAAatI,EAAMb,WAAa,EAAI,EACpCkJ,YAAarI,EAAMC,OAAO9F,SAE5B+pE,YAAa,CACXhiE,cAAe,MACfC,WAAY,SACZ6B,aAAchE,EAAMvC,QAAQX,GAC5BmE,cAAejB,EAAMvC,QAAQZ,GAC7ByF,kBAAmB,EACnBC,kBAAmBvC,EAAMC,OAAO9F,QAElCgqE,gBAAiB,CACf3hE,SAAUxC,EAAM7D,WAAWO,UAAUI,GACrC2F,WAAY,MACZC,MAAO1C,EAAMC,OAAOjG,KACpB0M,WAAY1G,EAAMvC,QAAQb,GAC1B8G,WAAY1D,EAAM7D,WAAWC,aAAaG,UAE5C6nE,WAAY,CACV5hE,SAAUxC,EAAM7D,WAAWO,UAAUM,IACrCyF,WAAY,OACZC,MAAO1C,EAAMC,OAAOjG,KACpBmnB,WAAYnhB,EAAM7D,WAAWgB,YAAYC,MAAQ4C,EAAM7D,WAAWO,UAAUM,IAC5E0G,WAAY1D,EAAM7D,WAAWC,aAAaI,KAC1Ce,eAAgB,GAChByG,aAAchE,EAAMvC,QAAQX,IAE9BunE,UAAW,CACT7hE,SAAUxC,EAAM7D,WAAWO,UAAUI,GACrCqkB,WAAYnhB,EAAM7D,WAAWgB,YAAYG,MAAQ0C,EAAM7D,WAAWO,UAAUI,GAC5E4F,MAAO1C,EAAMC,OAAOjG,KACpB0J,WAAY1D,EAAM7D,WAAWC,aAAaC,QAC1CkB,cAAe,IAEjB+mE,YAAW16E,GAAAA,GAAA,CACTkY,gBAAiB9B,EAAMC,OAAOlG,KAC9B4D,aAAcqC,EAAMrC,aAAaX,IACjCqF,QAASrC,EAAMvC,QAAQV,GACvBiH,aAAchE,EAAMvC,QAAQV,IACzBiD,EAAMnC,QAAQhB,IAAE,IACnByL,YAAatI,EAAMb,WAAa,EAAI,EACpCkJ,YAAarI,EAAMC,OAAO9F,SAE5BoqE,WAAY,CACVriE,cAAe,MACfC,WAAY,SACZ6B,aAAchE,EAAMvC,QAAQX,GAC5BmE,cAAejB,EAAMvC,QAAQZ,GAC7ByF,kBAAmB,EACnBC,kBAAmBvC,EAAMC,OAAO9F,QAElCqqE,eAAgB,CACdhiE,SAAUxC,EAAM7D,WAAWO,UAAUI,GACrC2F,WAAY,MACZC,MAAO1C,EAAMC,OAAOjG,KACpB0M,WAAY1G,EAAMvC,QAAQb,GAC1BiF,KAAM,EACN6B,WAAY1D,EAAM7D,WAAWC,aAAaG,UAE5CkoE,SAAU,CACR3iE,gBAAiB9B,EAAMC,OAAOzG,QAC9BwE,MAAO,GACPC,OAAQ,GACRN,aAAc,GACdyE,eAAgB,SAChBD,WAAY,UAEduiE,aAAc,CACZliE,SAAUxC,EAAM7D,WAAWO,UAAUC,GACrC+F,MAAO1C,EAAMC,OAAO5E,MACpBoH,WAAY,OACZiB,WAAY1D,EAAM7D,WAAWC,aAAaI,MAE5CmoE,SAAU,CACRziE,cAAe,MACfmf,SAAU,OACV2D,IAAKhlB,EAAMvC,QAAQb,IAErBrP,IAAG3D,GAAA,CACDkY,gBAAiB9B,EAAMC,OAAOxG,aAAe,KAC7CuJ,kBAAmBhD,EAAMvC,QAAQX,GACjCiG,gBAAiB/C,EAAMvC,QAAQZ,GAC/Bc,aAAcqC,EAAMrC,aAAaC,KACjC0K,YAAa,EACbD,YAAarI,EAAMC,OAAOzG,QAAU,MACjCwG,EAAMnC,QAAQjB,IAEnB0kB,QAAS,CACP9e,SAAUxC,EAAM7D,WAAWO,UAAUE,GACrC8F,MAAO1C,EAAMC,OAAOzG,QACpBiJ,WAAY,MACZiB,WAAY1D,EAAM7D,WAAWC,aAAaG,SAC1CgB,cAAe,IAEjBqnE,aAAYh7E,GAAAA,GAAA,CACVkY,gBAAiB9B,EAAMC,OAAOlG,KAC9B4D,aAAcqC,EAAMrC,aAAaX,IACjCqF,QAASrC,EAAMvC,QAAQV,GACvBiH,aAAchE,EAAMvC,QAAQV,IACzBiD,EAAMnC,QAAQhB,IAAE,IACnByL,YAAatI,EAAMb,WAAa,EAAI,EACpCkJ,YAAarI,EAAMC,OAAO9F,SAE5B0qE,WAAY,CACVriE,SAAUxC,EAAM7D,WAAWO,UAAUI,GACrC2F,WAAY,MACZC,MAAO1C,EAAMC,OAAOjG,KACpBgK,aAAchE,EAAMvC,QAAQX,GAC5B4G,WAAY1D,EAAM7D,WAAWC,aAAaG,UAE5CuoE,UAAW,CACT5iE,cAAe,MACfE,eAAgB,gBAElB2iE,SAAU,CACR5iE,WAAY,SACZN,KAAM,GAERujB,UAAW,CACT5iB,SAAUxC,EAAM7D,WAAWO,UAAUM,IACrCyF,WAAY,OACZC,MAAO1C,EAAMC,OAAOjG,KACpBuJ,UAAWvD,EAAMvC,QAAQb,GACzBoH,aAAchE,EAAMvC,QAAQd,GAC5B+G,WAAY1D,EAAM7D,WAAWC,aAAaI,MAE5C+oB,UAAW,CACT/iB,SAAUxC,EAAM7D,WAAWO,UAAUE,GACrC8F,MAAO1C,EAAMC,OAAOhG,cACpByJ,WAAY1D,EAAM7D,WAAWC,aAAaE,QAE5C0oE,gBAAiB,CACfruD,SAAU,WACV+K,OAAwB,QAAhBzgC,EAAAA,QAASC,GAAe,IAAM,GACtC0gC,MAAO5hB,EAAMvC,QAAQX,GACrBoF,cAAe,SACf8iB,IAAKhlB,EAAMvC,QAAQZ,IAErB42D,IAAG7pE,GAAAA,GAAA,CACDoU,MAAO,GACPC,OAAQ,GACRN,aAAc,GACdyE,eAAgB,SAChBD,WAAY,UACTnC,EAAMnC,QAAQd,IAAE,IACnBqB,UAAW,IAEb6mE,QAAS,CACPnjE,gBAAiB9B,EAAMC,OAAOzG,SAEhC0rE,UAAW,CACTpjE,gBAAiB9B,EAAMC,OAAOtd,OAGhCwiF,kBAAmB,CACjBz+D,WAAY,OACZrE,QAASrC,EAAMvC,QAAQb,GACvBe,aAAcqC,EAAMrC,aAAad,GACjCiF,gBAAiB9B,EAAMC,OAAOxG,aAAe,KAC7C+I,SAAUxC,EAAM7D,WAAWO,UAAUE,GACrC6F,WAAY,MACZC,MAAO1C,EAAMC,OAAOzG,QACpBkK,WAAY1D,EAAM7D,WAAWC,aAAaG,UAE5C6oE,aAAc,CACZphE,aAAchE,EAAMvC,QAAQX,IAE9BuoE,WAAY,CACV7iE,SAAUxC,EAAM7D,WAAWO,UAAUI,GACrC2F,WAAY,MACZC,MAAO1C,EAAMC,OAAOjG,KACpB0J,WAAY1D,EAAM7D,WAAWC,aAAaG,SAC1CuF,gBAAiB9B,EAAMC,OAAOvF,gBAC9BiD,aAAcqC,EAAMrC,aAAab,GACjCuF,QAASrC,EAAMvC,QAAQX,GACvBwL,YAAa,EACbD,YAAarI,EAAMC,OAAO9F,OAC1BkM,UAAW,IAEbi/D,eAAgB,CACdthE,aAAchE,EAAMvC,QAAQX,IAE9ByoE,aAAc,CACZ/iE,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC6F,MAAO1C,EAAMC,OAAOjG,KACpB0J,WAAY1D,EAAM7D,WAAWC,aAAaC,QAC1CyF,gBAAiB9B,EAAMC,OAAOvF,gBAC9BiD,aAAcqC,EAAMrC,aAAab,GACjCuF,QAASrC,EAAMvC,QAAQX,GACvBwL,YAAa,EACbD,YAAarI,EAAMC,OAAO9F,OAC1BkM,UAAW,IACX8a,WAAYnhB,EAAM7D,WAAWgB,YAAYG,MAAQ0C,EAAM7D,WAAWO,UAAUG,IAE9E2oE,cAAe,CACbrjE,WAAY,UAEdsjE,aAAY77E,GAAA,CACVsY,cAAe,MACfC,WAAY,SACZL,gBAAiB9B,EAAMC,OAAOzG,QAC9BuJ,gBAAiB/C,EAAMvC,QAAQX,GAC/BkG,kBAAmBhD,EAAMvC,QAAQV,GACjCY,aAAcqC,EAAMrC,aAAaC,MAC9BoC,EAAMnC,QAAQhB,IAEnB6oE,iBAAkB,CAChBhjE,MAAO1C,EAAMC,OAAO5E,MACpBmH,SAAUxC,EAAM7D,WAAWO,UAAUI,GACrC2F,WAAY,MACZiE,WAAY1G,EAAMvC,QAAQb,GAC1B8G,WAAY1D,EAAM7D,WAAWC,aAAaG,WAE3C,GAEH,SA17BiC,WAAO,IAADuqD,EAAA6e,EAC/Bv7D,GAAaC,EAAAA,GAAAA,iBACbk4B,GAAQujB,EAAAA,GAAAA,YACN9lD,EAAUG,KAAVH,MACF0B,EAASyE,GAAUnG,GACjBopB,EAAYmZ,EAAM93C,OAAlB2+B,QAER7yB,GAA0BC,EAAAA,EAAAA,UAA8B,MAAKC,GAAAC,EAAAA,EAAAA,SAAAH,EAAA,GAAtDwrB,EAAKtrB,EAAA,GAAEmvE,EAAQnvE,EAAA,GACtBI,GAAkCL,EAAAA,EAAAA,WAAS,GAAKM,GAAAJ,EAAAA,EAAAA,SAAAG,EAAA,GAAzCE,EAASD,EAAA,GAAEE,EAAYF,EAAA,GAG9BG,GAAoCT,EAAAA,EAAAA,WAAS,GAAMU,GAAAR,EAAAA,EAAAA,SAAAO,EAAA,GAA5C4uE,EAAU3uE,EAAA,GAAE4uE,EAAa5uE,EAAA,GAChCG,GAAkCb,EAAAA,EAAAA,UAAS,IAAGc,GAAAZ,EAAAA,EAAAA,SAAAW,EAAA,GAAvC0uE,EAASzuE,EAAA,GAAE0uE,EAAY1uE,EAAA,GAC9BoT,GAAsClU,EAAAA,EAAAA,UAAS,IAAGmU,GAAAjU,EAAAA,EAAAA,SAAAgU,EAAA,GAA3Cu7D,EAAWt7D,EAAA,GAAEu7D,EAAcv7D,EAAA,GAClCE,GAAgCrU,EAAAA,EAAAA,UAAgB,IAAGsU,GAAApU,EAAAA,EAAAA,SAAAmU,EAAA,GAA5Cs7D,EAAQr7D,EAAA,GAAEs7D,EAAWt7D,EAAA,GAC5BsC,GAAgC5W,EAAAA,EAAAA,WAAS,GAAM6W,GAAA3W,EAAAA,EAAAA,SAAA0W,EAAA,GAAxCisC,EAAQhsC,EAAA,GAAE02C,EAAW12C,EAAA,GAGtBw0D,GAAWtqD,EAAAA,EAAAA,QAAO,IAAIC,GAAAA,QAASC,MAAM,IAAIC,QACzC2uD,GAAY9uD,EAAAA,EAAAA,QAAO,IAAIC,GAAAA,QAASC,MAAM,KAAKC,QAC3CJ,GAAYC,EAAAA,EAAAA,QAAO,IAAIC,GAAAA,QAASC,MAAM,MAAOC,QAC7C4uD,GAAU/uD,EAAAA,EAAAA,QAAO,IAAIC,GAAAA,QAASC,MAAM,IAAIC,QAGxC6uD,GAAgBhvD,EAAAA,EAAAA,QAAkB,MAClCivD,GAAkBjvD,EAAAA,EAAAA,QAAkB,MAGpCkvD,EAAgBH,EAAQjuD,YAAY,CACxCC,WAAY,CAAC,EAAG,KAChBC,YAAa,CAAC,EAAG,GACjBmuD,YAAa,UAGTC,EAAcL,EAAQjuD,YAAY,CACtCC,WAAY,CAAC,EAAG,KAChBC,YAAa,CAAC,GAAK,GACnBmuD,YAAa,WAGfx/C,EAAAA,GAAAA,iBACE/H,EAAAA,EAAAA,cAAY,WAGV,OAFAynD,IAEO,WAEL/E,EAAS5yB,SAAS,GAClBo3B,EAAUp3B,SAAS,IACnB33B,EAAU23B,SAAS,IACrB,CACF,GAAG,CAAC7lB,MAGN5xB,EAAAA,EAAAA,YAAU,WACJuqB,GAEFvK,GAAAA,QAASqB,SAAS,CAChBrB,GAAAA,QAASQ,OAAO6pD,EAAU,CACxB5pD,QAAS,EACT3Z,SAAU,IACViY,iBAAiB,IAEnBiB,GAAAA,QAASsB,OAAOutD,EAAW,CACzBpuD,QAAS,EACTe,QAAS,GACTC,SAAU,EACV1C,iBAAiB,IAEnBiB,GAAAA,QAASsB,OAAOxB,EAAW,CACzBW,QAAS,EACTe,QAAS,GACTC,SAAU,EACV1C,iBAAiB,MAElB2B,OAEP,GAAG,CAAC6J,IAEJ,IAAM6kD,EAAiB,eAAAx/E,GAAApF,EAAAA,EAAAA,UAAG,YACxB,IACEgV,GAAa,GACb,IACMqqD,SADiB92D,EAAWI,SAASsnB,OAAOmX,KACvBtlC,KAC3B8hF,EAASvkB,GAGT2kB,EAAa3kB,EAAUt2D,OAAS,IAChCm7E,EAAe7kB,EAAUr2D,SAAW,IACpCo7E,EAAY/kB,EAAUv1D,MAAQ,GAChC,CAAE,MAAOnJ,GACPV,QAAQU,MAAM,+BAAgCA,GAC9CslC,GAAAA,QAAMC,MAAM,QAAS,uCACvB,CAAC,QACClxB,GAAa,EACf,CACF,IAAC,kBAjBsB,OAAA5P,EAAAxE,MAAA,KAAAC,UAAA,KAmBjBgkF,EAAmB,WACvBjuD,GAAcnc,QACdqpE,GAAeD,EACjB,EAEMiB,EAAiB,eAAA9+E,GAAAhG,EAAAA,EAAAA,UAAG,YACxB,GAAK+/B,EAKL,IACEgiC,GAAY,GACZnrC,GAAcnc,QAEd,IAAMsqE,EAAa,CACjBh8E,MAAOg7E,EACP/6E,QAASi7E,EACTn6E,KAAMq6E,EAAS1pD,KAAI,SAAAlvB,GAAG,OAAIA,EAAI0D,IAAI,WAGb1G,EAAW0B,YAAYgmB,OAAOmX,GAAU29C,GAC/D9kF,QAAQC,IAAI,4BAGZ,IAAM8kF,EAAYp9E,GAAAA,GAAA,GACbm4B,GAAK,IACRh3B,MAAOg7E,EACP/6E,QAASi7E,EACTn6E,KAAMq6E,IAERP,EAASoB,GACTlB,GAAc,GAGdltD,GAActoB,SAChB,CAAE,MAAO3N,GACPV,QAAQU,MAAM,sBAAuBA,GACrCslC,GAAAA,QAAMC,MAAM,QAAQ,4BAA4BvlC,aAAiB2B,MAAQ3B,EAAMW,QAAU,kBACzFs1B,GAAcj2B,OAChB,CAAC,QACCohE,GAAY,EACd,MAnCE9hE,QAAQU,MAAM,mBAoClB,IAAC,kBAtCsB,OAAAqF,EAAApF,MAAA,KAAAC,UAAA,KAmDjB+7E,EAAY,eAAAv0E,GAAArI,EAAAA,EAAAA,UAAG,YACnB42B,GAActc,SACd8N,EAAW0B,SAAS,qBAAsB,CAAEsd,QAAAA,GAC9C,IAAC,kBAHiB,OAAA/+B,EAAAzH,MAAA,KAAAC,UAAA,KAKZokF,GAAa,WACjBruD,GAAcnc,QACVopE,EAEF59C,GAAAA,QAAMC,MACJ,kBACA,uDACA,CACE,CACEluB,KAAM,UACN4L,MAAO,cACPG,QAAS,WA1BjB6S,GAAcnc,QAEVslB,IACFikD,EAAajkD,EAAMh3B,OAAS,IAC5Bm7E,EAAenkD,EAAM/2B,SAAW,IAChCo7E,EAAYrkD,EAAMj2B,MAAQ,KAE5Bg6E,GAAc,GAqBJ17D,EAAWi9C,QACb,GAEF,CACErtD,KAAM,cACN+L,QAAQ,WAAD,IAAAyvD,GAAAxzE,EAAAA,EAAAA,UAAE,kBACD8kF,IACN18D,EAAWi9C,QACb,IAHO,OAGN,WAHM,OAAAmO,EAAA5yE,MAAA,KAAAC,UAAA,EAAC,IAKV,CACEmX,KAAM,SACN4L,MAAO,YAKbwE,EAAWi9C,QAEf,EAEA,GAAItwD,EACF,OACEmC,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAO2B,iBAAiB/M,UACnCoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOshE,eAAe1sE,SAAA,EACjC4C,EAAAA,EAAAA,KAACgN,GAAAA,QAAiB,CAACxjB,KAAK,QAAQggB,MAAO1C,EAAMC,OAAOzG,WACpDN,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO4B,YAAYhN,SAAC,+BAMzC,IAAKyrB,EACH,OACE7oB,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAOoH,eAAexS,UACjCoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOuhE,aAAa3sE,SAAA,EAC/B4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,wBAAwBvO,KAAM,GAAIggB,MAAO1C,EAAMC,OAAOhG,iBACrEf,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOwhE,WAAW5sE,SAAC,qBAChC4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOqH,UAAUzS,SAAC,0DAC/BoP,EAAAA,EAAAA,MAACI,GAAAA,QAAgB,CACfF,MAAOlE,EAAOyhE,YACdp9D,QAASkhE,GACT/tD,cAAe,GAAI5iB,SAAA,EAEnB4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,aAAavO,KAAM,GAAIggB,MAAO1C,EAAMC,OAAO5E,SAC1DnC,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO0hE,gBAAgB9sE,SAAC,oBAO/C,IAAM8hC,IAAYhW,EAAAA,GAAAA,SAASL,EAAMn2B,YAC3Bs7E,IAAU/kD,EAAAA,GAAAA,SAAO,IAAIz+B,KAAQ,iBAAkBy+B,EAAAA,GAAAA,SAAOiW,GAAW,cACjE+uC,IAAchlD,EAAAA,GAAAA,SAAO,IAAIz+B,KAAKA,KAAKorB,MAAQ,OAAW,iBAAkBqT,EAAAA,GAAAA,SAAOiW,GAAW,cAQhG,OACE1yB,EAAAA,EAAAA,MAACC,GAAAA,QAAY,CAACC,MAAOlE,EAAOE,UAAUtL,SAAA,EAEpCoP,EAAAA,EAAAA,MAAC8R,GAAAA,QAAS3R,KAAI,CACZD,MAAO,CACLlE,EAAO2hE,eACP,CACEtsD,QAAS0vD,EACTjuD,UAAW,CAAC,CAAEC,MAAOkuD,MAEvBrwE,SAAA,EAEF4C,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CACfF,MAAOlE,EAAO4hE,iBACdv9D,QAASkhE,GACT/tD,cAAe,GAAI5iB,UAEnB4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,aAAavO,KAAM,GAAIggB,MAAO1C,EAAMC,OAAOjG,UAE5Dd,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO6hE,oBAAqB/gD,cAAe,EAAElsB,SACvDyrB,EAAMh3B,OAAS,mBAElBmO,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAO0+B,mBAItB16B,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAO8hE,WAAWltE,SAAA,EAC7B4C,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CACfF,MAAOlE,EAAOwK,WACdnG,QAASkhE,GACT/tD,cAAe,GAAI5iB,UAEnB4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,aAAavO,KAAM,GAAIggB,MAAO1C,EAAMC,OAAOjG,UAE5D0L,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAO+hE,cAAcntE,SAAA,CAC/BuvE,GACCngE,EAAAA,EAAAA,MAAA+oB,EAAAA,SAAA,CAAAn4B,SAAA,EACE4C,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CACfF,MAAO,CAAClE,EAAOgiE,mBAAoBrqB,GAAY,CAAEtiC,QAAS,KAC1DhR,QAAS,WAAO,IAADqhE,EAAAC,EAEQ,OAArBD,EAAAb,EAAc7uD,UAAd0vD,EAAuBE,OACA,OAAvBD,EAAAb,EAAgB9uD,UAAhB2vD,EAAyBC,OACzBR,GACF,EACA5tD,cAAe,GACfze,SAAU4+C,EAAS/iD,SAElB+iD,GACCngD,EAAAA,EAAAA,KAACgN,GAAAA,QAAiB,CAACxjB,KAAK,QAAQggB,MAAO1C,EAAMC,OAAOzG,WAEpDN,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,YAAYvO,KAAM,GAAIggB,MAAO1C,EAAMC,OAAO3P,aAG7D4I,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CACfF,MAAOlE,EAAOgiE,mBACd39D,QAAS8gE,EACT3tD,cAAe,GAAI5iB,UAEnB4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,cAAcvO,KAAM,GAAIggB,MAAO1C,EAAMC,OAAOzG,gBAI/DN,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CACfF,MAAOlE,EAAOgiE,mBACd39D,QAAS8gE,EACT3tD,cAAe,GAAI5iB,UAEnB4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,iBAAiBvO,KAAM,GAAIggB,MAAO1C,EAAMC,OAAOzG,aAGlEN,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CACfF,MAAO,CAAClE,EAAOgiE,mBAAoBhiE,EAAOiiE,oBAC1C59D,QAAS64D,EACT1lD,cAAe,GAAI5iB,UAEnB4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,gBAAgBvO,KAAM,GAAIggB,MAAO1C,EAAMC,OAAOtd,iBAKnEuW,EAAAA,EAAAA,KAACse,GAAAA,QAASnW,WAAU,CAClBuE,MAAOlE,EAAOo9D,WACdx9D,8BAA8B,EAC9BE,oBAAqB,GACrBgtB,SAAUhX,GAAAA,QAASuW,MACjB,CAAC,CAAEE,YAAa,CAAED,cAAe,CAAEX,EAAGi5C,MACtC,CAAE/vD,iBAAiB,IACnBjgB,UAEFoP,EAAAA,EAAAA,MAAC8R,GAAAA,QAAS3R,KAAI,CACZD,MAAO,CACLlE,EAAO1W,QACP,CACE+rB,QAAS8qD,EACTrpD,UAAW,CACT,CAAEu5B,WAAYs0B,GACd,CAAE5tD,MAAOnB,MAGbhhB,SAAA,EAGFoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOkiE,YAAYttE,SAAA,EAC9BoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOqf,cAAczqB,SAAA,EAChC4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOmiE,SAASvtE,SA9GnC4wE,GAAgB,QAChBC,GAAoB,aACjBhlD,EAAAA,GAAAA,SAAOiW,GAAW,mBA6Gfl/B,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOoiE,aAAaxtE,UAC9B6rB,EAAAA,GAAAA,SAAOiW,GAAW,mBAErB1yB,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOqiE,cAAcztE,SAAA,EAChC4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,eAAevO,KAAM,GAAIggB,MAAO1C,EAAMC,OAAOhG,iBAC5Df,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO8+B,SAASlqC,UAC1B6rB,EAAAA,GAAAA,SAAOiW,GAAW,kBAIxBrW,EAAMl2B,YACL6Z,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOwf,eAAe5qB,SAAA,EACjC4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,gBAAgBvO,KAAM,GAAIggB,MAAO1C,EAAMC,OAAOjF,UAC7D9B,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOsiE,UAAU1tE,SAAC,iBAMrCoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOuiE,aAAa3tE,SAAA,EAC/BoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOwiE,YAAY5tE,SAAA,EAC9B4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,gBAAgBvO,KAAM,GAAIggB,MAAO1C,EAAMC,OAAOzG,WAC7DN,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOyiE,gBAAgB7tE,SAAC,eACpCuvE,IACC3sE,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOyjE,kBAAkB7uE,SAAC,gBAK3C4C,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAO0jE,aAAa9uE,SAC9BuvE,GACC3sE,EAAAA,EAAAA,KAACmS,GAAAA,QAAS,CACR/K,IAAKimE,EACL3gE,MAAOlE,EAAO2jE,WACdvjF,MAAOikF,EACPx6D,aAAcy6D,EACd16D,YAAY,iBACZsuC,WAAW,EACXn3B,UAAW,OAGbvpB,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO0iE,WAAW9tE,SAC5ByrB,EAAMh3B,OAAS,sBAMtBmO,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAO4jE,eAAehvE,SAChCuvE,GACC3sE,EAAAA,EAAAA,KAACmS,GAAAA,QAAS,CACR/K,IAAKkmE,EACL5gE,MAAOlE,EAAO6jE,aACdzjF,MAAOmkF,EACP16D,aAAc26D,EACd56D,YAAY,uBACZsuC,WAAW,EACXp3B,cAAe,EACfk1B,kBAAkB,SAGpBx+C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO2iE,UAAU/tE,SAAEyrB,EAAM/2B,YAKzC66E,IACC3sE,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAO8jE,cAAclvE,UAChCoP,EAAAA,EAAAA,MAACI,GAAAA,QAAgB,CACfF,MAAOlE,EAAO+jE,aACd1/D,QAAS,WACP6S,GAAcnc,QACd2N,EAAW0B,SAAS,SAAU,CAAE+3C,UAAWz6B,GAC7C,EACAlQ,cAAe,GAAI5iB,SAAA,EAEnB4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,MAAMvO,KAAM,GAAIggB,MAAO1C,EAAMC,OAAO5E,SACnDnC,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOgkE,iBAAiBpvE,SAAC,oBAO9CoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAO4iE,YAAYhuE,SAAA,EAC9BoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAO6iE,WAAWjuE,SAAA,EAC7B4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,YAAYvO,KAAM,GAAIggB,MAAO1C,EAAMC,OAAOzG,WACzDN,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO8iE,eAAeluE,SAAC,UAClCuvE,IACA3sE,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAO+iE,SAASnuE,UAC3B4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOgjE,aAAapuE,UAAY,OAAVwwD,EAAA/kC,EAAMj2B,WAAI,EAAVg7D,EAAY5jE,SAAU,SAK9D2iF,GACC3sE,EAAAA,EAAAA,KAACquE,GAAQ,CACPz7E,KAAMq6E,EACNhF,aAAciF,EACd96D,YAAY,cACZs0D,QAAS,KAGX79C,EAAMj2B,MAAQi2B,EAAMj2B,KAAK5I,OAAS,IAChCgW,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAOijE,SAASruE,SAC1ByrB,EAAMj2B,KAAK2wB,KAAI,SAAClvB,EAAUq1B,GAAa,OACtC1pB,EAAAA,EAAAA,KAACse,GAAAA,QAAS3R,KAAI,CAEZD,MAAO,CACLlE,EAAOnU,IACP,CACEirB,UAAW,CAAC,CACVC,MAAOopD,EAASxpD,YAAY,CAC1BC,WAAY,CAAC,EAAG,GAChBC,YAAa,CAAC,GAAK,SAIzBjiB,UAEF4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO4f,QAAQhrB,SAAE/I,EAAI0D,QAb7B1D,EAAI3C,GAAKqnB,OAAO1kB,EAAI3C,IAASm3B,EAAMn3B,GAAE,QAAQg4B,EAcpC,UAQ1Bld,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOkjE,aAAatuE,SAAA,EAC/B4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOmjE,WAAWvuE,SAAC,iBAChCoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOojE,UAAUxuE,SAAA,EAC5BoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOqjE,SAASzuE,SAAA,EAC3B4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,eAAevO,KAAM,GAAIggB,MAAO1C,EAAMC,OAAOzG,WAC5DN,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO0jB,UAAU9uB,SAC3BuvE,EAAaI,EAAY/iF,OAAS6+B,EAAM/2B,QAAQ9H,UAEnDgW,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO6jB,UAAUjvB,SAAC,mBAEjCoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOqjE,SAASzuE,SAAA,EAC3B4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,kBAAkBvO,KAAM,GAAIggB,MAAO1C,EAAMC,OAAOjF,UAC/D9B,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO0jB,UAAU9uB,SAC3BuvE,EACGI,EAAY/gE,MAAM,KAAKpS,QAAO,SAAA00E,GAAI,OAAIA,EAAKtkF,OAAS,CAAC,IAAEA,OACvD6+B,EAAM/2B,QAAQka,MAAM,KAAKhiB,UAG/BgW,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO6jB,UAAUjvB,SAAC,cAEjCoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOqjE,SAASzuE,SAAA,EAC3B4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,oBAAoBvO,KAAM,GAAIggB,MAAO1C,EAAMC,OAAOtG,aACjET,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO0jB,UAAU9uB,SAC3BuvE,EAAaM,EAASjjF,QAAoB,OAAVyiF,EAAA5jD,EAAMj2B,WAAI,EAAV65E,EAAYziF,SAAU,KAEzDgW,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO6jB,UAAUjvB,SAAC,wBAQzCoP,EAAAA,EAAAA,MAAC8R,GAAAA,QAAS3R,KAAI,CACZD,MAAO,CACLlE,EAAOsjE,gBACP,CACEjuD,QAAS8qD,EACTrpD,UAAW,CAAC,CAAEu5B,WAAYs0B,MAE5B/vE,SAAA,EAEF4C,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CACfF,MAAO,CAAClE,EAAO+xD,IAAK/xD,EAAOujE,SAC3Bl/D,QAAS8gE,EACT3tD,cAAe,GAAI5iB,UAEnB4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,SAASvO,KAAM,GAAIggB,MAAO1C,EAAMC,OAAO5E,WAGxDnC,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CACfF,MAAO,CAAClE,EAAO+xD,IAAK/xD,EAAOwjE,WAC3Bn/D,QAAS64D,EACT1lD,cAAe,GAAI5iB,UAEnB4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,QAAQvO,KAAM,GAAIggB,MAAO1C,EAAMC,OAAO5E,eAK/D,E,0BC5TM8K,GAAY,SAACnG,GAAe,OAAK2B,EAAAA,QAAWxb,OAAO,CACvDyb,UAAW,CACTC,KAAM,EACNC,gBAAiB9B,EAAMC,OAAOpG,YAEhCwJ,iBAAkB,CAChBxB,KAAM,EACNO,eAAgB,SAChBD,WAAY,SACZL,gBAAiB9B,EAAMC,OAAOpG,YAEhCoO,gBAAiB,CACfpG,KAAM,EACNZ,cAAejB,EAAMvC,QAAQZ,IAE/BqL,cAAe,CACb7F,QAASrC,EAAMvC,QAAQX,IAEzB2qE,UAAW,CACTzjE,aAAchE,EAAMvC,QAAQX,IAE9BwiC,MAAO,CACL98B,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC4F,WAAY,OACZC,MAAO1C,EAAMC,OAAOjG,KACpBgK,aAAchE,EAAMvC,QAAQb,GAC5B8G,WAAY1D,EAAM7D,WAAWC,aAAaI,MAE5C4M,MAAO,CACLtH,gBAAiB9B,EAAMb,WAAaa,EAAMC,OAAOnE,QAAUkE,EAAMC,OAAO5E,MACxEiN,YAAa,EACbD,YAAarI,EAAMC,OAAO9F,OAC1BwD,aAAc,EACdqF,kBAAmBhD,EAAMvC,QAAQZ,GACjCkG,gBAAiB/C,EAAMvC,QAAQb,GAC/B4F,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC6F,MAAO1C,EAAMC,OAAOjG,KACpB0J,WAAY1D,EAAM7D,WAAWC,aAAaC,SAE5CqrE,SAAU,CACR5lE,gBAAiB9B,EAAMb,WAAaa,EAAMC,OAAOnE,QAAUkE,EAAMC,OAAO5E,MACxEiN,YAAa,EACbD,YAAarI,EAAMC,OAAO9F,OAC1BwD,aAAc,EACd0E,QAASrC,EAAMvC,QAAQZ,GACvB2F,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC6F,MAAO1C,EAAMC,OAAOjG,KACpBqM,UAAW,IACX3C,WAAY1D,EAAM7D,WAAWC,aAAaC,SAE5CsrE,qBAAsB,CACpB7lE,gBAAiB9B,EAAMb,WAAaa,EAAMC,OAAOpE,QAAUmE,EAAMC,OAAO1E,QACxE8G,QAASrC,EAAMvC,QAAQZ,GACvBc,aAAc,EACdqG,aAAchE,EAAMvC,QAAQZ,GAC5BsF,WAAY,UAEd0hE,SAAU,CACRrhE,SAAUxC,EAAM7D,WAAWO,UAAUI,GACrC2F,WAAY,OACZC,MAAO1C,EAAMC,OAAOjG,KACpB0J,WAAY1D,EAAM7D,WAAWC,aAAaI,MAE5CgkC,SAAU,CACRh+B,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC6F,MAAO1C,EAAMC,OAAOhG,cACpBsJ,UAAWvD,EAAMvC,QAAQd,GACzB+G,WAAY1D,EAAM7D,WAAWC,aAAaC,SAE5CurE,sBAAuB,CACrB1lE,cAAe,MACfE,eAAgB,eAChB4B,aAAchE,EAAMvC,QAAQZ,IAE9BgrE,aAAc,CACZ3lE,cAAe,MACfC,WAAY,SACZL,gBAAiB9B,EAAMb,WAAaa,EAAMC,OAAOpE,QAAUmE,EAAMC,OAAO1E,QACxE8G,QAASrC,EAAMvC,QAAQb,GACvBe,aAAc,GAEhBmqE,cAAe,CACbzlE,QAASrC,EAAMvC,QAAQb,IAEzBmrE,aAAc,CACZvlE,SAAUxC,EAAM7D,WAAWO,UAAUE,GACrC8F,MAAO1C,EAAMC,OAAOjG,KACpBiJ,iBAAkBjD,EAAMvC,QAAQb,GAChC8G,WAAY1D,EAAM7D,WAAWC,aAAaG,UAE5CyrE,gBAAiB,CACf9lE,cAAe,MACfE,eAAgB,gBAChBD,WAAY,SACZY,gBAAiB/C,EAAMvC,QAAQZ,GAC/BuH,eAAgB,EAChB9B,kBAAmB,EACnB+F,YAAarI,EAAMC,OAAO9F,OAC1BoJ,UAAWvD,EAAMvC,QAAQZ,GACzBmH,aAAchE,EAAMvC,QAAQX,GAC5BkG,kBAAmBhD,EAAMvC,QAAQd,IAEnCgwD,gBAAiB,CACfzqD,cAAe,MACfE,eAAgB,eAChBW,gBAAiB/C,EAAMvC,QAAQZ,GAC/BmG,kBAAmBhD,EAAMvC,QAAQX,GACjCsH,eAAgB,EAChBC,eAAgBrE,EAAMC,OAAO9F,OAC7B2H,gBAAiB9B,EAAMC,OAAOpG,YAEhCuM,OAAQ,CACNzI,aAAc,EACdoF,gBAAiB/C,EAAMvC,QAAQZ,GAC/BmG,kBAAmBhD,EAAMvC,QAAQV,GACjCoF,WAAY,SACZC,eAAgB,SAChBy5C,SAAU,KAEZosB,WAAY,CACVnmE,gBAAiB9B,EAAMC,OAAOzG,SAEhC0uE,eAAgB,CACdxlE,MAAO1C,EAAMb,WAAaa,EAAMC,OAAOpG,WAAamG,EAAMC,OAAO5E,MACjEmH,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC4F,WAAY,OACZiB,WAAY1D,EAAM7D,WAAWC,aAAaI,MAE5CowD,aAAc,CACZ9qD,gBAAiB9B,EAAMC,OAAOzE,SAEhCqxD,iBAAkB,CAChBnqD,MAAO1C,EAAMb,WAAaa,EAAMC,OAAOjG,KAAOgG,EAAMC,OAAOhG,cAC3DuI,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC6G,WAAY1D,EAAM7D,WAAWC,aAAaG,UAE5CgK,eAAgB,CACdzE,gBAAiB9B,EAAMC,OAAOxF,WAE/B,EAEH,SA/W2B,WACzB,IAAM2P,GAAaC,EAAAA,GAAAA,iBACbk4B,GAAQujB,EAAAA,GAAAA,YACN9lD,EAAUG,KAAVH,MACF0B,EAASyE,GAAUnG,GACjBmoE,EAAe5lC,EAAM93C,OAArB09E,WAER5xE,GAA0BC,EAAAA,EAAAA,UAAS,IAAGC,GAAAC,EAAAA,EAAAA,SAAAH,EAAA,GAA/BxL,EAAK0L,EAAA,GAAE0vD,EAAQ1vD,EAAA,GACtBI,GAAwBL,EAAAA,EAAAA,UAAS,IAAGM,GAAAJ,EAAAA,EAAAA,SAAAG,EAAA,GAA7BuxE,EAAItxE,EAAA,GAAEuxE,EAAOvxE,EAAA,GACpBG,GAAwCT,EAAAA,EAAAA,UAAS,IAAI9S,MAAOwT,GAAAR,EAAAA,EAAAA,SAAAO,EAAA,GAArDqxE,EAAYpxE,EAAA,GAAEqxE,EAAerxE,EAAA,GACpCG,GAAkCb,EAAAA,EAAAA,WAAS,GAAKc,GAAAZ,EAAAA,EAAAA,SAAAW,EAAA,GAAzCmxE,EAASlxE,EAAA,GAAEmxE,EAAYnxE,EAAA,GAE9BoT,GAAkClU,EAAAA,EAAAA,WAAS,GAAMmU,GAAAjU,EAAAA,EAAAA,SAAAgU,EAAA,GAA1C3T,EAAS4T,EAAA,GAAE3T,EAAY2T,EAAA,GAC9BE,GAAoDrU,EAAAA,EAAAA,WAAS,GAAMsU,GAAApU,EAAAA,EAAAA,SAAAmU,EAAA,GAA5D69D,EAAkB59D,EAAA,GAAE69D,EAAqB79D,EAAA,IAGhDtT,EAAAA,EAAAA,YAAU,WACJ2wE,GACFS,GAEJ,GAAG,CAACT,IAEJ,IAAMS,EAAiB,eAAA5gF,GAAAhG,EAAAA,EAAAA,UAAG,YACxB,IACE2mF,GAAsB,GACtB,IACME,SADiB5iF,EAAa0G,YAAYw7E,IACtBrkF,KAE1BqiE,EAAS0iB,EAAS99E,OAAS,IAC3Bs9E,EAAQQ,EAAST,MAAQ,IACzBG,EAAgB,IAAI7kF,KAAKmlF,EAASC,gBAClCL,EAAaI,EAASE,UACxB,CAAE,MAAOpmF,GACPV,QAAQU,MAAM,+BAAgCA,GAC9CslC,GAAAA,QAAMC,MAAM,QAAS,+BACvB,CAAC,QACCygD,GAAsB,EACxB,CACF,IAAC,kBAhBsB,OAAA3gF,EAAApF,MAAA,KAAAC,UAAA,KAkBjBmmF,EAAU,eAAA3+E,GAAArI,EAAAA,EAAAA,UAAG,YAEjB,GAAK+I,EAAM2c,OAKX,IACE1Q,GAAa,GAEb,IAAMiyE,EAAe,CACnBl+E,MAAAA,EACAq9E,KAAAA,EACAU,cAAeR,EAAa3kF,cAC5BolF,UAAWP,GAGTL,SAEIliF,EAAa4G,eAAes7E,EAAsBc,GACxDhhD,GAAAA,QAAMC,MAAM,UAAW,yCAGjBjiC,EAAa2G,eAAeq8E,GAClChhD,GAAAA,QAAMC,MAAM,UAAW,kCAGzB9d,EAAWi9C,QACb,CAAE,MAAO1kE,GACPV,QAAQU,MAAM,wBAAyBA,GACvCslC,GAAAA,QAAMC,MAAM,QAAS,0BACvB,CAAC,QACClxB,GAAa,EACf,MA9BEixB,GAAAA,QAAMC,MAAM,QAAS,yCA+BzB,IAAC,kBAlCe,OAAA79B,EAAAzH,MAAA,KAAAC,UAAA,KAqDhB,OAAI6lF,GAEAxvE,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAO2B,iBAAiB/M,UACnC4C,EAAAA,EAAAA,KAACgN,GAAAA,QAAiB,CAACxjB,KAAK,QAAQggB,MAAO1C,EAAMC,OAAOzG,aAMxDkM,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOE,UAAUtL,SAAA,EAC5BoP,EAAAA,EAAAA,MAACtF,GAAc,CACbwF,MAAOlE,EAAOuG,gBACdxH,sBAAuBiB,EAAOwG,cAC9B3G,0BAA0B,UAASjL,SAAA,EAEnCoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAO+lE,UAAUnxE,SAAA,EAC5B4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO49B,MAAMhpC,SAAC,WAC3B4C,EAAAA,EAAAA,KAACmS,GAAAA,QAAS,CACRzF,MAAOlE,EAAO0H,MACdkC,YAAY,iBACZxpB,MAAOiJ,EACPwgB,aAAc46C,EACdx6C,qBAAsB3L,EAAMC,OAAOhG,oBAIvCyL,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAO+lE,UAAUnxE,SAAA,EAC5B4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO49B,MAAMhpC,SAAC,UAC3B4C,EAAAA,EAAAA,KAACmS,GAAAA,QAAS,CACRzF,MAAOlE,EAAOgmE,SACd9tB,WAAS,EACTp3B,cAAe,EACflX,YAAY,wBACZxpB,MAAOsmF,EACP78D,aAAc88D,EACd3wB,kBAAkB,MAClB/rC,qBAAsB3L,EAAMC,OAAOhG,oBAIvCyL,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAO+lE,UAAUnxE,SAAA,EAC5B4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO49B,MAAMhpC,SAAC,0BAE3BoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOimE,qBAAqBrxE,SAAA,EACvC4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOmiE,SAASvtE,UAC1B6rB,EAAAA,GAAAA,SAAOmmD,EAAc,yBAExBpvE,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO8+B,SAASlqC,UAC1B6rB,EAAAA,GAAAA,SAAOmmD,EAAc,gBAI1B5iE,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOkmE,sBAAsBtxE,SAAA,EACxCoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOmmE,aAAavxE,SAAA,EAC/B4C,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CACfF,MAAOlE,EAAOomE,cACd/hE,QApES,WACrBwiE,GAAgB,SAAAW,GAAQ,OAAIC,EAAAA,GAAAA,SAAQD,GAAW,EAAE,GACnD,EAkEsC5yE,UAExB4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,SAASvO,KAAMsd,EAAM7D,WAAWO,UAAUK,GAAI2F,MAAO1C,EAAMC,OAAOhG,mBAGnFf,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOqmE,aAAazxE,SAAC,UAElC4C,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CACfF,MAAOlE,EAAOomE,cACd/hE,QAjFI,WAChBwiE,GAAgB,SAAAW,GAAQ,OAAIC,EAAAA,GAAAA,SAAQD,EAAU,EAAE,GAClD,EA+EiC5yE,UAEnB4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,MAAMvO,KAAMsd,EAAM7D,WAAWO,UAAUK,GAAI2F,MAAO1C,EAAMC,OAAOhG,sBAIlFyL,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOmmE,aAAavxE,SAAA,EAC/B4C,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CACfF,MAAOlE,EAAOomE,cACd/hE,QA9EU,WACtBwiE,GAAgB,SAAAW,GAAQ,OAAIE,EAAAA,GAAAA,SAASF,GAAW,EAAE,GACpD,EA4EuC5yE,UAEzB4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,SAASvO,KAAMsd,EAAM7D,WAAWO,UAAUK,GAAI2F,MAAO1C,EAAMC,OAAOhG,mBAGnFf,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOqmE,aAAazxE,SAAC,UAElC4C,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CACfF,MAAOlE,EAAOomE,cACd/hE,QA3FK,WACjBwiE,GAAgB,SAAAW,GAAQ,OAAIE,EAAAA,GAAAA,SAASF,EAAU,EAAE,GACnD,EAyFkC5yE,UAEpB4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CAAC/U,KAAK,MAAMvO,KAAMsd,EAAM7D,WAAWO,UAAUK,GAAI2F,MAAO1C,EAAMC,OAAOhG,4BAMtFyL,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOsmE,gBAAgB1xE,SAAA,EAClC4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO49B,MAAMhpC,SAAC,qBAC3B4C,EAAAA,EAAAA,KAAC6jC,GAAAA,QAAM,CACLC,WAAY,CAAEC,MAAOj9B,EAAMC,OAAOxE,QAASyhC,KAAMl9B,EAAMC,OAAOzG,SAC9D2jC,WAAYqrC,EAAaxoE,EAAMb,WAAaa,EAAMC,OAAOpG,WAAamG,EAAMC,OAAO5E,MAAS2E,EAAMC,OAAO1E,QACzG6hC,oBAAqBp9B,EAAMC,OAAOxE,QAClCohC,cAAe4rC,EACf3mF,MAAO0mF,WAKb9iE,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOirD,gBAAgBr2D,SAAA,EAClC4C,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CACfF,MAAO,CAAClE,EAAO0E,OAAQ1E,EAAOkrD,cAC9B7mD,QAAS,WAAF,OAAQqE,EAAWi9C,QAAQ,EAClC5sD,SAAU1D,EAAUT,UAEpB4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOmrD,iBAAiBv2D,SAAC,cAGxC4C,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CACfF,MAAO,CACLlE,EAAO0E,OACP1E,EAAOumE,WACPlxE,GAAa2K,EAAO6E,gBAEtBR,QAASijE,EACTvuE,SAAU1D,EAAUT,SAEnBS,GACCmC,EAAAA,EAAAA,KAACgN,GAAAA,QAAiB,CAACxjB,KAAK,QAAQggB,MAAO1C,EAAMb,WAAaa,EAAMC,OAAOpG,WAAamG,EAAMC,OAAO5E,SAEjGnC,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOwmE,eAAe5xE,SAAC,gBAMhD,EC/NA,IA4FM6P,GAAY,SAACnG,GAAe,OAAK2B,EAAAA,QAAWxb,OAAO,CACvDyb,UAAW,CACTC,KAAM,EACNC,gBAAiB9B,EAAMC,OAAOpG,YAEhC7O,QAAS,CACP6W,KAAM,EACNO,eAAgB,SAChBD,WAAY,SACZa,kBAAmBhD,EAAMvC,QAAQV,IAEnC8+B,cAAe,CACb79B,MAA2B,EAApBgC,EAAMvC,QAAQT,IACrBiB,OAA4B,EAApB+B,EAAMvC,QAAQT,IACtBW,aAAkC,IAApBqC,EAAMvC,QAAQT,IAC5B8E,gBAAiB9B,EAAMC,OAAOtd,MAAQ,KACtCyf,eAAgB,SAChBD,WAAY,SACZ6B,aAAchE,EAAMvC,QAAQV,IAE9BhS,MAAO,CACLyX,SAAUxC,EAAM7D,WAAWO,UAAUM,IACrCyF,WAAY,OACZC,MAAO1C,EAAMC,OAAOjG,KACpBgK,aAAchE,EAAMvC,QAAQZ,GAC5BoH,UAAW,SACXP,WAAY1D,EAAM7D,WAAWC,aAAaI,MAE5ClZ,QAAS,CACPkf,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC6F,MAAO1C,EAAMC,OAAOhG,cACpBgK,UAAW,SACXkd,WAAYnhB,EAAM7D,WAAWgB,YAAYE,OAAS2C,EAAM7D,WAAWO,UAAUG,GAC7EmH,aAAchE,EAAMvC,QAAQT,IAC5B0G,WAAY1D,EAAM7D,WAAWC,aAAaC,SAE5CswD,gBAAiB,CACfzqD,cAAe,MACflE,MAAO,OACPgnB,IAAKhlB,EAAMvC,QAAQZ,IAErBuJ,OAAQ,CACNvE,KAAM,EACNkB,gBAAiB/C,EAAMvC,QAAQX,GAC/Ba,aAAc,GACdwE,WAAY,SACZC,eAAgB,UAElBwqD,aAAc,CACZ9qD,gBAAiB9B,EAAMC,OAAOlG,KAC9BuO,YAAa,EACbD,YAAarI,EAAMC,OAAO9F,QAE5B83D,aAAc,CACZnwD,gBAAiB9B,EAAMC,OAAOtd,OAEhCkqE,iBAAkB,CAChBrqD,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC6F,MAAO1C,EAAMC,OAAOjG,KACpByI,WAAY,MACZiB,WAAY1D,EAAM7D,WAAWC,aAAaG,UAE5C0hE,iBAAkB,CAChBz7D,SAAUxC,EAAM7D,WAAWO,UAAUG,GACrC6F,MAAO1C,EAAMC,OAAO5E,MACpBoH,WAAY,MACZiB,WAAY1D,EAAM7D,WAAWC,aAAaG,WAE3C,EAEH,SAlKiC,WAC/B,IAAM6N,GAAaC,EAAAA,GAAAA,iBACbk4B,GAAQujB,EAAAA,GAAAA,YACN9lD,EAAUG,KAAVH,MACF0B,EAASyE,GAAUnG,GACjBopB,EAAYmZ,EAAM93C,OAAlB2+B,QACR7yB,GAAoCC,EAAAA,EAAAA,WAAS,GAAMC,GAAAC,EAAAA,EAAAA,SAAAH,EAAA,GAA5C4nE,EAAU1nE,EAAA,GAAE2nE,EAAa3nE,EAAA,GAO1B4yE,EAAmB,eAAAjiF,GAAApF,EAAAA,EAAAA,UAAG,YAC1B,IAAIm8E,EAEJ,IACEC,GAAc,GACdxlD,GAActc,SACdra,QAAQC,IAAI,gDAAgDknC,SACtD7+B,EAAW4B,YAAY8lB,OAAOmX,IACpCnnC,QAAQC,IAAI,0CAEZ02B,GAActoB,UAEd8Z,EAAW0B,SAAS,WAAY,CAC9BC,OAAQ,UACRthB,OAAQ,CAAEshB,OAAQ,gBAEtB,CAAE,MAAOppB,GACPV,QAAQU,MAAM,6CAA8CA,GAExDA,GAA0B,kBAAVA,GAAsB,WAAYA,GAA0B,MAAjBA,EAAMoF,QACnE9F,QAAQC,IAAI,mEACZ02B,GAActoB,UACd8Z,EAAW0B,SAAS,WAAY,CAC9BC,OAAQ,UACRthB,OAAQ,CAAEshB,OAAQ,mBAGpB6M,GAAcj2B,QAEdynB,EAAWi9C,SAEf,CAAC,QACC+W,GAAc,EAChB,CACF,IAAC,kBAlCwB,OAAAh3E,EAAAxE,MAAA,KAAAC,UAAA,KAoCzB,OACEqW,EAAAA,EAAAA,KAACyM,GAAAA,QAAY,CAACC,MAAOlE,EAAOE,UAAUtL,UACpCoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAO1W,QAAQsL,SAAA,EAC1B4C,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,EAAOm6B,cAAcvlC,UAChC4C,EAAAA,EAAAA,KAAC8M,GAAAA,QAAQ,CACP/U,KAAK,gBACLvO,KAA0B,EAApBsd,EAAMvC,QAAQT,IACpB0F,MAAO1C,EAAMC,OAAOtd,WAIxBuW,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAO3W,MAAMuL,SAAC,0BAE3B4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOpe,QAAQgT,SAAC,uFAI7BoP,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,EAAOirD,gBAAgBr2D,SAAA,EAClC4C,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CACfF,MAAO,CAAClE,EAAO0E,OAAQ1E,EAAOkrD,aAAcuR,GAAc,CAAEpnD,QAAS,KACrEhR,QA7DW,WACnB6S,GAAcnc,QACd2N,EAAWi9C,QACb,EA2DU5sD,SAAU0jE,EAAW7nE,UAErB4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOmrD,iBAAiBv2D,SAAC,cAGxC4C,EAAAA,EAAAA,KAAC4M,GAAAA,QAAgB,CACfF,MAAO,CAAClE,EAAO0E,OAAQ1E,EAAOuwD,aAAckM,GAAc,CAAEpnD,QAAS,KACrEhR,QAASsjE,EACT5uE,SAAU0jE,EAAW7nE,SAEpB6nE,GACCjlE,EAAAA,EAAAA,KAACgN,GAAAA,QAAiB,CAACxjB,KAAK,QAAQggB,MAAO1C,EAAMC,OAAO5E,SAEpDnC,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,EAAOu8D,iBAAiB3nE,SAAC,oBAOpD,ECnGA,IAAMsX,IAAQC,EAAAA,GAAAA,WAyEd,SAvEsB,WACpB,OACEnI,EAAAA,EAAAA,MAACkI,GAAME,UAAS,CACdE,cAAe,CACbC,aAAa,GACb3X,SAAA,EAEF4C,EAAAA,EAAAA,KAAC0U,GAAMM,OAAM,CACXjd,KAAK,WACLkd,UAAWm7D,GACXzqC,QAAS,CAAE5wB,aAAa,MAE1B/U,EAAAA,EAAAA,KAAC0U,GAAMM,OAAM,CACXjd,KAAK,SACLkd,UAAWo7D,GACX1qC,QAAS,CACP2qC,aAAc,QACdv7D,aAAa,KAGhB41B,OACC3qC,EAAAA,EAAAA,KAAC0U,GAAMM,OAAM,CACXjd,KAAK,gBACLkd,UAAWs7D,GACX5qC,QAAS,CACP2qC,aAAc,QACdv7D,aAAa,MAInB/U,EAAAA,EAAAA,KAAC0U,GAAMM,OAAM,CACXjd,KAAK,wBACLkd,UAAWu7D,GACX7qC,QAAS,CACP2qC,aAAc,QACdv7D,aAAa,MAGjB/U,EAAAA,EAAAA,KAAC0U,GAAMM,OAAM,CACXjd,KAAK,qBACLkd,UAAWw7D,GACX9qC,QAAS,CACP5wB,aAAa,MAIjB/U,EAAAA,EAAAA,KAAC0U,GAAMM,OAAM,CACXjd,KAAK,eACLkd,UAAWy7D,GACX/qC,QAAS,CACP5wB,aAAa,EACbljB,MAAO,WACP8+E,YAAa,CAAE/nE,gBAAiB,WAChCgoE,gBAAiB,WAGrB5wE,EAAAA,EAAAA,KAAC0U,GAAMM,OAAM,CACXjd,KAAK,qBACLkd,UAAW47D,GACXlrC,QAAS,CACP2qC,aAAc,QACdv7D,aAAa,EACbljB,MAAO,eACP8+E,YAAa,CAAE/nE,gBAAiB,WAChCgoE,gBAAiB,YAK3B,ECxEA,IAAMl8D,IAAQC,EAAAA,GAAAA,WA0CRnM,GAASC,EAAAA,QAAWxb,OAAO,CAC/Byb,UAAW,CACTC,KAAM,EACNO,eAAgB,SAChBD,WAAY,SACZL,gBAAiB,WAEnBwB,YAAa,CACXC,UAAW,GACXf,SAAU,GACVE,MAAO,UAIX,SAtDmB,WACjB,IAAAuE,EAA+D7N,KAAvDzC,EAAesQ,EAAftQ,gBAAiBI,EAASkQ,EAATlQ,UAAWI,EAAgB8P,EAAhB9P,iBAAkB9E,EAAI4U,EAAJ5U,KAiBtD,OAbAmF,EAAAA,EAAAA,YAAU,WAER9W,EAAOqE,KAAK,oBAAqB,CAC/BgS,UAAAA,EACAI,iBAAAA,EACAR,gBAAAA,EACAqzE,aAAc33E,EACdqmE,SAAUz3E,EAAAA,QAASC,GACnBK,OAAOC,GAEX,GAAG,CAACuV,EAAWI,EAAkBR,EAAiBtE,IAG9C8E,GAEAuO,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,GAAOE,UAAUtL,SAAA,EAC5B4C,EAAAA,EAAAA,KAACgN,GAAAA,QAAiB,CAACxjB,KAAK,QAAQggB,MAAM,aACtCxJ,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,GAAO4B,YAAYhN,SAAC,mBAMrC4C,EAAAA,EAAAA,KAAC0U,GAAME,UAAS,CAACE,cAAe,CAAEC,aAAa,GAAQ3X,SACpDK,GAECuC,EAAAA,EAAAA,KAAC0U,GAAMM,OAAM,CAACjd,KAAK,OAAOkd,UAAW87D,MAGrC/wE,EAAAA,EAAAA,KAAC0U,GAAMM,OAAM,CAACjd,KAAK,OAAOkd,UAAW+7D,MAI7C,E,mJCvCsE,IAahEC,GAAa,SAAAC,GAAA,SAAAD,IAAA,IAAArnF,E,OAAAjC,EAAAA,EAAAA,SAAA,KAAAspF,GAAA,QAAAlnF,EAAAJ,UAAAK,OAAAC,EAAA,IAAAC,MAAAH,GAAAI,EAAA,EAAAA,EAAAJ,EAAAI,IAAAF,EAAAE,GAAAR,UAAAQ,GAC4C,O,EAD5C,K,EAAA8mF,E,EAAA,GAAA77C,OAAAnrC,G,oBAAAL,G,2FACjByrB,MAA4B,CAAE87D,UAAU,EAAO1nF,MAAO,MAAMG,CAAC,CAAD,OAAA0sC,EAAAA,EAAAA,SAAA26C,EAAAC,IAAAzpF,EAAAA,EAAAA,SAAAwpF,EAAA,EAAAtoF,IAAA,oBAAAC,MAM5D,SAAkBa,EAAc2nF,GAC9B5pF,EAAOiC,MAAM,mCAAoC,CAAEA,MAAAA,EAAO2nF,UAAAA,GAC5D,GAAC,CAAAzoF,IAAA,SAAAC,MAED,WAC4B,IAADyoF,EAAzB,OAAIxpF,KAAKwtB,MAAM87D,UAEX3kE,EAAAA,EAAAA,MAACG,EAAAA,QAAI,CAACD,MAAOlE,GAAOoH,eAAexS,SAAA,EACjC4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,GAAOwhE,WAAW5sE,SAAC,2BAChC4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,GAAOtX,aAAakM,UACd,OAAhBi0E,EAAAxpF,KAAKwtB,MAAM5rB,YAAK,EAAhB4nF,EAAkB7pD,aAAc,mCAEnCxnB,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAACL,MAAOlE,GAAO8oE,UAAUl0E,SAAC,sCAK9BvV,KAAK2f,MAAMpK,QACpB,IAAC,EAAAzU,IAAA,2BAAAC,MAtBD,SAAgCa,GAC9B,MAAO,CAAE0nF,UAAU,EAAM1nF,MAAAA,EAC3B,IAAC,CALgB,CAASwkC,EAAAA,WA6B5BsjD,EAAAA,QAAOC,WAAW,CAChB,oDACA,uCACA,mBAKF,IAAMC,GAAa,WACjB,IAAQ3qE,EAAUG,KAAVH,MACRzJ,GAA0CC,EAAAA,EAAAA,WAAS,GAAMC,GAAAC,EAAAA,EAAAA,SAAAH,EAAA,GAAlDskB,EAAapkB,EAAA,GAAEm0E,EAAgBn0E,EAAA,IAEtCe,EAAAA,EAAAA,YAAU,WACR,IAAMqzE,EAAa,eAAAzjF,GAAApF,EAAAA,EAAAA,UAAG,YACpB,IASEtB,EAAOqE,KAAK,gCAEZ6lF,GAAiB,EACnB,CAAE,MAAOjoF,GACPjC,EAAOiC,MAAM,4BAA6BA,GAE1CioF,GAAiB,EACnB,CACF,IAAC,kBAlBkB,OAAAxjF,EAAAxE,MAAA,KAAAC,UAAA,KAoBnBgoF,GACF,GAAG,IAGH,IAAIC,EAAiC,OAOrC,GAN+B,iBAA3B9qE,EAAMC,OAAOtF,UACfmwE,EAAiB,OACmB,kBAA3B9qE,EAAMC,OAAOtF,YACtBmwE,EAAiB,UAGdjwD,EAAe,CAElB,IAAMkwD,EAAgBppE,EAAAA,QAAWxb,OAAO,CACpCkd,iBAAkB,CACdxB,KAAM,EACNO,eAAgB,SAChBD,WAAY,SACZL,gBAAiB,aAGzB,OACE5I,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOmlE,EAAc1nE,iBAAiB/M,UAC1C4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAAA3P,SAAC,yBAGZ,CAEA,OACE4C,EAAAA,EAAAA,KAAC8xE,EAAAA,iBAAgB,CAAA10E,UACf4C,EAAAA,EAAAA,KAAC7C,GAAY,CAAAC,UACX4C,EAAAA,EAAAA,KAAC6F,GAAa,CAAAzI,UACZ4C,EAAAA,EAAAA,KAACwhC,GAAgB,CAAApkC,UACf4C,EAAAA,EAAAA,KAAC+kB,GAAkB,CAAA3nB,UACjBoP,EAAAA,EAAAA,MAACulE,EAAAA,QAAmB,CAClB7wB,cAAe,WACT54D,CAGN,EACA0pF,UAEEhyE,EAAAA,EAAAA,KAAC2M,EAAAA,QAAI,CAACD,MAAOlE,GAAO2B,iBAAiB/M,UACnC4C,EAAAA,EAAAA,KAAC+M,EAAAA,QAAI,CAAA3P,SAAC,4BAETA,SAAA,EAED4C,EAAAA,EAAAA,KAACiyE,GAAU,KACXjyE,EAAAA,EAAAA,KAACkyE,EAAAA,QAAS,CAACxlE,MAAOklE,IAAkB,gBAQpD,EAEe,SAASO,KAGtB,OACEnyE,EAAAA,EAAAA,KAACixE,GAAa,CAAA7zE,UACZ4C,EAAAA,EAAAA,KAACoyE,EAAAA,uBAAsB,CAAC1lE,MAAO,CAAE/D,KAAM,GAAIvL,UACzC4C,EAAAA,EAAAA,KAAC6F,GAAa,CAAAzI,UACZ4C,EAAAA,EAAAA,KAACwhC,GAAgB,CAAApkC,UACf4C,EAAAA,EAAAA,KAAC+kB,GAAkB,CAAA3nB,UACjB4C,EAAAA,EAAAA,KAACyxE,GAAU,aAOzB,CAGA,IAAMjpE,GAASC,EAAAA,QAAWxb,OAAO,CAC/Bkd,iBAAkB,CAChBxB,KAAM,EACNO,eAAgB,SAChBD,WAAY,UAId2G,eAAgB,CACdjH,KAAM,EACNO,eAAgB,SAChBD,WAAY,SACZE,QAAS,GACTP,gBAAiB,WAEnBohE,WAAY,CACV1gE,SAAU,GACVC,WAAY,OACZC,MAAO,UACPsB,aAAc,IAEhB5Z,aAAc,CACZoY,SAAU,GACVE,MAAO,OACPsB,aAAc,GACdC,UAAW,UAEbumE,UAAW,CACThoE,SAAU,GACVE,MAAO,S,eCjMP6oE,EAA2B,CAAC,EAGhC,SAASC,EAAoBC,GAE5B,IAAIC,EAAeH,EAAyBE,GAC5C,QAAqB7mF,IAAjB8mF,EACH,OAAOA,EAAaC,QAGrB,IAAIC,EAASL,EAAyBE,GAAY,CACjD7gF,GAAI6gF,EACJI,QAAQ,EACRF,QAAS,CAAC,GAUX,OANAG,EAAoBL,GAAUM,KAAKH,EAAOD,QAASC,EAAQA,EAAOD,QAASH,GAG3EI,EAAOC,QAAS,EAGTD,EAAOD,OACf,CAGAH,EAAoBQ,EAAIF,E,MC5BxB,IAAIG,EAAW,GACfT,EAAoBU,EAAI,CAACz8E,EAAQ08E,EAAUC,EAAIC,KAC9C,IAAGF,EAAH,CAMA,IAAIG,EAAen5B,IACnB,IAASp/C,EAAI,EAAGA,EAAIk4E,EAAS/oF,OAAQ6Q,IAAK,CAGzC,IAFA,IAAKo4E,EAAUC,EAAIC,GAAYJ,EAASl4E,GACpCw4E,GAAY,EACPC,EAAI,EAAGA,EAAIL,EAASjpF,OAAQspF,MACpB,EAAXH,GAAsBC,GAAgBD,IAAa57E,OAAOC,KAAK86E,EAAoBU,GAAGz+C,OAAO5rC,GAAS2pF,EAAoBU,EAAErqF,GAAKsqF,EAASK,MAC9IL,EAASM,OAAOD,IAAK,IAErBD,GAAY,EACTF,EAAWC,IAAcA,EAAeD,IAG7C,GAAGE,EAAW,CACbN,EAASQ,OAAO14E,IAAK,GACrB,IAAI24E,EAAIN,SACExnF,IAAN8nF,IAAiBj9E,EAASi9E,EAC/B,CACD,CACA,OAAOj9E,CAnBP,CAJC48E,EAAWA,GAAY,EACvB,IAAI,IAAIt4E,EAAIk4E,EAAS/oF,OAAQ6Q,EAAI,GAAKk4E,EAASl4E,EAAI,GAAG,GAAKs4E,EAAUt4E,IAAKk4E,EAASl4E,GAAKk4E,EAASl4E,EAAI,GACrGk4E,EAASl4E,GAAK,CAACo4E,EAAUC,EAAIC,EAqBjB,C,KCzBdb,EAAoBmB,EAAKf,IACxB,IAAIgB,EAAShB,GAAUA,EAAOiB,WAC7B,IAAOjB,EAAiB,QACxB,IAAM,EAEP,OADAJ,EAAoBsB,EAAEF,EAAQ,CAAEG,EAAGH,IAC5BA,CAAM,E,MCNd,IACII,EADAC,EAAWx8E,OAAOy8E,eAAkBC,GAAS18E,OAAOy8E,eAAeC,GAASA,GAASA,EAAa,UAQtG3B,EAAoBn9C,EAAI,SAASvsC,EAAO8kB,GAEvC,GADU,EAAPA,IAAU9kB,EAAQf,KAAKe,IAChB,EAAP8kB,EAAU,OAAO9kB,EACpB,GAAoB,kBAAVA,GAAsBA,EAAO,CACtC,GAAW,EAAP8kB,GAAa9kB,EAAM+qF,WAAY,OAAO/qF,EAC1C,GAAW,GAAP8kB,GAAoC,oBAAf9kB,EAAM8pD,KAAqB,OAAO9pD,CAC5D,CACA,IAAIsrF,EAAK38E,OAAOtK,OAAO,MACvBqlF,EAAoBkB,EAAEU,GACtB,IAAIC,EAAM,CAAC,EACXL,EAAiBA,GAAkB,CAAC,KAAMC,EAAS,CAAC,GAAIA,EAAS,IAAKA,EAASA,IAC/E,IAAI,IAAIv1D,EAAiB,EAAP9Q,GAAY9kB,EAAyB,iBAAX41B,KAAyBs1D,EAAeM,QAAQ51D,GAAUA,EAAUu1D,EAASv1D,GACxHjnB,OAAO88E,oBAAoB71D,GAAS7D,SAAShyB,GAASwrF,EAAIxrF,GAAO,IAAOC,EAAMD,KAI/E,OAFAwrF,EAAa,QAAI,IAAM,EACvB7B,EAAoBsB,EAAEM,EAAIC,GACnBD,CACR,C,KCxBA5B,EAAoBsB,EAAI,CAACnB,EAAS6B,KACjC,IAAI,IAAI3rF,KAAO2rF,EACXhC,EAAoBiC,EAAED,EAAY3rF,KAAS2pF,EAAoBiC,EAAE9B,EAAS9pF,IAC5E4O,OAAOi9E,eAAe/B,EAAS9pF,EAAK,CAAE8rF,YAAY,EAAMjjF,IAAK8iF,EAAW3rF,IAE1E,ECND2pF,EAAoBoC,EAAI,WACvB,GAA0B,kBAAfC,WAAyB,OAAOA,WAC3C,IACC,OAAO9sF,MAAQ,IAAI+sF,SAAS,cAAb,EAChB,CAAE,MAAO31E,GACR,GAAsB,kBAAXzS,OAAqB,OAAOA,MACxC,CACA,CAPuB,GCAxB8lF,EAAoBuC,IAAOnC,KAC1BA,EAASn7E,OAAOtK,OAAOylF,IACXt1E,WAAUs1E,EAAOt1E,SAAW,IACxC7F,OAAOi9E,eAAe9B,EAAQ,UAAW,CACxC+B,YAAY,EACZz4E,IAAK,KACJ,MAAM,IAAI5Q,MAAM,0FAA4FsnF,EAAOhhF,GAAG,IAGjHghF,GCTRJ,EAAoBiC,EAAI,CAACN,EAAKa,IAAUv9E,OAAO8+B,UAAU0+C,eAAelC,KAAKoB,EAAKa,GCClFxC,EAAoBkB,EAAKf,IACH,qBAAXuC,QAA0BA,OAAOC,aAC1C19E,OAAOi9E,eAAe/B,EAASuC,OAAOC,YAAa,CAAErsF,MAAO,WAE7D2O,OAAOi9E,eAAe/B,EAAS,aAAc,CAAE7pF,OAAO,GAAO,ECL9D0pF,EAAoB4C,IAAOxC,IAC1BA,EAAOyC,MAAQ,GACVzC,EAAOt1E,WAAUs1E,EAAOt1E,SAAW,IACjCs1E,GCHRJ,EAAoB8C,EAAI,I,MCKxB,IAAIC,EAAkB,CACrB,IAAK,GAaN/C,EAAoBU,EAAEM,EAAKgC,GAA0C,IAA7BD,EAAgBC,GAGxD,IAAIC,EAAuB,CAACC,EAA4B5qF,KACvD,IAGI2nF,EAAU+C,GAHTrC,EAAUwC,EAAaC,GAAW9qF,EAGhBiQ,EAAI,EAC3B,GAAGo4E,EAAS57D,MAAM3lB,GAAgC,IAAxB2jF,EAAgB3jF,KAAa,CACtD,IAAI6gF,KAAYkD,EACZnD,EAAoBiC,EAAEkB,EAAalD,KACrCD,EAAoBQ,EAAEP,GAAYkD,EAAYlD,IAGhD,GAAGmD,EAAS,IAAIn/E,EAASm/E,EAAQpD,EAClC,CAEA,IADGkD,GAA4BA,EAA2B5qF,GACrDiQ,EAAIo4E,EAASjpF,OAAQ6Q,IACzBy6E,EAAUrC,EAASp4E,GAChBy3E,EAAoBiC,EAAEc,EAAiBC,IAAYD,EAAgBC,IACrED,EAAgBC,GAAS,KAE1BD,EAAgBC,GAAW,EAE5B,OAAOhD,EAAoBU,EAAEz8E,EAAO,EAGjCo/E,EAAqBC,KAAsB,gBAAIA,KAAsB,iBAAK,GAC9ED,EAAmBh7D,QAAQ46D,EAAqBM,KAAK,KAAM,IAC3DF,EAAmBjgD,KAAO6/C,EAAqBM,KAAK,KAAMF,EAAmBjgD,KAAKmgD,KAAKF,G,KC7CvF,IAAIG,EAAsBxD,EAAoBU,OAAEtnF,EAAW,CAAC,MAAM,IAAO4mF,EAAoB,QAC7FwD,EAAsBxD,EAAoBU,EAAE8C,E","sources":["src/utils/logger.ts","src/services/api.ts","src/services/opaqueAuth.ts","src/services/opaqueKeyManager.ts","src/contexts/AuthContext.tsx","src/config/theme.ts","src/contexts/ThemeContext.tsx","src/components/SafeScrollView.tsx","src/utils/LogViewer.tsx","src/components/OpaqueAuthButton.tsx","src/screens/auth/LoginScreen.tsx","src/screens/auth/RegisterScreen.tsx","src/navigation/AuthNavigator.tsx","src/services/audioPrewarmService.ts","src/config/languageConfig.ts","src/services/settingsService.ts","src/services/hapticService.ts","src/components/FloatingActionButton.tsx","src/services/clientEncryption.ts","src/contexts/HiddenModeContext.tsx","src/components/JournalCard.tsx","src/components/ScreenHeader.tsx","src/services/greetingService.ts","src/screens/main/HomeScreen.tsx","src/components/SkeletonLoader.tsx","src/screens/main/JournalScreen.tsx","src/services/crypto/errors.ts","src/services/crypto/OpaqueClient.ts","src/services/VoicePhraseDetector.ts","src/screens/main/CalendarScreen.tsx","src/services/notificationService.ts","src/contexts/SettingsContext.tsx","src/components/settings/SettingsRow.tsx","src/components/settings/SettingsToggle.tsx","src/components/settings/SettingsSelector.tsx","src/components/settings/SettingsSection.tsx","src/screens/main/SettingsScreen.tsx","src/navigation/MainTabNavigator.tsx","src/config/featureFlags.ts","src/services/speechToText.ts","src/hooks/useAudioRecording.ts","src/hooks/useWebSocketTranscription.ts","src/hooks/useAudioRecorderLogic.ts","src/components/BottomSheet.tsx","src/components/LanguageSelector.tsx","src/components/AudioRecorderUI.tsx","src/components/AudioRecorder.tsx","src/components/SecretTagIndicator.tsx","src/services/zeroKnowledgeEncryption.ts","src/services/tagManager.ts","src/services/encryptedJournalService.ts","src/hooks/useJournalEntry.ts","src/screens/main/RecordScreen.tsx","src/components/OpaqueTagIndicator.tsx","src/components/SecretTagSetup.tsx","src/components/RegularTagCreate.tsx","src/components/SecretTagCard.tsx","src/screens/main/TagManagementScreen.tsx","src/services/SessionStorageManager.ts","src/services/OpaqueTagManager.ts","src/screens/main/TagDeleteConfirmationScreen.tsx","src/components/RecentTagsSelector.tsx","src/components/TagInput.tsx","src/screens/main/JournalEntryDetailScreen.tsx","src/screens/main/ReminderFormScreen.tsx","src/screens/main/DeleteConfirmationScreen.tsx","src/navigation/MainNavigator.tsx","src/navigation/index.tsx","App.tsx","webpack/bootstrap","webpack/runtime/chunk loaded","webpack/runtime/compat get default export","webpack/runtime/create fake namespace object","webpack/runtime/define property getters","webpack/runtime/global","webpack/runtime/harmony module decorator","webpack/runtime/hasOwnProperty shorthand","webpack/runtime/make namespace object","webpack/runtime/node module decorator","webpack/runtime/publicPath","webpack/runtime/jsonp chunk loading","webpack/startup"],"sourcesContent":["import * as FileSystem from 'expo-file-system';\nimport Constants from 'expo-constants';\nimport { Platform } from 'react-native';\n\ntype LogLevel = 'debug' | 'info' | 'warn' | 'error';\n\nclass Logger {\n  private logDirectory: string;\n  private logFilePath: string;\n  private isWeb: boolean;\n  private enabled: boolean = true;\n  private isDev: boolean;\n  private debugEnabled: boolean;\n  private suppressedWarnings: Set<string>;\n\n  constructor() {\n    this.isWeb = Platform.OS === 'web';\n    this.logDirectory = this.isWeb ? '' : `${FileSystem.documentDirectory}logs/`;\n    this.logFilePath = this.isWeb ? '' : `${this.logDirectory}app.log`;\n    this.isDev = __DEV__;\n    this.debugEnabled = false; // Default to false, can be enabled via enableDebug()\n    this.suppressedWarnings = new Set([\n      'setNativeProps is deprecated', // Third-party library warning\n    ]);\n    this.initializeLogger();\n  }\n\n  private async initializeLogger() {\n    if (this.isWeb && !this.isDev) {\n      return; // Don't log initialization message in production web\n    }\n\n    if (this.isWeb && this.isDev) {\n      console.log('Logger initialized in web development mode');\n      this.setupConsoleOverrides();\n      return;\n    }\n\n    try {\n      const dirInfo = await FileSystem.getInfoAsync(this.logDirectory);\n      if (!dirInfo.exists) {\n        await FileSystem.makeDirectoryAsync(this.logDirectory, { intermediates: true });\n      }\n      \n      // Create log file if it doesn't exist\n      const fileInfo = await FileSystem.getInfoAsync(this.logFilePath);\n      if (!fileInfo.exists) {\n        await FileSystem.writeAsStringAsync(this.logFilePath, '--- Log Start ---\\n');\n      }\n      \n      // Keep log file size in check\n      const fileStatus = await FileSystem.getInfoAsync(this.logFilePath);\n      if (fileStatus.exists && fileStatus.size > 1024 * 1024) { // 1MB max log size\n        await FileSystem.writeAsStringAsync(this.logFilePath, '--- Log Rotated ---\\n');\n      }\n    } catch (error) {\n      console.error('Failed to initialize logger:', error);\n    }\n  }\n\n  private setupConsoleOverrides() {\n    if (!this.isWeb || !this.isDev) return;\n\n    // Override console.warn to filter out suppressed warnings\n    const originalWarn = console.warn;\n    console.warn = (...args: any[]) => {\n      const message = args.join(' ');\n      \n      // Check if this warning should be suppressed\n      for (const suppressedWarning of this.suppressedWarnings) {\n        if (message.includes(suppressedWarning)) {\n          return; // Suppress this warning\n        }\n      }\n      \n      // Allow the warning through\n      originalWarn.apply(console, args);\n    };\n  }\n\n  private getTimestamp(): string {\n    return new Date().toISOString();\n  }\n\n  private async writeToFile(level: LogLevel, message: string, data?: any) {\n    if (!this.enabled || this.isWeb) return;\n    \n    try {\n      let logEntry = `${this.getTimestamp()} [${level.toUpperCase()}] ${message}`;\n      if (data) {\n        logEntry += ` ${JSON.stringify(data, null, 2)}`;\n      }\n      logEntry += '\\n';\n      \n      await FileSystem.writeAsStringAsync(this.logFilePath, logEntry, { \n        encoding: FileSystem.EncodingType.UTF8 \n      });\n    } catch (error: unknown) {\n      if (error instanceof Error && (error as any).code === 'UNAVAILABLE' && this.isWeb) {\n        console.warn('Attempted to write log file on web, which is not supported.');\n      } else {\n        console.error('Failed to write to log file:', error);\n      }\n    }\n  }\n\n  private shouldLog(level: LogLevel): boolean {\n    if (!this.enabled) return false;\n    if (level === 'error' || level === 'warn') return true;\n    if (level === 'debug' && !this.debugEnabled) return false;\n    if (!this.isDev) return true;\n    return this.debugEnabled;\n  }\n\n  private shouldSuppressMessage(message: string): boolean {\n    for (const suppressedWarning of this.suppressedWarnings) {\n      if (message.includes(suppressedWarning)) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  public debug(message: string, data?: any) {\n    if (!this.shouldLog('debug')) return;\n    if (data !== undefined) {\n      console.debug(message, data);\n    } else {\n      console.debug(message);\n    }\n    this.writeToFile('debug', message, data);\n  }\n\n  public info(message: string, data?: any) {\n    if (!this.shouldLog('info')) return;\n    if (data !== undefined) {\n      console.info(message, data);\n    } else {\n      console.info(message);\n    }\n    this.writeToFile('info', message, data);\n  }\n\n  public warn(message: string, data?: any) {\n    // Check if this warning should be suppressed\n    if (this.shouldSuppressMessage(message)) {\n      return;\n    }\n\n    if (data !== undefined) {\n      console.warn(message, data);\n    } else {\n      console.warn(message);\n    }\n    this.writeToFile('warn', message, data);\n  }\n\n  public error(message: string, data?: any) {\n    if (data !== undefined) {\n      console.error(message, data);\n    } else {\n      console.error(message);\n    }\n    this.writeToFile('error', message, data);\n  }\n\n  public async getLogs(): Promise<string> {\n    if (this.isWeb) {\n      return 'Log files are not available in the web environment.';\n    }\n    \n    try {\n      return await FileSystem.readAsStringAsync(this.logFilePath);\n    } catch (error) {\n      console.error('Failed to read log file:', error);\n      return `Error reading logs: ${error}`;\n    }\n  }\n\n  public enable() {\n    this.enabled = true;\n  }\n\n  public disable() {\n    this.enabled = false;\n  }\n\n  public enableDebug() {\n    this.debugEnabled = true;\n  }\n\n  public disableDebug() {\n    this.debugEnabled = false;\n  }\n\n  public addSuppressedWarning(warning: string) {\n    this.suppressedWarnings.add(warning);\n  }\n\n  public removeSuppressedWarning(warning: string) {\n    this.suppressedWarnings.delete(warning);\n  }\n}\n\n// Export singleton instance\nexport const logger = new Logger();\nexport default logger; ","import axios from 'axios';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport Constants from 'expo-constants';\nimport { JournalEntryCreate, JournalEntryUpdate, User, Tag } from '../types';\nimport logger from '../utils/logger';\nimport { OPAQUE_AUTH_API_URL } from '../../constants/opaque';\n\nconst getApiUrl = (): string => {\n  const hostname = typeof window !== 'undefined' && window.location.hostname;\n\n  // Always use HTTPS for production domains\n  if (hostname && (hostname === 'app.kotori.io' || hostname === 'kotori.io' || hostname === 'www.kotori.io')) {\n    return 'https://api.kotori.io';\n  }\n  \n  // Check if we're on the Cloud Run URL\n  if (hostname && hostname.includes('run.app')) {\n    return 'https://api.kotori.io';\n  }\n  \n  // For local development, allow environment variable override, but default to localhost\n  return (Constants.expoConfig?.extra?.apiUrl as string | undefined) || 'http://localhost:8001';\n};\n\nexport const getWebSocketUrl = (): string => {\n    const hostname = typeof window !== 'undefined' && window.location.hostname;\n\n    // Always use WSS for production domains\n    if (hostname && (hostname === 'app.kotori.io' || hostname === 'kotori.io' || hostname === 'www.kotori.io')) {\n        return 'wss://api.kotori.io';\n    }\n    \n    // Check if we're on the Cloud Run URL\n    if (hostname && hostname.includes('run.app')) {\n        return 'wss://api.kotori.io';\n    }\n\n    // Local development\n    let apiUrl = getApiUrl();\n    // Replace http with ws for websocket connection\n    return apiUrl.replace(/^http/, 'ws');\n};\n\n\n// Create axios instance - always use HTTPS for production\nconst initialApiUrl = getApiUrl();\nconsole.log('[API] Creating axios instance with initial baseURL:', initialApiUrl);\n\n// Create the axios instance\nexport const api = axios.create({\n  withCredentials: true, // Important for cookies\n  headers: {\n    'Content-Type': 'application/json',\n  },\n  timeout: 10000,\n});\n\n// Set the baseURL dynamically based on the current hostname\nif (typeof window !== 'undefined') {\n  const hostname = window.location.hostname;\n  if (hostname === 'app.kotori.io' || hostname === 'kotori.io' || hostname === 'www.kotori.io' || hostname.includes('run.app')) {\n    api.defaults.baseURL = 'https://api.kotori.io';\n    console.log('[API] Set production baseURL:', api.defaults.baseURL);\n  } else {\n    api.defaults.baseURL = initialApiUrl;\n    console.log('[API] Set development baseURL:', api.defaults.baseURL);\n  }\n} else {\n  api.defaults.baseURL = initialApiUrl;\n}\n\n// Interceptor to always enforce HTTPS for the production API.\n// This is a safety net for any case where the baseURL might be http.\napi.interceptors.request.use((config) => {\n    // Log the request for debugging\n    console.log('[API Interceptor] Request config BEFORE:', {\n      baseURL: config.baseURL,\n      url: config.url,\n      fullURL: config.baseURL ? `${config.baseURL}${config.url}` : config.url\n    });\n    \n    // If we're on a production domain, ALWAYS force HTTPS\n    const hostname = typeof window !== 'undefined' && window.location.hostname;\n    if (hostname && (hostname === 'app.kotori.io' || hostname === 'kotori.io' || hostname === 'www.kotori.io' || hostname.includes('run.app'))) {\n      // Force the baseURL to be HTTPS regardless of what it currently is\n      config.baseURL = 'https://api.kotori.io';\n      console.log('[API Interceptor] Forced baseURL to HTTPS for production domain');\n    }\n    \n    // Aggressively ensure no HTTP URLs slip through anywhere\n    if (config.baseURL && config.baseURL.includes('api.kotori.io')) {\n      config.baseURL = config.baseURL.replace('http://', 'https://');\n    }\n    if (typeof config.url === 'string' && config.url.includes('http://api.kotori.io')) {\n      config.url = config.url.replace('http://', 'https://');\n    }\n    \n    // Additional safety: if the constructed URL would be HTTP, override it completely\n    const constructedUrl = config.baseURL ? `${config.baseURL}${config.url}` : config.url;\n    if (constructedUrl && constructedUrl.startsWith('http://api.kotori.io')) {\n      console.log('[API Interceptor] DETECTED HTTP URL, forcing full HTTPS override');\n      config.baseURL = 'https://api.kotori.io';\n      // Ensure the URL path doesn't contain the full domain\n      if (config.url && config.url.includes('api.kotori.io')) {\n        config.url = config.url.replace(/^https?:\\/\\/[^\\/]+/, '');\n      }\n    }\n    \n    console.log('[API Interceptor] Request config AFTER:', {\n      baseURL: config.baseURL,\n      url: config.url,\n      fullURL: config.baseURL ? `${config.baseURL}${config.url}` : config.url\n    });\n    \n    return config;\n  },\n  (error) => {\n    return Promise.reject(error);\n  }\n);\n\n// Add request interceptor for authorization headers\napi.interceptors.request.use(\n  async (config) => {\n    try {\n      // Get the access token from storage\n      const token = await AsyncStorage.getItem('access_token');\n      \n      // If token exists, add to headers\n      if (token) {\n        config.headers.Authorization = `Bearer ${token}`;\n        logger.debug(`API Request: ${config.method?.toUpperCase()} ${config.url}`);\n      } else {\n        logger.debug(`Unauthenticated API Request: ${config.method?.toUpperCase()} ${config.url}`);\n      }\n      \n      // If sending FormData, remove the default Content-Type header\n      // to let the browser/axios set the correct multipart/form-data with boundary\n      if (config.data instanceof FormData) {\n        delete config.headers['Content-Type'];\n        logger.debug(`Removed Content-Type header for FormData request to ${config.url}`);\n      }\n      \n      return config;\n    } catch (error) {\n      logger.error('API Interceptor Error', error);\n      return config;\n    }\n  },\n  (error) => {\n    logger.error('API Request Error', error);\n    return Promise.reject(error);\n  }\n);\n\n// Add response interceptor for handling token refresh and errors\napi.interceptors.response.use(\n  (response) => {\n    logger.debug(`API Response: ${response.status} ${response.config.method?.toUpperCase()} ${response.config.url}`);\n    return response;\n  },\n  async (error) => {\n    const originalRequest = error.config;\n    \n    // Handle CORS errors\n    if (error.message && (\n        error.message.includes('Network Error') || \n        error.message.includes('CORS') || \n        error.message.includes('blocked by CORS policy'))) {\n      logger.error('CORS or Network Error', { \n        message: error.message,\n        url: originalRequest?.url,\n        method: originalRequest?.method\n      });\n      return Promise.reject({\n        message: 'Network or CORS error. Check that the backend server is running and properly configured.',\n        status: 0,\n        originalError: error.message\n      });\n    }\n    \n    // Handle network errors\n    if (!error.response) {\n      logger.error('Network Error', { \n        url: originalRequest?.url,\n        method: originalRequest?.method\n      });\n      return Promise.reject({\n        message: 'Network error. Please check your connection and try again.',\n        status: 0\n      });\n    }\n    \n    logger.error('API Error Response', {\n      status: error.response?.status,\n      url: originalRequest.url,\n      method: originalRequest.method,\n      data: error.response?.data\n    });\n    \n    // Handle 401 (Unauthorized) errors\n    if (error.response?.status === 401 && !originalRequest._retry) {\n      originalRequest._retry = true;\n      logger.info(`API Response: 401 Unauthorized for ${originalRequest.url}. Checking authentication type.`);\n      \n      try {\n        // Check if we have OPAQUE authentication (no refresh token)\n        const refreshToken = await AsyncStorage.getItem('refresh_token');\n        const accessToken = await AsyncStorage.getItem('access_token');\n        \n        if (!refreshToken && accessToken) {\n          // OPAQUE authentication - no refresh tokens available\n          logger.warn('OPAQUE authentication detected (no refresh token). User needs to re-authenticate.');\n          await logout();\n          return Promise.reject({\n            message: 'Session expired. Please login again.',\n            status: 401\n          });\n        }\n        \n        if (!refreshToken) {\n          // No refresh token available, logout user\n          logger.warn('No refresh token available, logging out user');\n          await logout();\n          return Promise.reject({\n            message: 'Session expired. No refresh token. Please login again.',\n            status: 401\n          });\n        }\n        \n        // Traditional authentication - attempt token refresh\n        logger.info('Attempting token refresh');\n        logger.info(`Calling /api/v1/auth/refresh with refresh token: ${refreshToken ? refreshToken.substring(0, 10) + '...' : 'null'}`);\n        const response = await axios.post(`${getApiUrl()}/api/v1/auth/refresh`, {\n          refresh_token: refreshToken,\n        });\n        \n        if (response.data.access_token) {\n          logger.info('Token refresh successful. New access token received.');\n          // Save new tokens\n          await AsyncStorage.setItem('access_token', response.data.access_token);\n          \n          if (response.data.refresh_token) {\n            await AsyncStorage.setItem('refresh_token', response.data.refresh_token);\n            logger.info('New refresh token also received and stored.');\n          }\n          \n          // Update header for the instance defaults and the original request\n          const newAccessToken = response.data.access_token;\n          api.defaults.headers.common['Authorization'] = `Bearer ${newAccessToken}`;\n          logger.info(`Retrying original request to ${originalRequest.url} with new token.`);\n          \n          // Create a new config for the retry based on the original request\n          const retryConfig = {\n            ...originalRequest,\n            headers: {\n              ...originalRequest.headers,\n              Authorization: `Bearer ${newAccessToken}`,\n            },\n          };\n\n          // Retry the original request using the base axios with the new config\n          return axios(retryConfig);\n        }\n      } catch (refreshError: any) {\n        // If refresh fails, logout user\n        logger.error('Token refresh failed', { \n          message: refreshError.message, \n          status: refreshError.response?.status,\n          data: refreshError.response?.data \n        });\n        await logout();\n        return Promise.reject({\n          message: 'Session expired. Token refresh failed. Please login again.',\n          status: 401,\n          originalError: refreshError.message\n        });\n      }\n    }\n    \n    // Handle validation errors (422 Unprocessable Entity)\n    if (error.response?.status === 422) {\n      const responseData = error.response.data;\n      \n      if (responseData.errors && Array.isArray(responseData.errors)) {\n        logger.warn('Validation Error', {\n          errors: responseData.errors,\n          url: originalRequest.url\n        });\n        return Promise.reject({\n          message: responseData.detail || 'Validation error',\n          errors: responseData.errors,\n          status: 422\n        });\n      }\n    }\n    \n    // Handle database connection errors\n    if (error.response?.status === 500 && \n        error.response?.data?.detail && \n        typeof error.response.data.detail === 'string' &&\n        error.response.data.detail.includes('connection to server')) {\n      logger.error('Database Connection Error', {\n        detail: error.response.data.detail,\n        url: originalRequest.url\n      });\n      return Promise.reject({\n        message: 'Database connection error. Please try again later.',\n        originalError: error.response.data.detail,\n        status: 500\n      });\n    }\n    \n    // Handle other errors with meaningful messages\n    const errorMessage = error.response?.data?.detail || error.response?.data?.message || 'An error occurred. Please try again.';\n    logger.error('API Error', {\n      message: errorMessage,\n      url: originalRequest.url,\n      status: error.response?.status\n    });\n    return Promise.reject({\n      message: errorMessage,\n      status: error.response?.status\n    });\n  }\n);\n\n// Helper function to handle user logout\nconst logout = async () => {\n  try {\n    logger.info('Performing API logout');\n    // Clear tokens from storage\n    await AsyncStorage.removeItem('access_token');\n    await AsyncStorage.removeItem('refresh_token');\n    await AsyncStorage.removeItem('user');\n    \n    // Clear authorization header\n    delete api.defaults.headers.common.Authorization;\n    \n    // You might want to trigger navigation to login screen or auth context update\n    // This would typically be done via an auth context\n  } catch (error) {\n    logger.error('Logout Error', error);\n  }\n};\n\n// API endpoint functions\n\n// Auth - Dual Authentication System (OAuth + OPAQUE)\nexport const AuthAPI = {\n  // Legacy password login - deprecated, use OPAQUE instead\n  login: (email: string, password: string) => \n    api.post('/api/auth/login/json', { email, password }),\n  \n  // Legacy password register - deprecated, use OPAQUE instead  \n  register: (name: string, email: string, password: string) => \n    api.post('/api/auth/register', { name, email, password }),\n  \n  // OAuth Google Authentication (V1)\n  googleAuth: (idToken: string) => \n    api.post('/api/v1/auth/google', { id_token: idToken }),\n  \n  // Logout (V1)\n  logout: () => api.post('/api/v1/auth/logout'),\n};\n\n// User profile\nexport const UserAPI = {\n  // Get current user profile\n  getProfile: () => api.get('/api/users/me'),\n  \n  // Update user profile\n  updateProfile: (data: {\n    full_name?: string;\n    email?: string;\n    avatar_url?: string;\n  }) => api.put('/api/users/me', data),\n  \n  // Update user password\n  updatePassword: (data: {\n    current_password: string;\n    new_password: string;\n  }) => api.put('/api/users/me/password', data),\n  \n  // Upload avatar\n  uploadAvatar: (imageFile: any) => {\n    const formData = new FormData();\n    formData.append('avatar', imageFile);\n    \n    return api.post('/api/users/me/avatar', formData, {\n      headers: {\n        'Content-Type': 'multipart/form-data',\n      },\n    });\n  },\n\n  updateMe: (data: Partial<User>) =>\n    api.put('/api/users/me', data),\n};\n\n// Journal entries\nexport const JournalAPI = {\n  getEntries: (params: any) => \n    api.get('/api/v1/journals/', { params }),\n  \n  getEntry: (id: string) => \n    api.get(`/api/v1/journals/${id}`),\n  \n  // Use trailing slash for POST to avoid 405 due to strict slash matching\n  createEntry: (data: JournalEntryCreate) => \n    api.post('/api/v1/journals/', data),\n\n  // Enhanced method for creating encrypted secret tag entries (legacy secret tags)\n  createEncryptedEntry: (data: {\n    title?: string;\n    encrypted_content: string;    // Base64 encrypted content\n    encrypted_key: string;        // Base64 wrapped entry key\n    iv: string;                   // Base64 IV\n    salt: string;                 // Base64 salt\n    algorithm: string;            // Encryption algorithm\n    wrapIv: string;               // Base64 IV used for key wrapping\n    entry_date?: string;\n    audio_url?: string;\n    tags?: string[];\n    secret_tag_id?: string;       // Secret tag ID\n    secret_tag_hash?: string;     // Secret tag hash for server filtering\n  }) => api.post('/api/journals', {\n    title: data.title || '',\n    content: \"\",  // No plaintext content for secret tag entries\n    encrypted_content: data.encrypted_content,\n    encryption_iv: data.iv,\n    encryption_salt: data.salt,\n    encrypted_key: data.encrypted_key,\n    key_derivation_iterations: 100000,  // Default iterations (legacy)\n    encryption_algorithm: data.algorithm,\n    encryption_wrap_iv: data.wrapIv,\n    entry_date: data.entry_date || new Date().toISOString(),\n    audio_url: data.audio_url,\n    tags: data.tags || [],\n    secret_tag_id: data.secret_tag_id,\n    secret_tag_hash: data.secret_tag_hash,\n  }),\n  \n  updateEntry: (id: string, data: JournalEntryUpdate) => \n    api.put(`/api/v1/journals/${id}`, data),\n  \n  deleteEntry: (id: string) => \n    api.delete(`/api/v1/journals/${id}`),\n  \n  searchEntries: (query: string) => \n    api.get('/api/v1/journals/search', { params: { q: query } }),\n\n  // Get entries by secret tag (for specific tag filtering)\n  getEntriesBySecretTag: (secretTagHash: string, params?: { skip?: number, limit?: number }) =>\n    api.get(`/api/journals/secret-tag/${secretTagHash}`, { params }),\n};\n\n// Reminders\nexport const ReminderAPI = {\n  getReminders: (params?: { page?: number, limit?: number, is_active?: boolean }) => \n    api.get('/api/reminders', { params }),\n  \n  getReminder: (id: string) => \n    api.get(`/api/reminders/${id}`),\n  \n  createReminder: (data: { title: string, note?: string, reminder_time: string, is_active: boolean }) => \n    api.post('/api/reminders', data),\n  \n  updateReminder: (id: string, data: { title?: string, note?: string, reminder_time?: string, is_active?: boolean }) => \n    api.put(`/api/reminders/${id}`, data),\n  \n  deleteReminder: (id: string) => \n    api.delete(`/api/reminders/${id}`),\n};\n\n// Tags\nexport const TagsAPI = {\n  getTags: () => api.get('/api/tags'),\n  \n  getRecentTags: (limit: number = 5) => api.get('/api/tags/recent', { params: { limit } }),\n  \n  getEntriesByTag: (tagName: string) => api.get(`/api/tags/${tagName}/entries`),\n  \n  createTag: async (tag: { name: string; color?: string }) => {\n    const response = await api.post('/api/tags', tag);\n    return response.data;\n  },\n  \n  updateTag: async (id: string, updates: Partial<Tag>) => {\n    const response = await api.put(`/api/tags/${id}`, updates);\n    return response.data;\n  },\n  \n  deleteTag: async (id: string) => {\n    logger.info(`API: Attempting to delete tag with ID: ${id}`);\n    logger.info(`API: DELETE request to: /api/tags/${id}`);\n    const response = await api.delete(`/api/tags/${id}`);\n    logger.info(`API: Delete tag response:`, response.data);\n    return response.data;\n  },\n};\n\n// Audio transcription\nexport const TranscriptionAPI = {\n  transcribeAudio: (audioFile: any) => {\n    // Create form data for file upload\n    const formData = new FormData();\n    formData.append('audio_file', audioFile);\n    \n    return api.post('/api/transcriptions', formData, {\n      headers: {\n        'Content-Type': 'multipart/form-data',\n      },\n    });\n  },\n};\n\nexport const SecretTagAPI = {\n  delete: (tagId: string) => {\n    logger.info(`Sending API request to delete secret tag: ${tagId}`);\n    return api.delete(`/api/v1/secret-tags/${tagId}`);\n  },\n};\n\nexport default {\n  auth: AuthAPI,\n  user: UserAPI,\n  journal: JournalAPI,\n  tags: TagsAPI,\n  transcription: TranscriptionAPI,\n  reminder: ReminderAPI,\n  secretTag: SecretTagAPI,\n};","/**\n * OPAQUE Authentication Service\n * \n * This service handles OPAQUE-based authentication providing zero-knowledge password proof.\n * It works in conjunction with the backend's OPAQUE server implementation.\n */\n\nimport * as opaque from '@serenity-kit/opaque';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { api } from './api';\nimport logger from '../utils/logger';\n\n// Initialize OPAQUE library\nlet opaqueReady = false;\n\nasync function ensureOpaqueReady() {\n  if (!opaqueReady) {\n    if (opaque.ready) {\n      await opaque.ready;\n    }\n    opaqueReady = true;\n    logger.info('OPAQUE library initialized');\n  }\n}\n\n// OPAQUE client types and interfaces\nexport interface OpaqueRegistrationState {\n  clientRegistrationState: string;\n  password: string;\n}\n\nexport interface OpaqueLoginState {\n  clientLoginState: string;\n  password: string;\n}\n\nexport interface OpaqueRegistrationResponse {\n  registrationResponse: string;\n  userIdentifier: string;\n}\n\nexport interface OpaqueLoginResponse {\n  loginResponse: string;\n}\n\nexport interface OpaqueSessionResult {\n  sessionKey: string;\n  exportKey: string;\n  finishLoginRequest: string;\n}\n\nexport interface OpaqueLoginResult {\n  success: boolean;\n  user: {\n    id: string;\n    email: string;\n    full_name: string;\n    is_active: boolean;\n    is_superuser: boolean;\n    created_at: string | null;\n    updated_at: string | null;\n  };\n  token: string;\n  sessionKey: string;\n  exportKey: string;\n}\n\n// Storage keys for OPAQUE data\nconst STORAGE_KEYS = {\n  REGISTRATION_RECORD: 'opaque_registration_record',\n  USER_IDENTIFIER: 'opaque_user_identifier',\n  DEVICE_FINGERPRINT: 'opaque_device_fingerprint',\n  SESSION_DATA: 'opaque_session_data',\n} as const;\n\n/**\n * OPAQUE Authentication Service\n * Provides client-side OPAQUE protocol implementation for zero-knowledge authentication\n */\nexport class OpaqueAuthService {\n  private static instance: OpaqueAuthService;\n\n  private constructor() {}\n\n  public static getInstance(): OpaqueAuthService {\n    if (!OpaqueAuthService.instance) {\n      OpaqueAuthService.instance = new OpaqueAuthService();\n    }\n    return OpaqueAuthService.instance;\n  }\n\n  /**\n   * Start OPAQUE registration process\n   * @param password User's password\n   * @param userIdentifier User identifier (email)\n   * @returns Registration request and client state\n   */\n  public async startRegistration(password: string, userIdentifier: string): Promise<{\n    registrationRequest: string;\n    clientRegistrationState: string;\n  }> {\n    try {\n      await ensureOpaqueReady();\n      logger.info('Starting OPAQUE registration', { userIdentifier });\n\n      // Start registration with OPAQUE client\n      const { clientRegistrationState, registrationRequest } = opaque.client.startRegistration({\n        password,\n      });\n\n      if (!clientRegistrationState || !registrationRequest) {\n        throw new Error('Failed to generate OPAQUE registration request');\n      }\n\n      // Store the client state temporarily for finishing registration\n      await AsyncStorage.setItem(\n        `opaque_registration_state_${userIdentifier}`, \n        JSON.stringify({\n          clientRegistrationState,\n          password,\n          userIdentifier\n        })\n      );\n\n      logger.info('OPAQUE registration started successfully', { \n        registrationRequestLength: registrationRequest.length,\n        clientRegistrationStateLength: clientRegistrationState.length \n      });\n\n      return {\n        registrationRequest,  // Send raw Base64URL to backend\n        clientRegistrationState\n      };\n    } catch (error) {\n      logger.error('OPAQUE registration start failed', error);\n      throw new Error('Failed to start OPAQUE registration');\n    }\n  }\n\n  /**\n   * Complete OPAQUE registration process\n   * @param userIdentifier User identifier\n   * @param registrationResponse Server's registration response\n   * @returns Registration record\n   */\n  public async finishRegistration(\n    userIdentifier: string,\n    registrationResponse: string\n  ): Promise<string> {\n    try {\n      await ensureOpaqueReady();\n      logger.info('Finishing OPAQUE registration', { userIdentifier });\n\n      // Retrieve stored registration state\n      const storedState = await AsyncStorage.getItem(`opaque_registration_state_${userIdentifier}`);\n      if (!storedState) {\n        throw new Error('Registration state not found');\n      }\n\n      const { clientRegistrationState, password } = JSON.parse(storedState);\n\n      // Add detailed logging for debugging\n      logger.info('Retrieved stored registration state', { \n        userIdentifier,\n        clientRegistrationStateLength: clientRegistrationState?.length,\n        registrationResponseLength: registrationResponse?.length,\n        passwordLength: password?.length\n      });\n\n      // Complete registration\n      const { registrationRecord } = opaque.client.finishRegistration({\n        clientRegistrationState,\n        registrationResponse,\n        password,\n      });\n\n      if (!registrationRecord) {\n        throw new Error('Failed to finish registration');\n      }\n\n      // Clean up stored state\n      await AsyncStorage.removeItem(`opaque_registration_state_${userIdentifier}`);\n\n      logger.info('OPAQUE registration finished successfully', { userIdentifier });\n\n      return registrationRecord;  // Return raw Base64URL to backend\n    } catch (error) {\n      logger.error('Failed to finish OPAQUE registration', { userIdentifier, error });\n      throw new Error(`OPAQUE registration finish failed: ${error}`);\n    }\n  }\n\n  /**\n   * Start OPAQUE login process with user credentials\n   * @param password User's password\n   * @param userIdentifier User identifier (email)\n   * @returns Login request and client state\n   */\n  public async startLogin(password: string, userIdentifier: string): Promise<{\n    loginRequest: string;\n    clientLoginState: string;\n  }> {\n    try {\n      await ensureOpaqueReady();\n      logger.info('Starting OPAQUE login', { userIdentifier });\n\n      // Start login with OPAQUE client\n      const result = opaque.client.startLogin({ password });\n\n      if (!result || !result.clientLoginState || !result.startLoginRequest) {\n        throw new Error('Failed to generate OPAQUE login request');\n      }\n\n      // Store the client state temporarily for finishing login\n      await AsyncStorage.setItem(\n        `opaque_login_state_${userIdentifier}`, \n        JSON.stringify({\n          clientLoginState: result.clientLoginState,\n          password,\n          userIdentifier\n        })\n      );\n\n      logger.info('OPAQUE login started successfully', { \n        startLoginRequestLength: result.startLoginRequest.length,\n        clientLoginStateLength: result.clientLoginState.length \n      });\n      \n      return {\n        loginRequest: result.startLoginRequest,  // Send raw Base64URL to backend\n        clientLoginState: result.clientLoginState\n      };\n    } catch (error) {\n      logger.error('OPAQUE login start failed', error);\n      throw new Error('Failed to start OPAQUE login');\n    }\n  }\n\n  /**\n   * Complete OPAQUE login process and derive session keys\n   * @param userIdentifier User identifier\n   * @param loginResponse Server's login response\n   * @returns Session and export keys\n   */\n  public async finishLogin(\n    userIdentifier: string,\n    loginResponse: string\n  ): Promise<OpaqueSessionResult> {\n    try {\n      await ensureOpaqueReady();\n      logger.info('Finishing OPAQUE login', { userIdentifier });\n\n      // Retrieve stored login state\n      const storedState = await AsyncStorage.getItem(`opaque_login_state_${userIdentifier}`);\n      if (!storedState) {\n        throw new Error('Login state not found');\n      }\n\n      const { clientLoginState, password } = JSON.parse(storedState);\n\n      // Add detailed logging for debugging\n      logger.info('Retrieved stored login state', { \n        userIdentifier,\n        clientLoginStateLength: clientLoginState?.length,\n        loginResponseLength: loginResponse?.length,\n        passwordLength: password?.length\n      });\n\n      // Complete login\n      const loginResult = opaque.client.finishLogin({\n        clientLoginState,\n        loginResponse,\n        password,\n      });\n\n      logger.info('OPAQUE finishLogin result', { \n        userIdentifier,\n        success: loginResult !== null,\n        resultType: typeof loginResult,\n        resultKeys: loginResult ? Object.keys(loginResult) : null\n      });\n\n      if (!loginResult) {\n        throw new Error('Failed to finish login');\n      }\n\n      const { finishLoginRequest, sessionKey, exportKey } = loginResult;\n\n      // Clean up stored state\n      await AsyncStorage.removeItem(`opaque_login_state_${userIdentifier}`);\n\n      logger.info('OPAQUE login finished successfully', { userIdentifier });\n\n      return { \n        sessionKey, \n        exportKey, \n        finishLoginRequest\n      };\n    } catch (error) {\n      logger.error('Failed to finish OPAQUE login', { userIdentifier, error });\n      throw new Error(`OPAQUE login finish failed: ${error}`);\n    }\n  }\n\n  /**\n   * Register user with OPAQUE protocol\n   * @param name User's display name\n   * @param email User's email address\n   * @param password User's password\n   */\n  public async register(name: string, email: string, password: string): Promise<void> {\n    try {\n      logger.info('Starting OPAQUE registration flow', { email });\n\n      // Step 1: Start registration\n      const { registrationRequest } = await this.startRegistration(password, email);\n\n      // Step 2: Send registration request to server\n      const response = await api.post('/api/v1/auth/register/start', {\n        userIdentifier: email,\n        opaque_registration_request: registrationRequest,\n        name\n      });\n\n      const { opaque_registration_response: registrationResponse } = response.data;\n\n      // Step 3: Finish registration\n      const registrationRecord = await this.finishRegistration(email, registrationResponse);\n\n      // Step 4: Send registration record to server\n      await api.post('/api/v1/auth/register/finish', {\n        session_id: response.data.session_id,\n        userIdentifier: email,\n        opaque_registration_record: registrationRecord\n      });\n\n      logger.info('Registration record sent to server', { \n        email, \n        registrationRecordLength: registrationRecord.length,\n        registrationRecordSample: registrationRecord.substring(0, 50) + '...'\n      });\n\n      logger.info('OPAQUE registration flow completed successfully');\n    } catch (error) {\n      logger.error('OPAQUE registration flow failed', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Login user with OPAQUE protocol\n   * @param email User's email address\n   * @param password User's password\n   * @returns Complete login result with JWT token and session keys\n   */\n  public async login(email: string, password: string): Promise<OpaqueLoginResult> {\n    try {\n      logger.info('Starting OPAQUE login', { email });\n\n      // Start login process\n      const startResult = await this.startLogin(password, email);\n      const loginResponse = await api.post('/api/v1/auth/login/start', {\n        userIdentifier: email,\n        client_credential_request: startResult.loginRequest,\n      });\n\n      if (!loginResponse.data?.server_credential_response) {\n        throw new Error('Invalid login response from server');\n      }\n\n      // Finish login process\n      const sessionResult = await this.finishLogin(email, loginResponse.data.server_credential_response);\n      \n      // Send finish login request to server\n      const finishResponse = await api.post('/api/v1/auth/login/finish', {\n        session_id: loginResponse.data.session_id,\n        userIdentifier: email,\n        client_credential_finalization: sessionResult.finishLoginRequest,\n      });\n\n      if (!finishResponse.data?.access_token) {\n        throw new Error('Invalid finish login response from server');\n      }\n\n      logger.info('OPAQUE login completed successfully', { email });\n\n      return {\n        success: true,\n        user: finishResponse.data.user,\n        token: finishResponse.data.access_token,\n        sessionKey: sessionResult.sessionKey,\n        exportKey: sessionResult.exportKey,\n      };\n    } catch (error) {\n      logger.error('OPAQUE login failed', { email, error });\n      throw error;\n    }\n  }\n\n  /**\n   * Check if user has OPAQUE registration record stored locally\n   * @returns True if registration record exists\n   */\n  public async hasRegistrationRecord(): Promise<boolean> {\n    try {\n      const record = await AsyncStorage.getItem(STORAGE_KEYS.REGISTRATION_RECORD);\n      return record !== null;\n    } catch (error) {\n      logger.error('Failed to check registration record', error);\n      return false;\n    }\n  }\n\n  /**\n   * Get stored user identifier\n   * @returns User identifier or null if not found\n   */\n  public async getUserIdentifier(): Promise<string | null> {\n    try {\n      return await AsyncStorage.getItem(STORAGE_KEYS.USER_IDENTIFIER);\n    } catch (error) {\n      logger.error('Failed to get user identifier', error);\n      return null;\n    }\n  }\n\n  /**\n   * Clear all OPAQUE data from storage\n   */\n  public async clearOpaqueData(): Promise<void> {\n    try {\n      await AsyncStorage.multiRemove([\n        STORAGE_KEYS.REGISTRATION_RECORD,\n        STORAGE_KEYS.USER_IDENTIFIER\n      ]);\n\n      // Also clear any temporary states\n      const keys = await AsyncStorage.getAllKeys();\n      const tempKeys = keys.filter(key => \n        key.startsWith('opaque_reg_state_') || \n        key.startsWith('opaque_login_state_')\n      );\n      \n      if (tempKeys.length > 0) {\n        await AsyncStorage.multiRemove(tempKeys);\n      }\n\n      logger.info('OPAQUE data cleared successfully');\n    } catch (error) {\n      logger.error('Failed to clear OPAQUE data', error);\n    }\n  }\n}\n\n// Export singleton instance\nexport const opaqueAuth = OpaqueAuthService.getInstance(); ","import { OpaqueSessionResult } from './opaqueAuth';\nimport logger from '../utils/logger';\n\n// Key derivation constants (must match backend)\nconst KEY_DERIVATION_INFO = {\n  TAG_ID_KEY: 'TagID',\n  ENCRYPTION_KEY: 'Encryption',\n  VAULT_KEY: 'VaultKey'\n} as const;\n\n/**\n * Derives cryptographic keys from OPAQUE export key using HKDF\n * This integrates with the backend key derivation system\n */\nexport class OpaqueKeyManager {\n  private sessionKey: Uint8Array | null = null;\n  private exportKey: Uint8Array | null = null;\n  private derivedKeys: Map<string, Uint8Array> = new Map();\n\n  private decodeBase64ToBytes(data: string): Uint8Array {\n    // Accept both base64 and base64url encodings\n    const normalized = data.replace(/-/g, '+').replace(/_/g, '/');\n    const padLen = normalized.length % 4 === 0 ? 0 : 4 - (normalized.length % 4);\n    const padded = normalized + '='.repeat(padLen);\n    const binary = atob(padded);\n    const bytes = new Uint8Array(binary.length);\n    for (let i = 0; i < binary.length; i++) bytes[i] = binary.charCodeAt(i);\n    return bytes;\n  }\n\n  /**\n   * Initialize the key manager with OPAQUE session result\n   * @param sessionResult Result from successful OPAQUE login\n   */\n  public initialize(sessionResult: OpaqueSessionResult): void {\n    // sessionKey/exportKey may arrive as base64(url)-encoded strings from the OPAQUE client.\n    // Normalize to Uint8Array for WebCrypto.\n    const { sessionKey, exportKey } = sessionResult as unknown as {\n      sessionKey: string | Uint8Array;\n      exportKey: string | Uint8Array;\n    };\n\n    this.sessionKey = typeof sessionKey === 'string' ? this.decodeBase64ToBytes(sessionKey) : sessionKey;\n    this.exportKey = typeof exportKey === 'string' ? this.decodeBase64ToBytes(exportKey) : exportKey;\n    this.derivedKeys.clear();\n    \n    logger.info('OPAQUE key manager initialized', {\n      sessionKeyType: typeof this.sessionKey,\n      sessionKeyConstructor: this.sessionKey?.constructor?.name,\n      exportKeyType: typeof this.exportKey,\n      exportKeyConstructor: this.exportKey?.constructor?.name\n    });\n  }\n\n  /**\n   * Derive TagID key for deterministic tag generation\n   * @param salt Optional salt for key derivation\n   * @returns TagID key as Uint8Array\n   */\n  public async deriveTagIdKey(salt?: Uint8Array): Promise<Uint8Array> {\n    if (!this.exportKey) {\n      throw new Error('OPAQUE key manager not initialized');\n    }\n\n    const cacheKey = `tagid_${salt ? Array.from(salt).join(',') : 'default'}`;\n    \n    if (this.derivedKeys.has(cacheKey)) {\n      return this.derivedKeys.get(cacheKey)!;\n    }\n\n    try {\n      const tagIdKey = await this.deriveKey(\n        this.exportKey,\n        KEY_DERIVATION_INFO.TAG_ID_KEY,\n        32, // 256-bit key\n        salt\n      );\n\n      this.derivedKeys.set(cacheKey, tagIdKey);\n      logger.debug('TagID key derived successfully');\n      return tagIdKey;\n    } catch (error) {\n      logger.error('Failed to derive TagID key', error);\n      throw new Error('TagID key derivation failed');\n    }\n  }\n\n  /**\n   * Derive encryption key for vault data protection\n   * @param salt Optional salt for key derivation\n   * @returns Encryption key as Uint8Array\n   */\n  public async deriveEncryptionKey(salt?: Uint8Array): Promise<Uint8Array> {\n    if (!this.exportKey) {\n      throw new Error('OPAQUE key manager not initialized');\n    }\n\n    const cacheKey = `encryption_${salt ? Array.from(salt).join(',') : 'default'}`;\n    \n    if (this.derivedKeys.has(cacheKey)) {\n      return this.derivedKeys.get(cacheKey)!;\n    }\n\n    try {\n      const encryptionKey = await this.deriveKey(\n        this.exportKey,\n        KEY_DERIVATION_INFO.ENCRYPTION_KEY,\n        32, // 256-bit key for AES-256\n        salt\n      );\n\n      this.derivedKeys.set(cacheKey, encryptionKey);\n      logger.debug('Encryption key derived successfully');\n      return encryptionKey;\n    } catch (error) {\n      logger.error('Failed to derive encryption key', error);\n      throw new Error('Encryption key derivation failed');\n    }\n  }\n\n  /**\n   * Derive vault key for journal data encryption\n   * @param salt Optional salt for key derivation\n   * @returns Vault key as Uint8Array\n   */\n  public async deriveVaultKey(salt?: Uint8Array): Promise<Uint8Array> {\n    if (!this.exportKey) {\n      throw new Error('OPAQUE key manager not initialized');\n    }\n\n    const cacheKey = `vault_${salt ? Array.from(salt).join(',') : 'default'}`;\n    \n    if (this.derivedKeys.has(cacheKey)) {\n      return this.derivedKeys.get(cacheKey)!;\n    }\n\n    try {\n      const vaultKey = await this.deriveKey(\n        this.exportKey,\n        KEY_DERIVATION_INFO.VAULT_KEY,\n        32, // 256-bit key\n        salt\n      );\n\n      this.derivedKeys.set(cacheKey, vaultKey);\n      logger.debug('Vault key derived successfully');\n      return vaultKey;\n    } catch (error) {\n      logger.error('Failed to derive vault key', error);\n      throw new Error('Vault key derivation failed');\n    }\n  }\n\n  /**\n   * Get the session key for API authentication\n   * @returns Session key as Uint8Array\n   */\n  public getSessionKey(): Uint8Array {\n    if (!this.sessionKey) {\n      throw new Error('OPAQUE key manager not initialized');\n    }\n    return this.sessionKey;\n  }\n\n  /**\n   * Get the export key for additional key derivation\n   * @returns Export key as Uint8Array\n   */\n  public getExportKey(): Uint8Array {\n    if (!this.exportKey) {\n      throw new Error('OPAQUE key manager not initialized');\n    }\n    return this.exportKey;\n  }\n\n  /**\n   * Check if the key manager is initialized\n   * @returns True if initialized with valid keys\n   */\n  public isInitialized(): boolean {\n    return this.sessionKey !== null && this.exportKey !== null;\n  }\n\n  /**\n   * Clear all derived keys and session data\n   */\n  public clear(): void {\n    // Securely zero out keys if possible\n    if (this.sessionKey) {\n      // Check if it's a Uint8Array before calling fill\n      if (this.sessionKey instanceof Uint8Array) {\n        this.sessionKey.fill(0);\n      }\n      this.sessionKey = null;\n    }\n    \n    if (this.exportKey) {\n      // Check if it's a Uint8Array before calling fill\n      if (this.exportKey instanceof Uint8Array) {\n        this.exportKey.fill(0);\n      }\n      this.exportKey = null;\n    }\n\n    // Clear derived keys\n    for (const key of this.derivedKeys.values()) {\n      if (key instanceof Uint8Array) {\n        key.fill(0);\n      }\n    }\n    this.derivedKeys.clear();\n\n    logger.info('OPAQUE key manager cleared');\n  }\n\n  /**\n   * Internal HKDF key derivation function\n   * Uses Web Crypto API for HKDF-SHA256\n   */\n  private async deriveKey(\n    ikm: Uint8Array,\n    info: string,\n    length: number,\n    salt?: Uint8Array\n  ): Promise<Uint8Array> {\n    try {\n      // Import the input key material\n      const key = await crypto.subtle.importKey(\n        'raw',\n        ikm,\n        'HKDF',\n        false,\n        ['deriveKey', 'deriveBits']\n      );\n\n      // Derive the key using HKDF-SHA256\n      const derivedBits = await crypto.subtle.deriveBits(\n        {\n          name: 'HKDF',\n          hash: 'SHA-256',\n          salt: salt || new Uint8Array(32), // Default to 32-byte zero salt\n          info: new TextEncoder().encode(info)\n        },\n        key,\n        length * 8 // Convert bytes to bits\n      );\n\n      return new Uint8Array(derivedBits);\n    } catch (error) {\n      logger.error('HKDF key derivation failed', error);\n      throw new Error('Key derivation failed');\n    }\n  }\n}\n\n// Export singleton instance\nexport const opaqueKeyManager = new OpaqueKeyManager(); ","import React, { createContext, useState, useContext, useEffect, ReactNode } from 'react';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\n\nimport { api } from '../services/api';\nimport { User } from '../types';\nimport logger from '../utils/logger';\nimport { opaqueAuth, OpaqueSessionResult, OpaqueLoginResult } from '../services/opaqueAuth';\nimport { opaqueKeyManager } from '../services/opaqueKeyManager';\n\n// OPAQUE-only Authentication Context\ninterface AuthContextType {\n  isAuthenticated: boolean;\n  isLoading: boolean;\n  isInitialLoading: boolean;\n  user: User | null;\n  logout: () => Promise<void>;\n  updateUser: (updatedUserData: Partial<User>) => Promise<void>;\n  // OPAQUE zero-knowledge authentication methods\n  opaqueLogin: (email: string, password: string) => Promise<void>;\n  opaqueRegister: (name: string, email: string, password: string) => Promise<void>;\n  hasOpaqueSupport: () => Promise<boolean>;\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\n\ninterface AuthProviderProps {\n  children: ReactNode;\n}\n\nexport const AuthProvider: React.FC<AuthProviderProps> = ({ children }) => {\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [isLoading, setIsLoading] = useState(true);\n  const [isInitialLoading, setIsInitialLoading] = useState(true);\n  const [user, setUser] = useState<User | null>(null);\n  \n  // Check for existing OPAQUE session on startup\n  useEffect(() => {\n    const checkAuthStatus = async () => {\n      try {\n        logger.info('Checking OPAQUE authentication status');\n        \n        const token = await AsyncStorage.getItem('access_token');\n        const storedUser = await AsyncStorage.getItem('user');\n        const storedSessionKey = await AsyncStorage.getItem('opaque_session_key');\n        const storedExportKey = await AsyncStorage.getItem('opaque_export_key');\n        \n        if (token) {\n          logger.info('OPAQUE session token found. Verifying...');\n          // Set authorization header for API requests\n          api.defaults.headers.common.Authorization = `Bearer ${token}`;\n          // Mark as authenticated\n          setIsAuthenticated(true);\n          \n          if (storedUser) {\n            try {\n              const userData = JSON.parse(storedUser);\n              setUser(userData);\n              logger.info('Loaded user data from OPAQUE session:', { userId: userData.id });\n            } catch (parseError) {\n              logger.error('Failed to parse stored user data', parseError);\n              setUser(null);\n            }\n          } else {\n             setUser(null);\n          }\n\n          // Rehydrate OPAQUE keys if available (to enable per-user encryption after refresh)\n          try {\n            if (storedSessionKey && storedExportKey) {\n              opaqueKeyManager.initialize({\n                sessionKey: storedSessionKey,\n                exportKey: storedExportKey,\n                finishLoginRequest: ''\n              } as unknown as OpaqueSessionResult);\n              logger.info('OPAQUE key manager rehydrated from storage');\n            } else {\n              logger.warn('OPAQUE keys not found in storage; per-user encryption will require re-login');\n            }\n          } catch (rehydrateError) {\n            logger.error('Failed to rehydrate OPAQUE keys', rehydrateError);\n            opaqueKeyManager.clear();\n          }\n          \n        } else {\n          // No token found, ensure logged out state\n          setIsAuthenticated(false);\n          setUser(null);\n          delete api.defaults.headers.common.Authorization;\n          logger.info('No OPAQUE session token found');\n        }\n      } catch (error) {\n        logger.error('OPAQUE authentication check failed:', error);\n        // Clear tokens on error\n        try {\n          await AsyncStorage.removeItem('access_token');\n          await AsyncStorage.removeItem('refresh_token');\n          await AsyncStorage.removeItem('user');\n          delete api.defaults.headers.common.Authorization;\n          await opaqueAuth.clearOpaqueData();\n          opaqueKeyManager.clear();\n        } catch (e) {\n          logger.error('Failed to clear auth data:', e);\n        }\n      } finally {\n        setIsLoading(false);\n        setIsInitialLoading(false);\n      }\n    };\n\n    checkAuthStatus();\n  }, []);\n\n  // Logout - Clear all OPAQUE data\n  const logout = async () => {\n    try {\n      logger.info('Logging out OPAQUE user', { userId: user?.id });\n      setIsLoading(true);\n      \n      // Clear all authentication data from storage\n      await AsyncStorage.removeItem('access_token');\n      await AsyncStorage.removeItem('refresh_token');\n      await AsyncStorage.removeItem('user');\n      \n      // Clear OPAQUE data\n      await opaqueAuth.clearOpaqueData();\n      opaqueKeyManager.clear();\n      \n      // Clear API authorization header\n      delete api.defaults.headers.common.Authorization;\n      logger.info('API authorization header cleared');\n      \n      setUser(null);\n      setIsAuthenticated(false);\n      logger.info('OPAQUE logout successful - all auth data cleared');\n    } catch (error: any) {\n      logger.error('OPAQUE logout failed:', { \n        userId: user?.id,\n        status: error.status,\n        message: error.message\n      });\n      \n      // Even if server logout fails, remove all auth data\n      await AsyncStorage.removeItem('access_token');\n      await AsyncStorage.removeItem('refresh_token');\n      await AsyncStorage.removeItem('user');\n      \n      // Clear OPAQUE data\n      await opaqueAuth.clearOpaqueData();\n      opaqueKeyManager.clear();\n      \n      // Clear API authorization header\n      delete api.defaults.headers.common.Authorization;\n      \n      setUser(null);\n      setIsAuthenticated(false);\n      logger.info('OPAQUE logout successful - all auth data cleared (fallback)');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // Function to update local user state and storage\n  const updateUser = async (updatedUserData: Partial<User>) => {\n    if (!user) return; // Only update if a user is currently logged in\n    \n    try {\n      const newUser = { ...user, ...updatedUserData };\n      setUser(newUser);\n      // Update user data in storage as well\n      await AsyncStorage.setItem('user', JSON.stringify(newUser));\n      logger.info('Local user state updated', newUser);\n    } catch (error) {\n      logger.error('Failed to update local user state or storage', error);\n    }\n  };\n\n  // OPAQUE login with zero-knowledge authentication\n  const opaqueLogin = async (email: string, password: string) => {\n    try {\n      logger.info(`OPAQUE login attempt for ${email}`);\n      setIsLoading(true);\n      \n      // Perform OPAQUE authentication - this now returns the login response with JWT token\n      const loginResponse: OpaqueLoginResult = await opaqueAuth.login(email, password);\n      \n      // Initialize key manager with OPAQUE session keys for per-user encryption\n      // Note: We don't need the finishLoginRequest here as it's already been used\n      opaqueKeyManager.initialize({\n        sessionKey: loginResponse.sessionKey,\n        exportKey: loginResponse.exportKey,\n        finishLoginRequest: '' // Not needed for key manager initialization\n      });\n      // Persist keys for session rehydration (web dev convenience)\n      await AsyncStorage.setItem('opaque_session_key', loginResponse.sessionKey);\n      await AsyncStorage.setItem('opaque_export_key', loginResponse.exportKey);\n      \n      // Use JWT token for API authentication\n      api.defaults.headers.common.Authorization = `Bearer ${loginResponse.token}`;\n      \n      logger.info('OPAQUE login successful', { userId: loginResponse.user.id });\n      \n      // Ensure user data has proper date fields (convert null to empty string if needed)\n      const userData = {\n        ...loginResponse.user,\n        created_at: loginResponse.user.created_at || new Date().toISOString(),\n        updated_at: loginResponse.user.updated_at || new Date().toISOString()\n      };\n      \n      // Store JWT token and user data\n      await AsyncStorage.setItem('access_token', loginResponse.token);\n      await AsyncStorage.setItem('user', JSON.stringify(userData));\n      \n      setUser(userData);\n      setIsAuthenticated(true);\n    } catch (error: any) {\n      logger.error('OPAQUE login failed:', { \n        email,\n        status: error.status,\n        message: error.message,\n        response: error.response?.data\n      });\n      // Clear key manager on failure\n      opaqueKeyManager.clear();\n      throw error;\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // OPAQUE registration with zero-knowledge authentication\n  const opaqueRegister = async (name: string, email: string, password: string) => {\n    try {\n      logger.info(`OPAQUE registration attempt for ${email}`);\n      setIsLoading(true);\n      \n      // Perform OPAQUE registration only - don't auto-login\n      await opaqueAuth.register(name, email, password);\n      \n      logger.info('OPAQUE registration successful');\n    } catch (error: any) {\n      logger.error('OPAQUE registration failed:', { \n        email,\n        status: error.status,\n        message: error.message,\n        response: error.response?.data\n      });\n      throw error;\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // Check if OPAQUE is supported and available\n  const hasOpaqueSupport = async (): Promise<boolean> => {\n    try {\n      // OPAQUE is always available in V1 dual authentication system\n      // Check if server is healthy instead\n      const response = await api.get('/api/v1/auth/health');\n      return response.status >= 200 && response.status < 300;\n    } catch (error) {\n      logger.warn('OPAQUE support check failed, assuming not supported', error);\n      return false;\n    }\n  };\n\n  const value = {\n    isAuthenticated,\n    isLoading,\n    isInitialLoading,\n    user,\n    logout,\n    updateUser,\n    opaqueLogin,\n    opaqueRegister,\n    hasOpaqueSupport,\n  };\n\n  return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>;\n};\n\nexport const useAuth = (): AuthContextType => {\n  const context = useContext(AuthContext);\n  if (context === undefined) {\n    throw new Error('useAuth must be used within an AuthProvider');\n  }\n  return context;\n};\n\nexport default AuthContext;","import { Platform } from 'react-native';\n\nexport interface AppColors {\n  primary: string;\n  primaryLight: string;\n  primaryDark: string;\n  secondary: string;\n  secondaryLight: string;\n  background: string;\n  surface: string;\n  card: string;\n  text: string;\n  textSecondary: string;\n  textDisabled: string;\n  border: string;\n  borderLight: string;\n  notification: string;\n  error: string;\n  errorLight: string;\n  success: string;\n  successLight: string;\n  warning: string;\n  warningLight: string;\n  disabled: string;\n  inputBackground: string;\n  statusBar: 'auto' | 'dark-content' | 'light-content';\n  tabBarActive: string;\n  tabBarInactive: string;\n  shadow: string;\n  onPrimary: string;\n  onSurface: string;\n  overlay: string;\n  // Semantic colors for better UX\n  accent: string;\n  accentLight: string;\n  // Grayscale\n  black: string;\n  white: string;\n  gray50: string;\n  gray100: string;\n  gray200: string;\n  gray300: string;\n  gray400: string;\n  gray500: string;\n  gray600: string;\n  gray700: string;\n  gray800: string;\n  gray900: string;\n  // Skeleton colors\n  skeleton: string;\n  skeletonHighlight: string;\n}\n\nexport interface AppTypography {\n  fontFamilies: {\n    regular: string;\n    medium: string;\n    semiBold: string;\n    bold: string;\n    light: string;\n  };\n  fontSizes: {\n    xs: number; // 12\n    sm: number; // 14\n    md: number; // 16 (base)\n    lg: number; // 18\n    xl: number; // 20\n    xxl: number; // 24\n    xxxl: number; // 30\n    display: number; // 36\n  };\n  lineHeights: {\n    tight: number; // 1.25\n    normal: number; // 1.5\n    loose: number; // 1.75\n  };\n  letterSpacing: {\n    tight: number;\n    normal: number;\n    wide: number;\n  };\n}\n\nexport interface AppSpacing {\n  none: number; // 0\n  xs: number;   // 4\n  sm: number;   // 8\n  md: number;   // 16 (base)\n  lg: number;   // 24\n  xl: number;   // 32\n  xxl: number;  // 48\n  xxxl: number; // 64\n}\n\nexport interface AppBorderRadius {\n  none: number;\n  sm: number;   // 4\n  md: number;   // 8\n  lg: number;   // 12\n  xl: number;   // 16\n  xxl: number;  // 24\n  full: number; // 9999\n}\n\nexport interface AppShadows {\n  none: object;\n  sm: object;\n  md: object;\n  lg: object;\n  xl: object;\n}\n\nexport interface AppAnimations {\n  duration: {\n    fast: number;\n    normal: number;\n    slow: number;\n  };\n  easing: {\n    ease: string;\n    easeIn: string;\n    easeOut: string;\n    easeInOut: string;\n  };\n}\n\nexport interface AppTheme {\n  colors: AppColors;\n  typography: AppTypography;\n  spacing: AppSpacing;\n  borderRadius: AppBorderRadius;\n  shadows: AppShadows;\n  animations: AppAnimations;\n  isDarkMode: boolean;\n}\n\n// Enhanced Light Theme with modern color palette\nexport const lightModeColors: AppColors = {\n  primary: '#6366F1', // Modern indigo\n  primaryLight: '#A5B4FC',\n  primaryDark: '#4338CA',\n  secondary: '#06B6D4', // Cyan\n  secondaryLight: '#67E8F9',\n  background: '#FAFAFA',\n  surface: '#FFFFFF',\n  card: '#FFFFFF',\n  text: '#111827',\n  textSecondary: '#6B7280',\n  textDisabled: '#9CA3AF',\n  border: '#E5E7EB',\n  borderLight: '#F3F4F6',\n  notification: '#EF4444',\n  error: '#EF4444',\n  errorLight: '#FEE2E2',\n  success: '#10B981',\n  successLight: '#D1FAE5',\n  warning: '#F59E0B',\n  warningLight: '#FEF3C7',\n  disabled: '#D1D5DB',\n  inputBackground: '#FFFFFF',\n  statusBar: 'dark-content',\n  shadow: 'rgba(0, 0, 0, 0.1)',\n  onPrimary: '#FFFFFF',\n  onSurface: '#111827',\n  overlay: 'rgba(0, 0, 0, 0.5)',\n  accent: '#8B5CF6', // Purple accent\n  accentLight: '#DDD6FE',\n  tabBarActive: '#6366F1',\n  tabBarInactive: '#9CA3AF',\n\n  black: '#000000',\n  white: '#FFFFFF',\n  gray50: '#F9FAFB',\n  gray100: '#F3F4F6',\n  gray200: '#E5E7EB',\n  gray300: '#D1D5DB',\n  gray400: '#9CA3AF',\n  gray500: '#6B7280',\n  gray600: '#4B5563',\n  gray700: '#374151',\n  gray800: '#1F2937',\n  gray900: '#111827',\n  // Skeleton colors\n  skeleton: '#E5E7EB',\n  skeletonHighlight: '#F3F4F6',\n};\n\n// Enhanced Dark Theme\nexport const darkModeColors: AppColors = {\n  primary: '#818CF8', // Lighter indigo for dark mode\n  primaryLight: '#C7D2FE',\n  primaryDark: '#6366F1',\n  secondary: '#22D3EE',\n  secondaryLight: '#7DD3FC',\n  background: '#0F172A',\n  surface: '#1E293B',\n  card: '#1E293B',\n  text: '#F1F5F9',\n  textSecondary: '#94A3B8',\n  textDisabled: '#64748B',\n  border: '#334155',\n  borderLight: '#475569',\n  notification: '#F87171',\n  error: '#F87171',\n  errorLight: '#450A0A',\n  success: '#34D399',\n  successLight: '#064E3B',\n  warning: '#FBBF24',\n  warningLight: '#451A03',\n  disabled: '#475569',\n  inputBackground: '#334155',\n  statusBar: 'light-content',\n  shadow: 'rgba(0, 0, 0, 0.3)',\n  onPrimary: '#0F172A',\n  onSurface: '#F1F5F9',\n  overlay: 'rgba(0, 0, 0, 0.7)',\n  accent: '#A78BFA',\n  accentLight: '#312E81',\n  tabBarActive: '#818CF8',\n  tabBarInactive: '#64748B',\n\n  black: '#000000',\n  white: '#FFFFFF',\n  gray50: '#1E293B',\n  gray100: '#334155',\n  gray200: '#475569',\n  gray300: '#64748B',\n  gray400: '#94A3B8',\n  gray500: '#CBD5E1',\n  gray600: '#E2E8F0',\n  gray700: '#F1F5F9',\n  gray800: '#F8FAFC',\n  gray900: '#FFFFFF',\n  // Skeleton colors\n  skeleton: '#334155',\n  skeletonHighlight: '#475569',\n};\n\nexport const typography: AppTypography = {\n  fontFamilies: {\n    regular: Platform.OS === 'ios' ? 'SF Pro Text' : 'Roboto',\n    medium: Platform.OS === 'ios' ? 'SF Pro Text Medium' : 'Roboto Medium',\n    semiBold: Platform.OS === 'ios' ? 'SF Pro Text Semibold' : 'Roboto Medium',\n    bold: Platform.OS === 'ios' ? 'SF Pro Text Bold' : 'Roboto Bold',\n    light: Platform.OS === 'ios' ? 'SF Pro Text Light' : 'Roboto Light',\n  },\n  fontSizes: {\n    xs: 12,\n    sm: 14,\n    md: 16,\n    lg: 18,\n    xl: 20,\n    xxl: 24,\n    xxxl: 30,\n    display: 36,\n  },\n  lineHeights: {\n    tight: 1.25,\n    normal: 1.5,\n    loose: 1.75,\n  },\n  letterSpacing: {\n    tight: -0.025,\n    normal: 0,\n    wide: 0.025,\n  },\n};\n\nexport const spacing: AppSpacing = {\n  none: 0,\n  xs: 4,\n  sm: 8,\n  md: 16,\n  lg: 24,\n  xl: 32,\n  xxl: 48,\n  xxxl: 64,\n};\n\nexport const borderRadius: AppBorderRadius = {\n  none: 0,\n  sm: 4,\n  md: 8,\n  lg: 12,\n  xl: 16,\n  xxl: 24,\n  full: 9999,\n};\n\nexport const shadows: AppShadows = {\n  none: {\n    shadowColor: 'transparent',\n    shadowOffset: { width: 0, height: 0 },\n    shadowOpacity: 0,\n    shadowRadius: 0,\n    elevation: 0,\n  },\n  sm: {\n    shadowColor: '#000',\n    shadowOffset: { width: 0, height: 1 },\n    shadowOpacity: 0.05,\n    shadowRadius: 2,\n    elevation: 2,\n  },\n  md: {\n    shadowColor: '#000',\n    shadowOffset: { width: 0, height: 4 },\n    shadowOpacity: 0.1,\n    shadowRadius: 6,\n    elevation: 4,\n  },\n  lg: {\n    shadowColor: '#000',\n    shadowOffset: { width: 0, height: 10 },\n    shadowOpacity: 0.15,\n    shadowRadius: 15,\n    elevation: 8,\n  },\n  xl: {\n    shadowColor: '#000',\n    shadowOffset: { width: 0, height: 20 },\n    shadowOpacity: 0.25,\n    shadowRadius: 25,\n    elevation: 12,\n  },\n};\n\nexport const animations: AppAnimations = {\n  duration: {\n    fast: 150,\n    normal: 300,\n    slow: 500,\n  },\n  easing: {\n    ease: 'ease',\n    easeIn: 'ease-in',\n    easeOut: 'ease-out',\n    easeInOut: 'ease-in-out',\n  },\n};\n\n// Default theme export\nconst defaultTheme: AppTheme = {\n  colors: lightModeColors,\n  typography,\n  spacing,\n  borderRadius,\n  shadows,\n  animations,\n  isDarkMode: false,\n};\n\nexport default defaultTheme; ","import React, { createContext, useState, useEffect, useContext, ReactNode } from 'react';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { Appearance } from 'react-native';\n\nimport { AppTheme, lightModeColors, darkModeColors, typography, spacing, borderRadius, shadows, animations } from '../config/theme';\n\ninterface ThemeContextProps {\n  theme: AppTheme;\n  toggleTheme: () => void;\n  isSystemTheme: boolean;\n  setUseSystemTheme: (value: boolean) => void;\n}\n\nconst ThemeContext = createContext<ThemeContextProps | undefined>(undefined);\n\ninterface ThemeProviderProps {\n  children: ReactNode;\n}\n\nexport const ThemeProvider: React.FC<ThemeProviderProps> = ({ children }) => {\n  const systemColorScheme = Appearance.getColorScheme(); // 'light' | 'dark' | null\n  const [isDarkMode, setIsDarkMode] = useState(systemColorScheme === 'dark');\n  const [useSystemTheme, setUseSystemThemeState] = useState(true); // Default to using system theme\n\n  useEffect(() => {\n    const loadThemePreference = async () => {\n      try {\n        const savedThemeMode = await AsyncStorage.getItem('themeMode'); // 'light', 'dark', or 'system'\n        if (savedThemeMode) {\n          if (savedThemeMode === 'system') {\n            setUseSystemThemeState(true);\n            setIsDarkMode(systemColorScheme === 'dark');\n          } else {\n            setUseSystemThemeState(false);\n            setIsDarkMode(savedThemeMode === 'dark');\n          }\n        } else {\n          // If no preference saved, default to system theme\n          setUseSystemThemeState(true);\n          setIsDarkMode(systemColorScheme === 'dark');\n        }\n      } catch (error) {\n        console.error('Failed to load theme preference from storage', error);\n        // Fallback to system theme on error\n        setUseSystemThemeState(true);\n        setIsDarkMode(systemColorScheme === 'dark');\n      }\n    };\n    loadThemePreference();\n  }, [systemColorScheme]);\n\n  useEffect(() => {\n    // Listener for system theme changes\n    const subscription = Appearance.addChangeListener(({ colorScheme }) => {\n      if (useSystemTheme) {\n        setIsDarkMode(colorScheme === 'dark');\n      }\n    });\n    return () => subscription.remove();\n  }, [useSystemTheme]);\n\n  const toggleTheme = async () => {\n    const newIsDarkMode = !isDarkMode;\n    setIsDarkMode(newIsDarkMode);\n    setUseSystemThemeState(false); // Manual toggle means not following system theme anymore\n    try {\n      await AsyncStorage.setItem('themeMode', newIsDarkMode ? 'dark' : 'light');\n    } catch (error) {\n      console.error('Failed to save theme mode to storage', error);\n    }\n  };\n\n  const setUseSystemTheme = async (value: boolean) => {\n    setUseSystemThemeState(value);\n    if (value) {\n      setIsDarkMode(systemColorScheme === 'dark');\n      try {\n        await AsyncStorage.setItem('themeMode', 'system');\n      } catch (error) {\n        console.error('Failed to save theme mode (system) to storage', error);\n      }\n    } else {\n      // If switching off system theme, retain current manual theme (light/dark)\n      // The toggleTheme function or an explicit set (light/dark) will handle AsyncStorage for non-system themes\n      // For simplicity, we can re-save current explicit choice if user toggles system off.\n      try {\n        await AsyncStorage.setItem('themeMode', isDarkMode ? 'dark' : 'light');\n      } catch (error) {\n        console.error('Failed to save theme mode (manual) to storage', error);\n      }\n    }\n  };\n  \n  const currentThemeColors = isDarkMode ? darkModeColors : lightModeColors;\n  const theme: AppTheme = {\n    colors: currentThemeColors,\n    typography,\n    spacing,\n    borderRadius,\n    shadows,\n    animations,\n    isDarkMode,\n  };\n\n  return (\n    <ThemeContext.Provider value={{ theme, toggleTheme, isSystemTheme: useSystemTheme, setUseSystemTheme }}>\n      {children}\n    </ThemeContext.Provider>\n  );\n};\n\nexport const useAppTheme = (): ThemeContextProps => {\n  const context = useContext(ThemeContext);\n  if (!context) {\n    throw new Error('useAppTheme must be used within a ThemeProvider');\n  }\n  return context;\n}; ","import React, { forwardRef } from 'react';\nimport { ScrollView, ScrollViewProps, Platform } from 'react-native';\nimport { useAppTheme } from '../contexts/ThemeContext';\n\ninterface SafeScrollViewProps extends ScrollViewProps {\n  children: React.ReactNode;\n  extraBottomPadding?: number;\n}\n\nconst SafeScrollView = forwardRef<ScrollView, SafeScrollViewProps>(({\n  children,\n  extraBottomPadding = 0,\n  contentContainerStyle,\n  ...props\n}, ref) => {\n  const { theme } = useAppTheme();\n\n  // Calculate safe bottom padding\n  // Tab bar height + FAB height + some extra spacing\n  const tabBarHeight = Platform.OS === 'ios' ? 88 : 75;\n  const fabHeight = 64;\n  const fabBottomMargin = Platform.OS === 'ios' ? 100 : 85;\n  const extraSpacing = theme.spacing.xl;\n  \n  // Use the larger of FAB bottom position or tab bar height, plus extra spacing\n  // Increased padding to ensure content is fully accessible past the floating button\n  const safeBottomPadding = Math.max(fabBottomMargin + fabHeight/2, tabBarHeight) + extraSpacing + extraBottomPadding + 40;\n\n  const safeContentContainerStyle = [\n    {\n      paddingBottom: safeBottomPadding,\n    },\n    contentContainerStyle,\n  ];\n\n  return (\n    <ScrollView\n      ref={ref}\n      {...props}\n      contentContainerStyle={safeContentContainerStyle}\n      showsVerticalScrollIndicator={true}\n      keyboardShouldPersistTaps=\"handled\"\n      scrollEventThrottle={16}\n    >\n      {children}\n    </ScrollView>\n  );\n});\n\nSafeScrollView.displayName = 'SafeScrollView';\n\nexport default SafeScrollView; ","import React, { useState, useEffect } from 'react';\nimport { \n  View, \n  Text, \n  StyleSheet, \n  ScrollView, \n  TouchableOpacity, \n  ActivityIndicator, \n  Modal,\n  SafeAreaView,\n  Platform\n} from 'react-native';\nimport { Ionicons } from '@expo/vector-icons';\nimport Constants from 'expo-constants';\nimport logger from './logger';\n\ninterface LogViewerProps {\n  visible: boolean;\n  onClose: () => void;\n}\n\nconst LogViewer: React.FC<LogViewerProps> = ({ visible, onClose }) => {\n  const [logs, setLogs] = useState<string>('');\n  const [loading, setLoading] = useState<boolean>(true);\n  const [filter, setFilter] = useState<'all' | 'error' | 'warn' | 'info'>('all');\n\n  useEffect(() => {\n    if (visible) {\n      fetchLogs();\n    }\n  }, [visible, filter]);\n\n  const fetchLogs = async () => {\n    setLoading(true);\n    try {\n      const logData = await logger.getLogs();\n      \n      // Apply filters if needed\n      if (filter !== 'all') {\n        const filteredLogs = logData\n          .split('\\n')\n          .filter(line => {\n            const upperFilter = `[${filter.toUpperCase()}]`;\n            return line.includes(upperFilter);\n          })\n          .join('\\n');\n        setLogs(filteredLogs || 'No matching logs found.');\n      } else {\n        setLogs(logData);\n      }\n    } catch (error) {\n      console.error('Error fetching logs:', error);\n      setLogs('Error loading logs. Please try again.');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const clearLogs = async () => {\n    // This is a placeholder - we would implement proper log clearing in the logger\n    setLogs('Logs have been cleared.');\n  };\n\n  const isWeb = Platform.OS === 'web';\n\n  return (\n    <Modal\n      animationType=\"slide\"\n      transparent={false}\n      visible={visible}\n      onRequestClose={onClose}\n    >\n      <SafeAreaView style={styles.container}>\n        <View style={styles.header}>\n          <TouchableOpacity style={styles.closeButton} onPress={onClose}>\n            <Ionicons name=\"close\" size={24} color=\"#333\" />\n          </TouchableOpacity>\n          <Text style={styles.title}>Application Logs</Text>\n          <TouchableOpacity style={styles.refreshButton} onPress={fetchLogs}>\n            <Ionicons name=\"refresh\" size={24} color=\"#333\" />\n          </TouchableOpacity>\n        </View>\n\n        <View style={styles.filterContainer}>\n          <TouchableOpacity \n            style={[styles.filterButton, filter === 'all' && styles.activeFilter]} \n            onPress={() => setFilter('all')}\n          >\n            <Text style={[styles.filterText, filter === 'all' && styles.activeFilterText]}>All</Text>\n          </TouchableOpacity>\n          <TouchableOpacity \n            style={[styles.filterButton, filter === 'error' && styles.activeFilter]} \n            onPress={() => setFilter('error')}\n          >\n            <Text style={[styles.filterText, filter === 'error' && styles.activeFilterText]}>Errors</Text>\n          </TouchableOpacity>\n          <TouchableOpacity \n            style={[styles.filterButton, filter === 'warn' && styles.activeFilter]} \n            onPress={() => setFilter('warn')}\n          >\n            <Text style={[styles.filterText, filter === 'warn' && styles.activeFilterText]}>Warnings</Text>\n          </TouchableOpacity>\n          <TouchableOpacity \n            style={[styles.filterButton, filter === 'info' && styles.activeFilter]} \n            onPress={() => setFilter('info')}\n          >\n            <Text style={[styles.filterText, filter === 'info' && styles.activeFilterText]}>Info</Text>\n          </TouchableOpacity>\n        </View>\n\n        {loading ? (\n          <View style={styles.loadingContainer}>\n            <ActivityIndicator size=\"large\" color=\"#7D4CDB\" />\n            <Text style={styles.loadingText}>Loading logs...</Text>\n          </View>\n        ) : (\n          <ScrollView style={styles.logsContainer}>\n            {isWeb ? (\n              <View>\n                <Text style={styles.webNotice}>\n                  Logs are only available in the developer console on web. \n                  Please check your browser's developer tools.\n                </Text>\n                <Text style={styles.codeBlock}>console.log('View logs here in browser console')</Text>\n              </View>\n            ) : (\n              <Text style={styles.logs}>{logs}</Text>\n            )}\n          </ScrollView>\n        )}\n\n        <View style={styles.footer}>\n          <TouchableOpacity \n            style={styles.clearButton} \n            onPress={clearLogs}\n          >\n            <Text style={styles.clearButtonText}>Clear Logs</Text>\n          </TouchableOpacity>\n        </View>\n      </SafeAreaView>\n    </Modal>\n  );\n};\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: '#f5f5f5',\n    paddingTop: Constants.statusBarHeight,\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    padding: 16,\n    borderBottomWidth: 1,\n    borderBottomColor: '#e0e0e0',\n    backgroundColor: '#fff',\n  },\n  title: {\n    fontSize: 18,\n    fontWeight: 'bold',\n    color: '#333',\n  },\n  closeButton: {\n    padding: 8,\n  },\n  refreshButton: {\n    padding: 8,\n  },\n  filterContainer: {\n    flexDirection: 'row',\n    padding: 8,\n    borderBottomWidth: 1,\n    borderBottomColor: '#e0e0e0',\n    backgroundColor: '#fff',\n  },\n  filterButton: {\n    paddingVertical: 6,\n    paddingHorizontal: 12,\n    borderRadius: 16,\n    marginHorizontal: 4,\n    backgroundColor: '#f0f0f0',\n  },\n  activeFilter: {\n    backgroundColor: '#7D4CDB',\n  },\n  filterText: {\n    fontSize: 14,\n    color: '#666',\n  },\n  activeFilterText: {\n    color: '#fff',\n  },\n  loadingContainer: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  loadingText: {\n    marginTop: 12,\n    fontSize: 16,\n    color: '#666',\n  },\n  logsContainer: {\n    flex: 1,\n    padding: 16,\n    backgroundColor: '#f8f8f8',\n  },\n  logs: {\n    fontFamily: Platform.select({\n      ios: 'Menlo',\n      android: 'monospace',\n      default: 'monospace',\n    }),\n    fontSize: 12,\n    color: '#333',\n  },\n  webNotice: {\n    fontSize: 16,\n    color: '#666',\n    marginBottom: 16,\n    textAlign: 'center',\n  },\n  codeBlock: {\n    fontFamily: 'monospace',\n    fontSize: 14,\n    backgroundColor: '#333',\n    color: '#fff',\n    padding: 16,\n    borderRadius: 8,\n  },\n  footer: {\n    padding: 16,\n    borderTopWidth: 1,\n    borderTopColor: '#e0e0e0',\n    backgroundColor: '#fff',\n  },\n  clearButton: {\n    backgroundColor: '#f44336',\n    borderRadius: 8,\n    padding: 12,\n    alignItems: 'center',\n  },\n  clearButtonText: {\n    color: '#fff',\n    fontWeight: 'bold',\n  },\n});\n\nexport default LogViewer; ","import React, { useState, useEffect } from 'react';\nimport { View, Text, TouchableOpacity, ActivityIndicator, StyleSheet } from 'react-native';\nimport { useAuth } from '../contexts/AuthContext';\nimport { useAppTheme } from '../contexts/ThemeContext';\nimport { AppTheme } from '../config/theme';\nimport logger from '../utils/logger';\n\ninterface OpaqueAuthButtonProps {\n  mode: 'login' | 'register';\n  email: string;\n  password: string;\n  name?: string;\n  confirmPassword?: string;\n  onSuccess?: () => void;\n  onError?: (error: string) => void;\n  disabled?: boolean;\n  style?: any;\n}\n\nconst OpaqueAuthButton: React.FC<OpaqueAuthButtonProps> = ({\n  mode,\n  email,\n  password,\n  name,\n  confirmPassword,\n  onSuccess,\n  onError,\n  disabled = false,\n  style\n}) => {\n  const { \n    opaqueLogin, \n    opaqueRegister, \n    hasOpaqueSupport,\n    isLoading: authLoading \n  } = useAuth();\n  \n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n  \n  const [isLoading, setIsLoading] = useState(false);\n  const [opaqueSupported, setOpaqueSupported] = useState<boolean | null>(null);\n  const [checkingSupport, setCheckingSupport] = useState(true);\n\n  // Check OPAQUE support on component mount\n  useEffect(() => {\n    const checkSupport = async () => {\n      try {\n        setCheckingSupport(true);\n        const supported = await hasOpaqueSupport();\n        setOpaqueSupported(supported);\n        logger.info('Authentication service check completed', { supported });\n      } catch (error) {\n        logger.error('Failed to check authentication service', error);\n        setOpaqueSupported(false);\n      } finally {\n        setCheckingSupport(false);\n      }\n    };\n\n    checkSupport();\n  }, [hasOpaqueSupport]);\n\n  const handleAuth = async () => {\n    // Email validation regex - comprehensive pattern\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n    \n    // Validate required fields with specific messages\n    if (mode === 'register' && !name?.trim()) {\n      onError?.('Please enter your name');\n      return;\n    }\n    if (!email?.trim()) {\n      onError?.('Please enter your email address');\n      return;\n    }\n    \n    // Only apply strict email validation for registration\n    if (mode === 'register') {\n      const trimmedEmail = email.trim();\n      if (!emailRegex.test(trimmedEmail)) {\n        onError?.('Please enter a valid email address (e.g., user@example.com)');\n        return;\n      }\n      \n      // Additional email validation checks for registration\n      if (trimmedEmail.length > 254) {\n        onError?.('Email address is too long');\n        return;\n      }\n      if (trimmedEmail.includes('..')) {\n        onError?.('Email address cannot contain consecutive dots');\n        return;\n      }\n    }\n    if (!password) {\n      onError?.('Please enter a password');\n      return;\n    }\n    if (mode === 'register' && password.length < 8) {\n      onError?.('Password must be at least 8 characters long');\n      return;\n    }\n    if (mode === 'register') {\n      if (password.length > 128) {\n        onError?.('Password is too long (maximum 128 characters)');\n        return;\n      }\n      if (!confirmPassword) {\n        onError?.('Please confirm your password');\n        return;\n      }\n    }\n    if (mode === 'register' && password !== confirmPassword) {\n      onError?.('Passwords do not match');\n      return;\n    }\n\n    if (!opaqueSupported) {\n      onError?.('Authentication service is currently unavailable');\n      return;\n    }\n\n    try {\n      setIsLoading(true);\n      \n      logger.info(`Starting secure ${mode} process`);\n      \n      if (mode === 'login') {\n        await opaqueLogin(email, password);\n      } else {\n        await opaqueRegister(name!, email, password);\n      }\n      \n      onSuccess?.();\n    } catch (error: any) {\n      logger.error(`Secure ${mode} failed:`, error);\n      \n      let errorMsg = `An error occurred during ${mode}. Please try again.`;\n      \n      if (error.status === 401) {\n        errorMsg = 'Invalid email or password. Please try again.';\n      } else if (error.status === 422) {\n        if (error.message && typeof error.message === 'string') {\n          errorMsg = error.message;\n        } else if (error.errors && Array.isArray(error.errors)) {\n          errorMsg = error.errors.join('\\n');\n        }\n      } else if (error.status === 400 && error.message === 'User already exists') {\n        errorMsg = 'An account with this email already exists. Please try signing in instead.';\n      } else if (error.status === 409) {\n        errorMsg = 'An account with this email already exists.';\n      } else if (error.status === 500 && error.message.includes('Database connection error')) {\n        errorMsg = 'Cannot connect to the database. Please make sure the database service is running.';\n      } else if (error.status === 0) {\n        errorMsg = 'Unable to connect to the server. Please check your connection and try again.';\n      } else if (error.message) {\n        errorMsg = error.message;\n      }\n      \n      onError?.(errorMsg);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const isButtonDisabled = disabled || authLoading || isLoading || checkingSupport || !opaqueSupported;\n\n  if (checkingSupport) {\n    return (\n      <View style={[styles.button, styles.checkingButton, style]}>\n        <ActivityIndicator size=\"small\" color={theme.colors.white} />\n        <Text style={styles.buttonText}>Checking Server...</Text>\n      </View>\n    );\n  }\n\n  if (!opaqueSupported) {\n    return (\n      <View style={[styles.button, styles.disabledButton, style]}>\n        <Text style={[styles.buttonText, styles.disabledText]}>Server Unavailable</Text>\n      </View>\n    );\n  }\n\n  return (\n    <TouchableOpacity\n      style={[\n        styles.button,\n        isButtonDisabled ? styles.disabledButton : styles.enabledButton,\n        style\n      ]}\n      onPress={handleAuth}\n      disabled={isButtonDisabled}\n    >\n      {isLoading || authLoading ? (\n        <ActivityIndicator size=\"small\" color={theme.colors.white} />\n      ) : (\n        <Text style={styles.buttonText}>\n          {mode === 'login' ? 'Sign In' : 'Create Account'}\n        </Text>\n      )}\n    </TouchableOpacity>\n  );\n};\n\nconst getStyles = (theme: AppTheme) => StyleSheet.create({\n  button: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    paddingVertical: theme.spacing.md,\n    paddingHorizontal: theme.spacing.lg,\n    borderRadius: theme.borderRadius.lg,\n    minHeight: 56,\n  },\n  enabledButton: {\n    backgroundColor: theme.colors.primary,\n    ...theme.shadows.sm,\n  },\n  disabledButton: {\n    backgroundColor: theme.colors.disabled,\n  },\n  checkingButton: {\n    backgroundColor: theme.colors.warning,\n    ...theme.shadows.sm,\n  },\n  buttonText: {\n    color: theme.colors.white,\n    fontSize: theme.typography.fontSizes.md,\n    fontWeight: '600',\n    fontFamily: theme.typography.fontFamilies.semiBold,\n    marginLeft: theme.spacing.sm,\n  },\n  disabledText: {\n    color: theme.colors.textDisabled,\n  },\n});\n\nexport default OpaqueAuthButton; ","import React, { useState, useEffect } from 'react';\nimport { \n  View, \n  Text, \n  TextInput, \n  TouchableOpacity, \n  StyleSheet, \n  ActivityIndicator,\n  Alert\n} from 'react-native';\nimport { useNavigation } from '@react-navigation/native';\nimport { StackNavigationProp } from '@react-navigation/stack';\nimport { RootStackParamList, MainStackParamList } from '../../navigation/types';\nimport { Ionicons } from '@expo/vector-icons';\nimport { Image } from 'react-native';\nimport * as WebBrowser from 'expo-web-browser';\nimport Constants from 'expo-constants';\n\nimport { useAuth } from '../../contexts/AuthContext';\nimport { useAppTheme } from '../../contexts/ThemeContext';\nimport { AppTheme } from '../../config/theme';\nimport SafeScrollView from '../../components/SafeScrollView';\nimport logger from '../../utils/logger';\nimport LogViewer from '../../utils/LogViewer';\nimport OpaqueAuthButton from '../../components/OpaqueAuthButton';\nimport logo from '../../../assets/logo.png';\n\n// Ensure web browser redirect results are handled\nWebBrowser.maybeCompleteAuthSession();\n\ntype LoginScreenNavigationProp = StackNavigationProp<RootStackParamList>;\n\nconst LoginScreen = () => {\n  const navigation = useNavigation<LoginScreenNavigationProp>();\n  const { isLoading: authLoading } = useAuth();\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n  \n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const [showPassword, setShowPassword] = useState(false);\n  const [errorMessage, setErrorMessage] = useState<string | null>(null);\n  const [showLogViewer, setShowLogViewer] = useState(false);\n  \n  // Check if we're in development mode\n  const isDev = __DEV__;\n  \n  // Clear error message when inputs change\n  useEffect(() => {\n    if (errorMessage) {\n      setErrorMessage(null);\n    }\n  }, [email, password]);\n  \n  const handleGoogleLogin = async () => {\n    setErrorMessage('Google login is not available with OPAQUE zero-knowledge authentication. Please use email/password registration and login.');\n  };\n  \n  const navigateToRegister = () => {\n    navigation.navigate('Auth', { screen: 'Register' });\n  };\n\n  const openLogViewer = () => {\n    setShowLogViewer(true);\n  };\n  \n  return (\n    <View style={styles.container}>\n      <SafeScrollView \n        style={styles.scrollContainer}\n        contentContainerStyle={styles.scrollContent}\n        keyboardShouldPersistTaps=\"handled\"\n        showsVerticalScrollIndicator={false}\n      >\n        {/* Welcome Card */}\n        <View style={styles.welcomeCard}>\n          <View style={styles.logoContainer}>\n            <Image source={logo} style={styles.logo} resizeMode=\"contain\" />\n          </View>\n          <Text style={styles.title}>Kotori</Text>\n          <Text style={styles.subtitle}>Your AI-powered voice journal</Text>\n        </View>\n\n        {/* Login Form Card */}\n        <View style={styles.formCard}>\n          <View style={styles.formHeader}>\n            <Text style={styles.formTitle}>Sign In</Text>\n            <Text style={styles.formSubtitle}>Enter your credentials to access your account</Text>\n          </View>\n\n          {errorMessage && (\n            <View style={styles.errorContainer}>\n              <Ionicons name=\"alert-circle-outline\" size={20} color={theme.colors.error} />\n              <Text style={styles.errorText}>{errorMessage}</Text>\n            </View>\n          )}\n          \n          <View style={styles.inputContainer}>\n            <View style={styles.inputWrapper}>\n              <Ionicons name=\"mail-outline\" size={20} color={theme.colors.textSecondary} style={styles.inputIcon} />\n              <TextInput\n                style={styles.input}\n                placeholder=\"Email address\"\n                value={email}\n                onChangeText={setEmail}\n                keyboardType=\"email-address\"\n                autoCapitalize=\"none\"\n                autoCorrect={false}\n                placeholderTextColor={theme.colors.textDisabled}\n              />\n            </View>\n          </View>\n          \n          <View style={styles.inputContainer}>\n            <View style={styles.inputWrapper}>\n              <Ionicons name=\"lock-closed-outline\" size={20} color={theme.colors.textSecondary} style={styles.inputIcon} />\n              <TextInput\n                style={styles.input}\n                placeholder=\"Password\"\n                value={password}\n                onChangeText={setPassword}\n                secureTextEntry={!showPassword}\n                autoCapitalize=\"none\"\n                autoCorrect={false}\n                placeholderTextColor={theme.colors.textDisabled}\n              />\n              <TouchableOpacity \n                onPress={() => setShowPassword(!showPassword)}\n                style={styles.eyeIcon}\n              >\n                <Ionicons \n                  name={showPassword ? 'eye-off-outline' : 'eye-outline'} \n                  size={20} \n                  color={theme.colors.textSecondary} \n                />\n              </TouchableOpacity>\n            </View>\n          </View>\n          \n          <OpaqueAuthButton\n            mode=\"login\"\n            email={email}\n            password={password}\n            onSuccess={() => {\n              // Navigation will be handled by AuthContext\n              logger.info('Login successful via OPAQUE');\n            }}\n            onError={(error: string) => {\n              setErrorMessage(error);\n            }}\n            disabled={!email || !password || isLoading || authLoading}\n            style={styles.loginButton}\n          />\n          \n          <View style={styles.dividerContainer}>\n            <View style={styles.dividerLine} />\n            <Text style={styles.dividerText}>or</Text>\n            <View style={styles.dividerLine} />\n          </View>\n          \n          <TouchableOpacity \n            style={styles.googleButton}\n            onPress={handleGoogleLogin}\n            disabled={isLoading || authLoading}\n          >\n            <Ionicons name=\"logo-google\" size={20} color=\"#EA4335\" />\n            <Text style={styles.googleButtonText}>Continue with Google</Text>\n          </TouchableOpacity>\n        </View>\n\n        {/* Register Prompt Card */}\n        <View style={styles.registerCard}>\n          <Text style={styles.registerText}>Don't have an account?</Text>\n          <TouchableOpacity onPress={navigateToRegister} style={styles.registerButton}>\n            <Text style={styles.registerButtonText}>Create Account</Text>\n            <Ionicons name=\"arrow-forward\" size={16} color={theme.colors.primary} />\n          </TouchableOpacity>\n        </View>\n\n        {isDev && (\n          <TouchableOpacity \n            style={styles.debugButton}\n            onPress={openLogViewer}\n          >\n            <Ionicons name=\"bug-outline\" size={16} color={theme.colors.textSecondary} />\n            <Text style={styles.debugButtonText}>Show Logs</Text>\n          </TouchableOpacity>\n        )}\n      </SafeScrollView>\n      \n      <LogViewer \n        visible={showLogViewer} \n        onClose={() => setShowLogViewer(false)} \n      />\n    </View>\n  );\n};\n\nconst getStyles = (theme: AppTheme) => StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: theme.colors.background,\n  },\n  scrollContainer: {\n    flex: 1,\n  },\n  scrollContent: {\n    flexGrow: 1,\n    padding: theme.spacing.lg,\n    paddingTop: theme.spacing.xl,\n  },\n  welcomeCard: {\n    backgroundColor: theme.colors.card,\n    borderRadius: theme.borderRadius.xl,\n    padding: theme.spacing.xl,\n    marginBottom: theme.spacing.lg,\n    ...theme.shadows.md,\n    borderColor: theme.isDarkMode ? theme.colors.border : 'transparent',\n    borderWidth: theme.isDarkMode ? 1 : 0,\n  },\n  logoContainer: {\n    alignItems: 'center',\n  },\n  logo: {\n    width: 120,\n    height: 120,\n    marginBottom: theme.spacing.lg,\n  },\n  title: {\n    fontSize: theme.typography.fontSizes.xxxl,\n    fontWeight: 'bold',\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.bold,\n    marginBottom: theme.spacing.sm,\n  },\n  subtitle: {\n    fontSize: theme.typography.fontSizes.lg,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.regular,\n    textAlign: 'center',\n  },\n  formCard: {\n    backgroundColor: theme.colors.card,\n    borderRadius: theme.borderRadius.xl,\n    padding: theme.spacing.xl,\n    marginBottom: theme.spacing.lg,\n    ...theme.shadows.md,\n    borderColor: theme.isDarkMode ? theme.colors.border : 'transparent',\n    borderWidth: theme.isDarkMode ? 1 : 0,\n  },\n  formHeader: {\n    marginBottom: theme.spacing.xl,\n  },\n  formTitle: {\n    fontSize: theme.typography.fontSizes.xxl,\n    fontWeight: 'bold',\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.bold,\n    marginBottom: theme.spacing.xs,\n  },\n  formSubtitle: {\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  errorContainer: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: theme.colors.errorLight,\n    borderRadius: theme.borderRadius.md,\n    padding: theme.spacing.md,\n    marginBottom: theme.spacing.lg,\n    borderWidth: 1,\n    borderColor: theme.colors.error + '30',\n  },\n  errorText: {\n    color: theme.colors.error,\n    fontSize: theme.typography.fontSizes.sm,\n    fontFamily: theme.typography.fontFamilies.medium,\n    marginLeft: theme.spacing.sm,\n    flex: 1,\n  },\n  inputContainer: {\n    marginBottom: theme.spacing.lg,\n  },\n  inputWrapper: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: theme.colors.inputBackground,\n    borderRadius: theme.borderRadius.lg,\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n    paddingHorizontal: theme.spacing.md,\n    height: 56,\n  },\n  inputIcon: {\n    marginRight: theme.spacing.md,\n  },\n  input: {\n    flex: 1,\n    fontSize: theme.typography.fontSizes.md,\n    fontFamily: theme.typography.fontFamilies.regular,\n    color: theme.colors.text,\n  },\n  eyeIcon: {\n    padding: theme.spacing.xs,\n  },\n  loginButton: {\n    backgroundColor: theme.colors.primary,\n    borderRadius: theme.borderRadius.lg,\n    height: 56,\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginBottom: theme.spacing.lg,\n    ...theme.shadows.sm,\n  },\n  dividerContainer: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginVertical: theme.spacing.lg,\n  },\n  dividerLine: {\n    flex: 1,\n    height: 1,\n    backgroundColor: theme.colors.border,\n  },\n  dividerText: {\n    marginHorizontal: theme.spacing.md,\n    fontSize: theme.typography.fontSizes.sm,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.medium,\n  },\n  googleButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    backgroundColor: theme.colors.surface,\n    borderRadius: theme.borderRadius.lg,\n    height: 56,\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n    ...theme.shadows.sm,\n  },\n  googleButtonText: {\n    fontSize: theme.typography.fontSizes.md,\n    fontWeight: '600',\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n    marginLeft: theme.spacing.sm,\n  },\n  registerCard: {\n    backgroundColor: theme.colors.card,\n    borderRadius: theme.borderRadius.xl,\n    padding: theme.spacing.lg,\n    marginBottom: theme.spacing.lg,\n    ...theme.shadows.sm,\n    borderColor: theme.isDarkMode ? theme.colors.border : 'transparent',\n    borderWidth: theme.isDarkMode ? 1 : 0,\n  },\n  registerText: {\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.regular,\n    textAlign: 'center',\n    marginBottom: theme.spacing.md,\n  },\n  registerButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    backgroundColor: theme.colors.primaryLight + '20',\n    borderRadius: theme.borderRadius.lg,\n    paddingVertical: theme.spacing.md,\n    paddingHorizontal: theme.spacing.lg,\n  },\n  registerButtonText: {\n    fontSize: theme.typography.fontSizes.md,\n    fontWeight: '600',\n    color: theme.colors.primary,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n    marginRight: theme.spacing.xs,\n  },\n  debugButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    backgroundColor: theme.colors.surface,\n    borderRadius: theme.borderRadius.md,\n    paddingVertical: theme.spacing.sm,\n    paddingHorizontal: theme.spacing.md,\n    marginTop: theme.spacing.lg,\n    alignSelf: 'center',\n  },\n  debugButtonText: {\n    fontSize: theme.typography.fontSizes.xs,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.medium,\n    marginLeft: theme.spacing.xs,\n  },\n});\n\nexport default LoginScreen; ","import React, { useState, useEffect } from 'react';\nimport { \n  View, \n  Text, \n  TextInput, \n  TouchableOpacity, \n  StyleSheet, \n  ActivityIndicator,\n  Alert\n} from 'react-native';\nimport { useNavigation } from '@react-navigation/native';\nimport { StackNavigationProp } from '@react-navigation/stack';\nimport { RootStackParamList } from '../../navigation/types';\nimport { Ionicons } from '@expo/vector-icons';\nimport * as WebBrowser from 'expo-web-browser';\nimport Constants from 'expo-constants';\n\nimport { useAuth } from '../../contexts/AuthContext';\nimport { useAppTheme } from '../../contexts/ThemeContext';\nimport { AppTheme } from '../../config/theme';\nimport SafeScrollView from '../../components/SafeScrollView';\nimport OpaqueAuthButton from '../../components/OpaqueAuthButton';\n\n// Ensure web browser redirect results are handled\nWebBrowser.maybeCompleteAuthSession();\n\ntype RegisterScreenNavigationProp = StackNavigationProp<RootStackParamList>;\n\nconst RegisterScreen = () => {\n  const navigation = useNavigation<RegisterScreenNavigationProp>();\n  const { isLoading: authLoading } = useAuth();\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n  \n  // Debug navigation changes\n  useEffect(() => {\n    console.log('RegisterScreen mounted');\n    return () => {\n      console.log('RegisterScreen unmounted');\n    };\n  }, []);\n  \n  const [name, setName] = useState('');\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const [confirmPassword, setConfirmPassword] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const [showPassword, setShowPassword] = useState(false);\n  const [errorMessage, setErrorMessage] = useState<string | null>(null);\n  const [successMessage, setSuccessMessage] = useState<string | null>(null);\n  \n  // Clear error and success messages when inputs change\n  useEffect(() => {\n    if (errorMessage) {\n      setErrorMessage(null);\n    }\n    if (successMessage) {\n      setSuccessMessage(null);\n    }\n  }, [name, email, password, confirmPassword]);\n  \n  const handleGoogleRegister = async () => {\n    setErrorMessage('Google registration is not available with secure zero-knowledge authentication. Please use email/password registration.');\n  };\n  \n  const navigateToLogin = () => {\n    navigation.navigate('Auth', { screen: 'Login' });\n  };\n  \n  // Check if inputs are valid without side effects\n  // Form validation is now handled by OpaqueAuthButton component\n  \n  return (\n    <View style={styles.container}>\n      <SafeScrollView \n        style={styles.scrollContainer}\n        contentContainerStyle={styles.scrollContent}\n        keyboardShouldPersistTaps=\"handled\"\n        showsVerticalScrollIndicator={false}\n      >\n        {/* Header */}\n        <View style={styles.headerContainer}>\n          <TouchableOpacity \n            style={styles.backButton} \n            onPress={navigateToLogin}\n          >\n            <Ionicons name=\"arrow-back\" size={24} color={theme.colors.text} />\n          </TouchableOpacity>\n        </View>\n\n        {/* Welcome Card */}\n        <View style={styles.welcomeCard}>\n          <View style={styles.logoContainer}>\n            <View style={styles.logoCircle}>\n              <Ionicons name=\"person-add\" size={32} color={theme.colors.primary} />\n            </View>\n            <Text style={styles.appName}>Create Account</Text>\n            <Text style={styles.tagline}>Join us and start your journaling journey</Text>\n          </View>\n        </View>\n\n        {/* Registration Form Card */}\n        <View style={styles.formCard}>\n          <View style={styles.formHeader}>\n            <Text style={styles.formTitle}>Sign Up</Text>\n            <Text style={styles.formSubtitle}>Fill in your information to get started</Text>\n          </View>\n\n          {errorMessage && (\n            <View style={styles.errorContainer}>\n              <Ionicons name=\"alert-circle-outline\" size={20} color={theme.colors.error} />\n              <Text style={styles.errorText}>{errorMessage}</Text>\n            </View>\n          )}\n          \n          {successMessage && (\n            <View style={styles.successContainer}>\n              <Ionicons name=\"checkmark-circle-outline\" size={20} color={theme.colors.success} />\n              <View style={styles.successTextContainer}>\n                <Text style={styles.successText}>{successMessage}</Text>\n                <TouchableOpacity onPress={navigateToLogin} style={styles.signInLinkContainer}>\n                  <Text style={styles.signInLinkText}>Sign in now</Text>\n                  <Ionicons name=\"arrow-forward\" size={16} color={theme.colors.primary} />\n                </TouchableOpacity>\n              </View>\n            </View>\n          )}\n          \n          <View style={styles.inputContainer}>\n            <View style={styles.inputWrapper}>\n              <Ionicons name=\"person-outline\" size={20} color={theme.colors.textSecondary} style={styles.inputIcon} />\n              <TextInput\n                style={styles.input}\n                placeholder=\"Name\"\n                value={name}\n                onChangeText={setName}\n                autoCapitalize=\"words\"\n                autoCorrect={false}\n                placeholderTextColor={theme.colors.textDisabled}\n              />\n            </View>\n          </View>\n          \n          <View style={styles.inputContainer}>\n            <View style={styles.inputWrapper}>\n              <Ionicons name=\"mail-outline\" size={20} color={theme.colors.textSecondary} style={styles.inputIcon} />\n              <TextInput\n                style={styles.input}\n                placeholder=\"Email address\"\n                value={email}\n                onChangeText={setEmail}\n                keyboardType=\"email-address\"\n                autoCapitalize=\"none\"\n                autoCorrect={false}\n                placeholderTextColor={theme.colors.textDisabled}\n              />\n            </View>\n          </View>\n          \n          <View style={styles.inputContainer}>\n            <View style={styles.inputWrapper}>\n              <Ionicons name=\"lock-closed-outline\" size={20} color={theme.colors.textSecondary} style={styles.inputIcon} />\n              <TextInput\n                style={styles.input}\n                placeholder=\"Password\"\n                value={password}\n                onChangeText={setPassword}\n                secureTextEntry={!showPassword}\n                autoCapitalize=\"none\"\n                autoCorrect={false}\n                placeholderTextColor={theme.colors.textDisabled}\n              />\n              <TouchableOpacity \n                onPress={() => setShowPassword(!showPassword)}\n                style={styles.eyeIcon}\n              >\n                <Ionicons \n                  name={showPassword ? 'eye-off-outline' : 'eye-outline'} \n                  size={20} \n                  color={theme.colors.textSecondary} \n                />\n              </TouchableOpacity>\n            </View>\n          </View>\n          \n          <View style={styles.inputContainer}>\n            <View style={styles.inputWrapper}>\n              <Ionicons name=\"lock-closed-outline\" size={20} color={theme.colors.textSecondary} style={styles.inputIcon} />\n              <TextInput\n                style={styles.input}\n                placeholder=\"Confirm Password\"\n                value={confirmPassword}\n                onChangeText={setConfirmPassword}\n                secureTextEntry={!showPassword}\n                autoCapitalize=\"none\"\n                autoCorrect={false}\n                placeholderTextColor={theme.colors.textDisabled}\n              />\n            </View>\n          </View>\n\n          {/* Password Requirements */}\n          <View style={styles.passwordRequirements}>\n            <Text style={styles.requirementsTitle}>Password Requirements:</Text>\n            <View style={styles.requirementItem}>\n              <Ionicons \n                name={password.length >= 8 ? 'checkmark-circle' : 'ellipse-outline'} \n                size={16} \n                color={password.length >= 8 ? theme.colors.success : theme.colors.textDisabled} \n              />\n              <Text style={[styles.requirementText, { color: password.length >= 8 ? theme.colors.success : theme.colors.textDisabled }]}>\n                At least 8 characters\n              </Text>\n            </View>\n            <View style={styles.requirementItem}>\n              <Ionicons \n                name={password === confirmPassword && password.length > 0 ? 'checkmark-circle' : 'ellipse-outline'} \n                size={16} \n                color={password === confirmPassword && password.length > 0 ? theme.colors.success : theme.colors.textDisabled} \n              />\n              <Text style={[styles.requirementText, { color: password === confirmPassword && password.length > 0 ? theme.colors.success : theme.colors.textDisabled }]}>\n                Passwords match\n              </Text>\n            </View>\n          </View>\n          \n          <OpaqueAuthButton\n            mode=\"register\"\n            name={name}\n            email={email}\n            password={password}\n            confirmPassword={confirmPassword}\n            onSuccess={() => {\n              // Show success message instead of navigating\n              setErrorMessage(null);\n              setSuccessMessage('Account created successfully! You can now sign in with your credentials.');\n              console.log('Registration successful via OPAQUE button');\n            }}\n            onError={(error) => {\n              // Show the server error directly - validation should have been done before submission\n              console.log('RegisterScreen onError called with:', error);\n              setSuccessMessage(null);\n              setErrorMessage(error);\n            }}\n            disabled={isLoading || authLoading || !!successMessage}\n            style={styles.registerButton}\n          />\n          \n          <View style={styles.dividerContainer}>\n            <View style={styles.dividerLine} />\n            <Text style={styles.dividerText}>or</Text>\n            <View style={styles.dividerLine} />\n          </View>\n          \n          <TouchableOpacity \n            style={styles.googleButton}\n            onPress={handleGoogleRegister}\n            disabled={isLoading || authLoading}\n          >\n            <Ionicons name=\"logo-google\" size={20} color=\"#EA4335\" />\n            <Text style={styles.googleButtonText}>Continue with Google</Text>\n          </TouchableOpacity>\n        </View>\n\n        {/* Login Prompt Card */}\n        <View style={styles.loginCard}>\n          <Text style={styles.loginText}>Already have an account?</Text>\n          <TouchableOpacity onPress={navigateToLogin} style={styles.loginButton}>\n            <Text style={styles.loginButtonText}>Sign In</Text>\n            <Ionicons name=\"arrow-forward\" size={16} color={theme.colors.primary} />\n          </TouchableOpacity>\n        </View>\n      </SafeScrollView>\n    </View>\n  );\n};\n\nconst getStyles = (theme: AppTheme) => StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: theme.colors.background,\n  },\n  scrollContainer: {\n    flex: 1,\n  },\n  scrollContent: {\n    flexGrow: 1,\n    padding: theme.spacing.lg,\n    paddingTop: theme.spacing.xl,\n  },\n  headerContainer: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginBottom: theme.spacing.lg,\n  },\n  backButton: {\n    width: 40,\n    height: 40,\n    borderRadius: 20,\n    backgroundColor: theme.colors.surface,\n    alignItems: 'center',\n    justifyContent: 'center',\n    ...theme.shadows.sm,\n  },\n  welcomeCard: {\n    backgroundColor: theme.colors.card,\n    borderRadius: theme.borderRadius.xl,\n    padding: theme.spacing.xl,\n    marginBottom: theme.spacing.lg,\n    ...theme.shadows.md,\n    borderColor: theme.isDarkMode ? theme.colors.border : 'transparent',\n    borderWidth: theme.isDarkMode ? 1 : 0,\n  },\n  logoContainer: {\n    alignItems: 'center',\n  },\n  logoCircle: {\n    width: 80,\n    height: 80,\n    borderRadius: 40,\n    backgroundColor: theme.colors.primaryLight + '20',\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginBottom: theme.spacing.lg,\n  },\n  appName: {\n    fontSize: theme.typography.fontSizes.xxxl,\n    fontWeight: 'bold',\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.bold,\n    marginBottom: theme.spacing.sm,\n  },\n  tagline: {\n    fontSize: theme.typography.fontSizes.lg,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.regular,\n    textAlign: 'center',\n  },\n  formCard: {\n    backgroundColor: theme.colors.card,\n    borderRadius: theme.borderRadius.xl,\n    padding: theme.spacing.xl,\n    marginBottom: theme.spacing.lg,\n    ...theme.shadows.md,\n    borderColor: theme.isDarkMode ? theme.colors.border : 'transparent',\n    borderWidth: theme.isDarkMode ? 1 : 0,\n  },\n  formHeader: {\n    marginBottom: theme.spacing.xl,\n  },\n  formTitle: {\n    fontSize: theme.typography.fontSizes.xxl,\n    fontWeight: 'bold',\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.bold,\n    marginBottom: theme.spacing.xs,\n  },\n  formSubtitle: {\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  errorContainer: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: theme.colors.errorLight,\n    borderRadius: theme.borderRadius.md,\n    padding: theme.spacing.md,\n    marginBottom: theme.spacing.lg,\n    borderWidth: 1,\n    borderColor: theme.colors.error + '30',\n  },\n  errorText: {\n    color: theme.colors.error,\n    fontSize: theme.typography.fontSizes.sm,\n    fontFamily: theme.typography.fontFamilies.medium,\n    marginLeft: theme.spacing.sm,\n    flex: 1,\n  },\n  successContainer: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: theme.colors.successLight || theme.colors.success + '20',\n    borderRadius: theme.borderRadius.md,\n    padding: theme.spacing.md,\n    marginBottom: theme.spacing.lg,\n    borderWidth: 1,\n    borderColor: theme.colors.success + '30',\n  },\n  successText: {\n    color: theme.colors.success,\n    fontSize: theme.typography.fontSizes.sm,\n    fontFamily: theme.typography.fontFamilies.medium,\n    marginBottom: theme.spacing.sm,\n  },\n  successTextContainer: {\n    flex: 1,\n    marginLeft: theme.spacing.sm,\n  },\n  signInLinkContainer: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginTop: theme.spacing.xs,\n  },\n  signInLinkText: {\n    color: theme.colors.primary,\n    fontSize: theme.typography.fontSizes.sm,\n    fontFamily: theme.typography.fontFamilies.medium,\n    marginRight: theme.spacing.xs,\n  },\n  inputContainer: {\n    marginBottom: theme.spacing.lg,\n  },\n  inputWrapper: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: theme.colors.inputBackground,\n    borderRadius: theme.borderRadius.lg,\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n    paddingHorizontal: theme.spacing.md,\n    height: 56,\n  },\n  inputIcon: {\n    marginRight: theme.spacing.md,\n  },\n  input: {\n    flex: 1,\n    fontSize: theme.typography.fontSizes.md,\n    fontFamily: theme.typography.fontFamilies.regular,\n    color: theme.colors.text,\n  },\n  eyeIcon: {\n    padding: theme.spacing.xs,\n  },\n  passwordRequirements: {\n    backgroundColor: theme.colors.surface,\n    borderRadius: theme.borderRadius.md,\n    padding: theme.spacing.md,\n    marginBottom: theme.spacing.lg,\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n  },\n  requirementsTitle: {\n    fontSize: theme.typography.fontSizes.sm,\n    fontWeight: '600',\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n    marginBottom: theme.spacing.sm,\n  },\n  requirementItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginBottom: theme.spacing.xs,\n  },\n  requirementText: {\n    fontSize: theme.typography.fontSizes.sm,\n    fontFamily: theme.typography.fontFamilies.regular,\n    marginLeft: theme.spacing.sm,\n  },\n  registerButton: {\n    backgroundColor: theme.colors.primary,\n    borderRadius: theme.borderRadius.lg,\n    height: 56,\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginBottom: theme.spacing.lg,\n    ...theme.shadows.sm,\n  },\n  dividerContainer: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginVertical: theme.spacing.lg,\n  },\n  dividerLine: {\n    flex: 1,\n    height: 1,\n    backgroundColor: theme.colors.border,\n  },\n  dividerText: {\n    marginHorizontal: theme.spacing.md,\n    fontSize: theme.typography.fontSizes.sm,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.medium,\n  },\n  googleButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    backgroundColor: theme.colors.surface,\n    borderRadius: theme.borderRadius.lg,\n    height: 56,\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n    ...theme.shadows.sm,\n  },\n  googleButtonText: {\n    fontSize: theme.typography.fontSizes.md,\n    fontWeight: '600',\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n    marginLeft: theme.spacing.sm,\n  },\n  loginCard: {\n    backgroundColor: theme.colors.card,\n    borderRadius: theme.borderRadius.xl,\n    padding: theme.spacing.lg,\n    marginBottom: theme.spacing.lg,\n    ...theme.shadows.sm,\n    borderColor: theme.isDarkMode ? theme.colors.border : 'transparent',\n    borderWidth: theme.isDarkMode ? 1 : 0,\n  },\n  loginText: {\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.regular,\n    textAlign: 'center',\n    marginBottom: theme.spacing.md,\n  },\n  loginButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    backgroundColor: theme.colors.primaryLight + '20',\n    borderRadius: theme.borderRadius.lg,\n    paddingVertical: theme.spacing.md,\n    paddingHorizontal: theme.spacing.lg,\n  },\n  loginButtonText: {\n    fontSize: theme.typography.fontSizes.md,\n    fontWeight: '600',\n    color: theme.colors.primary,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n    marginRight: theme.spacing.xs,\n  },\n});\n\nexport default RegisterScreen; ","import React from 'react';\nimport { createStackNavigator } from '@react-navigation/stack';\n\nimport { AuthStackParamList } from './types';\nimport LoginScreen from '../screens/auth/LoginScreen';\nimport RegisterScreen from '../screens/auth/RegisterScreen';\n\nconst Stack = createStackNavigator<AuthStackParamList>();\n\nconst AuthNavigator = () => {\n  return (\n    <Stack.Navigator \n      initialRouteName=\"Register\"\n      screenOptions={{\n        headerShown: false,\n      }}\n    >\n      <Stack.Screen name=\"Login\" component={LoginScreen} />\n      <Stack.Screen name=\"Register\" component={RegisterScreen} />\n    </Stack.Navigator>\n  );\n};\n\nexport default AuthNavigator; ","import { Audio } from 'expo-av';\nimport logger from '../utils/logger';\n\ninterface AudioPrewarmState {\n  permissionsGranted: boolean;\n  audioModeConfigured: boolean;\n  isPrewarmed: boolean;\n  lastPrewarmTime: number;\n}\n\n/**\n * Simplified Audio Prewarm Service\n * Pre-configures audio permissions and settings for faster recording initialization\n */\nclass AudioPrewarmService {\n  private state: AudioPrewarmState = {\n    permissionsGranted: false,\n    audioModeConfigured: false,\n    isPrewarmed: false,\n    lastPrewarmTime: 0,\n  };\n\n  private prewarmPromise: Promise<void> | null = null;\n\n  /**\n   * Main prewarm method - can be called multiple times safely\n   */\n  async prewarmAudioSystem(): Promise<void> {\n    // If already prewarming, wait for existing operation\n    if (this.prewarmPromise) {\n      await this.prewarmPromise;\n      return;\n    }\n\n    // If recently prewarmed (within 5 minutes), skip\n    const fiveMinutes = 5 * 60 * 1000;\n    if (this.state.isPrewarmed && (Date.now() - this.state.lastPrewarmTime) < fiveMinutes) {\n      logger.debug('Audio system already prewarmed recently, skipping');\n      return;\n    }\n\n    // Start new prewarm operation\n    this.prewarmPromise = this.performPrewarm();\n    \n    try {\n      await this.prewarmPromise;\n    } finally {\n      this.prewarmPromise = null;\n    }\n  }\n\n  /**\n   * Perform the actual prewarming operations\n   */\n  private async performPrewarm(): Promise<void> {\n    logger.info('Starting audio system prewarm...');\n    const startTime = Date.now();\n\n    try {\n      // Step 1: Request and verify permissions\n      await this.prewarmPermissions();\n\n      // Step 2: Configure audio mode\n      await this.prewarmAudioMode();\n\n      this.state.isPrewarmed = true;\n      this.state.lastPrewarmTime = Date.now();\n\n      const duration = Date.now() - startTime;\n      logger.info(`Audio system prewarm completed in ${duration}ms`);\n    } catch (error) {\n      logger.error('Audio system prewarm failed:', error);\n      this.state.isPrewarmed = false;\n      throw error;\n    }\n  }\n\n  /**\n   * Pre-warm audio permissions\n   */\n  private async prewarmPermissions(): Promise<void> {\n    try {\n      logger.debug('Prewarming audio permissions...');\n      \n      // Request microphone permission\n      const audioPermission = await Audio.requestPermissionsAsync();\n      if (!audioPermission.granted) {\n        logger.warn('Microphone permission not granted during prewarm');\n        this.state.permissionsGranted = false;\n        return;\n      }\n\n      this.state.permissionsGranted = true;\n      logger.debug('Audio permissions prewarmed successfully');\n    } catch (error) {\n      logger.error('Failed to prewarm audio permissions:', error);\n      this.state.permissionsGranted = false;\n      throw error;\n    }\n  }\n\n  /**\n   * Pre-configure audio mode for optimal recording\n   */\n  private async prewarmAudioMode(): Promise<void> {\n    try {\n      logger.debug('Prewarming audio mode configuration...');\n      \n      await Audio.setAudioModeAsync({\n        allowsRecordingIOS: true,\n        playsInSilentModeIOS: true,\n        shouldDuckAndroid: true,\n        playThroughEarpieceAndroid: false,\n        staysActiveInBackground: false,\n      });\n\n      this.state.audioModeConfigured = true;\n      logger.debug('Audio mode prewarmed successfully');\n    } catch (error) {\n      logger.error('Failed to prewarm audio mode:', error);\n      this.state.audioModeConfigured = false;\n      throw error;\n    }\n  }\n\n  /**\n   * Get current prewarm state\n   */\n  getPrewarmState(): AudioPrewarmState {\n    return { ...this.state };\n  }\n\n  /**\n   * Check if audio system is ready for recording\n   */\n  isReadyForRecording(): boolean {\n    return this.state.permissionsGranted && this.state.audioModeConfigured;\n  }\n\n  /**\n   * Force refresh of prewarm state\n   */\n  async refreshPrewarm(): Promise<void> {\n    this.state.isPrewarmed = false;\n    this.state.lastPrewarmTime = 0;\n    await this.prewarmAudioSystem();\n  }\n\n  /**\n   * Get prewarm performance metrics\n   */\n  getPerformanceMetrics(): {\n    isPrewarmed: boolean;\n    lastPrewarmTime: number;\n    timeSinceLastPrewarm: number;\n    readyForRecording: boolean;\n  } {\n    const now = Date.now();\n    return {\n      isPrewarmed: this.state.isPrewarmed,\n      lastPrewarmTime: this.state.lastPrewarmTime,\n      timeSinceLastPrewarm: this.state.lastPrewarmTime > 0 ? now - this.state.lastPrewarmTime : -1,\n      readyForRecording: this.isReadyForRecording(),\n    };\n  }\n\n  /**\n   * Cleanup and reset prewarm state\n   */\n  cleanup(): void {\n    this.state = {\n      permissionsGranted: false,\n      audioModeConfigured: false,\n      isPrewarmed: false,\n      lastPrewarmTime: 0,\n    };\n    this.prewarmPromise = null;\n    logger.debug('Audio prewarm service cleaned up');\n  }\n}\n\n// Export singleton instance\nexport const audioPrewarmService = new AudioPrewarmService();\nexport default audioPrewarmService; ","// Simplified language configuration for single language speech recognition\nexport interface LanguageOption {\n  code: string;\n  name: string;\n  region?: string;\n}\n\n// Simplified list of most common languages for transcription\nexport const SUPPORTED_LANGUAGES: LanguageOption[] = [\n  // Auto-detect option\n  { code: 'auto', name: 'Auto-detect' },\n  \n  // English variants\n  { code: 'en-US', name: 'English', region: 'United States' },\n  { code: 'en-GB', name: 'English', region: 'United Kingdom' },\n  { code: 'en-AU', name: 'English', region: 'Australia' },\n  { code: 'en-CA', name: 'English', region: 'Canada' },\n  \n  // Spanish variants\n  { code: 'es-ES', name: 'Spanish', region: 'Spain' },\n  { code: 'es-MX', name: 'Spanish', region: 'Mexico' },\n  { code: 'es-US', name: 'Spanish', region: 'United States' },\n  \n  // French variants\n  { code: 'fr-FR', name: 'French', region: 'France' },\n  { code: 'fr-CA', name: 'French', region: 'Canada' },\n  \n  // German\n  { code: 'de-DE', name: 'German', region: 'Germany' },\n  \n  // Italian\n  { code: 'it-IT', name: 'Italian', region: 'Italy' },\n  \n  // Portuguese\n  { code: 'pt-BR', name: 'Portuguese', region: 'Brazil' },\n  { code: 'pt-PT', name: 'Portuguese', region: 'Portugal' },\n  \n  // Chinese\n  { code: 'zh-CN', name: 'Chinese', region: 'Simplified' },\n  { code: 'zh-TW', name: 'Chinese', region: 'Traditional' },\n  \n  // Japanese\n  { code: 'ja-JP', name: 'Japanese', region: 'Japan' },\n  \n  // Korean\n  { code: 'ko-KR', name: 'Korean', region: 'South Korea' },\n  \n  // Russian\n  { code: 'ru-RU', name: 'Russian', region: 'Russia' },\n  \n  // Arabic\n  { code: 'ar-SA', name: 'Arabic', region: 'Saudi Arabia' },\n  \n  // Hindi\n  { code: 'hi-IN', name: 'Hindi', region: 'India' },\n  \n  // Dutch\n  { code: 'nl-NL', name: 'Dutch', region: 'Netherlands' },\n  \n  // Polish\n  { code: 'pl-PL', name: 'Polish', region: 'Poland' },\n  \n  // Turkish\n  { code: 'tr-TR', name: 'Turkish', region: 'Turkey' },\n  \n  // Swedish\n  { code: 'sv-SE', name: 'Swedish', region: 'Sweden' },\n  \n  // Norwegian\n  { code: 'no-NO', name: 'Norwegian', region: 'Norway' },\n  \n  // Danish\n  { code: 'da-DK', name: 'Danish', region: 'Denmark' },\n  \n  // Finnish\n  { code: 'fi-FI', name: 'Finnish', region: 'Finland' },\n];\n\n// Get a human-readable language name from a language code\nexport function getLanguageName(languageCode: string): string | null {\n  const language = SUPPORTED_LANGUAGES.find(lang => lang.code === languageCode);\n  if (language) {\n    if (language.code === 'auto') return language.name;\n    return language.region ? `${language.name} (${language.region})` : language.name;\n  }\n  \n  // Try to match by primary language code (before the dash)\n  const langPart = languageCode.split('-')[0];\n  const match = SUPPORTED_LANGUAGES.find(lang => lang.code.startsWith(langPart + '-'));\n  return match ? (match.region ? `${match.name} (${match.region})` : match.name) : null;\n}\n\n// Get default language code\nexport function getDefaultLanguageCode(): string {\n  return 'auto'; // Default to auto-detect\n}\n\n// Validate single language code\nexport function validateLanguageCode(languageCode: string): boolean {\n  return SUPPORTED_LANGUAGES.some(lang => lang.code === languageCode);\n} ","import AsyncStorage from '@react-native-async-storage/async-storage';\nimport logger from '../utils/logger';\nimport { getDefaultLanguageCode, validateLanguageCode } from '../config/languageConfig';\n\n// Settings interface with only functional user preferences\nexport interface UserSettings {\n  // Language & Transcription (FUNCTIONAL)\n  defaultLanguage: string; // Can be 'auto' for auto-detect or specific language code\n  \n  // Privacy & Security (FUNCTIONAL)\n  defaultEntryPrivacy: 'public' | 'hidden';\n  hiddenModeEnabled: boolean;\n  \n  // App Behavior (FUNCTIONAL)\n  hapticFeedbackEnabled: boolean;\n  \n  // Notifications (FUNCTIONAL)\n  notificationsEnabled: boolean;\n  reminderNotifications: boolean;\n  dailyReminderTime: string; // HH:MM format\n  \n  // Advanced (FUNCTIONAL)\n  analyticsEnabled: boolean;\n  crashReportsEnabled: boolean;\n  \n  // Additional (FUNCTIONAL)\n  autoSaveEnabled: boolean;\n  autoRecordingEnabled: boolean;\n}\n\n// Default settings with sensible defaults\nexport const DEFAULT_SETTINGS: UserSettings = {\n  // Language & Transcription\n  defaultLanguage: getDefaultLanguageCode(), // 'auto' for auto-detect\n  \n  // Privacy & Security\n  defaultEntryPrivacy: 'public',\n  hiddenModeEnabled: false,\n  \n  // App Behavior\n  hapticFeedbackEnabled: true,\n  \n  // Notifications\n  notificationsEnabled: true,\n  reminderNotifications: false,\n  dailyReminderTime: '20:00',\n  \n  // Advanced\n  analyticsEnabled: true,\n  crashReportsEnabled: true,\n  \n  // Additional\n  autoSaveEnabled: true,\n  autoRecordingEnabled: true,\n};\n\nconst SETTINGS_STORAGE_KEY = '@kotori_user_settings';\nconst SETTINGS_VERSION = '1.0';\n\nclass SettingsService {\n  private settings: UserSettings = { ...DEFAULT_SETTINGS };\n  private initialized = false;\n  private listeners: Set<(settings: UserSettings) => void> = new Set();\n\n  /**\n   * Initialize the settings service by loading stored preferences\n   */\n  async initialize(): Promise<UserSettings> {\n    if (this.initialized) {\n      return this.settings;\n    }\n\n    try {\n      const storedSettings = await AsyncStorage.getItem(SETTINGS_STORAGE_KEY);\n      \n      if (storedSettings) {\n        const parsed = JSON.parse(storedSettings);\n        \n        // Extract just the settings object if it exists, otherwise use the whole parsed object\n        const settingsToValidate = parsed.settings || parsed;\n        \n        // Merge with defaults to handle new settings added in updates\n        this.settings = {\n          ...DEFAULT_SETTINGS,\n          ...this.validateSettings(settingsToValidate),\n        };\n        \n        logger.info('[SettingsService] Settings loaded from storage');\n      } else {\n        // First time - save defaults\n        await this.saveSettings(this.settings);\n        logger.info('[SettingsService] Initialized with default settings');\n      }\n    } catch (err) {\n      const error = err instanceof Error ? err : new Error(String(err));\n      logger.error('[SettingsService] Failed to load settings:', error);\n      this.settings = { ...DEFAULT_SETTINGS };\n    }\n\n    this.initialized = true;\n    return this.settings;\n  }\n\n  /**\n   * Get current settings (readonly)\n   */\n  getSettings(): UserSettings {\n    return { ...this.settings };\n  }\n\n  /**\n   * Get a specific setting value\n   */\n  getSetting<K extends keyof UserSettings>(key: K): UserSettings[K] {\n    return this.settings[key];\n  }\n\n  /**\n   * Update a single setting\n   */\n  async updateSetting<K extends keyof UserSettings>(\n    key: K, \n    value: UserSettings[K]\n  ): Promise<void> {\n    try {\n      // Validate the setting\n      const validatedValue = this.validateSingleSetting(key, value);\n      \n      // Update local settings\n      this.settings = {\n        ...this.settings,\n        [key]: validatedValue,\n      };\n\n      // Persist to storage\n      await this.saveSettings(this.settings);\n      \n      // Notify listeners\n      this.notifyListeners();\n      \n      logger.info(`[SettingsService] Updated setting: ${String(key)} = ${value}`);\n    } catch (err) {\n      const error = err instanceof Error ? err : new Error(String(err));\n      logger.error(`[SettingsService] Failed to update setting ${String(key)}:`, error);\n      throw error;\n    }\n  }\n\n  /**\n   * Update multiple settings at once\n   */\n  async updateSettings(updates: Partial<UserSettings>): Promise<void> {\n    try {\n      // Validate all updates\n      const validatedUpdates = this.validateSettings(updates);\n      \n      // Update local settings\n      this.settings = {\n        ...this.settings,\n        ...validatedUpdates,\n      };\n\n      // Persist to storage\n      await this.saveSettings(this.settings);\n      \n      // Notify listeners\n      this.notifyListeners();\n      \n      logger.info('[SettingsService] Bulk settings update completed');\n    } catch (err) {\n      const error = err instanceof Error ? err : new Error(String(err));\n      logger.error('[SettingsService] Failed to update settings:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Reset all settings to defaults\n   */\n  async resetToDefaults(): Promise<void> {\n    try {\n      this.settings = { ...DEFAULT_SETTINGS };\n      await this.saveSettings(this.settings);\n      this.notifyListeners();\n      logger.info('[SettingsService] Settings reset to defaults');\n    } catch (err) {\n      const error = err instanceof Error ? err : new Error(String(err));\n      logger.error('[SettingsService] Failed to reset settings:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Export settings as JSON string\n   */\n  async exportSettings(): Promise<string> {\n    const exportData = {\n      version: SETTINGS_VERSION,\n      timestamp: new Date().toISOString(),\n      settings: this.settings,\n    };\n    return JSON.stringify(exportData, null, 2);\n  }\n\n  /**\n   * Import settings from JSON string\n   */\n  async importSettings(jsonData: string): Promise<void> {\n    try {\n      const imported = JSON.parse(jsonData);\n      \n      if (!imported.settings) {\n        throw new Error('Invalid settings format - missing settings object');\n      }\n      \n      // Validate and merge with current settings\n      const validatedSettings = this.validateSettings(imported.settings);\n      await this.updateSettings(validatedSettings);\n      \n      logger.info('[SettingsService] Settings imported successfully');\n    } catch (err) {\n      const error = err instanceof Error ? err : new Error(String(err));\n      logger.error('[SettingsService] Failed to import settings:', error);\n      throw new Error('Failed to import settings: ' + error.message);\n    }\n  }\n\n  /**\n   * Subscribe to settings changes\n   */\n  subscribe(listener: (settings: UserSettings) => void): () => void {\n    this.listeners.add(listener);\n    \n    // Return unsubscribe function\n    return () => {\n      this.listeners.delete(listener);\n    };\n  }\n\n  /**\n   * Get migration recommendations for settings updates\n   */\n  getMigrationInfo(): { hasNewSettings: boolean; newSettings: string[] } {\n    const currentKeys = Object.keys(this.settings);\n    const defaultKeys = Object.keys(DEFAULT_SETTINGS);\n    const newSettings = defaultKeys.filter(key => !currentKeys.includes(key));\n    \n    return {\n      hasNewSettings: newSettings.length > 0,\n      newSettings,\n    };\n  }\n\n  // Private methods\n\n  private async saveSettings(settings: UserSettings): Promise<void> {\n    const settingsData = {\n      version: SETTINGS_VERSION,\n      timestamp: new Date().toISOString(),\n      settings,\n    };\n    \n    await AsyncStorage.setItem(SETTINGS_STORAGE_KEY, JSON.stringify(settingsData));\n  }\n\n  private validateSettings(settings: Partial<UserSettings>): Partial<UserSettings> {\n    const validated: Record<string, any> = {};\n    \n    for (const [key, value] of Object.entries(settings)) {\n      try {\n        const validatedValue = this.validateSingleSetting(\n          key as keyof UserSettings, \n          value\n        );\n        validated[key] = validatedValue;\n      } catch (err) {\n        const error = err instanceof Error ? err : new Error(String(err));\n        logger.warn(`[SettingsService] Invalid setting ${key}: ${error.message}, using default`);\n        // Use default value for invalid settings\n        const defaultValue = DEFAULT_SETTINGS[key as keyof UserSettings];\n        validated[key] = defaultValue;\n      }\n    }\n    \n    return validated as Partial<UserSettings>;\n  }\n\n  private validateSingleSetting<K extends keyof UserSettings>(\n    key: K, \n    value: unknown\n  ): UserSettings[K] {\n    switch (key) {\n      case 'defaultLanguage':\n        if (typeof value !== 'string' || (!validateLanguageCode(value) && value !== 'auto')) {\n          throw new Error(`Invalid language code: ${value}`);\n        }\n        return value as UserSettings[K];\n        \n      case 'dailyReminderTime':\n        if (typeof value !== 'string' || !/^\\d{2}:\\d{2}$/.test(value)) {\n          throw new Error(`Invalid time format: ${value}`);\n        }\n        return value as UserSettings[K];\n        \n      default:\n        // For boolean and other simple types, just ensure correct type\n        if (typeof value !== typeof DEFAULT_SETTINGS[key]) {\n          throw new Error(`Type mismatch for ${key}: expected ${typeof DEFAULT_SETTINGS[key]}, got ${typeof value}`);\n        }\n        return value as UserSettings[K];\n    }\n  }\n\n  private notifyListeners(): void {\n    this.listeners.forEach(listener => {\n      try {\n        listener(this.getSettings());\n      } catch (err) {\n        const error = err instanceof Error ? err : new Error(String(err));\n        logger.error('[SettingsService] Error in settings listener:', error);\n      }\n    });\n  }\n}\n\n// Create and export singleton instance\nexport const settingsService = new SettingsService();\n\nexport default settingsService; ","import { Platform, Vibration } from 'react-native';\nimport logger from '../utils/logger';\n\n// Import settings service to check if haptic feedback is enabled\nimport settingsService from './settingsService';\n\nexport enum HapticFeedbackType {\n  Selection = 'selection',\n  ImpactLight = 'impactLight',\n  ImpactMedium = 'impactMedium',\n  ImpactHeavy = 'impactHeavy',\n  NotificationSuccess = 'notificationSuccess',\n  NotificationWarning = 'notificationWarning',\n  NotificationError = 'notificationError',\n}\n\nclass HapticService {\n  private expoHaptics: any = null;\n  private initialized = false;\n\n  /**\n   * Initialize the haptic service by trying to load Expo Haptics\n   */\n  private async initialize() {\n    if (this.initialized) return;\n\n    try {\n      if (Platform.OS !== 'web') {\n        // Try to import Expo Haptics\n        const { Haptics } = require('expo-haptics');\n        this.expoHaptics = Haptics;\n        logger.info('[HapticService] Expo Haptics initialized successfully');\n      } else {\n        logger.info('[HapticService] Web platform - haptics not supported');\n      }\n    } catch (error) {\n      logger.warn('[HapticService] Expo Haptics not available, will use fallback vibration');\n    }\n\n    this.initialized = true;\n  }\n\n  /**\n   * Check if haptic feedback is enabled in user settings\n   */\n  private async isHapticEnabled(): Promise<boolean> {\n    try {\n      const settings = await settingsService.getSettings();\n      return settings.hapticFeedbackEnabled;\n    } catch (error) {\n      logger.warn('[HapticService] Failed to get haptic setting, defaulting to enabled');\n      return true; // Default to enabled if we can't get settings\n    }\n  }\n\n  /**\n   * Trigger haptic feedback of the specified type\n   */\n  async impact(type: HapticFeedbackType = HapticFeedbackType.ImpactMedium): Promise<void> {\n    try {\n      await this.initialize();\n\n      // Check if haptic feedback is enabled\n      const isEnabled = await this.isHapticEnabled();\n      if (!isEnabled) {\n        logger.debug('[HapticService] Haptic feedback disabled in settings');\n        return;\n      }\n\n      if (Platform.OS === 'web') {\n        // Web doesn't support haptics\n        return;\n      }\n\n      if (this.expoHaptics) {\n        // Use Expo Haptics if available\n        await this.triggerExpoHaptic(type);\n      } else {\n        // Fallback to basic vibration\n        this.triggerVibrationFallback(type);\n      }\n\n      logger.debug(`[HapticService] Haptic feedback triggered: ${type}`);\n    } catch (error) {\n      logger.error('[HapticService] Failed to trigger haptic feedback:', error);\n    }\n  }\n\n  /**\n   * Trigger haptic feedback using Expo Haptics\n   */\n  private async triggerExpoHaptic(type: HapticFeedbackType): Promise<void> {\n    if (!this.expoHaptics) return;\n\n    switch (type) {\n      case HapticFeedbackType.Selection:\n        await this.expoHaptics.selectionAsync();\n        break;\n      case HapticFeedbackType.ImpactLight:\n        await this.expoHaptics.impactAsync(this.expoHaptics.ImpactFeedbackStyle.Light);\n        break;\n      case HapticFeedbackType.ImpactMedium:\n        await this.expoHaptics.impactAsync(this.expoHaptics.ImpactFeedbackStyle.Medium);\n        break;\n      case HapticFeedbackType.ImpactHeavy:\n        await this.expoHaptics.impactAsync(this.expoHaptics.ImpactFeedbackStyle.Heavy);\n        break;\n      case HapticFeedbackType.NotificationSuccess:\n        await this.expoHaptics.notificationAsync(this.expoHaptics.NotificationFeedbackType.Success);\n        break;\n      case HapticFeedbackType.NotificationWarning:\n        await this.expoHaptics.notificationAsync(this.expoHaptics.NotificationFeedbackType.Warning);\n        break;\n      case HapticFeedbackType.NotificationError:\n        await this.expoHaptics.notificationAsync(this.expoHaptics.NotificationFeedbackType.Error);\n        break;\n      default:\n        await this.expoHaptics.impactAsync(this.expoHaptics.ImpactFeedbackStyle.Medium);\n    }\n  }\n\n  /**\n   * Fallback to basic vibration when Expo Haptics is not available\n   */\n  private triggerVibrationFallback(type: HapticFeedbackType): void {\n    let duration: number;\n\n    switch (type) {\n      case HapticFeedbackType.Selection:\n        duration = 20;\n        break;\n      case HapticFeedbackType.ImpactLight:\n        duration = 30;\n        break;\n      case HapticFeedbackType.ImpactMedium:\n        duration = 50;\n        break;\n      case HapticFeedbackType.ImpactHeavy:\n        duration = 80;\n        break;\n      case HapticFeedbackType.NotificationSuccess:\n        duration = 100;\n        break;\n      case HapticFeedbackType.NotificationWarning:\n        duration = 150;\n        break;\n      case HapticFeedbackType.NotificationError:\n        duration = 200;\n        break;\n      default:\n        duration = 50;\n    }\n\n    Vibration.vibrate(duration);\n  }\n\n  /**\n   * Convenience methods for common haptic feedback types\n   */\n  async selection(): Promise<void> {\n    return this.impact(HapticFeedbackType.Selection);\n  }\n\n  async light(): Promise<void> {\n    return this.impact(HapticFeedbackType.ImpactLight);\n  }\n\n  async medium(): Promise<void> {\n    return this.impact(HapticFeedbackType.ImpactMedium);\n  }\n\n  async heavy(): Promise<void> {\n    return this.impact(HapticFeedbackType.ImpactHeavy);\n  }\n\n  async success(): Promise<void> {\n    return this.impact(HapticFeedbackType.NotificationSuccess);\n  }\n\n  async warning(): Promise<void> {\n    return this.impact(HapticFeedbackType.NotificationWarning);\n  }\n\n  async error(): Promise<void> {\n    return this.impact(HapticFeedbackType.NotificationError);\n  }\n}\n\n// Export singleton instance\nconst hapticService = new HapticService();\nexport default hapticService; ","import React, { useRef, useEffect } from 'react';\nimport {\n  View,\n  TouchableOpacity,\n  StyleSheet,\n  Animated,\n  Platform,\n} from 'react-native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { useAppTheme } from '../contexts/ThemeContext';\nimport { AppTheme } from '../config/theme';\nimport hapticService from '../services/hapticService';\n\ninterface FloatingActionButtonProps {\n  onPress: () => void;\n  icon?: keyof typeof Ionicons.glyphMap;\n  size?: number;\n  style?: object;\n  disabled?: boolean;\n  variant?: 'primary' | 'secondary' | 'accent';\n  testID?: string;\n}\n\n// Helper to determine if native driver should be used\nconst useNativeDriver = Platform.OS !== 'web';\n\nconst FloatingActionButton: React.FC<FloatingActionButtonProps> = ({\n  onPress,\n  icon = 'mic',\n  size = 56,\n  style,\n  disabled = false,\n  variant = 'primary',\n  testID = 'floating-action-button',\n}) => {\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme, size, variant);\n  \n  const scaleAnim = useRef(new Animated.Value(1)).current;\n  const pulseAnim = useRef(new Animated.Value(1)).current;\n  const rotateAnim = useRef(new Animated.Value(0)).current;\n\n  // Pulse animation for attention\n  useEffect(() => {\n    const pulse = Animated.loop(\n      Animated.sequence([\n        Animated.timing(pulseAnim, {\n          toValue: 1.05,\n          duration: 1000,\n          useNativeDriver,\n        }),\n        Animated.timing(pulseAnim, {\n          toValue: 1,\n          duration: 1000,\n          useNativeDriver,\n        }),\n      ])\n    );\n    \n    if (!disabled) {\n      pulse.start();\n    }\n    \n    return () => pulse.stop();\n  }, [disabled, pulseAnim]);\n\n  const handlePressIn = () => {\n    if (disabled) return;\n    \n    // Haptic feedback using centralized service\n    hapticService.medium();\n\n    Animated.parallel([\n      Animated.spring(scaleAnim, {\n        toValue: 0.95,\n        useNativeDriver,\n      }),\n      Animated.timing(rotateAnim, {\n        toValue: 1,\n        duration: 150,\n        useNativeDriver,\n      }),\n    ]).start();\n  };\n\n  const handlePressOut = () => {\n    if (disabled) return;\n    \n    Animated.parallel([\n      Animated.spring(scaleAnim, {\n        toValue: 1,\n        tension: 150,\n        friction: 4,\n        useNativeDriver,\n      }),\n      Animated.timing(rotateAnim, {\n        toValue: 0,\n        duration: 150,\n        useNativeDriver,\n      }),\n    ]).start();\n  };\n\n  const handlePress = () => {\n    if (disabled) return;\n    onPress();\n  };\n\n  const rotation = rotateAnim.interpolate({\n    inputRange: [0, 1],\n    outputRange: ['0deg', '15deg'],\n  });\n\n  return (\n    <View style={[styles.container, style]}>\n      <Animated.View\n        style={[\n          styles.shadowContainer,\n          {\n            transform: [{ scale: pulseAnim }],\n          },\n        ]}\n      >\n        <Animated.View\n          style={[\n            styles.button,\n            disabled && styles.disabled,\n            {\n              transform: [\n                { scale: scaleAnim },\n                { rotate: rotation },\n              ],\n            },\n          ]}\n        >\n          <TouchableOpacity\n            style={styles.touchable}\n            onPress={handlePress}\n            onPressIn={handlePressIn}\n            onPressOut={handlePressOut}\n            disabled={disabled}\n            activeOpacity={0.8}\n            testID={testID}\n          >\n            <Ionicons\n              name={icon}\n              size={size * 0.5}\n              color={styles.icon.color}\n            />\n          </TouchableOpacity>\n        </Animated.View>\n      </Animated.View>\n    </View>\n  );\n};\n\nconst getStyles = (theme: AppTheme, size: number, variant: 'primary' | 'secondary' | 'accent') => {\n  const getVariantColors = () => {\n    switch (variant) {\n      case 'secondary':\n        return {\n          backgroundColor: theme.colors.secondary,\n          shadowColor: theme.colors.secondary,\n        };\n      case 'accent':\n        return {\n          backgroundColor: theme.colors.accent,\n          shadowColor: theme.colors.accent,\n        };\n      default:\n        return {\n          backgroundColor: theme.colors.primary,\n          shadowColor: theme.colors.primary,\n        };\n    }\n  };\n\n  const variantColors = getVariantColors();\n\n  return StyleSheet.create({\n    container: {\n      position: 'relative',\n    },\n    shadowContainer: {\n      borderRadius: size / 2,\n      ...theme.shadows.lg,\n      shadowColor: variantColors.shadowColor,\n    },\n    button: {\n      width: size,\n      height: size,\n      borderRadius: size / 2,\n      backgroundColor: variantColors.backgroundColor,\n      justifyContent: 'center',\n      alignItems: 'center',\n      overflow: 'hidden',\n    },\n    touchable: {\n      width: '100%',\n      height: '100%',\n      justifyContent: 'center',\n      alignItems: 'center',\n    },\n    disabled: {\n      backgroundColor: theme.colors.disabled,\n      opacity: 0.6,\n    },\n    icon: {\n      color: theme.colors.onPrimary,\n    },\n  });\n};\n\nexport default FloatingActionButton; ","/**\n * Client-Side Zero-Knowledge Encryption Service\n * \n * This service ensures that encryption keys are derived from user secrets\n * and never leave the user's device. The server cannot decrypt user data.\n */\n\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { Platform } from 'react-native';\nimport logger from '../utils/logger';\nimport { opaqueKeyManager } from './opaqueKeyManager';\n\ninterface EncryptionResult {\n  encryptedContent: string;  // Base64 encoded encrypted data\n  iv: string;               // Base64 encoded initialization vector\n  salt?: string;             // Optional salt (legacy). For per-user encryption we may omit.\n  wrappedKey?: string;       // Base64-wrapped per-entry key using user master key\n  wrapIv?: string;           // Base64 IV used for key wrapping\n  algorithm?: string;        // Algorithm identifier (e.g., AES-GCM)\n}\n\ninterface KeyDerivationParams {\n  userSecret: string;       // User's secret phrase or biometric-derived data\n  salt?: Uint8Array;        // Optional salt for key derivation\n  iterations?: number;      // PBKDF2 iterations\n}\n\nclass ClientEncryptionService {\n  private static readonly ALGORITHM = 'AES-GCM';\n  private static readonly KEY_LENGTH = 256;\n  private static readonly IV_LENGTH = 12; // 96 bits for GCM\n  private static readonly SALT_LENGTH = 32; // 256 bits\n  private static readonly DEFAULT_ITERATIONS = 100000;\n  private static readonly MASTER_INFO = 'UserMasterKey';\n  \n  // Secure storage keys\n  private static readonly USER_SALT_KEY = 'user_encryption_salt';\n  private static readonly KEY_DERIVATION_PARAMS_KEY = 'key_derivation_params';\n\n  /**\n   * Check if Web Crypto API is available\n   */\n  private isWebCryptoAvailable(): boolean {\n    return typeof crypto !== 'undefined' && \n           typeof crypto.subtle !== 'undefined' &&\n           typeof crypto.subtle.deriveKey === 'function';\n  }\n\n  /**\n   * Get or create a user-specific salt for key derivation\n   */\n  private async getUserSalt(): Promise<Uint8Array> {\n    try {\n      // Try to get existing salt from secure storage\n      let saltBase64: string | null = null;\n      \n      if (Platform.OS === 'web') {\n        saltBase64 = localStorage.getItem(ClientEncryptionService.USER_SALT_KEY);\n      } else {\n        // Use AsyncStorage for mobile platforms (Note: consider upgrading to expo-secure-store for production)\n        saltBase64 = await AsyncStorage.getItem(ClientEncryptionService.USER_SALT_KEY);\n      }\n\n      if (saltBase64) {\n        // Convert base64 back to Uint8Array\n        const binaryString = atob(saltBase64);\n        const salt = new Uint8Array(binaryString.length);\n        for (let i = 0; i < binaryString.length; i++) {\n          salt[i] = binaryString.charCodeAt(i);\n        }\n        return salt;\n      }\n\n      // Generate new salt if none exists\n      const newSalt = crypto.getRandomValues(new Uint8Array(ClientEncryptionService.SALT_LENGTH));\n      \n      // Convert to base64 for storage\n      const saltArray = Array.from(newSalt);\n      const saltBase64New = btoa(String.fromCharCode(...saltArray));\n\n      // Store securely\n      if (Platform.OS === 'web') {\n        localStorage.setItem(ClientEncryptionService.USER_SALT_KEY, saltBase64New);\n      } else {\n        await AsyncStorage.setItem(ClientEncryptionService.USER_SALT_KEY, saltBase64New);\n      }\n\n      logger.info('Generated new user salt for encryption');\n      return newSalt;\n    } catch (error) {\n      logger.error('Failed to get or create user salt:', error);\n      throw new Error('Failed to initialize encryption salt');\n    }\n  }\n\n  /**\n   * Derive encryption key from user secret using PBKDF2\n   */\n  private async deriveKeyFromSecret(params: KeyDerivationParams): Promise<CryptoKey> {\n    if (!this.isWebCryptoAvailable()) {\n      throw new Error('Web Crypto API not available');\n    }\n\n    const { userSecret, salt, iterations = ClientEncryptionService.DEFAULT_ITERATIONS } = params;\n    \n    try {\n      // Convert user secret to key material\n      const encoder = new TextEncoder();\n      const keyMaterial = await crypto.subtle.importKey(\n        'raw',\n        encoder.encode(userSecret),\n        'PBKDF2',\n        false,\n        ['deriveKey']\n      );\n\n      // Use provided salt or get user-specific salt\n      const derivationSalt = salt || await this.getUserSalt();\n\n      // Derive the actual encryption key\n      const key = await crypto.subtle.deriveKey(\n        {\n          name: 'PBKDF2',\n          salt: derivationSalt,\n          iterations: iterations,\n          hash: 'SHA-256'\n        },\n        keyMaterial,\n        {\n          name: ClientEncryptionService.ALGORITHM,\n          length: ClientEncryptionService.KEY_LENGTH\n        },\n        false, // Key is not extractable\n        ['encrypt', 'decrypt']\n      );\n\n      return key;\n    } catch (error) {\n      logger.error('Failed to derive encryption key:', error);\n      throw new Error('Key derivation failed');\n    }\n  }\n\n  /**\n   * Derive per-user master key from OPAQUE export key using HKDF\n   * Lives only in memory; never persisted\n   */\n  private async getUserMasterKey(): Promise<CryptoKey> {\n    if (!opaqueKeyManager.isInitialized()) {\n      throw new Error('OPAQUE key manager not initialized');\n    }\n    const exportKey = opaqueKeyManager.getExportKey();\n    // Import raw export key for HKDF\n    const ikm = await crypto.subtle.importKey('raw', exportKey, 'HKDF', false, ['deriveKey']);\n    const masterKey = await crypto.subtle.deriveKey(\n      {\n        name: 'HKDF',\n        hash: 'SHA-256',\n        // Use zero salt by default; exportKey already high entropy; info distinguishes use\n        salt: new Uint8Array(32),\n        info: new TextEncoder().encode(ClientEncryptionService.MASTER_INFO),\n      },\n      ikm,\n      {\n        name: ClientEncryptionService.ALGORITHM,\n        length: ClientEncryptionService.KEY_LENGTH,\n      },\n      false,\n      ['encrypt', 'decrypt', 'wrapKey', 'unwrapKey']\n    );\n    return masterKey;\n  }\n\n  /**\n   * Generate a new random content key for a single entry\n   */\n  private async generateEntryKey(): Promise<CryptoKey> {\n    return await crypto.subtle.generateKey(\n      { name: ClientEncryptionService.ALGORITHM, length: ClientEncryptionService.KEY_LENGTH },\n      true,\n      ['encrypt', 'decrypt']\n    );\n  }\n\n  /**\n   * Export CryptoKey to raw bytes\n   */\n  private async exportRawKey(key: CryptoKey): Promise<Uint8Array> {\n    const raw = await crypto.subtle.exportKey('raw', key);\n    return new Uint8Array(raw);\n  }\n\n  /**\n   * Wrap entry key with per-user master key\n   */\n  private async wrapEntryKey(entryKey: CryptoKey, masterKey: CryptoKey, wrapIv: Uint8Array): Promise<Uint8Array> {\n    const wrapped = await crypto.subtle.encrypt(\n      { name: ClientEncryptionService.ALGORITHM, iv: wrapIv },\n      masterKey,\n      await this.exportRawKey(entryKey)\n    );\n    return new Uint8Array(wrapped);\n  }\n\n  /**\n   * Encrypt content using per-user master key wrapping a per-entry key\n   */\n  async encryptPerUser(content: string): Promise<EncryptionResult> {\n    if (!this.isWebCryptoAvailable()) {\n      throw new Error('Encryption not available on this platform');\n    }\n\n    try {\n      // Derive per-user master key from OPAQUE export key\n      const masterKey = await this.getUserMasterKey();\n      // Generate per-entry key\n      const entryKey = await this.generateEntryKey();\n\n      // Generate random IV\n      const iv = crypto.getRandomValues(new Uint8Array(ClientEncryptionService.IV_LENGTH));\n      const wrapIv = crypto.getRandomValues(new Uint8Array(ClientEncryptionService.IV_LENGTH));\n\n      // Encrypt the content\n      const encoder = new TextEncoder();\n      const encryptedData = await crypto.subtle.encrypt(\n        {\n          name: ClientEncryptionService.ALGORITHM,\n          iv: iv\n        },\n        entryKey,\n        encoder.encode(content)\n      );\n\n      // Wrap entry key with master key\n      const wrapped = await this.wrapEntryKey(entryKey, masterKey, wrapIv);\n\n      // Convert to base64 for storage/transmission\n      const encryptedArray = new Uint8Array(encryptedData);\n      const encryptedBase64 = btoa(String.fromCharCode(...encryptedArray));\n      const ivBase64 = btoa(String.fromCharCode(...iv));\n      const wrapIvBase64 = btoa(String.fromCharCode(...wrapIv));\n      const wrappedBase64 = btoa(String.fromCharCode(...wrapped));\n\n      logger.info('Content encrypted successfully');\n      \n      return {\n        encryptedContent: encryptedBase64,\n        iv: ivBase64,\n        wrappedKey: wrappedBase64,\n        wrapIv: wrapIvBase64,\n        algorithm: ClientEncryptionService.ALGORITHM,\n      };\n    } catch (error) {\n      logger.error('Encryption failed:', error);\n      throw new Error('Failed to encrypt content');\n    }\n  }\n\n  /**\n   * Decrypt content using user-derived key\n   */\n  async decryptContent(\n    encryptedContent: string, \n    iv: string, \n    userSecret: string,\n    salt?: string\n  ): Promise<string> {\n    if (!this.isWebCryptoAvailable()) {\n      throw new Error('Decryption not available on this platform');\n    }\n\n    try {\n      // Convert base64 back to Uint8Array\n      const encryptedData = new Uint8Array(\n        atob(encryptedContent).split('').map(char => char.charCodeAt(0))\n      );\n      const ivArray = new Uint8Array(\n        atob(iv).split('').map(char => char.charCodeAt(0))\n      );\n      \n      // Use provided salt or get stored salt\n      let saltArray: Uint8Array;\n      if (salt) {\n        saltArray = new Uint8Array(\n          atob(salt).split('').map(char => char.charCodeAt(0))\n        );\n      } else {\n        saltArray = await this.getUserSalt();\n      }\n\n      // Derive the same key used for encryption\n      const key = await this.deriveKeyFromSecret({ userSecret, salt: saltArray });\n\n      // Decrypt the content\n      const decryptedData = await crypto.subtle.decrypt(\n        {\n          name: ClientEncryptionService.ALGORITHM,\n          iv: ivArray\n        },\n        key,\n        encryptedData\n      );\n\n      // Convert back to string\n      const decoder = new TextDecoder();\n      const decryptedContent = decoder.decode(decryptedData);\n\n      logger.info('Content decrypted successfully');\n      return decryptedContent;\n    } catch (error) {\n      logger.error('Decryption failed:', error);\n      throw new Error('Failed to decrypt content - invalid key or corrupted data');\n    }\n  }\n\n  /**\n   * Verify if a user secret can decrypt a given encrypted content\n   */\n  async verifyUserSecret(\n    encryptedContent: string,\n    iv: string,\n    userSecret: string,\n    salt?: string\n  ): Promise<boolean> {\n    try {\n      await this.decryptContent(encryptedContent, iv, userSecret, salt);\n      return true;\n    } catch (error) {\n      return false;\n    }\n  }\n\n  /**\n   * Clear stored encryption data (for logout/reset)\n   */\n  async clearEncryptionData(): Promise<void> {\n    try {\n      if (Platform.OS === 'web') {\n        localStorage.removeItem(ClientEncryptionService.USER_SALT_KEY);\n        localStorage.removeItem(ClientEncryptionService.KEY_DERIVATION_PARAMS_KEY);\n      } else {\n        await AsyncStorage.removeItem(ClientEncryptionService.USER_SALT_KEY);\n        await AsyncStorage.removeItem(ClientEncryptionService.KEY_DERIVATION_PARAMS_KEY);\n      }\n      logger.info('Encryption data cleared');\n    } catch (error) {\n      logger.error('Failed to clear encryption data:', error);\n    }\n  }\n\n  /**\n   * Generate a strong random secret for initial setup\n   */\n  generateRandomSecret(length: number = 32): string {\n    const charset = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*';\n    const randomBytes = crypto.getRandomValues(new Uint8Array(length));\n    \n    return Array.from(randomBytes)\n      .map(byte => charset[byte % charset.length])\n      .join('');\n  }\n\n  /**\n   * Test encryption/decryption functionality\n   */\n  async testEncryption(): Promise<boolean> {\n    try {\n      const testContent = 'This is a test message for encryption verification';\n      const testSecret = 'test-user-secret-phrase-123';\n      \n      const encrypted = await this.encryptContent(testContent, testSecret);\n      const decrypted = await this.decryptContent(\n        encrypted.encryptedContent,\n        encrypted.iv,\n        testSecret,\n        encrypted.salt\n      );\n      \n      const success = decrypted === testContent;\n      logger.info('Encryption test:', success ? 'PASSED' : 'FAILED');\n      return success;\n    } catch (error) {\n      logger.error('Encryption test failed:', error);\n      return false;\n    }\n  }\n}\n\n// Export singleton instance\nexport const clientEncryption = new ClientEncryptionService();\nexport default clientEncryption; ","/**\n * Hidden Mode Context with Zero-Knowledge Encryption\n * \n * This context manages hidden mode state and handles client-side encryption\n * using user-controlled secrets that never leave the device.\n */\n\nimport React, { createContext, useContext, useState, useCallback, useEffect } from 'react';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport clientEncryption from '../services/clientEncryption';\nimport logger from '../utils/logger';\n\ninterface HiddenModeContextValue {\n  // State\n  isHiddenMode: boolean;\n  isSetupRequired: boolean;\n  isUnlocked: boolean;\n  \n  // Actions\n  setupHiddenMode: (userSecret: string) => Promise<void>;\n  unlockHiddenMode: (userSecret: string) => Promise<boolean>;\n  lockHiddenMode: () => void;\n  clearHiddenMode: () => Promise<void>;\n  \n  // Encryption utilities\n  encryptContent: (content: string) => Promise<{ encryptedContent: string; iv: string; salt: string }>;\n  decryptContent: (encryptedContent: string, iv: string, salt?: string) => Promise<string>;\n  \n  // Session management\n  sessionTimeoutMinutes: number;\n  setSessionTimeout: (minutes: number) => void;\n  extendSession: () => void;\n  getRemainingSessionTime: () => number;\n}\n\nconst HiddenModeContext = createContext<HiddenModeContextValue | undefined>(undefined);\n\ninterface HiddenModeProviderProps {\n  children: React.ReactNode;\n}\n\nexport const HiddenModeProvider: React.FC<HiddenModeProviderProps> = ({ children }) => {\n  const [isHiddenMode, setIsHiddenMode] = useState(false);\n  const [isSetupRequired, setIsSetupRequired] = useState(true);\n  const [isUnlocked, setIsUnlocked] = useState(false);\n  const [userSecret, setUserSecret] = useState<string | null>(null);\n  const [sessionTimeoutMinutes, setSessionTimeoutMinutes] = useState(2);\n  const [sessionEndTime, setSessionEndTime] = useState<number | null>(null);\n  const [sessionTimer, setSessionTimer] = useState<NodeJS.Timeout | null>(null);\n\n  // Storage keys\n  const HIDDEN_MODE_SETUP_KEY = 'hidden_mode_setup_completed';\n  const VERIFICATION_DATA_KEY = 'hidden_mode_verification';\n  const SESSION_TIMEOUT_KEY = 'hidden_mode_session_timeout';\n\n  /**\n   * Check if hidden mode has been set up\n   */\n  const checkSetupStatus = useCallback(async () => {\n    try {\n      const setupCompleted = await AsyncStorage.getItem(HIDDEN_MODE_SETUP_KEY);\n      const verificationData = await AsyncStorage.getItem(VERIFICATION_DATA_KEY);\n      \n      setIsSetupRequired(!(setupCompleted === 'true' && verificationData));\n      \n      // Load session timeout preference\n      const storedTimeout = await AsyncStorage.getItem(SESSION_TIMEOUT_KEY);\n      if (storedTimeout) {\n        setSessionTimeoutMinutes(parseInt(storedTimeout, 10));\n      }\n    } catch (error) {\n      logger.error('Failed to check hidden mode setup status:', error);\n      setIsSetupRequired(true);\n    }\n  }, []);\n\n  /**\n   * Set up hidden mode with user secret\n   */\n  const setupHiddenMode = useCallback(async (secret: string): Promise<void> => {\n    try {\n      if (!secret || secret.length < 8) {\n        throw new Error('Secret must be at least 8 characters long');\n      }\n\n      // Test encryption with the user secret\n      const testSuccess = await clientEncryption.testEncryption();\n      if (!testSuccess) {\n        throw new Error('Encryption test failed - device may not support required security features');\n      }\n\n      // Create verification data by encrypting a known test string\n      const verificationText = 'HIDDEN_MODE_VERIFICATION_SUCCESS';\n      const verificationData = await clientEncryption.encryptContent(verificationText, secret);\n\n      // Store setup completion and verification data\n      await AsyncStorage.setItem(HIDDEN_MODE_SETUP_KEY, 'true');\n      await AsyncStorage.setItem(VERIFICATION_DATA_KEY, JSON.stringify(verificationData));\n\n      setIsSetupRequired(false);\n      setUserSecret(secret);\n      setIsUnlocked(true);\n      setIsHiddenMode(true);\n\n      // Start session timer\n      startSessionTimer();\n\n      logger.info('Hidden mode setup completed successfully');\n    } catch (error) {\n      logger.error('Hidden mode setup failed:', error);\n      throw error;\n    }\n  }, []);\n\n  /**\n   * Unlock hidden mode with user secret\n   */\n  const unlockHiddenMode = useCallback(async (secret: string): Promise<boolean> => {\n    try {\n      if (!secret) {\n        return false;\n      }\n\n      // Get verification data\n      const verificationDataJson = await AsyncStorage.getItem(VERIFICATION_DATA_KEY);\n      if (!verificationDataJson) {\n        logger.error('No verification data found - hidden mode not set up');\n        return false;\n      }\n\n      const verificationData = JSON.parse(verificationDataJson);\n      \n      // Try to decrypt verification data with provided secret\n      const decryptedText = await clientEncryption.decryptContent(\n        verificationData.encryptedContent,\n        verificationData.iv,\n        secret,\n        verificationData.salt\n      );\n\n      // Check if decryption was successful\n      if (decryptedText === 'HIDDEN_MODE_VERIFICATION_SUCCESS') {\n        setUserSecret(secret);\n        setIsUnlocked(true);\n        setIsHiddenMode(true);\n        startSessionTimer();\n        \n        logger.info('Hidden mode unlocked successfully');\n        return true;\n      } else {\n        logger.warn('Hidden mode unlock failed - incorrect secret');\n        return false;\n      }\n    } catch (error) {\n      logger.error('Hidden mode unlock error:', error);\n      return false;\n    }\n  }, []);\n\n  /**\n   * Lock hidden mode and clear sensitive data\n   */\n  const lockHiddenMode = useCallback(() => {\n    setUserSecret(null);\n    setIsUnlocked(false);\n    setIsHiddenMode(false);\n    setSessionEndTime(null);\n    \n    if (sessionTimer) {\n      clearTimeout(sessionTimer);\n      setSessionTimer(null);\n    }\n    \n    logger.info('Hidden mode locked');\n  }, [sessionTimer]);\n\n  /**\n   * Clear all hidden mode data (reset/delete)\n   */\n  const clearHiddenMode = useCallback(async (): Promise<void> => {\n    try {\n      // Clear stored data\n      await AsyncStorage.removeItem(HIDDEN_MODE_SETUP_KEY);\n      await AsyncStorage.removeItem(VERIFICATION_DATA_KEY);\n      await AsyncStorage.removeItem(SESSION_TIMEOUT_KEY);\n      \n      // Clear encryption data\n      await clientEncryption.clearEncryptionData();\n      \n      // Reset state\n      lockHiddenMode();\n      setIsSetupRequired(true);\n      \n      logger.info('Hidden mode data cleared');\n    } catch (error) {\n      logger.error('Failed to clear hidden mode data:', error);\n      throw error;\n    }\n  }, [lockHiddenMode]);\n\n  /**\n   * Start session timer\n   */\n  const startSessionTimer = useCallback(() => {\n    if (sessionTimer) {\n      clearTimeout(sessionTimer);\n    }\n\n    const endTime = Date.now() + (sessionTimeoutMinutes * 60 * 1000);\n    setSessionEndTime(endTime);\n\n    const timer = setTimeout(() => {\n      logger.info('Hidden mode session timed out');\n      lockHiddenMode();\n    }, sessionTimeoutMinutes * 60 * 1000);\n\n    setSessionTimer(timer);\n  }, [sessionTimeoutMinutes, sessionTimer, lockHiddenMode]);\n\n  /**\n   * Extend current session\n   */\n  const extendSession = useCallback(() => {\n    if (isUnlocked) {\n      startSessionTimer();\n      logger.info('Hidden mode session extended');\n    }\n  }, [isUnlocked, startSessionTimer]);\n\n  /**\n   * Get remaining session time in seconds\n   */\n  const getRemainingSessionTime = useCallback((): number => {\n    if (!sessionEndTime || !isUnlocked) {\n      return 0;\n    }\n    \n    const remaining = Math.max(0, Math.floor((sessionEndTime - Date.now()) / 1000));\n    return remaining;\n  }, [sessionEndTime, isUnlocked]);\n\n  /**\n   * Set session timeout and persist preference\n   */\n  const setSessionTimeoutWithPersistence = useCallback(async (minutes: number) => {\n    setSessionTimeoutMinutes(minutes);\n    try {\n      await AsyncStorage.setItem(SESSION_TIMEOUT_KEY, minutes.toString());\n    } catch (error) {\n      logger.error('Failed to save session timeout preference:', error);\n    }\n  }, []);\n\n  /**\n   * Encrypt content using current user secret\n   */\n  const encryptContent = useCallback(async (content: string) => {\n    if (!userSecret) {\n      throw new Error('Hidden mode not unlocked - cannot encrypt');\n    }\n    \n    return await clientEncryption.encryptContent(content, userSecret);\n  }, [userSecret]);\n\n  /**\n   * Decrypt content using current user secret\n   */\n  const decryptContent = useCallback(async (encryptedContent: string, iv: string, salt?: string) => {\n    if (!userSecret) {\n      throw new Error('Hidden mode not unlocked - cannot decrypt');\n    }\n    \n    return await clientEncryption.decryptContent(encryptedContent, iv, userSecret, salt);\n  }, [userSecret]);\n\n  // Initialize setup status on mount\n  useEffect(() => {\n    checkSetupStatus();\n  }, [checkSetupStatus]);\n\n  // Cleanup timer on unmount\n  useEffect(() => {\n    return () => {\n      if (sessionTimer) {\n        clearTimeout(sessionTimer);\n      }\n    };\n  }, [sessionTimer]);\n\n  const value: HiddenModeContextValue = {\n    // State\n    isHiddenMode,\n    isSetupRequired,\n    isUnlocked,\n    \n    // Actions\n    setupHiddenMode,\n    unlockHiddenMode,\n    lockHiddenMode,\n    clearHiddenMode,\n    \n    // Encryption utilities\n    encryptContent,\n    decryptContent,\n    \n    // Session management\n    sessionTimeoutMinutes,\n    setSessionTimeout: setSessionTimeoutWithPersistence,\n    extendSession,\n    getRemainingSessionTime,\n  };\n\n  return (\n    <HiddenModeContext.Provider value={value}>\n      {children}\n    </HiddenModeContext.Provider>\n  );\n};\n\n/**\n * Hook to use hidden mode context\n */\nexport const useHiddenMode = (): HiddenModeContextValue => {\n  const context = useContext(HiddenModeContext);\n  if (!context) {\n    throw new Error('useHiddenMode must be used within a HiddenModeProvider');\n  }\n  return context;\n};\n\nexport default HiddenModeProvider; ","import React, { useRef, useState } from 'react';\nimport { View, Text, StyleSheet, Pressable, Animated, Platform } from 'react-native';\nimport { format, parseISO } from 'date-fns';\nimport { Ionicons } from '@expo/vector-icons';\n\nimport { JournalEntry, Tag } from '../types';\nimport { useAppTheme } from '../contexts/ThemeContext';\nimport { AppTheme } from '../config/theme';\n\n// Helper to determine if native driver should be used\nconst useNativeDriver = Platform.OS !== 'web';\n\ninterface JournalCardProps {\n  entry: JournalEntry;\n  onPress?: (entry: JournalEntry) => void;\n  style?: object;\n}\n\nconst JournalCard: React.FC<JournalCardProps> = ({ entry, onPress, style }) => {\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n  const [isPressed, setIsPressed] = useState(false);\n  const scaleAnim = useRef(new Animated.Value(1)).current;\n\n  const getPreviewText = (content: string, maxLength: number = 120) => {\n    if (!content) return 'No content';\n    if (content.length <= maxLength) return content;\n    return `${content.substring(0, maxLength)}...`;\n  };\n\n  const formattedDate = format(\n    typeof entry.entry_date === 'string' ? parseISO(entry.entry_date) : entry.entry_date,\n    'MMM dd, yyyy'\n  );\n\n  const formattedTime = format(\n    typeof entry.entry_date === 'string' ? parseISO(entry.entry_date) : entry.entry_date,\n    'h:mm a'\n  );\n\n  const handlePressIn = () => {\n    setIsPressed(true);\n    Animated.spring(scaleAnim, {\n      toValue: 0.98,\n      useNativeDriver,\n      tension: 100,\n      friction: 3,\n    }).start();\n  };\n\n  const handlePressOut = () => {\n    setIsPressed(false);\n    Animated.spring(scaleAnim, {\n      toValue: 1,\n      useNativeDriver,\n      tension: 100,\n      friction: 3,\n    }).start();\n  };\n\n  const handlePress = () => {\n    if (onPress) {\n      onPress(entry);\n    }\n  };\n\n  const animatedStyle = {\n    transform: [{ scale: scaleAnim }],\n    opacity: scaleAnim.interpolate({\n      inputRange: [0.98, 1],\n      outputRange: [0.8, 1],\n    }),\n  };\n  \n  return (\n    <Animated.View style={[animatedStyle, style]}>\n      <Pressable \n        style={[\n          styles.container,\n          isPressed && styles.pressed\n        ]} \n        onPress={handlePress}\n        onPressIn={handlePressIn}\n        onPressOut={handlePressOut}\n        testID=\"journal-card\"\n      >\n        {/* Header with date and audio indicator */}\n        <View style={styles.header}>\n          <View style={styles.dateContainer}>\n            <Text style={styles.date} testID=\"journal-date\">{formattedDate}</Text>\n            <Text style={styles.time}>{formattedTime}</Text>\n          </View>\n          {entry.audio_url && (\n            <View style={styles.audioIndicator}>\n              <Ionicons name=\"musical-notes\" size={18} color={theme.colors.accent} />\n            </View>\n          )}\n        </View>\n        \n        {/* Title */}\n        {entry.title && (\n          <Text style={styles.title} testID=\"journal-title\" numberOfLines={2}>\n            {entry.title}\n          </Text>\n        )}\n        \n        {/* Content preview */}\n        <Text \n          style={styles.content} \n          numberOfLines={3}\n          testID=\"journal-content\"\n        >\n          {getPreviewText(entry.content)}\n        </Text>\n        \n        {/* Tags */}\n        {entry.tags && entry.tags.length > 0 && (\n          <View style={styles.tagsContainer} testID=\"tags-container\">\n            {entry.tags.slice(0, 3).map((tag: Tag, index: number) => (\n              <View key={`${entry.id}-tag-${tag.id || index}-${tag.name}`} style={styles.tag} testID={`tag-${tag.id ?? index}`}>\n                <Text style={styles.tagText}>{tag.name}</Text>\n              </View>\n            ))}\n            {entry.tags.length > 3 && (\n              <View key={`${entry.id}-more-tags`} style={styles.moreTagsIndicator}>\n                <Text style={styles.moreTagsText}>+{entry.tags.length - 3}</Text>\n              </View>\n            )}\n          </View>\n        )}\n\n        {/* Bottom accent line */}\n        <View style={styles.accentLine} />\n      </Pressable>\n    </Animated.View>\n  );\n};\n\nconst getStyles = (theme: AppTheme) => StyleSheet.create({\n  container: {\n    backgroundColor: theme.colors.card,\n    borderRadius: theme.borderRadius.xl,\n    padding: theme.spacing.lg,\n    marginVertical: theme.spacing.sm,\n    marginHorizontal: theme.spacing.xs,\n    ...theme.shadows.md,\n    borderColor: theme.colors.borderLight,\n    borderWidth: theme.isDarkMode ? 1 : 0,\n    overflow: 'hidden',\n  },\n  pressed: {\n    backgroundColor: theme.isDarkMode \n      ? theme.colors.gray800 \n      : theme.colors.gray100,\n  },\n  header: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'flex-start',\n    marginBottom: theme.spacing.md,\n  },\n  dateContainer: {\n    flex: 1,\n  },\n  date: {\n    fontSize: theme.typography.fontSizes.sm,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.medium,\n    marginBottom: theme.spacing.xs / 2,\n  },\n  time: {\n    fontSize: theme.typography.fontSizes.xs,\n    color: theme.colors.textDisabled,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  audioIndicator: {\n    backgroundColor: theme.colors.accentLight,\n    borderRadius: theme.borderRadius.full,\n    padding: theme.spacing.sm,\n    marginLeft: theme.spacing.md,\n  },\n  title: {\n    fontSize: theme.typography.fontSizes.xl,\n    fontWeight: '600',\n    color: theme.colors.text,\n    marginBottom: theme.spacing.md,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n    lineHeight: theme.typography.lineHeights.tight * theme.typography.fontSizes.xl,\n  },\n  content: {\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.textSecondary,\n    marginBottom: theme.spacing.lg,\n    lineHeight: theme.typography.lineHeights.normal * theme.typography.fontSizes.md,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  tagsContainer: {\n    flexDirection: 'row',\n    flexWrap: 'wrap',\n    marginBottom: theme.spacing.sm,\n  },\n  tag: {\n    backgroundColor: theme.isDarkMode ? theme.colors.gray700 : theme.colors.primaryLight + '20',\n    borderRadius: theme.borderRadius.full,\n    paddingHorizontal: theme.spacing.md,\n    paddingVertical: theme.spacing.sm,\n    marginRight: theme.spacing.sm,\n    marginBottom: theme.spacing.sm,\n    borderWidth: 1,\n    borderColor: theme.isDarkMode ? theme.colors.gray600 : theme.colors.primaryLight + '40',\n  },\n  tagText: {\n    fontSize: theme.typography.fontSizes.xs,\n    color: theme.isDarkMode ? theme.colors.text : theme.colors.primary,\n    fontFamily: theme.typography.fontFamilies.medium,\n    fontWeight: '500',\n  },\n  moreTagsIndicator: {\n    backgroundColor: theme.colors.gray300,\n    borderRadius: theme.borderRadius.full,\n    paddingHorizontal: theme.spacing.md,\n    paddingVertical: theme.spacing.sm,\n    marginRight: theme.spacing.sm,\n    marginBottom: theme.spacing.sm,\n  },\n  moreTagsText: {\n    fontSize: theme.typography.fontSizes.xs,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.medium,\n  },\n  accentLine: {\n    position: 'absolute',\n    bottom: 0,\n    left: 0,\n    right: 0,\n    height: 3,\n    backgroundColor: theme.colors.primary,\n    borderBottomLeftRadius: theme.borderRadius.xl,\n    borderBottomRightRadius: theme.borderRadius.xl,\n  },\n});\n\nexport default JournalCard; ","import React from 'react';\nimport { View, Text, StyleSheet } from 'react-native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { useAppTheme } from '../contexts/ThemeContext';\nimport { AppTheme } from '../config/theme';\n\ninterface ScreenHeaderProps {\n  title: string;\n  showSecretTagIndicator?: boolean;\n  secretTagText?: string;\n}\n\nconst ScreenHeader: React.FC<ScreenHeaderProps> = ({ \n  title, \n  showSecretTagIndicator = false, \n  secretTagText = \"Secret Tags Active\" \n}) => {\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n\n  return (\n    <View style={styles.header}>\n      <Text style={styles.title}>{title}</Text>\n      {showSecretTagIndicator && (\n        <View style={styles.secretTagIndicator}>\n          <Ionicons name=\"shield-checkmark\" size={16} color={theme.colors.primary} />\n          <Text style={styles.secretTagText}>{secretTagText}</Text>\n        </View>\n      )}\n    </View>\n  );\n};\n\nconst getStyles = (theme: AppTheme) => StyleSheet.create({\n  header: {\n    backgroundColor: theme.colors.card,\n    paddingHorizontal: theme.spacing.lg,\n    paddingVertical: theme.spacing.lg,\n    borderBottomWidth: 1,\n    borderBottomColor: theme.colors.border,\n    alignItems: 'center',\n  },\n  title: {\n    fontSize: theme.typography.fontSizes.xl,\n    fontWeight: 'bold',\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.bold,\n  },\n  secretTagIndicator: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginTop: theme.spacing.xs,\n    paddingHorizontal: theme.spacing.sm,\n    paddingVertical: theme.spacing.xs,\n    backgroundColor: theme.colors.primaryLight || theme.colors.primary + '20',\n    borderRadius: 12,\n  },\n  secretTagText: {\n    fontSize: theme.typography.fontSizes.xs,\n    color: theme.colors.primary,\n    marginLeft: theme.spacing.xs,\n    fontFamily: theme.typography.fontFamilies.medium,\n  },\n});\n\nexport default ScreenHeader; ","/**\n * Greeting Service for Dynamic Home Screen Messages\n * \n * Provides time-based and context-aware greetings that rotate to keep\n * the user experience fresh and engaging.\n */\n\nexport interface GreetingData {\n  mainGreeting: string;\n}\n\ninterface TimeBasedGreetings {\n  morning: string[];\n  afternoon: string[];\n  evening: string[];\n  nightOwl: string[];\n}\n\n\n\n// Time-based greeting templates\nconst TIME_GREETINGS: TimeBasedGreetings = {\n  morning: [\n    \"Good morning, {userName} 🌅\",\n    \"{userName}, let's start fresh ✨\",\n    \"What are you hoping for today, {userName}? 🌱\",\n    \"{userName}, the day is yours — what's on your mind? ☀️\",\n    \"Morning clarity, {userName} 🧘\",\n    \"Ready to capture today's thoughts, {userName}? 📝\",\n    \"Rise and shine, {userName} 🌞\",\n    \"{userName}, what dreams are you chasing today? 💫\",\n    \"Morning energy is calling, {userName} 🔥\",\n    \"{userName}, ready to make today count? 💪\",\n    \"New day, fresh perspective, {userName} 🌿\",\n    \"What's inspiring you this morning, {userName}? 💡\",\n    \"{userName}, time to bloom 🌺\",\n    \"Morning motivation time, {userName} ⚡\",\n    \"Seize the morning, {userName} 🏆\",\n    \"{userName}, what story will today tell? 📚\",\n    \"Morning energy is strong, {userName} 🎵\",\n    \"Ready for today's adventure, {userName}? 🗺️\",\n  ],\n  afternoon: [\n    \"Good afternoon, {userName} ☀️\",\n    \"How's your day going, {userName}? 🤔\",\n    \"{userName}, got something to reflect on? 💭\",\n    \"Midday pause — want to journal something, {userName}? ⏸️\",\n    \"Perfect time for reflection, {userName} 🎯\",\n    \"What's been on your mind today, {userName}? 🧠\",\n    \"{userName}, time for a mental check-in 📊\",\n    \"How are you feeling right now, {userName}? 💝\",\n    \"{userName}, ready to process some thoughts? 🔄\",\n    \"What's working well today, {userName}? ✅\",\n    \"{userName}, any insights to capture? 🎨\",\n    \"Taking a moment to breathe, {userName}? 🫁\",\n    \"What's your energy like today, {userName}? ⚡\",\n    \"{userName}, time to organize your thoughts? 📋\",\n    \"Any breakthroughs to record, {userName}? 🚀\",\n    \"{userName}, how's your heart feeling? ❤️\",\n    \"Ready to dive deeper, {userName}? 🏊\",\n    \"What patterns are you noticing, {userName}? 🔍\",\n  ],\n  evening: [\n    \"Good evening, {userName} 🌆\",\n    \"Evening is perfect for reflection, {userName} 🌙\",\n    \"What stood out today, {userName}? ⭐\",\n    \"Unwind your thoughts, {userName} 🛋️\",\n    \"{userName}, time to process the day 📖\",\n    \"Evening reflections, {userName}? 🌸\",\n    \"Ready to wind down, {userName}? 🕯️\",\n    \"What are you grateful for today, {userName}? 🙏\",\n    \"{userName}, time to let go of today's stress 🌊\",\n    \"Any lessons from today, {userName}? 🎓\",\n    \"How did today shape you, {userName}? 🏺\",\n    \"{userName}, ready for some evening clarity? 🔮\",\n    \"What emotions need attention, {userName}? 🎭\",\n    \"{userName}, time to celebrate today's wins? 🎉\",\n    \"Any worries to release, {userName}? 🕊️\",\n    \"What's your heart telling you, {userName}? 💖\",\n    \"Ready to make peace with today, {userName}? ☮️\",\n    \"{userName}, time for gentle self-reflection? 🪞\",\n  ],\n  nightOwl: [\n    \"Up late, {userName}? 🌙\",\n    \"Night thoughts can be powerful, {userName} 💫\",\n    \"{userName}, let's capture what's on your mind 🌌\",\n    \"Rest easier — journal it out, {userName} 😴\",\n    \"Late night insights, {userName} 🦉\",\n    \"Sometimes the best thoughts come at night, {userName} ✨\",\n    \"What's keeping you up, {userName}? 🤯\",\n    \"{userName}, midnight reflections calling? 🕛\",\n    \"Ready to quiet the mind, {userName}? 🧘‍♀️\",\n    \"Any deep thoughts to explore, {userName}? 🌊\",\n    \"{userName}, night time, right time for journaling? 📝\",\n    \"What's your soul whispering, {userName}? 👻\",\n    \"{userName}, ready to release today's thoughts? 🎈\",\n    \"Any dreams to document, {userName}? 💤\",\n    \"{userName}, late night wisdom session? 🧙‍♂️\",\n    \"What's stirring in your heart, {userName}? 🌪️\",\n    \"{userName}, time to empty the mental jar? 🫙\",\n    \"Ready for some nocturnal therapy, {userName}? 🌃\",\n  ],\n};\n\n\n\n// Time periods in 24-hour format\nenum TimePeriod {\n  MORNING = 'morning',     // 5:00 - 11:59\n  AFTERNOON = 'afternoon', // 12:00 - 17:59\n  EVENING = 'evening',     // 18:00 - 22:59\n  NIGHT_OWL = 'nightOwl',  // 23:00 - 4:59\n}\n\n/**\n * Determines the current time period based on local device time\n */\nfunction getCurrentTimePeriod(): TimePeriod {\n  const now = new Date();\n  const hour = now.getHours();\n\n  if (hour >= 5 && hour < 12) {\n    return TimePeriod.MORNING;\n  } else if (hour >= 12 && hour < 18) {\n    return TimePeriod.AFTERNOON;\n  } else if (hour >= 18 && hour < 23) {\n    return TimePeriod.EVENING;\n  } else {\n    return TimePeriod.NIGHT_OWL;\n  }\n}\n\n/**\n * Generates a pseudo-random index based on date and time period\n * This ensures greetings rotate but remain consistent within the same time period of the same day\n */\nfunction getRotationIndex(arrayLength: number, timePeriod: TimePeriod): number {\n  const today = new Date();\n  const dateString = today.toDateString(); // \"Mon Oct 09 2023\"\n  const seed = dateString + timePeriod;\n  \n  // Simple hash function for consistent pseudo-randomness\n  let hash = 0;\n  for (let i = 0; i < seed.length; i++) {\n    const char = seed.charCodeAt(i);\n    hash = ((hash << 5) - hash) + char;\n    hash = hash & hash; // Convert to 32-bit integer\n  }\n  \n  return Math.abs(hash) % arrayLength;\n}\n\n\n\n/**\n * Main function to get dynamic greeting based on time\n */\nexport function getDynamicGreeting(\n  userName: string = 'there'\n): GreetingData {\n  const timePeriod = getCurrentTimePeriod();\n  const timeGreetings = TIME_GREETINGS[timePeriod];\n  \n  // Get main greeting with rotation\n  const mainIndex = getRotationIndex(timeGreetings.length, timePeriod);\n  const mainGreeting = timeGreetings[mainIndex].replace('{userName}', userName);\n  \n  return {\n    mainGreeting,\n  };\n}\n\n/**\n * Utility function to get a preview of all possible greetings for testing\n */\nexport function getAllGreetingPreviews(userName: string = 'User'): Record<string, string[]> {\n  const previews: Record<string, string[]> = {};\n  \n  Object.entries(TIME_GREETINGS).forEach(([period, greetings]) => {\n    previews[period] = greetings.map((greeting: string) => \n      greeting.replace('{userName}', userName)\n    );\n  });\n  \n  return previews;\n}\n\n/**\n * Get the current time period as a string (useful for debugging)\n */\nexport function getCurrentTimePeriodString(): string {\n  return getCurrentTimePeriod();\n} ","import React, { useEffect, useState, useMemo } from 'react';\nimport { \n  View, \n  Text, \n  StyleSheet, \n  TouchableOpacity, \n  ActivityIndicator,\n  RefreshControl,\n  Alert,\n  Platform\n} from 'react-native';\nimport { useNavigation, useFocusEffect } from '@react-navigation/native';\nimport { CompositeNavigationProp } from '@react-navigation/native';\nimport { StackNavigationProp } from '@react-navigation/stack';\nimport { BottomTabNavigationProp } from '@react-navigation/bottom-tabs';\nimport { Ionicons } from '@expo/vector-icons';\nimport { format } from 'date-fns';\n\nimport { useAuth } from '../../contexts/AuthContext';\nimport { useHiddenMode } from '../../contexts/HiddenModeContext';\nimport { api } from '../../services/api';\nimport { JournalEntry, Tag } from '../../types';\nimport JournalCard from '../../components/JournalCard';\nimport SafeScrollView from '../../components/SafeScrollView';\nimport ScreenHeader from '../../components/ScreenHeader';\nimport { MainStackParamList, MainTabParamList } from '../../navigation/types';\nimport { logger } from '../../utils/logger';\nimport { useAppTheme } from '../../contexts/ThemeContext';\nimport { AppTheme } from '../../config/theme';\nimport { getDynamicGreeting, GreetingData } from '../../services/greetingService';\n\n// --- Special Tag for Hidden Entries (Client-Side) ---\n// TODO: Move this to a shared constants file\nconst HIDDEN_ENTRY_TAG = \"_hidden_entry\";\n// ----------------------------------------------------\n\ntype HomeScreenNavigationProp = CompositeNavigationProp<\n  BottomTabNavigationProp<MainTabParamList, 'Home'>,\n  StackNavigationProp<MainStackParamList>\n>;\n\nconst HomeScreen = () => {\n  const navigation = useNavigation<HomeScreenNavigationProp>();\n  const { user } = useAuth();\n  const { theme } = useAppTheme();\n  const { isHiddenMode } = useHiddenMode();\n  const styles = getStyles(theme);\n  \n  // Extract first name for greeting\n  const getFirstName = () => {\n    if (user?.full_name) {\n      return user.full_name.split(' ')[0]; // Get first part of the name\n    }\n    return 'there'; // Fallback greeting\n  };\n  \n  const [recentEntries, setRecentEntries] = useState<JournalEntry[]>([]);\n  const [stats, setStats] = useState({\n    totalEntries: 0,\n    currentStreak: 0,\n    entriesThisWeek: 0,\n  });\n  const [loading, setLoading] = useState(true);\n  const [refreshing, setRefreshing] = useState(false);\n\n  // Get dynamic greeting based on time and user name\n  const greetingData: GreetingData = useMemo(() => {\n    return getDynamicGreeting(getFirstName());\n  }, [user?.full_name]);\n\n  // Filter entries based on hidden mode\n  const displayedEntries = useMemo(() => {\n    if (isHiddenMode) {\n      return recentEntries;\n    }\n    // Correctly check if any tag object has a name matching HIDDEN_ENTRY_TAG\n    return recentEntries.filter(entry => \n      !entry.tags.some((tag: Tag) => tag.name === HIDDEN_ENTRY_TAG)\n    );\n  }, [recentEntries, isHiddenMode]);\n\n  // Replace useEffect with useFocusEffect to fetch data whenever the screen comes into focus\n  useFocusEffect(\n    React.useCallback(() => {\n      // Fetch data when the screen gains focus\n      fetchData();\n\n      // Optional: Return a cleanup function if needed\n      // return () => console.log('HomeScreen blurred');\n    }, []) // Dependency array is empty, so it runs on every focus\n  );\n\n  // Log recentEntries IDs when they change, for debugging key prop warning\n  useEffect(() => {\n    if (recentEntries.length > 0) {\n      // Only log in debug mode and check for duplicate IDs\n      const ids = recentEntries.map(entry => entry.id);\n      const uniqueIds = [...new Set(ids)];\n      if (ids.length !== uniqueIds.length) {\n        logger.warn('HomeScreen: Duplicate entry IDs detected!', { ids, uniqueIds });\n      }\n    }\n  }, [recentEntries]);\n\n  // Log displayedEntries IDs when they change, for debugging key prop warning\n  useEffect(() => {\n    if (displayedEntries.length > 0) {\n      // Only check for duplicate IDs in displayed entries\n      const displayedIds = displayedEntries.map(entry => entry.id);\n      const uniqueDisplayedIds = [...new Set(displayedIds)];\n      if (displayedIds.length !== uniqueDisplayedIds.length) {\n        logger.warn('HomeScreen: Duplicate displayed entry IDs detected!', { displayedIds, uniqueDisplayedIds });\n      }\n    }\n  }, [displayedEntries]);\n\n  const fetchData = async () => {\n    try {\n      setLoading(true);\n      \n      // Fetch user stats from the new backend endpoint with the correct prefix\n      const statsResponse = await api.get('/api/users/me/stats');\n      setStats({\n        totalEntries: statsResponse.data.total_entries,\n        currentStreak: statsResponse.data.current_streak,\n        entriesThisWeek: statsResponse.data.entries_this_week,\n      });\n      \n      // Fetch recent entries, ensuring descending order by entry_date\n      const entriesResponse = await api.get('/api/journals/', {\n        params: { \n          limit: 1, // Only show 1 most recent entry on the home screen\n          sort: 'entry_date:desc' // Explicitly request sorting if backend supports it\n        }\n      });\n      const entries = Array.isArray(entriesResponse.data)\n        ? entriesResponse.data\n        : (entriesResponse.data?.entries ?? []);\n      setRecentEntries(entries);\n      \n    } catch (error: any) {\n      // Log the specific error\n      logger.error('HomeScreen: Error fetching home data', { \n        message: error.message, \n        status: error.response?.status,\n        data: error.response?.data\n      });\n      // In development mode, don't show error alert\n      if (!__DEV__) {\n        Alert.alert('Error', 'Failed to load your data');\n      }\n    } finally {\n      setLoading(false);\n      setRefreshing(false);\n    }\n  };\n\n  const onRefresh = () => {\n    setRefreshing(true);\n    fetchData();\n  };\n\n  const navigateToRecord = () => {\n    // Navigate to Record modal in the parent MainStack\n    navigation.navigate('Record');\n  };\n\n  const navigateToJournalList = () => {\n    navigation.navigate('Journal', { screen: 'JournalList' });\n  };\n\n  const navigateToDetail = (entryId: number) => {\n    // Navigate to JournalEntryDetail in the main stack\n    navigation.navigate('JournalEntryDetail', { entryId: entryId.toString() });\n  };\n\n  const handleVibePress = (vibeId: string, tag: string) => {\n    // Define vibe prompts based on evidence-driven recommendations\n    const vibePrompts: Record<string, string> = {\n      grateful: \"What are you thankful for?\",\n      reflect: \"What's been on your mind?\", \n      inspired: \"Capture that idea before it fades!\",\n      stressed: \"Want to unload what's weighing you down?\",\n      plan: \"What's your next step or goal?\"\n    };\n\n    // Navigate to Record modal with vibe parameters and prompt\n    const prompt = vibePrompts[vibeId];\n    navigation.navigate('Record', {\n      vibeEmoji: vibeId, // Keep the same parameter name for compatibility\n      vibeTag: tag,\n      prefilledPrompt: prompt,\n    });\n  };\n\n  if (loading && !refreshing) {\n    return (\n      <View style={styles.loadingContainer}>\n        <ActivityIndicator size=\"large\" color={theme.colors.primary} testID=\"loading-indicator\" />\n      </View>\n    );\n  }\n\n  return (\n    <View style={styles.container}>\n      <ScreenHeader title=\"Home\" />\n      \n      <SafeScrollView \n        style={styles.scrollContainer}\n        refreshControl={\n          Platform.OS !== 'web' ? (\n            <RefreshControl refreshing={refreshing} onRefresh={onRefresh} colors={[theme.colors.primary]} tintColor={theme.colors.primary} />\n          ) : undefined\n        }\n      >\n        <View style={styles.greetingContainer}>\n          <View style={styles.greetingCard}>\n            <View style={styles.greetingContent}>\n              <Text style={styles.greeting}>{greetingData.mainGreeting}</Text>\n              <Text style={styles.date}>{format(new Date(), 'EEEE, MMMM d')}</Text>\n            </View>\n          </View>\n        </View>\n\n              <View style={styles.statsContainer}>\n        <View style={styles.statCard}>\n          <Ionicons name=\"book\" size={24} color={theme.colors.primary} style={styles.statIcon} />\n          <Text style={styles.statValue}>{stats.totalEntries}</Text>\n          <Text style={styles.statLabel}>Entries</Text>\n        </View>\n        <View style={[styles.statCard, styles.streakCard]}>\n          <Ionicons name=\"flame\" size={24} color=\"#FF6B35\" style={styles.statIcon} />\n          <Text style={[styles.statValue, styles.streakValue]}>{stats.currentStreak}</Text>\n          <Text style={styles.statLabel}>Streak</Text>\n        </View>\n        <View style={styles.statCard}>\n          <Ionicons name=\"calendar\" size={24} color={theme.colors.secondary} style={styles.statIcon} />\n          <Text style={[styles.statValue, styles.weekValue]}>{stats.entriesThisWeek}</Text>\n          <Text style={styles.statLabel}>Week</Text>\n        </View>\n      </View>\n\n      {/* Current Vibe Section */}\n      <View style={styles.vibeContainer}>\n        <Text style={styles.vibeTitle}>Your Current Vibe 💫</Text>\n        <View style={styles.vibeButtonsContainer}>\n          <TouchableOpacity \n            style={styles.vibeButton}\n            onPress={() => handleVibePress('grateful', 'gratitude')}\n            activeOpacity={0.7}\n          >\n            <Ionicons name=\"heart-outline\" size={24} color=\"#B39DFF\" style={styles.vibeIcon} />\n            <Text style={styles.vibeLabel}>Grateful</Text>\n          </TouchableOpacity>\n          \n          <TouchableOpacity \n            style={styles.vibeButton}\n            onPress={() => handleVibePress('reflect', 'reflection')}\n            activeOpacity={0.7}\n          >\n            <Ionicons name=\"book-outline\" size={24} color=\"#6E7CFF\" style={styles.vibeIcon} />\n            <Text style={styles.vibeLabel}>Reflective</Text>\n          </TouchableOpacity>\n          \n          <TouchableOpacity \n            style={styles.vibeButton}\n            onPress={() => handleVibePress('inspired', 'idea')}\n            activeOpacity={0.7}\n          >\n            <Ionicons name=\"bulb-outline\" size={24} color=\"#FFD966\" style={styles.vibeIcon} />\n            <Text style={styles.vibeLabel}>Inspired</Text>\n          </TouchableOpacity>\n          \n          <TouchableOpacity \n            style={styles.vibeButton}\n            onPress={() => handleVibePress('stressed', 'stress')}\n            activeOpacity={0.7}\n          >\n            <Ionicons name=\"rainy-outline\" size={24} color=\"#8CBFFF\" style={styles.vibeIcon} />\n            <Text style={styles.vibeLabel}>Stressed</Text>\n          </TouchableOpacity>\n          \n          <TouchableOpacity \n            style={styles.vibeButton}\n            onPress={() => handleVibePress('plan', 'plan')}\n            activeOpacity={0.7}\n          >\n            <Ionicons name=\"radio-button-on-outline\" size={24} color=\"#51C1C1\" style={styles.vibeIcon} />\n            <Text style={styles.vibeLabel}>Planning</Text>\n          </TouchableOpacity>\n        </View>\n      </View>\n\n      <View style={styles.sectionHeader}>\n        <Text style={styles.sectionTitle}>Last Entry</Text>\n        <TouchableOpacity onPress={navigateToJournalList}>\n          <Text style={styles.seeAllText}>See All</Text>\n        </TouchableOpacity>\n      </View>\n\n      {displayedEntries.length > 0 ? (\n        <JournalCard \n          key={`home-entry-${displayedEntries[0].id}`} \n          entry={displayedEntries[0]} \n          onPress={() => navigateToDetail(displayedEntries[0].id)}\n        />\n      ) : (\n        <View style={styles.emptyContainer}>\n          <Ionicons name=\"book-outline\" size={theme.spacing.xxl} color={theme.colors.disabled} />\n          <Text style={styles.emptyText}>No journal entries yet</Text>\n          <TouchableOpacity \n            style={styles.startButton}\n            onPress={navigateToRecord}\n          >\n            <Text style={styles.startButtonText}>Start Journaling</Text>\n          </TouchableOpacity>\n        </View>\n      )}\n      </SafeScrollView>\n    </View>\n  );\n};\n\n// Function to generate styles based on the theme\nconst getStyles = (theme: AppTheme) => StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: theme.colors.background,\n  },\n  scrollContainer: {\n    flex: 1,\n  },\n  loadingContainer: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n    backgroundColor: theme.colors.background,\n  },\n  greetingContainer: {\n    paddingHorizontal: theme.spacing.lg,\n    paddingTop: theme.spacing.md,\n    paddingBottom: theme.spacing.lg,\n  },\n  greetingCard: {\n    backgroundColor: theme.colors.card,\n    borderRadius: theme.borderRadius.xl,\n    padding: theme.spacing.lg,\n    elevation: theme.isDarkMode ? 1 : 2,\n    shadowColor: theme.colors.shadow,\n    shadowOffset: { width: 0, height: theme.isDarkMode ? 1 : 2 },\n    shadowOpacity: theme.isDarkMode ? 0.15 : 0.08,\n    shadowRadius: theme.isDarkMode ? 2 : 4,\n    borderColor: theme.isDarkMode ? theme.colors.border : 'transparent',\n    borderWidth: theme.isDarkMode ? 1 : 0,\n  },\n  greetingContent: {\n    alignItems: 'flex-start',\n  },\n  greeting: {\n    fontSize: theme.typography.fontSizes.xl,\n    fontWeight: '600',\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n    lineHeight: theme.typography.lineHeights.tight * theme.typography.fontSizes.xl,\n  },\n\n  date: {\n    fontSize: theme.typography.fontSizes.lg,\n    color: theme.colors.textSecondary,\n    marginTop: theme.spacing.sm,\n    fontFamily: theme.typography.fontFamilies.regular,\n    lineHeight: theme.typography.lineHeights.normal * theme.typography.fontSizes.lg,\n  },\n  statsContainer: {\n    flexDirection: 'row',\n    justifyContent: 'center',\n    alignItems: 'center',\n    paddingHorizontal: theme.spacing.lg,\n    paddingVertical: theme.spacing.lg,\n    gap: theme.spacing.md,\n  },\n  statCard: {\n    backgroundColor: theme.colors.card,\n    borderRadius: 12,\n    padding: theme.spacing.lg,\n    alignItems: 'center',\n    width: '30%',\n    elevation: theme.isDarkMode ? 2 : 3,\n    shadowColor: theme.colors.black,\n    shadowOffset: { width: 0, height: theme.isDarkMode ? 2 : 3 },\n    shadowOpacity: theme.isDarkMode ? 0.2 : 0.08,\n    shadowRadius: theme.isDarkMode ? 3 : 4,\n    borderColor: theme.isDarkMode ? theme.colors.border : 'transparent',\n    borderWidth: theme.isDarkMode ? 1 : 0,\n  },\n  streakCard: {\n    backgroundColor: theme.isDarkMode ? theme.colors.card : '#FFF8F5',\n    borderColor: theme.isDarkMode ? theme.colors.border : '#FFE5D9',\n    borderWidth: 1,\n  },\n  statIcon: {\n    marginBottom: theme.spacing.sm,\n  },\n  statValue: {\n    fontSize: theme.typography.fontSizes.xxl,\n    fontWeight: 'bold',\n    color: theme.colors.primary,\n    fontFamily: theme.typography.fontFamilies.bold,\n    marginBottom: theme.spacing.xs,\n  },\n  streakValue: {\n    color: '#FF6B35',\n  },\n  weekValue: {\n    color: theme.colors.secondary,\n  },\n  statLabel: {\n    fontSize: theme.typography.fontSizes.xs,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.medium,\n    textAlign: 'center',\n    height: 16, // Fixed height for consistent alignment\n    lineHeight: 16,\n  },\n  sectionHeader: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    paddingHorizontal: theme.spacing.lg,\n    paddingTop: theme.spacing.lg,\n    paddingBottom: theme.spacing.sm,\n  },\n  sectionTitle: {\n    fontSize: theme.typography.fontSizes.xl,\n    fontWeight: 'bold',\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.bold,\n  },\n  seeAllText: {\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.primary,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n  emptyContainer: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n    padding: theme.spacing.lg,\n    marginTop: theme.spacing.xxl,\n  },\n  emptyText: {\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.textSecondary,\n    marginTop: theme.spacing.md,\n    marginBottom: theme.spacing.lg,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  startButton: {\n    backgroundColor: theme.colors.primary,\n    paddingVertical: theme.spacing.md,\n    paddingHorizontal: theme.spacing.xl,\n    borderRadius: 25,\n    marginTop: theme.spacing.md,\n  },\n  startButtonText: {\n    color: theme.isDarkMode ? theme.colors.background : theme.colors.white,\n    fontSize: theme.typography.fontSizes.md,\n    fontWeight: 'bold',\n    fontFamily: theme.typography.fontFamilies.bold,\n  },\n  // Vibe section styles\n  vibeContainer: {\n    paddingHorizontal: theme.spacing.lg,\n    paddingVertical: theme.spacing.lg,\n  },\n  vibeTitle: {\n    fontSize: theme.typography.fontSizes.xl,\n    fontWeight: 'bold',\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.bold,\n    marginBottom: theme.spacing.md,\n    textAlign: 'center',\n  },\n  vibeButtonsContainer: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n  },\n  vibeButton: {\n    backgroundColor: theme.colors.card,\n    borderRadius: 12,\n    padding: theme.spacing.md,\n    alignItems: 'center',\n    justifyContent: 'center',\n    width: '18%',\n    elevation: theme.isDarkMode ? 1 : 2,\n    shadowColor: theme.colors.shadow,\n    shadowOffset: { width: 0, height: theme.isDarkMode ? 1 : 2 },\n    shadowOpacity: theme.isDarkMode ? 0.15 : 0.08,\n    shadowRadius: theme.isDarkMode ? 2 : 3,\n    borderColor: theme.isDarkMode ? theme.colors.border : 'transparent',\n    borderWidth: theme.isDarkMode ? 1 : 0,\n  },\n  vibeIcon: {\n    marginBottom: theme.spacing.xs,\n  },\n  vibeLabel: {\n    fontSize: theme.typography.fontSizes.xs,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.medium,\n    textAlign: 'center',\n  },\n  \n});\n\nexport default HomeScreen; ","import React, { useEffect, useRef } from 'react';\nimport { View, StyleSheet, Animated, Dimensions } from 'react-native';\nimport { useAppTheme } from '../contexts/ThemeContext';\nimport { AppTheme } from '../config/theme';\n\ninterface SkeletonLoaderProps {\n  width?: number | string;\n  height?: number;\n  borderRadius?: number;\n  style?: any;\n  animated?: boolean;\n}\n\nconst SkeletonLoader: React.FC<SkeletonLoaderProps> = ({\n  width = '100%',\n  height = 20,\n  borderRadius = 4,\n  style,\n  animated = true,\n}) => {\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n  const animatedValue = useRef(new Animated.Value(0)).current;\n\n  useEffect(() => {\n    if (animated) {\n      const animation = Animated.loop(\n        Animated.sequence([\n          Animated.timing(animatedValue, {\n            toValue: 1,\n            duration: 1000,\n            useNativeDriver: false,\n          }),\n          Animated.timing(animatedValue, {\n            toValue: 0,\n            duration: 1000,\n            useNativeDriver: false,\n          }),\n        ])\n      );\n      animation.start();\n      return () => animation.stop();\n    }\n  }, [animated, animatedValue]);\n\n  const backgroundColor = animated\n    ? animatedValue.interpolate({\n        inputRange: [0, 1],\n        outputRange: [\n          theme.colors.skeleton || theme.colors.gray200,\n          theme.colors.skeletonHighlight || theme.colors.gray300,\n        ],\n      })\n    : theme.colors.skeleton || theme.colors.gray200;\n\n  return (\n    <Animated.View\n      style={[\n        styles.skeleton,\n        {\n          width,\n          height,\n          borderRadius,\n          backgroundColor,\n        },\n        style,\n      ]}\n    />\n  );\n};\n\n// Predefined skeleton components for common use cases\nexport const JournalCardSkeleton: React.FC = () => {\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n\n  return (\n    <View style={styles.journalCardSkeleton}>\n      <View style={styles.journalCardHeader}>\n        <SkeletonLoader width=\"60%\" height={18} />\n        <SkeletonLoader width={80} height={14} />\n      </View>\n      <SkeletonLoader width=\"100%\" height={16} style={{ marginTop: theme.spacing.sm }} />\n      <SkeletonLoader width=\"85%\" height={16} style={{ marginTop: theme.spacing.xs }} />\n      <SkeletonLoader width=\"70%\" height={16} style={{ marginTop: theme.spacing.xs }} />\n      <View style={styles.journalCardFooter}>\n        <SkeletonLoader width={60} height={12} />\n        <SkeletonLoader width={40} height={12} />\n      </View>\n    </View>\n  );\n};\n\nexport const CalendarSkeleton: React.FC = () => {\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n\n  return (\n    <View style={styles.calendarSkeleton}>\n      {/* Calendar header */}\n      <View style={styles.calendarHeader}>\n        <SkeletonLoader width={30} height={30} borderRadius={15} />\n        <SkeletonLoader width={120} height={20} />\n        <SkeletonLoader width={30} height={30} borderRadius={15} />\n      </View>\n      \n      {/* Calendar grid */}\n      <View style={styles.calendarGrid}>\n        {Array.from({ length: 35 }, (_, index) => (\n          <SkeletonLoader\n            key={index}\n            width={35}\n            height={35}\n            borderRadius={4}\n            style={{ margin: 2 }}\n          />\n        ))}\n      </View>\n    </View>\n  );\n};\n\nexport const SettingsSkeleton: React.FC = () => {\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n\n  return (\n    <View style={styles.settingsSkeleton}>\n      {Array.from({ length: 6 }, (_, index) => (\n        <View key={index} style={styles.settingsRow}>\n          <View style={styles.settingsRowLeft}>\n            <SkeletonLoader width={24} height={24} borderRadius={12} />\n            <View style={styles.settingsRowText}>\n              <SkeletonLoader width=\"70%\" height={16} />\n              <SkeletonLoader width=\"50%\" height={12} style={{ marginTop: theme.spacing.xs }} />\n            </View>\n          </View>\n          <SkeletonLoader width={50} height={20} borderRadius={10} />\n        </View>\n      ))}\n    </View>\n  );\n};\n\nconst getStyles = (theme: AppTheme) => {\n  const { width } = Dimensions.get('window');\n  \n  return StyleSheet.create({\n    skeleton: {\n      overflow: 'hidden',\n    },\n    journalCardSkeleton: {\n      backgroundColor: theme.colors.card,\n      padding: theme.spacing.md,\n      marginHorizontal: theme.spacing.md,\n      marginVertical: theme.spacing.sm,\n      borderRadius: theme.spacing.sm,\n      borderWidth: 1,\n      borderColor: theme.colors.border,\n    },\n    journalCardHeader: {\n      flexDirection: 'row',\n      justifyContent: 'space-between',\n      alignItems: 'center',\n      marginBottom: theme.spacing.sm,\n    },\n    journalCardFooter: {\n      flexDirection: 'row',\n      justifyContent: 'space-between',\n      alignItems: 'center',\n      marginTop: theme.spacing.md,\n    },\n    calendarSkeleton: {\n      backgroundColor: theme.colors.card,\n      padding: theme.spacing.md,\n      margin: theme.spacing.md,\n      borderRadius: theme.spacing.sm,\n    },\n    calendarHeader: {\n      flexDirection: 'row',\n      justifyContent: 'space-between',\n      alignItems: 'center',\n      marginBottom: theme.spacing.md,\n    },\n    calendarGrid: {\n      flexDirection: 'row',\n      flexWrap: 'wrap',\n      justifyContent: 'space-around',\n    },\n    settingsSkeleton: {\n      padding: theme.spacing.md,\n    },\n    settingsRow: {\n      flexDirection: 'row',\n      justifyContent: 'space-between',\n      alignItems: 'center',\n      paddingVertical: theme.spacing.md,\n      borderBottomWidth: 1,\n      borderBottomColor: theme.colors.border,\n    },\n    settingsRowLeft: {\n      flexDirection: 'row',\n      alignItems: 'center',\n      flex: 1,\n    },\n    settingsRowText: {\n      marginLeft: theme.spacing.md,\n      flex: 1,\n    },\n  });\n};\n\nexport default SkeletonLoader; ","import React, { useState, useEffect, useCallback, useMemo, useRef } from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  TouchableOpacity,\n  RefreshControl,\n  TextInput,\n  Alert,\n  ScrollView,\n  Platform,\n  FlatList,\n} from 'react-native';\nimport { useNavigation, useFocusEffect } from '@react-navigation/native';\nimport { CompositeNavigationProp } from '@react-navigation/native';\nimport { StackNavigationProp } from '@react-navigation/stack';\nimport { BottomTabNavigationProp } from '@react-navigation/bottom-tabs';\nimport { Ionicons } from '@expo/vector-icons';\nimport { format } from 'date-fns';\n\nimport { JournalAPI, TagsAPI } from '../../services/api';\nimport JournalCard from '../../components/JournalCard';\nimport { JournalCardSkeleton } from '../../components/SkeletonLoader';\nimport SafeScrollView from '../../components/SafeScrollView';\nimport ScreenHeader from '../../components/ScreenHeader';\n\nimport { JournalEntry, Tag } from '../../types';\nimport { MainStackParamList, MainTabParamList, JournalStackParamList } from '../../navigation/types';\nimport { useAppTheme } from '../../contexts/ThemeContext';\nimport { useHiddenMode } from '../../contexts/HiddenModeContext';\nimport { AppTheme } from '../../config/theme';\n\n// --- Special Tag for Hidden Entries (Client-Side) ---\n// TODO: Move this to a shared constants file\nconst HIDDEN_ENTRY_TAG = \"_hidden_entry\";\n// ----------------------------------------------------\n\n// Define navigation prop types for tab navigation with access to main stack\ntype JournalScreenNavigationProp = CompositeNavigationProp<\n  BottomTabNavigationProp<MainTabParamList, 'Journal'>,\n  StackNavigationProp<MainStackParamList>\n>;\n\nconst JournalScreen = () => {\n  const navigation = useNavigation<JournalScreenNavigationProp>();\n  const { theme } = useAppTheme();\n  const { isHiddenMode } = useHiddenMode();\n  const styles = getStyles(theme);\n  \n  // State\n  const [entries, setEntries] = useState<JournalEntry[]>([]);\n  const [filteredEntries, setFilteredEntries] = useState<JournalEntry[]>([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [isRefreshing, setIsRefreshing] = useState(false);\n  const [searchQuery, setSearchQuery] = useState('');\n  const [availableTags, setAvailableTags] = useState<string[]>([]);\n  const [selectedTags, setSelectedTags] = useState<string[]>([]);\n  \n  // Scroll position persistence\n  const scrollViewRef = useRef<ScrollView>(null);\n  const scrollPosition = useRef({ offset: 0 });\n  const shouldRestoreScroll = useRef(false);\n  \n  // Save scroll position when leaving screen\n  const saveScrollPosition = useCallback(() => {\n    if (scrollViewRef.current) {\n      // Save current scroll offset for restoration\n      shouldRestoreScroll.current = true;\n    }\n  }, []);\n\n  // Fetch journal entries from API\n  const fetchEntries = async () => {\n    try {\n      setIsLoading(true);\n      \n      const response = await JournalAPI.getEntries({});\n      // Normalize possible response shapes\n      const data = Array.isArray(response.data)\n        ? response.data\n        : (response.data?.entries ?? []);\n      setEntries(data);\n    } catch (error) {\n      console.error('Error fetching journal entries', error);\n      Alert.alert('Error', 'Failed to load journal entries');\n    } finally {\n      setIsLoading(false);\n      setIsRefreshing(false);\n    }\n  };\n  \n  // Fetch available tags from API\n  const fetchTags = async () => {\n    try {\n      const response = await TagsAPI.getTags();\n      setAvailableTags(response.data.map((tag: Tag) => tag.name));\n    } catch (error) {\n      console.error('Error fetching tags', error);\n    }\n  };\n\n  // Restore scroll position after data loads\n  const restoreScrollPosition = useCallback(() => {\n    if (shouldRestoreScroll.current && scrollViewRef.current && filteredEntries.length > 0) {\n      const timer = setTimeout(() => {\n        try {\n          if (scrollPosition.current.offset > 0) {\n            scrollViewRef.current?.scrollTo({\n              y: scrollPosition.current.offset,\n              animated: false,\n            });\n          }\n          shouldRestoreScroll.current = false;\n        } catch (error) {\n          console.log('Failed to restore scroll position:', error);\n          shouldRestoreScroll.current = false;\n        }\n      }, 100); // Small delay to ensure content is rendered\n\n      return () => clearTimeout(timer);\n    }\n  }, [filteredEntries]);\n\n  // Fetch journal entries when screen is focused\n  useFocusEffect(\n    useCallback(() => {\n      // Test with a small delay\n      const timer = setTimeout(() => {\n        fetchEntries();\n        fetchTags();\n      }, 500); // 500ms delay\n\n      return () => {\n        clearTimeout(timer);\n        saveScrollPosition();\n      };\n    }, []) // Use empty dependency array to avoid circular dependency\n  );\n  \n  // Filter entries whenever search query, selected tags, base entries, or hidden mode changes\n  useEffect(() => {\n    filterEntries();\n  }, [searchQuery, selectedTags, entries, isHiddenMode]);\n\n  // Restore scroll position after filtered entries change\n  useEffect(() => {\n    restoreScrollPosition();\n  }, [restoreScrollPosition]);\n  \n  // Handle refresh\n  const onRefresh = () => {\n    setIsRefreshing(true);\n    fetchEntries();\n  };\n  \n  // Filter entries based on search query and selected tags\n  const filterEntries = () => {\n    let processedEntries = [...entries];\n    \n    // Filter by search query\n    if (searchQuery.trim()) {\n      const query = searchQuery.toLowerCase();\n      processedEntries = processedEntries.filter(entry => \n        entry.title.toLowerCase().includes(query) || \n        entry.content.toLowerCase().includes(query)\n      );\n    }\n    \n    // Filter by selected tags\n    if (selectedTags.length > 0) {\n      processedEntries = processedEntries.filter(entry => \n        selectedTags.every(selectedTagName => \n          entry.tags.some(tagObject => tagObject.name === selectedTagName)\n        )\n      );\n    }\n\n    // Filter by hidden mode status\n    if (!isHiddenMode) {\n      processedEntries = processedEntries.filter(entry => \n        !entry.tags.some(tagObject => tagObject.name === HIDDEN_ENTRY_TAG)\n      );\n    }\n    // If isHiddenMode is true, all entries (that match search/tags) are shown\n    \n    setFilteredEntries(processedEntries);\n  };\n  \n  // Toggle tag selection\n  const toggleTag = (tag: string) => {\n    if (selectedTags.includes(tag)) {\n      setSelectedTags(selectedTags.filter(t => t !== tag));\n    } else {\n      setSelectedTags([...selectedTags, tag]);\n    }\n  };\n  \n  // Navigate to entry creation screen\n  const handleCreateEntry = () => {\n    // Navigate to Record modal in the parent MainStack\n    navigation.navigate('Record');\n  };\n  \n  // Navigate to entry detail screen\n  const handleEntryPress = (entry: JournalEntry) => {\n    console.log('Entry pressed:', entry.id);\n    navigation.navigate('JournalEntryDetail', { entryId: entry.id.toString() });\n  };\n  \n  // Group entries by month for SectionList\n  const getSectionData = () => {\n    const grouped: { [key: string]: JournalEntry[] } = {};\n    \n    filteredEntries.forEach(entry => {\n      const date = new Date(entry.entry_date);\n      const monthYear = format(date, 'MMMM yyyy');\n      \n      if (!grouped[monthYear]) {\n        grouped[monthYear] = [];\n      }\n      \n      grouped[monthYear].push(entry);\n    });\n    \n    const sections = Object.entries(grouped).map(([month, entries]) => ({\n      title: month,\n      data: entries,\n    }));\n    \n    return sections;\n  };\n  \n  // Scroll to top functionality\n  const [showScrollToTop, setShowScrollToTop] = useState(false);\n\n  // Handle scroll events to save position and show/hide scroll-to-top button\n  const handleScroll = useCallback((event: any) => {\n    const { contentOffset } = event.nativeEvent;\n    scrollPosition.current.offset = contentOffset.y;\n    \n    // Show scroll-to-top button when scrolled down more than 200px\n    setShowScrollToTop(contentOffset.y > 200);\n  }, []);\n\n  // Scroll to top function\n  const scrollToTop = useCallback(() => {\n    if (scrollViewRef.current) {\n      scrollViewRef.current.scrollTo({\n        y: 0,\n        animated: true,\n      });\n    }\n  }, []);\n  \n  return (\n    <View style={styles.container}>\n      <ScreenHeader title=\"Journal\" />\n      \n      <View style={styles.searchContainer}>\n        <View style={styles.searchBar}>\n          <Ionicons name=\"search\" size={theme.typography.fontSizes.xl} color={theme.colors.textSecondary} style={styles.searchIcon} />\n          <TextInput\n            style={styles.searchInput}\n            placeholder=\"Search entries...\"\n            value={searchQuery}\n            onChangeText={setSearchQuery}\n            placeholderTextColor={theme.colors.textSecondary}\n          />\n          {searchQuery ? (\n            <TouchableOpacity onPress={() => setSearchQuery('')}>\n              <Ionicons name=\"close-circle\" size={theme.typography.fontSizes.xl} color={theme.colors.textSecondary} />\n            </TouchableOpacity>\n          ) : null}\n        </View>\n      </View>\n      \n      {availableTags.length > 0 && (\n        <View style={styles.tagsContainer}>\n          <ScrollView horizontal showsHorizontalScrollIndicator={false}>\n            {availableTags.map(tag => (\n              <TouchableOpacity\n                key={tag}\n                style={[\n                  styles.tagChip,\n                  selectedTags.includes(tag) && styles.tagChipSelected\n                ]}\n                onPress={() => toggleTag(tag)}\n              >\n                <Text \n                  style={[\n                    styles.tagText,\n                    selectedTags.includes(tag) && styles.tagTextSelected\n                  ]}\n                >\n                  #{tag}\n                </Text>\n              </TouchableOpacity>\n            ))}\n          </ScrollView>\n        </View>\n      )}\n      \n      <SafeScrollView \n        style={{ flex: 1 }} \n        contentContainerStyle={{ flexGrow: 1 }}\n        refreshControl={\n          <RefreshControl\n            refreshing={isRefreshing}\n            onRefresh={onRefresh}\n            colors={[theme.colors.primary]}\n            tintColor={theme.colors.primary}\n          />\n        }\n        onScroll={handleScroll}\n        scrollEventThrottle={16}\n      >\n        {isLoading ? (\n          <View style={styles.skeletonContainer}>\n            {Array.from({ length: 5 }, (_, index) => (\n              <JournalCardSkeleton key={`skeleton-${index}`} />\n            ))}\n          </View>\n        ) : (\n          <>\n            {filteredEntries.length === 0 ? (\n              <View style={styles.emptyContainer}>\n                <Ionicons name=\"journal-outline\" size={theme.spacing.xxl * 1.5} color={theme.colors.disabled} />\n                <Text style={styles.emptyText}>No journal entries found</Text>\n                <Text style={styles.emptySubtext}>\n                  {searchQuery || selectedTags.length > 0 || !isHiddenMode && entries.some(e => e.tags.some(t=>t.name === HIDDEN_ENTRY_TAG)) \n                    ? 'Try changing your search or filters, or check hidden mode.'\n                    : 'Tap the + button to create your first entry'}\n                </Text>\n              </View>\n            ) : (\n              <>\n                {getSectionData().map((section, sectionIndex) => (\n                  <View key={section.title} style={styles.monthSection}>\n                    <Text style={styles.monthTitle}>{section.title}</Text>\n                    {section.data.map((entry, entryIndex) => (\n                      <JournalCard \n                        key={`journal-entry-${entry.id}-${entryIndex}`}\n                        entry={entry}\n                        onPress={() => handleEntryPress(entry)}\n                      />\n                    ))}\n                  </View>\n                ))}\n              </>\n            )}\n          </>\n        )}\n      </SafeScrollView>\n      \n      {/* Scroll to Top Button */}\n      {showScrollToTop && (\n        <TouchableOpacity\n          style={styles.scrollToTopButton}\n          onPress={scrollToTop}\n          activeOpacity={0.8}\n        >\n          <Ionicons \n            name=\"chevron-up\" \n            size={24} \n            color={theme.colors.white} \n          />\n        </TouchableOpacity>\n      )}\n    </View>\n  );\n};\n\n// Function to generate styles based on the theme\nconst getStyles = (theme: AppTheme) => StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: theme.colors.background,\n  },\n\n  searchContainer: {\n    paddingHorizontal: theme.spacing.md,\n    paddingVertical: theme.spacing.sm,\n    backgroundColor: theme.colors.card,\n    borderBottomWidth: 1,\n    borderBottomColor: theme.colors.border,\n  },\n  searchBar: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: theme.colors.inputBackground,\n    borderRadius: theme.spacing.sm,\n    paddingHorizontal: theme.spacing.sm,\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n  },\n  searchIcon: {\n    marginRight: theme.spacing.sm,\n  },\n  searchInput: {\n    flex: 1,\n    paddingVertical: theme.spacing.sm,\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  tagsContainer: {\n    paddingVertical: theme.spacing.sm,\n    paddingHorizontal: theme.spacing.xs,\n    backgroundColor: theme.colors.card,\n    borderBottomWidth: 1,\n    borderBottomColor: theme.colors.border,\n  },\n  tagChip: {\n    paddingVertical: theme.spacing.xs,\n    paddingHorizontal: theme.spacing.md,\n    borderRadius: theme.spacing.lg,\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n    backgroundColor: theme.isDarkMode ? theme.colors.gray700 : theme.colors.gray100,\n    marginRight: theme.spacing.sm,\n  },\n  tagChipSelected: {\n    backgroundColor: theme.colors.primary,\n    borderColor: theme.colors.primary,\n  },\n  tagText: {\n    fontSize: theme.typography.fontSizes.sm,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  tagTextSelected: {\n    color: theme.colors.onPrimary,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n  loaderContainer: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n    backgroundColor: theme.colors.background,\n  },\n  skeletonContainer: {\n    flex: 1,\n    backgroundColor: theme.colors.background,\n    paddingTop: theme.spacing.sm,\n  },\n  emptyContainer: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n    padding: theme.spacing.lg,\n  },\n  emptyText: {\n    fontSize: theme.typography.fontSizes.lg,\n    color: theme.colors.textSecondary,\n    marginTop: theme.spacing.md,\n    textAlign: 'center',\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n  emptySubtext: {\n    fontSize: theme.typography.fontSizes.sm,\n    color: theme.colors.textSecondary,\n    marginTop: theme.spacing.sm,\n    textAlign: 'center',\n    paddingHorizontal: theme.spacing.xl,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  listContent: {\n    paddingBottom: theme.spacing.lg,\n  },\n  monthSection: {\n    marginBottom: theme.spacing.md,\n  },\n  monthTitle: {\n    fontSize: theme.typography.fontSizes.lg,\n    fontWeight: 'bold',\n    color: theme.colors.text,\n    paddingHorizontal: theme.spacing.lg,\n    paddingVertical: theme.spacing.sm,\n    backgroundColor: theme.isDarkMode ? theme.colors.gray800 : theme.colors.gray100,\n    fontFamily: theme.typography.fontFamilies.bold,\n  },\n  safeBottomPadding: {\n    // Base padding plus extra for navigation elements\n    paddingTop: theme.spacing.lg,\n    paddingBottom: Platform.OS === 'ios' ? 200 : 185,\n  },\n  scrollToTopButton: {\n    position: 'absolute',\n    bottom: Platform.OS === 'ios' ? 120 : 105, // Above the tab bar\n    right: theme.spacing.lg,\n    width: 48,\n    height: 48,\n    borderRadius: 24,\n    backgroundColor: theme.colors.primary,\n    justifyContent: 'center',\n    alignItems: 'center',\n    elevation: 8,\n    shadowColor: theme.colors.shadow,\n    shadowOffset: { width: 0, height: 4 },\n    shadowOpacity: 0.3,\n    shadowRadius: 8,\n    zIndex: 1000,\n  },\n});\n\nexport default JournalScreen; ","/**\n * Error types for OPAQUE Client operations\n * Provides structured error handling without information leakage\n */\n\n/**\n * Base error class for all OPAQUE-related errors\n */\nexport class OpaqueError extends Error {\n  public readonly code: string;\n  public readonly timestamp: Date;\n  public readonly cause?: unknown;\n\n  constructor(message: string, cause?: unknown, code = 'OPAQUE_ERROR') {\n    super(message);\n    this.name = 'OpaqueError';\n    this.code = code;\n    this.timestamp = new Date();\n    this.cause = cause;\n\n    // Ensure proper prototype chain for instanceof checks\n    Object.setPrototypeOf(this, OpaqueError.prototype);\n  }\n\n  /**\n   * Get a sanitized error message for logging (no sensitive information)\n   */\n  public getSanitizedMessage(): string {\n    return `${this.code}: ${this.message}`;\n  }\n\n  /**\n   * Get error details for debugging (internal use only)\n   */\n  public getDebugInfo(): Record<string, unknown> {\n    return {\n      code: this.code,\n      message: this.message,\n      timestamp: this.timestamp.toISOString(),\n      cause: this.cause,\n      stack: this.stack\n    };\n  }\n}\n\n/**\n * Authentication-specific error for OPAQUE operations\n */\nexport class AuthenticationError extends OpaqueError {\n  constructor(message: string, cause?: unknown) {\n    super(message, cause, 'AUTHENTICATION_ERROR');\n    this.name = 'AuthenticationError';\n    Object.setPrototypeOf(this, AuthenticationError.prototype);\n  }\n}\n\n/**\n * Network-related error for OPAQUE operations\n */\nexport class NetworkError extends OpaqueError {\n  public readonly statusCode?: number;\n\n  constructor(message: string, statusCode?: number, cause?: unknown) {\n    super(message, cause, 'NETWORK_ERROR');\n    this.name = 'NetworkError';\n    this.statusCode = statusCode;\n    Object.setPrototypeOf(this, NetworkError.prototype);\n  }\n}\n\n/**\n * Initialization error for OPAQUE client\n */\nexport class InitializationError extends OpaqueError {\n  constructor(message: string, cause?: unknown) {\n    super(message, cause, 'INITIALIZATION_ERROR');\n    this.name = 'InitializationError';\n    Object.setPrototypeOf(this, InitializationError.prototype);\n  }\n}\n\n/**\n * Memory management error for OPAQUE operations\n */\nexport class MemoryError extends OpaqueError {\n  constructor(message: string, cause?: unknown) {\n    super(message, cause, 'MEMORY_ERROR');\n    this.name = 'MemoryError';\n    Object.setPrototypeOf(this, MemoryError.prototype);\n  }\n}\n\n/**\n * Key derivation error for OPAQUE operations\n */\nexport class KeyDerivationError extends OpaqueError {\n  constructor(message: string, cause?: unknown) {\n    super(message, cause, 'KEY_DERIVATION_ERROR');\n    this.name = 'KeyDerivationError';\n    Object.setPrototypeOf(this, KeyDerivationError.prototype);\n  }\n}\n\n/**\n * Serialization/deserialization error for OPAQUE data\n */\nexport class SerializationError extends OpaqueError {\n  constructor(message: string, cause?: unknown) {\n    super(message, cause, 'SERIALIZATION_ERROR');\n    this.name = 'SerializationError';\n    Object.setPrototypeOf(this, SerializationError.prototype);\n  }\n}\n\n/**\n * Utility function to create user-friendly error messages\n * Ensures no sensitive information is leaked to users\n */\nexport function createUserMessage(error: OpaqueError): string {\n  switch (error.code) {\n    case 'AUTHENTICATION_ERROR':\n      return 'Authentication failed. Please check your credentials and try again.';\n    case 'NETWORK_ERROR':\n      return 'Network connection failed. Please check your internet connection and try again.';\n    case 'INITIALIZATION_ERROR':\n      return 'Application initialization failed. Please restart the app.';\n    case 'MEMORY_ERROR':\n      return 'Memory operation failed. Please restart the app.';\n    case 'KEY_DERIVATION_ERROR':\n      return 'Security key generation failed. Please try again.';\n    case 'SERIALIZATION_ERROR':\n      return 'Data processing failed. Please try again.';\n    default:\n      return 'An unexpected error occurred. Please try again.';\n  }\n}\n\n/**\n * Utility function to determine if an error is recoverable\n */\nexport function isRecoverableError(error: OpaqueError): boolean {\n  const recoverableCodes = [\n    'NETWORK_ERROR',\n    'AUTHENTICATION_ERROR'\n  ];\n  \n  return recoverableCodes.includes(error.code);\n}\n\n/**\n * Utility function to determine if error should trigger retry\n */\nexport function shouldRetry(error: OpaqueError, attemptCount: number, maxAttempts: number): boolean {\n  if (attemptCount >= maxAttempts) {\n    return false;\n  }\n\n  // Only retry network errors and certain initialization errors\n  return error.code === 'NETWORK_ERROR' || \n         (error.code === 'INITIALIZATION_ERROR' && attemptCount < 2);\n} ","/**\n * OPAQUE Client Wrapper\n * Provides a clean TypeScript interface for OPAQUE protocol operations\n * using the react-native-opaque package for cross-platform compatibility\n */\n\nimport * as opaque from 'react-native-opaque';\nimport { Platform } from 'react-native';\nimport logger from '../../utils/logger';\nimport { OpaqueError, AuthenticationError, NetworkError } from './errors';\n\n// Type definitions for OPAQUE operations\nexport interface RegistrationResult {\n  registrationRequest: string;\n  clientState: string;\n}\n\nexport interface RegistrationResponse {\n  registrationResponse: string;\n}\n\nexport interface RegistrationRecord {\n  registrationUpload: string;\n  exportKey: Uint8Array;\n}\n\nexport interface LoginResult {\n  credentialRequest: string;\n  clientState: string;\n}\n\nexport interface LoginResponse {\n  credentialResponse: string;\n}\n\nexport interface SessionResult {\n  credentialFinalization: string;\n  sessionKey: Uint8Array;\n  exportKey: Uint8Array;\n}\n\nexport interface VaultKeys {\n  tagId: Uint8Array;\n  dataKey: Uint8Array;\n  vaultId: string;\n}\n\n// Memory management for sensitive data\nclass SecureMemory {\n  private static sensitiveData: Set<Uint8Array> = new Set();\n\n  static register(data: Uint8Array): void {\n    this.sensitiveData.add(data);\n  }\n\n  static clear(data: Uint8Array): void {\n    if (this.sensitiveData.has(data)) {\n      data.fill(0);\n      this.sensitiveData.delete(data);\n    }\n  }\n\n  static clearAll(): void {\n    this.sensitiveData.forEach(data => data.fill(0));\n    this.sensitiveData.clear();\n  }\n}\n\n/**\n * OPAQUE Client - Main interface for OPAQUE protocol operations\n */\nexport class OpaqueClient {\n  private static instance: OpaqueClient;\n  private isInitialized = false;\n\n  private constructor() {}\n\n  public static getInstance(): OpaqueClient {\n    if (!OpaqueClient.instance) {\n      OpaqueClient.instance = new OpaqueClient();\n    }\n    return OpaqueClient.instance;\n  }\n\n  /**\n   * Initialize the OPAQUE client\n   * For web platforms, waits for WebAssembly module to load\n   */\n  public async initialize(): Promise<void> {\n    try {\n      if (Platform.OS === 'web') {\n        logger.info('Waiting for OPAQUE WebAssembly module to load');\n        await opaque.ready;\n        logger.info('OPAQUE WebAssembly module loaded successfully');\n      }\n      \n      this.isInitialized = true;\n      logger.info('OPAQUE client initialized successfully');\n    } catch (error) {\n      logger.error('Failed to initialize OPAQUE client', error);\n      throw new OpaqueError('OPAQUE initialization failed', error);\n    }\n  }\n\n  /**\n   * Start OPAQUE registration process\n   * @param password - User password for registration\n   * @returns Registration request and client state\n   */\n  public async startRegistration(password: string): Promise<RegistrationResult> {\n    this.ensureInitialized();\n    \n    try {\n      logger.debug('Starting OPAQUE registration');\n      \n      const result = opaque.client.startRegistration({ password });\n      \n      if (!result || !result.clientRegistrationState || !result.registrationRequest) {\n        throw new OpaqueError('Invalid registration result from OPAQUE library');\n      }\n\n      logger.debug('OPAQUE registration started successfully');\n      return {\n        registrationRequest: result.registrationRequest,\n        clientState: result.clientRegistrationState\n      };\n    } catch (error) {\n      logger.error('OPAQUE registration start failed', error);\n      if (error instanceof OpaqueError) {\n        throw error;\n      }\n      throw new OpaqueError('Failed to start OPAQUE registration', error);\n    }\n  }\n\n  /**\n   * Complete OPAQUE registration process\n   * @param password - User password\n   * @param clientState - Client state from startRegistration\n   * @param response - Server registration response\n   * @returns Registration record and export key\n   */\n  public async finishRegistration(\n    password: string,\n    clientState: string,\n    response: RegistrationResponse\n  ): Promise<RegistrationRecord> {\n    this.ensureInitialized();\n    \n    try {\n      logger.debug('Finishing OPAQUE registration');\n      \n      const result = opaque.client.finishRegistration({\n        password,\n        clientRegistrationState: clientState,\n        registrationResponse: response.registrationResponse\n      });\n\n      if (!result || !result.registrationUpload || !result.exportKey) {\n        throw new OpaqueError('Invalid registration finish result from OPAQUE library');\n      }\n\n      // Register export key for secure memory management\n      SecureMemory.register(result.exportKey);\n\n      logger.debug('OPAQUE registration finished successfully');\n      return {\n        registrationUpload: result.registrationUpload,\n        exportKey: result.exportKey\n      };\n    } catch (error) {\n      logger.error('OPAQUE registration finish failed', error);\n      if (error instanceof OpaqueError) {\n        throw error;\n      }\n      throw new OpaqueError('Failed to finish OPAQUE registration', error);\n    }\n  }\n\n  /**\n   * Start OPAQUE login/authentication process\n   * @param password - User password for authentication\n   * @returns Login request and client state\n   */\n  public async startLogin(password: string): Promise<LoginResult> {\n    this.ensureInitialized();\n    \n    try {\n      logger.debug('Starting OPAQUE login');\n      \n      const result = opaque.client.startLogin({ password });\n      \n      if (!result || !result.clientLoginState || !result.credentialRequest) {\n        throw new OpaqueError('Invalid login result from OPAQUE library');\n      }\n\n      logger.debug('OPAQUE login started successfully');\n      return {\n        credentialRequest: result.credentialRequest,\n        clientState: result.clientLoginState\n      };\n    } catch (error) {\n      logger.error('OPAQUE login start failed', error);\n      if (error instanceof OpaqueError) {\n        throw error;\n      }\n      throw new OpaqueError('Failed to start OPAQUE login', error);\n    }\n  }\n\n  /**\n   * Complete OPAQUE login process\n   * @param password - User password\n   * @param clientState - Client state from startLogin\n   * @param response - Server credential response\n   * @returns Session result with keys\n   */\n  public async finishLogin(\n    password: string,\n    clientState: string,\n    response: LoginResponse\n  ): Promise<SessionResult> {\n    this.ensureInitialized();\n    \n    try {\n      logger.debug('Finishing OPAQUE login');\n      \n      const result = opaque.client.finishLogin({\n        password,\n        clientLoginState: clientState,\n        credentialResponse: response.credentialResponse\n      });\n\n      if (!result || !result.credentialFinalization || !result.sessionKey || !result.exportKey) {\n        throw new AuthenticationError('OPAQUE authentication failed - invalid credentials');\n      }\n\n      // Register sensitive keys for secure memory management\n      SecureMemory.register(result.sessionKey);\n      SecureMemory.register(result.exportKey);\n\n      logger.debug('OPAQUE login finished successfully');\n      return {\n        credentialFinalization: result.credentialFinalization,\n        sessionKey: result.sessionKey,\n        exportKey: result.exportKey\n      };\n    } catch (error) {\n      logger.error('OPAQUE login finish failed', error);\n      if (error instanceof AuthenticationError) {\n        throw error;\n      }\n      if (error instanceof OpaqueError) {\n        throw error;\n      }\n      throw new OpaqueError('Failed to finish OPAQUE login', error);\n    }\n  }\n\n  /**\n   * Derive vault keys from export key for data encryption\n   * @param exportKey - Export key from OPAQUE session\n   * @param secretPhrase - The secret phrase used as additional input\n   * @returns Vault keys for encryption operations\n   */\n  public async deriveVaultKeys(exportKey: Uint8Array, secretPhrase: string): Promise<VaultKeys> {\n    try {\n      logger.debug('Deriving vault keys from export key');\n      \n      // Use BLAKE2s to generate tag ID (consistent with server)\n      const tagId = await this.blake2s(secretPhrase.trim().toLowerCase(), 16);\n      \n      // Derive data key using HKDF with tag ID as salt\n      const dataKey = await this.hkdf(exportKey, tagId, 'VaultDataKey', 32);\n      \n      // Generate vault ID from tag ID\n      const vaultId = this.bytesToHex(tagId);\n\n      // Register keys for secure memory management\n      SecureMemory.register(tagId);\n      SecureMemory.register(dataKey);\n\n      logger.debug('Vault keys derived successfully');\n      return {\n        tagId,\n        dataKey,\n        vaultId\n      };\n    } catch (error) {\n      logger.error('Failed to derive vault keys', error);\n      throw new OpaqueError('Vault key derivation failed', error);\n    }\n  }\n\n  /**\n   * Clear all sensitive data from memory\n   */\n  public clearMemory(): void {\n    try {\n      SecureMemory.clearAll();\n      logger.debug('OPAQUE client memory cleared');\n    } catch (error) {\n      logger.error('Failed to clear OPAQUE client memory', error);\n    }\n  }\n\n  /**\n   * Check if the client is properly initialized\n   */\n  public getInitializationStatus(): boolean {\n    return this.isInitialized;\n  }\n\n  // Private helper methods\n\n  private ensureInitialized(): void {\n    if (!this.isInitialized) {\n      throw new OpaqueError('OPAQUE client not initialized. Call initialize() first.');\n    }\n  }\n\n  private async blake2s(input: string, outputLength: number): Promise<Uint8Array> {\n    // Using SHA-256 as fallback since BLAKE2s might not be available\n    // In production, should use proper BLAKE2s implementation\n    const encoder = new TextEncoder();\n    const data = encoder.encode(input);\n    const hash = await crypto.subtle.digest('SHA-256', data);\n    return new Uint8Array(hash.slice(0, outputLength));\n  }\n\n  private async hkdf(\n    ikm: Uint8Array,\n    salt: Uint8Array,\n    info: string,\n    length: number\n  ): Promise<Uint8Array> {\n    try {\n      const key = await crypto.subtle.importKey('raw', ikm, 'HKDF', false, ['deriveBits']);\n      const infoBuffer = new TextEncoder().encode(info);\n      \n      const derivedBits = await crypto.subtle.deriveBits(\n        {\n          name: 'HKDF',\n          hash: 'SHA-256',\n          salt,\n          info: infoBuffer\n        },\n        key,\n        length * 8\n      );\n      \n      return new Uint8Array(derivedBits);\n    } catch (error) {\n      throw new OpaqueError('HKDF derivation failed', error);\n    }\n  }\n\n  private bytesToHex(bytes: Uint8Array): string {\n    return Array.from(bytes)\n      .map(b => b.toString(16).padStart(2, '0'))\n      .join('');\n  }\n}\n\n// Export singleton instance\nexport const opaqueClient = OpaqueClient.getInstance(); ","/**\n * Voice Phrase Detector Service\n * \n * Integrates OPAQUE zero-knowledge authentication with voice phrase detection.\n * Replaces the legacy tag manager phrase detection with secure OPAQUE protocol.\n * \n * Features:\n * - OPAQUE-based authentication for voice phrases\n * - Automatic session management for successful authentications  \n * - Secure memory management with automatic cleanup\n * - Performance-optimized for voice processing pipeline\n */\n\nimport { OpaqueClient } from './crypto/OpaqueClient';\nimport { OpaqueError, AuthenticationError, NetworkError } from './crypto/errors';\nimport { SecretTag, SessionData, AuthenticationResult } from './crypto/types';\nimport logger from '../utils/logger';\n\nexport interface VoiceAuthenticationResult {\n  success: boolean;\n  tagId?: string;\n  tagName?: string;\n  sessionKey?: Uint8Array;\n  vaultKey?: Uint8Array;\n  error?: string;\n}\n\nexport interface PhraseDetectionResult {\n  found: boolean;\n  tagId?: string;\n  tagName?: string;\n  action?: 'activate' | 'deactivate' | 'panic';\n}\n\n/**\n * Service for detecting and authenticating voice phrases using OPAQUE protocol\n */\nexport class VoicePhraseDetector {\n  private static instance: VoicePhraseDetector;\n  private opaqueClient: OpaqueClient;\n  private activeSessions: Map<string, SessionData> = new Map();\n  private sessionTimeouts: Map<string, NodeJS.Timeout> = new Map();\n  \n  // Configuration\n  private readonly SESSION_TIMEOUT_MS = 15 * 60 * 1000; // 15 minutes\n  private readonly MAX_AUTHENTICATION_TIME_MS = 2000; // 2 seconds max\n  private readonly PHRASE_NORMALIZATION_REGEX = /[^a-zA-Z0-9\\s]/g;\n\n  private constructor() {\n    this.opaqueClient = OpaqueClient.getInstance();\n  }\n\n  public static getInstance(): VoicePhraseDetector {\n    if (!VoicePhraseDetector.instance) {\n      VoicePhraseDetector.instance = new VoicePhraseDetector();\n    }\n    return VoicePhraseDetector.instance;\n  }\n\n  /**\n   * Main entry point: Check if transcribed voice contains secret phrases\n   * and authenticate using OPAQUE protocol\n   */\n  public async checkForSecretPhrase(transcribedText: string): Promise<PhraseDetectionResult> {\n    if (!transcribedText?.trim()) {\n      return { found: false };\n    }\n\n    try {\n      logger.info(`[VoicePhraseDetector] Checking phrase: \"${transcribedText}\"`);\n      \n      // Normalize the transcribed text for consistent matching\n      const normalizedPhrase = this.normalizePhrase(transcribedText);\n      \n      // Check for panic phrase first (highest priority)\n      if (this.isPanicPhrase(normalizedPhrase)) {\n        logger.warn('[VoicePhraseDetector] Panic phrase detected');\n        await this.handlePanicMode();\n        return {\n          found: true,\n          action: 'panic'\n        };\n      }\n\n      // Attempt OPAQUE authentication with the normalized phrase\n      const authResult = await this.authenticateWithOPAQUE(normalizedPhrase);\n      \n      if (authResult.success && authResult.tagId) {\n        // Check if tag is currently active\n        const isActive = this.isSessionActive(authResult.tagId);\n        const action = isActive ? 'deactivate' : 'activate';\n        \n        if (action === 'activate') {\n          // Create new session for successful authentication\n          await this.createSession(authResult.tagId, authResult.tagName!, authResult.sessionKey!, authResult.vaultKey!);\n        } else {\n          // Deactivate existing session\n          await this.deactivateSession(authResult.tagId);\n        }\n\n        logger.info(`[VoicePhraseDetector] Authentication successful: ${authResult.tagName} (${action})`);\n        \n        return {\n          found: true,\n          tagId: authResult.tagId,\n          tagName: authResult.tagName,\n          action\n        };\n      }\n\n      // No authentication successful\n      logger.info('[VoicePhraseDetector] No secret phrase detected');\n      return { found: false };\n\n    } catch (error) {\n      logger.error('[VoicePhraseDetector] Error during phrase detection:', error);\n      return { found: false };\n    }\n  }\n\n  /**\n   * Authenticate a phrase using OPAQUE protocol\n   */\n  private async authenticateWithOPAQUE(phrase: string): Promise<VoiceAuthenticationResult> {\n    const startTime = Date.now();\n    \n    try {\n      // Get all available secret tags (server will return tag metadata without secrets)\n      const availableTags = await this.getAvailableSecretTags();\n      \n      if (availableTags.length === 0) {\n        return { success: false, error: 'No secret tags configured' };\n      }\n\n      // Try to authenticate with each tag using OPAQUE\n      for (const tag of availableTags) {\n        try {\n          // Check timeout constraint\n          if (Date.now() - startTime > this.MAX_AUTHENTICATION_TIME_MS) {\n            logger.warn('[VoicePhraseDetector] Authentication timeout reached');\n            break;\n          }\n\n          // Attempt OPAQUE authentication with tag ID and phrase\n          const authResult = await this.opaqueClient.authenticate(tag.id, phrase);\n          \n          if (authResult.success) {\n            // Derive vault key from session key\n            const vaultKey = await this.opaqueClient.deriveVaultKey(authResult.sessionKey!, tag.id);\n            \n            return {\n              success: true,\n              tagId: tag.id,\n              tagName: tag.name,\n              sessionKey: authResult.sessionKey,\n              vaultKey\n            };\n          }\n        } catch (error) {\n          // Continue trying other tags - don't fail immediately\n          if (error instanceof AuthenticationError) {\n            logger.debug(`[VoicePhraseDetector] Authentication failed for tag ${tag.id}: ${error.message}`);\n          } else {\n            logger.warn(`[VoicePhraseDetector] Unexpected error for tag ${tag.id}:`, error);\n          }\n          continue;\n        }\n      }\n\n      // No successful authentication\n      const elapsedTime = Date.now() - startTime;\n      logger.info(`[VoicePhraseDetector] Authentication failed for all tags (${elapsedTime}ms)`);\n      \n      return { success: false, error: 'Authentication failed' };\n\n    } catch (error) {\n      const elapsedTime = Date.now() - startTime;\n      logger.error(`[VoicePhraseDetector] OPAQUE authentication error (${elapsedTime}ms):`, error);\n      \n      if (error instanceof NetworkError) {\n        return { success: false, error: 'Network error during authentication' };\n      } else if (error instanceof OpaqueError) {\n        return { success: false, error: 'Authentication protocol error' };\n      }\n      \n      return { success: false, error: 'Unknown authentication error' };\n    }\n  }\n\n  /**\n   * Get available secret tags from server (metadata only, no secrets)\n   */\n  private async getAvailableSecretTags(): Promise<SecretTag[]> {\n    try {\n      // This would call the backend API to get user's secret tag metadata\n      // Implementation would depend on the existing API structure\n      // For now, return empty array - this will be implemented in subsequent tasks\n      logger.info('[VoicePhraseDetector] Getting available secret tags from server');\n      return [];\n    } catch (error) {\n      logger.error('[VoicePhraseDetector] Failed to get available secret tags:', error);\n      return [];\n    }\n  }\n\n  /**\n   * Create a new active session for successful authentication\n   */\n  private async createSession(tagId: string, tagName: string, sessionKey: Uint8Array, vaultKey: Uint8Array): Promise<void> {\n    try {\n      // Clear any existing session for this tag\n      await this.deactivateSession(tagId);\n\n      // Create new session\n      const sessionData: SessionData = {\n        tagId,\n        tagName,\n        sessionKey,\n        vaultKey,\n        createdAt: new Date(),\n        expiresAt: new Date(Date.now() + this.SESSION_TIMEOUT_MS)\n      };\n\n      this.activeSessions.set(tagId, sessionData);\n\n      // Set automatic cleanup timeout\n      const timeoutId = setTimeout(() => {\n        this.deactivateSession(tagId);\n      }, this.SESSION_TIMEOUT_MS);\n\n      this.sessionTimeouts.set(tagId, timeoutId);\n\n      logger.info(`[VoicePhraseDetector] Session created for tag: ${tagName} (expires in ${this.SESSION_TIMEOUT_MS / 1000}s)`);\n    } catch (error) {\n      logger.error('[VoicePhraseDetector] Failed to create session:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Deactivate an active session and clean up memory\n   */\n  private async deactivateSession(tagId: string): Promise<void> {\n    try {\n      const session = this.activeSessions.get(tagId);\n      if (session) {\n        // Clear sensitive data from memory\n        session.sessionKey.fill(0);\n        session.vaultKey.fill(0);\n        \n        this.activeSessions.delete(tagId);\n        logger.info(`[VoicePhraseDetector] Session deactivated for tag: ${session.tagName}`);\n      }\n\n      // Clear timeout if exists\n      const timeoutId = this.sessionTimeouts.get(tagId);\n      if (timeoutId) {\n        clearTimeout(timeoutId);\n        this.sessionTimeouts.delete(tagId);\n      }\n    } catch (error) {\n      logger.error('[VoicePhraseDetector] Error deactivating session:', error);\n    }\n  }\n\n  /**\n   * Check if a session is currently active for a tag\n   */\n  public isSessionActive(tagId: string): boolean {\n    const session = this.activeSessions.get(tagId);\n    if (!session) {\n      return false;\n    }\n\n    // Check if session has expired\n    if (session.expiresAt < new Date()) {\n      this.deactivateSession(tagId);\n      return false;\n    }\n\n    return true;\n  }\n\n  /**\n   * Get active session data for a tag\n   */\n  public getActiveSession(tagId: string): SessionData | null {\n    if (!this.isSessionActive(tagId)) {\n      return null;\n    }\n    return this.activeSessions.get(tagId) || null;\n  }\n\n  /**\n   * Get all currently active sessions\n   */\n  public getActiveSessions(): SessionData[] {\n    const activeSessions: SessionData[] = [];\n    \n    for (const [tagId, session] of this.activeSessions) {\n      if (this.isSessionActive(tagId)) {\n        activeSessions.push(session);\n      }\n    }\n    \n    return activeSessions;\n  }\n\n  /**\n   * Handle panic mode - clear all sessions and sensitive data\n   */\n  private async handlePanicMode(): Promise<void> {\n    try {\n      logger.warn('[VoicePhraseDetector] Entering panic mode - clearing all sessions');\n\n      // Deactivate all sessions\n      const tagIds = Array.from(this.activeSessions.keys());\n      for (const tagId of tagIds) {\n        await this.deactivateSession(tagId);\n      }\n\n      // Clear OPAQUE client memory\n      await this.opaqueClient.clearMemory();\n\n      logger.info('[VoicePhraseDetector] Panic mode complete - all sensitive data cleared');\n    } catch (error) {\n      logger.error('[VoicePhraseDetector] Error during panic mode:', error);\n    }\n  }\n\n  /**\n   * Normalize phrase for consistent matching\n   */\n  private normalizePhrase(phrase: string): string {\n    return phrase\n      .toLowerCase()\n      .trim()\n      .replace(this.PHRASE_NORMALIZATION_REGEX, '')\n      .replace(/\\s+/g, ' ');\n  }\n\n  /**\n   * Check if phrase is a panic phrase\n   */\n  private isPanicPhrase(normalizedPhrase: string): boolean {\n    const panicPhrases = [\n      'emergency delete everything',\n      'panic mode now',\n      'destroy all data'\n    ];\n\n    return panicPhrases.some(panic => normalizedPhrase.includes(panic));\n  }\n\n  /**\n   * Clean up all resources\n   */\n  public async cleanup(): Promise<void> {\n    try {\n      logger.info('[VoicePhraseDetector] Cleaning up resources');\n\n      // Deactivate all sessions\n      const tagIds = Array.from(this.activeSessions.keys());\n      for (const tagId of tagIds) {\n        await this.deactivateSession(tagId);\n      }\n\n      // Clear all timeouts\n      for (const timeoutId of this.sessionTimeouts.values()) {\n        clearTimeout(timeoutId);\n      }\n      this.sessionTimeouts.clear();\n\n      logger.info('[VoicePhraseDetector] Cleanup complete');\n    } catch (error) {\n      logger.error('[VoicePhraseDetector] Error during cleanup:', error);\n    }\n  }\n}\n\n// Export singleton instance\nexport const voicePhraseDetector = VoicePhraseDetector.getInstance(); ","import React, { useState, useEffect, useMemo, useRef, useCallback } from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  TouchableOpacity,\n  FlatList,\n  ActivityIndicator,\n  Alert,\n  Dimensions,\n  Platform,\n  RefreshControl,\n} from 'react-native';\nimport { useNavigation, useFocusEffect } from '@react-navigation/native';\nimport { CompositeNavigationProp } from '@react-navigation/native';\nimport { StackNavigationProp } from '@react-navigation/stack';\nimport { BottomTabNavigationProp } from '@react-navigation/bottom-tabs';\nimport { format, parseISO, startOfMonth, endOfMonth, eachDayOfInterval, isSameDay } from 'date-fns';\nimport { Ionicons } from '@expo/vector-icons';\n\nimport { JournalAPI } from '../../services/api';\nimport { JournalEntry, Tag } from '../../types';\nimport JournalCard from '../../components/JournalCard';\nimport SafeScrollView from '../../components/SafeScrollView';\nimport ScreenHeader from '../../components/ScreenHeader';\nimport { CalendarSkeleton, JournalCardSkeleton } from '../../components/SkeletonLoader';\nimport { MainStackParamList, MainTabParamList, JournalStackParamList } from '../../navigation/types';\nimport { useAppTheme } from '../../contexts/ThemeContext';\nimport { voicePhraseDetector } from '../../services/VoicePhraseDetector';\nimport { AppTheme } from '../../config/theme';\n\ntype CalendarScreenNavigationProp = CompositeNavigationProp<\n  BottomTabNavigationProp<MainTabParamList, 'Calendar'>,\n  StackNavigationProp<MainStackParamList>\n>;\n\nconst CalendarScreen = () => {\n  const navigation = useNavigation<CalendarScreenNavigationProp>();\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n  \n  const [currentMonth, setCurrentMonth] = useState(new Date());\n  const [selectedDate, setSelectedDate] = useState(new Date());\n  const [allEntries, setAllEntries] = useState<JournalEntry[]>([]);\n  const [filteredEntriesForSelectedDate, setFilteredEntriesForSelectedDate] = useState<JournalEntry[]>([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [hasActiveSecretTags, setHasActiveSecretTags] = useState(false);\n  const [isRefreshing, setIsRefreshing] = useState(false);\n  \n  // Scroll to top functionality\n  const [showScrollToTop, setShowScrollToTop] = useState(false);\n  const scrollViewRef = useRef<any>(null);\n  \n  // Handle scroll events to show/hide scroll-to-top button\n  const handleScroll = useCallback((event: any) => {\n    const { contentOffset } = event.nativeEvent;\n    \n    // Show scroll-to-top button when scrolled down more than 200px\n    setShowScrollToTop(contentOffset.y > 200);\n  }, []);\n\n  // Scroll to top function\n  const scrollToTop = useCallback(() => {\n    if (scrollViewRef.current) {\n      scrollViewRef.current.scrollTo({\n        y: 0,\n        animated: true,\n      });\n    }\n  }, []);\n  \n  // Check for active secret tags\n  useEffect(() => {\n    const checkActiveSecretTags = async () => {\n      const activeSessions = voicePhraseDetector.getActiveSessions();\n      setHasActiveSecretTags(activeSessions.length > 0);\n    };\n    \n    checkActiveSecretTags();\n    // Check periodically for secret tag changes\n    const interval = setInterval(checkActiveSecretTags, 1000);\n    \n    return () => clearInterval(interval);\n  }, []);\n  \n  const visibleEntries = useMemo(() => {\n    // For now, return all entries - filtering will happen server-side\n    return allEntries;\n  }, [allEntries, hasActiveSecretTags]);\n  \n  useFocusEffect(\n    React.useCallback(() => {\n      fetchEntries();\n      // Also refresh entries for the currently selected date when returning to screen\n      if (selectedDate) {\n        fetchEntriesForSelectedDate(selectedDate);\n      }\n    }, [selectedDate])\n  );\n  \n  useEffect(() => {\n    // When the selectedDate changes, fetch entries for that date\n    if (selectedDate) {\n      fetchEntriesForSelectedDate(selectedDate);\n    }\n  }, [selectedDate]);\n\n  // Keep a separate effect for when secret tag visibility changes\n  useEffect(() => {\n    if (selectedDate && allEntries.length > 0) {\n      // Refresh filtered entries when secret tags change\n      fetchEntriesForSelectedDate(selectedDate);\n    }\n  }, [hasActiveSecretTags]);\n  \n  const getDaysInMonth = () => {\n    const start = startOfMonth(currentMonth);\n    const end = endOfMonth(currentMonth);\n    return eachDayOfInterval({ start, end });\n  };\n  \n  const fetchEntries = async () => {\n    try {\n      setIsLoading(true);\n      \n      // Fetch all entries for date indicators in the calendar\n      const allEntriesResponse = await JournalAPI.getEntries({\n        limit: 100,  // Fetch more entries to show indicators properly\n        include_public: true\n      });\n      const entries = Array.isArray(allEntriesResponse.data) \n        ? allEntriesResponse.data \n        : allEntriesResponse.data.entries || [];\n      setAllEntries(entries as JournalEntry[]);\n      \n      // Also trigger filtering for the selected date\n      await fetchEntriesForSelectedDate(selectedDate);\n    } catch (error) {\n      console.error('Error fetching journal entries', error);\n      Alert.alert('Error', 'Failed to load journal entries');\n    } finally {\n      setIsLoading(false);\n      setIsRefreshing(false);\n    }\n  };\n\n  // Handle pull-to-refresh\n  const onRefresh = React.useCallback(() => {\n    setIsRefreshing(true);\n    fetchEntries();\n  }, [selectedDate]);\n  \n  // New function to fetch entries for a specific date\n  const fetchEntriesForSelectedDate = async (date: Date) => {\n    try {\n      // Format date as YYYY-MM-DD for API query\n      const formattedDate = format(date, 'yyyy-MM-dd');\n      \n      // Use start_date and end_date parameters to filter by exact date\n      const response = await JournalAPI.getEntries({\n        // Filter by the specific date using both start_date and end_date\n        start_date: formattedDate,\n        end_date: formattedDate,\n        include_public: true\n      });\n      \n      const entries = Array.isArray(response.data)\n        ? response.data\n        : (response.data?.entries ?? []);\n      setFilteredEntriesForSelectedDate(entries as JournalEntry[]);\n    } catch (error) {\n      console.error(`Error fetching entries for date ${format(date, 'yyyy-MM-dd')}`, error);\n      setFilteredEntriesForSelectedDate([]);\n    }\n  };\n  \n  // Replace filterEntriesByDate with a function that triggers fetchEntriesForSelectedDate\n  const filterEntriesByDate = () => {\n    fetchEntriesForSelectedDate(selectedDate);\n  };\n  \n  const goToPreviousMonth = () => {\n    const previousMonth = new Date(currentMonth);\n    previousMonth.setMonth(previousMonth.getMonth() - 1);\n    setCurrentMonth(previousMonth);\n  };\n  \n  const goToNextMonth = () => {\n    const nextMonth = new Date(currentMonth);\n    nextMonth.setMonth(nextMonth.getMonth() + 1);\n    setCurrentMonth(nextMonth);\n  };\n  \n  const handleCreateEntry = () => {\n    // Pass the selected date to the Record screen\n    const formattedDate = format(selectedDate, 'yyyy-MM-dd');\n    navigation.navigate('Record', { \n      selectedDate: formattedDate\n    });\n  };\n  \n  const handleEntryPress = (entry: JournalEntry) => {\n    // Navigate to JournalEntryDetail in the main stack\n    navigation.navigate('JournalEntryDetail', { entryId: entry.id.toString() });\n  };\n  \n  const renderDay = (day: Date) => {\n    const dayString = format(day, 'd');\n    const hasEntriesOnDay = visibleEntries.some(entry => {\n      try {\n        const entryDate = parseISO(entry.entry_date);\n        return entryDate.getFullYear() === day.getFullYear() &&\n               entryDate.getMonth() === day.getMonth() &&\n               entryDate.getDate() === day.getDate();\n      } catch (e) {\n        console.error(`Error parsing entry_date for indicator: ${entry.entry_date}`, e);\n        return false;\n      }\n    });\n    \n    const isSelected = isSameDay(day, selectedDate); \n    \n    return (\n      <TouchableOpacity \n        style={[\n          styles.dayContainer,\n          isSelected && styles.selectedDayContainer\n        ]} \n        onPress={() => {\n          setSelectedDate(day);\n          // Fetch entries immediately for better user experience\n          fetchEntriesForSelectedDate(day);\n        }}\n      >\n        <Text style={[\n          styles.dayText,\n          isSelected && styles.selectedDayText\n        ]}>\n          {dayString}\n        </Text>\n        \n        {hasEntriesOnDay && <View style={[\n          styles.entryIndicator,\n          isSelected && styles.selectedEntryIndicator\n        ]} />}\n      </TouchableOpacity>\n    );\n  };\n  \n  const renderEntry = ({ item, index }: { item: JournalEntry; index: number }) => (\n    <JournalCard \n      entry={item}\n      onPress={() => handleEntryPress(item)}\n      key={`calendar-entry-${item.id}-${index}`}\n    />\n  );\n  \n  return (\n    <View style={styles.container}>\n      <ScreenHeader \n        title=\"Calendar\" \n        showSecretTagIndicator={hasActiveSecretTags}\n        secretTagText=\"Secret Tags Active\"\n      />\n      \n      <SafeScrollView \n        style={{ flex: 1 }} \n        contentContainerStyle={{ flexGrow: 1 }}\n        refreshControl={\n          <RefreshControl\n            refreshing={isRefreshing}\n            onRefresh={onRefresh}\n            colors={[theme.colors.primary]}\n            tintColor={theme.colors.primary}\n          />\n        }\n        onScroll={handleScroll}\n        ref={scrollViewRef}\n      >\n        <View style={styles.calendarHeader}>\n          <TouchableOpacity onPress={goToPreviousMonth}>\n            <Ionicons name=\"chevron-back\" size={theme.typography.fontSizes.xxl} color={theme.colors.text} />\n          </TouchableOpacity>\n          \n          <Text style={styles.monthText}>\n            {format(currentMonth, 'MMMM yyyy')}\n          </Text>\n          \n          <TouchableOpacity onPress={goToNextMonth}>\n            <Ionicons name=\"chevron-forward\" size={theme.typography.fontSizes.xxl} color={theme.colors.text} />\n          </TouchableOpacity>\n        </View>\n        \n        <View style={styles.calendar}>\n          <View style={styles.weekDays}>\n            {['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'].map((day) => (\n              <Text key={day} style={styles.weekDayText}>{day}</Text>\n            ))}\n          </View>\n          \n          <View style={styles.daysContainer}>\n            {getDaysInMonth().map((day) => (\n              <View key={day.toISOString()}>\n                {renderDay(day)}\n              </View>\n            ))}\n          </View>\n        </View>\n        \n        <View style={styles.selectedDateContainer}>\n          <Text style={styles.selectedDateText}>\n            {format(selectedDate, 'EEEE, MMMM d, yyyy')}\n          </Text>\n          \n          <TouchableOpacity \n            style={styles.addButton}\n            onPress={handleCreateEntry}\n          >\n            <Ionicons name=\"add\" size={theme.typography.fontSizes.xxl} color={theme.isDarkMode ? theme.colors.background : theme.colors.white} />\n          </TouchableOpacity>\n        </View>\n        \n        {isLoading ? (\n          <View style={styles.skeletonContainer}>\n            <CalendarSkeleton />\n            {Array.from({ length: 3 }, (_, index) => (\n              <JournalCardSkeleton key={`skeleton-${index}`} />\n            ))}\n          </View>\n        ) : (\n          <View style={styles.entriesContainer}>\n            {filteredEntriesForSelectedDate.length === 0 ? (\n              <View style={styles.emptyContainer}>\n                <Ionicons name=\"calendar-outline\" size={theme.spacing.xxl * 1.5} color={theme.colors.disabled} />\n                <Text style={styles.emptyText}>\n                  {\"No entries for this date\"}\n                </Text>\n                <TouchableOpacity \n                  style={styles.createButton}\n                  onPress={handleCreateEntry}\n                >\n                  <Text style={styles.createButtonText}>Create Entry</Text>\n                </TouchableOpacity>\n              </View>\n            ) : (\n              <View style={styles.entriesListContainer}>\n                <FlatList\n                  data={filteredEntriesForSelectedDate}\n                  renderItem={renderEntry}\n                  keyExtractor={(item, index) => `calendar-list-${item.id}-${index}`}\n                  contentContainerStyle={[styles.listContent, { paddingBottom: 40 }]}\n                  scrollEnabled={true}\n                  nestedScrollEnabled={true}\n                />\n              </View>\n            )}\n          </View>\n        )}\n      </SafeScrollView>\n      \n      {/* Scroll to Top Button */}\n      {showScrollToTop && (\n        <TouchableOpacity\n          style={styles.scrollToTopButton}\n          onPress={scrollToTop}\n          activeOpacity={0.8}\n        >\n          <Ionicons \n            name=\"chevron-up\" \n            size={24} \n            color={theme.colors.white} \n          />\n        </TouchableOpacity>\n      )}\n    </View>\n  );\n};\n\nconst getStyles = (theme: AppTheme) => {\n  const { width, height } = Dimensions.get('window');\n  const isDesktop = width > 768; // Consider devices wider than 768px as desktop\n  const isTablet = width > 480 && width <= 768;\n  \n  // Calculate responsive calendar dimensions\n  const calendarMaxWidth = isDesktop ? 600 : width - (theme.spacing.md * 2);\n  const calendarPadding = isDesktop ? theme.spacing.xl : theme.spacing.md;\n  \n  // Calculate day cell size - ensure calendar fits within screen\n  const availableWidth = calendarMaxWidth - (theme.spacing.sm * 2);\n  const dayCellSize = Math.min(\n    availableWidth / 7, // Ensure 7 days fit in one row\n    isDesktop ? 60 : 45  // Max size constraints\n  );\n  \n  return StyleSheet.create({\n    container: {\n      flex: 1,\n      backgroundColor: theme.colors.background,\n    },\n\n    calendarHeader: {\n      flexDirection: 'row',\n      justifyContent: 'space-between',\n      alignItems: 'center',\n      paddingHorizontal: calendarPadding,\n      paddingVertical: theme.spacing.md,\n      borderBottomWidth: 1,\n      borderBottomColor: theme.colors.border,\n      maxWidth: calendarMaxWidth,\n      alignSelf: 'center',\n      width: '100%',\n    },\n    monthText: {\n      fontSize: theme.typography.fontSizes.lg,\n      fontWeight: 'bold',\n      color: theme.colors.text,\n      fontFamily: theme.typography.fontFamilies.bold,\n    },\n    calendar: {\n      paddingHorizontal: theme.spacing.sm,\n      paddingVertical: theme.spacing.md,\n      backgroundColor: theme.colors.card,\n      margin: theme.spacing.md,\n      borderRadius: 8,\n      maxWidth: calendarMaxWidth,\n      alignSelf: 'center',\n      width: isDesktop ? calendarMaxWidth : '100%',\n    },\n    weekDays: {\n      flexDirection: 'row',\n      justifyContent: 'space-around',\n      marginBottom: theme.spacing.sm,\n    },\n    weekDayText: {\n      fontSize: isDesktop ? theme.typography.fontSizes.sm : theme.typography.fontSizes.xs,\n      color: theme.colors.textSecondary,\n      fontFamily: theme.typography.fontFamilies.semiBold,\n      width: dayCellSize,\n      textAlign: 'center',\n    },\n    daysContainer: {\n      flexDirection: 'row',\n      flexWrap: 'wrap',\n      justifyContent: 'space-around',\n    },\n    dayContainer: {\n      width: dayCellSize,\n      height: dayCellSize,\n      justifyContent: 'center',\n      alignItems: 'center',\n      borderWidth: 1,\n      borderColor: 'transparent',\n      borderRadius: 5,\n      margin: 1,\n    },\n    selectedDayContainer: {\n      backgroundColor: theme.colors.primary,\n      borderColor: theme.colors.primary,\n      borderRadius: 20,\n    },\n    dayText: {\n      fontSize: isDesktop ? theme.typography.fontSizes.sm : theme.typography.fontSizes.xs,\n      color: theme.colors.text,\n      fontFamily: theme.typography.fontFamilies.regular,\n    },\n    selectedDayText: {\n      color: theme.isDarkMode ? theme.colors.background : theme.colors.white,\n      fontWeight: 'bold',\n      fontFamily: theme.typography.fontFamilies.bold,\n    },\n    entryIndicator: {\n      width: 4,\n      height: 4,\n      borderRadius: 2,\n      backgroundColor: theme.colors.secondary,\n      position: 'absolute',\n      bottom: isDesktop ? 6 : 4,\n    },\n    selectedEntryIndicator: {\n      backgroundColor: theme.isDarkMode ? theme.colors.background : theme.colors.white,\n    },\n    selectedDateContainer: {\n      padding: theme.spacing.md,\n      flexDirection: 'row',\n      justifyContent: 'space-between',\n      alignItems: 'center',\n      borderTopWidth: 1,\n      borderBottomWidth: 1,\n      borderColor: theme.colors.border,\n      backgroundColor: theme.colors.card,\n      maxWidth: calendarMaxWidth,\n      alignSelf: 'center',\n      width: isDesktop ? calendarMaxWidth : '100%',\n    },\n    selectedDateText: {\n      fontSize: theme.typography.fontSizes.md,\n      fontWeight: 'bold',\n      color: theme.colors.text,\n      fontFamily: theme.typography.fontFamilies.bold,\n    },\n    addButton: {\n      backgroundColor: theme.colors.primary,\n      padding: theme.spacing.sm,\n      borderRadius: 20,\n    },\n    loaderContainer: {\n      flex: 1,\n      justifyContent: 'center',\n      alignItems: 'center',\n      backgroundColor: theme.colors.background,\n    },\n    skeletonContainer: {\n      flex: 1,\n      backgroundColor: theme.colors.background,\n    },\n    entriesContainer: {\n      flex: 1,\n      maxWidth: calendarMaxWidth,\n      alignSelf: 'center',\n      width: isDesktop ? calendarMaxWidth : '100%',\n    },\n    emptyContainer: {\n      flex: 1,\n      justifyContent: 'center',\n      alignItems: 'center',\n      padding: theme.spacing.lg,\n      minHeight: isDesktop ? 200 : 150,\n    },\n    emptyText: {\n      fontSize: theme.typography.fontSizes.md,\n      color: theme.colors.textSecondary,\n      marginTop: theme.spacing.md,\n      marginBottom: theme.spacing.lg,\n      textAlign: 'center',\n      fontFamily: theme.typography.fontFamilies.regular,\n    },\n    createButton: {\n      backgroundColor: theme.colors.primary,\n      paddingVertical: theme.spacing.md,\n      paddingHorizontal: theme.spacing.xl,\n      borderRadius: 25,\n    },\n    createButtonText: {\n      color: theme.isDarkMode ? theme.colors.background : theme.colors.white,\n      fontSize: theme.typography.fontSizes.md,\n      fontWeight: 'bold',\n      fontFamily: theme.typography.fontFamilies.bold,\n    },\n    listContent: {\n      padding: theme.spacing.md,\n      paddingBottom: Platform.OS === 'ios' ? 60 : 50, // Extra bottom padding for navigation\n    },\n    scrollContainer: {\n      flex: 1,\n    },\n    scrollContent: {\n      flexGrow: 1,\n    },\n    entriesListContainer: {\n      minHeight: isDesktop ? 300 : 200,\n    },\n    scrollToTopButton: {\n      position: 'absolute',\n      bottom: Platform.OS === 'ios' ? 120 : 105, // Above the tab bar\n      right: theme.spacing.lg,\n      width: 48,\n      height: 48,\n      borderRadius: 24,\n      backgroundColor: theme.colors.primary,\n      justifyContent: 'center',\n      alignItems: 'center',\n      elevation: 8,\n      shadowColor: theme.colors.shadow,\n      shadowOffset: { width: 0, height: 4 },\n      shadowOpacity: 0.3,\n      shadowRadius: 8,\n      zIndex: 1000,\n    },\n  });\n};\n\nexport default CalendarScreen; \n \n ","import { Platform, Alert } from 'react-native';\nimport settingsService from './settingsService';\nimport logger from '../utils/logger';\n\nexport interface NotificationPermissions {\n  granted: boolean;\n  canAskAgain: boolean;\n  status: 'granted' | 'denied' | 'undetermined';\n}\n\nclass NotificationService {\n  private initialized = false;\n  private dailyReminderScheduled = false;\n\n  /**\n   * Initialize the notification service\n   * Note: This is a simplified version. In a full implementation,\n   * you would install expo-notifications and use proper notification APIs.\n   */\n  async initialize(): Promise<boolean> {\n    try {\n      if (this.initialized) return true;\n\n      logger.info('[NotificationService] Initialized (simplified version)');\n      this.initialized = true;\n      return true;\n    } catch (error) {\n      logger.error('[NotificationService] Failed to initialize:', error);\n      return false;\n    }\n  }\n\n  /**\n   * Request notification permissions\n   * Note: This is a placeholder. In a full implementation,\n   * you would use expo-notifications to request actual permissions.\n   */\n  async requestPermissions(): Promise<NotificationPermissions> {\n    try {\n      // For now, we'll simulate permission request\n      logger.info('[NotificationService] Permission request (simulated)');\n      \n      return {\n        granted: true, // Simulated as granted\n        canAskAgain: true,\n        status: 'granted',\n      };\n    } catch (error) {\n      logger.error('[NotificationService] Failed to request permissions:', error);\n      return {\n        granted: false,\n        canAskAgain: false,\n        status: 'denied',\n      };\n    }\n  }\n\n  /**\n   * Schedule daily journal reminder based on user settings\n   * Note: This is a placeholder. In a full implementation,\n   * you would use expo-notifications to schedule actual notifications.\n   */\n  async scheduleDailyReminder(): Promise<boolean> {\n    try {\n      const settings = await settingsService.getSettings();\n      \n      // Check if notifications and reminders are enabled\n      if (!settings.notificationsEnabled || !settings.reminderNotifications) {\n        logger.info('[NotificationService] Daily reminders disabled in settings');\n        this.dailyReminderScheduled = false;\n        return false;\n      }\n\n      // Parse the reminder time (HH:MM format)\n      const [hours, minutes] = settings.dailyReminderTime.split(':').map(Number);\n      \n      if (isNaN(hours) || isNaN(minutes) || hours < 0 || hours > 23 || minutes < 0 || minutes > 59) {\n        logger.error(`[NotificationService] Invalid reminder time: ${settings.dailyReminderTime}`);\n        return false;\n      }\n\n      // Simulate scheduling the notification\n      this.dailyReminderScheduled = true;\n      logger.info(`[NotificationService] Scheduled daily reminder at ${settings.dailyReminderTime} (simulated)`);\n      \n      // In a real implementation, you would:\n      // await Notifications.scheduleNotificationAsync({...});\n      \n      return true;\n    } catch (error) {\n      logger.error('[NotificationService] Failed to schedule daily reminder:', error);\n      return false;\n    }\n  }\n\n  /**\n   * Cancel the daily journal reminder\n   */\n  async cancelDailyReminder(): Promise<void> {\n    try {\n      this.dailyReminderScheduled = false;\n      logger.info('[NotificationService] Cancelled daily reminder (simulated)');\n      \n      // In a real implementation, you would:\n      // await Notifications.cancelScheduledNotificationAsync(identifier);\n    } catch (error) {\n      logger.error('[NotificationService] Failed to cancel daily reminder:', error);\n    }\n  }\n\n  /**\n   * Update notification settings - call this when user changes notification preferences\n   */\n  async updateNotificationSettings(): Promise<void> {\n    try {\n      const settings = await settingsService.getSettings();\n      \n      if (settings.reminderNotifications && settings.notificationsEnabled) {\n        // Reschedule daily reminder with new settings\n        await this.scheduleDailyReminder();\n      } else {\n        // Cancel daily reminder if disabled\n        await this.cancelDailyReminder();\n      }\n      \n      logger.info('[NotificationService] Updated notification settings');\n    } catch (error) {\n      logger.error('[NotificationService] Failed to update notification settings:', error);\n    }\n  }\n\n  /**\n   * Check if notifications are properly configured\n   */\n  async isConfigured(): Promise<boolean> {\n    try {\n      // For now, always return true since we're using a simplified version\n      return true;\n    } catch (error) {\n      logger.error('[NotificationService] Failed to check configuration:', error);\n      return false;\n    }\n  }\n\n  /**\n   * Get notification permission status\n   */\n  async getPermissionStatus(): Promise<'granted' | 'denied' | 'undetermined'> {\n    try {\n      // For now, always return granted since we're using a simplified version\n      return 'granted';\n    } catch (error) {\n      logger.error('[NotificationService] Failed to get permission status:', error);\n      return 'denied';\n    }\n  }\n\n  /**\n   * Show a test notification (for development/testing)\n   */\n  async showTestNotification(): Promise<void> {\n    try {\n      const settings = await settingsService.getSettings();\n      \n      if (!settings.notificationsEnabled) {\n        Alert.alert('Notifications Disabled', 'Please enable notifications in settings to test.');\n        return;\n      }\n\n      Alert.alert(\n        '📝 Journal Reminder',\n        'This is a test notification. In a full implementation, this would be a proper push notification.',\n        [{ text: 'OK' }]\n      );\n      \n      logger.info('[NotificationService] Showed test notification');\n    } catch (error) {\n      logger.error('[NotificationService] Failed to show test notification:', error);\n    }\n  }\n\n  /**\n   * Get the current reminder schedule status\n   */\n  isDailyReminderScheduled(): boolean {\n    return this.dailyReminderScheduled;\n  }\n}\n\n// Export singleton instance\nconst notificationService = new NotificationService();\nexport default notificationService; ","import React, { createContext, useContext, useState, useEffect, ReactNode } from 'react';\nimport settingsService, { UserSettings, DEFAULT_SETTINGS } from '../services/settingsService';\nimport notificationService from '../services/notificationService';\nimport logger from '../utils/logger';\n\ninterface SettingsContextValue {\n  settings: UserSettings;\n  isLoading: boolean;\n  error: string | null;\n  updateSetting: <K extends keyof UserSettings>(key: K, value: UserSettings[K]) => Promise<void>;\n  updateSettings: (updates: Partial<UserSettings>) => Promise<void>;\n  resetToDefaults: () => Promise<void>;\n  exportSettings: () => Promise<string>;\n  importSettings: (jsonData: string) => Promise<void>;\n  getSetting: <K extends keyof UserSettings>(key: K) => UserSettings[K];\n}\n\nconst SettingsContext = createContext<SettingsContextValue | undefined>(undefined);\n\ninterface SettingsProviderProps {\n  children: ReactNode;\n}\n\nexport const SettingsProvider: React.FC<SettingsProviderProps> = ({ children }) => {\n  const [settings, setSettings] = useState<UserSettings>(DEFAULT_SETTINGS);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  // Initialize settings on mount\n  useEffect(() => {\n    const initializeSettings = async () => {\n      try {\n        setIsLoading(true);\n        setError(null);\n        \n        const loadedSettings = await settingsService.initialize();\n        setSettings(loadedSettings);\n        \n        logger.info('[SettingsContext] Settings initialized successfully');\n      } catch (err) {\n        const errorMessage = err instanceof Error ? err.message : 'Failed to initialize settings';\n        logger.error('[SettingsContext] Settings initialization failed:', err);\n        setError(errorMessage);\n        \n        // Fallback to defaults on error\n        setSettings(DEFAULT_SETTINGS);\n      } finally {\n        setIsLoading(false);\n      }\n    };\n\n    initializeSettings();\n  }, []);\n\n  // Subscribe to settings changes from the service\n  useEffect(() => {\n    const unsubscribe = settingsService.subscribe((updatedSettings) => {\n      setSettings(updatedSettings);\n      logger.debug('[SettingsContext] Settings updated via subscription');\n    });\n\n    return unsubscribe;\n  }, []);\n\n  // Update a single setting\n  const updateSetting = async <K extends keyof UserSettings>(\n    key: K, \n    value: UserSettings[K]\n  ): Promise<void> => {\n    try {\n      setError(null);\n      await settingsService.updateSetting(key, value);\n      \n      // Update notification settings if notification-related settings changed\n      if (key === 'notificationsEnabled' || key === 'reminderNotifications' || key === 'dailyReminderTime') {\n        await notificationService.updateNotificationSettings();\n        logger.info(`[SettingsContext] Updated notification settings after ${key} change`);\n      }\n      \n      // Settings will be updated via subscription\n    } catch (err) {\n      const errorMessage = err instanceof Error ? err.message : `Failed to update ${key}`;\n      logger.error(`[SettingsContext] Failed to update setting ${key}:`, err);\n      setError(errorMessage);\n      throw err; // Re-throw for component error handling\n    }\n  };\n\n  // Update multiple settings\n  const updateSettings = async (updates: Partial<UserSettings>): Promise<void> => {\n    try {\n      setError(null);\n      await settingsService.updateSettings(updates);\n      // Settings will be updated via subscription\n    } catch (err) {\n      const errorMessage = err instanceof Error ? err.message : 'Failed to update settings';\n      logger.error('[SettingsContext] Failed to update settings:', err);\n      setError(errorMessage);\n      throw err; // Re-throw for component error handling\n    }\n  };\n\n  // Reset all settings to defaults\n  const resetToDefaults = async (): Promise<void> => {\n    try {\n      setError(null);\n      await settingsService.resetToDefaults();\n      // Settings will be updated via subscription\n      logger.info('[SettingsContext] Settings reset to defaults');\n    } catch (err) {\n      const errorMessage = err instanceof Error ? err.message : 'Failed to reset settings';\n      logger.error('[SettingsContext] Failed to reset settings:', err);\n      setError(errorMessage);\n      throw err; // Re-throw for component error handling\n    }\n  };\n\n  // Export settings\n  const exportSettings = async (): Promise<string> => {\n    try {\n      setError(null);\n      const exportData = await settingsService.exportSettings();\n      logger.info('[SettingsContext] Settings exported successfully');\n      return exportData;\n    } catch (err) {\n      const errorMessage = err instanceof Error ? err.message : 'Failed to export settings';\n      logger.error('[SettingsContext] Failed to export settings:', err);\n      setError(errorMessage);\n      throw err; // Re-throw for component error handling\n    }\n  };\n\n  // Import settings\n  const importSettings = async (jsonData: string): Promise<void> => {\n    try {\n      setError(null);\n      await settingsService.importSettings(jsonData);\n      // Settings will be updated via subscription\n      logger.info('[SettingsContext] Settings imported successfully');\n    } catch (err) {\n      const errorMessage = err instanceof Error ? err.message : 'Failed to import settings';\n      logger.error('[SettingsContext] Failed to import settings:', err);\n      setError(errorMessage);\n      throw err; // Re-throw for component error handling\n    }\n  };\n\n  // Get a specific setting value\n  const getSetting = <K extends keyof UserSettings>(key: K): UserSettings[K] => {\n    return settings[key];\n  };\n\n  const contextValue: SettingsContextValue = {\n    settings,\n    isLoading,\n    error,\n    updateSetting,\n    updateSettings,\n    resetToDefaults,\n    exportSettings,\n    importSettings,\n    getSetting,\n  };\n\n  return (\n    <SettingsContext.Provider value={contextValue}>\n      {children}\n    </SettingsContext.Provider>\n  );\n};\n\nexport const useSettings = (): SettingsContextValue => {\n  const context = useContext(SettingsContext);\n  if (context === undefined) {\n    throw new Error('useSettings must be used within a SettingsProvider');\n  }\n  return context;\n};\n\nexport default SettingsContext; ","import React from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  TouchableOpacity,\n  ViewStyle,\n  TextStyle,\n} from 'react-native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { useAppTheme } from '../../contexts/ThemeContext';\nimport { AppTheme } from '../../config/theme';\nimport hapticService from '../../services/hapticService';\n\ninterface SettingsRowProps {\n  title: string;\n  subtitle?: string;\n  leftIcon?: keyof typeof Ionicons.glyphMap;\n  leftIconColor?: string;\n  rightElement?: React.ReactNode;\n  onPress?: () => void;\n  disabled?: boolean;\n  style?: ViewStyle;\n  showChevron?: boolean;\n  testID?: string;\n}\n\nconst SettingsRow: React.FC<SettingsRowProps> = ({\n  title,\n  subtitle,\n  leftIcon,\n  leftIconColor,\n  rightElement,\n  onPress,\n  disabled = false,\n  style,\n  showChevron = false,\n  testID,\n}) => {\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n\n  const handlePress = () => {\n    if (!disabled && onPress) {\n      hapticService.selection(); // Light haptic feedback for settings interactions\n      onPress();\n    }\n  };\n\n  const isInteractive = !!onPress && !disabled;\n\n  return (\n    <TouchableOpacity\n      style={[\n        styles.container,\n        disabled && styles.containerDisabled,\n        !isInteractive && styles.containerNonInteractive,\n        style,\n      ]}\n      onPress={handlePress}\n      disabled={!isInteractive}\n      activeOpacity={isInteractive ? 0.7 : 1}\n      testID={testID}\n      accessibilityRole={isInteractive ? 'button' : 'text'}\n      accessibilityLabel={subtitle ? `${title}, ${subtitle}` : title}\n      accessibilityHint={isInteractive ? 'Tap to modify this setting' : undefined}\n    >\n      <View style={styles.leftSection}>\n        {leftIcon && (\n          <View style={styles.iconContainer}>\n            <Ionicons\n              name={leftIcon}\n              size={22}\n              color={disabled ? theme.colors.disabled : (leftIconColor || theme.colors.primary)}\n            />\n          </View>\n        )}\n        \n        <View style={styles.textContainer}>\n          <Text \n            style={[\n              styles.title,\n              disabled && styles.titleDisabled,\n            ]}\n          >\n            {title}\n          </Text>\n          \n          {subtitle && (\n            <Text \n              style={[\n                styles.subtitle,\n                disabled && styles.subtitleDisabled,\n              ]}\n            >\n              {subtitle}\n            </Text>\n          )}\n        </View>\n      </View>\n\n      <View style={styles.rightSection}>\n        {rightElement}\n        \n        {showChevron && isInteractive && (\n          <View style={styles.chevronContainer}>\n            <Ionicons\n              name=\"chevron-forward\"\n              size={20}\n              color={disabled ? theme.colors.disabled : theme.colors.textSecondary}\n            />\n          </View>\n        )}\n      </View>\n    </TouchableOpacity>\n  );\n};\n\nconst getStyles = (theme: AppTheme) => StyleSheet.create({\n  container: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    paddingVertical: theme.spacing.md,\n    paddingHorizontal: theme.spacing.lg,\n    backgroundColor: theme.colors.card,\n    borderBottomWidth: 1,\n    borderBottomColor: theme.colors.border,\n    minHeight: 64,\n  },\n  containerDisabled: {\n    opacity: 0.6,\n  },\n  containerNonInteractive: {\n    // No special styling for non-interactive rows\n  },\n  leftSection: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    flex: 1,\n  },\n  iconContainer: {\n    width: 40,\n    height: 40,\n    borderRadius: theme.borderRadius.lg,\n    backgroundColor: theme.colors.primaryLight + '20',\n    justifyContent: 'center',\n    alignItems: 'center',\n    marginRight: theme.spacing.md,\n  },\n  textContainer: {\n    flex: 1,\n  },\n  title: {\n    fontSize: theme.typography.fontSizes.md,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n    color: theme.colors.text,\n    marginBottom: theme.spacing.xs,\n  },\n  titleDisabled: {\n    color: theme.colors.textSecondary,\n  },\n  subtitle: {\n    fontSize: theme.typography.fontSizes.sm,\n    fontFamily: theme.typography.fontFamilies.regular,\n    color: theme.colors.textSecondary,\n    lineHeight: 18,\n  },\n  subtitleDisabled: {\n    color: theme.colors.border,\n  },\n  rightSection: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginLeft: theme.spacing.md,\n  },\n  chevronContainer: {\n    marginLeft: theme.spacing.sm,\n  },\n});\n\nexport default SettingsRow; ","import React from 'react';\nimport { Switch, ViewStyle } from 'react-native';\nimport { useAppTheme } from '../../contexts/ThemeContext';\nimport SettingsRow from './SettingsRow';\nimport { Ionicons } from '@expo/vector-icons';\n\ninterface SettingsToggleProps {\n  title: string;\n  subtitle?: string;\n  leftIcon?: keyof typeof Ionicons.glyphMap;\n  value: boolean;\n  onValueChange: (value: boolean) => void;\n  disabled?: boolean;\n  style?: ViewStyle;\n  testID?: string;\n}\n\nconst SettingsToggle: React.FC<SettingsToggleProps> = ({\n  title,\n  subtitle,\n  leftIcon,\n  value,\n  onValueChange,\n  disabled = false,\n  style,\n  testID,\n}) => {\n  const { theme } = useAppTheme();\n\n  const handleToggle = () => {\n    if (!disabled) {\n      onValueChange(!value);\n    }\n  };\n\n  const switchElement = (\n    <Switch\n      trackColor={{ \n        false: theme.colors.gray300, \n        true: theme.colors.primary + '80' \n      }}\n      thumbColor={value ? theme.colors.primary : theme.colors.gray100}\n      ios_backgroundColor={theme.colors.gray300}\n      onValueChange={onValueChange}\n      value={value}\n      disabled={disabled}\n      accessibilityLabel={`${title} toggle`}\n      accessibilityRole=\"switch\"\n      accessibilityState={{ checked: value }}\n    />\n  );\n\n  return (\n    <SettingsRow\n      title={title}\n      subtitle={subtitle}\n      leftIcon={leftIcon}\n      rightElement={switchElement}\n      onPress={handleToggle}\n      disabled={disabled}\n      style={style}\n      testID={testID}\n    />\n  );\n};\n\nexport default SettingsToggle; ","import React, { useState } from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  ViewStyle,\n  Modal,\n  TouchableOpacity,\n  FlatList,\n} from 'react-native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { useAppTheme } from '../../contexts/ThemeContext';\nimport { AppTheme } from '../../config/theme';\nimport SettingsRow from './SettingsRow';\n\nexport interface SettingsOption {\n  value: string;\n  label: string;\n  subtitle?: string;\n  disabled?: boolean;\n}\n\ninterface SettingsSelectorProps {\n  title: string;\n  subtitle?: string;\n  leftIcon?: keyof typeof Ionicons.glyphMap;\n  options: SettingsOption[];\n  selectedValue: string;\n  onValueChange: (value: string) => void;\n  disabled?: boolean;\n  style?: ViewStyle;\n  testID?: string;\n  placeholder?: string;\n}\n\nconst SettingsSelector: React.FC<SettingsSelectorProps> = ({\n  title,\n  subtitle,\n  leftIcon,\n  options,\n  selectedValue,\n  onValueChange,\n  disabled = false,\n  style,\n  testID,\n  placeholder = 'Select an option',\n}) => {\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n  const [isModalVisible, setIsModalVisible] = useState(false);\n\n  const selectedOption = options.find(option => option.value === selectedValue);\n  const displayText = selectedOption?.label || placeholder;\n\n  const handleOptionSelect = (value: string) => {\n    onValueChange(value);\n    setIsModalVisible(false);\n  };\n\n  const handlePress = () => {\n    if (!disabled) {\n      setIsModalVisible(true);\n    }\n  };\n\n  const rightElement = (\n    <View style={styles.rightContainer}>\n      <Text \n        style={[\n          styles.selectedText,\n          disabled && styles.selectedTextDisabled,\n          !selectedOption && styles.placeholderText,\n        ]}\n      >\n        {displayText}\n      </Text>\n    </View>\n  );\n\n  const renderOption = ({ item }: { item: SettingsOption }) => (\n    <TouchableOpacity\n      style={[\n        styles.optionItem,\n        item.value === selectedValue && styles.selectedOptionItem,\n        item.disabled && styles.optionItemDisabled,\n      ]}\n      onPress={() => handleOptionSelect(item.value)}\n      disabled={item.disabled}\n      accessibilityRole=\"button\"\n      accessibilityLabel={item.label}\n      accessibilityState={{ selected: item.value === selectedValue }}\n    >\n      <View style={styles.optionContent}>\n        <Text \n          style={[\n            styles.optionLabel,\n            item.value === selectedValue && styles.selectedOptionLabel,\n            item.disabled && styles.optionLabelDisabled,\n          ]}\n        >\n          {item.label}\n        </Text>\n        \n        {item.subtitle && (\n          <Text \n            style={[\n              styles.optionSubtitle,\n              item.disabled && styles.optionSubtitleDisabled,\n            ]}\n          >\n            {item.subtitle}\n          </Text>\n        )}\n      </View>\n      \n      {item.value === selectedValue && (\n        <Ionicons \n          name=\"checkmark-circle\" \n          size={24} \n          color={theme.colors.primary} \n        />\n      )}\n    </TouchableOpacity>\n  );\n\n  return (\n    <>\n      <SettingsRow\n        title={title}\n        subtitle={subtitle}\n        leftIcon={leftIcon}\n        rightElement={rightElement}\n        onPress={handlePress}\n        disabled={disabled}\n        style={style}\n        showChevron={true}\n        testID={testID}\n      />\n\n      <Modal\n        visible={isModalVisible}\n        animationType=\"slide\"\n        presentationStyle=\"pageSheet\"\n        onRequestClose={() => setIsModalVisible(false)}\n      >\n        <View style={styles.modalContainer}>\n          {/* Modal Header */}\n          <View style={styles.modalHeader}>\n            <View style={styles.headerLeft} />\n            \n            <Text style={styles.modalTitle}>{title}</Text>\n            \n            <TouchableOpacity\n              style={styles.headerButton}\n              onPress={() => setIsModalVisible(false)}\n              accessibilityLabel=\"Close\"\n              accessibilityRole=\"button\"\n            >\n              <Text style={styles.doneButtonText}>Done</Text>\n            </TouchableOpacity>\n          </View>\n\n          {/* Options List */}\n          <FlatList\n            data={options}\n            keyExtractor={(item) => item.value}\n            renderItem={renderOption}\n            style={styles.optionsList}\n            showsVerticalScrollIndicator={true}\n            bounces={true}\n          />\n        </View>\n      </Modal>\n    </>\n  );\n};\n\nconst getStyles = (theme: AppTheme) => StyleSheet.create({\n  rightContainer: {\n    alignItems: 'flex-end',\n  },\n  selectedText: {\n    fontSize: theme.typography.fontSizes.md,\n    fontFamily: theme.typography.fontFamilies.regular,\n    color: theme.colors.textSecondary,\n    textAlign: 'right',\n  },\n  selectedTextDisabled: {\n    color: theme.colors.disabled,\n  },\n  placeholderText: {\n    fontStyle: 'italic',\n    color: theme.colors.textDisabled,\n  },\n  modalContainer: {\n    flex: 1,\n    backgroundColor: theme.colors.background,\n  },\n  modalHeader: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: theme.spacing.lg,\n    paddingVertical: theme.spacing.md,\n    borderBottomWidth: 1,\n    borderBottomColor: theme.colors.border,\n    backgroundColor: theme.colors.card,\n  },\n  headerLeft: {\n    width: 60, // Balance the header\n  },\n  modalTitle: {\n    fontSize: theme.typography.fontSizes.lg,\n    fontFamily: theme.typography.fontFamilies.bold,\n    color: theme.colors.text,\n    textAlign: 'center',\n  },\n  headerButton: {\n    width: 60,\n    alignItems: 'flex-end',\n  },\n  doneButtonText: {\n    fontSize: theme.typography.fontSizes.md,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n    color: theme.colors.primary,\n  },\n  optionsList: {\n    flex: 1,\n  },\n  optionItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingVertical: theme.spacing.lg,\n    paddingHorizontal: theme.spacing.lg,\n    backgroundColor: theme.colors.card,\n    borderBottomWidth: 1,\n    borderBottomColor: theme.colors.border,\n    minHeight: 64,\n  },\n  selectedOptionItem: {\n    backgroundColor: theme.colors.primaryLight + '20',\n  },\n  optionItemDisabled: {\n    opacity: 0.5,\n  },\n  optionContent: {\n    flex: 1,\n  },\n  optionLabel: {\n    fontSize: theme.typography.fontSizes.md,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n    color: theme.colors.text,\n  },\n  selectedOptionLabel: {\n    color: theme.colors.primary,\n  },\n  optionLabelDisabled: {\n    color: theme.colors.disabled,\n  },\n  optionSubtitle: {\n    fontSize: theme.typography.fontSizes.sm,\n    fontFamily: theme.typography.fontFamilies.regular,\n    color: theme.colors.textSecondary,\n    marginTop: theme.spacing.xs,\n  },\n  optionSubtitleDisabled: {\n    color: theme.colors.disabled,\n  },\n});\n\nexport default SettingsSelector; ","import React, { useState } from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  TouchableOpacity,\n  Animated,\n  LayoutAnimation,\n  Platform,\n} from 'react-native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { useAppTheme } from '../../contexts/ThemeContext';\nimport { AppTheme } from '../../config/theme';\n\ninterface SettingsSectionProps {\n  title: string;\n  subtitle?: string;\n  icon?: keyof typeof Ionicons.glyphMap;\n  children: React.ReactNode;\n  collapsible?: boolean;\n  initiallyExpanded?: boolean;\n  headerAction?: React.ReactNode;\n}\n\nconst SettingsSection: React.FC<SettingsSectionProps> = ({\n  title,\n  subtitle,\n  icon,\n  children,\n  collapsible = false,\n  initiallyExpanded = true,\n  headerAction,\n}) => {\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n  const [isExpanded, setIsExpanded] = useState(initiallyExpanded);\n\n  const toggleExpanded = () => {\n    if (collapsible) {\n      // Use LayoutAnimation for smooth collapse/expand\n      if (Platform.OS !== 'web') {\n        LayoutAnimation.configureNext({\n          duration: 300,\n          create: { type: 'easeInEaseOut', property: 'opacity' },\n          update: { type: 'easeInEaseOut' },\n          delete: { type: 'easeInEaseOut', property: 'opacity' },\n        });\n      }\n      setIsExpanded(!isExpanded);\n    }\n  };\n\n  return (\n    <View style={styles.container}>\n      <View style={styles.header}>\n        {icon && (\n          <Ionicons name={icon} size={20} color={theme.colors.textSecondary} style={styles.headerIcon} />\n        )}\n        <View style={styles.titleContainer}>\n          <Text style={styles.title}>{title}</Text>\n          {subtitle && <Text style={styles.subtitle}>{subtitle}</Text>}\n        </View>\n        {headerAction && (\n          <View style={styles.headerAction}>\n            {headerAction}\n          </View>\n        )}\n      </View>\n      <View style={styles.childrenContainer}>{children}</View>\n    </View>\n  );\n};\n\nconst getStyles = (theme: AppTheme) =>\n  StyleSheet.create({\n    container: {\n      marginVertical: theme.spacing.sm,\n      marginHorizontal: theme.spacing.md,\n      backgroundColor: theme.colors.card,\n      borderRadius: theme.borderRadius.lg,\n      overflow: 'hidden',\n      ...theme.shadows.sm,\n    },\n    header: {\n      flexDirection: 'row',\n      alignItems: 'center',\n      paddingVertical: theme.spacing.sm,\n      paddingHorizontal: theme.spacing.md,\n      backgroundColor: theme.colors.card,\n      borderBottomWidth: 1,\n      borderBottomColor: theme.colors.border,\n    },\n    headerTouchable: {\n      flexDirection: 'row',\n      alignItems: 'center',\n      flex: 1,\n    },\n    headerIcon: {\n      marginRight: theme.spacing.md,\n    },\n    titleContainer: {\n      flex: 1,\n    },\n    title: {\n      fontSize: theme.typography.fontSizes.lg,\n      fontFamily: theme.typography.fontFamilies.bold,\n      color: theme.colors.text,\n    },\n    headerAction: {\n      marginLeft: theme.spacing.md,\n    },\n    subtitle: {\n      fontSize: theme.typography.fontSizes.sm,\n      color: theme.colors.textSecondary,\n      marginLeft: theme.spacing.sm,\n      padding: theme.spacing.xs,\n    },\n    childrenContainer: {\n      paddingHorizontal: theme.spacing.md,\n      paddingBottom: theme.spacing.md,\n    },\n    iconContainer: {\n      width: 40,\n      height: 40,\n      borderRadius: theme.borderRadius.md,\n      backgroundColor: theme.colors.primaryLight + '20',\n      justifyContent: 'center',\n      alignItems: 'center',\n      marginRight: theme.spacing.md,\n    },\n    content: {\n      paddingHorizontal: theme.spacing.md,\n      paddingBottom: theme.spacing.sm,\n      backgroundColor: theme.colors.card,\n    },\n  });\n\nexport default SettingsSection; ","import React, { useState, useEffect } from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  TouchableOpacity,\n  Alert,\n  Switch,\n  ActivityIndicator,\n  RefreshControl,\n  Animated,\n} from 'react-native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { useNavigation } from '@react-navigation/native';\nimport { CompositeNavigationProp } from '@react-navigation/native';\nimport { BottomTabNavigationProp } from '@react-navigation/bottom-tabs';\nimport { StackNavigationProp } from '@react-navigation/stack';\n\nimport { useAuth } from '../../contexts/AuthContext';\nimport { useAppTheme } from '../../contexts/ThemeContext';\nimport { useSettings } from '../../contexts/SettingsContext';\nimport { AppTheme } from '../../config/theme';\nimport { MainStackParamList, MainTabParamList } from '../../navigation/types';\nimport { SUPPORTED_LANGUAGES } from '../../config/languageConfig';\nimport logger from '../../utils/logger';\nimport SafeScrollView from '../../components/SafeScrollView';\nimport { SettingsSkeleton } from '../../components/SkeletonLoader';\nimport ScreenHeader from '../../components/ScreenHeader';\n\n// Settings components\nimport SettingsRow from '../../components/settings/SettingsRow';\nimport SettingsToggle from '../../components/settings/SettingsToggle';\nimport SettingsSelector from '../../components/settings/SettingsSelector';\nimport SettingsSection from '../../components/settings/SettingsSection';\n\ninterface SettingsOption {\n  value: string;\n  label: string;\n  subtitle?: string;\n}\n\ntype SettingsScreenNavigationProp = CompositeNavigationProp<\n  BottomTabNavigationProp<MainTabParamList, 'Settings'>,\n  StackNavigationProp<MainStackParamList>\n>;\n\nconst SettingsScreen: React.FC = () => {\n  const navigation = useNavigation<SettingsScreenNavigationProp>();\n  const { user, logout } = useAuth();\n  const { theme, toggleTheme, isSystemTheme, setUseSystemTheme } = useAppTheme();\n  const { settings, updateSetting, isLoading } = useSettings();\n  const styles = getStyles(theme);\n  const [isRefreshing, setIsRefreshing] = useState(false);\n  \n  // Scroll to top functionality\n  const scrollViewRef = React.useRef<any>(null);\n  const [showScrollToTop, setShowScrollToTop] = useState(false);\n  const scrollToTopOpacity = React.useRef(new Animated.Value(0)).current;\n  \n  const handleScroll = (event: any) => {\n    const scrollY = event.nativeEvent.contentOffset.y;\n    const shouldShow = scrollY > 200;\n    \n    if (shouldShow !== showScrollToTop) {\n      setShowScrollToTop(shouldShow);\n      Animated.timing(scrollToTopOpacity, {\n        toValue: shouldShow ? 1 : 0,\n        duration: 200,\n        useNativeDriver: false, // Changed to false for web compatibility\n      }).start();\n    }\n  };\n  \n  const scrollToTop = () => {\n    scrollViewRef.current?.scrollTo({ y: 0, animated: true });\n  };\n\n  // Loading state\n  if (isLoading) {\n    return (\n      <View style={styles.container}>\n        <SettingsSkeleton />\n      </View>\n    );\n  }\n\n  // Language options for selector\n  const languageOptions: SettingsOption[] = SUPPORTED_LANGUAGES.map(lang => ({\n    value: lang.code,\n    label: lang.name,\n    subtitle: lang.region ? `${lang.region}` : undefined,\n  }));\n\n  const handleSignOut = async () => {\n    // For web platform, use window.confirm instead of Alert.alert\n    const confirmed = window.confirm('Are you sure you want to sign out?');\n    \n    if (confirmed) {\n      try {\n        logger.info('[SettingsScreen] User confirmed sign out');\n        await logout();\n        logger.info('[SettingsScreen] User signed out successfully');\n      } catch (error) {\n        logger.error('[SettingsScreen] Error during sign out:', error);\n        window.alert('Failed to sign out. Please try again.');\n      }\n    }\n  };\n\n  // Handle pull-to-refresh\n  const onRefresh = React.useCallback(() => {\n    setIsRefreshing(true);\n    // Simulate refresh by resetting the refresh state\n    setTimeout(() => {\n      setIsRefreshing(false);\n    }, 1000);\n  }, []);\n\n  return (\n    <View style={styles.container}>\n      <ScreenHeader title=\"Settings\" />\n      <SafeScrollView \n        ref={scrollViewRef}\n        style={styles.container} \n        contentContainerStyle={styles.scrollContent}\n        showsVerticalScrollIndicator={false}\n        onScroll={handleScroll}\n        scrollEventThrottle={16}\n        refreshControl={\n          <RefreshControl\n            refreshing={isRefreshing}\n            onRefresh={onRefresh}\n            colors={[theme.colors.primary]}\n            tintColor={theme.colors.primary}\n          />\n        }\n      >\n      {/* Profile Section */}\n      <SettingsSection\n        title=\"Profile\"\n        icon=\"person\"\n      >\n        <SettingsRow\n          title=\"Account\"\n          subtitle={user?.email || 'No email available'}\n          leftIcon=\"mail\"\n          rightElement={\n            <View style={styles.profileBadge}>\n              <Text style={styles.profileBadgeText}>\n                {user?.email?.charAt(0).toUpperCase() || 'U'}\n              </Text>\n            </View>\n          }\n        />\n\n        <SettingsRow\n          title=\"Sign Out\"\n          subtitle=\"Sign out of your account\"\n          leftIcon=\"log-out\"\n          onPress={handleSignOut}\n          showChevron={true}\n        />\n      </SettingsSection>\n\n      {/* Language & Transcription Section */}\n      <SettingsSection\n        title=\"Language & Transcription\"\n        icon=\"language\"\n      >\n        <SettingsSelector\n          title=\"Default Language\"\n          subtitle=\"Language for voice transcription\"\n          leftIcon=\"globe\"\n          options={languageOptions}\n          selectedValue={settings.defaultLanguage}\n          onValueChange={(value) => updateSetting('defaultLanguage', value)}\n        />\n      </SettingsSection>\n\n      {/* Privacy & Security Section */}\n      <SettingsSection\n        title=\"Privacy & Security\"\n        icon=\"shield-checkmark\"\n      >\n        <SettingsRow\n          title=\"Tags\"\n          subtitle=\"Manage regular and privacy tags\"\n          leftIcon=\"pricetag\"\n          onPress={() => navigation.navigate('TagManagement')}\n          showChevron={true}\n        />\n\n        <SettingsToggle\n          title=\"Analytics\"\n          subtitle=\"Help improve the app\"\n          leftIcon=\"analytics\"\n          value={settings.analyticsEnabled}\n          onValueChange={(value) => updateSetting('analyticsEnabled', value)}\n        />\n\n        <SettingsToggle\n          title=\"Crash Reports\"\n          subtitle=\"Send crash reports to developers\"\n          leftIcon=\"bug\"\n          value={settings.crashReportsEnabled}\n          onValueChange={(value) => updateSetting('crashReportsEnabled', value)}\n        />\n      </SettingsSection>\n\n      {/* App Settings Section */}\n      <SettingsSection\n        title=\"App Settings\"\n        icon=\"settings\"\n      >\n        <SettingsToggle\n          title=\"Dark Mode\"\n          subtitle={isSystemTheme ? \"Following system setting\" : \"Manual override\"}\n          leftIcon=\"moon\"\n          value={theme.isDarkMode}\n          onValueChange={() => {\n            if (isSystemTheme) setUseSystemTheme(false);\n            toggleTheme();\n          }}\n          disabled={isSystemTheme}\n        />\n        \n        <SettingsToggle\n          title=\"Use System Theme\"\n          subtitle=\"Follow device theme setting\"\n          leftIcon=\"phone-portrait\"\n          value={isSystemTheme}\n          onValueChange={setUseSystemTheme}\n        />\n\n        <SettingsToggle\n          title=\"Haptic Feedback\"\n          subtitle=\"Enable subtle vibrations for interactions\"\n          leftIcon=\"pulse-outline\"\n          value={settings.hapticFeedbackEnabled}\n          onValueChange={(value) =>\n            updateSetting('hapticFeedbackEnabled', value)\n          }\n        />\n        \n        <SettingsToggle\n          title=\"Auto-Save Entry\"\n          subtitle=\"Automatically save during recording\"\n          leftIcon=\"save-outline\"\n          value={settings.autoSaveEnabled}\n          onValueChange={(value) =>\n            updateSetting('autoSaveEnabled', value)\n          }\n        />\n        \n        <SettingsToggle\n          title=\"Auto-Start Recording\"\n          subtitle=\"Automatically start recording when opening record screen\"\n          leftIcon=\"mic-outline\"\n          value={settings.autoRecordingEnabled}\n          onValueChange={(value) =>\n            updateSetting('autoRecordingEnabled', value)\n          }\n        />\n      </SettingsSection>\n\n      {/* Notifications Section */}\n      <SettingsSection\n        title=\"Notifications\"\n        icon=\"notifications\"\n      >\n        <SettingsToggle\n          title=\"Push Notifications\"\n          subtitle=\"Receive app notifications\"\n          leftIcon=\"notifications\"\n          value={settings.notificationsEnabled}\n          onValueChange={(value) => updateSetting('notificationsEnabled', value)}\n        />\n\n        <SettingsToggle\n          title=\"Daily Reminders\"\n          subtitle=\"Reminder to write in your journal\"\n          leftIcon=\"time\"\n          value={settings.reminderNotifications}\n          onValueChange={(value) => updateSetting('reminderNotifications', value)}\n        />\n\n        {settings.reminderNotifications && (\n          <SettingsRow\n            title=\"Reminder Time\"\n            subtitle={`Daily reminder at ${settings.dailyReminderTime}`}\n            leftIcon=\"alarm\"\n            rightElement={\n              <Text style={styles.timeText}>{settings.dailyReminderTime}</Text>\n            }\n            onPress={() => {\n              // TODO: Implement time picker\n              Alert.alert('Coming Soon', 'Time picker will be available in a future update.');\n            }}\n            showChevron={true}\n          />\n        )}\n      </SettingsSection>\n\n      {/* About Section */}\n      <SettingsSection\n        title=\"About\"\n        icon=\"information-circle\"\n      >\n        <SettingsRow\n          title=\"Version\"\n          subtitle=\"Current app version\"\n          leftIcon=\"code-working\"\n          rightElement={\n            <Text style={styles.versionText}>1.0.0</Text>\n          }\n        />\n\n        <SettingsRow\n          title=\"Privacy Policy\"\n          subtitle=\"View our privacy policy\"\n          leftIcon=\"document-text\"\n          onPress={() => {\n            Alert.alert('Privacy Policy', 'Privacy policy will be available soon.');\n          }}\n          showChevron={true}\n        />\n\n        <SettingsRow\n          title=\"Terms of Service\"\n          subtitle=\"View terms and conditions\"\n          leftIcon=\"document\"\n          onPress={() => {\n            Alert.alert('Terms of Service', 'Terms of service will be available soon.');\n          }}\n          showChevron={true}\n        />\n      </SettingsSection>\n\n      {/* Bottom spacing */}\n      <View style={styles.bottomSpacing} />\n    </SafeScrollView>\n    \n    {/* Scroll to top button */}\n    <Animated.View \n      style={[\n        styles.scrollToTopButton,\n        {\n          opacity: scrollToTopOpacity,\n          transform: [{\n            scale: scrollToTopOpacity.interpolate({\n              inputRange: [0, 1],\n              outputRange: [0.8, 1],\n            })\n          }]\n        }\n      ]}\n      pointerEvents={showScrollToTop ? 'auto' : 'none'}\n    >\n      <TouchableOpacity\n        style={styles.scrollToTopButtonInner}\n        onPress={scrollToTop}\n        activeOpacity={0.7}\n      >\n        <Ionicons name=\"chevron-up\" size={24} color={theme.colors.background} />\n      </TouchableOpacity>\n    </Animated.View>\n  </View>\n  );\n};\n\nconst getStyles = (theme: AppTheme) => StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: theme.colors.background,\n  },\n  scrollContent: {\n    paddingBottom: 100,\n  },\n  centerContent: {\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  loadingText: {\n    marginTop: theme.spacing.md,\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: theme.spacing.lg,\n    paddingTop: theme.spacing.xl,\n    paddingBottom: theme.spacing.lg,\n    borderBottomWidth: 1,\n    borderBottomColor: theme.colors.border,\n  },\n  backButton: {\n    width: 40,\n    height: 40,\n    borderRadius: 20,\n    backgroundColor: theme.colors.card,\n    justifyContent: 'center',\n    alignItems: 'center',\n    ...theme.shadows.sm,\n  },\n  headerTitle: {\n    fontSize: theme.typography.fontSizes.xl,\n    fontWeight: 'bold',\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.bold,\n  },\n  headerSpacer: {\n    width: 40,\n  },\n  profileBadge: {\n    width: 36,\n    height: 36,\n    borderRadius: 18,\n    backgroundColor: theme.colors.primary,\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  profileBadgeText: {\n    fontSize: theme.typography.fontSizes.md,\n    fontWeight: 'bold',\n    color: theme.colors.background,\n    fontFamily: theme.typography.fontFamilies.bold,\n  },\n  statusText: {\n    fontSize: theme.typography.fontSizes.sm,\n    fontFamily: theme.typography.fontFamilies.medium,\n  },\n  timeText: {\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  versionText: {\n    fontSize: theme.typography.fontSizes.sm,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  bottomSpacing: {\n    height: theme.spacing.xxxl,\n  },\n  scrollToTopButton: {\n    position: 'absolute',\n    bottom: 30,\n    right: 20,\n    zIndex: 1000,\n  },\n  scrollToTopButtonInner: {\n    width: 50,\n    height: 50,\n    borderRadius: 25,\n    backgroundColor: theme.colors.primary,\n    justifyContent: 'center',\n    alignItems: 'center',\n    ...theme.shadows.lg,\n  },\n});\n\nexport default SettingsScreen; ","import React, { useEffect, useCallback } from 'react';\nimport { createBottomTabNavigator } from '@react-navigation/bottom-tabs';\nimport { createStackNavigator } from '@react-navigation/stack';\nimport { Ionicons } from '@expo/vector-icons';\nimport { View, StyleSheet, Platform } from 'react-native';\nimport { StackNavigationProp } from '@react-navigation/stack';\nimport { useAppTheme } from '../contexts/ThemeContext';\nimport { AppTheme } from '../config/theme';\nimport { MainTabParamList, MainStackParamList } from './types';\nimport logger from '../utils/logger';\nimport audioPrewarmService from '../services/audioPrewarmService';\n\n// Import our modern FloatingActionButton\nimport FloatingActionButton from '../components/FloatingActionButton';\n\nimport HomeScreen from '../screens/main/HomeScreen';\nimport JournalScreen from '../screens/main/JournalScreen';\nimport CalendarScreen from '../screens/main/CalendarScreen';\nimport SettingsScreen from '../screens/main/SettingsScreen';\n\nconst Tab = createBottomTabNavigator<MainTabParamList>();\n\ntype MainTabNavigatorProps = {\n  navigation: StackNavigationProp<MainStackParamList, 'MainTabs'>;\n};\n\n\n\nconst MainTabNavigator = ({ navigation }: MainTabNavigatorProps) => {\n  const { theme } = useAppTheme();\n  const styles = getNavigatorStyles(theme);\n\n  // Pre-warm audio system when MainTabNavigator mounts\n  useEffect(() => {\n    const prewarmAudio = async () => {\n      try {\n        logger.info('[MainTabNavigator] Starting audio system prewarm...');\n        await audioPrewarmService.prewarmAudioSystem();\n        \n        const metrics = audioPrewarmService.getPerformanceMetrics();\n        logger.info('[MainTabNavigator] Audio prewarm completed:', metrics);\n      } catch (error) {\n        logger.error('[MainTabNavigator] Audio prewarm failed:', error);\n      }\n    };\n\n    prewarmAudio();\n\n    // Cleanup on unmount\n    return () => {\n      audioPrewarmService.cleanup();\n    };\n  }, []);\n\n  const handleRecordPress = useCallback(() => {\n    logger.info('[MainTabNavigator] FloatingActionButton pressed. Navigating to Record screen.');\n    \n    // Check if audio system is ready\n    const isReady = audioPrewarmService.isReadyForRecording();\n    if (!isReady) {\n      logger.warn('[MainTabNavigator] Audio system not ready, attempting to prewarm...');\n      audioPrewarmService.prewarmAudioSystem().catch(error => {\n        logger.error('[MainTabNavigator] Failed to prewarm audio system:', error);\n      });\n    }\n    \n    // Navigate to the Record screen using the navigation prop from the parent StackNavigator\n    navigation.navigate('Record');\n  }, [navigation]);\n\n  return (\n    <View style={styles.container}>\n      <Tab.Navigator\n        screenOptions={({ route }) => ({\n          headerShown: false,\n          tabBarActiveTintColor: theme.colors.tabBarActive,\n          tabBarInactiveTintColor: theme.colors.tabBarInactive,\n          tabBarStyle: styles.tabBarStyle,\n          tabBarLabelStyle: styles.tabBarLabelStyle,\n          tabBarItemStyle: styles.tabBarItemStyle,\n          tabBarIcon: ({ focused, color, size }) => {\n            let iconName: keyof typeof Ionicons.glyphMap | undefined;\n            if (route.name === 'Home') iconName = focused ? 'home' : 'home-outline';\n            else if (route.name === 'Journal') iconName = focused ? 'book' : 'book-outline';\n            else if (route.name === 'Calendar') iconName = focused ? 'calendar' : 'calendar-outline';\n            else if (route.name === 'Settings') iconName = focused ? 'cog' : 'cog-outline';\n\n            if (!iconName) return <View style={{width:size, height:size}}/>;\n            return <Ionicons name={iconName} size={focused ? size + 2 : size} color={color} />;\n          },\n        })}\n      >\n        <Tab.Screen name=\"Home\" component={HomeScreen} options={{ tabBarLabel: 'Home'}} />\n        <Tab.Screen name=\"Journal\" component={JournalScreen} options={{ tabBarLabel: 'Journal'}} />\n        <Tab.Screen name=\"Calendar\" component={CalendarScreen} options={{ tabBarLabel: 'Calendar'}} />\n        <Tab.Screen name=\"Settings\" component={SettingsScreen} options={{ tabBarLabel: 'Settings'}}/>\n      </Tab.Navigator>\n      \n      {/* Floating Action Button positioned over the tab bar */}\n      <View style={styles.fabContainer}>\n        <FloatingActionButton\n          onPress={handleRecordPress}\n          icon=\"mic\"\n          size={64}\n          variant=\"primary\"\n          testID=\"main-record-button\"\n        />\n      </View>\n    </View>\n  );\n};\n\nconst getNavigatorStyles = (theme: AppTheme) => StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  tabBarStyle: {\n    backgroundColor: theme.colors.card,\n    borderTopColor: theme.colors.borderLight,\n    borderTopWidth: 1,\n    height: Platform.OS === 'ios' ? 88 : 75,\n    paddingBottom: Platform.OS === 'ios' ? 24 : 8,\n    paddingTop: 8,\n    paddingHorizontal: theme.spacing.sm,\n    ...theme.shadows.lg,\n    // Modern floating tab bar effect\n    marginHorizontal: theme.spacing.md,\n    marginBottom: Platform.OS === 'ios' ? theme.spacing.lg : theme.spacing.md,\n    borderRadius: theme.borderRadius.xl,\n    position: 'absolute',\n    left: 0,\n    right: 0,\n    bottom: 0,\n  },\n  tabBarLabelStyle: {\n    fontSize: theme.typography.fontSizes.xs,\n    fontFamily: theme.typography.fontFamilies.medium,\n    marginBottom: Platform.OS === 'ios' ? 0 : theme.spacing.xs,\n    marginTop: theme.spacing.xs,\n  },\n  tabBarItemStyle: {\n    paddingVertical: theme.spacing.xs,\n    borderRadius: theme.borderRadius.md,\n  },\n  fabContainer: {\n    position: 'absolute',\n    bottom: Platform.OS === 'ios' ? 100 : 85, // Position above tab bar\n    alignSelf: 'center',\n    zIndex: 1000,\n  },\n});\n\nexport default MainTabNavigator; ","/**\n * Feature Flags Configuration\n * \n * Central location for controlling app features during development and deployment.\n * This allows us to disable features temporarily while preserving code for future releases.\n */\n\nexport interface FeatureFlags {\n  // Secret Tags Features\n  ENABLE_OFFLINE_SECRET_TAGS: boolean;\n  ENABLE_SECRET_TAG_CACHING: boolean;\n  ENABLE_SECURITY_MODE_SWITCHING: boolean;\n  ENABLE_BORDER_CROSSING_MODE: boolean;\n  // Global kill-switch for all secret-tag UI & detection paths\n  ENABLE_SECRET_TAGS: boolean;\n  \n  // Future features can be added here\n  ENABLE_TEAM_COLLABORATION: boolean;\n  ENABLE_CLOUD_BACKUP: boolean;\n}\n\n/**\n * Current feature flag configuration for production deployment\n * \n * TEMPORARILY DISABLED FOR INITIAL LAUNCH:\n * - Offline secret tags functionality\n * - Security mode switching \n * - Border crossing data clearing\n * \n * These features are fully implemented and tested, but disabled to simplify\n * the initial user experience and reduce complexity for the first release.\n * \n * To re-enable offline features for future releases, change the relevant\n * flags to true and the system will seamlessly restore full functionality.\n */\nexport const FEATURE_FLAGS: FeatureFlags = {\n  // Global kill-switch (default OFF for Kotori)\n  ENABLE_SECRET_TAGS: false,\n  // Secret Tags - TEMPORARILY DISABLED FOR LAUNCH SIMPLIFICATION\n  ENABLE_OFFLINE_SECRET_TAGS: false,        // Disable offline caching\n  ENABLE_SECRET_TAG_CACHING: false,         // Disable local storage of tags\n  ENABLE_SECURITY_MODE_SWITCHING: false,    // Hide online/offline mode toggle\n  ENABLE_BORDER_CROSSING_MODE: false,       // Disable data clearing features\n  \n  // Future features - Not yet implemented\n  ENABLE_TEAM_COLLABORATION: false,\n  ENABLE_CLOUD_BACKUP: false,\n};\n\n/**\n * Development override flags (for testing disabled features during development)\n * Set via environment variables or developer settings\n */\nexport const DEV_FEATURE_OVERRIDES: Partial<FeatureFlags> = {\n  // Uncomment to test offline features during development:\n  // ENABLE_OFFLINE_SECRET_TAGS: true,\n  // ENABLE_SECRET_TAG_CACHING: true,\n  // ENABLE_SECURITY_MODE_SWITCHING: true,\n  // ENABLE_BORDER_CROSSING_MODE: true,\n};\n\n/**\n * Get the current feature flag value with development overrides\n */\nexport function getFeatureFlag<K extends keyof FeatureFlags>(key: K): boolean {\n  // Check for development override first\n  if (DEV_FEATURE_OVERRIDES[key] !== undefined) {\n    return DEV_FEATURE_OVERRIDES[key] as boolean;\n  }\n  \n  // Return production flag value\n  return FEATURE_FLAGS[key];\n}\n\n/**\n * Check if offline secret tag features are enabled\n */\nexport function isOfflineSecretTagsEnabled(): boolean {\n  return getFeatureFlag('ENABLE_SECRET_TAGS') && getFeatureFlag('ENABLE_OFFLINE_SECRET_TAGS');\n}\n\n/**\n * Check if security mode switching is enabled\n */\nexport function isSecurityModeSwitchingEnabled(): boolean {\n  return getFeatureFlag('ENABLE_SECRET_TAGS') && getFeatureFlag('ENABLE_SECURITY_MODE_SWITCHING');\n}\n\n/**\n * Check if secret tag caching is enabled  \n */\nexport function isSecretTagCachingEnabled(): boolean {\n  return getFeatureFlag('ENABLE_SECRET_TAGS') && getFeatureFlag('ENABLE_SECRET_TAG_CACHING');\n}\n\n/**\n * Check if border crossing mode is enabled\n */\nexport function isBorderCrossingModeEnabled(): boolean {\n  return getFeatureFlag('ENABLE_SECRET_TAGS') && getFeatureFlag('ENABLE_BORDER_CROSSING_MODE');\n} \n\nexport function areSecretTagsEnabled(): boolean {\n  return getFeatureFlag('ENABLE_SECRET_TAGS');\n}","import { Platform } from 'react-native';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport logger from '../utils/logger';\n// Import the NAMED export 'api' (the axios instance) and alias it\nimport { api as axiosInstance } from './api';\nimport axios from 'axios';\nimport * as FileSystem from 'expo-file-system';\nimport { validateLanguageCode } from '../config/languageConfig';\nimport { voicePhraseDetector } from './VoicePhraseDetector';\nimport { areSecretTagsEnabled } from '../config/featureFlags';\n\n// Enhanced types for multi-language transcription\ninterface TranscriptionResult {\n  transcript: string;\n  detected_language_code?: string;\n  confidence: number;\n  alternatives: Array<{\n    transcript: string;\n    confidence: number;\n  }>;\n  word_confidence: Array<{\n    word: string;\n    confidence: number;\n    start_time: number;\n    end_time: number;\n  }>;\n  language_confidence: number;\n  quality_metrics: {\n    average_confidence: number;\n    low_confidence_words: number;\n    total_words: number;\n  };\n  secret_tag_detected?: {\n    found: boolean;\n    tagId?: string;\n    tagName?: string;\n    action?: 'activate' | 'deactivate' | 'panic';\n  };\n}\n\ninterface TranscriptionOptions {\n  languageCodes?: string[]; // Enhanced to support multiple language codes\n  maxAlternatives?: number;\n  enableWordConfidence?: boolean;\n  confidenceThreshold?: number;\n  enableSecretTagDetection?: boolean; // Enable secret tag phrase detection\n}\n\ninterface TranscriptionError {\n  type: 'validation' | 'network' | 'server' | 'authentication' | 'unknown';\n  message: string;\n  details?: any;\n}\n\n/**\n * Enhanced Speech-to-Text Service with multi-language support and secret tag detection\n */\nclass SpeechToTextService {\n  private static instance: SpeechToTextService;\n\n  public static getInstance(): SpeechToTextService {\n    if (!SpeechToTextService.instance) {\n      SpeechToTextService.instance = new SpeechToTextService();\n    }\n    return SpeechToTextService.instance;\n  }\n\n  private readonly maxRetries = 2;\n  private readonly retryDelay = 1000; // 1 second\n\n  constructor() {\n    logger.info('Enhanced SpeechToTextService initialized for multi-language support');\n  }\n\n  /**\n   * Enhanced transcription method with multi-language support and secret tag detection\n   */\n  public async transcribeAudio(\n    audioFilePath: string,\n    options: TranscriptionOptions = {}\n  ): Promise<TranscriptionResult> {\n    const { \n      languageCodes, \n      maxAlternatives = 3, \n      enableWordConfidence = true,\n      enableSecretTagDetection = true \n    } = options;\n    \n    logger.info(\n      `Requesting enhanced transcription for audio file: ${audioFilePath}, ` +\n      `Languages: ${languageCodes ? languageCodes.join(', ') : 'auto-detect'}, ` +\n      `Max alternatives: ${maxAlternatives}, ` +\n      `Secret tag detection: ${enableSecretTagDetection}`\n    );\n    \n    try {\n      // Validate language codes if provided\n      if (languageCodes && languageCodes.length > 0) {\n        this._validateLanguageCodes(languageCodes);\n      }\n\n      // --- First attempt with current token ---\n      try {\n        return await this._performTranscription(audioFilePath, languageCodes, enableSecretTagDetection);\n      } \n      catch (initialError: any) {\n        // Handle 401 with manual refresh and retry\n        if (initialError.response?.status === 401) {\n          logger.info('Got 401, manually refreshing token and retrying...');\n          return await this._retryWithTokenRefresh(audioFilePath, languageCodes, enableSecretTagDetection);\n        }\n        \n        // If not a 401 error, just rethrow the original error\n        throw this._createTranscriptionError(initialError);\n      }\n    } \n    catch (error: any) {\n      // Final error handling for errors outside the 401/retry flow\n      logger.error('Failed to transcribe audio via enhanced backend API', {\n        message: error.message,\n        type: error.type || 'unknown',\n        languageCodes,\n        audioPath: audioFilePath\n      });\n      throw error;\n    }\n  }\n\n  /**\n   * Validate language codes before sending to backend\n   */\n  private _validateLanguageCodes(languageCodes: string[]): void {\n    if (languageCodes.length > 4) {\n      throw this._createTranscriptionError({\n        type: 'validation',\n        message: `Too many language codes. Maximum 4 allowed, got ${languageCodes.length}`\n      });\n    }\n\n    // Use simplified validation from languageConfig\n    const invalidCodes = languageCodes.filter(code => {\n      return code !== 'auto' && !validateLanguageCode(code);\n    });\n\n    if (invalidCodes.length > 0) {\n      throw this._createTranscriptionError({\n        type: 'validation',\n        message: `Invalid language codes: ${invalidCodes.join(', ')}. Please use supported language codes.`\n      });\n    }\n  }\n\n  /**\n   * Perform the actual transcription request\n   */\n  private async _performTranscription(\n    audioFilePath: string, \n    languageCodes?: string[],\n    enableSecretTagDetection: boolean = true\n  ): Promise<TranscriptionResult> {\n    // Create FormData with audio file\n    const formData = await this._createFormData(audioFilePath);\n    \n    // Add language codes if provided\n    if (languageCodes && languageCodes.length > 0) {\n      formData.append('language_codes_json', JSON.stringify(languageCodes));\n      logger.info(`Added language codes to request: ${JSON.stringify(languageCodes)}`);\n    }\n    \n    // Get current token\n    const token = await AsyncStorage.getItem('access_token');\n    if (!token) {\n      throw this._createTranscriptionError({\n        type: 'authentication',\n        message: 'Authentication token not found'\n      });\n    }\n    \n    logger.info('Sending enhanced audio file to backend /api/speech/transcribe...');\n    \n    const response = await axiosInstance.post<any>(\n      '/api/speech/transcribe',\n      formData,\n      {\n        headers: {\n          'Authorization': `Bearer ${token}`,\n        },\n        timeout: 30000, // 30 second timeout for transcription\n      }\n    );\n    \n    logger.info(\n      `Enhanced transcription received successfully. ` +\n      `Transcript length: ${response.data.transcript?.length || 0}`\n    );\n    \n    // Process the response and add secret tag detection\n    const processedResult = await this._processTranscriptionResponse(response.data, enableSecretTagDetection);\n    \n    return processedResult;\n  }\n\n  /**\n   * Create FormData for the transcription request\n   */\n  private async _createFormData(audioFilePath: string): Promise<FormData> {\n    const formData = new FormData();\n    \n    if (Platform.OS === 'web') {\n      logger.info('Web platform detected, fetching blob data...');\n      const response = await fetch(audioFilePath);\n      const blob = await response.blob();\n      const fileName = `recording-${Date.now()}.webm`;\n      const mimeType = 'audio/webm;codecs=opus';\n      \n      formData.append('file', new File([blob], fileName, { \n        type: mimeType\n      }));\n      \n      logger.info(`Appended blob to FormData: ${fileName}, type: ${mimeType}, size: ${blob.size}`);\n    } else {\n      // Native platform handling\n      const fileInfo = await FileSystem.getInfoAsync(audioFilePath);\n      if (!fileInfo.exists) {\n        throw this._createTranscriptionError({\n          type: 'validation',\n          message: `Audio file not found: ${audioFilePath}`\n        });\n      }\n\n      const uri = fileInfo.uri;\n      const fileExtension = uri.split('.').pop()?.toLowerCase();\n      const fileType = this._getAudioMimeType(fileExtension);\n      const fileName = uri.split('/').pop() || `recording-${Date.now()}.${fileExtension}`;\n      \n      // For React Native, we need to use the specific format for file uploads\n      (formData as any).append('file', {\n        uri,\n        name: fileName,\n        type: fileType,\n      });\n      \n      logger.info(`Appended native file to FormData: ${fileName}, type: ${fileType}`);\n    }\n    \n    return formData;\n  }\n\n  /**\n   * Get audio MIME type based on file extension\n   */\n  private _getAudioMimeType(extension?: string): string {\n    const mimeTypes: { [key: string]: string } = {\n      'wav': 'audio/wav',\n      'mp3': 'audio/mpeg',\n      'mp4': 'audio/mp4',\n      'm4a': 'audio/mp4',\n      'aac': 'audio/aac',\n      'ogg': 'audio/ogg',\n      'webm': 'audio/webm',\n      'flac': 'audio/flac'\n    };\n    \n    return mimeTypes[extension || 'wav'] || 'audio/wav';\n  }\n\n  /**\n   * Process and validate transcription response with secret tag detection\n   */\n  private async _processTranscriptionResponse(data: any, enableSecretTagDetection: boolean): Promise<TranscriptionResult> {\n    // Ensure all required fields are present with defaults\n    const processedResult: TranscriptionResult = {\n      transcript: data.transcript || '',\n      detected_language_code: data.detected_language_code || undefined,\n      confidence: typeof data.confidence === 'number' ? data.confidence : 0.8, // Default confidence\n      alternatives: Array.isArray(data.alternatives) ? data.alternatives : [],\n      word_confidence: Array.isArray(data.word_confidence) ? data.word_confidence : [],\n      language_confidence: typeof data.language_confidence === 'number' ? data.language_confidence : 0.8,\n      quality_metrics: {\n        average_confidence: data.quality_metrics?.average_confidence || 0.8,\n        low_confidence_words: data.quality_metrics?.low_confidence_words || 0,\n        total_words: data.quality_metrics?.total_words || 0,\n        ...data.quality_metrics\n      }\n    };\n\n    // Perform OPAQUE-based secret phrase detection only when globally enabled\n    if (areSecretTagsEnabled() && enableSecretTagDetection && processedResult.transcript.trim()) {\n      try {\n        logger.info(`[OPAQUE Voice Detection] Starting detection for transcript: \"${processedResult.transcript}\"`);\n        \n        // Use new OPAQUE-based voice phrase detector\n        const tagDetection = await voicePhraseDetector.checkForSecretPhrase(processedResult.transcript);\n        processedResult.secret_tag_detected = tagDetection;\n        \n        logger.info(`[OPAQUE Voice Detection] Detection result:`, tagDetection);\n        \n        if (tagDetection.found) {\n          logger.info(`OPAQUE secret phrase authenticated: ${tagDetection.tagName} (${tagDetection.action})`);\n          \n          // Handle the detected secret tag action (session management happens in VoicePhraseDetector)\n          await this._handleOpaqueTagDetection(tagDetection);\n        } else {\n          logger.info(`[OPAQUE Voice Detection] No secret phrases authenticated in: \"${processedResult.transcript}\"`);\n        }\n      } catch (error) {\n        logger.error('Error during OPAQUE voice detection:', error);\n        // Don't fail the transcription if secret tag detection fails\n        processedResult.secret_tag_detected = { found: false };\n      }\n    } else {\n      processedResult.secret_tag_detected = { found: false };\n      const reason = !areSecretTagsEnabled()\n        ? 'Disabled by global feature flag'\n        : (processedResult.transcript.trim() ? 'Detection disabled by option' : 'Skipped - empty transcript');\n      logger.info(`[OPAQUE Voice Detection] ${reason}`);\n    }\n\n    // Log quality metrics\n    logger.info(\n      `Transcription quality metrics - ` +\n      `Avg confidence: ${processedResult.quality_metrics.average_confidence.toFixed(2)}, ` +\n      `Low confidence words: ${processedResult.quality_metrics.low_confidence_words}/${processedResult.quality_metrics.total_words}, ` +\n      `Language confidence: ${processedResult.language_confidence.toFixed(2)}, ` +\n      `Secret tag detected: ${processedResult.secret_tag_detected?.found || false}`\n    );\n\n    return processedResult;\n  }\n\n  /**\n   * Handle OPAQUE tag detection results\n   */\n  private async _handleOpaqueTagDetection(detection: any): Promise<void> {\n    try {\n      if (detection.action === 'panic') {\n        // Handle panic mode - OPAQUE client handles memory cleanup\n        logger.warn('Panic mode detected via OPAQUE authentication');\n        // Panic mode cleanup is already handled in VoicePhraseDetector\n        return;\n      }\n\n      if (detection.tagId) {\n        if (detection.action === 'activate') {\n          logger.info(`OPAQUE secret tag session activated: ${detection.tagName}`);\n          // Session management is handled in VoicePhraseDetector\n        } else if (detection.action === 'deactivate') {\n          logger.info(`OPAQUE secret tag session deactivated: ${detection.tagName}`);\n          // Session cleanup is handled in VoicePhraseDetector\n        }\n      }\n    } catch (error) {\n      logger.error('Failed to handle OPAQUE tag detection:', error);\n      // Don't throw - this shouldn't fail the transcription\n    }\n  }\n\n\n\n  /**\n   * Retry transcription with token refresh\n   */\n  private async _retryWithTokenRefresh(\n    audioFilePath: string, \n    languageCodes?: string[],\n    enableSecretTagDetection: boolean = true\n  ): Promise<TranscriptionResult> {\n    try {\n      // Attempt to refresh the token\n      const refreshToken = await AsyncStorage.getItem('refresh_token');\n      if (!refreshToken) {\n        throw this._createTranscriptionError({\n          type: 'authentication',\n          message: 'No refresh token available for retry'\n        });\n      }\n\n      logger.info('Attempting to refresh access token...');\n      \n      // Call refresh endpoint\n      const refreshResponse = await axios.post('/api/v1/auth/refresh', {\n        refresh_token: refreshToken,\n      });\n\n      if (refreshResponse.data.access_token) {\n        // Save new token\n        await AsyncStorage.setItem('access_token', refreshResponse.data.access_token);\n        \n        if (refreshResponse.data.refresh_token) {\n          await AsyncStorage.setItem('refresh_token', refreshResponse.data.refresh_token);\n        }\n\n        logger.info('Token refreshed successfully, retrying transcription...');\n        \n        // Retry the transcription with new token\n        return await this._performTranscription(audioFilePath, languageCodes, enableSecretTagDetection);\n      } else {\n        throw this._createTranscriptionError({\n          type: 'authentication',\n          message: 'Token refresh failed - no access token received'\n        });\n      }\n    } catch (refreshError: any) {\n      logger.error('Token refresh failed:', refreshError);\n      throw this._createTranscriptionError({\n        type: 'authentication',\n        message: 'Authentication failed and token refresh unsuccessful'\n      });\n    }\n  }\n\n  /**\n   * Create standardized transcription error\n   */\n  private _createTranscriptionError(error: any): TranscriptionError {\n    if (error.type && error.message) {\n      return error; // Already a TranscriptionError\n    }\n\n    let errorType: TranscriptionError['type'] = 'unknown';\n    let errorMessage = 'Unknown transcription error';\n\n    if (error.response) {\n      // HTTP error response\n      const status = error.response.status;\n      const detail = error.response.data?.detail || error.response.statusText;\n      \n      if (status === 401) {\n        errorType = 'authentication';\n        errorMessage = 'Authentication failed';\n      } else if (status === 422) {\n        errorType = 'validation';\n        errorMessage = detail || 'Validation error';\n      } else if (status >= 500) {\n        errorType = 'server';\n        errorMessage = detail || 'Server error';\n      } else {\n        errorType = 'network';\n        errorMessage = detail || `HTTP ${status} error`;\n      }\n    } else if (error.request) {\n      // Network error\n      errorType = 'network';\n      errorMessage = 'Network error - unable to reach server';\n    } else {\n      // Other error\n      errorMessage = error.message || 'Unknown error occurred';\n    }\n\n    return {\n      type: errorType,\n      message: errorMessage,\n      details: error.response?.data || error\n    };\n  }\n\n  /**\n   * Get transcription quality assessment\n   */\n  public getQualityAssessment(result: TranscriptionResult): {\n    overall: 'excellent' | 'good' | 'fair' | 'poor';\n    confidence: number;\n    recommendations: string[];\n  } {\n    const confidence = result.confidence;\n    const lowConfidenceRatio = result.quality_metrics.total_words > 0 \n      ? result.quality_metrics.low_confidence_words / result.quality_metrics.total_words \n      : 0;\n\n    let overall: 'excellent' | 'good' | 'fair' | 'poor';\n    const recommendations: string[] = [];\n\n    if (confidence >= 0.9 && lowConfidenceRatio < 0.1) {\n      overall = 'excellent';\n    } else if (confidence >= 0.8 && lowConfidenceRatio < 0.2) {\n      overall = 'good';\n    } else if (confidence >= 0.7 && lowConfidenceRatio < 0.3) {\n      overall = 'fair';\n      recommendations.push('Consider speaking more clearly for better accuracy');\n    } else {\n      overall = 'poor';\n      recommendations.push('Try speaking more slowly and clearly');\n      recommendations.push('Ensure you are in a quiet environment');\n      if (result.alternatives.length > 0) {\n        recommendations.push('Check alternative transcriptions below');\n      }\n    }\n\n    if (lowConfidenceRatio > 0.2) {\n      recommendations.push('Some words had low confidence - review the transcript carefully');\n    }\n\n    if (!result.detected_language_code) {\n      recommendations.push('Language detection failed - try selecting specific languages');\n    }\n\n    if (result.secret_tag_detected?.found) {\n      recommendations.push(`Secret tag detected: ${result.secret_tag_detected.tagName || 'Unknown'}`);\n    }\n\n    return {\n      overall,\n      confidence,\n      recommendations\n    };\n  }\n}\n\n// Export singleton instance\nconst speechToTextService = SpeechToTextService.getInstance();\nexport default speechToTextService; ","import { useState, useEffect, useRef, useCallback } from 'react';\nimport { Alert, Platform } from 'react-native';\nimport { Audio } from 'expo-av';\nimport * as FileSystem from 'expo-file-system';\nimport logger from '../utils/logger';\n\nexport interface AudioRecordingOptions {\n  quality?: keyof typeof Audio.RecordingOptionsPresets;\n  autoStart?: boolean;\n  filePrefix?: string;\n  requestPermissionOnMount?: boolean;\n  maxDuration?: number; // in seconds, 0 means unlimited\n}\n\nconst DEFAULT_OPTIONS: AudioRecordingOptions = {\n  quality: 'HIGH_QUALITY',\n  autoStart: false,\n  filePrefix: 'recording_',\n  requestPermissionOnMount: true,\n  maxDuration: 0,\n};\n\nexport interface AudioRecordingHook {\n  isRecording: boolean;\n  recordingDuration: number;\n  audioUri: string | null;\n  startRecording: () => Promise<void>;\n  stopRecording: () => Promise<void>;\n  cleanupRecordingFile: (uri: string | null) => Promise<void>;\n  permissionGranted: boolean;\n  error: Error | null;\n}\n\nconst useAudioRecording = (options?: AudioRecordingOptions): AudioRecordingHook => {\n  const RECORDING_DIR = FileSystem.documentDirectory + 'recordings/';\n  const mergedOptions = { ...DEFAULT_OPTIONS, ...options };\n  const [recording, setRecording] = useState<Audio.Recording | null>(null);\n  const [isRecording, setIsRecording] = useState(false);\n  const [recordingDuration, setRecordingDuration] = useState(0);\n  const [audioUri, setAudioUri] = useState<string | null>(null);\n  const [permissionGranted, setPermissionGranted] = useState(false);\n  const [error, setError] = useState<Error | null>(null);\n  const timerRef = useRef<NodeJS.Timeout | null>(null);\n  const startTimeRef = useRef<number>(0);\n  const recordingInstanceRef = useRef<Audio.Recording | null>(null);\n  const isRequestingPermissionRef = useRef(false);\n  const autoStartAttemptedRef = useRef(false); // Track if auto-start has been attempted\n  \n  // Effect to keep recordingInstanceRef updated with the latest recording object\n  useEffect(() => {\n    recordingInstanceRef.current = recording;\n  }, [recording]);\n  \n  // Debug effect for recordingDuration changes\n  useEffect(() => {\n    logger.debug(`[useAudioRecording] recordingDuration updated: ${recordingDuration}s`);\n  }, [recordingDuration]);\n  \n  // Robust unmount cleanup effect\n  useEffect(() => {\n    return () => {\n      logger.info('[useAudioRecording] Component unmounting. Performing final cleanup.');\n      if (timerRef.current) {\n        logger.info('[useAudioRecording] Unmount: Clearing timer interval.');\n        clearInterval(timerRef.current);\n        timerRef.current = null;\n      }\n      // Also ensure the Audio.Recording object is stopped and unloaded.\n      if (recordingInstanceRef.current) {\n        logger.warn('[useAudioRecording] Unmount: Stopping and unloading active Audio.Recording object.');\n        recordingInstanceRef.current.stopAndUnloadAsync()\n          .catch(e => logger.error('Error stopping/unloading recording on unmount', e));\n        recordingInstanceRef.current = null; // Clear the ref\n      }\n    };\n  }, []); // Empty dependency array ensures this runs only on unmount\n  \n  const requestPermissionsAndSetupAudioMode = useCallback(async () => {\n    if (isRequestingPermissionRef.current) {\n      logger.debug(\"[useAudioRecording] Permission request already in progress.\");\n      return; // Exit if a request is already happening\n    }\n    isRequestingPermissionRef.current = true;\n    setError(null); // Clear previous errors before a new attempt\n\n    try {\n      logger.info(\"[useAudioRecording] Requesting audio permissions via Expo AV.\");\n      const { granted, status } = await Audio.requestPermissionsAsync();\n      logger.info(`[useAudioRecording] Expo AV permission request result: granted=${granted}, status=${status}.`);\n      \n      if (granted) {\n        await Audio.setAudioModeAsync({\n          allowsRecordingIOS: true,\n          playsInSilentModeIOS: true,\n          staysActiveInBackground: false,\n          shouldDuckAndroid: true,\n          playThroughEarpieceAndroid: false,\n        });\n        logger.info('[useAudioRecording] Audio mode set successfully after permission grant.');\n        setPermissionGranted(true); // Set state to true\n      } else {\n        const permissionError = new Error('Audio recording permission is needed to record audio.');\n        logger.warn('[useAudioRecording] Audio recording permission not granted by user.');\n        setError(permissionError);\n        setPermissionGranted(false); // Ensure state is false\n      }\n    } catch (error) {\n      const err = error instanceof Error ? error : new Error('Failed to request permissions or set audio mode');\n      logger.error('[useAudioRecording] Catch block: Audio permission/setup error:', err);\n      setError(err);\n      setPermissionGranted(false); // Ensure state is false on error\n    } finally {\n      isRequestingPermissionRef.current = false; // Reset the flag\n    }\n  }, []); // Empty dependency array: this callback is stable and manages state internally.\n  \n  const ensureRecordingDirExists = async () => {\n    if (Platform.OS !== 'web') {\n      const dirInfo = await FileSystem.getInfoAsync(RECORDING_DIR);\n      if (!dirInfo.exists) {\n        logger.info(`Creating directory for recordings: ${RECORDING_DIR}`);\n        await FileSystem.makeDirectoryAsync(RECORDING_DIR, { intermediates: true });\n      }\n    }\n  };\n\n  // Function to stop recording - defined early so it can be referenced in updateTimer\n  const stopRecording = useCallback(async () => {\n    if (!recording) {\n      logger.warn('stopRecording called when no recording is active.');\n      return;\n    }\n\n    logger.info('Stopping audio recording...');\n    setIsRecording(false);\n    \n    // Calculate final duration before clearing timer and resetting refs\n    const finalDuration = startTimeRef.current ? Math.floor((Date.now() - startTimeRef.current) / 1000) : 0;\n    logger.info(`[useAudioRecording] Final duration: ${finalDuration}s`);\n    \n    // IMPORTANT: Clear timer interval BEFORE resetting startTimeRef to avoid timer ticks with startTimeRef=0\n    if (timerRef.current) {\n      clearInterval(timerRef.current);\n      timerRef.current = null;\n    }\n    \n    // Set the final duration and then reset startTimeRef (order matters)\n    setRecordingDuration(finalDuration);\n    startTimeRef.current = 0;\n\n    try {\n      await recording.stopAndUnloadAsync();\n      const uri = recording.getURI();\n      logger.info(`Recording stopped. URI: ${uri}, duration: ${finalDuration}s`);\n      setAudioUri(uri);\n      setRecording(null);\n    } catch (err) {\n      const error = err instanceof Error ? err : new Error('Failed to stop recording');\n      logger.error('Failed to stop and unload recording', error);\n      setError(error);\n      setAudioUri(null); // Ensure URI is null on error\n    }\n  }, [recording]); // Only depend on recording\n\n  // Start recording implementation\n  const startRecording = useCallback(async () => {\n    setError(null);\n    logger.info('[useAudioRecording] Attempting to start recording...');\n\n    // Critical check: Rely on the permissionGranted state.\n    if (!permissionGranted) {\n        logger.error('[useAudioRecording] startRecording: Permissions are NOT granted. Aborting recording attempt.');\n        setError(new Error('Audio recording permission has not been granted. Please grant permission first.'));\n        return; // Do not proceed if permissions are not already granted\n    }\n\n    if (isRecording) {\n        logger.warn('[useAudioRecording] startRecording called while already recording. Ignoring call.');\n        return;\n    }\n\n    try {\n      // First clear any existing timer\n      if (timerRef.current) {\n        clearInterval(timerRef.current);\n        timerRef.current = null;\n      }\n      \n      logger.info('[useAudioRecording] Ensuring recording directory exists...');\n      await ensureRecordingDirExists();\n      logger.info('[useAudioRecording] Setting audio mode for recording...');\n      await Audio.setAudioModeAsync({\n        allowsRecordingIOS: true,\n        playsInSilentModeIOS: true,\n        shouldDuckAndroid: true,\n        playThroughEarpieceAndroid: false,\n        staysActiveInBackground: false,\n      });\n\n      // Set recording options based on quality preference\n      const qualityPreset = mergedOptions.quality || 'HIGH_QUALITY';\n      const options: Audio.RecordingOptions = {\n        ...Audio.RecordingOptionsPresets[qualityPreset],\n      };\n      \n      if (Platform.OS === 'web') {\n        // Use WebM with Opus codec for better Google Speech-to-Text compatibility\n        options.web = { mimeType: 'audio/webm;codecs=opus' };\n      }\n      \n      logger.info('[useAudioRecording] Creating recording instance...');\n      const { recording: newRecording } = await Audio.Recording.createAsync(options);\n      setRecording(newRecording);\n      \n      // Reset duration and set start time BEFORE setting isRecording\n      setRecordingDuration(0);\n      const now = Date.now();\n      startTimeRef.current = now;\n      logger.info(`[useAudioRecording] Setting start time to ${now}`);\n      \n      setIsRecording(true);\n      setAudioUri(null); // Reset previous URI\n\n      logger.info('[useAudioRecording] Starting timer interval...');\n      // Use a direct function instead of updateTimer to ensure closure has latest startTimeRef\n      timerRef.current = setInterval(() => {\n        const currentTime = Date.now();\n        \n        // Safety check: If startTimeRef is 0 or otherwise invalid, stop the timer\n        if (!startTimeRef.current) {\n          logger.warn('[useAudioRecording] Timer tick with invalid startTimeRef (0). Clearing interval.');\n          if (timerRef.current) {\n            clearInterval(timerRef.current);\n            timerRef.current = null;\n          }\n          return;\n        }\n        \n        const elapsed = Math.floor((currentTime - startTimeRef.current) / 1000);\n        logger.info(`Timer tick: current=${currentTime}, start=${startTimeRef.current}, elapsed=${elapsed}s`);\n        \n        // Only update the duration if we have a valid elapsed time (prevents displaying astronomical values)\n        if (elapsed >= 0 && elapsed < 86400) { // Sanity check: < 24 hours\n          setRecordingDuration(elapsed);\n        } else {\n          logger.warn(`[useAudioRecording] Invalid elapsed time calculated: ${elapsed}s. Ignoring this tick.`);\n        }\n        \n        // Check max duration\n        if (mergedOptions.maxDuration && \n            mergedOptions.maxDuration > 0 && \n            elapsed >= mergedOptions.maxDuration) {\n          logger.info(`Max duration reached: ${elapsed}s, stopping`);\n          if (timerRef.current) {\n            clearInterval(timerRef.current);\n            timerRef.current = null;\n          }\n          stopRecording();\n        }\n      }, 1000);\n      \n      logger.info('[useAudioRecording] Started audio recording successfully');\n    } catch (err) {\n      const error = err instanceof Error ? err : new Error('Failed to start recording');\n      logger.error('[useAudioRecording] Failed to start recording', error);\n      setError(error);\n      setIsRecording(false);\n      startTimeRef.current = 0;\n      if (timerRef.current) {\n        clearInterval(timerRef.current);\n        timerRef.current = null;\n      }\n    }\n  }, [isRecording, mergedOptions.quality, mergedOptions.maxDuration, stopRecording, ensureRecordingDirExists]);\n\n  // Function to update timer based on elapsed time\n  const updateTimer = useCallback(() => {\n    if (!startTimeRef.current) {\n      logger.warn('[useAudioRecording] updateTimer called but startTimeRef is not set');\n      return;\n    }\n    \n    const now = Date.now();\n    const elapsed = Math.floor((now - startTimeRef.current) / 1000);\n    logger.info(`[useAudioRecording] Timer tick, now: ${now}, start: ${startTimeRef.current}, elapsed: ${elapsed}s`);\n    \n    // Update recordingDuration state with actual elapsed time\n    setRecordingDuration(elapsed);\n    \n    // Check for max duration\n    if (mergedOptions.maxDuration && \n        mergedOptions.maxDuration > 0 && \n        elapsed >= mergedOptions.maxDuration) {\n      logger.info(`[useAudioRecording] Max duration of ${mergedOptions.maxDuration}s reached, stopping recording`);\n      stopRecording();\n    }\n  }, [mergedOptions.maxDuration, stopRecording]);\n\n  // This useEffect handles permission requests on mount and auto-start logic.\n  // It relies on permissionGranted state being updated by requestPermissionsAndSetupAudioMode.\n  useEffect(() => {\n    let didCancel = false; // To prevent state updates on unmounted component\n\n    const managePermissionsAndAutoStart = async () => {\n      if (mergedOptions.requestPermissionOnMount && !permissionGranted) {\n        // Only call if no request is currently in progress\n        if (!isRequestingPermissionRef.current) {\n          logger.info(\"[useAudioRecording] Mount/PermissionEffect: Permissions not granted and no request in progress. Initiating request.\");\n          // requestPermissionsAndSetupAudioMode is async but we don't need to await it here\n          // as its purpose is to update state, which will cause this effect to re-run.\n          requestPermissionsAndSetupAudioMode();\n        } else {\n          logger.debug(\"[useAudioRecording] Mount/PermissionEffect: Permission request already in progress. Waiting for completion.\");\n        }\n        // Important: Return early. Let the re-run of this effect (due to permissionGranted state change) handle auto-start.\n        return;\n      }\n\n      // This part of the logic runs if: \n      // 1. Permissions were already granted on mount.\n      // 2. Permissions became granted after a request, and the effect re-ran.\n      if (permissionGranted && mergedOptions.autoStart && !isRecording && !autoStartAttemptedRef.current) {\n        if (!didCancel) { // Check if component is still mounted\n          logger.info('[useAudioRecording] Mount/PermissionEffect: Permissions granted. Auto-start conditions met. Calling startRecording.');\n          autoStartAttemptedRef.current = true; // Mark that we've attempted auto-start\n          startRecording(); // Not awaiting, it's a fire-and-forget from this effect's perspective\n        }\n      } else if (permissionGranted && mergedOptions.autoStart && isRecording) {\n        logger.debug('[useAudioRecording] Mount/PermissionEffect: Permissions granted and auto-start enabled, but already recording.');\n      } else if (permissionGranted && !mergedOptions.autoStart) {\n        logger.debug('[useAudioRecording] Mount/PermissionEffect: Permissions granted, but auto-start is not enabled.');\n      } else if (permissionGranted && mergedOptions.autoStart && autoStartAttemptedRef.current) {\n        logger.debug('[useAudioRecording] Mount/PermissionEffect: Auto-start already attempted, skipping to prevent infinite loop.');\n      }\n    };\n\n    managePermissionsAndAutoStart();\n\n    return () => {\n      didCancel = true; // Cleanup function to set didCancel on unmount\n    };\n  }, [\n    mergedOptions.requestPermissionOnMount,\n    mergedOptions.autoStart,\n    permissionGranted, // Key dependency: effect re-runs when this changes\n    isRecording,\n    requestPermissionsAndSetupAudioMode, // Stable callback\n    startRecording // Callback, its stability depends on its own deps\n  ]);\n\n  const cleanupRecordingFile = useCallback(async (uri: string | null) => {\n    if (uri && Platform.OS !== 'web') {\n        try {\n            const fileInfo = await FileSystem.getInfoAsync(uri);\n            if (fileInfo.exists) {\n                logger.info(`Cleaning up temporary recording file: ${uri}`);\n                await FileSystem.deleteAsync(uri);\n            }\n        } catch (err) {\n            logger.error(`Failed to delete recording file ${uri}`, err);\n        }\n    }\n  }, []);\n\n  return {\n    isRecording,\n    recordingDuration,\n    audioUri,\n    startRecording,\n    stopRecording,\n    cleanupRecordingFile,\n    permissionGranted,\n    error,\n  };\n};\n\nexport default useAudioRecording; ","import { useState, useEffect, useRef, useCallback } from 'react';\nimport { Alert } from 'react-native';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport Constants from 'expo-constants';\nimport logger from '../utils/logger';\nimport { AppState } from 'react-native';\nimport { TranscriptionSegment } from '../types';\nimport { getWebSocketUrl } from '../services/api';\n\nexport type WebSocketStatus = 'disconnected' | 'connecting' | 'connected' | 'error';\n\ninterface WebSocketTranscriptionHookProps {\n  onOpen?: () => void;\n  onClose?: (event: { code: number; reason: string }) => void;\n  onMessage?: (data: any) => void; // For raw messages if needed\n  onInterimTranscript?: (text: string) => void;\n  onFinalTranscript?: (text: string, detectedLanguage?: string) => void;\n  onTranscriptionError?: (errorMessage: string) => void;\n  onStatusUpdate?: (statusMessage: string) => void; // For general status messages from WS\n}\n\nexport interface WebSocketTranscriptionHook {\n  wsStatus: WebSocketStatus;\n  connect: () => Promise<void>;\n  disconnect: () => void;\n  sendMessage: (message: string | object) => boolean; // Returns true if message was sent\n  // sendAudioChunk: (chunk: Blob | ArrayBuffer) => boolean; // Future: for live streaming\n}\n\nconst useWebSocketTranscription = ({\n  onOpen,\n  onClose,\n  onMessage,\n  onInterimTranscript,\n  onFinalTranscript,\n  onTranscriptionError,\n  onStatusUpdate,\n}: WebSocketTranscriptionHookProps): WebSocketTranscriptionHook => {\n  const ws = useRef<WebSocket | null>(null);\n  const [wsStatus, setWsStatus] = useState<WebSocketStatus>('disconnected');\n  const [authToken, setAuthToken] = useState<string | null>(null);\n\n  useEffect(() => {\n    // Fetch token on mount, but don't auto-connect\n    AsyncStorage.getItem('access_token').then(token => {\n      if (token) {\n        setAuthToken(token);\n      } else {\n        logger.warn('WebSocket: Auth token not found on initial load.');\n      }\n    });\n\n    // Cleanup WebSocket on unmount\n    return () => {\n      if (ws.current) {\n        logger.info('useWebSocketTranscription unmounting, closing WebSocket.');\n        ws.current.onclose = null; // Avoid triggering onClose callback during forced close\n        ws.current.onerror = null;\n        ws.current.onmessage = null;\n        ws.current.onopen = null;\n        ws.current.close();\n        ws.current = null;\n      }\n    };\n  }, []);\n\n  const connect = useCallback(async () => {\n    if (ws.current && ws.current.readyState === WebSocket.OPEN) {\n      logger.info('WebSocket already connected.');\n      setWsStatus('connected'); // Ensure status is correct\n      onOpen?.();\n      return;\n    }\n\n    if (wsStatus === 'connecting') {\n      logger.info('WebSocket connection attempt already in progress.');\n      return;\n    }\n\n    let token = authToken;\n    if (!token) {\n      logger.info('WebSocket: Auth token not in state, re-fetching...');\n      token = await AsyncStorage.getItem('access_token');\n    }\n\n    if (!token) {\n      logger.error('WebSocket: Cannot connect. No auth token found (key: access_token).');\n      setWsStatus('error');\n      onTranscriptionError?.('Authentication Error: Missing token.');\n      Alert.alert('Authentication Error', 'Could not connect to transcription service. Please log in again.');\n      return;\n    }\n    setAuthToken(token); // Store it if re-fetched\n\n    setWsStatus('connecting');\n    logger.info('Attempting WebSocket connection...');\n\n    const socketUrl = getWebSocketUrl();\n    logger.info(`Connecting to WebSocket at ${socketUrl}`);\n\n    try {\n      const socket = new WebSocket(`${socketUrl}/api/v1/transcribe`);\n      ws.current = socket;\n\n      socket.onopen = () => {\n        logger.info('WebSocket Connected!');\n        setWsStatus('connected');\n        // Send authentication token\n        socket.send(JSON.stringify({ type: 'auth', token }));\n        onOpen?.();\n      };\n\n      socket.onmessage = (event) => {\n        try {\n          const message = JSON.parse(event.data as string);\n          logger.debug('WebSocket message received:', message);\n          onMessage?.(message); // Generic message handler\n\n          if (message.type === 'interim_transcript') {\n            onInterimTranscript?.(message.text);\n          } else if (message.type === 'final_transcript') {\n            onFinalTranscript?.(message.text, message.language_code); // Assuming language_code might be present\n          } else if (message.type === 'error') {\n            logger.error('WebSocket server error:', message.message);\n            onTranscriptionError?.(message.message);\n             // setWsStatus('error'); // Let onClose handle status for critical errors, or decide specific logic\n          } else if (message.type === 'status') {\n            logger.info('WebSocket status update:', message.message);\n            onStatusUpdate?.(message.message);\n          } else if (message.type === 'language_detected'){\n            logger.info('Language detected by server:', message.code);\n            // Potentially call a specific handler if needed, or use onStatusUpdate\n          }\n\n        } catch (e) {\n          logger.error('Failed to parse WebSocket message:', e);\n          onTranscriptionError?.('Received malformed message from server.');\n        }\n      };\n\n      socket.onerror = (errorEvent) => {\n        // The error object in onerror is often not very detailed directly.\n        // True error details might be in the reason for onclose.\n        logger.error('WebSocket Error Event:', errorEvent);\n        setWsStatus('error');\n        onTranscriptionError?.('WebSocket connection error. Please try again.');\n        // Don't Alert here, let the component decide based on onTranscriptionError\n      };\n\n      socket.onclose = (event) => {\n        logger.info('WebSocket Closed:', { code: event.code, reason: event.reason });\n        ws.current = null; // Clear the ref\n        // Only set to disconnected if not already in error state from onerror\n        if (wsStatus !== 'error') {\n             setWsStatus('disconnected');\n        }\n        onClose?.({ code: event.code, reason: event.reason });\n        // Alert.alert('Connection Closed', `Transcription service disconnected: ${event.reason || event.code}`);\n      };\n    } catch (e) {\n        logger.error('Failed to create WebSocket object or initial connection error:', e);\n        setWsStatus('error');\n        onTranscriptionError?.('Could not establish connection to transcription service.');\n        ws.current = null;\n    }\n  }, [authToken, wsStatus, onOpen, onClose, onMessage, onInterimTranscript, onFinalTranscript, onTranscriptionError, onStatusUpdate]);\n\n  const disconnect = useCallback(() => {\n    if (ws.current) {\n      logger.info('Manually disconnecting WebSocket...');\n      ws.current.close(); // Simplest call, 0 arguments\n      // onclose handler will set ws.current to null and update status\n    }\n  }, []);\n\n  const sendMessage = useCallback((message: string | object): boolean => {\n    if (ws.current && ws.current.readyState === WebSocket.OPEN) {\n      try {\n        const payload = typeof message === 'string' ? message : JSON.stringify(message);\n        ws.current.send(payload);\n        logger.debug('WebSocket message sent:', payload);\n        return true;\n      } catch (error) {\n        logger.error('Failed to send WebSocket message:', error);\n        onTranscriptionError?.('Failed to send message to server.');\n        return false;\n      }\n    } else {\n      logger.warn('Cannot send WebSocket message: Connection not open.');\n      // onTranscriptionError?.('Cannot send message: Connection not open.'); // Could be too noisy\n      return false;\n    }\n  }, [onTranscriptionError]);\n\n  return {\n    wsStatus,\n    connect,\n    disconnect,\n    sendMessage,\n  };\n};\n\nexport default useWebSocketTranscription; ","import { useState, useEffect, useCallback, useRef } from 'react';\nimport { Alert, Animated, Platform } from 'react-native';\nimport { Audio } from 'expo-av';\nimport speechToTextService from '../services/speechToText';\nimport logger from '../utils/logger';\nimport hapticService from '../services/hapticService';\n\n// Import hooks\nimport useAudioRecording from './useAudioRecording';\nimport useWebSocketTranscription, { WebSocketStatus } from './useWebSocketTranscription';\nimport { useSettings } from '../contexts/SettingsContext';\n\n// Import simplified config\nimport { \n  getDefaultLanguageCode, \n  validateLanguageCode\n} from '../config/languageConfig';\n\n// Enhanced transcription result interface\nexport interface TranscriptionResult {\n  transcript: string;\n  detected_language_code?: string;\n  confidence: number;\n  alternatives: Array<{\n    transcript: string;\n    confidence: number;\n  }>;\n  word_confidence: Array<{\n    word: string;\n    confidence: number;\n    start_time: number;\n    end_time: number;\n  }>;\n  language_confidence: number;\n  quality_metrics: {\n    average_confidence: number;\n    low_confidence_words: number;\n    total_words: number;\n  };\n  secret_tag_detected?: {\n    found: boolean;\n    tagId?: string;\n    tagName?: string;\n    action?: 'activate' | 'deactivate' | 'panic';\n  };\n}\n\ninterface UseAudioRecorderLogicProps {\n  onTranscriptionComplete: (text: string, audioUri?: string, detectedLanguage?: string | null, confidence?: number) => void;\n  onCancel: () => void;\n  autoStart?: boolean;\n  onAutoSave: (currentTranscript: string) => void;\n}\n\nexport const useAudioRecorderLogic = ({ \n  onTranscriptionComplete, \n  onCancel,\n  autoStart = false,\n  onAutoSave,\n}: UseAudioRecorderLogicProps) => {\n  // Get user settings for default language\n  const { settings } = useSettings();\n  \n  // Enhanced states for transcription\n  const [transcriptSegments, setTranscriptSegments] = useState<string[]>([]);\n  const [currentSegmentTranscript, setCurrentSegmentTranscript] = useState('');\n  const [isTranscribingSegment, setIsTranscribingSegment] = useState(false);\n  const [lastTranscriptionResult, setLastTranscriptionResult] = useState<TranscriptionResult | null>(null);\n  const [showAlternatives, setShowAlternatives] = useState(false);\n\n\n  // Use user's default language setting\n  const [selectedLanguage, setSelectedLanguage] = useState<string>(settings.defaultLanguage);\n\n  // Update selected language when user changes default language setting\n  useEffect(() => {\n    setSelectedLanguage(settings.defaultLanguage);\n    logger.info(`[AudioRecorderLogic] Default language updated to: ${settings.defaultLanguage}`);\n  }, [settings.defaultLanguage]);\n\n  // Animation refs\n  const pulseAnim = useRef(new Animated.Value(1)).current;\n  const waveAnim1 = useRef(new Animated.Value(0)).current;\n  const waveAnim2 = useRef(new Animated.Value(0)).current;\n\n  // Audio recording hook\n  const {\n    isRecording,\n    recordingDuration,\n    audioUri,\n    startRecording,\n    stopRecording,\n    cleanupRecordingFile,\n    permissionGranted,\n    error: recordingError\n  } = useAudioRecording({\n    requestPermissionOnMount: true,\n    autoStart: autoStart\n  });\n\n  // Enhanced state management\n  const [isProcessing, setIsProcessing] = useState(false);\n  const [processedUris, setProcessedUris] = useState<Set<string>>(new Set());\n  const [hasTranscribedAudio, setHasTranscribedAudio] = useState(false);\n  \n  // Refs to track component state\n  const isMountedRef = useRef(true);\n  const callbackCalledRef = useRef(false);\n\n  // Animation effects\n  useEffect(() => {\n    if (isRecording) {\n      Animated.loop(\n        Animated.sequence([\n          Animated.timing(pulseAnim, { toValue: 1.1, duration: 700, useNativeDriver: Platform.OS !== 'web' }),\n          Animated.timing(pulseAnim, { toValue: 1, duration: 700, useNativeDriver: Platform.OS !== 'web' }),\n        ])\n      ).start();\n      Animated.loop(\n        Animated.stagger(300, [\n          Animated.sequence([\n            Animated.timing(waveAnim1, { toValue: 1, duration: 800, useNativeDriver: Platform.OS !== 'web' }),\n            Animated.timing(waveAnim1, { toValue: 0, duration: 800, useNativeDriver: Platform.OS !== 'web' }),\n          ]),\n          Animated.sequence([\n            Animated.timing(waveAnim2, { toValue: 1, duration: 800, useNativeDriver: Platform.OS !== 'web' }),\n            Animated.timing(waveAnim2, { toValue: 0, duration: 800, useNativeDriver: Platform.OS !== 'web' }),\n          ])\n        ])\n      ).start();\n    } else {\n      pulseAnim.stopAnimation();\n      pulseAnim.setValue(1);\n      waveAnim1.stopAnimation();\n      waveAnim1.setValue(0);\n      waveAnim2.stopAnimation();\n      waveAnim2.setValue(0);\n    }\n  }, [isRecording, pulseAnim, waveAnim1, waveAnim2]);\n\n  // WebSocket handlers\n  const handleWebSocketError = useCallback((errorMessage: string) => {\n    logger.error('WebSocket Transcription Error:', errorMessage);\n    if (isMountedRef.current) {\n      setIsProcessing(false);\n      setCurrentSegmentTranscript(\"Error with live transcription.\");\n    }\n  }, []);\n\n  const handleInterimTranscript = useCallback((text: string) => {\n    logger.debug('Interim transcript received (WS):', text);\n    if (isMountedRef.current) {\n      setCurrentSegmentTranscript(prev => prev + text);\n    }\n  }, []);\n\n  const handleFinalTranscript = useCallback((text: string, detectedLanguage?: string) => {\n    logger.info(`Final transcript (WS): ${text}, lang: ${detectedLanguage}`);\n    if (isMountedRef.current) {\n      setCurrentSegmentTranscript(text + ' '); \n    }\n  }, []);\n\n  // WebSocket hook\n  const {\n    wsStatus,\n    connect: connectWebSocket,\n    disconnect: disconnectWebSocket,\n    sendMessage: sendWsMessage,\n  } = useWebSocketTranscription({\n    onInterimTranscript: handleInterimTranscript,\n    onFinalTranscript: handleFinalTranscript,\n    onTranscriptionError: handleWebSocketError,\n    onOpen: () => logger.info('AudioRecorder: WebSocket connection opened.'),\n    onClose: (event) => logger.info('AudioRecorder: WebSocket connection closed.', event),\n  });\n\n  // Effect 1: Mount/Unmount setup - should only run once\n  useEffect(() => {\n    isMountedRef.current = true;\n    logger.info('AudioRecorder: Component did mount.');\n\n    // Reset states for enhanced recording when component mounts\n    setTranscriptSegments([]);\n    setCurrentSegmentTranscript('');\n    setIsTranscribingSegment(false);\n    setLastTranscriptionResult(null);\n    setShowAlternatives(false);\n\n    callbackCalledRef.current = false;\n    setHasTranscribedAudio(false);\n\n    return () => {\n      logger.info('AudioRecorder: Component will unmount. Performing final cleanup.');\n      isMountedRef.current = false;\n      disconnectWebSocket();\n    };\n  }, []); // Empty dependency array - runs only on mount/unmount\n\n  // Effect to set audio mode *after* permission is granted via the hook's request\n  useEffect(() => {\n    if (permissionGranted) {\n      const setMode = async () => {\n        logger.info('[AudioRecorder] Permission is granted, ensuring audio mode is set.');\n        try {\n          await Audio.setAudioModeAsync({\n            allowsRecordingIOS: true,\n            playsInSilentModeIOS: true,\n            shouldDuckAndroid: true,\n            playThroughEarpieceAndroid: false,\n          });\n          logger.info('[AudioRecorder] Audio mode set successfully (on permissionGranted change).');\n        } catch (err) {\n          logger.error('[AudioRecorder] Failed to set audio mode (on permissionGranted change):', err);\n        }\n      };\n      setMode();\n    }\n  }, [permissionGranted]);\n\n  // Simplified function to safely handle the done/cancel action (X button)\n  const handleDone = useCallback(() => {\n    logger.info('AudioRecorder: handleDone (X button) called, closing recorder and discarding changes.');\n    if (isMountedRef.current) {\n      if (isRecording) { // If recording, stop it first\n        stopRecording().catch(err => \n          logger.error('Error stopping recording during handleDone:', err)\n        );\n      }\n      onCancel();\n    }\n  }, [isRecording, stopRecording, onCancel]);\n\n  // Enhanced function to accept transcript with quality metrics\n  const handleAcceptTranscript = useCallback(() => {\n    if (!isMountedRef.current || callbackCalledRef.current) return;\n\n    const fullTranscript = transcriptSegments.join('\\n').trim();\n    if (!fullTranscript) {\n      logger.warn('No transcript to accept.');\n      return;\n    }\n\n    callbackCalledRef.current = true;\n    setHasTranscribedAudio(true);\n\n    const confidence = lastTranscriptionResult?.confidence || 0;\n    const detectedLanguage = lastTranscriptionResult?.detected_language_code as string | undefined;\n\n    logger.info(\n      `Accepting enhanced transcript: \"${fullTranscript.substring(0, 50)}...\", ` +\n      `confidence: ${confidence.toFixed(2)}, language: ${detectedLanguage || 'unknown'}`\n    );\n\n    hapticService.success(); // Success haptic feedback for accepting transcript\n    onTranscriptionComplete(fullTranscript, audioUri || undefined, detectedLanguage, confidence);\n  }, [transcriptSegments, lastTranscriptionResult, audioUri, onTranscriptionComplete]);\n\n  // Function to determine if secret tag detection should be treated as a command or normal content\n  const shouldTreatAsSecretTagCommand = (transcript: string, secretTagDetected: any): boolean => {\n    if (!secretTagDetected?.tagName) return false;\n    \n    // Normalize function: lowercase, remove punctuation and spaces, keep only letters and numbers\n    const normalize = (text: string): string => {\n      return text.toLowerCase().replace(/[^a-z0-9]/g, '');\n    };\n    \n    const normalizedTranscript = normalize(transcript);\n    const normalizedPhrase = normalize(secretTagDetected.tagName);\n    \n    // Secret tag activation requires exact match after normalization\n    const isExactMatch = normalizedTranscript === normalizedPhrase;\n    \n    if (isExactMatch) {\n      logger.info(`[shouldTreatAsSecretTagCommand] Exact match found - transcript: \"${normalizedTranscript}\" matches phrase: \"${normalizedPhrase}\"`);\n    } else {\n      logger.info(`[shouldTreatAsSecretTagCommand] No exact match - transcript: \"${normalizedTranscript}\" vs phrase: \"${normalizedPhrase}\"`);\n    }\n    \n    return isExactMatch;\n  };\n\n  // Simplified segment processing with single language support\n  const processSegment = async (uri: string, languageCode: string) => {\n    if (!isMountedRef.current || processedUris.has(uri)) {\n      logger.info(`[processSegment] Skipping ${uri} - component unmounted or already processed.`);\n      return;\n    }\n\n    setProcessedUris(prev => new Set(prev).add(uri));\n    setIsTranscribingSegment(true);\n    setCurrentSegmentTranscript('Processing...');\n\n    try {\n      logger.info(`[processSegment] Starting transcription for ${uri} with language: ${languageCode}`);\n      \n      // Use speech service with single language code (or auto-detect) and secret tag detection\n      const languageCodes = languageCode === 'auto' ? undefined : [languageCode];\n      const result = await speechToTextService.transcribeAudio(uri, {\n        languageCodes,\n        maxAlternatives: 3,\n        enableWordConfidence: true,\n        enableSecretTagDetection: true\n      });\n\n      if (!isMountedRef.current) {\n        logger.info('[processSegment] Component unmounted during transcription, ignoring result.');\n        return;\n      }\n\n      // Store enhanced transcription result\n      setLastTranscriptionResult(result);\n      \n      // Get quality assessment\n      const qualityAssessment = speechToTextService.getQualityAssessment(result);\n\n      const transcript = result.transcript?.trim();\n      if (transcript) {\n        // Check if a secret tag was detected\n        if (result.secret_tag_detected?.found) {\n          // Determine if this should be treated as a secret tag command or normal content\n          const isSecretTagCommand = shouldTreatAsSecretTagCommand(transcript, result.secret_tag_detected);\n          \n          if (isSecretTagCommand) {\n            logger.info(`[processSegment] Secret tag command detected - not adding \"${transcript}\" to transcript segments`);\n            const action = result.secret_tag_detected.action === 'activate' ? 'activated' : 'deactivated';\n            setCurrentSegmentTranscript(`Secret tag ${action} successfully`);\n            \n            // Show brief success message then clear\n            setTimeout(() => {\n              if (isMountedRef.current) {\n                setCurrentSegmentTranscript('');\n              }\n            }, 2000);\n            \n            return; // Exit early - don't add to segments or trigger auto-save\n          } else {\n            logger.info(`[processSegment] Secret tag detected but treating as normal content: \"${transcript}\"`);\n            // Continue with normal processing - this will create an entry\n          }\n        }\n        \n        // Capitalize first letter of the transcript segment\n        const capitalizedTranscript = transcript.charAt(0).toUpperCase() + transcript.slice(1);\n        \n        logger.info(\n          `[processSegment] Transcription completed - ` +\n          `Text: \"${transcript.substring(0, 50)}...\", ` +\n          `Confidence: ${result.confidence.toFixed(2)}, ` +\n          `Language: ${result.detected_language_code || languageCode}, ` +\n          `Quality: ${qualityAssessment.overall}, ` +\n          `Alternatives: ${result.alternatives.length}`\n        );\n\n        // Show quality recommendations if needed\n        if (qualityAssessment.recommendations.length > 0) {\n          logger.info(`Quality recommendations: ${qualityAssessment.recommendations.join(', ')}`);\n        }\n        \n        // Update transcript segments first\n        setTranscriptSegments(prev => {\n          const newSegments = [...prev, capitalizedTranscript];\n          logger.info(`[processSegment] Updated transcript segments: ${newSegments.length} segments, latest: \"${capitalizedTranscript}\"`);\n          \n          // Trigger auto-save with the complete transcript INSIDE the state update\n          if (settings.autoSaveEnabled && onAutoSave) {\n            const newTranscript = newSegments.join('\\n');\n            logger.info(`[AutoSave] Triggering auto-save due to new segment. Full transcript: \"${newTranscript}\"`);\n            // Use setTimeout to ensure the state update completes first\n            setTimeout(() => {\n              onAutoSave(newTranscript);\n            }, 0);\n          }\n          \n          return newSegments;\n        });\n        \n        setCurrentSegmentTranscript('');\n      } else {\n        setCurrentSegmentTranscript('No speech detected in this segment.');\n        logger.warn('[processSegment] No transcript received from service.');\n      }\n\n    } catch (error: any) {\n      logger.error('[processSegment] Transcription failed:', error);\n      if (isMountedRef.current) {\n        setCurrentSegmentTranscript(`Error: ${error.message || 'Transcription failed'}`);\n      }\n    } finally {\n      if (isMountedRef.current) {\n        setIsTranscribingSegment(false);\n      }\n      \n      // Clean up the audio file\n      try {\n        await cleanupRecordingFile(uri);\n        logger.info(`[processSegment] Cleaned up audio file: ${uri}`);\n      } catch (cleanupError) {\n        logger.error(`[processSegment] Failed to clean up audio file ${uri}:`, cleanupError);\n      }\n    }\n  };\n\n  // Simplified effect to process audio with selected language\n  useEffect(() => {\n    if (audioUri && !isRecording && !processedUris.has(audioUri) && permissionGranted) {\n      // Validate language code\n      if (selectedLanguage !== 'auto' && !validateLanguageCode(selectedLanguage)) {\n        logger.error(`Invalid language selection: ${selectedLanguage}`);\n        Alert.alert('Language Selection Error', 'Invalid language selected. Using auto-detect.');\n        setSelectedLanguage('auto');\n        return;\n      }\n\n      logger.info(\n        `[AudioRecorder] useEffect detected new audioUri: ${audioUri} ` +\n        `for language: ${selectedLanguage}. Starting processSegment.`\n      );\n      \n      processSegment(audioUri, selectedLanguage);\n    }\n  }, [audioUri, isRecording, processedUris, permissionGranted, selectedLanguage]);\n\n  const handleMicPress = async () => {\n    if (!permissionGranted) {\n      Alert.alert('Permissions Required', 'Audio recording permission is needed to record.');\n      logger.warn('Mic pressed but permission not granted.');\n      return;\n    }\n\n    if (isRecording) {\n      logger.info('[AudioRecorder] Mic press: Stopping current recording segment.');\n      hapticService.medium(); // Medium haptic feedback for stop action\n      try {\n        await stopRecording();\n      } catch (error) {\n        logger.error('[AudioRecorder] Error stopping recording segment:', error);\n      }\n    } else { // Not recording\n      if (isTranscribingSegment) {\n        logger.info('[AudioRecorder] Mic press: Still transcribing previous segment. Please wait.');\n        hapticService.warning(); // Warning haptic for blocked action\n        Alert.alert('Processing', 'Still processing the previous audio. Please wait a moment.');\n        return;\n      }\n      \n      // Reset callback flag for new recording session\n      callbackCalledRef.current = false;\n      \n      logger.info('[AudioRecorder] Mic press: Starting new recording segment.');\n      hapticService.heavy(); // Heavy haptic feedback for start recording action\n      try {\n        await startRecording();\n      } catch (error) {\n        logger.error('[AudioRecorder] Error starting new recording segment:', error);\n        Alert.alert('Error Starting Recording', 'Could not start a new recording. Please try again.');\n      }\n    }\n  };\n\n  // Language selection handler\n  const handleLanguageChange = (languageCode: string) => {\n    if (validateLanguageCode(languageCode) || languageCode === 'auto') {\n      setSelectedLanguage(languageCode);\n      logger.info(`Language changed to: ${languageCode}`);\n    } else {\n      logger.error(`Invalid language code: ${languageCode}`);\n    }\n  };\n\n  const formatDuration = (seconds: number) => {\n    const mins = Math.floor(seconds / 60);\n    const secs = seconds % 60;\n    return `${mins}:${secs.toString().padStart(2, '0')}`;\n  };\n\n  // Function to sanitize/clean transcript text\n  const sanitizeText = (text: string): string => {\n    return text.replace(/^[\\(\\[\\•\\-\\*]+\\s*/g, '').trim();\n  };\n\n  const canAcceptTranscript = !isRecording && !isTranscribingSegment && transcriptSegments.length > 0;\n\n  return {\n    // State\n    transcriptSegments,\n    setTranscriptSegments,\n    currentSegmentTranscript,\n    isTranscribingSegment,\n    lastTranscriptionResult,\n    showAlternatives,\n    setShowAlternatives,\n    selectedLanguage,\n    isProcessing,\n    hasTranscribedAudio,\n    canAcceptTranscript,\n    \n    // Animation refs\n    pulseAnim,\n    waveAnim1,\n    waveAnim2,\n    \n    // Audio recording state\n    isRecording,\n    recordingDuration,\n    audioUri,\n    permissionGranted,\n    recordingError,\n    \n    // Handlers\n    handleMicPress,\n    handleAcceptTranscript,\n    handleDone,\n    handleLanguageChange,\n    formatDuration,\n    sanitizeText,\n  };\n};","import React, { useRef, useEffect, useImperativeHandle, forwardRef, useCallback } from 'react';\nimport {\n  View,\n  StyleSheet,\n  Animated,\n  Dimensions,\n  TouchableWithoutFeedback,\n  Modal,\n  Platform,\n} from 'react-native';\nimport { PanGestureHandler, State } from 'react-native-gesture-handler';\nimport { useAppTheme } from '../contexts/ThemeContext';\nimport { AppTheme } from '../config/theme';\n\nconst { height: SCREEN_HEIGHT } = Dimensions.get('window');\n\n// Helper for native driver compatibility\nconst useNativeDriver = Platform.OS !== 'web';\n\ninterface BottomSheetProps {\n  children: React.ReactNode;\n  visible: boolean;\n  onClose: () => void;\n  snapPoints?: number[];\n  initialSnapPoint?: number;\n  enablePanGesture?: boolean;\n  backdropOpacity?: number;\n  style?: object;\n}\n\nexport interface BottomSheetRef {\n  snapTo: (index: number) => void;\n  close: () => void;\n}\n\nconst BottomSheet = forwardRef<BottomSheetRef, BottomSheetProps>(({\n  children,\n  visible,\n  onClose,\n  snapPoints = [0.3, 0.6, 0.9],\n  initialSnapPoint = 1,\n  enablePanGesture = true,\n  backdropOpacity = 0.5,\n  style,\n}, ref) => {\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n  \n  const translateY = useRef(new Animated.Value(SCREEN_HEIGHT)).current;\n  const backdropOpacity_ = useRef(new Animated.Value(0)).current;\n  const lastGestureY = useRef(0);\n  const currentSnapIndex = useRef(initialSnapPoint);\n  const gestureTranslateY = useRef(new Animated.Value(0)).current;\n\n  const snapPointsInPixels = snapPoints.map(point => SCREEN_HEIGHT * (1 - point));\n\n  useImperativeHandle(ref, () => ({\n    snapTo: (index: number) => {\n      if (index >= 0 && index < snapPointsInPixels.length) {\n        currentSnapIndex.current = index;\n        Animated.spring(translateY, {\n          toValue: snapPointsInPixels[index],\n          useNativeDriver,\n        }).start();\n      }\n    },\n    close: () => {\n      onClose();\n    },\n  }));\n\n  useEffect(() => {\n    if (visible) {\n      // Show bottom sheet\n      Animated.parallel([\n        Animated.spring(translateY, {\n          toValue: snapPointsInPixels[initialSnapPoint],\n          useNativeDriver,\n        }),\n        Animated.timing(backdropOpacity_, {\n          toValue: 1,\n          duration: 300,\n          useNativeDriver,\n        }),\n      ]).start();\n      currentSnapIndex.current = initialSnapPoint;\n    } else {\n      // Hide bottom sheet\n      Animated.parallel([\n        Animated.spring(translateY, {\n          toValue: SCREEN_HEIGHT,\n          useNativeDriver,\n        }),\n        Animated.timing(backdropOpacity_, {\n          toValue: 0,\n          duration: 300,\n          useNativeDriver,\n        }),\n      ]).start();\n    }\n  }, [visible, initialSnapPoint]);\n\n  // Use a more React-friendly approach for gesture handling\n  const onGestureEvent = useCallback(\n    Animated.event(\n      [{ nativeEvent: { translationY: gestureTranslateY } }],\n      { \n        useNativeDriver: false, // Set to false for web compatibility\n        listener: (event: any) => {\n          // Optional: Add any additional gesture handling here\n          if (!enablePanGesture) return;\n          \n          const { translationY } = event.nativeEvent;\n          lastGestureY.current = translationY;\n        }\n      }\n    ),\n    [enablePanGesture, gestureTranslateY]\n  );\n\n  const onHandlerStateChange = useCallback((event: any) => {\n    if (!enablePanGesture) return;\n\n    if (event.nativeEvent.oldState === State.ACTIVE) {\n      const { translationY, velocityY } = event.nativeEvent;\n      const currentY = snapPointsInPixels[currentSnapIndex.current] + translationY;\n      \n      // Reset gesture value\n      gestureTranslateY.setValue(0);\n      \n      // Determine which snap point to go to\n      let targetSnapIndex = currentSnapIndex.current;\n      \n      if (velocityY > 500) {\n        // Fast downward swipe - go to next snap point or close\n        targetSnapIndex = Math.min(currentSnapIndex.current + 1, snapPointsInPixels.length - 1);\n        if (targetSnapIndex === snapPointsInPixels.length - 1 && translationY > 100) {\n          onClose();\n          return;\n        }\n      } else if (velocityY < -500) {\n        // Fast upward swipe - go to previous snap point\n        targetSnapIndex = Math.max(currentSnapIndex.current - 1, 0);\n      } else {\n        // Find closest snap point\n        let minDistance = Infinity;\n        snapPointsInPixels.forEach((point, index) => {\n          const distance = Math.abs(currentY - point);\n          if (distance < minDistance) {\n            minDistance = distance;\n            targetSnapIndex = index;\n          }\n        });\n        \n        // If dragged down significantly, close\n        if (currentY > SCREEN_HEIGHT * 0.8) {\n          onClose();\n          return;\n        }\n      }\n\n      currentSnapIndex.current = targetSnapIndex;\n      Animated.spring(translateY, {\n        toValue: snapPointsInPixels[targetSnapIndex],\n        useNativeDriver,\n      }).start();\n    }\n  }, [enablePanGesture, snapPointsInPixels, onClose, translateY]);\n\n  const handleBackdropPress = () => {\n    onClose();\n  };\n\n  if (!visible) {\n    return null;\n  }\n\n  // Combine translateY and gestureTranslateY for smoother gestures\n  const combinedTranslateY = Animated.add(translateY, gestureTranslateY);\n\n  const content = (\n    <View style={styles.container}>\n      \n      <TouchableWithoutFeedback onPress={handleBackdropPress}>\n        <Animated.View\n          style={[\n            styles.backdrop,\n            {\n              opacity: backdropOpacity_.interpolate({\n                inputRange: [0, 1],\n                outputRange: [0, backdropOpacity],\n              }),\n            },\n          ]}\n        />\n      </TouchableWithoutFeedback>\n\n      <PanGestureHandler\n        onGestureEvent={onGestureEvent}\n        onHandlerStateChange={onHandlerStateChange}\n        enabled={enablePanGesture}\n      >\n        <Animated.View\n          style={[\n            styles.bottomSheet,\n            style,\n            {\n              transform: [{ translateY: combinedTranslateY }],\n            },\n          ]}\n        >\n          <View style={styles.handle} />\n          <View style={styles.content}>\n            {children}\n          </View>\n        </Animated.View>\n      </PanGestureHandler>\n    </View>\n  );\n\n  if (Platform.OS === 'ios') {\n    return (\n      <Modal\n        transparent\n        visible={visible}\n        animationType=\"none\"\n        onRequestClose={onClose}\n      >\n        {content}\n      </Modal>\n    );\n  }\n\n  return content;\n});\n\nconst getStyles = (theme: AppTheme) => StyleSheet.create({\n  container: {\n    flex: 1,\n    justifyContent: 'flex-end',\n  },\n  backdrop: {\n    ...StyleSheet.absoluteFillObject,\n    backgroundColor: theme.colors.overlay,\n  },\n  bottomSheet: {\n    backgroundColor: theme.colors.surface,\n    borderTopLeftRadius: theme.borderRadius.xxl,\n    borderTopRightRadius: theme.borderRadius.xxl,\n    minHeight: SCREEN_HEIGHT * 0.3,\n    maxHeight: SCREEN_HEIGHT * 0.95,\n    ...theme.shadows.xl,\n  },\n  handle: {\n    width: 40,\n    height: 4,\n    backgroundColor: theme.colors.border,\n    borderRadius: 2,\n    alignSelf: 'center',\n    marginTop: theme.spacing.md,\n    marginBottom: theme.spacing.lg,\n  },\n  content: {\n    flex: 1,\n    paddingHorizontal: theme.spacing.lg,\n    paddingBottom: theme.spacing.xl,\n  },\n});\n\nexport default BottomSheet; ","import React, { useState, useRef } from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  TouchableOpacity,\n  FlatList,\n  TextInput,\n} from 'react-native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { useAppTheme } from '../contexts/ThemeContext';\nimport { AppTheme } from '../config/theme';\nimport { LanguageOption, SUPPORTED_LANGUAGES, getLanguageName } from '../config/languageConfig';\nimport BottomSheet, { BottomSheetRef } from './BottomSheet';\n\ninterface LanguageSelectorProps {\n  selectedLanguage: string;\n  onLanguageChange: (languageCode: string) => void;\n  disabled?: boolean;\n}\n\nconst LanguageSelector: React.FC<LanguageSelectorProps> = ({\n  selectedLanguage,\n  onLanguageChange,\n  disabled = false,\n}) => {\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n  const [modalVisible, setModalVisible] = useState(false);\n  const [searchQuery, setSearchQuery] = useState('');\n  const bottomSheetRef = useRef<BottomSheetRef>(null);\n\n  const selectedLanguageName = getLanguageName(selectedLanguage) || 'Auto-detect';\n\n  // Filter languages based on search query\n  const filteredLanguages = SUPPORTED_LANGUAGES.filter(language => {\n    if (!searchQuery.trim()) return true;\n    \n    const query = searchQuery.toLowerCase();\n    return (\n      language.name.toLowerCase().includes(query) ||\n      language.code.toLowerCase().includes(query) ||\n      (language.region && language.region.toLowerCase().includes(query))\n    );\n  });\n\n  const handleLanguageSelect = (languageCode: string) => {\n    onLanguageChange(languageCode);\n    setModalVisible(false);\n    setSearchQuery(''); // Clear search when closing\n  };\n\n  const handleOpenSelector = () => {\n    if (!disabled) {\n      setModalVisible(true);\n    }\n  };\n\n  const handleCloseSelector = () => {\n    setModalVisible(false);\n    setSearchQuery(''); // Clear search when closing\n  };\n\n  const renderLanguageItem = ({ item }: { item: LanguageOption }) => (\n    <TouchableOpacity\n      style={[\n        styles.languageItem,\n        item.code === selectedLanguage && styles.selectedLanguageItem\n      ]}\n      onPress={() => handleLanguageSelect(item.code)}\n      accessibilityLabel={`Select ${item.name} language`}\n      accessibilityRole=\"button\"\n    >\n      <View style={styles.languageInfo}>\n        <Text style={[\n          styles.languageName,\n          item.code === selectedLanguage && styles.selectedLanguageName\n        ]}>\n          {item.region ? `${item.name} (${item.region})` : item.name}\n        </Text><Text style={[\n          styles.languageCode,\n          item.code === selectedLanguage && styles.selectedLanguageCode\n        ]}>\n          {item.code}\n        </Text>\n      </View>{item.code === selectedLanguage && (\n        <View style={styles.checkmarkContainer}>\n          <Ionicons name=\"checkmark-circle\" size={24} color={theme.colors.primary} />\n        </View>\n      )}\n    </TouchableOpacity>\n  );\n\n  const renderEmptyState = () => (\n    <View style={styles.emptyState}>\n      <Ionicons name=\"search-outline\" size={48} color={theme.colors.textDisabled} /><Text style={styles.emptyStateText}>No languages found</Text><Text style={styles.emptyStateSubtext}>Try a different search term</Text>\n    </View>\n  );\n\n  return (\n    <View style={styles.container}>\n      <TouchableOpacity\n        style={[styles.selector, disabled && styles.selectorDisabled]}\n        onPress={handleOpenSelector}\n        disabled={disabled}\n        accessibilityLabel={`Current language: ${selectedLanguageName}. Tap to change.`}\n        accessibilityRole=\"button\"\n        accessibilityHint=\"Opens language selection menu\"\n      >\n        <View style={styles.selectorContent}>\n          <View style={styles.iconContainer}>\n            <Ionicons \n              name=\"language\" \n              size={22} \n              color={disabled ? theme.colors.disabled : theme.colors.primary} \n            />\n          </View><View style={styles.textContainer}>\n            <Text style={styles.selectorLabel}>Language</Text><Text style={[\n              styles.selectorText,\n              disabled && styles.selectorTextDisabled\n            ]}>\n              {selectedLanguageName}\n            </Text>\n          </View>\n        </View><Ionicons \n          name=\"chevron-down\" \n          size={20} \n          color={disabled ? theme.colors.disabled : theme.colors.textSecondary} \n        />\n      </TouchableOpacity><BottomSheet\n        visible={modalVisible}\n        onClose={handleCloseSelector}\n        snapPoints={[0.7, 0.9]}\n        initialSnapPoint={0}\n      >\n        <View style={styles.modalContent}>\n          <View style={styles.modalHeader}>\n            <Text style={styles.modalTitle}>Select Language</Text><Text style={styles.modalSubtitle}>\n              Choose your preferred language for voice transcription\n            </Text>\n          </View><View style={styles.searchContainer}>\n            <View style={styles.searchInputWrapper}>\n              <Ionicons \n                name=\"search\" \n                size={20} \n                color={theme.colors.textSecondary} \n                style={styles.searchIcon}\n              /><TextInput\n                style={styles.searchInput}\n                value={searchQuery}\n                onChangeText={setSearchQuery}\n                placeholder=\"Search languages...\"\n                placeholderTextColor={theme.colors.textSecondary}\n                returnKeyType=\"search\"\n                autoCorrect={false}\n                autoCapitalize=\"none\"\n              />{searchQuery.length > 0 && (\n                <TouchableOpacity\n                  onPress={() => setSearchQuery('')}\n                  style={styles.clearButton}\n                  accessibilityLabel=\"Clear search\"\n                >\n                  <Ionicons name=\"close-circle\" size={20} color={theme.colors.textSecondary} />\n                </TouchableOpacity>\n              )}\n            </View>\n          </View>{searchQuery.trim() && (\n            <Text style={styles.resultsCount}>\n              {filteredLanguages.length} language{filteredLanguages.length === 1 ? '' : 's'} found\n            </Text>\n          )}<FlatList\n            data={filteredLanguages}\n            keyExtractor={(item) => item.code}\n            renderItem={renderLanguageItem}\n            style={styles.languageList}\n            showsVerticalScrollIndicator={true}\n            ListEmptyComponent={renderEmptyState}\n            keyboardShouldPersistTaps=\"handled\"\n            getItemLayout={(data, index) => ({\n              length: 72,\n              offset: 72 * index,\n              index,\n            })}\n            initialNumToRender={10}\n            maxToRenderPerBatch={10}\n            windowSize={10}\n          />\n        </View>\n      </BottomSheet>\n    </View>\n  );\n};\n\nconst getStyles = (theme: AppTheme) => StyleSheet.create({\n  container: {\n    marginVertical: theme.spacing.md,\n  },\n  selector: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    backgroundColor: theme.colors.card,\n    borderRadius: theme.borderRadius.lg,\n    paddingHorizontal: theme.spacing.lg,\n    paddingVertical: theme.spacing.lg,\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n    minHeight: 64,\n    ...theme.shadows.sm,\n  },\n  selectorDisabled: {\n    opacity: 0.6,\n    backgroundColor: theme.colors.disabled,\n  },\n  selectorContent: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    flex: 1,\n  },\n  iconContainer: {\n    width: 40,\n    height: 40,\n    borderRadius: theme.borderRadius.lg,\n    backgroundColor: theme.colors.primaryLight + '20',\n    justifyContent: 'center',\n    alignItems: 'center',\n    marginRight: theme.spacing.md,\n  },\n  textContainer: {\n    flex: 1,\n  },\n  selectorLabel: {\n    fontSize: theme.typography.fontSizes.sm,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.medium,\n    marginBottom: theme.spacing.xs,\n  },\n  selectorText: {\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n  selectorTextDisabled: {\n    color: theme.colors.disabled,\n  },\n  modalContent: {\n    flex: 1,\n  },\n  modalHeader: {\n    marginBottom: theme.spacing.lg,\n  },\n  modalTitle: {\n    fontSize: theme.typography.fontSizes.xl,\n    fontWeight: 'bold',\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.bold,\n    marginBottom: theme.spacing.xs,\n  },\n  modalSubtitle: {\n    fontSize: theme.typography.fontSizes.sm,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  searchContainer: {\n    marginBottom: theme.spacing.lg,\n  },\n  searchInputWrapper: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: theme.colors.inputBackground,\n    borderRadius: theme.borderRadius.lg,\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n    paddingHorizontal: theme.spacing.md,\n    minHeight: 48,\n  },\n  searchIcon: {\n    marginRight: theme.spacing.sm,\n  },\n  searchInput: {\n    flex: 1,\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.regular,\n    paddingVertical: theme.spacing.md,\n  },\n  clearButton: {\n    padding: theme.spacing.xs,\n    marginLeft: theme.spacing.sm,\n  },\n  resultsCount: {\n    fontSize: theme.typography.fontSizes.sm,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.regular,\n    marginBottom: theme.spacing.md,\n    textAlign: 'center',\n  },\n  languageList: {\n    flex: 1,\n  },\n  languageItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingVertical: theme.spacing.lg,\n    paddingHorizontal: theme.spacing.md,\n    borderRadius: theme.borderRadius.md,\n    marginBottom: theme.spacing.xs,\n    minHeight: 72,\n  },\n  selectedLanguageItem: {\n    backgroundColor: theme.colors.primaryLight + '20',\n    borderWidth: 1,\n    borderColor: theme.colors.primaryLight + '40',\n  },\n  languageInfo: {\n    flex: 1,\n  },\n  languageName: {\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n    marginBottom: theme.spacing.xs,\n  },\n  selectedLanguageName: {\n    color: theme.colors.primary,\n  },\n  languageCode: {\n    fontSize: theme.typography.fontSizes.sm,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  selectedLanguageCode: {\n    color: theme.colors.primary,\n  },\n  checkmarkContainer: {\n    marginLeft: theme.spacing.md,\n  },\n  emptyState: {\n    alignItems: 'center',\n    justifyContent: 'center',\n    paddingVertical: theme.spacing.xxxl,\n  },\n  emptyStateText: {\n    fontSize: theme.typography.fontSizes.lg,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n    marginTop: theme.spacing.md,\n    marginBottom: theme.spacing.xs,\n  },\n  emptyStateSubtext: {\n    fontSize: theme.typography.fontSizes.sm,\n    color: theme.colors.textDisabled,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n});\n\nexport default LanguageSelector; ","import React, { useState, useEffect, useRef, useCallback } from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  TouchableOpacity,\n  ActivityIndicator,\n  ScrollView,\n  Animated,\n  Platform,\n  TextInput,\n  Modal,\n} from 'react-native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { useAppTheme } from '../contexts/ThemeContext';\nimport { AppTheme } from '../config/theme';\nimport { TranscriptionResult } from '../hooks/useAudioRecorderLogic';\nimport { getLanguageName } from '../config/languageConfig';\n\n// Import simple language selector\nimport LanguageSelector from './LanguageSelector';\n\n// Helper function to add alpha to hex colors\nconst addAlpha = (color: string, alpha: string): string => {\n  // If color already has alpha, return as is\n  if (color.length === 9) return color;\n  // Add alpha to 6-digit hex color\n  if (color.length === 7) return color + alpha;\n  // For other formats, just return the color (won't add alpha)\n  return color;\n};\n\ninterface SaveButtonState {\n  text: string;\n  disabled: boolean;\n  isSaving: boolean;\n}\n\ninterface AudioRecorderUIProps {\n  // State props\n  transcriptSegments: string[];\n  setTranscriptSegments: React.Dispatch<React.SetStateAction<string[]>>;\n  currentSegmentTranscript: string;\n  isTranscribingSegment: boolean;\n  lastTranscriptionResult: TranscriptionResult | null;\n  showAlternatives: boolean;\n\n  selectedLanguage: string;\n  isProcessing: boolean;\n  canAcceptTranscript: boolean;\n  \n  // Animation refs\n  pulseAnim: Animated.Value;\n  waveAnim1: Animated.Value;\n  waveAnim2: Animated.Value;\n  \n  // Audio recording state\n  isRecording: boolean;\n  recordingDuration: number;\n  permissionGranted: boolean;\n  \n  // Handlers\n  handleMicPress: () => void;\n  handleAcceptTranscript: () => void;\n  handleLanguageChange: (languageCode: string) => void;\n  formatDuration: (seconds: number) => string;\n  setShowAlternatives: (show: boolean) => void;\n  \n  // Save button state\n  saveButtonState?: SaveButtonState;\n  \n  // Optional close handler for modal mode\n  onClose?: () => void;\n  \n  // Optional existing content to show as context\n  existingContent?: string;\n  \n  // Optional handler for saving with complete edited text\n  onSaveWithCompleteText?: (completeText: string) => void;\n}\n\n// Waveform component for dynamic visualization\nconst WaveformVisualization: React.FC<{\n  isRecording: boolean;\n  waveAnim1: Animated.Value;\n  waveAnim2: Animated.Value;\n  theme: AppTheme;\n}> = ({ isRecording, waveAnim1, waveAnim2, theme }) => {\n  const waveformBars = Array.from({ length: 12 }, (_, i) => {\n    // Create staggered animation for each bar\n    const animValue = i % 2 === 0 ? waveAnim1 : waveAnim2;\n    const delay = i * 50; // Stagger the animation\n    \n    return (\n      <Animated.View\n        key={i}\n        style={[\n          {\n            width: 3,\n            backgroundColor: theme.colors.primary,\n            marginHorizontal: 1,\n            borderRadius: 1.5,\n          },\n          {\n            height: animValue.interpolate({\n              inputRange: [0, 1],\n              outputRange: [8, 25 + Math.random() * 15], // Random heights for more dynamic look\n            }),\n          },\n        ]}\n      />\n    );\n  });\n\n  return (\n    <View style={{\n      flexDirection: 'row',\n      alignItems: 'center',\n      justifyContent: 'center',\n      height: 40,\n      marginVertical: theme.spacing.sm, // Further reduced spacing\n    }}>\n      {waveformBars}\n    </View>\n  );\n};\n\nexport const AudioRecorderUI: React.FC<AudioRecorderUIProps> = ({\n  transcriptSegments,\n  setTranscriptSegments,\n  currentSegmentTranscript,\n  isTranscribingSegment,\n  lastTranscriptionResult,\n  showAlternatives,\n  selectedLanguage,\n  isProcessing,\n  canAcceptTranscript,\n  pulseAnim,\n  waveAnim1,\n  waveAnim2,\n  isRecording,\n  recordingDuration,\n  permissionGranted,\n  handleMicPress,\n  handleAcceptTranscript,\n  handleLanguageChange,\n  formatDuration,\n  setShowAlternatives,\n  saveButtonState,\n  onClose,\n  existingContent,\n  onSaveWithCompleteText,\n}) => {\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n  const [isLanguageModalVisible, setLanguageModalVisible] = useState(false);\n  const pulseAnimRef = useRef(new Animated.Value(1)).current;\n\n  // Animate recording button pulse\n  useEffect(() => {\n    if (isRecording) {\n      const pulseAnimation = Animated.loop(\n        Animated.sequence([\n          Animated.timing(pulseAnimRef, {\n            toValue: 1.1,\n            duration: 800,\n            useNativeDriver: true,\n          }),\n          Animated.timing(pulseAnimRef, {\n            toValue: 1,\n            duration: 800,\n            useNativeDriver: true,\n          }),\n        ])\n      );\n      pulseAnimation.start();\n      return () => pulseAnimation.stop();\n    } else {\n      pulseAnimRef.setValue(1);\n    }\n  }, [isRecording, pulseAnimRef]);\n\n  // Track user-edited text separately to avoid feedback loops\n  const [editedText, setEditedText] = useState(existingContent || '');\n  const [hasUserEdited, setHasUserEdited] = useState(false);\n\n  // Compute display text for the TextInput\n  const getDisplayText = () => {\n    // If user has manually edited the text, use that\n    if (hasUserEdited) {\n      return editedText;\n    }\n    \n    // Build the complete display text from all available sources\n    let displayParts = [];\n    \n    // Add existing content if available\n    if (existingContent && existingContent.trim()) {\n      displayParts.push(existingContent);\n    }\n    \n    // Add completed segments if available\n    if (transcriptSegments.length > 0) {\n      displayParts.push(transcriptSegments.join('\\n'));\n    }\n    \n    // Add current segment being transcribed ONLY during active transcription\n    if (isTranscribingSegment && \n        currentSegmentTranscript && \n        currentSegmentTranscript.trim() && \n        currentSegmentTranscript !== 'Processing...') {\n      displayParts.push(currentSegmentTranscript);\n    }\n    \n    return displayParts.join('\\n\\n');\n  };\n\n  // Get effective save button state\n  const effectiveSaveButtonState = saveButtonState || {\n    text: 'Save',\n    disabled: !canAcceptTranscript,\n    isSaving: false\n  };\n\n  // Handle save button press\n  const handleSavePress = useCallback(() => {\n    if (onSaveWithCompleteText && existingContent) {\n      // Get the current text for saving\n      let textToSave;\n      if (hasUserEdited) {\n        // User has manually edited\n        textToSave = editedText;\n      } else {\n        // Build the complete text from all available sources (same as display logic)\n        let saveParts = [];\n        \n        // Add existing content if available\n        if (existingContent && existingContent.trim()) {\n          saveParts.push(existingContent);\n        }\n        \n        // Add completed segments if available\n        if (transcriptSegments.length > 0) {\n          saveParts.push(transcriptSegments.join('\\n'));\n        }\n        \n        textToSave = saveParts.join('\\n\\n');\n      }\n      \n      onSaveWithCompleteText(textToSave);\n      \n      // After save, update the display to show the saved content\n      setEditedText(textToSave);\n      setHasUserEdited(true); // Mark as edited so it shows the saved content\n      // Clear transcript segments to prevent re-accumulation\n      setTranscriptSegments([]);\n    } else {\n      // For new entries, get the current transcript and save it\n      const currentTranscript = transcriptSegments.join('\\n').trim();\n      if (currentTranscript) {\n        handleAcceptTranscript();\n        // After save, update display to show the saved content\n        setEditedText(currentTranscript);\n        setHasUserEdited(true);\n        // Clear segments to prevent accumulation\n        setTranscriptSegments([]);\n      }\n    }\n  }, [onSaveWithCompleteText, existingContent, editedText, hasUserEdited, transcriptSegments, handleAcceptTranscript, setTranscriptSegments]);\n\n  // Get display text for transcription area\n  const getTranscriptionDisplayText = () => {\n    if (isTranscribingSegment) {\n      return 'Processing audio...';\n    }\n    if (editedText) {\n      return editedText;\n    }\n    if (isRecording) {\n      return 'Listening...';\n    }\n    return 'Tap the microphone to start recording';\n  };\n\n  return (\n    <View style={styles.container}>\n      {/* Top Bar with Timer and Icons */}\n      <View style={styles.topBar}>\n        {/* Timer - Top Left */}\n        <Text style={styles.timerTextTopLeft}>\n          {formatDuration(recordingDuration)}\n        </Text>\n        \n        {/* Icons - Top Right */}\n        <View style={styles.topRightIcons}>\n          {/* Language Icon */}\n          <TouchableOpacity\n            style={styles.languageButton}\n            onPress={() => setLanguageModalVisible(true)}\n            disabled={isRecording}\n          >\n            <Ionicons \n              name=\"language\" \n              size={20} \n              color={isRecording ? theme.colors.disabled : theme.colors.primary} \n            />\n          </TouchableOpacity>\n          \n          {/* Lock Icon */}\n          <TouchableOpacity\n            style={styles.lockButton}\n            onPress={() => setLanguageModalVisible(true)}\n            disabled={isRecording}\n          >\n            <Ionicons \n              name=\"lock-closed\" \n              size={20} \n              color={isRecording ? theme.colors.disabled : theme.colors.textSecondary} \n            />\n          </TouchableOpacity>\n        </View>\n      </View>\n      \n      {/* Waveform Visualization */}\n      <WaveformVisualization\n        isRecording={isRecording}\n        waveAnim1={waveAnim1}\n        waveAnim2={waveAnim2}\n        theme={theme}\n      />\n      \n      {/* Recording Button */}\n      <View style={styles.recordingButtonContainer}>\n        <Animated.View style={[\n          styles.recordingButtonOuter,\n          { transform: [{ scale: pulseAnimRef }] }\n        ]}>\n          <TouchableOpacity\n            style={[\n              styles.recordingButton,\n              { backgroundColor: isRecording ? '#E53E3E' : theme.colors.primary }\n            ]}\n            onPress={handleMicPress}\n            disabled={!permissionGranted}\n          >\n            <View style={styles.recordingButtonInner}>\n              {isRecording ? (\n                <View style={styles.stopIcon} />\n              ) : (\n                <Ionicons name=\"mic\" size={32} color=\"white\" />\n              )}\n            </View>\n          </TouchableOpacity>\n        </Animated.View>\n      </View>\n      \n      {/* Recording Status */}\n      <Text style={styles.recordingStatusText}>\n        {isRecording ? 'Recording in progress' : 'Ready to record'}\n      </Text>\n      \n      {/* Spacer to push transcript to bottom */}\n      <View style={styles.spacer} />\n        \n      {/* Transcript Card - Bottom Area */}\n      <View style={styles.transcriptCard}>\n        {/* Header with Transcript label and Save button */}\n        <View style={styles.transcriptHeader}>\n          <View style={styles.transcriptLabelContainer}>\n            <Ionicons name=\"document-text\" size={20} color={theme.colors.primary} />\n            <Text style={styles.transcriptLabel}>Transcript</Text>\n          </View>\n          \n          <TouchableOpacity\n            style={[\n              styles.saveButtonSmall,\n              effectiveSaveButtonState.disabled && styles.saveButtonSmallDisabled\n            ]}\n            onPress={handleSavePress}\n            disabled={effectiveSaveButtonState.disabled}\n          >\n            {effectiveSaveButtonState.isSaving ? (\n              <ActivityIndicator size=\"small\" color=\"white\" />\n            ) : (\n              <Text style={styles.saveButtonSmallText}>Save</Text>\n            )}\n          </TouchableOpacity>\n        </View>\n        \n        {/* Editable Text Area */}\n        <TextInput\n          style={styles.transcriptTextInput}\n          value={getDisplayText()}\n          onChangeText={(text) => {\n            // Only allow editing when not transcribing\n            if (!isTranscribingSegment) {\n              setEditedText(text);\n              setHasUserEdited(true);\n            }\n          }}\n          multiline\n          placeholder={isTranscribingSegment ? 'Processing audio...' : (isRecording ? 'Listening...' : 'Tap the microphone to start recording')}\n          placeholderTextColor={theme.colors.textSecondary}\n          textAlignVertical=\"top\"\n          editable={!isTranscribingSegment}\n        />\n        \n        {isTranscribingSegment && (\n          <ActivityIndicator\n            size=\"small\"\n            color={theme.colors.primary}\n            style={styles.transcriptionLoader}\n          />\n        )}\n        \n        {/* Transcription Alternatives */}\n        {showAlternatives && lastTranscriptionResult?.alternatives && lastTranscriptionResult.alternatives.length > 0 && (\n          <ScrollView style={styles.alternativesScroll} showsVerticalScrollIndicator={false}>\n            <View style={styles.alternativesContainer}>\n              <Text style={styles.alternativesTitle}>Alternative transcriptions:</Text>\n              {lastTranscriptionResult.alternatives.map((alternative, index) => (\n                <TouchableOpacity\n                  key={index}\n                  style={styles.alternativeItem}\n                  onPress={() => {\n                    if (alternative.transcript && alternative.transcript.trim()) {\n                      setTranscriptSegments([alternative.transcript]);\n                      setShowAlternatives(false);\n                    }\n                  }}\n                >\n                  <Text style={styles.alternativeText}>{alternative.transcript}</Text>\n                  {alternative.confidence !== undefined && (\n                    <Text style={styles.alternativeConfidence}>\n                      {Math.round(alternative.confidence * 100)}%\n                    </Text>\n                  )}\n                </TouchableOpacity>\n              ))}\n            </View>\n          </ScrollView>\n        )}\n      </View>\n\n      {/* Language Selector Modal */}\n      <Modal\n        animationType=\"slide\"\n        transparent={true}\n        visible={isLanguageModalVisible}\n        onRequestClose={() => setLanguageModalVisible(false)}\n      >\n        <View style={styles.modalOverlay}>\n          <View style={styles.modalContent}>\n            <View style={styles.modalHeader}>\n              <Text style={styles.modalTitle}>Select Language</Text>\n              <TouchableOpacity\n                style={styles.modalCloseButton}\n                onPress={() => setLanguageModalVisible(false)}\n              >\n                <Ionicons name=\"close\" size={24} color={theme.colors.text} />\n              </TouchableOpacity>\n            </View>\n            <LanguageSelector\n              selectedLanguage={selectedLanguage}\n              onLanguageChange={(languageCode) => {\n                handleLanguageChange(languageCode);\n                setLanguageModalVisible(false);\n              }}\n            />\n          </View>\n        </View>\n      </Modal>\n    </View>\n  );\n};\n\nconst getStyles = (theme: AppTheme) => StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: 'transparent',\n  },\n  \n  // Top bar with timer and icons\n  topBar: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    paddingHorizontal: theme.spacing.lg,\n    paddingTop: theme.spacing.md,\n    paddingBottom: theme.spacing.sm,\n  },\n  \n  // Icons container in top-right\n  topRightIcons: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 12,\n  },\n  \n  // Timer in top-left\n  timerTextTopLeft: {\n    fontSize: 32,\n    fontWeight: '300',\n    color: theme.colors.text,\n    fontFamily: Platform.OS === 'ios' ? 'Helvetica Neue' : 'Roboto',\n  },\n  \n  // Language button\n  languageButton: {\n    padding: 8,\n    borderRadius: 20,\n    backgroundColor: theme.colors.surface,\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n  },\n  \n  // Lock button (language selector)\n  lockButton: {\n    padding: 8,\n    borderRadius: 20,\n    backgroundColor: theme.colors.surface,\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n  },\n  \n  // Recording button\n  recordingButtonContainer: {\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginVertical: theme.spacing.lg,\n  },\n  \n  // Spacer to push transcript to bottom - make it much smaller\n  spacer: {\n    flex: 0.3, // Further reduced from 0.5\n    minHeight: 10,\n  },\n  recordingButtonOuter: {\n    width: 120,\n    height: 120,\n    borderRadius: 60,\n    backgroundColor: 'rgba(99, 102, 241, 0.2)',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  recordingButton: {\n    width: 90,\n    height: 90,\n    borderRadius: 45,\n    alignItems: 'center',\n    justifyContent: 'center',\n    elevation: 4,\n    shadowColor: '#000',\n    shadowOffset: { width: 0, height: 2 },\n    shadowOpacity: 0.25,\n    shadowRadius: 4,\n  },\n  recordingButtonInner: {\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  stopIcon: {\n    width: 24,\n    height: 24,\n    backgroundColor: 'white',\n    borderRadius: 4,\n  },\n  \n  // Recording status\n  recordingStatusText: {\n    fontSize: 16,\n    color: '#E53E3E',\n    fontWeight: '500',\n    marginTop: theme.spacing.sm,\n    textAlign: 'center',\n  },\n  \n  // Transcript card - simplified and taking more space\n  transcriptCard: {\n    backgroundColor: theme.colors.card,\n    borderRadius: theme.borderRadius.xl,\n    marginHorizontal: theme.spacing.md,\n    marginTop: theme.spacing.md,\n    marginBottom: theme.spacing.lg, // Add bottom margin for proper spacing\n    ...theme.shadows.md,\n    borderColor: theme.colors.borderLight,\n    borderWidth: theme.isDarkMode ? 1 : 0,\n    overflow: 'hidden',\n    flex: 1, // Take remaining space\n    minHeight: 250, // Ensure substantial minimum height\n  },\n  transcriptHeader: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    paddingHorizontal: theme.spacing.lg,\n    paddingVertical: theme.spacing.md,\n    backgroundColor: theme.isDarkMode ? theme.colors.gray800 : theme.colors.gray50,\n    borderBottomWidth: 1,\n    borderBottomColor: theme.colors.borderLight,\n  },\n  transcriptLabelContainer: {\n    flexDirection: 'row',\n    alignItems: 'center',\n  },\n  transcriptLabel: {\n    fontSize: theme.typography.fontSizes.md,\n    fontWeight: '600',\n    color: theme.colors.text,\n    marginLeft: theme.spacing.sm,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n  saveButtonSmall: {\n    backgroundColor: theme.colors.primary,\n    paddingHorizontal: theme.spacing.md,\n    paddingVertical: theme.spacing.sm,\n    borderRadius: theme.borderRadius.full,\n  },\n  saveButtonSmallDisabled: {\n    backgroundColor: theme.colors.disabled,\n  },\n  saveButtonSmallText: {\n    color: theme.colors.onPrimary,\n    fontSize: theme.typography.fontSizes.sm,\n    fontWeight: '600',\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n  transcriptTextInput: {\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.text,\n    lineHeight: theme.typography.lineHeights.normal * theme.typography.fontSizes.md,\n    padding: theme.spacing.lg,\n    flex: 1, // Take remaining space in the card\n    textAlignVertical: 'top',\n    fontFamily: theme.typography.fontFamilies.regular,\n    backgroundColor: 'transparent',\n  },\n  \n  // Legacy transcription display (keeping for compatibility)\n  transcriptionContainer: {\n    width: '100%',\n    height: 120,\n    backgroundColor: theme.colors.surface,\n    borderRadius: 16,\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n    marginTop: 20,\n    position: 'relative',\n  },\n  transcriptionInput: {\n    flex: 1,\n    fontSize: 16,\n    color: theme.colors.text,\n    lineHeight: 22,\n    padding: 16,\n    textAlignVertical: 'top',\n  },\n  transcriptionScroll: {\n    flex: 1,\n  },\n  transcriptionContent: {\n    padding: 16,\n    minHeight: 88,\n  },\n  transcriptionText: {\n    fontSize: 16,\n    color: theme.colors.text,\n    lineHeight: 22,\n  },\n  alternativesScroll: {\n    maxHeight: 80,\n    paddingHorizontal: theme.spacing.lg,\n    paddingBottom: theme.spacing.sm,\n  },\n  transcriptionLoader: {\n    position: 'absolute',\n    bottom: theme.spacing.md,\n    right: theme.spacing.md,\n  },\n  \n  // Alternatives styles\n  alternativesContainer: {\n    marginTop: theme.spacing.md,\n    paddingTop: theme.spacing.md,\n    borderTopWidth: 1,\n    borderTopColor: theme.colors.borderLight,\n  },\n  alternativesTitle: {\n    fontSize: theme.typography.fontSizes.sm,\n    fontWeight: '600',\n    color: theme.colors.textSecondary,\n    marginBottom: theme.spacing.sm,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n  alternativeItem: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    paddingVertical: theme.spacing.sm,\n    paddingHorizontal: theme.spacing.md,\n    backgroundColor: theme.isDarkMode ? theme.colors.gray700 : theme.colors.gray100,\n    borderRadius: theme.borderRadius.md,\n    marginBottom: theme.spacing.xs,\n    borderWidth: 1,\n    borderColor: theme.colors.borderLight,\n  },\n  alternativeText: {\n    fontSize: theme.typography.fontSizes.sm,\n    color: theme.colors.text,\n    flex: 1,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  alternativeConfidence: {\n    fontSize: theme.typography.fontSizes.xs,\n    color: theme.colors.textSecondary,\n    marginLeft: theme.spacing.sm,\n    fontWeight: '500',\n    fontFamily: theme.typography.fontFamilies.medium,\n  },\n  \n  // Modal styles\n  modalOverlay: {\n    flex: 1,\n    backgroundColor: 'rgba(0, 0, 0, 0.5)',\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  modalContent: {\n    backgroundColor: theme.colors.background,\n    borderRadius: 16,\n    padding: 20,\n    width: '90%',\n    maxHeight: '80%',\n  },\n  modalHeader: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    marginBottom: 20,\n  },\n  modalTitle: {\n    fontSize: 20,\n    fontWeight: 'bold',\n    color: theme.colors.text,\n  },\n  modalCloseButton: {\n    padding: 4,\n  },\n});\n\nexport default AudioRecorderUI; ","import React, { useCallback, useEffect } from 'react';\nimport { View, StyleSheet } from 'react-native';\nimport { useAudioRecorderLogic } from '../hooks/useAudioRecorderLogic';\nimport AudioRecorderUI from './AudioRecorderUI';\nimport logger from '../utils/logger';\nimport speechToTextService from '../services/speechToText';\n\n\nconst analyzeTranscriptionQuality = (result: any): { recommendations: string[] } => {\n  const recommendations = [];\n  if (result.confidence < 0.85) {\n    recommendations.push('Low transcription confidence.');\n  }\n  if (result.secret_tag_detected) {\n    recommendations.push(`Secret tag detected: ${result.secret_tag_details?.tagName}`);\n  }\n  return { recommendations };\n};\n\nconst cleanupAudioFile = (uri: string) => {\n  logger.info(`[cleanupAudioFile] Cleaned up audio file: ${uri}`);\n};\n\ninterface AudioRecorderProps {\n  onSave?: (transcript: string) => void;\n  onManualSave?: (transcript: string, audioUri?: string) => void;\n  onTranscriptionComplete?: (transcript: string) => void;\n  onCancel?: () => void;\n  onAutoSave?: (transcript: string) => void;\n  onStateChange?: (newState: string) => void;\n  onCommandDetected?: () => void;\n  isEditingInitialContent?: boolean;\n  saveButtonState?: { text: string; disabled: boolean; isSaving: boolean };\n  startRecordingOnMount?: boolean;\n  existingContent?: string;\n  onSaveWithCompleteText?: (completeText: string) => void;\n}\n\nconst AudioRecorder: React.FC<AudioRecorderProps> = ({\n  onSave,\n  onManualSave,\n  onTranscriptionComplete,\n  onCancel,\n  onAutoSave,\n  onStateChange,\n  onCommandDetected,\n  isEditingInitialContent = false,\n  saveButtonState,\n  startRecordingOnMount = true,\n  existingContent,\n  onSaveWithCompleteText,\n}) => {\n  const handleTranscriptionComplete = (text: string, audioUri?: string, detectedLanguage?: string | null, confidence?: number) => {\n    logger.info('[AudioRecorder] onTranscriptionComplete triggered.');\n    onTranscriptionComplete?.(text);\n    onSave?.(text);\n  };\n  \n  const handleCancel = () => {\n    logger.info('[AudioRecorder] onCancel called.');\n    onCancel?.();\n  };\n\n  const handleAutoSave = (text: string) => {\n    logger.info('[AudioRecorder] onAutoSave called.');\n    onAutoSave?.(text);\n  };\n  \n  const processSegment = useCallback(\n    async (audioUri: string, language: string): Promise<{ text: string } | null> => {\n      try {\n        const result = await speechToTextService.transcribeAudio(audioUri, { \n          languageCodes: [language],\n          enableSecretTagDetection: true \n        });\n        if (!result) {\n          cleanupAudioFile(audioUri);\n          return null;\n        }\n        const { transcript, secret_tag_detected } = result;\n        \n        // Check if secret tag was detected (handled by speechToText service)\n        if (secret_tag_detected?.found) {\n          logger.info(`OPAQUE secret tag detected: ${secret_tag_detected.tagName} (${secret_tag_detected.action})`);\n          // Treat secret tag phrases as commands (don't add to transcript)\n          logger.info('[processSegment] Transcript was a secret tag command. Halting processing.');\n          cleanupAudioFile(audioUri);\n          onCommandDetected?.();\n          return null;\n        }\n        \n        analyzeTranscriptionQuality(result);\n        cleanupAudioFile(audioUri);\n        return { text: transcript };\n      } catch (error) {\n        logger.error(\"Error during transcription processSegment\", error);\n        cleanupAudioFile(audioUri);\n        return null;\n      }\n    },\n    [onCommandDetected]\n  );\n\n  const logic = useAudioRecorderLogic({\n    onTranscriptionComplete: handleTranscriptionComplete,\n    onCancel: handleCancel,\n    onAutoSave: handleAutoSave,\n    autoStart: startRecordingOnMount && !isEditingInitialContent,\n  });\n\n  useEffect(() => {\n    onStateChange?.(logic.isRecording ? 'recording' : 'idle');\n  }, [logic.isRecording, onStateChange]);\n\n  const handleManualSave = useCallback(() => {\n    const fullTranscript = logic.transcriptSegments.join('\\n').trim();\n    if (fullTranscript) {\n      onManualSave?.(fullTranscript);\n      onSave?.(fullTranscript);\n    }\n  }, [logic.transcriptSegments, onManualSave, onSave]);\n\n  return (\n    <View style={styles.container}>\n      <AudioRecorderUI\n        isRecording={logic.isRecording}\n        transcriptSegments={logic.transcriptSegments}\n        setTranscriptSegments={logic.setTranscriptSegments}\n        currentSegmentTranscript={logic.currentSegmentTranscript}\n        isTranscribingSegment={logic.isTranscribingSegment}\n        lastTranscriptionResult={logic.lastTranscriptionResult}\n        showAlternatives={logic.showAlternatives}\n        setShowAlternatives={logic.setShowAlternatives}\n        selectedLanguage={logic.selectedLanguage}\n        isProcessing={logic.isProcessing}\n        canAcceptTranscript={logic.canAcceptTranscript}\n        pulseAnim={logic.pulseAnim}\n        waveAnim1={logic.waveAnim1}\n        waveAnim2={logic.waveAnim2}\n        recordingDuration={logic.recordingDuration}\n        permissionGranted={logic.permissionGranted}\n        handleMicPress={logic.handleMicPress}\n        handleAcceptTranscript={handleManualSave}\n        handleLanguageChange={logic.handleLanguageChange}\n        formatDuration={logic.formatDuration}\n        onClose={onCancel}\n        existingContent={existingContent}\n        onSaveWithCompleteText={onSaveWithCompleteText}\n      />\n    </View>\n  );\n};\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n});\n\nexport default AudioRecorder; ","/**\n * Secret Tag Indicator Component\n * \n * Shows active secret tags status in the UI with visual indicators.\n * Displays in recording screen, journal screens, etc.\n */\n\nimport React, { useState, useEffect } from 'react';\nimport {\n  View,\n  Text,\n  TouchableOpacity,\n  StyleSheet,\n  Animated,\n  Platform,\n} from 'react-native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { useAppTheme } from '../contexts/ThemeContext';\nimport { AppTheme } from '../config/theme';\nimport { SecretTagV2 } from '../services/secretTagOnlineManager';\nimport { areSecretTagsEnabled } from '../config/featureFlags';\nimport logger from '../utils/logger';\n\n// Helper to determine if native driver should be used\nconst useNativeDriver = Platform.OS !== 'web';\n\ninterface SecretTagIndicatorProps {\n  activeTags: SecretTagV2[];\n  onPress?: () => void;\n  compact?: boolean;\n  showPulse?: boolean;\n}\n\nconst SecretTagIndicator: React.FC<SecretTagIndicatorProps> = ({\n  activeTags,\n  onPress,\n  compact = false,\n  showPulse = true,\n}) => {\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n  \n  const [pulseAnim] = useState(new Animated.Value(1));\n\n  // Pulse animation for active state\n  useEffect(() => {\n    if (showPulse && activeTags.length > 0) {\n      const pulse = Animated.loop(\n        Animated.sequence([\n          Animated.timing(pulseAnim, {\n            toValue: 1.1,\n            duration: 1000,\n            useNativeDriver,\n          }),\n          Animated.timing(pulseAnim, {\n            toValue: 1,\n            duration: 1000,\n            useNativeDriver,\n          }),\n        ])\n      );\n      pulse.start();\n      \n      return () => pulse.stop();\n    }\n  }, [activeTags.length, showPulse, pulseAnim]);\n\n  // Don't render if feature disabled or no active tags\n  if (!areSecretTagsEnabled() || activeTags.length === 0) {\n    return null;\n  }\n\n  const primaryTag = activeTags[0];\n  const hasMultipleTags = activeTags.length > 1;\n\n  if (compact) {\n    return (\n      <TouchableOpacity\n        style={styles.compactContainer}\n        onPress={onPress}\n        activeOpacity={0.7}\n      >\n        <Animated.View style={[\n          styles.compactIndicator,\n          { backgroundColor: primaryTag.colorCode },\n          showPulse && { transform: [{ scale: pulseAnim }] }\n        ]}>\n          <Ionicons name=\"shield-checkmark\" size={12} color={theme.colors.background} />\n        </Animated.View>\n        {hasMultipleTags && (\n          <View style={styles.multipleTagsBadge}>\n            <Text style={styles.multipleTagsText}>+{activeTags.length - 1}</Text>\n          </View>\n        )}\n      </TouchableOpacity>\n    );\n  }\n\n  return (\n    <TouchableOpacity\n      style={styles.container}\n      onPress={onPress}\n      activeOpacity={0.8}\n    >\n      <Animated.View style={[\n        styles.indicator,\n        { borderColor: primaryTag.colorCode },\n        showPulse && { transform: [{ scale: pulseAnim }] }\n      ]}>\n        <View style={[styles.colorDot, { backgroundColor: primaryTag.colorCode }]} />\n        <View style={styles.content}>\n          <View style={styles.header}>\n            <Ionicons name=\"shield-checkmark\" size={16} color={theme.colors.primary} />\n            <Text style={styles.title}>Secret Tag Active</Text>\n          </View>\n          \n          <Text style={styles.tagName} numberOfLines={1}>\n            {primaryTag.name}\n            {hasMultipleTags && ` +${activeTags.length - 1} more`}\n          </Text>\n          \n          <Text style={styles.subtitle}>\n            New entries will be encrypted\n          </Text>\n        </View>\n        \n        {onPress && (\n          <Ionicons name=\"chevron-forward\" size={16} color={theme.colors.textSecondary} />\n        )}\n      </Animated.View>\n    </TouchableOpacity>\n  );\n};\n\n/**\n * Mini version for floating display\n */\nexport const SecretTagFloatingIndicator: React.FC<{\n  activeTags: SecretTagV2[];\n  onPress?: () => void;\n}> = ({ activeTags, onPress }) => {\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n  \n  const [pulseAnim] = useState(new Animated.Value(1));\n\n  useEffect(() => {\n    if (activeTags.length > 0) {\n      const pulse = Animated.loop(\n        Animated.sequence([\n          Animated.timing(pulseAnim, {\n            toValue: 1.2,\n            duration: 1500,\n            useNativeDriver,\n          }),\n          Animated.timing(pulseAnim, {\n            toValue: 1,\n            duration: 1500,\n            useNativeDriver,\n          }),\n        ])\n      );\n      pulse.start();\n      \n      return () => pulse.stop();\n    }\n  }, [activeTags.length, pulseAnim]);\n\n  if (!areSecretTagsEnabled() || activeTags.length === 0) {\n    return null;\n  }\n\n  const primaryTag = activeTags[0];\n\n  return (\n    <TouchableOpacity\n      style={styles.floatingContainer}\n      onPress={onPress}\n      activeOpacity={0.8}\n    >\n      <Animated.View style={[\n        styles.floatingIndicator,\n        { backgroundColor: primaryTag.colorCode },\n        { transform: [{ scale: pulseAnim }] }\n      ]}>\n        <Ionicons name=\"shield-checkmark\" size={16} color={theme.colors.background} />\n        {activeTags.length > 1 && (\n          <View style={styles.floatingBadge}>\n            <Text style={styles.floatingBadgeText}>{activeTags.length}</Text>\n          </View>\n        )}\n      </Animated.View>\n    </TouchableOpacity>\n  );\n};\n\nconst getStyles = (theme: AppTheme) => StyleSheet.create({\n  container: {\n    marginVertical: theme.spacing.xs,\n  },\n  indicator: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: theme.colors.card,\n    borderRadius: 12,\n    padding: theme.spacing.md,\n    borderWidth: 2,\n    borderColor: theme.colors.primary,\n    ...theme.shadows.sm,\n  },\n  colorDot: {\n    width: 8,\n    height: 8,\n    borderRadius: 4,\n    marginRight: theme.spacing.sm,\n  },\n  content: {\n    flex: 1,\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginBottom: 2,\n  },\n  title: {\n    fontSize: theme.typography.fontSizes.sm,\n    fontWeight: '600',\n    color: theme.colors.primary,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n    marginLeft: 4,\n  },\n  tagName: {\n    fontSize: theme.typography.fontSizes.md,\n    fontWeight: '500',\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.medium,\n    marginBottom: 2,\n  },\n  subtitle: {\n    fontSize: theme.typography.fontSizes.xs,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  compactContainer: {\n    position: 'relative',\n  },\n  compactIndicator: {\n    width: 24,\n    height: 24,\n    borderRadius: 12,\n    justifyContent: 'center',\n    alignItems: 'center',\n    ...theme.shadows.sm,\n  },\n  multipleTagsBadge: {\n    position: 'absolute',\n    top: -4,\n    right: -4,\n    backgroundColor: theme.colors.error,\n    borderRadius: 8,\n    minWidth: 16,\n    height: 16,\n    justifyContent: 'center',\n    alignItems: 'center',\n    paddingHorizontal: 4,\n  },\n  multipleTagsText: {\n    fontSize: 10,\n    fontWeight: 'bold',\n    color: theme.colors.background,\n    fontFamily: theme.typography.fontFamilies.bold,\n  },\n  floatingContainer: {\n    position: 'absolute',\n    top: theme.spacing.lg,\n    right: theme.spacing.lg,\n    zIndex: 1000,\n  },\n  floatingIndicator: {\n    width: 48,\n    height: 48,\n    borderRadius: 24,\n    justifyContent: 'center',\n    alignItems: 'center',\n    ...theme.shadows.lg,\n    position: 'relative',\n  },\n  floatingBadge: {\n    position: 'absolute',\n    top: -4,\n    right: -4,\n    backgroundColor: theme.colors.background,\n    borderRadius: 10,\n    minWidth: 20,\n    height: 20,\n    justifyContent: 'center',\n    alignItems: 'center',\n    paddingHorizontal: 4,\n    borderWidth: 2,\n    borderColor: theme.colors.primary,\n  },\n  floatingBadgeText: {\n    fontSize: 12,\n    fontWeight: 'bold',\n    color: theme.colors.primary,\n    fontFamily: theme.typography.fontFamilies.bold,\n  },\n});\n\nexport default SecretTagIndicator; ","/**\n * Zero-Knowledge Encryption Service\n * \n * This service ensures TRUE PRIVACY by:\n * - All encryption/decryption happens on user device only\n * - Each secret phrase directly becomes an encryption key\n * - Keys stored in hardware-backed secure storage (iOS Secure Enclave/Android Keystore)\n * - Server cannot decrypt any user data under any circumstances\n * - Per-entry encryption with forward secrecy\n * - Complete isolation between secret tags\n */\n\nimport * as SecureStore from 'expo-secure-store';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { Platform } from 'react-native';\nimport logger from '../utils/logger';\n\nexport interface EncryptedEntry {\n  encryptedContent: string;  // Base64 encoded encrypted data\n  encryptedKey: string;      // Entry key encrypted with phrase-derived key\n  iv: string;                // Base64 encoded initialization vector for content\n  salt: string;              // Base64 encoded salt for this entry\n  algorithm: string;         // Encryption algorithm used\n  wrapIv: string;            // Base64 encoded IV used for key wrapping\n}\n\nexport interface PhraseKeyInfo {\n  tagId: string;             // Secret tag ID\n  phraseSalt: string;        // Base64 encoded salt for phrase key derivation\n  iterations: number;        // PBKDF2 iterations\n  createdAt: number;         // Timestamp of key creation\n}\n\nclass ZeroKnowledgeEncryption {\n  private static readonly ALGORITHM = 'AES-GCM';\n  private static readonly KEY_LENGTH = 256;\n  private static readonly IV_LENGTH = 12; // 96 bits for GCM\n  private static readonly SALT_LENGTH = 32; // 256 bits\n  private static readonly DEFAULT_ITERATIONS = 100000;\n  \n  // Hardware-backed storage keys\n  private static readonly DEVICE_INFO = 'zk_device_info';\n  private static readonly PHRASE_KEYS_INFO = 'zk_phrase_keys_info';\n  \n  private phraseKeys: Map<string, CryptoKey> = new Map(); // tagId -> CryptoKey\n  private deviceEntropy: Uint8Array | null = null;\n\n  /**\n   * Secure storage abstraction for web compatibility\n   */\n  private async getSecureItem(key: string): Promise<string | null> {\n    if (Platform.OS === 'web') {\n      return AsyncStorage.getItem(key);\n    } else {\n      return SecureStore.getItemAsync(key);\n    }\n  }\n\n  /**\n   * Secure storage setter with authentication\n   */\n  private async setSecureItem(\n    key: string, \n    value: string, \n    options?: SecureStore.SecureStoreOptions\n  ): Promise<void> {\n    if (Platform.OS === 'web') {\n      await AsyncStorage.setItem(key, value);\n    } else {\n      await SecureStore.setItemAsync(key, value, options);\n    }\n  }\n\n  /**\n   * Secure storage deletion\n   */\n  private async deleteSecureItem(key: string): Promise<void> {\n    if (Platform.OS === 'web') {\n      await AsyncStorage.removeItem(key);\n    } else {\n      await SecureStore.deleteItemAsync(key);\n    }\n  }\n\n  /**\n   * Check if Web Crypto API is available\n   */\n  private isWebCryptoAvailable(): boolean {\n    return typeof crypto !== 'undefined' && \n           typeof crypto.subtle !== 'undefined' &&\n           typeof crypto.subtle.deriveKey === 'function';\n  }\n\n  /**\n   * Check if secure storage is available\n   */\n  private async isSecureStorageAvailable(): Promise<boolean> {\n    if (Platform.OS === 'web') {\n      return true; // AsyncStorage is always available on web\n    } else {\n      return SecureStore.isAvailableAsync();\n    }\n  }\n\n  /**\n   * Get or generate device-specific entropy\n   */\n  private async getDeviceEntropy(): Promise<Uint8Array> {\n    if (this.deviceEntropy) {\n      return this.deviceEntropy;\n    }\n\n    try {\n      const storedEntropy = await this.getSecureItem(ZeroKnowledgeEncryption.DEVICE_INFO);\n      \n      if (storedEntropy) {\n        this.deviceEntropy = this.base64ToArray(storedEntropy);\n        return this.deviceEntropy;\n      }\n\n      // Generate new device entropy\n      this.deviceEntropy = crypto.getRandomValues(new Uint8Array(ZeroKnowledgeEncryption.SALT_LENGTH));\n      \n      await this.setSecureItem(\n        ZeroKnowledgeEncryption.DEVICE_INFO,\n        this.arrayToBase64(this.deviceEntropy),\n        {\n          requireAuthentication: false, // Device entropy doesn't need auth\n          authenticationPrompt: 'Authenticate to access device encryption'\n        }\n      );\n\n      logger.info('Generated new device entropy for encryption');\n      return this.deviceEntropy;\n    } catch (error) {\n      logger.error('Failed to get device entropy:', error);\n      throw new Error('Failed to initialize device entropy');\n    }\n  }\n\n  /**\n   * Initialize phrase-specific encryption key for a secret tag\n   */\n  async initializePhraseKey(tagId: string, secretPhrase: string): Promise<boolean> {\n    if (!this.isWebCryptoAvailable()) {\n      throw new Error('Web Crypto API not available');\n    }\n\n    try {\n      // Get device-specific entropy\n      const deviceEntropy = await this.getDeviceEntropy();\n      \n      // Create phrase-specific key material\n      const encoder = new TextEncoder();\n      const phraseBytes = encoder.encode(secretPhrase);\n      \n      // Combine secret phrase + device entropy for unique key per phrase\n      const combinedKeyMaterial = new Uint8Array(phraseBytes.length + deviceEntropy.length);\n      combinedKeyMaterial.set(phraseBytes, 0);\n      combinedKeyMaterial.set(deviceEntropy, phraseBytes.length);\n\n      // Import key material for PBKDF2\n      const keyMaterial = await crypto.subtle.importKey(\n        'raw',\n        combinedKeyMaterial,\n        'PBKDF2',\n        false,\n        ['deriveKey']\n      );\n\n      // Generate unique salt for this phrase\n      const phraseSalt = crypto.getRandomValues(new Uint8Array(ZeroKnowledgeEncryption.SALT_LENGTH));\n\n      // Derive phrase-specific encryption key\n      const phraseKey = await crypto.subtle.deriveKey(\n        {\n          name: 'PBKDF2',\n          salt: phraseSalt,\n          iterations: ZeroKnowledgeEncryption.DEFAULT_ITERATIONS,\n          hash: 'SHA-256'\n        },\n        keyMaterial,\n        {\n          name: ZeroKnowledgeEncryption.ALGORITHM,\n          length: ZeroKnowledgeEncryption.KEY_LENGTH\n        },\n        false, // Key is not extractable\n        ['encrypt', 'decrypt', 'wrapKey', 'unwrapKey']\n      );\n\n      // Store phrase key in memory\n      this.phraseKeys.set(tagId, phraseKey);\n\n      // Store phrase key info securely\n      const phraseKeyInfo: PhraseKeyInfo = {\n        tagId: tagId,\n        phraseSalt: this.arrayToBase64(phraseSalt),\n        iterations: ZeroKnowledgeEncryption.DEFAULT_ITERATIONS,\n        createdAt: Date.now()\n      };\n\n      await this.savePhraseKeyInfo(phraseKeyInfo);\n\n      // Clear sensitive data from memory\n      combinedKeyMaterial.fill(0);\n      \n      logger.info(`Secret phrase key initialized for tag: ${tagId}`);\n      return true;\n\n    } catch (error) {\n      logger.error(`Failed to initialize phrase key for tag ${tagId}:`, error);\n      return false;\n    }\n  }\n\n  /**\n   * Load existing phrase-specific encryption key\n   */\n  async loadPhraseKey(tagId: string, secretPhrase: string): Promise<boolean> {\n    if (!this.isWebCryptoAvailable()) {\n      throw new Error('Web Crypto API not available');\n    }\n\n    try {\n      // Get phrase key info\n      const phraseKeyInfo = await this.getPhraseKeyInfo(tagId);\n      if (!phraseKeyInfo) {\n        logger.warn(`No phrase key info found for tag: ${tagId}`);\n        return false;\n      }\n\n      // Get device-specific entropy\n      const deviceEntropy = await this.getDeviceEntropy();\n      \n      // Recreate the same key derivation process\n      const encoder = new TextEncoder();\n      const phraseBytes = encoder.encode(secretPhrase);\n      \n      const combinedKeyMaterial = new Uint8Array(phraseBytes.length + deviceEntropy.length);\n      combinedKeyMaterial.set(phraseBytes, 0);\n      combinedKeyMaterial.set(deviceEntropy, phraseBytes.length);\n\n      const keyMaterial = await crypto.subtle.importKey(\n        'raw',\n        combinedKeyMaterial,\n        'PBKDF2',\n        false,\n        ['deriveKey']\n      );\n\n      const phraseSalt = this.base64ToArray(phraseKeyInfo.phraseSalt);\n\n      const phraseKey = await crypto.subtle.deriveKey(\n        {\n          name: 'PBKDF2',\n          salt: phraseSalt,\n          iterations: phraseKeyInfo.iterations,\n          hash: 'SHA-256'\n        },\n        keyMaterial,\n        {\n          name: ZeroKnowledgeEncryption.ALGORITHM,\n          length: ZeroKnowledgeEncryption.KEY_LENGTH\n        },\n        false,\n        ['encrypt', 'decrypt', 'wrapKey', 'unwrapKey']\n      );\n\n      // Store phrase key in memory\n      this.phraseKeys.set(tagId, phraseKey);\n\n      // Clear sensitive data\n      combinedKeyMaterial.fill(0);\n      \n      logger.info(`Secret phrase key loaded for tag: ${tagId}`);\n      return true;\n\n    } catch (error) {\n      logger.error(`Failed to load phrase key for tag ${tagId}:`, error);\n      return false;\n    }\n  }\n\n  /**\n   * Encrypt journal entry content with phrase-specific key\n   */\n  async encryptEntryWithSecretPhrase(content: string, tagId: string): Promise<EncryptedEntry> {\n    const phraseKey = this.phraseKeys.get(tagId);\n    if (!phraseKey) {\n      throw new Error(`Secret phrase key not loaded for tag: ${tagId}`);\n    }\n\n    return this.encryptWithKey(content, phraseKey);\n  }\n\n  /**\n   * Decrypt journal entry content with phrase-specific key\n   */\n  async decryptEntryWithSecretPhrase(encryptedEntry: EncryptedEntry, tagId: string): Promise<string> {\n    const phraseKey = this.phraseKeys.get(tagId);\n    if (!phraseKey) {\n      throw new Error(`Secret phrase key not loaded for tag: ${tagId}`);\n    }\n\n    return this.decryptWithKey(encryptedEntry, phraseKey);\n  }\n\n  /**\n   * Check if a secret phrase key is loaded for a tag\n   */\n  isPhraseKeyLoaded(tagId: string): boolean {\n    return this.phraseKeys.has(tagId);\n  }\n\n  /**\n   * Unload a secret phrase key from memory\n   */\n  unloadPhraseKey(tagId: string): void {\n    this.phraseKeys.delete(tagId);\n    logger.info(`Secret phrase key unloaded for tag: ${tagId}`);\n  }\n\n  /**\n   * Clear a secret tag's phrase encryption data permanently\n   */\n  async clearSecretPhraseEncryption(tagId: string): Promise<void> {\n    try {\n      // Remove from memory\n      this.phraseKeys.delete(tagId);\n      \n      // Remove from secure storage\n      await this.deletePhraseKeyInfo(tagId);\n      \n      logger.info(`Secret phrase encryption cleared for tag: ${tagId}`);\n    } catch (error) {\n      logger.error(`Failed to clear phrase encryption for tag ${tagId}:`, error);\n      throw error;\n    }\n  }\n\n  /**\n   * Securely clear all encryption data\n   */\n  async secureClearAllData(): Promise<void> {\n    try {\n      // Clear all phrase keys from memory\n      this.phraseKeys.clear();\n      \n      // Clear device entropy\n      this.deviceEntropy = null;\n      \n      // Remove all secure storage data\n      await this.deleteSecureItem(ZeroKnowledgeEncryption.DEVICE_INFO);\n      await this.deleteSecureItem(ZeroKnowledgeEncryption.PHRASE_KEYS_INFO);\n      \n      logger.info('All encryption data securely cleared');\n    } catch (error) {\n      logger.error('Failed to clear all encryption data:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Generic encryption with any key\n   */\n  private async encryptWithKey(content: string, encryptionKey: CryptoKey): Promise<EncryptedEntry> {\n    try {\n      // Generate unique key for this entry\n      const entryKey = await crypto.subtle.generateKey(\n        {\n          name: ZeroKnowledgeEncryption.ALGORITHM,\n          length: ZeroKnowledgeEncryption.KEY_LENGTH\n        },\n        true, // Extractable for wrapping\n        ['encrypt', 'decrypt']\n      );\n\n      // Generate unique salt and IV for this entry\n      const entrySalt = crypto.getRandomValues(new Uint8Array(ZeroKnowledgeEncryption.SALT_LENGTH));\n      const iv = crypto.getRandomValues(new Uint8Array(ZeroKnowledgeEncryption.IV_LENGTH));\n      const wrapIv = crypto.getRandomValues(new Uint8Array(ZeroKnowledgeEncryption.IV_LENGTH));\n\n      // Encrypt the content with entry key\n      const encoder = new TextEncoder();\n      const encryptedContent = await crypto.subtle.encrypt(\n        {\n          name: ZeroKnowledgeEncryption.ALGORITHM,\n          iv: iv\n        },\n        entryKey,\n        encoder.encode(content)\n      );\n\n      // Wrap (encrypt) the entry key with phrase key\n      const wrappedKey = await crypto.subtle.wrapKey(\n        'raw',\n        entryKey,\n        encryptionKey,\n        {\n          name: ZeroKnowledgeEncryption.ALGORITHM,\n          iv: wrapIv\n        }\n      );\n\n      return {\n        encryptedContent: this.arrayToBase64(new Uint8Array(encryptedContent)),\n        encryptedKey: this.arrayToBase64(new Uint8Array(wrappedKey)),\n        iv: this.arrayToBase64(iv),\n        salt: this.arrayToBase64(entrySalt),\n        algorithm: ZeroKnowledgeEncryption.ALGORITHM,\n        wrapIv: this.arrayToBase64(wrapIv)\n      };\n\n    } catch (error) {\n      logger.error('Failed to encrypt entry:', error);\n      throw new Error('Encryption failed');\n    }\n  }\n\n  /**\n   * Generic decryption with any key\n   */\n  private async decryptWithKey(encryptedEntry: EncryptedEntry, decryptionKey: CryptoKey): Promise<string> {\n    try {\n      // Convert base64 to arrays\n      const encryptedContent = this.base64ToArray(encryptedEntry.encryptedContent);\n      const encryptedKey = this.base64ToArray(encryptedEntry.encryptedKey);\n      const iv = this.base64ToArray(encryptedEntry.iv);\n      const wrapIv = this.base64ToArray(encryptedEntry.wrapIv);\n\n      // Unwrap (decrypt) the entry key with phrase key\n      const entryKey = await crypto.subtle.unwrapKey(\n        'raw',\n        encryptedKey,\n        decryptionKey,\n        {\n          name: ZeroKnowledgeEncryption.ALGORITHM,\n          iv: wrapIv\n        },\n        {\n          name: ZeroKnowledgeEncryption.ALGORITHM,\n          length: ZeroKnowledgeEncryption.KEY_LENGTH\n        },\n        false,\n        ['decrypt']\n      );\n\n      // Decrypt the content with entry key\n      const decryptedContent = await crypto.subtle.decrypt(\n        {\n          name: ZeroKnowledgeEncryption.ALGORITHM,\n          iv: iv\n        },\n        entryKey,\n        encryptedContent\n      );\n\n      // Convert back to string\n      const decoder = new TextDecoder();\n      return decoder.decode(decryptedContent);\n\n    } catch (error) {\n      logger.error('Failed to decrypt entry:', error);\n      throw new Error('Decryption failed - invalid phrase or corrupted data');\n    }\n  }\n\n  /**\n   * Save phrase key info to secure storage\n   */\n  private async savePhraseKeyInfo(phraseKeyInfo: PhraseKeyInfo): Promise<void> {\n    try {\n      const existingKeysStr = await this.getSecureItem(ZeroKnowledgeEncryption.PHRASE_KEYS_INFO);\n      const existingKeys: PhraseKeyInfo[] = existingKeysStr ? JSON.parse(existingKeysStr) : [];\n      \n      // Remove existing info for this tag\n      const filteredKeys = existingKeys.filter(info => info.tagId !== phraseKeyInfo.tagId);\n      filteredKeys.push(phraseKeyInfo);\n\n      await this.setSecureItem(\n        ZeroKnowledgeEncryption.PHRASE_KEYS_INFO,\n        JSON.stringify(filteredKeys),\n        {\n          requireAuthentication: true,\n          authenticationPrompt: 'Authenticate to manage secret phrase keys'\n        }\n      );\n    } catch (error) {\n      logger.error('Failed to save phrase key info:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get phrase key info from secure storage\n   */\n  private async getPhraseKeyInfo(tagId: string): Promise<PhraseKeyInfo | null> {\n    try {\n      const keysStr = await this.getSecureItem(ZeroKnowledgeEncryption.PHRASE_KEYS_INFO);\n      if (!keysStr) {\n        return null;\n      }\n\n      const keys: PhraseKeyInfo[] = JSON.parse(keysStr);\n      return keys.find(info => info.tagId === tagId) || null;\n    } catch (error) {\n      logger.error('Failed to get phrase key info:', error);\n      return null;\n    }\n  }\n\n  /**\n   * Delete phrase key info from secure storage\n   */\n  private async deletePhraseKeyInfo(tagId: string): Promise<void> {\n    try {\n      const keysStr = await this.getSecureItem(ZeroKnowledgeEncryption.PHRASE_KEYS_INFO);\n      if (!keysStr) {\n        return;\n      }\n\n      const keys: PhraseKeyInfo[] = JSON.parse(keysStr);\n      const filteredKeys = keys.filter(info => info.tagId !== tagId);\n\n      if (filteredKeys.length === 0) {\n        await this.deleteSecureItem(ZeroKnowledgeEncryption.PHRASE_KEYS_INFO);\n      } else {\n        await this.setSecureItem(\n          ZeroKnowledgeEncryption.PHRASE_KEYS_INFO,\n          JSON.stringify(filteredKeys),\n          {\n            requireAuthentication: true,\n            authenticationPrompt: 'Authenticate to manage secret phrase keys'\n          }\n        );\n      }\n    } catch (error) {\n      logger.error('Failed to delete phrase key info:', error);\n      throw error;\n    }\n  }\n\n  // Utility methods\n  private arrayToBase64(array: Uint8Array): string {\n    const binaryString = Array.from(array, byte => String.fromCharCode(byte)).join('');\n    return btoa(binaryString);\n  }\n\n  private base64ToArray(base64: string): Uint8Array {\n    const binaryString = atob(base64);\n    return new Uint8Array(binaryString.length).map((_, i) => binaryString.charCodeAt(i));\n  }\n}\n\n// Export singleton instance\nexport const zeroKnowledgeEncryption = new ZeroKnowledgeEncryption();\nexport default zeroKnowledgeEncryption; ","/**\n * Legacy Tag Manager Service\n * \n * This service provides backward compatibility for the legacy tag management system\n * while redirecting to the new OPAQUE-based system.\n */\n\nimport { Tag } from '../types';\nimport { TagsAPI } from './api';\nimport logger from '../utils/logger';\nimport { areSecretTagsEnabled } from '../config/featureFlags';\n\nexport interface TagManagerInterface {\n  getAllTags(): Promise<Tag[]>;\n  createTag(name: string, color?: string): Promise<Tag>;\n  updateTag(id: string, updates: Partial<Tag>): Promise<Tag>;\n  deleteTag(id: string): Promise<void>;\n  getTagById(id: string): Promise<Tag | null>;\n  getTagsByIds(ids: string[]): Promise<Tag[]>;\n  // OPAQUE-specific methods\n  getActiveSecretTags(): Promise<any[]>;\n  checkForSecretTagPhrases(content: string): Promise<{ found: boolean; tagId?: string; tagName?: string; action?: string }>;\n  getSecretTags(): Promise<any[]>;\n  activateSecretTag(tagId: string): Promise<void>;\n}\n\n/**\n * Legacy Tag Manager Implementation\n * \n * This implementation provides compatibility with the old tag management system\n * while delegating to the new OPAQUE-based system where appropriate.\n */\nclass LegacyTagManager implements TagManagerInterface {\n  /**\n   * Get all tags (regular tags only, not secret tags)\n   */\n  async getAllTags(): Promise<Tag[]> {\n    try {\n      logger.info('Legacy tagManager: Getting all regular tags from API');\n      const response = await TagsAPI.getTags();\n      const tags = response.data || [];\n      logger.info(`Legacy tagManager: Found ${tags.length} regular tags`);\n      return tags;\n    } catch (error) {\n      logger.error('Failed to get all tags:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Create a new regular tag\n   */\n  async createTag(name: string, color?: string): Promise<Tag> {\n    try {\n      logger.info('Legacy tagManager: Creating regular tag:', { name, color });\n      \n      const newTag = await TagsAPI.createTag({\n        name: name.trim(),\n        color: color || '#007AFF'\n      });\n\n      logger.info('Legacy tagManager: Created regular tag:', newTag);\n      return newTag;\n    } catch (error) {\n      logger.error('Failed to create tag:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Update an existing tag\n   */\n  async updateTag(id: string, updates: Partial<Tag>): Promise<Tag> {\n    try {\n      logger.info('Legacy tagManager: Updating tag:', { id, updates });\n      \n      const updatedTag = await TagsAPI.updateTag(id, updates);\n      logger.info('Legacy tagManager: Updated tag:', updatedTag);\n      return updatedTag;\n    } catch (error) {\n      logger.error('Failed to update tag:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Delete a tag\n   */\n  async deleteTag(id: string): Promise<void> {\n    try {\n      logger.info('Legacy tagManager: Deleting tag:', { id });\n      \n      await TagsAPI.deleteTag(id);\n      logger.info('Legacy tagManager: Deleted tag successfully');\n    } catch (error) {\n      logger.error('Failed to delete tag:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get a tag by ID\n   */\n  async getTagById(id: string): Promise<Tag | null> {\n    try {\n      logger.info('Legacy tagManager: Getting tag by ID:', { id });\n      \n      const allTags = await this.getAllTags();\n      const tag = allTags.find(t => String(t.id) === id) || null;\n      \n      logger.info('Legacy tagManager: Found tag:', tag);\n      return tag;\n    } catch (error) {\n      logger.error('Failed to get tag by ID:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get tags by IDs\n   */\n  async getTagsByIds(ids: string[]): Promise<Tag[]> {\n    try {\n      logger.info('Legacy tagManager: Getting tags by IDs:', { ids });\n      \n      const allTags = await this.getAllTags();\n      const tags = allTags.filter(t => ids.includes(String(t.id)));\n      \n      logger.info(`Legacy tagManager: Found ${tags.length} tags`);\n      return tags;\n    } catch (error) {\n      logger.error('Failed to get tags by IDs:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get active secret tags (OPAQUE-based)\n   */\n  async getActiveSecretTags(): Promise<any[]> {\n    try {\n      logger.info('Legacy tagManager: Getting active secret tags');\n      if (!areSecretTagsEnabled()) {\n        return [];\n      }\n      // TODO: Implement active secret tags retrieval from backend\n      // For now, return empty array to avoid breaking the interface\n      logger.warn('getActiveSecretTags not yet implemented - returning empty array');\n      return [];\n    } catch (error) {\n      logger.error('Failed to get active secret tags:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Check for secret tag phrases in content\n   */\n  async checkForSecretTagPhrases(content: string): Promise<{ found: boolean; tagId?: string; tagName?: string; action?: string }> {\n    try {\n      logger.info('Legacy tagManager: Checking for secret tag phrases');\n      if (!areSecretTagsEnabled()) {\n        return { found: false };\n      }\n      // TODO: Implement phrase detection logic with backend\n      // For now, return not found to avoid breaking the interface\n      logger.warn('checkForSecretTagPhrases not yet implemented - returning not found');\n      return { found: false };\n    } catch (error) {\n      logger.error('Failed to check for secret tag phrases:', error);\n      return { found: false };\n    }\n  }\n\n  /**\n   * Get all secret tags (OPAQUE-based)\n   */\n  async getSecretTags(): Promise<any[]> {\n    try {\n      logger.info('Legacy tagManager: Getting all secret tags');\n      if (!areSecretTagsEnabled()) {\n        return [];\n      }\n      // TODO: Implement secret tags retrieval from backend API\n      // For now, return empty array to avoid breaking the interface\n      logger.warn('getSecretTags not yet implemented - returning empty array');\n      return [];\n    } catch (error) {\n      logger.error('Failed to get secret tags:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Activate a secret tag\n   */\n  async activateSecretTag(tagId: string): Promise<void> {\n    try {\n      logger.info('Legacy tagManager: Activating secret tag:', { tagId });\n      if (!areSecretTagsEnabled()) {\n        return;\n      }\n      // TODO: Implement secret tag activation with backend API\n      // For now, just log to avoid breaking the interface\n      logger.warn('activateSecretTag not yet implemented - no action taken');\n    } catch (error) {\n      logger.error('Failed to activate secret tag:', error);\n      throw error;\n    }\n  }\n}\n\n// Export the legacy tag manager instance\nexport const tagManager = new LegacyTagManager();\n\n// Export default for compatibility\nexport default tagManager; ","/**\n * Encrypted Journal Service\n * \n * High-level service that integrates phrase-based zero-knowledge encryption with journal operations.\n * Handles transparent encryption/decryption for secret tag entries using secret phrases directly as keys.\n */\n\nimport { JournalAPI } from './api';\nimport { zeroKnowledgeEncryption } from './zeroKnowledgeEncryption';\nimport { tagManager } from './tagManager';\nimport logger from '../utils/logger';\nimport { clientEncryption } from './clientEncryption';\nimport { areSecretTagsEnabled } from '../config/featureFlags';\n\nexport interface JournalEntryData {\n  id?: number;\n  title?: string;\n  content: string;\n  entry_date?: string;\n  audio_url?: string;\n  tags?: string[];\n  secret_tag_id?: string | null;  // Secret tag ID (if any)\n  created_at?: string;\n  updated_at?: string;\n}\n\nexport interface CreateEntryOptions {\n  secretTagId?: string;    // Specific secret tag to use\n  forcePublic?: boolean;   // Force entry to be public (no secret tag)\n  detectedTagId?: string;  // Tag detected from voice activation\n}\n\nclass EncryptedJournalService {\n  /**\n   * Reusable logic to detect and handle secret tag phrases in content.\n   * This can be called from both create and update operations.\n   * @returns {Promise<{\n   *   processedContent: string;\n   *   detectedTagId: string | null;\n   * }>}\n   */\n  private async detectAndProcessSecretPhrase(\n    content: string,\n    existingTagId: string | null = null\n  ): Promise<{ processedContent: string; detectedTagId: string | null }> {\n    if (!content) {\n      return { processedContent: content, detectedTagId: existingTagId };\n    }\n\n    try {\n      const detection = await tagManager.checkForSecretTagPhrases(content);\n      if (detection.found && detection.tagId && detection.action === 'activate') {\n        logger.info(`Secret tag activation phrase detected in content for tag: ${detection.tagName} (${detection.tagId})`);\n        \n        // Activate the tag\n        await tagManager.activateSecretTag(detection.tagId);\n        \n        // Clean the activation phrase from the content\n        let cleanedContent = content;\n        if (detection.tagName) {\n          // Create a regex to find the phrase (case-insensitive) and remove it\n          const phraseRegex = new RegExp(detection.tagName.replace(/[-\\/\\\\^$*+?.()|[\\]{}]/g, '\\\\$&'), 'gi');\n          cleanedContent = content.replace(phraseRegex, '').trim();\n        }\n        \n        return {\n          processedContent: cleanedContent,\n          detectedTagId: detection.tagId,\n        };\n      }\n    } catch (error) {\n      logger.error('Error during secret phrase detection, proceeding with original content.', error);\n    }\n\n    // If no phrase is detected, return original content and tag ID\n    return { processedContent: content, detectedTagId: existingTagId };\n  }\n\n  /**\n   * Create a journal entry, automatically encrypting based on active secret tags\n   */\n  async createEntry(\n    entryData: Omit<JournalEntryData, 'id'>,\n    options: CreateEntryOptions = {}\n  ): Promise<JournalEntryData> {\n    const { secretTagId, forcePublic, detectedTagId: optionDetectedTagId } = options;\n    \n    // Process content for secret phrases unless forced public\n    const { processedContent, detectedTagId: manuallyDetectedTagId } = forcePublic\n      ? { processedContent: entryData.content, detectedTagId: null }\n      : await this.detectAndProcessSecretPhrase(entryData.content, null);\n\n    const finalEntryData = {\n      ...entryData,\n      content: processedContent,\n    };\n    \n    // Determine the final secret tag to use for this entry\n    const targetSecretTagId = secretTagId || optionDetectedTagId || manuallyDetectedTagId;\n\n    // If secret tags feature is disabled, use per-user encryption path\n    if (!areSecretTagsEnabled()) {\n      return this.createPerUserEncryptedEntry(finalEntryData);\n    }\n\n    if (targetSecretTagId && zeroKnowledgeEncryption.isPhraseKeyLoaded(targetSecretTagId)) {\n      return this.createSecretTagEntry(finalEntryData, targetSecretTagId);\n    }\n\n    if (targetSecretTagId && !zeroKnowledgeEncryption.isPhraseKeyLoaded(targetSecretTagId)) {\n      logger.warn(`Entry should use secret tag ${targetSecretTagId} but phrase encryption not ready, creating public entry`);\n    }\n    // Fall back to public entry\n    return this.createPublicEntry(finalEntryData);\n  }\n\n  /**\n   * Create a public (non-encrypted) journal entry\n   */\n  private async createPublicEntry(entryData: Omit<JournalEntryData, 'id'>): Promise<JournalEntryData> {\n    try {\n      const response = await JournalAPI.createEntry({\n        title: entryData.title || '',\n        content: entryData.content,\n        entry_date: entryData.entry_date || new Date().toISOString(),\n        audio_url: entryData.audio_url,\n        tags: entryData.tags || [],\n        // Remove secret tag references in per-user encryption mode\n      });\n      \n      logger.info('Created public journal entry');\n      return response.data;\n    } catch (error) {\n      logger.error('Failed to create public journal entry:', error);\n      throw new Error('Failed to create journal entry');\n    }\n  }\n\n  /**\n   * Create a per-user encrypted journal entry (no secret tags)\n   */\n  private async createPerUserEncryptedEntry(entryData: Omit<JournalEntryData, 'id'>): Promise<JournalEntryData> {\n    try {\n      const enc = await clientEncryption.encryptPerUser(entryData.content);\n      const response = await JournalAPI.createEntry({\n        title: entryData.title || '',\n        content: '',\n        entry_date: entryData.entry_date || new Date().toISOString(),\n        audio_url: entryData.audio_url,\n        tags: entryData.tags || [],\n        encrypted_content: enc.encryptedContent,\n        encryption_iv: enc.iv,\n        encrypted_key: enc.wrappedKey,\n        encryption_wrap_iv: enc.wrapIv,\n        encryption_algorithm: enc.algorithm || 'AES-GCM',\n      } as any);\n      logger.info('Created per-user encrypted journal entry');\n      return {\n        ...response.data,\n        content: entryData.content,\n      };\n    } catch (error) {\n      logger.error('Failed to create per-user encrypted journal entry:', error);\n      throw new Error('Failed to create encrypted journal entry');\n    }\n  }\n\n  /**\n   * Create a secret tag (encrypted) journal entry\n   */\n  private async createSecretTagEntry(\n    entryData: Omit<JournalEntryData, 'id'>, \n    secretTagId: string\n  ): Promise<JournalEntryData> {\n    if (!zeroKnowledgeEncryption.isPhraseKeyLoaded(secretTagId)) {\n      throw new Error(`Secret tag encryption not loaded for tag: ${secretTagId}`);\n    }\n\n    try {\n      // Encrypt the content with tag-specific key\n      const encrypted = await zeroKnowledgeEncryption.encryptEntryWithSecretPhrase(\n        entryData.content, \n        secretTagId\n      );\n      \n      // Get server-side tag hashes for this tag\n      const activeTagHashes = await tagManager.getActiveSecretTags();\n      const secretTags = await tagManager.getSecretTags();\n      const targetTag = secretTags.find((tag: any) => tag.id === secretTagId);\n      \n      if (!targetTag) {\n        throw new Error(`Secret tag not found: ${secretTagId}`);\n      }\n      \n      // Create the encrypted entry\n      const response = await JournalAPI.createEncryptedEntry({\n        title: entryData.title || '',\n        encrypted_content: encrypted.encryptedContent,\n        encrypted_key: encrypted.encryptedKey,\n        iv: encrypted.iv,\n        salt: encrypted.salt,\n        algorithm: encrypted.algorithm,\n        entry_date: entryData.entry_date || new Date().toISOString(),\n        audio_url: entryData.audio_url,\n        tags: entryData.tags || [],\n        wrapIv: encrypted.wrapIv,\n        secret_tag_id: secretTagId,\n        secret_tag_hash: targetTag.id,\n      });\n      \n      logger.info(`Created secret tag journal entry with tag: ${secretTagId}`);\n      \n      // Return with decrypted content for immediate use\n      return {\n        ...response.data,\n        content: entryData.content, // Return original content for UI\n        secret_tag_id: secretTagId,\n      };\n    } catch (error) {\n      logger.error('Failed to create secret tag journal entry:', error);\n      throw new Error('Failed to create encrypted journal entry');\n    }\n  }\n\n  /**\n   * Create a secret tag entry without encryption (when encryption keys not ready)\n   */\n  private async createSecretTagEntryUnencrypted(\n    entryData: Omit<JournalEntryData, 'id'>, \n    secretTagId: string\n  ): Promise<JournalEntryData> {\n    try {\n      // Get server-side tag hashes for this tag\n      const secretTags = await tagManager.getSecretTags();\n      const targetTag = secretTags.find((tag: any) => tag.id === secretTagId);\n      \n      if (!targetTag) {\n        throw new Error(`Secret tag not found: ${secretTagId}`);\n      }\n      \n      // Create the entry with secret tag metadata but unencrypted content\n      const response = await JournalAPI.createEntry({\n        title: entryData.title || '',\n        content: entryData.content, // Store unencrypted for now\n        entry_date: entryData.entry_date || new Date().toISOString(),\n        audio_url: entryData.audio_url,\n        tags: entryData.tags || [],\n        secret_tag_id: secretTagId,\n        secret_tag_hash: targetTag.id,\n      });\n      \n      logger.info(`Created secret tag journal entry (unencrypted) with tag: ${secretTagId}`);\n      \n      return {\n        ...response.data,\n        secret_tag_id: secretTagId,\n      };\n    } catch (error) {\n      logger.error('Failed to create secret tag journal entry (unencrypted):', error);\n      throw new Error('Failed to create journal entry with secret tag');\n    }\n  }\n\n  /**\n   * Get journal entries, automatically filtering and decrypting based on active secret tags\n   */\n  async getEntries(options: {\n    page?: number;\n    limit?: number;\n    tags?: string[];\n    entry_date?: string;\n    includeAllSecretTags?: boolean;\n  } = {}): Promise<JournalEntryData[]> {\n    try {\n      // Get active secret tags for server-side filtering\n      const activeTags = await tagManager.getActiveSecretTags();\n      const activeTagHashes = activeTags.map((tag: any) => tag.id);\n      \n      // Fetch entries with secret tag filtering\n      const response = await JournalAPI.getEntries({\n        ...options,\n        secret_tag_hashes: activeTagHashes,\n        include_public: true, // Always include public entries\n      });\n      \n      const entries = response.data.entries || response.data;\n      \n      // Filter and decrypt entries based on active secret tags\n      return this.processEntries(entries);\n    } catch (error) {\n      logger.error('Failed to get journal entries:', error);\n      throw new Error('Failed to retrieve journal entries');\n    }\n  }\n\n  /**\n   * Get a specific journal entry by ID, automatically decrypting if it's a secret tag entry\n   */\n  async getEntry(id: number): Promise<JournalEntryData | null> {\n    try {\n      const response = await JournalAPI.getEntry(id);\n      const entry = response.data;\n      \n      if (!entry) return null;\n      \n      const processedEntries = await this.processEntries([entry]);\n      return processedEntries.length > 0 ? processedEntries[0] : null;\n    } catch (error) {\n      logger.error(`Failed to get journal entry ${id}:`, error);\n      throw new Error('Failed to retrieve journal entry');\n    }\n  }\n\n  /**\n   * Process entries: filter based on active secret tags and decrypt if necessary\n   */\n  private async processEntries(entries: any[]): Promise<JournalEntryData[]> {\n    // Filter entries based on active secret tags - for now just return all entries\n    // TODO: Implement filtering logic in tagManager\n    const filteredEntries = entries;\n    \n    // Decrypt secret tag entries if we have the keys loaded\n    const activeTags = await tagManager.getActiveSecretTags();\n    const activeTagIds = activeTags.map((tag: any) => tag.id);\n    \n    const processedEntries = await Promise.all(\n      filteredEntries.map(async (entry: any) => {\n        if (entry.secret_tag_id && activeTagIds.includes(entry.secret_tag_id)) {\n          return this.decryptSecretTagEntry(entry);\n        }\n        return entry;\n      })\n    );\n    \n    return processedEntries.filter(entry => entry !== null) as JournalEntryData[];\n  }\n\n  /**\n   * Decrypt a secret tag journal entry\n   */\n  private async decryptSecretTagEntry(entry: any): Promise<JournalEntryData | null> {\n    const secretTagId = entry.secret_tag_id;\n    \n    if (!secretTagId) {\n      logger.warn('Entry has no secret tag ID, cannot decrypt');\n      return null;\n    }\n\n    if (!zeroKnowledgeEncryption.isPhraseKeyLoaded(secretTagId)) {\n      logger.warn(`Cannot decrypt entry: secret tag key not loaded for ${secretTagId}`);\n      return null;\n    }\n\n    try {\n      // Check if we have the necessary encryption fields\n      if (!entry.encrypted_content || !entry.encryption_iv || !entry.encryption_salt) {\n        logger.warn('Entry missing encryption fields, cannot decrypt');\n        return null;\n      }\n\n      const encrypted = {\n        encryptedContent: entry.encrypted_content,\n        encryptedKey: entry.encrypted_key || '',\n        iv: entry.encryption_iv,\n        salt: entry.encryption_salt,\n        algorithm: entry.encryption_algorithm || 'AES-GCM',\n        wrapIv: entry.encryption_wrap_iv || entry.encryption_iv,\n      };\n\n      const decryptedContent = await zeroKnowledgeEncryption.decryptEntryWithSecretPhrase(\n        encrypted, \n        secretTagId\n      );\n      \n      return {\n        ...entry,\n        content: decryptedContent,\n      };\n    } catch (error) {\n      logger.error('Failed to decrypt secret tag journal entry:', error);\n      // Return entry with encrypted content as fallback\n      return {\n        ...entry,\n        content: '[Encrypted Content - Unable to Decrypt]',\n      };\n    }\n  }\n\n  /**\n   * Search journal entries (only in accessible entries)\n   */\n  async searchEntries(query: string): Promise<JournalEntryData[]> {\n    try {\n      // Get active tag hashes for filtering\n      const activeTags = await tagManager.getActiveSecretTags();\n      const activeTagHashes = activeTags.map((tag: any) => tag.id);\n      \n      const response = await JournalAPI.searchEntries(query, {\n        secret_tag_hashes: activeTagHashes,\n        include_public: true,\n      });\n      \n      const entries = response.data.entries || response.data;\n      return this.processEntries(entries);\n    } catch (error) {\n      logger.error('Failed to search journal entries:', error);\n      throw new Error('Failed to search journal entries');\n    }\n  }\n\n  /**\n   * Update a journal entry\n   */\n  async updateEntry(id: number, updates: Partial<JournalEntryData>): Promise<JournalEntryData> {\n    try {\n      // If content is being updated, check it for secret phrases\n      if (typeof updates.content === 'string') {\n        const { processedContent, detectedTagId } = await this.detectAndProcessSecretPhrase(updates.content);\n        \n        // Update the content with the cleaned version\n        updates.content = processedContent;\n\n        // Secret tags path if enabled\n        if (areSecretTagsEnabled() && detectedTagId && zeroKnowledgeEncryption.isPhraseKeyLoaded(detectedTagId)) {\n          logger.info(`Secret phrase detected during update. Encrypting entry ${id} with tag ${detectedTagId}.`);\n          \n          const encrypted = await zeroKnowledgeEncryption.encryptEntryWithSecretPhrase(processedContent, detectedTagId);\n          const secretTags = await tagManager.getSecretTags();\n          const targetTag = secretTags.find((tag: any) => tag.id === detectedTagId);\n\n          if (!targetTag) {\n            throw new Error(`Secret tag not found: ${detectedTagId}`);\n          }\n          \n          const encryptedUpdatePayload = {\n            ...updates,\n            content: \"\", // Clear plaintext content for the backend\n            encrypted_content: encrypted.encryptedContent,\n            encrypted_key: encrypted.encryptedKey,\n            iv: encrypted.iv,\n            salt: encrypted.salt,\n            algorithm: encrypted.algorithm,\n            wrapIv: encrypted.wrapIv,\n            secret_tag_id: detectedTagId,\n            secret_tag_hash: targetTag.id,\n          };\n          \n          const response = await JournalAPI.updateEntry(id, encryptedUpdatePayload);\n          return {\n            ...response.data,\n            content: processedContent, // Return decrypted content for UI\n          };\n        }\n\n        // Per-user encryption path when secret tags disabled\n        if (!areSecretTagsEnabled()) {\n          logger.info(`Updating entry ${id} with per-user encryption.`);\n          const enc = await clientEncryption.encryptPerUser(processedContent);\n          const encryptedUpdatePayload: any = {\n            ...updates,\n            content: '',\n            encrypted_content: enc.encryptedContent,\n            encryption_iv: enc.iv,\n            encrypted_key: enc.wrappedKey,\n            encryption_wrap_iv: enc.wrapIv,\n            encryption_algorithm: enc.algorithm || 'AES-GCM',\n          };\n          const response = await JournalAPI.updateEntry(id, encryptedUpdatePayload);\n          return { ...response.data, content: processedContent };\n        }\n      }\n      \n      // If no secret phrase was detected or encryption is not ready, perform a standard public update\n      logger.info(`Updating public journal entry ${id}.`);\n      const response = await JournalAPI.updateEntry(id, updates);\n      return response.data;\n    } catch (error) {\n      logger.error(`Failed to update journal entry ${id}:`, error);\n      throw new Error('Failed to update journal entry');\n    }\n  }\n\n  /**\n   * Delete a journal entry\n   */\n  async deleteEntry(id: string): Promise<void> {\n    try {\n      await JournalAPI.deleteEntry(String(id));\n      logger.info(`Deleted journal entry ${String(id)}`);\n    } catch (error) {\n      logger.error(`Failed to delete journal entry ${id}:`, error);\n      throw new Error('Failed to delete journal entry');\n    }\n  }\n}\n\n// Export singleton instance\nexport const encryptedJournalService = new EncryptedJournalService();\nexport default encryptedJournalService; ","import { useState, useRef, useCallback, useEffect } from 'react';\nimport { format } from 'date-fns';\nimport { encryptedJournalService } from '../services/encryptedJournalService';\nimport { JournalEntry } from '../types';\nimport logger from '../utils/logger';\n\nexport interface JournalData {\n  id: string | null;\n  title: string;\n  content: string;\n  tags: string[];\n  audioUri: string | null;\n}\n\nexport interface SaveOptions {\n  silent?: boolean; // If true, no navigation or error callbacks\n  navigateOnSuccess?: boolean; // If true, trigger navigation on success\n}\n\nexport interface JournalEntryHook {\n  journalId: string | null;\n  isSaving: boolean;\n  save: (data?: Partial<JournalData>, options?: SaveOptions) => Promise<string | null>;\n  error: Error | null;\n}\n\ninterface UseJournalEntryOptions {\n  initialData?: Partial<JournalData>;\n  selectedDate?: string; // Date in YYYY-MM-DD format from calendar\n  onSaveComplete?: (id: string | null) => void;\n  onSaveError?: (error: Error) => void;\n}\n\nconst DEFAULT_OPTIONS: UseJournalEntryOptions = {};\n\nconst useJournalEntry = (data: JournalData, options?: UseJournalEntryOptions): JournalEntryHook => {\n  const mergedOptions = { ...DEFAULT_OPTIONS, ...options };\n  const { selectedDate, onSaveComplete, onSaveError } = mergedOptions;\n  const [journalId, setJournalId] = useState<string | null>(data.id);\n  const [isSaving, setIsSaving] = useState(false);\n  const [error, setError] = useState<Error | null>(null);\n  const isMounted = useRef(true);\n  const isNavigatingRef = useRef(false);\n  \n  // Add a reference to always hold the latest data\n  const currentDataRef = useRef<JournalData>(data);\n  \n  // Keep the data reference updated\n  useEffect(() => {\n    currentDataRef.current = {\n      ...data,\n      id: journalId || data.id, // Always use the most up-to-date ID\n    };\n  }, [data, journalId]);\n\n  // Cleanup on unmount\n  useEffect(() => {\n    return () => {\n      isMounted.current = false;\n      // Important: Mark as navigating on unmount to prevent further saves\n      isNavigatingRef.current = true;\n    };\n  }, []);\n\n  // Core save function: handles create (POST) or update (PUT)\n  const performSave = useCallback(async (currentData: JournalData): Promise<string | null> => {\n    // Check if component unmounted or navigation started\n    if (!isMounted.current || isNavigatingRef.current) {\n      logger.warn('performSave: Save aborted: Component unmounting or navigation in progress');\n      return null;\n    }\n    \n    // Check if there's anything to save\n    if (!currentData.content.trim() && !currentData.title.trim() && !currentData.audioUri) {\n      logger.warn('performSave: Save skipped: No title, content, or audio URI.');\n      return null;\n    }\n      \n    // Don't send blob URLs to backend - they can't be accessed by the server\n    let audioUrl = null;\n    if (currentData.audioUri && !currentData.audioUri.startsWith('blob:')) {\n      audioUrl = currentData.audioUri;\n    } else if (currentData.audioUri) {\n      logger.info('performSave: Detected blob URL for audio. This will not be sent to backend.');\n    }\n    \n    // Use selectedDate if provided, otherwise use current date\n    let entryDate: string;\n    if (selectedDate) {\n      // Parse the selectedDate (YYYY-MM-DD format) and create a proper UTC date\n      // Set it to noon UTC to avoid timezone issues\n      const [year, month, day] = selectedDate.split('-').map(Number);\n      const utcDate = new Date(Date.UTC(year, month - 1, day, 12, 0, 0, 0));\n      entryDate = utcDate.toISOString();\n      logger.info(`performSave: Using selectedDate ${selectedDate}, converted to UTC: ${entryDate}`);\n    } else {\n      entryDate = new Date().toISOString();\n      logger.info(`performSave: Using current date: ${entryDate}`);\n    }\n      \n    const entryData = {\n      title: currentData.title.trim() || `Journal - ${format(new Date(), 'yyyy-MM-dd HH:mm')}`,\n      content: currentData.content.trim(),\n      entry_date: entryDate,\n      audio_url: audioUrl || undefined, // Convert null to undefined for type compatibility\n      tags: currentData.tags,\n    };\n\n    try {\n      // Final check before API call\n      if (!isMounted.current || isNavigatingRef.current) {\n        logger.warn('performSave: Save aborted just before API call: Component unmounting or navigation in progress');\n        return null;\n      }\n      \n      let response;\n      if (currentData.id !== null) {\n        logger.info(`performSave: Updating journal entry ID: ${currentData.id}`);\n        const updatedEntry = await encryptedJournalService.updateEntry(currentData.id, entryData);\n        logger.info(`performSave: Journal entry ID: ${currentData.id} updated.`);\n        return currentData.id;\n      } else {\n        logger.info('performSave: Creating new journal entry with data:', entryData);\n        const newEntry = await encryptedJournalService.createEntry(entryData);\n        const newId = String(newEntry.id);\n        logger.info(`performSave: New journal entry created with ID: ${newId}`);\n        if (isMounted.current && !isNavigatingRef.current) {\n          setJournalId(newId);\n        }\n        return newId;\n      }\n    } catch (err) {\n      // Only set error if still mounted and not navigating\n      if (isMounted.current && !isNavigatingRef.current) {\n        const error = err instanceof Error ? err : new Error('Error saving journal entry');\n        logger.error('performSave: Error saving journal entry', error);\n        setError(error);\n        if (onSaveError) {\n          onSaveError(error);\n        }\n      } else {\n          logger.warn('performSave: Save error occurred, but component unmounted or navigating. Error not propagated.', err);\n      }\n      // Rethrow so the caller knows it failed, even if state isn't updated\n      throw err; \n    }\n  }, [onSaveError, selectedDate]);\n\n  // Immediate save function\n  const save = useCallback(async (dataOverride?: Partial<JournalData>, options?: SaveOptions): Promise<string | null> => {\n    const { silent = false, navigateOnSuccess = false } = options || {};\n    \n    // Check if already saving\n    if (isSaving) {\n      logger.debug('save: Save skipped: Another save operation is in progress.');\n      return null;\n    }\n\n    // Check mounted status before proceeding\n    if (!isMounted.current || isNavigatingRef.current) {\n      logger.warn('save: Save aborted: Component unmounting or navigation in progress');\n      return null;\n    }\n    \n    logger.info(`save: Starting ${silent ? 'silent' : 'manual'} save operation...`);\n    \n    setIsSaving(true);\n    setError(null);\n    let savedId: string | null = null;\n    \n    try {\n      // Merge current data with any overrides\n      const currentData = currentDataRef.current;\n      const finalData: JournalData = {\n        ...currentData,\n        ...dataOverride,\n      };\n      \n      // Perform the save operation\n      savedId = await performSave(finalData);\n      logger.info(`save: performSave completed. Result ID: ${savedId}.`);\n      \n      // Handle success callbacks only if component is still mounted\n      if (isMounted.current && !isNavigatingRef.current) {\n        if (savedId !== null) {\n          setJournalId(savedId);\n          \n          // Only trigger navigation callback for non-silent saves\n          if (!silent && navigateOnSuccess && onSaveComplete) {\n            logger.info('save: Triggering navigation callback.');\n            onSaveComplete(savedId);\n          } else {\n            logger.info(`save: Success (${silent ? 'silent' : 'manual'}) - no navigation.`);\n          }\n        }\n      }\n      \n      return savedId;\n    } catch (err) {\n      logger.error('save: Save operation failed:', err);\n      \n      // Only trigger error callback for non-silent saves\n      if (!silent && isMounted.current && !isNavigatingRef.current && onSaveError) {\n        const error = err instanceof Error ? err : new Error('Error saving journal entry');\n        setError(error);\n        onSaveError(error);\n      } else if (silent) {\n        logger.info('save: Silent save failed - no error callback triggered.');\n      }\n      \n      return null;\n    } finally {\n      // Ensure isSaving is set to false only if the component is still mounted\n      if (isMounted.current) {\n        setIsSaving(false);\n      }\n    }\n  }, [performSave, isSaving, onSaveComplete, onSaveError]);\n\n  // Add a comprehensive unmount cleanup at the end of the hook, after all functions are defined\n  useEffect(() => {\n    return () => {\n      // This will run when the component unmounts\n      logger.info('Final cleanup on unmount');\n      \n      // Ensure we're marked as unmounted and navigating\n      isMounted.current = false;\n      isNavigatingRef.current = true;\n    };\n  }, []);\n\n  return {\n    journalId,\n    isSaving,\n    save,\n    error,\n  };\n};\n\nexport default useJournalEntry; ","import React, { useState, useEffect, useRef, useCallback, useMemo } from 'react';\nimport {\n  View,\n  StyleSheet,\n  Text,\n  TouchableOpacity,\n  KeyboardAvoidingView,\n  Platform,\n  ActivityIndicator,\n  Alert,\n} from 'react-native';\nimport { useNavigation, useRoute, RouteProp, useIsFocused } from '@react-navigation/native';\nimport { StackNavigationProp } from '@react-navigation/stack';\nimport { Ionicons } from '@expo/vector-icons';\n\n// Types\nimport { MainStackParamList, RecordScreenParams } from '../../navigation/types'; // Removed RootStackParamList\n\n// Components\nimport AudioRecorder from '../../components/AudioRecorder';\nimport { SecretTagFloatingIndicator } from '../../components/SecretTagIndicator';\nimport { areSecretTagsEnabled } from '../../config/featureFlags';\n\n// Hooks\nimport useJournalEntry from '../../hooks/useJournalEntry'; // Removed JournalData import as it's implicitly used\nimport { getLanguageName } from '../../config/languageConfig';\nimport { useHiddenMode } from '../../contexts/HiddenModeContext';\nimport { useSettings } from '../../contexts/SettingsContext';\nimport { tagManager } from '../../services/tagManager';\nimport { SecretTagV2 } from '../../services/secretTagOnlineManager';\n\n// Utils\nimport logger from '../../utils/logger';\nimport { useAppTheme } from '../../contexts/ThemeContext';\nimport { AppTheme } from '../../config/theme';\nimport { JournalAPI } from '../../services/api';\n\n// --- Special Tag for Hidden Entries (Client-Side) ---\nconst HIDDEN_ENTRY_TAG = \"_hidden_entry\";\n// ----------------------------------------------------\n\n// Type definitions for navigation and route\ntype RecordScreenRouteProp = RouteProp<MainStackParamList, 'Record'>;\ntype RecordScreenNavigationProp = StackNavigationProp<MainStackParamList, 'Record'>;\n\nconst RecordScreen: React.FC = () => {\n  logger.info('RecordScreen instance created/rendered.');\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n  const navigation = useNavigation<RecordScreenNavigationProp>();\n  const route = useRoute<RecordScreenRouteProp>();\n  const { isHiddenMode } = useHiddenMode();\n  const { settings } = useSettings();\n  \n  // Use the Auto Recording setting instead of route parameter\n  const startRecordingOnMount = settings.autoRecordingEnabled;\n  \n  // Log the auto-recording behavior\n  useEffect(() => {\n    if (startRecordingOnMount) {\n      logger.info('[RecordScreen] Auto-recording is enabled - recording will start automatically');\n    } else {\n      logger.info('[RecordScreen] Auto-recording is disabled - user must manually start recording');\n    }\n  }, [startRecordingOnMount]);\n  const selectedDate = route.params?.selectedDate; // Get selectedDate from route params\n  const journalId = route.params?.journalId; // Get journalId for appending to existing entry\n  const vibeEmoji = route.params?.vibeEmoji; // Get vibe emoji\n  const vibeTag = route.params?.vibeTag; // Get vibe tag\n  \n  // Log if using a custom date or vibe parameters\n  useEffect(() => {\n    if (selectedDate) {\n      logger.info(`[RecordScreen] Using selected date from calendar: ${selectedDate}`);\n    } else {\n      logger.info('[RecordScreen] Using current date for new entry');\n    }\n    \n    if (journalId) {\n      logger.info(`[RecordScreen] Appending to existing entry: ${journalId}`);\n    } else {\n      logger.info('[RecordScreen] Creating new entry');\n    }\n    \n    if (vibeEmoji && vibeTag) {\n      logger.info(`[RecordScreen] Vibe check-in: ${vibeEmoji} (tag: ${vibeTag})`);\n    }\n  }, [selectedDate, journalId, vibeEmoji, vibeTag]);\n\n  // UI states\n  const [isLoading, setIsLoading] = useState(false);\n  const [showRecorder, setShowRecorder] = useState(true); // Start with recorder visible\n  const [hasStartedSaving, setHasStartedSaving] = useState(false);\n  const [activeTags, setActiveTags] = useState<SecretTagV2[]>([]);\n  const [recorderState, setRecorderState] = useState('idle');\n  \n  // Data states for saving the entry\n  const [title, setTitle] = useState('');\n  const [content, setContent] = useState('');\n  const [originalContent, setOriginalContent] = useState(''); // Preserve original content for editing mode\n  const [tags, setTags] = useState<string[]>(vibeTag ? [vibeTag] : ['journal']);\n  const [audioUri, setAudioUri] = useState<string | null>(null);\n  const [isLoadingExistingEntry, setIsLoadingExistingEntry] = useState(false);\n  \n  // Load existing entry data if journalId is provided\n  useEffect(() => {\n    if (journalId) {\n             const loadExistingEntry = async () => {\n         try {\n           setIsLoadingExistingEntry(true);\n           const response = await JournalAPI.getEntry(parseInt(journalId));\n           const entry = response.data;\n           \n           logger.info(`[RecordScreen] Loaded existing entry for appending: ${entry.title}`);\n           setTitle(entry.title || '');\n           const entryContent = entry.content || '';\n           setContent(entryContent);\n           setOriginalContent(entryContent); // Store original content separately\n           setTags(entry.tags?.map((tag: any) => tag.name) || ['journal']);\n           setAudioUri(entry.audio_url);\n         } catch (error) {\n           logger.error(`[RecordScreen] Failed to load existing entry ${journalId}:`, error);\n           // Continue with empty data if loading fails\n         } finally {\n           setIsLoadingExistingEntry(false);\n         }\n       };\n      \n      loadExistingEntry();\n    }\n  }, [journalId]);\n  \n  const mountedRef = useRef(true);\n\n  const {\n    isSaving,\n    save,\n  } = useJournalEntry(\n    useMemo(() => {\n      let currentTags = tags;\n      if (isHiddenMode && !currentTags.includes(HIDDEN_ENTRY_TAG)) {\n        currentTags = [...currentTags, HIDDEN_ENTRY_TAG];\n      } else if (!isHiddenMode && currentTags.includes(HIDDEN_ENTRY_TAG)) {\n        currentTags = currentTags.filter(t => t !== HIDDEN_ENTRY_TAG);\n      }\n      return {\n        id: journalId || null, // Use existing entry ID if provided\n        title,\n        content,\n        tags: currentTags,\n        audioUri,\n      };\n    }, [title, content, tags, audioUri, isHiddenMode]),\n    {\n      selectedDate: selectedDate, // Pass selectedDate from route params\n      onSaveComplete: useCallback((savedId: string | null) => {\n        if (!mountedRef.current) {\n          logger.debug('[RecordScreen] onSaveComplete: Aborted (unmounted).');\n          return;\n        }\n        if (savedId) {\n          logger.info(`[RecordScreen] Save successful (ID: ${savedId}). Navigating back.`);\n        } else {\n          logger.warn('[RecordScreen] Save completed but no ID received. Navigating back anyway.');\n        }\n        \n        // If we were appending to an existing entry, go back to the detail screen\n        // Otherwise just go back to the previous screen\n        if (navigation.canGoBack()) {\n          navigation.goBack();\n        }\n      }, [navigation]),\n      onSaveError: useCallback((error: Error) => {\n        if (!mountedRef.current) {\n          logger.debug('[RecordScreen] onSaveError: Aborted (unmounted).');\n          return;\n        }\n        logger.error('[RecordScreen] Save failed:', error);\n        Alert.alert('Save Failed', 'Could not save the recording. Please try again.', [\n          { text: 'OK', onPress: () => {\n            if (navigation.canGoBack()) {\n              navigation.goBack();\n            }\n          } }\n        ]);\n      }, [navigation])\n    }\n  );\n\n  useEffect(() => {\n    mountedRef.current = true;\n    return () => {\n      mountedRef.current = false;\n    };\n  }, []);\n\n  // Load active secret tags\n  useEffect(() => {\n    if (!areSecretTagsEnabled()) {\n      setActiveTags([]);\n      return;\n    }\n    const loadActiveTags = async () => {\n      try {\n        const activeTagsList = await tagManager.getActiveSecretTags();\n        setActiveTags(activeTagsList);\n      } catch (error) {\n        logger.error('Failed to load active secret tags:', error);\n      }\n    };\n\n    loadActiveTags();\n  }, []);\n\n  const handleTranscriptionComplete = useCallback((finalTranscript: string) => {\n    // This logic is being disabled to prevent race conditions with manual saves.\n    // The save operation will now only be triggered by the user pressing the save button.\n    logger.info('[RecordScreen] Transcription completed, but auto-save is disabled.');\n    // logger.log('[RecordScreen] Transcription completed. Preparing to save...');\n    // setSaveData({\n    //   content: finalTranscript,\n    //   options: { silent: false, navigate: true },\n    // });\n  }, []);\n\n  // Handle manual save from AudioRecorder\n  const handleManualSave = useCallback(async (newTranscript: string, finalAudioUri?: string) => {\n    if (!mountedRef.current || isSaving) return;\n    \n    logger.info('[RecordScreen] Manual save triggered.');\n    \n    // Combine existing content with new transcript\n    const finalContent = journalId && originalContent \n      ? originalContent + '\\n\\n' + newTranscript \n      : newTranscript;\n    \n    // Only set title if it's empty (don't override existing titles)\n    let finalTitle = title;\n    if (newTranscript && !title) {\n      const words = newTranscript.split(' ');\n      const baseTitle = words.slice(0, 5).join(' ') + (words.length > 5 ? '...' : '');\n      // Add vibe emoji prefix if this is a vibe check-in\n      finalTitle = vibeEmoji ? `${vibeEmoji} ${baseTitle}` : baseTitle;\n      setTitle(finalTitle);\n    }\n    \n    // Update content state for UI consistency\n    setContent(finalContent);\n    if (finalAudioUri) setAudioUri(finalAudioUri);\n    \n    setHasStartedSaving(true);\n    \n    try {\n      // Pass the content explicitly to save function instead of relying on state\n      await save({\n        content: finalContent,\n        title: finalTitle,\n      });\n    } catch (error) {\n      logger.error('[RecordScreen] Manual save failed:', error);\n    }\n  }, [save, title, isSaving, journalId, originalContent]);\n\n  // Handle save with complete edited text (for editing mode)\n  const handleSaveWithCompleteText = useCallback(async (completeText: string) => {\n    if (!mountedRef.current || isSaving) return;\n    \n    logger.info('[RecordScreen] Save with complete text triggered.');\n    \n    // Only set title if it's empty (don't override existing titles)\n    let finalTitle = title;\n    if (completeText && !title) {\n      const words = completeText.split(' ');\n      const baseTitle = words.slice(0, 5).join(' ') + (words.length > 5 ? '...' : '');\n      // Generate clean title without vibe prefix\n      finalTitle = baseTitle;\n      setTitle(finalTitle);\n    }\n    \n    setHasStartedSaving(true);\n    \n    try {\n      // Pass the complete text directly to save function instead of relying on state\n      await save({\n        content: completeText,\n        title: finalTitle,\n      });\n    } catch (error) {\n      logger.error('[RecordScreen] Save with complete text failed:', error);\n    }\n  }, [save, title, isSaving]);\n\n  const handleRecorderCancel = useCallback(() => {\n    if (!mountedRef.current) {\n      logger.debug('[RecordScreen] handleRecorderCancel: Aborted (unmounted).');\n      return;\n    }\n    logger.info('[RecordScreen] Recording cancelled.');\n    if (navigation.canGoBack()) {\n      navigation.goBack();\n    }\n  }, [navigation]);\n\n  // Handle close button press\n  const handleClose = useCallback(() => {\n    if (!mountedRef.current) {\n      logger.debug('[RecordScreen] handleClose: Aborted (unmounted).');\n      return;\n    }\n    logger.info('[RecordScreen] Close button pressed.');\n    if (navigation.canGoBack()) {\n      navigation.goBack();\n    }\n  }, [navigation]);\n\n  // Handle auto-save from AudioRecorder\n  const handleAutoSave = useCallback(async (currentTranscript: string) => {\n    if (!mountedRef.current) {\n      logger.debug('[RecordScreen] handleAutoSave: Aborted (unmounted).');\n      return;\n    }\n    logger.info('[RecordScreen] Auto-save triggered by new segment.');\n    \n    // Auto-generate title from the first few words if not already set\n    let newTitle = title;\n    if (!title && currentTranscript) {\n      const words = currentTranscript.split(' ');\n      const baseTitle = words.slice(0, 5).join(' ') + (words.length > 5 ? '...' : '');\n      // Generate clean title without vibe prefix\n      const generatedTitle = baseTitle;\n      newTitle = generatedTitle;\n      setTitle(generatedTitle);\n    }\n    \n    // For auto-save, determine the complete content to save\n    let contentToSave;\n    if (journalId && originalContent) {\n      // For existing entries, combine original content with new transcript\n      contentToSave = `${originalContent}\\n\\n${currentTranscript}`;\n    } else {\n      // For new entries, just use the current transcript\n      contentToSave = currentTranscript;\n      // DON'T update content state for new entries to avoid duplication in display\n      // The UI will show transcriptSegments, and auto-save works silently\n    }\n    \n    // Prepare data for save\n    const saveData = {\n      title: newTitle,\n      content: contentToSave,\n    };\n    \n    // Use new save function with explicit data and silent mode\n    try {\n      const savedId = await save(saveData, { \n        silent: true // Silent save - no navigation or error dialogs\n      });\n      \n      if (savedId) {\n        logger.info(`[RecordScreen] Auto-save successful. Entry ID: ${savedId}`);\n        // For new entries, update the journalId so subsequent saves are updates\n        if (!journalId) {\n          // This is now an existing entry for future operations\n          // But don't set originalContent to avoid affecting the display\n        }\n      } else {\n        logger.warn('[RecordScreen] Auto-save completed but no ID returned.');\n      }\n    } catch (error) {\n      logger.error('[RecordScreen] Auto-save failed:', error);\n    }\n  }, [save, title, journalId, originalContent]);\n\n  // Determine save button state\n  const getSaveButtonState = useCallback(() => {\n    if (isSaving) {\n      return { text: 'Saving...', disabled: true, isSaving: true };\n    }\n    if (hasStartedSaving && !isSaving) {\n      return { text: 'Saved', disabled: true, isSaving: false };\n    }\n    return { text: 'Save', disabled: false, isSaving: false };\n  }, [isSaving, hasStartedSaving]);\n\n  const handleCommandDetected = useCallback(() => {\n    logger.info('[RecordScreen] Secret tag command detected. Navigating back.');\n    navigation.goBack();\n  }, [navigation]);\n\n  if (isLoading && !showRecorder) { // Show loading only if recorder isn't active yet\n    return (\n      <View style={styles.container}>\n        <View style={styles.modalOverlay} />\n        <View style={styles.recorderContainer}>\n          {/* Modal Header */}\n          <View style={styles.modalHeader}>\n            <View style={styles.modalHandle} />\n            <TouchableOpacity\n              style={styles.closeButton}\n              onPress={handleClose}\n              hitSlop={{ top: 10, bottom: 10, left: 10, right: 10 }}\n            >\n              <Ionicons\n                name=\"close\"\n                size={24}\n                color={theme.colors.textSecondary}\n              />\n            </TouchableOpacity>\n          </View>\n          <View style={styles.loadingContainer}>\n            <ActivityIndicator size=\"large\" color={theme.colors.primary} />\n            <Text style={styles.loadingText}>Loading Recorder...</Text>\n          </View>\n        </View>\n      </View>\n    );\n  }\n  \n  return (\n    <View style={styles.container}> \n      {/* Modal overlay background - only show if this is a new entry (not appending) */}\n      {!journalId && <View style={styles.modalOverlay} />}\n      \n      <View style={styles.contentContainer}>\n        {showRecorder ? (\n          <View style={styles.recorderContainer}>\n            {/* Modal Header with Drag Handle and Close Button */}\n            <View style={styles.modalHeader}>\n              {!journalId && <View style={styles.modalHandle} />}\n              {journalId && (\n                <Text style={styles.headerTitle}>\n                  Add to Entry\n                </Text>\n              )}\n              <TouchableOpacity\n                style={styles.closeButton}\n                onPress={handleClose}\n                hitSlop={{ top: 10, bottom: 10, left: 10, right: 10 }}\n              >\n                <Ionicons\n                  name={journalId ? \"arrow-back\" : \"close\"}\n                  size={24}\n                  color={theme.colors.textSecondary}\n                />\n              </TouchableOpacity>\n            </View>\n\n            {/* Audio Recorder Content */}\n            <View style={styles.recorderContent}>\n              <AudioRecorder\n                onTranscriptionComplete={handleTranscriptionComplete}\n                onCancel={handleRecorderCancel}\n                onManualSave={handleManualSave}\n                onAutoSave={handleAutoSave}\n                saveButtonState={getSaveButtonState()}\n                startRecordingOnMount={startRecordingOnMount}\n                onCommandDetected={handleCommandDetected}\n                existingContent={originalContent || content}\n                onSaveWithCompleteText={handleSaveWithCompleteText}\n              />\n              \n              {/* Secret Tag Floating Indicator */}\n              {areSecretTagsEnabled() && (\n                <SecretTagFloatingIndicator\n                  activeTags={activeTags}\n                  onPress={() => navigation.navigate('TagManagement')}\n                />\n              )}\n            </View>\n          </View>\n        ) : (\n          <View style={styles.recorderContainer}>\n            {/* Modal Header */}\n            <View style={styles.modalHeader}>\n              <View style={styles.modalHandle} />\n              <TouchableOpacity\n                style={styles.closeButton}\n                onPress={handleClose}\n                hitSlop={{ top: 10, bottom: 10, left: 10, right: 10 }}\n              >\n                <Ionicons\n                  name=\"close\"\n                  size={24}\n                  color={theme.colors.textSecondary}\n                />\n              </TouchableOpacity>\n            </View>\n            <View style={styles.loadingContainer}>\n              <ActivityIndicator size=\"large\" color={theme.colors.primary} />\n              <Text style={styles.loadingText}>Processing Recording...</Text>\n            </View>\n          </View>\n        )}\n      </View>\n\n      {isSaving && (\n        <View style={styles.savingOverlay}> \n          <ActivityIndicator size=\"large\" color={theme.colors.primary} />\n          <Text style={styles.loadingText}>\n            Saving Entry...\n          </Text>\n        </View>\n      )}\n    </View>\n  );\n};\n\nconst getStyles = (theme: AppTheme) => StyleSheet.create({\n  container: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  modalOverlay: {\n    ...StyleSheet.absoluteFillObject,\n    backgroundColor: 'rgba(0, 0, 0, 0.4)',\n    zIndex: 1,\n  },\n  contentContainer: {\n    flex: 1,\n    width: '100%',\n    zIndex: 2,\n  },\n  recorderContainer: {\n    flex: 1,\n    width: '100%',\n    backgroundColor: theme.colors.background,\n  },\n  modalHeader: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    paddingHorizontal: theme.spacing.lg,\n    paddingTop: Platform.OS === 'ios' ? 60 : theme.spacing.xl, // Account for status bar\n    paddingBottom: theme.spacing.sm,\n    borderBottomWidth: 1,\n    borderBottomColor: theme.colors.border,\n    backgroundColor: theme.colors.background,\n  },\n  modalHandle: {\n    width: 40,\n    height: 4,\n    backgroundColor: theme.colors.border,\n    borderRadius: 2,\n    position: 'absolute',\n    top: Platform.OS === 'ios' ? 50 : theme.spacing.md,\n    left: '50%',\n    marginLeft: -20,\n  },\n  closeButton: {\n    width: 40,\n    height: 40,\n    borderRadius: 20,\n    backgroundColor: theme.colors.card,\n    justifyContent: 'center',\n    alignItems: 'center',\n    marginLeft: 'auto',\n    ...theme.shadows.sm,\n  },\n  recorderContent: {\n    flex: 1,\n  },\n  loadingContainer: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n    paddingVertical: theme.spacing.xl,\n  },\n  savingOverlay: {\n    ...StyleSheet.absoluteFillObject,\n    backgroundColor: 'rgba(0, 0, 0, 0.7)',\n    justifyContent: 'center',\n    alignItems: 'center',\n    zIndex: 3,\n  },\n  loadingText: {\n    marginTop: theme.spacing.md,\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  headerTitle: {\n    fontSize: theme.typography.fontSizes.lg,\n    fontWeight: '600',\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n});\n\nexport default RecordScreen; ","/**\n * OPAQUE Tag Indicator Component\n * \n * Visual indicator for OPAQUE-based secret tags showing security level,\n * session status, and authentication method.\n */\n\nimport React from 'react';\nimport { View, Text, TouchableOpacity, StyleSheet } from 'react-native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { useAppTheme } from '../contexts/ThemeContext';\nimport { AppTheme } from '../config/theme';\nimport { OpaqueTagIndicatorProps } from '../types/opaqueTypes';\nimport { areSecretTagsEnabled } from '../config/featureFlags';\n\nconst OpaqueTagIndicator: React.FC<OpaqueTagIndicatorProps> = ({\n  tag,\n  showSession = true,\n  showSecurityLevel = true,\n  onSessionToggle,\n  size = 'medium'\n}) => {\n  if (!areSecretTagsEnabled()) {\n    return null;\n  }\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme, size);\n\n  // Get security level color and icon\n  const getSecurityLevelInfo = () => {\n    switch (tag.security_level) {\n      case 'enhanced':\n        return {\n          color: '#00C851', // Green\n          icon: 'shield-checkmark' as const,\n          label: 'Enhanced'\n        };\n      case 'standard':\n        return {\n          color: '#007AFF', // Blue\n          icon: 'shield' as const,\n          label: 'Standard'\n        };\n      case 'legacy':\n        return {\n          color: '#FF9500', // Orange\n          icon: 'shield-outline' as const,\n          label: 'Legacy'\n        };\n      default:\n        return {\n          color: '#8E8E93', // Gray\n          icon: 'shield-outline' as const,\n          label: 'Unknown'\n        };\n    }\n  };\n\n  // Get authentication method info\n  const getAuthMethodInfo = () => {\n    switch (tag.auth_method) {\n      case 'opaque':\n        return {\n          color: '#00C851', // Green\n          icon: 'key' as const,\n          label: 'OPAQUE'\n        };\n      case 'legacy':\n        return {\n          color: '#FF9500', // Orange\n          icon: 'key-outline' as const,\n          label: 'Legacy'\n        };\n      default:\n        return {\n          color: '#8E8E93', // Gray\n          icon: 'key-outline' as const,\n          label: 'Unknown'\n        };\n    }\n  };\n\n  const securityInfo = getSecurityLevelInfo();\n  const authInfo = getAuthMethodInfo();\n\n  return (\n    <View style={styles.container}>\n      {/* Security Level Indicator */}\n      {showSecurityLevel && (\n        <View style={styles.indicatorGroup}>\n          <View style={[styles.indicator, { backgroundColor: securityInfo.color + '20' }]}>\n            <Ionicons \n              name={securityInfo.icon} \n              size={size === 'small' ? 12 : size === 'large' ? 18 : 14}\n              color={securityInfo.color}\n            />\n            {size !== 'small' && (\n              <Text style={[styles.indicatorText, { color: securityInfo.color }]}>\n                {securityInfo.label}\n              </Text>\n            )}\n          </View>\n        </View>\n      )}\n\n      {/* Authentication Method Indicator */}\n      <View style={styles.indicatorGroup}>\n        <View style={[styles.indicator, { backgroundColor: authInfo.color + '20' }]}>\n          <Ionicons \n            name={authInfo.icon} \n            size={size === 'small' ? 12 : size === 'large' ? 18 : 14}\n            color={authInfo.color}\n          />\n          {size !== 'small' && (\n            <Text style={[styles.indicatorText, { color: authInfo.color }]}>\n              {authInfo.label}\n            </Text>\n          )}\n        </View>\n      </View>\n\n      {/* Session Status Indicator */}\n      {showSession && onSessionToggle && (\n        <TouchableOpacity \n          style={styles.sessionToggle}\n          onPress={() => onSessionToggle(tag.id)}\n          accessibilityLabel=\"Toggle session status\"\n          accessibilityRole=\"button\"\n        >\n          <View style={[styles.indicator, { backgroundColor: theme.colors.primary + '20' }]}>\n            <Ionicons \n              name=\"time\" \n              size={size === 'small' ? 12 : size === 'large' ? 18 : 14}\n              color={theme.colors.primary}\n            />\n            {size !== 'small' && (\n              <Text style={[styles.indicatorText, { color: theme.colors.primary }]}>\n                Session\n              </Text>\n            )}\n          </View>\n        </TouchableOpacity>\n      )}\n\n      {/* Device Binding Indicator */}\n      {tag.device_fingerprint && (\n        <View style={styles.indicatorGroup}>\n          <View style={[styles.indicator, { backgroundColor: '#00C851' + '20' }]}>\n            <Ionicons \n              name=\"phone-portrait\" \n              size={size === 'small' ? 12 : size === 'large' ? 18 : 14}\n              color=\"#00C851\"\n            />\n            {size === 'large' && (\n              <Text style={[styles.indicatorText, { color: '#00C851' }]}>\n                Device Bound\n              </Text>\n            )}\n          </View>\n        </View>\n      )}\n\n      {/* Migration Indicator */}\n      {tag.migrated_from && (\n        <View style={styles.indicatorGroup}>\n          <View style={[styles.indicator, { backgroundColor: '#FF9500' + '20' }]}>\n            <Ionicons \n              name=\"refresh\" \n              size={size === 'small' ? 12 : size === 'large' ? 18 : 14}\n              color=\"#FF9500\"\n            />\n            {size === 'large' && (\n              <Text style={[styles.indicatorText, { color: '#FF9500' }]}>\n                Migrated\n              </Text>\n            )}\n          </View>\n        </View>\n      )}\n    </View>\n  );\n};\n\nconst getStyles = (theme: AppTheme, size: 'small' | 'medium' | 'large') => {\n  const padding = size === 'small' ? 4 : size === 'large' ? 8 : 6;\n  const fontSize = size === 'small' ? 10 : size === 'large' ? 12 : 11;\n  const spacing = size === 'small' ? 4 : size === 'large' ? 8 : 6;\n\n  return StyleSheet.create({\n    container: {\n      flexDirection: 'row',\n      alignItems: 'center',\n      flexWrap: 'wrap',\n      gap: spacing,\n    },\n    indicatorGroup: {\n      flexDirection: 'row',\n      alignItems: 'center',\n    },\n    indicator: {\n      flexDirection: 'row',\n      alignItems: 'center',\n      paddingHorizontal: padding,\n      paddingVertical: padding / 2,\n      borderRadius: 12,\n      gap: 4,\n    },\n    indicatorText: {\n      fontSize,\n      fontWeight: '500',\n      fontFamily: theme.typography.fontFamilies.medium,\n    },\n    sessionToggle: {\n      // Add touch feedback styles if needed\n    },\n  });\n};\n\nexport default OpaqueTagIndicator; ","/**\n * Secret Tag Setup Component\n * \n * Allows users to create new secret tags with custom names, phrases, and colors.\n * Enhanced to support both legacy and OPAQUE-based authentication methods.\n */\n\nimport React, { useState, useCallback } from 'react';\nimport {\n  View,\n  Text,\n  TextInput,\n  TouchableOpacity,\n  StyleSheet,\n  Alert,\n  ActivityIndicator,\n  ScrollView,\n} from 'react-native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { useAppTheme } from '../contexts/ThemeContext';\nimport { AppTheme } from '../config/theme';\nimport OpaqueTagIndicator from './OpaqueTagIndicator';\nimport logger from '../utils/logger';\nimport { OpaqueSecretTag } from '../types/opaqueTypes';\nimport { api } from '../services/api';\nimport { OpaqueAuthService } from '../services/opaqueAuth';\nimport { areSecretTagsEnabled } from '../config/featureFlags';\nimport { tagManager } from '../services/tagManager';\n\ninterface SecretTagSetupProps {\n  onTagCreated?: (tagId: string) => void;\n  onCancel?: () => void;\n  existingTagNames?: string[];\n  enableOpaqueAuth?: boolean; // Feature flag for OPAQUE authentication\n}\n\nconst SecretTagSetup: React.FC<SecretTagSetupProps> = ({\n  onTagCreated,\n  onCancel,\n  existingTagNames = [],\n  enableOpaqueAuth = true,\n}) => {\n  if (!areSecretTagsEnabled()) {\n    return null;\n  }\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n  \n  const [tagName, setTagName] = useState('');\n  const [activationPhrase, setActivationPhrase] = useState('');\n  const [confirmationPhrase, setConfirmationPhrase] = useState('');\n  const [selectedColor, setSelectedColor] = useState('#007AFF');\n  const [isLoading, setIsLoading] = useState(false);\n  const [useOpaqueAuth, setUseOpaqueAuth] = useState(true);\n  const [securityLevel] = useState<'standard' | 'enhanced'>('standard'); // Always use standard - no user selection needed\n  const [showConfirmation, setShowConfirmation] = useState(false);\n  const [justCreated, setJustCreated] = useState<{ \n    tagName: string; \n    phrase: string; \n    isOpaque: boolean;\n    tag?: OpaqueSecretTag;\n  } | null>(null);\n\n  // Predefined color options\n  const colorOptions = [\n    '#007AFF', // Blue\n    '#34C759', // Green\n    '#FF9500', // Orange\n    '#FF3B30', // Red\n    '#AF52DE', // Purple\n    '#FF2D92', // Pink\n    '#5AC8FA', // Light Blue\n    '#FFCC00', // Yellow\n    '#FF6B6B', // Light Red\n    '#4ECDC4', // Teal\n    '#45B7D1', // Sky Blue\n    '#96CEB4', // Mint Green\n  ];\n\n  /**\n   * Validate tag name\n   */\n  const validateTagName = useCallback((name: string): string | null => {\n    if (!name.trim()) {\n      return 'Tag name cannot be empty';\n    }\n    \n    if (name.length < 2) {\n      return 'Tag name must be at least 2 characters';\n    }\n    \n    if (name.length > 50) {\n      return 'Tag name must be less than 50 characters';\n    }\n    \n    if (existingTagNames.some(existing => existing.toLowerCase() === name.toLowerCase())) {\n      return 'A tag with this name already exists';\n    }\n    \n    return null;\n  }, [existingTagNames]);\n\n  /**\n   * Validate activation phrase\n   */\n  const validatePhrase = useCallback((phrase: string): string | null => {\n    if (!phrase.trim()) {\n      return 'Activation phrase cannot be empty';\n    }\n    \n    if (phrase.length < 3) {\n      return 'Activation phrase must be at least 3 characters';\n    }\n    \n    if (phrase.length > 100) {\n      return 'Activation phrase must be less than 100 characters';\n    }\n    \n    // Check for common words that might be accidentally triggered\n    const commonWords = ['the', 'and', 'or', 'but', 'in', 'on', 'at', 'to', 'for', 'of', 'with', 'by'];\n    if (commonWords.includes(phrase.toLowerCase().trim())) {\n      return 'Please choose a more unique phrase to avoid accidental activation';\n    }\n    \n    return null;\n  }, []);\n\n  /**\n   * Validate phrase confirmation\n   */\n  const validateConfirmation = useCallback((phrase: string, confirmation: string): string | null => {\n    if (!confirmation.trim()) {\n      return 'Please confirm your activation phrase';\n    }\n    \n    if (phrase !== confirmation) {\n      return 'Phrases do not match';\n    }\n    \n    return null;\n  }, []);\n\n  /**\n   * Handle tag creation using OPAQUE protocol\n   */\n  const handleCreateTag = useCallback(async () => {\n    // Validate inputs\n    const nameError = validateTagName(tagName);\n    if (nameError) {\n      Alert.alert('Invalid Name', nameError);\n      return;\n    }\n\n    const phraseError = validatePhrase(activationPhrase);\n    if (phraseError) {\n      Alert.alert('Invalid Phrase', phraseError);\n      return;\n    }\n\n    // Validate confirmation phrase (required for OPAQUE tags)\n    const confirmError = validateConfirmation(activationPhrase, confirmationPhrase);\n    if (confirmError) {\n      Alert.alert('Invalid Confirmation', confirmError);\n      return;\n    }\n\n    setIsLoading(true);\n\n    try {\n      const phrase = activationPhrase.trim();\n      \n      logger.info('🚀 UPDATED CODE: Starting OPAQUE secret tag registration', { \n        tagName: tagName.trim(),\n        phraseLength: phrase.length,\n        timestamp: new Date().toISOString()\n      });\n\n      // Use the exact same OPAQUE flow as user registration\n      const opaqueAuth = OpaqueAuthService.getInstance();\n      \n      // Create a unique identifier for this secret tag registration\n      const secretTagIdentifier = `secret-tag-${tagName.trim().toLowerCase().replace(/\\s+/g, '-')}-${Date.now()}`;\n      \n      logger.info('Step 1: Starting OPAQUE registration with OpaqueAuthService');\n      \n      // Step 1: Start OPAQUE registration (same as user registration)\n      let registrationRequest;\n      try {\n        const result = await opaqueAuth.startRegistration(phrase, secretTagIdentifier);\n        registrationRequest = result.registrationRequest;\n        \n        logger.info('Step 1 Complete: OPAQUE startRegistration result', {\n          registrationRequestType: typeof registrationRequest,\n          registrationRequestLength: registrationRequest?.length,\n          registrationRequestSample: registrationRequest?.slice(0, 50),\n          registrationRequestFull: registrationRequest\n        });\n      } catch (error) {\n        logger.error('Step 1 Failed: OPAQUE startRegistration error', error);\n        throw new Error(`OPAQUE startRegistration failed: ${error instanceof Error ? error.message : String(error)}`);\n      }\n      \n      logger.info('Step 2: Sending registration request to server');\n      \n      // Debug: Log exactly what we're sending\n      const requestData = {\n        opaque_registration_request: registrationRequest,\n        tag_name: tagName.trim(),\n        color: selectedColor\n      };\n      \n      logger.info('Request data being sent to backend:', {\n        opaque_registration_request_length: registrationRequest?.length,\n        opaque_registration_request_type: typeof registrationRequest,\n        opaque_registration_request_sample: registrationRequest?.slice(0, 20),\n        tag_name: requestData.tag_name,\n        color: requestData.color\n      });\n      \n      // Step 2: Send registration request to server (secret tags endpoint)\n      const response = await api.post('/api/v1/secret-tags/register/start', requestData);\n\n      const { opaque_registration_response: registrationResponse, session_id, tag_handle } = response.data;\n      \n      if (!registrationResponse) {\n        throw new Error('Invalid server registration response');\n      }\n\n      logger.info('Step 3: Completing OPAQUE registration');\n      \n      // Step 3: Finish OPAQUE registration (same as user registration)\n      let registrationRecord;\n      try {\n        registrationRecord = await opaqueAuth.finishRegistration(secretTagIdentifier, registrationResponse);\n        \n        logger.info('Step 3 Complete: OPAQUE finishRegistration result', {\n          registrationRecordType: typeof registrationRecord,\n          registrationRecordLength: registrationRecord?.length,\n          registrationRecordSample: registrationRecord?.slice(0, 50),\n          registrationRecordFull: registrationRecord\n        });\n      } catch (error) {\n        logger.error('Step 3 Failed: OPAQUE finishRegistration error', error);\n        throw new Error(`OPAQUE finishRegistration failed: ${error instanceof Error ? error.message : String(error)}`);\n      }\n      \n      if (!registrationRecord) {\n        throw new Error('Failed to complete OPAQUE registration');\n      }\n\n      logger.info('Step 4: Creating secret tag with OPAQUE data', {\n        registrationRequestType: typeof registrationRequest,\n        registrationRequestLength: registrationRequest?.length,\n        registrationRequestValue: registrationRequest,\n        registrationRecordType: typeof registrationRecord,\n        registrationRecordLength: registrationRecord?.length,\n        registrationRecordValue: registrationRecord\n      });\n      \n      // Step 4: Generate salt (16 bytes)\n      const saltBytes = Array.from({ length: 16 }, () => Math.floor(Math.random() * 256));\n      \n      // Step 5: Register the secret tag with the OPAQUE data\n      // Add debugging to see what data we're actually sending\n      logger.info('OPAQUE data before sending to backend:', {\n        registrationRequestType: typeof registrationRequest,\n        registrationRequestLength: registrationRequest.length,\n        registrationRequestSample: registrationRequest.slice(0, 20),\n        registrationRecordType: typeof registrationRecord,\n        registrationRecordLength: registrationRecord.length,\n        registrationRecordSample: registrationRecord.slice(0, 20)\n      });\n      \n      // Test base64 validity before sending\n      logger.info('🔍 About to validate base64 data:', {\n        registrationRequestType: typeof registrationRequest,\n        registrationRequestValue: registrationRequest,\n        registrationRecordType: typeof registrationRecord,\n        registrationRecordValue: registrationRecord\n      });\n      \n      // Validate base64/base64url encoding (OPAQUE uses URL-safe base64)\n      const validateBase64 = (data: string, name: string): void => {\n        try {\n          // Try URL-safe base64 first (OPAQUE standard)\n          const urlSafeDecoded = data.replace(/-/g, '+').replace(/_/g, '/');\n          // Add padding if needed\n          const padding = urlSafeDecoded.length % 4;\n          const paddedData = padding ? urlSafeDecoded + '='.repeat(4 - padding) : urlSafeDecoded;\n          const testDecode = atob(paddedData);\n          logger.info(`✅ ${name} base64url valid (length: ${testDecode.length})`);\n        } catch (error) {\n          logger.error(`❌ ${name} base64 validation failed:`, error);\n          throw new Error(`${name} is not valid base64/base64url`);\n        }\n      };\n\n      try {\n        logger.info('🧪 Validating OPAQUE base64 data...');\n        validateBase64(registrationRequest, 'registrationRequest');\n        validateBase64(registrationRecord, 'registrationRecord');\n        logger.info('✅ All OPAQUE base64 validation passed');\n      } catch (error) {\n        logger.error('Base64 validation failed:', error);\n        throw new Error('OPAQUE data is not valid base64');\n      }\n      \n      const serverResponse = await api.post('/api/v1/secret-tags/register/finish', {\n        session_id: session_id,\n        opaque_registration_record: registrationRecord\n      });\n\n      if (!serverResponse.data) {\n        throw new Error('Invalid registration response from server');\n      }\n\n      // Step 3: Complete OPAQUE registration (if backend provides registration response)\n      // Note: For secret tags, we might not need the full two-step flow depending on backend implementation\n      // The backend should handle the OPAQUE verification internally\n      \n      const secretTag = serverResponse.data;\n      const tagId = secretTag.tag_id;\n      \n      // Convert to OpaqueSecretTag format for display\n      const createdTag: OpaqueSecretTag = {\n        id: tagId,\n        tag_name: secretTag.tag_name,\n        color_code: secretTag.color_code,\n        created_at: secretTag.created_at,\n        updated_at: secretTag.updated_at,\n        user_id: secretTag.user_id || 0,\n        auth_method: 'opaque' as const,\n        security_level: securityLevel,\n        authentication_count: 0\n      };\n      \n      logger.info('OPAQUE secret tag created successfully:', tagId);\n      \n      // Set success state with created tag info\n      setJustCreated({\n        tagName: tagName.trim(),\n        phrase,\n        isOpaque: true, // Always OPAQUE now\n        tag: createdTag\n      });\n\n      // Clear form\n      setTagName('');\n      setActivationPhrase('');\n      setConfirmationPhrase('');\n      setSelectedColor('#007AFF');\n      setShowConfirmation(false);\n\n      // Call the callback after a short delay to let user see the success message\n      setTimeout(() => {\n        onTagCreated?.(tagId);\n      }, 3000);\n      \n    } catch (error) {\n      logger.error('Failed to create secret tag:', error);\n      \n      // Log detailed error information for debugging\n      if (error && typeof error === 'object' && 'response' in error) {\n        const response = (error as any).response;\n        if (response?.data?.detail) {\n          logger.error('Backend validation error detail:', response.data.detail);\n        }\n        if (response?.data?.errors) {\n          logger.error('Backend validation errors:', response.data.errors);\n        }\n      }\n      \n      Alert.alert(\n        'Creation Failed',\n        error instanceof Error ? error.message : 'Failed to create secret tag'\n      );\n    } finally {\n      setIsLoading(false);\n    }\n  }, [\n    tagName, \n    activationPhrase, \n    confirmationPhrase,\n    selectedColor, \n    securityLevel,\n    validateTagName, \n    validatePhrase, \n    validateConfirmation,\n    onTagCreated\n  ]);\n\n  // Show success message if tag was just created\n  if (justCreated) {\n    return (\n      <View style={styles.container}>\n        <View style={styles.successContainer}>\n          <View style={styles.successIcon}>\n            <Ionicons \n              name={justCreated.isOpaque ? \"shield-checkmark\" : \"checkmark-circle\"} \n              size={64} \n              color={justCreated.isOpaque ? '#00C851' : (theme.colors.success || '#34C759')} \n            />\n          </View>\n          \n          <Text style={styles.successTitle}>\n            {justCreated.isOpaque ? 'OPAQUE Secret Tag Created!' : 'Secret Tag Created!'}\n          </Text>\n\n          {/* Show OPAQUE tag indicator if applicable */}\n          {justCreated.isOpaque && justCreated.tag && (\n            <View style={styles.opaqueIndicatorContainer}>\n              <OpaqueTagIndicator \n                tag={justCreated.tag}\n                showSession={false}\n                showSecurityLevel={true}\n                size=\"large\"\n              />\n            </View>\n          )}\n          \n          <View style={styles.successDetails}>\n            <Text style={styles.successLabel}>Tag Name:</Text>\n            <Text style={styles.successValue}>{justCreated.tagName}</Text>\n            \n            <Text style={styles.successLabel}>Activation Phrase:</Text>\n            <Text style={styles.successValue}>\"{justCreated.phrase}\"</Text>\n\n            {justCreated.isOpaque && (\n              <>\n                <Text style={styles.successLabel}>Authentication:</Text>\n                <Text style={styles.successValue}>Zero-Knowledge OPAQUE</Text>\n              </>\n            )}\n          </View>\n\n          <View style={styles.successInstructions}>\n            <Text style={styles.successInstructionText}>\n              Your tag is protected with OPAQUE zero-knowledge authentication. \n              Include your activation phrase in journal entries to automatically access encrypted content.\n            </Text>\n          </View>\n\n          {justCreated.isOpaque && (\n            <View style={styles.securityNotice}>\n              <View style={styles.securityNoticeIcon}>\n                <Ionicons name=\"warning\" size={20} color=\"#FF9500\" />\n              </View>\n              <Text style={styles.securityNoticeText}>\n                <Text style={styles.securityNoticeTextBold}>Important:</Text> This phrase cannot be recovered if forgotten. \n                Your encrypted entries will be permanently inaccessible without it.\n              </Text>\n            </View>\n          )}\n\n          <TouchableOpacity \n            style={styles.continueButton}\n            onPress={() => {\n              setJustCreated(null);\n              onTagCreated?.(justCreated.tagName);\n            }}\n          >\n            <Text style={styles.continueButtonText}>Continue</Text>\n          </TouchableOpacity>\n        </View>\n      </View>\n    );\n  }\n\n  return (\n    <ScrollView style={styles.container}>\n      <View style={styles.card}>\n        <Text style={styles.title}>Create Secret Tag</Text>\n        \n        <Text style={styles.description}>\n          Secret tags provide independent privacy levels for your journal entries.\n          Include your activation phrase in journal entries to automatically access encrypted content.\n        </Text>\n\n        {/* Security Information */}\n        <View style={styles.securityLevelContainer}>\n          <Text style={styles.securityLevelTitle}>Security Level</Text>\n          <Text style={styles.securityLevelDescription}>\n            All tags use OPAQUE zero-knowledge authentication with server-side phrase detection.\n            Neither we nor anyone else can see or recover your secret tags or entries.\n          </Text>\n          <View style={styles.securityInfoBox}>\n            <Ionicons \n              name=\"shield-checkmark\" \n              size={24} \n              color=\"#00C851\" \n            />\n            <Text style={styles.securityInfoText}>\n              Zero-Knowledge OPAQUE Authentication\n            </Text>\n          </View>\n        </View>\n\n        {/* Critical Warning Section */}\n        <View style={styles.warningContainer}>\n          <View style={styles.warningHeader}>\n            <Ionicons name=\"warning\" size={20} color={theme.colors.error} />\n            <Text style={styles.warningTitle}>\n              {useOpaqueAuth && enableOpaqueAuth \n                ? 'IMPORTANT: OPAQUE Zero-Knowledge Privacy'\n                : 'IMPORTANT: Zero-Knowledge Privacy'\n              }\n            </Text>\n          </View>\n          \n          <Text style={styles.warningText}>\n            This tag uses OPAQUE zero-knowledge authentication with server-side phrase detection.\n            Neither we nor anyone else can see or recover your secret tags or entries.\n          </Text>\n          \n          <Text style={styles.warningTextBold}>\n            If you forget your activation phrase, all entries with this tag will be permanently lost. There is no recovery method.\n          </Text>\n          \n          <Text style={styles.warningTextBold}>\n            To access encrypted entries, type your exact activation phrase in a journal entry.\n          </Text>\n          \n          <View style={styles.warningTips}>\n            <Text style={styles.warningTipTitle}>Tips for remembering phrases:</Text>\n            <View style={styles.warningTipItem}>\n              <View style={styles.warningBullet} />\n              <Text style={styles.warningTip}>Use phrases that are meaningful to you</Text>\n            </View>\n            <View style={styles.warningTipItem}>\n              <View style={styles.warningBullet} />\n              <Text style={styles.warningTip}>Consider writing them down in a secure location</Text>\n            </View>\n            <View style={styles.warningTipItem}>\n              <View style={styles.warningBullet} />\n              <Text style={styles.warningTip}>Test your phrases after creation</Text>\n            </View>\n            {useOpaqueAuth && enableOpaqueAuth && (\n              <View style={styles.warningTipItem}>\n                <View style={styles.warningBullet} />\n                <Text style={styles.warningTip}>Ensure this device remains accessible for future use</Text>\n              </View>\n            )}\n          </View>\n        </View>\n\n        {/* Tag Name Input */}\n        <View style={styles.inputContainer}>\n          <Text style={styles.label}>Tag Name</Text>\n          <TextInput\n            style={[\n              styles.input,\n              tagName && validateTagName(tagName) ? styles.inputError : styles.inputValid\n            ]}\n            value={tagName}\n            onChangeText={setTagName}\n            placeholder=\"e.g., Work Private, Personal Thoughts\"\n            autoCapitalize=\"words\"\n            autoCorrect={false}\n            maxLength={50}\n          />\n          <View style={[\n            styles.validationContainer,\n            tagName && validateTagName(tagName) ? styles.validationError : styles.validationSuccess\n          ]}>\n            <Text style={[\n              styles.validationText,\n              tagName && validateTagName(tagName) ? styles.validationTextError : styles.validationTextSuccess\n            ]}>\n              {tagName && validateTagName(tagName) ? validateTagName(tagName) : tagName ? '✓ Tag name looks good' : 'Enter a unique tag name'}\n            </Text>\n          </View>\n        </View>\n\n        {/* Activation Phrase Input */}\n        <View style={styles.inputContainer}>\n          <Text style={styles.label}>Activation Phrase</Text>\n          <TextInput\n            style={[\n              styles.input,\n              activationPhrase && validatePhrase(activationPhrase) ? styles.inputError : styles.inputValid\n            ]}\n            value={activationPhrase}\n            onChangeText={setActivationPhrase}\n            placeholder=\"e.g., activate work mode, private thoughts\"\n            autoCapitalize=\"none\"\n            autoCorrect={false}\n            maxLength={100}\n          />\n          <View style={[\n            styles.validationContainer,\n            activationPhrase && validatePhrase(activationPhrase) ? styles.validationError : styles.validationSuccess\n          ]}>\n            <Text style={[\n              styles.validationText,\n              activationPhrase && validatePhrase(activationPhrase) ? styles.validationTextError : styles.validationTextSuccess\n            ]}>\n              {activationPhrase && validatePhrase(activationPhrase) ? validatePhrase(activationPhrase) : activationPhrase ? '✓ Activation phrase looks good' : 'Enter a unique activation phrase'}\n            </Text>\n          </View>\n        </View>\n\n        {/* Confirmation Phrase Input - Only for OPAQUE */}\n        {useOpaqueAuth && enableOpaqueAuth && (\n          <View style={styles.inputContainer}>\n            <Text style={styles.label}>Confirm Activation Phrase</Text>\n            <TextInput\n              style={[\n                styles.input,\n                confirmationPhrase && validateConfirmation(activationPhrase, confirmationPhrase) ? styles.inputError : styles.inputValid\n              ]}\n              value={confirmationPhrase}\n              onChangeText={setConfirmationPhrase}\n              placeholder=\"Re-enter your activation phrase\"\n              autoCapitalize=\"none\"\n              autoCorrect={false}\n              maxLength={100}\n            />\n            <View style={[\n              styles.validationContainer,\n              confirmationPhrase && validateConfirmation(activationPhrase, confirmationPhrase) ? styles.validationError : styles.validationSuccess\n            ]}>\n              <Text style={[\n                styles.validationText,\n                confirmationPhrase && validateConfirmation(activationPhrase, confirmationPhrase) ? styles.validationTextError : styles.validationTextSuccess\n              ]}>\n                {confirmationPhrase && validateConfirmation(activationPhrase, confirmationPhrase) \n                  ? validateConfirmation(activationPhrase, confirmationPhrase) \n                  : confirmationPhrase && activationPhrase === confirmationPhrase \n                    ? '✓ Phrases match' \n                    : 'Confirm your activation phrase'\n                }\n              </Text>\n            </View>\n          </View>\n        )}\n\n        {/* Color Selection */}\n        <View style={styles.inputContainer}>\n          <Text style={styles.label}>Tag Color</Text>\n          <View style={styles.colorGrid}>\n            {colorOptions.map((color) => (\n              <TouchableOpacity\n                key={color}\n                style={[\n                  styles.colorOption,\n                  { backgroundColor: color },\n                  selectedColor === color && styles.selectedColorOption,\n                ]}\n                onPress={() => setSelectedColor(color)}\n              >\n                {selectedColor === color && (\n                  <Ionicons name=\"checkmark\" size={16} color={theme.colors.background} />\n                )}\n              </TouchableOpacity>\n            ))}\n          </View>\n        </View>\n\n        {/* Action Buttons */}\n        <View style={styles.buttonContainer}>\n          <TouchableOpacity \n            style={[styles.button, styles.cancelButton]}\n            onPress={onCancel}\n            disabled={isLoading}\n          >\n            <Text style={styles.cancelButtonText}>Cancel</Text>\n          </TouchableOpacity>\n\n          <TouchableOpacity \n            style={[styles.button, styles.createButton]}\n            onPress={handleCreateTag}\n            disabled={isLoading || !tagName || !activationPhrase}\n          >\n            {isLoading ? (\n              <ActivityIndicator color=\"#FFFFFF\" />\n            ) : (\n              <Text style={styles.buttonText}>Create Secret Tag</Text>\n            )}\n          </TouchableOpacity>\n        </View>\n      </View>\n    </ScrollView>\n  );\n};\n\nconst getStyles = (theme: AppTheme) => StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: theme.colors.background,\n  },\n  card: {\n    backgroundColor: theme.colors.card,\n    margin: theme.spacing.lg,\n    padding: theme.spacing.xl,\n    borderRadius: 12,\n    ...theme.shadows.sm,\n  },\n  title: {\n    fontSize: theme.typography.fontSizes.xl,\n    fontWeight: 'bold',\n    textAlign: 'center',\n    marginBottom: theme.spacing.lg,\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.bold,\n  },\n  description: {\n    fontSize: theme.typography.fontSizes.md,\n    lineHeight: 24,\n    textAlign: 'center',\n    marginBottom: theme.spacing.xl,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n\n  // Warning Section Styles\n  warningContainer: {\n    backgroundColor: '#FFF3CD',\n    borderColor: '#FFEAA7',\n    borderWidth: 1,\n    borderRadius: 8,\n    padding: theme.spacing.lg,\n    marginBottom: theme.spacing.xl,\n  },\n  warningHeader: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginBottom: theme.spacing.md,\n  },\n  warningTitle: {\n    fontSize: theme.typography.fontSizes.md,\n    fontWeight: 'bold',\n    color: theme.colors.error,\n    marginLeft: theme.spacing.sm,\n    fontFamily: theme.typography.fontFamilies.bold,\n  },\n  warningText: {\n    fontSize: theme.typography.fontSizes.sm,\n    color: '#856404',\n    lineHeight: 20,\n    marginBottom: theme.spacing.sm,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  warningTextBold: {\n    fontSize: theme.typography.fontSizes.sm,\n    color: '#721C24',\n    lineHeight: 20,\n    fontWeight: 'bold',\n    marginBottom: theme.spacing.md,\n    fontFamily: theme.typography.fontFamilies.bold,\n  },\n  warningTips: {\n    marginTop: theme.spacing.sm,\n  },\n  warningTipTitle: {\n    fontSize: theme.typography.fontSizes.sm,\n    fontWeight: '600',\n    color: '#856404',\n    marginBottom: theme.spacing.xs,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n  warningTip: {\n    fontSize: theme.typography.fontSizes.sm,\n    color: '#856404',\n    lineHeight: 18,\n    fontFamily: theme.typography.fontFamilies.regular,\n    flex: 1,\n  },\n  warningTipItem: {\n    marginBottom: 2,\n    flexDirection: 'row',\n    alignItems: 'flex-start',\n  },\n  warningBullet: {\n    width: 4,\n    height: 4,\n    borderRadius: 2,\n    backgroundColor: '#856404',\n    marginTop: 7,\n    marginRight: theme.spacing.xs,\n  },\n\n  // Success Screen Styles\n  successContainer: {\n    flex: 1,\n    backgroundColor: theme.colors.card,\n    margin: theme.spacing.lg,\n    padding: theme.spacing.xl,\n    borderRadius: 12,\n    alignItems: 'center',\n    justifyContent: 'center',\n    ...theme.shadows.sm,\n  },\n  successIcon: {\n    marginBottom: theme.spacing.xl,\n  },\n  successTitle: {\n    fontSize: theme.typography.fontSizes.xxl,\n    fontWeight: 'bold',\n    color: theme.colors.success || '#34C759',\n    textAlign: 'center',\n    marginBottom: theme.spacing.xl,\n    fontFamily: theme.typography.fontFamilies.bold,\n  },\n  successDetails: {\n    width: '100%',\n    marginBottom: theme.spacing.xl,\n  },\n  successLabel: {\n    fontSize: theme.typography.fontSizes.sm,\n    color: theme.colors.textSecondary,\n    fontWeight: '600',\n    marginBottom: theme.spacing.xs,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n  successValue: {\n    fontSize: theme.typography.fontSizes.lg,\n    color: theme.colors.text,\n    fontWeight: 'bold',\n    marginBottom: theme.spacing.lg,\n    fontFamily: theme.typography.fontFamilies.bold,\n  },\n  successInstructions: {\n    width: '100%',\n    marginBottom: theme.spacing.xl,\n  },\n  successInstructionText: {\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.textSecondary,\n    textAlign: 'center',\n    lineHeight: 22,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  continueButton: {\n    backgroundColor: theme.colors.primary,\n    paddingHorizontal: theme.spacing.xl,\n    paddingVertical: theme.spacing.lg,\n    borderRadius: 8,\n    minWidth: 120,\n  },\n  continueButtonText: {\n    color: theme.colors.background,\n    fontSize: theme.typography.fontSizes.md,\n    fontWeight: '600',\n    textAlign: 'center',\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n\n  // OPAQUE-specific styles\n  opaqueIndicatorContainer: {\n    marginVertical: theme.spacing.md,\n    alignItems: 'center',\n  },\n  securityNotice: {\n    flexDirection: 'row',\n    backgroundColor: '#FFF9E6',\n    padding: theme.spacing.md,\n    borderRadius: 8,\n    marginTop: theme.spacing.md,\n    borderLeftWidth: 4,\n    borderLeftColor: '#FF9500',\n  },\n  securityNoticeIcon: {\n    marginRight: theme.spacing.sm,\n    marginTop: 2,\n  },\n  securityNoticeText: {\n    flex: 1,\n    fontSize: theme.typography.fontSizes.sm,\n    color: '#8B4513',\n    lineHeight: 20,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  securityNoticeTextBold: {\n    fontWeight: '600',\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n\n  // Authentication Method styles\n  authMethodContainer: {\n    marginBottom: theme.spacing.lg,\n    backgroundColor: theme.colors.surface,\n    padding: theme.spacing.md,\n    borderRadius: 8,\n  },\n  authMethodTitle: {\n    fontSize: theme.typography.fontSizes.md,\n    fontWeight: '600',\n    marginBottom: theme.spacing.md,\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n  authMethodOption: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n  },\n  authMethodInfo: {\n    flex: 1,\n    marginRight: theme.spacing.md,\n  },\n  authMethodLabel: {\n    fontSize: theme.typography.fontSizes.md,\n    fontWeight: '500',\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.medium,\n  },\n  authMethodDescription: {\n    fontSize: theme.typography.fontSizes.sm,\n    color: theme.colors.textSecondary,\n    marginTop: 2,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n\n  // Security Level styles\n  securityLevelContainer: {\n    marginTop: theme.spacing.md,\n  },\n  securityLevelTitle: {\n    fontSize: theme.typography.fontSizes.sm,\n    fontWeight: '600',\n    marginBottom: theme.spacing.sm,\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n  securityLevelDescription: {\n    fontSize: theme.typography.fontSizes.sm,\n    color: theme.colors.textSecondary,\n    marginBottom: theme.spacing.md,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  securityInfoBox: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    padding: theme.spacing.md,\n    borderRadius: 8,\n    borderWidth: 1,\n    borderColor: '#00C851',\n    backgroundColor: '#00C851' + '10',\n  },\n  securityInfoText: {\n    marginLeft: theme.spacing.sm,\n    fontSize: theme.typography.fontSizes.md,\n    color: '#00C851',\n    fontFamily: theme.typography.fontFamilies.semiBold,\n    fontWeight: '600',\n  },\n\n  // Form Input Styles\n  inputContainer: {\n    marginBottom: theme.spacing.lg,\n  },\n  label: {\n    fontSize: theme.typography.fontSizes.md,\n    fontWeight: '600',\n    marginBottom: theme.spacing.sm,\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n  input: {\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n    borderRadius: 8,\n    padding: theme.spacing.md,\n    fontSize: theme.typography.fontSizes.md,\n    backgroundColor: theme.colors.card,\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  inputValid: {\n    borderColor: '#34C759', // Green border for valid input\n  },\n  inputError: {\n    borderColor: theme.colors.error, // Red border for invalid input\n  },\n  validationContainer: {\n    marginTop: theme.spacing.xs,\n    paddingHorizontal: theme.spacing.xs,\n    paddingVertical: 4,\n    borderRadius: 4,\n    minHeight: 20,\n  },\n  validationSuccess: {\n    backgroundColor: '#E8F5E8', // Light green background\n  },\n  validationError: {\n    backgroundColor: '#FFF2F2', // Light red background\n  },\n  validationText: {\n    fontSize: theme.typography.fontSizes.sm,\n    fontFamily: theme.typography.fontFamilies.regular,\n    lineHeight: 16,\n  },\n  validationTextSuccess: {\n    color: '#22C55E', // Green text for success\n  },\n  validationTextError: {\n    color: theme.colors.error, // Red text for errors\n  },\n  colorGrid: {\n    flexDirection: 'row',\n    flexWrap: 'wrap',\n    justifyContent: 'space-between',\n  },\n  colorOption: {\n    width: 40,\n    height: 40,\n    borderRadius: 20,\n    marginBottom: theme.spacing.sm,\n    justifyContent: 'center',\n    alignItems: 'center',\n    borderWidth: 2,\n    borderColor: 'transparent',\n  },\n  selectedColorOption: {\n    borderColor: theme.colors.text,\n    borderWidth: 3,\n  },\n\n  buttonContainer: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    marginBottom: theme.spacing.lg,\n  },\n  button: {\n    flex: 1,\n    padding: theme.spacing.lg,\n    borderRadius: 8,\n    alignItems: 'center',\n    marginHorizontal: theme.spacing.sm,\n  },\n  createButton: {\n    backgroundColor: theme.colors.primary,\n  },\n  cancelButton: {\n    backgroundColor: 'transparent',\n    borderWidth: 1,\n    borderColor: theme.colors.textSecondary,\n  },\n  buttonText: {\n    color: theme.colors.background,\n    fontSize: theme.typography.fontSizes.md,\n    fontWeight: '600',\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n  cancelButtonText: {\n    color: theme.colors.textSecondary,\n    fontSize: theme.typography.fontSizes.md,\n    fontWeight: '600',\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n});\n\nexport default SecretTagSetup; ","/**\n * Regular Tag Create Component\n * \n * Simple modal for creating regular tags with name and color selection.\n * Works cross-platform (web, iOS, Android).\n */\n\nimport React, { useState, useCallback } from 'react';\nimport {\n  View,\n  Text,\n  TextInput,\n  TouchableOpacity,\n  StyleSheet,\n  Alert,\n  ActivityIndicator,\n  ScrollView,\n} from 'react-native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { useAppTheme } from '../contexts/ThemeContext';\nimport { AppTheme } from '../config/theme';\nimport { TagsAPI } from '../services/api';\nimport logger from '../utils/logger';\nimport { Tag } from '../types';\n\ninterface RegularTagCreateProps {\n  onTagCreated?: (tag: Tag) => void;\n  onCancel?: () => void;\n  existingTagNames?: string[];\n}\n\nconst RegularTagCreate: React.FC<RegularTagCreateProps> = ({\n  onTagCreated,\n  onCancel,\n  existingTagNames = [],\n}) => {\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n  \n  const [tagName, setTagName] = useState('');\n  const [selectedColor, setSelectedColor] = useState('#007AFF');\n  const [isLoading, setIsLoading] = useState(false);\n\n  // Predefined color options\n  const colorOptions = [\n    '#007AFF', // Blue\n    '#34C759', // Green\n    '#FF9500', // Orange\n    '#FF3B30', // Red\n    '#AF52DE', // Purple\n    '#FF2D92', // Pink\n    '#5AC8FA', // Light Blue\n    '#FFCC00', // Yellow\n    '#FF6B6B', // Light Red\n    '#4ECDC4', // Teal\n    '#45B7D1', // Sky Blue\n    '#96CEB4', // Mint Green\n  ];\n\n  /**\n   * Validate tag name\n   */\n  const validateTagName = useCallback((name: string): string | null => {\n    if (!name.trim()) {\n      return 'Tag name cannot be empty';\n    }\n    \n    if (name.length < 2) {\n      return 'Tag name must be at least 2 characters';\n    }\n    \n    if (name.length > 50) {\n      return 'Tag name must be less than 50 characters';\n    }\n    \n    if (existingTagNames.some(existing => existing.toLowerCase() === name.toLowerCase())) {\n      return 'A tag with this name already exists';\n    }\n    \n    return null;\n  }, [existingTagNames]);\n\n  /**\n   * Handle tag creation\n   */\n  const handleCreateTag = useCallback(async () => {\n    // Validate inputs\n    const nameError = validateTagName(tagName);\n    if (nameError) {\n      Alert.alert('Invalid Name', nameError);\n      return;\n    }\n\n    setIsLoading(true);\n\n    try {\n      // Create tag via API\n      const newTag = await TagsAPI.createTag({\n        name: tagName.trim(),\n        color: selectedColor\n      });\n\n      logger.info('Regular tag created:', newTag);\n      onTagCreated?.(newTag);\n      \n      // Clear form\n      setTagName('');\n      setSelectedColor('#007AFF');\n      \n    } catch (error) {\n      logger.error('Failed to create regular tag:', error);\n      Alert.alert(\n        'Creation Failed',\n        error instanceof Error ? error.message : 'Failed to create tag'\n      );\n    } finally {\n      setIsLoading(false);\n    }\n  }, [tagName, selectedColor, validateTagName, onTagCreated]);\n\n  const canCreate = tagName.trim() && !isLoading;\n\n  return (\n    <View style={styles.container}>\n      <ScrollView style={styles.content} keyboardShouldPersistTaps=\"handled\">\n        {/* Header */}\n        <View style={styles.header}>\n          <Text style={styles.title}>Create Regular Tag</Text>\n          <Text style={styles.subtitle}>\n            Regular tags help organize your journal entries\n          </Text>\n        </View>\n\n        {/* Tag Name Input */}\n        <View style={styles.inputContainer}>\n          <Text style={styles.label}>Tag Name</Text>\n          <TextInput\n            style={styles.input}\n            value={tagName}\n            onChangeText={setTagName}\n            placeholder=\"e.g., Work, Personal, Travel\"\n            placeholderTextColor={theme.colors.textSecondary}\n            maxLength={50}\n            autoCapitalize=\"words\"\n            autoCorrect={false}\n            autoFocus={true}\n          />\n        </View>\n\n        {/* Color Selection */}\n        <View style={styles.inputContainer}>\n          <Text style={styles.label}>Tag Color</Text>\n          <View style={styles.colorGrid}>\n            {colorOptions.map((color) => (\n              <TouchableOpacity\n                key={color}\n                style={[\n                  styles.colorOption,\n                  { backgroundColor: color },\n                  selectedColor === color && styles.selectedColorOption,\n                ]}\n                onPress={() => setSelectedColor(color)}\n              >\n                {selectedColor === color && (\n                  <Ionicons name=\"checkmark\" size={16} color=\"white\" />\n                )}\n              </TouchableOpacity>\n            ))}\n          </View>\n        </View>\n\n        {/* Preview */}\n        <View style={styles.previewContainer}>\n          <Text style={styles.label}>Preview</Text>\n          <View style={styles.tagPreview}>\n            <View style={[styles.tagColorIndicator, { backgroundColor: selectedColor }]} />\n            <Text style={styles.tagPreviewText}>{tagName || 'Your tag name'}</Text>\n          </View>\n        </View>\n      </ScrollView>\n\n      {/* Action Buttons */}\n      <View style={styles.buttonContainer}>\n        <TouchableOpacity \n          style={[styles.button, styles.cancelButton]}\n          onPress={onCancel}\n          disabled={isLoading}\n        >\n          <Text style={styles.cancelButtonText}>Cancel</Text>\n        </TouchableOpacity>\n\n        <TouchableOpacity \n          style={[\n            styles.button, \n            styles.createButton,\n            !canCreate && styles.disabledButton\n          ]}\n          onPress={handleCreateTag}\n          disabled={!canCreate}\n        >\n          {isLoading ? (\n            <ActivityIndicator color=\"white\" />\n          ) : (\n            <Text style={styles.createButtonText}>Create Tag</Text>\n          )}\n        </TouchableOpacity>\n      </View>\n    </View>\n  );\n};\n\nconst getStyles = (theme: AppTheme) => StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: theme.colors.background,\n  },\n  content: {\n    flex: 1,\n    padding: theme.spacing.lg,\n  },\n  header: {\n    marginBottom: theme.spacing.xl,\n    alignItems: 'center',\n  },\n  title: {\n    fontSize: theme.typography.fontSizes.xxl,\n    fontWeight: 'bold',\n    color: theme.colors.text,\n    textAlign: 'center',\n    marginBottom: theme.spacing.sm,\n    fontFamily: theme.typography.fontFamilies.bold,\n  },\n  subtitle: {\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.textSecondary,\n    textAlign: 'center',\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  inputContainer: {\n    marginBottom: theme.spacing.xl,\n  },\n  label: {\n    fontSize: theme.typography.fontSizes.md,\n    fontWeight: '600',\n    color: theme.colors.text,\n    marginBottom: theme.spacing.sm,\n    fontFamily: theme.typography.fontFamilies.medium,\n  },\n  input: {\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n    borderRadius: theme.borderRadius.md,\n    padding: theme.spacing.md,\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.text,\n    backgroundColor: theme.colors.inputBackground,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  colorGrid: {\n    flexDirection: 'row',\n    flexWrap: 'wrap',\n    gap: theme.spacing.md,\n  },\n  colorOption: {\n    width: 44,\n    height: 44,\n    borderRadius: 22,\n    justifyContent: 'center',\n    alignItems: 'center',\n    borderWidth: 2,\n    borderColor: 'transparent',\n  },\n  selectedColorOption: {\n    borderColor: theme.colors.text,\n    borderWidth: 3,\n  },\n  previewContainer: {\n    marginBottom: theme.spacing.xl,\n  },\n  tagPreview: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: theme.colors.card,\n    padding: theme.spacing.md,\n    borderRadius: theme.borderRadius.md,\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n  },\n  tagColorIndicator: {\n    width: 16,\n    height: 16,\n    borderRadius: 8,\n    marginRight: theme.spacing.md,\n  },\n  tagPreviewText: {\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  buttonContainer: {\n    flexDirection: 'row',\n    padding: theme.spacing.lg,\n    gap: theme.spacing.md,\n    borderTopWidth: 1,\n    borderTopColor: theme.colors.border,\n    backgroundColor: theme.colors.card,\n  },\n  button: {\n    flex: 1,\n    paddingVertical: theme.spacing.md,\n    paddingHorizontal: theme.spacing.lg,\n    borderRadius: theme.borderRadius.md,\n    alignItems: 'center',\n    justifyContent: 'center',\n    minHeight: 48,\n  },\n  cancelButton: {\n    backgroundColor: theme.colors.card,\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n  },\n  cancelButtonText: {\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.medium,\n  },\n  createButton: {\n    backgroundColor: theme.colors.primary,\n  },\n  createButtonText: {\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.onPrimary,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n  disabledButton: {\n    opacity: 0.5,\n  },\n});\n\nexport default RegularTagCreate; ","/**\n * Secret Tag Card Component\n * \n * Displays an individual secret tag with management actions like edit, delete, and activation status.\n */\n\nimport React, { useState } from 'react';\nimport {\n  View,\n  Text,\n  TouchableOpacity,\n  StyleSheet,\n  Alert,\n  ActivityIndicator,\n  Platform,\n} from 'react-native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { useAppTheme } from '../contexts/ThemeContext';\nimport { AppTheme } from '../config/theme';\nimport { SecretTagV2 } from '../services/secretTagOnlineManager';\nimport { areSecretTagsEnabled } from '../config/featureFlags';\nimport logger from '../utils/logger';\n\ninterface SecretTagCardProps {\n  tag: SecretTagV2;\n  isActive: boolean;\n  onActivate: (tagId: string) => Promise<void>;\n  onDeactivate: (tagId: string) => Promise<void>;\n  onEdit: (tag: SecretTagV2) => void;\n  onDelete: (tagId: string) => Promise<void>;\n}\n\nconst SecretTagCard: React.FC<SecretTagCardProps> = ({\n  tag,\n  isActive,\n  onActivate,\n  onDeactivate,\n  onEdit,\n  onDelete,\n}) => {\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n  \n  const [isLoading, setIsLoading] = useState(false);\n\n  /**\n   * Handle tag activation/deactivation\n   */\n  const handleToggleActivation = async () => {\n    setIsLoading(true);\n    try {\n      if (isActive) {\n        await onDeactivate(tag.id);\n      } else {\n        await onActivate(tag.id);\n      }\n    } catch (error) {\n      logger.error('Failed to toggle tag activation:', error);\n      Alert.alert(\n        'Error',\n        error instanceof Error ? error.message : 'Failed to toggle tag activation'\n      );\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  /**\n   * Handle tag deletion with confirmation\n   */\n  const handleDelete = () => {\n    console.log(`Delete button clicked for tag: ${tag.name}, isActive: ${isActive}`);\n    \n    // Check if tag is active before allowing deletion\n    if (!isActive) {\n      // Use browser-compatible alert for web\n      if (Platform.OS === 'web') {\n        window.alert('Secret tags can only be deleted when they are active. Please activate the tag first, then try deleting it.');\n      } else {\n        Alert.alert(\n          'Cannot Delete Tag',\n          'Secret tags can only be deleted when they are active. Please activate the tag first, then try deleting it.',\n          [{ text: 'OK', style: 'default' }]\n        );\n      }\n      return;\n    }\n\n    // Use browser-compatible confirm for web\n    if (Platform.OS === 'web') {\n      const confirmed = window.confirm(\n        `Are you sure you want to delete \"${tag.name}\"? This action cannot be undone.\\n\\nNote: Only active tags can be deleted for security reasons.`\n      );\n      \n      if (confirmed) {\n        handleDeleteConfirmed();\n      }\n    } else {\n      Alert.alert(\n        'Delete Secret Tag',\n        `Are you sure you want to delete \"${tag.name}\"? This action cannot be undone.\\n\\nNote: Only active tags can be deleted for security reasons.`,\n        [\n          { text: 'Cancel', style: 'cancel' },\n          {\n            text: 'Delete',\n            style: 'destructive',\n            onPress: handleDeleteConfirmed,\n          },\n        ]\n      );\n    }\n  };\n\n  /**\n   * Handle the actual deletion after confirmation\n   */\n  const handleDeleteConfirmed = async () => {\n    try {\n      console.log(`Proceeding with deletion of tag: ${tag.name}`);\n      await onDelete(tag.id);\n      \n      // Show success message\n      if (Platform.OS === 'web') {\n        window.alert('The secret tag has been permanently deleted.');\n      } else {\n        Alert.alert('Tag Deleted', 'The secret tag has been permanently deleted.');\n      }\n    } catch (error) {\n      logger.error('Failed to delete tag:', error);\n      const errorMessage = error instanceof Error ? error.message : 'Failed to delete tag';\n      \n      if (Platform.OS === 'web') {\n        window.alert(`Error: ${errorMessage}`);\n      } else {\n        Alert.alert('Error', errorMessage);\n      }\n    }\n  };\n\n  /**\n   * Format creation date\n   */\n  const formatDate = (dateString: string): string => {\n    const date = new Date(dateString);\n    return date.toLocaleDateString('en-US', {\n      year: 'numeric',\n      month: 'short',\n      day: 'numeric',\n    });\n  };\n\n  if (!areSecretTagsEnabled()) {\n    return null;\n  }\n\n  return (\n    <View style={[styles.container, isActive && styles.activeContainer]}>\n      {/* Tag Header */}\n      <View style={styles.header}>\n        <View style={styles.tagInfo}>\n          <View style={[styles.colorIndicator, { backgroundColor: tag.colorCode }]} />\n          <View style={styles.tagDetails}>\n            <Text style={styles.tagName}>{tag.name}</Text>\n            <Text style={styles.tagDate}>Created {formatDate(tag.createdAt)}</Text>\n          </View>\n        </View>\n        \n        {/* Status Badge */}\n        <View style={[styles.statusBadge, isActive && styles.activeStatusBadge]}>\n          <Text style={[styles.statusText, isActive && styles.activeStatusText]}>\n            {isActive ? 'Active' : 'Inactive'}\n          </Text>\n        </View>\n      </View>\n\n      {/* Tag Actions */}\n      <View style={styles.actions}>\n        {/* Activation Toggle */}\n        <TouchableOpacity\n          style={[styles.actionButton, styles.toggleButton, isActive && styles.activeToggleButton]}\n          onPress={handleToggleActivation}\n          disabled={isLoading}\n        >\n          {isLoading ? (\n            <ActivityIndicator size=\"small\" color={isActive ? theme.colors.background : theme.colors.primary} />\n          ) : (\n            <>\n              <Ionicons\n                name={isActive ? 'eye-off' : 'eye'}\n                size={16}\n                color={isActive ? theme.colors.background : theme.colors.primary}\n              />\n              <Text style={[styles.actionButtonText, isActive && styles.activeActionButtonText]}>\n                {isActive ? 'Deactivate' : 'Activate'}\n              </Text>\n            </>\n          )}\n        </TouchableOpacity>\n\n        {/* Edit Button */}\n        <TouchableOpacity\n          style={[styles.actionButton, styles.editButton]}\n          onPress={() => onEdit(tag)}\n          disabled={isLoading}\n        >\n          <Ionicons name=\"pencil\" size={16} color={theme.colors.textSecondary} />\n          <Text style={styles.secondaryActionButtonText}>Edit</Text>\n        </TouchableOpacity>\n\n        {/* Delete Button */}\n        <TouchableOpacity\n          style={[\n            styles.actionButton, \n            styles.deleteButton,\n            !isActive && styles.disabledButton\n          ]}\n          onPress={handleDelete}\n          disabled={isLoading || !isActive}\n        >\n          <Ionicons \n            name=\"trash\" \n            size={16} \n            color={!isActive ? theme.colors.textSecondary : theme.colors.error} \n          />\n          <Text style={[\n            styles.secondaryActionButtonText, \n            { color: !isActive ? theme.colors.textSecondary : theme.colors.error }\n          ]}>\n            Delete\n          </Text>\n        </TouchableOpacity>\n      </View>\n\n      {/* Active Tag Info */}\n      {isActive && (\n        <View style={styles.activeInfo}>\n          <Ionicons name=\"information-circle\" size={16} color={theme.colors.primary} />\n          <Text style={styles.activeInfoText}>\n            This tag is currently active. New entries will be encrypted with this tag. You can delete this tag while it's active.\n          </Text>\n        </View>\n      )}\n\n      {/* Inactive Tag Info */}\n      {!isActive && (\n        <View style={styles.inactiveInfo}>\n          <Ionicons name=\"information-circle-outline\" size={16} color={theme.colors.textSecondary} />\n          <Text style={styles.inactiveInfoText}>\n            Activate this tag to enable deletion and encryption features.\n          </Text>\n        </View>\n      )}\n    </View>\n  );\n};\n\nconst getStyles = (theme: AppTheme) => StyleSheet.create({\n  container: {\n    backgroundColor: theme.colors.card,\n    borderRadius: 12,\n    padding: theme.spacing.lg,\n    marginBottom: theme.spacing.md,\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n    ...theme.shadows.sm,\n  },\n  activeContainer: {\n    borderColor: theme.colors.primary,\n    borderWidth: 2,\n  },\n  header: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    marginBottom: theme.spacing.md,\n  },\n  tagInfo: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    flex: 1,\n  },\n  colorIndicator: {\n    width: 12,\n    height: 12,\n    borderRadius: 6,\n    marginRight: theme.spacing.sm,\n  },\n  tagDetails: {\n    flex: 1,\n  },\n  tagName: {\n    fontSize: theme.typography.fontSizes.lg,\n    fontWeight: '600',\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n    marginBottom: 2,\n  },\n  tagDate: {\n    fontSize: theme.typography.fontSizes.sm,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  statusBadge: {\n    paddingHorizontal: theme.spacing.sm,\n    paddingVertical: 4,\n    borderRadius: 12,\n    backgroundColor: theme.colors.card,\n  },\n  activeStatusBadge: {\n    backgroundColor: theme.colors.primary,\n  },\n  statusText: {\n    fontSize: theme.typography.fontSizes.xs,\n    fontWeight: '600',\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n  activeStatusText: {\n    color: theme.colors.background,\n  },\n  actions: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    marginBottom: theme.spacing.sm,\n  },\n  actionButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    paddingHorizontal: theme.spacing.md,\n    paddingVertical: theme.spacing.sm,\n    borderRadius: 8,\n    flex: 1,\n    marginHorizontal: 2,\n    justifyContent: 'center',\n  },\n  toggleButton: {\n    backgroundColor: 'transparent',\n    borderWidth: 1,\n    borderColor: theme.colors.primary,\n  },\n  activeToggleButton: {\n    backgroundColor: theme.colors.primary,\n  },\n  editButton: {\n    backgroundColor: 'transparent',\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n  },\n  deleteButton: {\n    backgroundColor: 'transparent',\n    borderWidth: 1,\n    borderColor: theme.colors.error,\n  },\n  actionButtonText: {\n    fontSize: theme.typography.fontSizes.sm,\n    fontWeight: '600',\n    color: theme.colors.primary,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n    marginLeft: 4,\n  },\n  activeActionButtonText: {\n    color: theme.colors.background,\n  },\n  secondaryActionButtonText: {\n    fontSize: theme.typography.fontSizes.sm,\n    fontWeight: '600',\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n    marginLeft: 4,\n  },\n  activeInfo: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: theme.colors.primaryLight || theme.colors.primary + '20',\n    padding: theme.spacing.sm,\n    borderRadius: 8,\n    marginTop: theme.spacing.sm,\n  },\n  activeInfoText: {\n    fontSize: theme.typography.fontSizes.sm,\n    color: theme.colors.primary,\n    fontFamily: theme.typography.fontFamilies.regular,\n    marginLeft: theme.spacing.xs,\n    flex: 1,\n  },\n  inactiveInfo: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: theme.colors.card,\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n    padding: theme.spacing.sm,\n    borderRadius: 8,\n    marginTop: theme.spacing.sm,\n  },\n  inactiveInfoText: {\n    fontSize: theme.typography.fontSizes.sm,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.regular,\n    marginLeft: theme.spacing.xs,\n    flex: 1,\n  },\n  disabledButton: {\n    opacity: 0.5,\n    borderColor: theme.colors.border,\n  },\n});\n\nexport default SecretTagCard; ","/**\n * Tag Management Screen\n * \n * Provides an interface for managing both regular tags and secret tags.\n * Integrates with the OPAQUE-based secret tag system.\n */\n\nimport React, { useState, useEffect, useCallback } from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  TouchableOpacity,\n  FlatList,\n  Alert,\n  ActivityIndicator,\n  RefreshControl,\n} from 'react-native';\nimport { useNavigation } from '@react-navigation/native';\nimport { StackNavigationProp } from '@react-navigation/stack';\nimport { Ionicons } from '@expo/vector-icons';\n\nimport { MainStackParamList } from '../../navigation/types';\nimport { useAppTheme } from '../../contexts/ThemeContext';\nimport { AppTheme } from '../../config/theme';\nimport { tagManager } from '../../services/tagManager';\nimport { api } from '../../services/api';\nimport SecretTagSetup from '../../components/SecretTagSetup';\nimport RegularTagCreate from '../../components/RegularTagCreate';\nimport SecretTagCard from '../../components/SecretTagCard';\nimport ScreenHeader from '../../components/ScreenHeader';\nimport { Tag } from '../../types';\nimport { OpaqueSecretTag } from '../../types/opaqueTypes';\nimport logger from '../../utils/logger';\nimport { areSecretTagsEnabled } from '../../config/featureFlags';\n\ntype TagManagementNavigationProp = StackNavigationProp<MainStackParamList, 'TagManagement'>;\n\ninterface TagManagementScreenProps {}\n\nconst TagManagementScreen: React.FC<TagManagementScreenProps> = () => {\n  // If secret tags are disabled globally, render nothing\n  if (!areSecretTagsEnabled()) {\n    return null;\n  }\n  const navigation = useNavigation<TagManagementNavigationProp>();\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n\n  // State\n  const [regularTags, setRegularTags] = useState<Tag[]>([]);\n  const [secretTags, setSecretTags] = useState<OpaqueSecretTag[]>([]);\n  const [activeSecretTags, setActiveSecretTags] = useState<Set<string>>(new Set());\n  const [isLoading, setIsLoading] = useState(true);\n  const [isRefreshing, setIsRefreshing] = useState(false);\n  const [showSecretTagSetup, setShowSecretTagSetup] = useState(false);\n  const [showRegularTagCreate, setShowRegularTagCreate] = useState(false);\n  const [selectedTab, setSelectedTab] = useState<'regular' | 'secret'>('regular');\n\n  /**\n   * Load secret tags from server\n   */\n  const loadSecretTags = useCallback(async () => {\n    try {\n      logger.info('Loading secret tags from server');\n      \n      // Use the proper API service with authentication headers\n      const response = await api.get('/api/v1/secret-tags');\n      \n      // Backend returns SecretTagListResponse with tags array\n      const tagsData = response.data?.tags || [];\n      setSecretTags(tagsData.map((tag: any) => ({\n        ...tag,\n        id: tag.tag_id, // Convert tag_id to id for consistency\n        auth_method: 'opaque' as const,\n        security_level: 'standard' as const,\n        authentication_count: 0\n      })));\n      logger.info(`Loaded ${tagsData.length} secret tags`);\n    } catch (error) {\n      logger.error('Error loading secret tags:', error);\n      setSecretTags([]);\n    }\n  }, []);\n\n  /**\n   * Load all tags (regular and secret)\n   */\n  const loadTags = useCallback(async () => {\n    setIsLoading(true);\n    try {\n      // Load regular tags\n      const tags = await tagManager.getAllTags();\n      setRegularTags(tags);\n      \n      // Load secret tags\n      await loadSecretTags();\n      \n    } catch (error) {\n      logger.error('Failed to load tags:', error);\n      Alert.alert('Error', 'Failed to load tags');\n    } finally {\n      setIsLoading(false);\n    }\n  }, [loadSecretTags]);\n\n  /**\n   * Refresh tags\n   */\n  const handleRefresh = useCallback(async () => {\n    setIsRefreshing(true);\n    await loadTags();\n    setIsRefreshing(false);\n  }, [loadTags]);\n\n  /**\n   * Handle regular tag creation\n   */\n  const handleRegularTagCreate = useCallback(() => {\n    setShowRegularTagCreate(true);\n  }, []);\n\n  /**\n   * Handle regular tag created callback\n   */\n  const handleRegularTagCreated = useCallback((newTag: Tag) => {\n    setRegularTags(prev => [...prev, newTag]);\n    setShowRegularTagCreate(false);\n    logger.info('Regular tag created:', newTag);\n  }, []);\n\n  /**\n   * Handle regular tag create cancelled\n   */\n  const handleRegularTagCreateCancelled = useCallback(() => {\n    setShowRegularTagCreate(false);\n  }, []);\n\n  /**\n   * Handle secret tag activation\n   */\n  const handleSecretTagActivate = useCallback(async (tagId: string) => {\n    try {\n      // Use the speech API for activation (this is client-side managed)\n      const response = await fetch('/api/speech/secret-tag/activate', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        credentials: 'include',\n        body: JSON.stringify({\n          tag_id: tagId,\n          action: 'activate'\n        })\n      });\n\n      if (response.ok) {\n        setActiveSecretTags(prev => new Set([...prev, tagId]));\n        logger.info('Secret tag activated:', tagId);\n      } else {\n        throw new Error('Failed to activate secret tag');\n      }\n    } catch (error) {\n      logger.error('Failed to activate secret tag:', error);\n      throw error;\n    }\n  }, []);\n\n  /**\n   * Handle secret tag deactivation\n   */\n  const handleSecretTagDeactivate = useCallback(async (tagId: string) => {\n    try {\n      // Use the speech API for deactivation (this is client-side managed)\n      const response = await fetch('/api/speech/secret-tag/activate', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        credentials: 'include',\n        body: JSON.stringify({\n          tag_id: tagId,\n          action: 'deactivate'\n        })\n      });\n\n      if (response.ok) {\n        setActiveSecretTags(prev => {\n          const newSet = new Set(prev);\n          newSet.delete(tagId);\n          return newSet;\n        });\n        logger.info('Secret tag deactivated:', tagId);\n      } else {\n        throw new Error('Failed to deactivate secret tag');\n      }\n    } catch (error) {\n      logger.error('Failed to deactivate secret tag:', error);\n      throw error;\n    }\n  }, []);\n\n  /**\n   * Handle secret tag editing\n   */\n  const handleSecretTagEdit = useCallback((tag: OpaqueSecretTag) => {\n    // For now, show an alert. In a full implementation, this would open an edit modal\n    Alert.alert('Edit Tag', `Editing \"${tag.tag_name}\" is not yet implemented.`);\n  }, []);\n\n  /**\n   * Handle secret tag deletion\n   */\n  const handleSecretTagDelete = useCallback(async (tagId: string) => {\n    try {\n      // Use the V1 secret tags API endpoint for deletion\n      const response = await api.delete(`/api/v1/secret-tags/${tagId}`);\n\n              if (response.status >= 200 && response.status < 300) {\n        setSecretTags(prev => prev.filter(tag => tag.id !== tagId));\n        setActiveSecretTags(prev => {\n          const newSet = new Set(prev);\n          newSet.delete(tagId);\n          return newSet;\n        });\n        logger.info('Secret tag deleted:', tagId);\n      } else {\n        throw new Error('Failed to delete secret tag');\n      }\n    } catch (error) {\n      logger.error('Failed to delete secret tag:', error);\n      throw error;\n    }\n  }, []);\n\n  /**\n   * Handle secret tag creation\n   */\n  const handleSecretTagCreated = useCallback((tagId: string) => {\n    setShowSecretTagSetup(false);\n    loadTags(); // Refresh the tags list\n  }, [loadTags]);\n\n  /**\n   * Handle FAB press\n   */\n  const handleFABPress = useCallback(() => {\n    if (selectedTab === 'regular') {\n      handleRegularTagCreate();\n    } else {\n      setShowSecretTagSetup(true);\n    }\n  }, [selectedTab, handleRegularTagCreate]);\n\n  // Load tags on mount\n  useEffect(() => {\n    loadTags();\n  }, [loadTags]);\n\n  /**\n   * Render regular tag item\n   */\n  const renderRegularTag = useCallback(({ item }: { item: Tag }) => (\n    <View style={styles.regularTagCard}>\n      <View style={styles.tagInfo}>\n        <View style={[styles.tagColorIndicator, { backgroundColor: item.color }]} />\n        <Text style={styles.tagName}>{item.name}</Text>\n      </View>\n      <TouchableOpacity\n        style={styles.tagDeleteButton}\n        onPress={() => {\n          Alert.alert(\n            'Delete Tag',\n            `Are you sure you want to delete \"${item.name}\"?`,\n            [\n              { text: 'Cancel', style: 'cancel' },\n              {\n                text: 'Delete',\n                style: 'destructive',\n                onPress: async () => {\n                  try {\n                    await tagManager.deleteTag(String(item.id));\n                    setRegularTags(prev => prev.filter(tag => tag.id !== item.id));\n                  } catch (error) {\n                    Alert.alert('Error', 'Failed to delete tag');\n                  }\n                },\n              },\n            ]\n          );\n        }}\n      >\n        <Ionicons name=\"trash\" size={18} color={theme.colors.error} />\n      </TouchableOpacity>\n    </View>\n  ), [styles, theme.colors.error]);\n\n  /**\n   * Render secret tag item\n   */\n  const renderSecretTag = useCallback(({ item }: { item: OpaqueSecretTag }) => (\n    <SecretTagCard\n      tag={item}\n      isActive={activeSecretTags.has(item.id)}\n      onActivate={handleSecretTagActivate}\n      onDeactivate={handleSecretTagDeactivate}\n      onEdit={handleSecretTagEdit}\n      onDelete={handleSecretTagDelete}\n    />\n  ), [activeSecretTags, handleSecretTagActivate, handleSecretTagDeactivate, handleSecretTagEdit, handleSecretTagDelete]);\n\n  // If showing regular tag creation modal\n  if (showRegularTagCreate) {\n    return (\n      <View style={styles.container}>\n        <ScreenHeader title=\"Create Regular Tag\" />\n        <RegularTagCreate\n          onTagCreated={handleRegularTagCreated}\n          onCancel={handleRegularTagCreateCancelled}\n          existingTagNames={regularTags.map(tag => tag.name)}\n        />\n      </View>\n    );\n  }\n\n  // If showing secret tag setup modal\n  if (showSecretTagSetup) {\n    return (\n      <View style={styles.container}>\n        <ScreenHeader title=\"Create Secret Tag\" />\n        <SecretTagSetup\n          onTagCreated={handleSecretTagCreated}\n          onCancel={() => setShowSecretTagSetup(false)}\n          existingTagNames={secretTags.map(tag => tag.tag_name)}\n          enableOpaqueAuth={true}\n        />\n      </View>\n    );\n  }\n\n  return (\n    <View style={styles.container}>\n      <ScreenHeader title=\"Tag Management\" />\n      \n      {/* Tab Selector */}\n      <View style={styles.tabContainer}>\n        <TouchableOpacity\n          style={[styles.tab, selectedTab === 'regular' && styles.activeTab]}\n          onPress={() => setSelectedTab('regular')}\n        >\n          <Ionicons \n            name=\"pricetag\" \n            size={20} \n            color={selectedTab === 'regular' ? theme.colors.primary : theme.colors.textSecondary} \n          />\n          <Text style={[styles.tabText, selectedTab === 'regular' && styles.activeTabText]}>\n            Regular Tags\n          </Text>\n        </TouchableOpacity>\n        \n        <TouchableOpacity\n          style={[styles.tab, selectedTab === 'secret' && styles.activeTab]}\n          onPress={() => setSelectedTab('secret')}\n        >\n          <Ionicons \n            name=\"shield\" \n            size={20} \n            color={selectedTab === 'secret' ? theme.colors.primary : theme.colors.textSecondary} \n          />\n          <Text style={[styles.tabText, selectedTab === 'secret' && styles.activeTabText]}>\n            Secret Tags\n          </Text>\n        </TouchableOpacity>\n      </View>\n\n      {/* Content */}\n      <View style={styles.content}>\n        {isLoading ? (\n          <View style={styles.loadingContainer}>\n            <ActivityIndicator size=\"large\" color={theme.colors.primary} />\n            <Text style={styles.loadingText}>Loading tags...</Text>\n          </View>\n        ) : (\n          <>\n            {selectedTab === 'regular' ? (\n              <FlatList\n                data={regularTags}\n                renderItem={renderRegularTag}\n                keyExtractor={(item) => String(item.id)}\n                refreshControl={\n                  <RefreshControl\n                    refreshing={isRefreshing}\n                    onRefresh={handleRefresh}\n                    colors={[theme.colors.primary]}\n                  />\n                }\n                ListEmptyComponent={\n                  <View style={styles.emptyContainer}>\n                    <Ionicons name=\"pricetag-outline\" size={64} color={theme.colors.textSecondary} />\n                    <Text style={styles.emptyText}>No regular tags yet</Text>\n                    <Text style={styles.emptySubtext}>\n                      Tap the + button to create your first tag\n                    </Text>\n                  </View>\n                }\n              />\n            ) : (\n              <FlatList\n                data={secretTags}\n                renderItem={renderSecretTag}\n                keyExtractor={(item) => item.id}\n                refreshControl={\n                  <RefreshControl\n                    refreshing={isRefreshing}\n                    onRefresh={handleRefresh}\n                    colors={[theme.colors.primary]}\n                  />\n                }\n                ListEmptyComponent={\n                  <View style={styles.emptyContainer}>\n                    <Ionicons name=\"shield-outline\" size={64} color={theme.colors.textSecondary} />\n                    <Text style={styles.emptyText}>No secret tags yet</Text>\n                    <Text style={styles.emptySubtext}>\n                      Tap the + button to create your first secret tag\n                    </Text>\n                  </View>\n                }\n              />\n            )}\n          </>\n        )}\n      </View>\n\n      {/* Floating Action Button */}\n      <TouchableOpacity\n        style={styles.fab}\n        onPress={handleFABPress}\n      >\n        <Ionicons name=\"add\" size={24} color={theme.colors.onPrimary} />\n      </TouchableOpacity>\n\n      {/* Back Button */}\n      <TouchableOpacity\n        style={styles.backButton}\n        onPress={() => navigation.goBack()}\n      >\n        <Ionicons name=\"arrow-back\" size={24} color={theme.colors.text} />\n      </TouchableOpacity>\n    </View>\n  );\n};\n\nconst getStyles = (theme: AppTheme) => StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: theme.colors.background,\n  },\n  tabContainer: {\n    flexDirection: 'row',\n    backgroundColor: theme.colors.card,\n    borderBottomWidth: 1,\n    borderBottomColor: theme.colors.border,\n  },\n  tab: {\n    flex: 1,\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    paddingVertical: theme.spacing.md,\n    paddingHorizontal: theme.spacing.lg,\n  },\n  activeTab: {\n    borderBottomWidth: 2,\n    borderBottomColor: theme.colors.primary,\n  },\n  tabText: {\n    marginLeft: theme.spacing.sm,\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  activeTabText: {\n    color: theme.colors.primary,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n  content: {\n    flex: 1,\n    padding: theme.spacing.md,\n  },\n  loadingContainer: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  loadingText: {\n    marginTop: theme.spacing.md,\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  regularTagCard: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    backgroundColor: theme.colors.card,\n    padding: theme.spacing.md,\n    marginBottom: theme.spacing.sm,\n    borderRadius: theme.borderRadius.lg,\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n  },\n  tagInfo: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    flex: 1,\n  },\n  tagColorIndicator: {\n    width: 16,\n    height: 16,\n    borderRadius: 8,\n    marginRight: theme.spacing.md,\n  },\n  tagName: {\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  tagDeleteButton: {\n    padding: theme.spacing.sm,\n  },\n  emptyContainer: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n    paddingVertical: theme.spacing.xxl,\n  },\n  emptyText: {\n    fontSize: theme.typography.fontSizes.lg,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n    marginTop: theme.spacing.md,\n  },\n  emptySubtext: {\n    fontSize: theme.typography.fontSizes.sm,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.regular,\n    textAlign: 'center',\n    marginTop: theme.spacing.sm,\n    paddingHorizontal: theme.spacing.xl,\n  },\n  fab: {\n    position: 'absolute',\n    bottom: theme.spacing.xl,\n    right: theme.spacing.xl,\n    width: 56,\n    height: 56,\n    borderRadius: 28,\n    backgroundColor: theme.colors.primary,\n    justifyContent: 'center',\n    alignItems: 'center',\n    elevation: 8,\n    shadowColor: '#000',\n    shadowOffset: { width: 0, height: 2 },\n    shadowOpacity: 0.25,\n    shadowRadius: 4,\n  },\n  backButton: {\n    position: 'absolute',\n    top: theme.spacing.xl,\n    left: theme.spacing.md,\n    width: 40,\n    height: 40,\n    borderRadius: 20,\n    backgroundColor: theme.colors.card,\n    justifyContent: 'center',\n    alignItems: 'center',\n    elevation: 2,\n    shadowColor: '#000',\n    shadowOffset: { width: 0, height: 1 },\n    shadowOpacity: 0.2,\n    shadowRadius: 2,\n  },\n});\n\nexport default TagManagementScreen; ","/**\n * Session Storage Manager\n * \n * Handles persistence of session metadata (not sensitive data) across app restarts.\n * Ensures no session keys or other sensitive information is stored persistently.\n */\n\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { AppState, Platform } from 'react-native';\nimport logger from '../utils/logger';\nimport {\n  SessionPersistenceData,\n  SessionMetadata,\n  SessionStorageAdapter,\n  DeviceFingerprint,\n  SessionRecoveryOptions\n} from '../types/sessionTypes';\n\nconst STORAGE_KEYS = {\n  SESSION_METADATA: 'opaque_session_metadata',\n  DEVICE_FINGERPRINT: 'device_fingerprint',\n  LAST_APP_STATE: 'last_app_state'\n} as const;\n\n/**\n * AsyncStorage implementation of SessionStorageAdapter\n */\nclass AsyncStorageAdapter implements SessionStorageAdapter {\n  async store(key: string, data: SessionPersistenceData[]): Promise<void> {\n    try {\n      const serialized = JSON.stringify(data);\n      await AsyncStorage.setItem(key, serialized);\n    } catch (error) {\n      logger.error(`Failed to store session data for key ${key}:`, error);\n      throw error;\n    }\n  }\n\n  async retrieve(key: string): Promise<SessionPersistenceData[] | null> {\n    try {\n      const serialized = await AsyncStorage.getItem(key);\n      if (!serialized) {\n        return null;\n      }\n      return JSON.parse(serialized);\n    } catch (error) {\n      logger.error(`Failed to retrieve session data for key ${key}:`, error);\n      return null;\n    }\n  }\n\n  async remove(key: string): Promise<void> {\n    try {\n      await AsyncStorage.removeItem(key);\n    } catch (error) {\n      logger.error(`Failed to remove session data for key ${key}:`, error);\n      throw error;\n    }\n  }\n\n  async clear(): Promise<void> {\n    try {\n      const keys = Object.values(STORAGE_KEYS);\n      await AsyncStorage.multiRemove(keys);\n    } catch (error) {\n      logger.error('Failed to clear session storage:', error);\n      throw error;\n    }\n  }\n}\n\n/**\n * Session Storage Manager\n */\nexport class SessionStorageManager {\n  private static instance: SessionStorageManager;\n  private storageAdapter: SessionStorageAdapter;\n  private deviceFingerprint: DeviceFingerprint | null = null;\n  private isAppInBackground = false;\n  private lastBackgroundTime: Date | null = null;\n\n  private constructor() {\n    this.storageAdapter = new AsyncStorageAdapter();\n    this.setupAppStateHandling();\n  }\n\n  public static getInstance(): SessionStorageManager {\n    if (!SessionStorageManager.instance) {\n      SessionStorageManager.instance = new SessionStorageManager();\n    }\n    return SessionStorageManager.instance;\n  }\n\n  /**\n   * Initialize the storage manager and device fingerprinting\n   */\n  public async initialize(): Promise<void> {\n    try {\n      logger.info('Initializing SessionStorageManager');\n      \n      // Generate or retrieve device fingerprint\n      await this.initializeDeviceFingerprint();\n      \n      // Clean up expired session metadata\n      await this.cleanupExpiredSessions();\n      \n      logger.info('SessionStorageManager initialized successfully');\n    } catch (error) {\n      logger.error('Failed to initialize SessionStorageManager:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Store session metadata for persistence\n   */\n  public async storeSessionMetadata(sessions: SessionMetadata[]): Promise<void> {\n    try {\n      const persistenceData: SessionPersistenceData[] = sessions.map(session => ({\n        tagId: session.tagId,\n        tagName: session.tagName,\n        createdAt: session.createdAt.toISOString(),\n        expiresAt: session.expiresAt.toISOString(),\n        deviceFingerprint: session.deviceFingerprint,\n        isLocked: session.isLocked,\n        lastAccessed: session.lastAccessed.toISOString(),\n        accessCount: session.accessCount,\n        origin: session.origin\n      }));\n\n      await this.storageAdapter.store(STORAGE_KEYS.SESSION_METADATA, persistenceData);\n      logger.info(`Stored metadata for ${persistenceData.length} sessions`);\n    } catch (error) {\n      logger.error('Failed to store session metadata:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Retrieve session metadata for recovery\n   */\n  public async retrieveSessionMetadata(options: SessionRecoveryOptions = {\n    requireReauth: true,\n    maxAge: 24 * 60 * 60 * 1000, // 24 hours\n    allowPartialRecovery: true\n  }): Promise<SessionMetadata[]> {\n    try {\n      const persistenceData = await this.storageAdapter.retrieve(STORAGE_KEYS.SESSION_METADATA);\n      \n      if (!persistenceData || persistenceData.length === 0) {\n        logger.info('No session metadata found for recovery');\n        return [];\n      }\n\n      const now = new Date();\n      const maxAge = options.maxAge || 24 * 60 * 60 * 1000;\n      const cutoffTime = new Date(now.getTime() - maxAge);\n\n      const validSessions: SessionMetadata[] = [];\n\n      for (const data of persistenceData) {\n        try {\n          const createdAt = new Date(data.createdAt);\n          const expiresAt = new Date(data.expiresAt);\n          const lastAccessed = new Date(data.lastAccessed);\n\n          // Check if session is too old\n          if (createdAt < cutoffTime) {\n            logger.debug(`Session ${data.tagId} too old, skipping recovery`);\n            continue;\n          }\n\n          // Check if session has expired\n          if (expiresAt < now) {\n            logger.debug(`Session ${data.tagId} expired, skipping recovery`);\n            continue;\n          }\n\n          // Check device fingerprint match\n          if (this.deviceFingerprint && data.deviceFingerprint !== this.deviceFingerprint.hash) {\n            logger.warn(`Session ${data.tagId} device fingerprint mismatch, skipping recovery`);\n            continue;\n          }\n\n          const sessionMetadata: SessionMetadata = {\n            tagId: data.tagId,\n            tagName: data.tagName,\n            createdAt,\n            expiresAt,\n            deviceFingerprint: data.deviceFingerprint,\n            isLocked: data.isLocked,\n            lastAccessed,\n            accessCount: data.accessCount,\n            origin: data.origin\n          };\n\n          validSessions.push(sessionMetadata);\n        } catch (error) {\n          logger.warn(`Failed to parse session metadata for ${data.tagId}:`, error);\n          if (!options.allowPartialRecovery) {\n            throw error;\n          }\n        }\n      }\n\n      logger.info(`Retrieved ${validSessions.length} valid sessions for recovery`);\n      return validSessions;\n    } catch (error) {\n      logger.error('Failed to retrieve session metadata:', error);\n      if (options.allowPartialRecovery) {\n        return [];\n      }\n      throw error;\n    }\n  }\n\n  /**\n   * Remove specific session metadata\n   */\n  public async removeSessionMetadata(tagId: string): Promise<void> {\n    try {\n      const sessions = await this.retrieveSessionMetadata({ \n        requireReauth: true,\n        maxAge: 24 * 60 * 60 * 1000,\n        allowPartialRecovery: true \n      });\n      const filteredSessions = sessions.filter(session => session.tagId !== tagId);\n      await this.storeSessionMetadata(filteredSessions);\n      logger.info(`Removed session metadata for tag ${tagId}`);\n    } catch (error) {\n      logger.error(`Failed to remove session metadata for tag ${tagId}:`, error);\n      throw error;\n    }\n  }\n\n  /**\n   * Clear all session metadata\n   */\n  public async clearSessionMetadata(): Promise<void> {\n    try {\n      await this.storageAdapter.remove(STORAGE_KEYS.SESSION_METADATA);\n      logger.info('Cleared all session metadata');\n    } catch (error) {\n      logger.error('Failed to clear session metadata:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get current device fingerprint\n   */\n  public getDeviceFingerprint(): DeviceFingerprint | null {\n    return this.deviceFingerprint;\n  }\n\n  /**\n   * Check if app was recently backgrounded\n   */\n  public getBackgroundInfo(): { wasBackgrounded: boolean; duration: number | null } {\n    if (!this.lastBackgroundTime) {\n      return { wasBackgrounded: false, duration: null };\n    }\n\n    const now = new Date();\n    const duration = now.getTime() - this.lastBackgroundTime.getTime();\n    \n    return {\n      wasBackgrounded: true,\n      duration\n    };\n  }\n\n  /**\n   * Initialize device fingerprinting\n   */\n  private async initializeDeviceFingerprint(): Promise<void> {\n    try {\n      // Try to retrieve existing fingerprint\n      const stored = await AsyncStorage.getItem(STORAGE_KEYS.DEVICE_FINGERPRINT);\n      if (stored) {\n        this.deviceFingerprint = JSON.parse(stored);\n        logger.debug('Retrieved existing device fingerprint');\n        return;\n      }\n\n      // Generate new fingerprint\n      this.deviceFingerprint = await this.generateDeviceFingerprint();\n      \n      // Store for future use\n      await AsyncStorage.setItem(\n        STORAGE_KEYS.DEVICE_FINGERPRINT,\n        JSON.stringify(this.deviceFingerprint)\n      );\n      \n      logger.info('Generated new device fingerprint');\n    } catch (error) {\n      logger.error('Failed to initialize device fingerprint:', error);\n      // Continue without fingerprinting if it fails\n      this.deviceFingerprint = null;\n    }\n  }\n\n  /**\n   * Generate device fingerprint for session binding\n   */\n  private async generateDeviceFingerprint(): Promise<DeviceFingerprint> {\n    try {\n      const platform = Platform.OS;\n      const version = Platform.Version.toString();\n      \n      // Get screen dimensions (if available)\n      let screenDimensions = 'unknown';\n      if (typeof window !== 'undefined' && window.screen) {\n        screenDimensions = `${window.screen.width}x${window.screen.height}`;\n      }\n\n      // Get timezone\n      const timezone = Intl.DateTimeFormat().resolvedOptions().timeZone;\n      \n      // Get language\n      const language = Intl.DateTimeFormat().resolvedOptions().locale;\n      \n      // Get user agent (web only)\n      let userAgent: string | undefined;\n      if (Platform.OS === 'web' && typeof navigator !== 'undefined') {\n        userAgent = navigator.userAgent;\n      }\n\n      // Create fingerprint data\n      const fingerprintData = {\n        platform,\n        version,\n        screenDimensions,\n        timezone,\n        language,\n        userAgent\n      };\n\n      // Generate hash of fingerprint data\n      const hash = await this.hashFingerprint(fingerprintData);\n\n      return {\n        ...fingerprintData,\n        hash\n      };\n    } catch (error) {\n      logger.error('Failed to generate device fingerprint:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Hash fingerprint data for consistency\n   */\n  private async hashFingerprint(data: any): Promise<string> {\n    try {\n      const jsonString = JSON.stringify(data);\n      \n      // Simple hash implementation for React Native\n      let hash = 0;\n      for (let i = 0; i < jsonString.length; i++) {\n        const char = jsonString.charCodeAt(i);\n        hash = ((hash << 5) - hash) + char;\n        hash = hash & hash; // Convert to 32-bit integer\n      }\n      \n      return Math.abs(hash).toString(16);\n    } catch (error) {\n      logger.error('Failed to hash fingerprint:', error);\n      return 'unknown';\n    }\n  }\n\n  /**\n   * Setup app state handling for background detection\n   */\n  private setupAppStateHandling(): void {\n    AppState.addEventListener('change', (nextAppState) => {\n      if (nextAppState === 'background') {\n        this.isAppInBackground = true;\n        this.lastBackgroundTime = new Date();\n        logger.debug('App moved to background');\n      } else if (nextAppState === 'active' && this.isAppInBackground) {\n        this.isAppInBackground = false;\n        const backgroundDuration = this.lastBackgroundTime \n          ? new Date().getTime() - this.lastBackgroundTime.getTime()\n          : 0;\n        logger.debug(`App returned to foreground after ${backgroundDuration}ms`);\n      }\n    });\n  }\n\n  /**\n   * Clean up expired session metadata\n   */\n  private async cleanupExpiredSessions(): Promise<void> {\n    try {\n      const sessions = await this.retrieveSessionMetadata({ \n        requireReauth: true,\n        maxAge: 24 * 60 * 60 * 1000,\n        allowPartialRecovery: true \n      });\n      const now = new Date();\n      const validSessions = sessions.filter(session => session.expiresAt > now);\n      \n      if (validSessions.length < sessions.length) {\n        await this.storeSessionMetadata(validSessions);\n        logger.info(`Cleaned up ${sessions.length - validSessions.length} expired session metadata`);\n      }\n    } catch (error) {\n      logger.error('Failed to cleanup expired sessions:', error);\n      // Don't throw - this is cleanup, not critical\n    }\n  }\n\n  /**\n   * Clear all storage data\n   */\n  public async clearAll(): Promise<void> {\n    try {\n      await this.storageAdapter.clear();\n      this.deviceFingerprint = null;\n      this.lastBackgroundTime = null;\n      logger.info('Cleared all session storage data');\n    } catch (error) {\n      logger.error('Failed to clear session storage:', error);\n      throw error;\n    }\n  }\n}\n\n// Export singleton instance\nexport const sessionStorageManager = SessionStorageManager.getInstance(); ","/**\n * OPAQUE Tag Manager\n * \n * Service for managing OPAQUE-based secret tags with enhanced security\n * features while maintaining compatibility with existing tag systems.\n */\n\nimport { OpaqueClient } from './crypto/OpaqueClient';\n// SessionManager was archived; use SessionStorageManager for initialization\nimport { voicePhraseDetector } from './VoicePhraseDetector';\nimport { sessionStorageManager } from './SessionStorageManager';\nimport logger from '../utils/logger';\nimport {\n  OpaqueSecretTag,\n  OpaqueTagCreationRequest,\n  OpaqueTagCreationResponse,\n  OpaqueTagAuthRequest,\n  OpaqueTagAuthResponse,\n  OpaqueTagMigration,\n  OpaqueTagSettings,\n  OpaqueTagAnalyticsEvent\n} from '../types/opaqueTypes';\nimport { SecretTag } from '../types';\n\n/**\n * OPAQUE Tag Manager Service\n */\nexport class OpaqueTagManager {\n  private static instance: OpaqueTagManager;\n  private opaqueClient: OpaqueClient;\n  private isInitialized = false;\n  private analyticsEvents: OpaqueTagAnalyticsEvent[] = [];\n  \n  // Default settings\n  private defaultSettings: OpaqueTagSettings = {\n    enableDeviceBinding: true,\n    requirePhraseConfirmation: true,\n    sessionTimeout: 15, // minutes\n    maxSessionExtensions: 5,\n    enableAnalytics: true,\n    securityLevel: 'standard'\n  };\n\n  private constructor() {\n    this.opaqueClient = OpaqueClient.getInstance();\n  }\n\n  public static getInstance(): OpaqueTagManager {\n    if (!OpaqueTagManager.instance) {\n      OpaqueTagManager.instance = new OpaqueTagManager();\n    }\n    return OpaqueTagManager.instance;\n  }\n\n  /**\n   * Initialize the OPAQUE tag manager\n   */\n  public async initialize(): Promise<void> {\n    if (this.isInitialized) {\n      logger.debug('OpaqueTagManager already initialized');\n      return;\n    }\n\n    try {\n      logger.info('Initializing OpaqueTagManager');\n\n      // Initialize dependencies\n      await this.opaqueClient.initialize();\n      await sessionStorageManager.initialize();\n\n      // Load existing analytics events\n      await this.loadAnalyticsEvents();\n\n      this.isInitialized = true;\n      logger.info('OpaqueTagManager initialized successfully');\n    } catch (error) {\n      logger.error('Failed to initialize OpaqueTagManager:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Create a new OPAQUE-based secret tag\n   */\n  public async createOpaqueTag(request: OpaqueTagCreationRequest): Promise<OpaqueTagCreationResponse> {\n    try {\n      if (!this.isInitialized) {\n        await this.initialize();\n      }\n\n      logger.info(`Creating OPAQUE tag: ${request.tag_name}`);\n\n      // Get device fingerprint\n      const deviceFingerprint = sessionStorageManager.getDeviceFingerprint();\n      if (!deviceFingerprint) {\n        throw new Error('Device fingerprinting required for OPAQUE tags');\n      }\n\n      // Validate request\n      this.validateTagCreationRequest(request);\n\n      // Generate unique tag ID\n      const tagId = this.generateTagId();\n\n      // For now, we'll create a placeholder OPAQUE tag\n      // In a full implementation, this would integrate with the actual OPAQUE server\n      logger.info(`Generated OPAQUE tag ID: ${tagId}`);\n\n      // Create OPAQUE secret tag\n      const opaqueTag: OpaqueSecretTag = {\n        id: tagId,\n        tag_name: request.tag_name,\n        color_code: request.color_code,\n        created_at: new Date().toISOString(),\n        updated_at: new Date().toISOString(),\n        user_id: 1, // TODO: Get from auth context\n        \n        // OPAQUE-specific fields\n        opaque_server_public_key: 'placeholder_key', // TODO: Real server key\n        auth_method: 'opaque',\n        device_fingerprint: deviceFingerprint.hash,\n        \n        // Enhanced security fields\n        security_level: request.security_level,\n        last_authentication: new Date().toISOString(),\n        authentication_count: 0\n      };\n\n      // Store tag locally (encrypted)\n      await this.storeOpaqueTag(opaqueTag);\n\n      // Create session data placeholder\n      const sessionData = {\n        session_key: 'placeholder_session_key',\n        vault_key: 'placeholder_vault_key',\n        expires_at: new Date(Date.now() + 15 * 60 * 1000).toISOString() // 15 minutes\n      };\n\n      // Record analytics event\n      await this.recordAnalyticsEvent({\n        type: 'creation',\n        tagId,\n        timestamp: new Date(),\n        deviceFingerprint: deviceFingerprint.hash,\n        securityLevel: request.security_level,\n        metadata: {\n          tagName: request.tag_name,\n          authMethod: 'manual'\n        }\n      });\n\n      logger.info(`OPAQUE tag created successfully: ${tagId}`);\n\n      return {\n        success: true,\n        tag: opaqueTag,\n        session_data: sessionData\n      };\n    } catch (error) {\n      logger.error('Failed to create OPAQUE tag:', error);\n      \n      // Record error event\n      await this.recordAnalyticsEvent({\n        type: 'error',\n        tagId: request.tag_name, // Use tag name as fallback\n        timestamp: new Date(),\n        deviceFingerprint: request.device_fingerprint,\n        securityLevel: request.security_level,\n        metadata: {\n          error: error instanceof Error ? error.message : 'Unknown error',\n          operation: 'creation'\n        }\n      });\n\n      return {\n        success: false,\n        tag: {} as OpaqueSecretTag,\n        error: error instanceof Error ? error.message : 'Failed to create OPAQUE tag'\n      };\n    }\n  }\n\n  /**\n   * Authenticate with an OPAQUE tag\n   */\n  public async authenticateOpaqueTag(request: OpaqueTagAuthRequest): Promise<OpaqueTagAuthResponse> {\n    try {\n      logger.info(`Authenticating OPAQUE tag: ${request.tag_id}`);\n\n      // Get device fingerprint\n      const deviceFingerprint = sessionStorageManager.getDeviceFingerprint();\n      if (!deviceFingerprint) {\n        throw new Error('Device fingerprinting required for OPAQUE authentication');\n      }\n\n      // Verify device fingerprint matches\n      const tag = await this.getOpaqueTag(request.tag_id);\n      if (tag && tag.device_fingerprint !== deviceFingerprint.hash) {\n        throw new Error('Device fingerprint mismatch');\n      }\n\n      // For now, simulate authentication success\n      // In a full implementation, this would integrate with the actual OPAQUE server\n      logger.info(`Simulating OPAQUE authentication for tag: ${request.tag_id}`);\n\n      // Update tag authentication info\n      if (tag) {\n        tag.last_authentication = new Date().toISOString();\n        tag.authentication_count = (tag.authentication_count || 0) + 1;\n        await this.updateOpaqueTag(tag);\n      }\n\n      // Create session data\n      const sessionData = {\n        session_key: 'placeholder_session_key',\n        vault_key: 'placeholder_vault_key',\n        expires_at: new Date(Date.now() + 15 * 60 * 1000).toISOString() // 15 minutes\n      };\n\n      // Record analytics event\n      await this.recordAnalyticsEvent({\n        type: 'authentication',\n        tagId: request.tag_id,\n        timestamp: new Date(),\n        deviceFingerprint: deviceFingerprint.hash,\n        securityLevel: tag?.security_level || 'standard',\n        metadata: {\n          authenticationCount: tag?.authentication_count || 1\n        }\n      });\n\n      logger.info(`OPAQUE tag authenticated successfully: ${request.tag_id}`);\n\n      return {\n        success: true,\n        session_data: sessionData\n      };\n    } catch (error) {\n      logger.error('Failed to authenticate OPAQUE tag:', error);\n      \n      // Record error event\n      await this.recordAnalyticsEvent({\n        type: 'error',\n        tagId: request.tag_id,\n        timestamp: new Date(),\n        deviceFingerprint: request.device_fingerprint,\n        securityLevel: 'standard',\n        metadata: {\n          error: error instanceof Error ? error.message : 'Unknown error',\n          operation: 'authentication'\n        }\n      });\n\n      return {\n        success: false,\n        error: error instanceof Error ? error.message : 'Authentication failed'\n      };\n    }\n  }\n\n  /**\n   * Migrate legacy tag to OPAQUE\n   */\n  public async migrateToOpaque(\n    legacyTag: SecretTag,\n    newActivationPhrase: string\n  ): Promise<OpaqueTagCreationResponse> {\n    try {\n      logger.info(`Migrating legacy tag to OPAQUE: ${legacyTag.id}`);\n\n      // Get device fingerprint\n      const deviceFingerprint = sessionStorageManager.getDeviceFingerprint();\n      if (!deviceFingerprint) {\n        throw new Error('Device fingerprinting required for OPAQUE migration');\n      }\n\n      // Create OPAQUE tag with legacy tag info\n      const migrationRequest: OpaqueTagCreationRequest = {\n        tag_name: legacyTag.tag_name,\n        activation_phrase: newActivationPhrase,\n        color_code: legacyTag.color_code,\n        device_fingerprint: deviceFingerprint.hash,\n        security_level: 'standard'\n      };\n\n      // Create the OPAQUE tag\n      const result = await this.createOpaqueTag(migrationRequest);\n\n      if (result.success) {\n        logger.info(`Legacy tag migrated successfully: ${legacyTag.id} -> ${result.tag.id}`);\n        \n        // Record migration event\n        await this.recordAnalyticsEvent({\n          type: 'migration',\n          tagId: result.tag.id,\n          timestamp: new Date(),\n          deviceFingerprint: deviceFingerprint.hash,\n          securityLevel: 'standard',\n          metadata: {\n            legacyTagId: legacyTag.id,\n            migrationDate: new Date().toISOString()\n          }\n        });\n      }\n\n      return result;\n    } catch (error) {\n      logger.error('Failed to migrate legacy tag to OPAQUE:', error);\n      return {\n        success: false,\n        tag: {} as OpaqueSecretTag,\n        error: error instanceof Error ? error.message : 'Migration failed'\n      };\n    }\n  }\n\n  /**\n   * Get migration information for a legacy tag\n   */\n  public getMigrationInfo(legacyTag: SecretTag): OpaqueTagMigration {\n    const securityBenefits = [\n      'Zero-knowledge authentication',\n      'Device binding protection',\n      'Enhanced session management',\n      'Advanced security analytics',\n      'Protection against server breaches'\n    ];\n\n    const risks = [\n      'New activation phrase required',\n      'Cannot recover if phrase is forgotten',\n      'Requires device re-authentication'\n    ];\n\n    return {\n      canMigrate: true,\n      legacyTag,\n      estimatedTime: 30, // seconds\n      securityBenefits,\n      risks,\n      requiresReAuth: true\n    };\n  }\n\n  /**\n   * Get all OPAQUE tags for current user\n   */\n  public async getOpaqueTags(): Promise<OpaqueSecretTag[]> {\n    try {\n      // TODO: Implement storage retrieval\n      logger.debug('Retrieving OPAQUE tags');\n      return [];\n    } catch (error) {\n      logger.error('Failed to retrieve OPAQUE tags:', error);\n      return [];\n    }\n  }\n\n  /**\n   * Get all OPAQUE tags for current user (alias for getOpaqueTags)\n   */\n  public async getAllTags(): Promise<OpaqueSecretTag[]> {\n    return this.getOpaqueTags();\n  }\n\n  /**\n   * Get currently active OPAQUE tags\n   */\n  public async getActiveTags(): Promise<OpaqueSecretTag[]> {\n    try {\n      logger.debug('Retrieving active OPAQUE tags');\n      \n      // Get active sessions from voice phrase detector\n      const activeSessions = voicePhraseDetector.getActiveSessions();\n      \n      // Convert sessions to OpaqueSecretTag format\n      const activeTags: OpaqueSecretTag[] = activeSessions.map(session => ({\n        id: session.tagId,\n        tag_name: session.tagName,\n        color_code: '#FF3B30', // Default color for secret tags\n        created_at: session.createdAt.toISOString(),\n        updated_at: session.lastAccessed.toISOString(),\n        user_id: 1, // TODO: Get from auth context\n        \n        // OPAQUE-specific fields\n        opaque_server_public_key: '', // TODO: Retrieve from storage\n        auth_method: 'opaque',\n        device_fingerprint: sessionStorageManager.getDeviceFingerprint()?.hash || '',\n        \n        // Enhanced security fields\n        security_level: 'standard',\n        last_authentication: session.lastAccessed.toISOString(),\n        authentication_count: 0\n      }));\n      \n      logger.debug(`Found ${activeTags.length} active OPAQUE tags`);\n      return activeTags;\n    } catch (error) {\n      logger.error('Failed to retrieve active OPAQUE tags:', error);\n      return [];\n    }\n  }\n\n  /**\n   * Activate an OPAQUE tag (create a session)\n   */\n  public async activateTag(tagId: string): Promise<void> {\n    try {\n      logger.info(`Activating OPAQUE tag: ${tagId}`);\n      \n      // For now, we'll need the user to provide the activation phrase\n      // In a full implementation, this would require authentication\n      throw new Error('Tag activation requires authentication with activation phrase');\n    } catch (error) {\n      logger.error(`Failed to activate OPAQUE tag ${tagId}:`, error);\n      throw error;\n    }\n  }\n\n  /**\n   * Deactivate an OPAQUE tag (end the session)\n   */\n  public async deactivateTag(tagId: string): Promise<void> {\n    try {\n      logger.info(`Deactivating OPAQUE tag: ${tagId}`);\n      \n      // Check if session is active and let VoicePhraseDetector handle cleanup\n      if (voicePhraseDetector.isSessionActive(tagId)) {\n        // We can't directly call deactivateSession as it's private\n        // For now, we'll use the cleanup method which deactivates all sessions\n        // In a full implementation, there would be a public method to deactivate specific sessions\n        logger.info(`OPAQUE tag ${tagId} is active, cleanup will be handled by session timeout`);\n      }\n      \n      logger.info(`OPAQUE tag deactivated successfully: ${tagId}`);\n    } catch (error) {\n      logger.error(`Failed to deactivate OPAQUE tag ${tagId}:`, error);\n      throw error;\n    }\n  }\n\n  /**\n   * Delete an OPAQUE tag (alias for deleteOpaqueTag)\n   */\n  public async deleteTag(tagId: string): Promise<void> {\n    const result = await this.deleteOpaqueTag(tagId);\n    if (!result) {\n      throw new Error(`Failed to delete OPAQUE tag: ${tagId}`);\n    }\n  }\n\n  /**\n   * Delete an OPAQUE tag\n   */\n  public async deleteOpaqueTag(tagId: string): Promise<boolean> {\n    try {\n      logger.info(`Deleting OPAQUE tag: ${tagId}`);\n\n      // Check if there's an active session and note it\n      if (voicePhraseDetector.isSessionActive(tagId)) {\n        logger.info(`OPAQUE tag ${tagId} has active session, it will be cleaned up`);\n      }\n\n      // Remove from local storage\n      await this.removeOpaqueTag(tagId);\n\n      logger.info(`OPAQUE tag deleted successfully: ${tagId}`);\n      return true;\n    } catch (error) {\n      logger.error('Failed to delete OPAQUE tag:', error);\n      return false;\n    }\n  }\n\n  /**\n   * Get analytics events\n   */\n  public getAnalyticsEvents(): OpaqueTagAnalyticsEvent[] {\n    return [...this.analyticsEvents];\n  }\n\n  /**\n   * Validate tag creation request\n   */\n  private validateTagCreationRequest(request: OpaqueTagCreationRequest): void {\n    if (!request.tag_name || request.tag_name.trim().length < 2) {\n      throw new Error('Tag name must be at least 2 characters');\n    }\n\n    if (!request.activation_phrase || request.activation_phrase.trim().length < 3) {\n      throw new Error('Activation phrase must be at least 3 characters');\n    }\n\n    if (!request.color_code || !request.color_code.match(/^#[0-9A-Fa-f]{6}$/)) {\n      throw new Error('Invalid color code');\n    }\n\n    if (!request.device_fingerprint) {\n      throw new Error('Device fingerprint required');\n    }\n  }\n\n  /**\n   * Generate unique tag ID\n   */\n  private generateTagId(): string {\n    return `opaque_tag_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n  }\n\n  /**\n   * Create initial session after tag creation\n   */\n  private async createInitialSession(tagId: string, phrase: string) {\n    // TODO: Implement with actual OPAQUE client integration\n    // For now, return placeholder session data\n    logger.debug(`Creating initial session for tag: ${tagId}`);\n    \n    return {\n      session_key: 'placeholder_session_key',\n      vault_key: 'placeholder_vault_key',\n      expires_at: new Date(Date.now() + 15 * 60 * 1000).toISOString()\n    };\n  }\n\n  /**\n   * Store OPAQUE tag locally\n   */\n  private async storeOpaqueTag(tag: OpaqueSecretTag): Promise<void> {\n    // TODO: Implement encrypted local storage\n    logger.debug(`Storing OPAQUE tag: ${tag.id}`);\n  }\n\n  /**\n   * Get OPAQUE tag by ID\n   */\n  private async getOpaqueTag(tagId: string): Promise<OpaqueSecretTag | null> {\n    // TODO: Implement storage retrieval\n    logger.debug(`Retrieving OPAQUE tag: ${tagId}`);\n    return null;\n  }\n\n  /**\n   * Update OPAQUE tag\n   */\n  private async updateOpaqueTag(tag: OpaqueSecretTag): Promise<void> {\n    tag.updated_at = new Date().toISOString();\n    // TODO: Implement storage update\n    logger.debug(`Updating OPAQUE tag: ${tag.id}`);\n  }\n\n  /**\n   * Remove OPAQUE tag from storage\n   */\n  private async removeOpaqueTag(tagId: string): Promise<void> {\n    // TODO: Implement storage removal\n    logger.debug(`Removing OPAQUE tag: ${tagId}`);\n  }\n\n  /**\n   * Record analytics event\n   */\n  private async recordAnalyticsEvent(event: OpaqueTagAnalyticsEvent): Promise<void> {\n    try {\n      this.analyticsEvents.push(event);\n      \n      // Keep only last 1000 events\n      if (this.analyticsEvents.length > 1000) {\n        this.analyticsEvents = this.analyticsEvents.slice(-1000);\n      }\n\n      // TODO: Persist to storage\n      logger.debug(`Recorded analytics event: ${event.type} for tag ${event.tagId}`);\n    } catch (error) {\n      logger.error('Failed to record analytics event:', error);\n    }\n  }\n\n  /**\n   * Load analytics events from storage\n   */\n  private async loadAnalyticsEvents(): Promise<void> {\n    try {\n      // TODO: Load from storage\n      logger.debug('Loading analytics events');\n    } catch (error) {\n      logger.error('Failed to load analytics events:', error);\n    }\n  }\n\n  /**\n   * Clean up resources\n   */\n  public async cleanup(): Promise<void> {\n    try {\n      logger.info('Cleaning up OpaqueTagManager');\n      \n      this.analyticsEvents = [];\n      this.isInitialized = false;\n      \n      logger.info('OpaqueTagManager cleanup complete');\n    } catch (error) {\n      logger.error('Error during OpaqueTagManager cleanup:', error);\n      throw error;\n    }\n  }\n}\n\n// Export singleton instance\nexport const opaqueTagManager = OpaqueTagManager.getInstance(); ","/**\n * Tag Delete Confirmation Screen\n * \n * Provides a secure confirmation dialog for deleting tags, with special handling\n * for secret tags that require additional security verification.\n */\n\nimport React, { useState, useEffect } from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  TouchableOpacity,\n  Alert,\n  ActivityIndicator,\n  TextInput,\n} from 'react-native';\nimport { useNavigation, useRoute, RouteProp } from '@react-navigation/native';\nimport { StackNavigationProp } from '@react-navigation/stack';\nimport { Ionicons } from '@expo/vector-icons';\n\nimport { MainStackParamList } from '../../navigation/types';\nimport { useAppTheme } from '../../contexts/ThemeContext';\nimport { AppTheme } from '../../config/theme';\nimport { tagManager } from '../../services/tagManager';\nimport { opaqueTagManager } from '../../services/OpaqueTagManager';\nimport ScreenHeader from '../../components/ScreenHeader';\nimport logger from '../../utils/logger';\n\ntype TagDeleteConfirmationRouteProp = RouteProp<MainStackParamList, 'TagDeleteConfirmation'>;\ntype TagDeleteConfirmationNavigationProp = StackNavigationProp<MainStackParamList, 'TagDeleteConfirmation'>;\n\nconst TagDeleteConfirmationScreen: React.FC = () => {\n  const navigation = useNavigation<TagDeleteConfirmationNavigationProp>();\n  const route = useRoute<TagDeleteConfirmationRouteProp>();\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n\n  const { tagId, tagName, tagType } = route.params;\n\n  // State\n  const [isDeleting, setIsDeleting] = useState(false);\n  const [confirmationText, setConfirmationText] = useState('');\n  const [showConfirmationInput, setShowConfirmationInput] = useState(false);\n\n  // For secret tags, require typing the tag name to confirm\n  const isSecretTag = tagType === 'secret';\n  const requiresConfirmation = isSecretTag;\n  const confirmationRequired = requiresConfirmation ? tagName : 'DELETE';\n\n  useEffect(() => {\n    if (requiresConfirmation) {\n      setShowConfirmationInput(true);\n    }\n  }, [requiresConfirmation]);\n\n  /**\n   * Handle tag deletion\n   */\n  const handleDelete = async () => {\n    if (requiresConfirmation && confirmationText !== confirmationRequired) {\n      Alert.alert(\n        'Confirmation Required',\n        `Please type \"${confirmationRequired}\" to confirm deletion.`\n      );\n      return;\n    }\n\n    setIsDeleting(true);\n    \n    try {\n      if (isSecretTag) {\n        await opaqueTagManager.deleteTag(tagId);\n        logger.info('Secret tag deleted:', { tagId, tagName });\n      } else {\n        await tagManager.deleteTag(tagId);\n        logger.info('Regular tag deleted:', { tagId, tagName });\n      }\n\n      Alert.alert(\n        'Tag Deleted',\n        `\"${tagName}\" has been permanently deleted.`,\n        [\n          {\n            text: 'OK',\n            onPress: () => navigation.goBack(),\n          },\n        ]\n      );\n    } catch (error) {\n      logger.error('Failed to delete tag:', error);\n      Alert.alert(\n        'Delete Failed',\n        error instanceof Error ? error.message : 'Failed to delete tag. Please try again.'\n      );\n    } finally {\n      setIsDeleting(false);\n    }\n  };\n\n  /**\n   * Handle cancellation\n   */\n  const handleCancel = () => {\n    navigation.goBack();\n  };\n\n  const canDelete = !requiresConfirmation || confirmationText === confirmationRequired;\n\n  return (\n    <View style={styles.container}>\n      <ScreenHeader title=\"Delete Tag\" />\n      \n      <View style={styles.content}>\n        {/* Warning Icon */}\n        <View style={styles.warningContainer}>\n          <Ionicons \n            name={isSecretTag ? \"shield-outline\" : \"warning-outline\"} \n            size={64} \n            color={theme.colors.error} \n          />\n        </View>\n\n        {/* Warning Text */}\n        <Text style={styles.warningTitle}>\n          {isSecretTag ? 'Delete Secret Tag?' : 'Delete Tag?'}\n        </Text>\n        \n        <Text style={styles.warningMessage}>\n          Are you sure you want to permanently delete \"{tagName}\"?\n        </Text>\n\n        {isSecretTag && (\n          <Text style={styles.secretTagWarning}>\n            This is a secret tag with encrypted data. Once deleted, all associated \n            encrypted entries will become permanently inaccessible.\n          </Text>\n        )}\n\n        <Text style={styles.warningSubtext}>\n          This action cannot be undone.\n        </Text>\n\n        {/* Confirmation Input */}\n        {showConfirmationInput && (\n          <View style={styles.confirmationContainer}>\n            <Text style={styles.confirmationLabel}>\n              Type \"{confirmationRequired}\" to confirm:\n            </Text>\n            <TextInput\n              style={styles.confirmationInput}\n              value={confirmationText}\n              onChangeText={setConfirmationText}\n              placeholder={confirmationRequired}\n              placeholderTextColor={theme.colors.textSecondary}\n              autoCapitalize=\"none\"\n              autoCorrect={false}\n            />\n          </View>\n        )}\n\n        {/* Action Buttons */}\n        <View style={styles.buttonContainer}>\n          <TouchableOpacity\n            style={[styles.button, styles.cancelButton]}\n            onPress={handleCancel}\n            disabled={isDeleting}\n          >\n            <Text style={styles.cancelButtonText}>Cancel</Text>\n          </TouchableOpacity>\n\n          <TouchableOpacity\n            style={[\n              styles.button,\n              styles.deleteButton,\n              (!canDelete || isDeleting) && styles.disabledButton,\n            ]}\n            onPress={handleDelete}\n            disabled={!canDelete || isDeleting}\n          >\n            {isDeleting ? (\n              <ActivityIndicator size=\"small\" color={theme.colors.onError} />\n            ) : (\n              <Text style={styles.deleteButtonText}>Delete</Text>\n            )}\n          </TouchableOpacity>\n        </View>\n\n        {/* Security Notice */}\n        {isSecretTag && (\n          <View style={styles.securityNotice}>\n            <Ionicons name=\"information-circle\" size={16} color={theme.colors.textSecondary} />\n            <Text style={styles.securityNoticeText}>\n              Secret tags can only be deleted when they are active for security reasons.\n            </Text>\n          </View>\n        )}\n      </View>\n    </View>\n  );\n};\n\nconst getStyles = (theme: AppTheme) => StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: theme.colors.background,\n  },\n  content: {\n    flex: 1,\n    padding: theme.spacing.xl,\n    justifyContent: 'center',\n  },\n  warningContainer: {\n    alignItems: 'center',\n    marginBottom: theme.spacing.xl,\n  },\n  warningTitle: {\n    fontSize: theme.typography.fontSizes.xxl,\n    fontWeight: 'bold',\n    color: theme.colors.error,\n    textAlign: 'center',\n    marginBottom: theme.spacing.md,\n    fontFamily: theme.typography.fontFamilies.bold,\n  },\n  warningMessage: {\n    fontSize: theme.typography.fontSizes.lg,\n    color: theme.colors.text,\n    textAlign: 'center',\n    marginBottom: theme.spacing.md,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  secretTagWarning: {\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.error,\n    textAlign: 'center',\n    marginBottom: theme.spacing.md,\n    fontFamily: theme.typography.fontFamilies.medium,\n    backgroundColor: theme.colors.errorLight || theme.colors.error + '20',\n    padding: theme.spacing.md,\n    borderRadius: theme.borderRadius.md,\n    borderWidth: 1,\n    borderColor: theme.colors.error + '40',\n  },\n  warningSubtext: {\n    fontSize: theme.typography.fontSizes.sm,\n    color: theme.colors.textSecondary,\n    textAlign: 'center',\n    marginBottom: theme.spacing.xl,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  confirmationContainer: {\n    marginBottom: theme.spacing.xl,\n  },\n  confirmationLabel: {\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.text,\n    marginBottom: theme.spacing.sm,\n    fontFamily: theme.typography.fontFamilies.medium,\n  },\n  confirmationInput: {\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n    borderRadius: theme.borderRadius.md,\n    padding: theme.spacing.md,\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.text,\n    backgroundColor: theme.colors.inputBackground,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  buttonContainer: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    gap: theme.spacing.md,\n  },\n  button: {\n    flex: 1,\n    paddingVertical: theme.spacing.md,\n    paddingHorizontal: theme.spacing.lg,\n    borderRadius: theme.borderRadius.md,\n    alignItems: 'center',\n    justifyContent: 'center',\n    minHeight: 48,\n  },\n  cancelButton: {\n    backgroundColor: theme.colors.card,\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n  },\n  cancelButtonText: {\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.medium,\n  },\n  deleteButton: {\n    backgroundColor: theme.colors.error,\n  },\n  deleteButtonText: {\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.onError || theme.colors.white,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n  disabledButton: {\n    opacity: 0.5,\n  },\n  securityNotice: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginTop: theme.spacing.xl,\n    padding: theme.spacing.md,\n    backgroundColor: theme.colors.card,\n    borderRadius: theme.borderRadius.md,\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n  },\n  securityNoticeText: {\n    fontSize: theme.typography.fontSizes.sm,\n    color: theme.colors.textSecondary,\n    marginLeft: theme.spacing.sm,\n    flex: 1,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n});\n\nexport default TagDeleteConfirmationScreen; ","import React, { useState, useEffect } from 'react';\nimport {\n  View,\n  Text,\n  TouchableOpacity,\n  StyleSheet,\n  ScrollView,\n  ActivityIndicator,\n} from 'react-native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { useAppTheme } from '../contexts/ThemeContext';\nimport { AppTheme } from '../config/theme';\nimport { Tag } from '../types';\nimport { TagsAPI } from '../services/api';\nimport logger from '../utils/logger';\n\ninterface RecentTag extends Tag {\n  last_used: string;\n  usage_count: number;\n}\n\ninterface RecentTagsSelectorProps {\n  onTagSelect: (tag: Tag) => void;\n  selectedTags: Tag[];\n  maxTags?: number;\n}\n\nconst RecentTagsSelector: React.FC<RecentTagsSelectorProps> = ({\n  onTagSelect,\n  selectedTags,\n  maxTags = 10,\n}) => {\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n  const [recentTags, setRecentTags] = useState<RecentTag[]>([]);\n  const [isLoading, setIsLoading] = useState(false);\n\n  useEffect(() => {\n    loadRecentTags();\n  }, []);\n\n  const loadRecentTags = async () => {\n    try {\n      setIsLoading(true);\n      const response = await TagsAPI.getRecentTags(5);\n      setRecentTags(response.data);\n    } catch (error) {\n      logger.error('Failed to load recent tags:', error);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleTagPress = (tag: RecentTag) => {\n    // Check if tag is already selected\n    const isSelected = selectedTags.some(selectedTag => \n      selectedTag.id === tag.id || selectedTag.name.toLowerCase() === tag.name.toLowerCase()\n    );\n    \n    if (isSelected) {\n      return; // Don't add duplicate tags\n    }\n\n    if (selectedTags.length >= maxTags) {\n      return; // Don't exceed max tags\n    }\n\n    // Convert RecentTag to Tag format\n    const tagToAdd: Tag = {\n      id: tag.id,\n      name: tag.name,\n      color: tag.color,\n      created_at: tag.created_at,\n      updated_at: tag.updated_at,\n    };\n\n    onTagSelect(tagToAdd);\n  };\n\n  const formatLastUsed = (lastUsed: string) => {\n    const date = new Date(lastUsed);\n    const now = new Date();\n    const diffInDays = Math.floor((now.getTime() - date.getTime()) / (1000 * 60 * 60 * 24));\n    \n    if (diffInDays === 0) {\n      return 'Today';\n    } else if (diffInDays === 1) {\n      return 'Yesterday';\n    } else if (diffInDays < 7) {\n      return `${diffInDays} days ago`;\n    } else {\n      return date.toLocaleDateString();\n    }\n  };\n\n  if (isLoading) {\n    return (\n      <View style={styles.loadingContainer}>\n        <ActivityIndicator size=\"small\" color={theme.colors.primary} />\n        <Text style={styles.loadingText}>Loading recent tags...</Text>\n      </View>\n    );\n  }\n\n  if (recentTags.length === 0) {\n    return null; // Don't show anything if no recent tags\n  }\n\n  return (\n    <View style={styles.container}>\n      <Text style={styles.title}>Recent Tags</Text>\n      <ScrollView \n        horizontal \n        showsHorizontalScrollIndicator={false}\n        style={styles.scrollView}\n        contentContainerStyle={styles.scrollContent}\n      >\n        {recentTags.map((tag) => {\n          const isSelected = selectedTags.some(selectedTag => \n            selectedTag.id === tag.id || selectedTag.name.toLowerCase() === tag.name.toLowerCase()\n          );\n          const isDisabled = selectedTags.length >= maxTags && !isSelected;\n          \n          return (\n            <TouchableOpacity\n              key={tag.id}\n              style={[\n                styles.tagButton,\n                isSelected && styles.tagButtonSelected,\n                isDisabled && styles.tagButtonDisabled,\n              ]}\n              onPress={() => handleTagPress(tag)}\n              disabled={isSelected || isDisabled}\n              activeOpacity={0.7}\n            >\n              <View style={styles.tagContent}>\n                <View style={styles.tagHeader}>\n                  <Ionicons \n                    name=\"pricetag\" \n                    size={16} \n                    color={tag.color || theme.colors.primary}\n                    style={styles.tagIcon}\n                  />\n                  <Text style={[\n                    styles.tagName,\n                    isSelected && styles.tagNameSelected,\n                    isDisabled && styles.tagNameDisabled,\n                  ]}>\n                    {tag.name}\n                  </Text>\n                </View>\n                <Text style={[\n                  styles.tagMeta,\n                  isSelected && styles.tagMetaSelected,\n                  isDisabled && styles.tagMetaDisabled,\n                ]}>\n                  {formatLastUsed(tag.last_used)} • {tag.usage_count} uses\n                </Text>\n              </View>\n            </TouchableOpacity>\n          );\n        })}\n      </ScrollView>\n    </View>\n  );\n};\n\nconst getStyles = (theme: AppTheme) => StyleSheet.create({\n  container: {\n    marginBottom: theme.spacing.md,\n  },\n  title: {\n    fontSize: 16,\n    fontWeight: '600',\n    color: theme.colors.text,\n    marginBottom: theme.spacing.sm,\n    marginLeft: theme.spacing.xs,\n  },\n  scrollView: {\n    flexGrow: 0,\n  },\n  scrollContent: {\n    paddingHorizontal: theme.spacing.xs,\n  },\n  loadingContainer: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    padding: theme.spacing.md,\n  },\n  loadingText: {\n    marginLeft: theme.spacing.sm,\n    color: theme.colors.textSecondary,\n    fontSize: 14,\n  },\n  tagButton: {\n    backgroundColor: theme.colors.surface,\n    borderRadius: theme.borderRadius.md,\n    padding: theme.spacing.sm,\n    marginRight: theme.spacing.sm,\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n    minWidth: 120,\n  },\n  tagButtonSelected: {\n    backgroundColor: theme.colors.primary + '20',\n    borderColor: theme.colors.primary,\n  },\n  tagButtonDisabled: {\n    opacity: 0.5,\n  },\n  tagContent: {\n    alignItems: 'flex-start',\n  },\n  tagHeader: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginBottom: 2,\n  },\n  tagIcon: {\n    marginRight: 4,\n  },\n  tagName: {\n    fontSize: 14,\n    fontWeight: '500',\n    color: theme.colors.text,\n    flex: 1,\n  },\n  tagNameSelected: {\n    color: theme.colors.primary,\n  },\n  tagNameDisabled: {\n    color: theme.colors.textSecondary,\n  },\n  tagMeta: {\n    fontSize: 12,\n    color: theme.colors.textSecondary,\n  },\n  tagMetaSelected: {\n    color: theme.colors.primary + 'CC',\n  },\n  tagMetaDisabled: {\n    color: theme.colors.textSecondary + '80',\n  },\n});\n\nexport default RecentTagsSelector; ","import React, { useState, useRef, useEffect, useMemo } from 'react';\nimport {\n  View,\n  Text,\n  TextInput,\n  TouchableOpacity,\n  StyleSheet,\n  ScrollView,\n  Animated,\n  Keyboard,\n  Platform,\n} from 'react-native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { useAppTheme } from '../contexts/ThemeContext';\nimport { AppTheme } from '../config/theme';\nimport { Tag } from '../types'; // Make sure this path is correct\nimport RecentTagsSelector from './RecentTagsSelector';\n\n// Helper to determine if native driver should be used\nconst useNativeDriver = Platform.OS !== 'web';\n\ninterface TagInputProps {\n  tags: Tag[];\n  onChangeTags: (tags: Tag[]) => void;\n  maxTags?: number;\n  placeholder?: string;\n  suggestions?: string[]; // Common tags for autocomplete\n}\n\nconst TagInput: React.FC<TagInputProps> = ({\n  tags,\n  onChangeTags,\n  maxTags = 10,\n  placeholder = \"Add tag...\",\n  suggestions = []\n}) => {\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n  const [inputValue, setInputValue] = useState('');\n  const [showSuggestions, setShowSuggestions] = useState(false);\n  const [filteredSuggestions, setFilteredSuggestions] = useState<string[]>([]);\n  const inputRef = useRef<TextInput>(null);\n  const fadeAnim = useRef(new Animated.Value(0)).current;\n\n  // Memoize suggestions to prevent unnecessary re-renders\n  const memoizedSuggestions = useMemo(() => suggestions, [suggestions]);\n\n  // Filter suggestions based on input\n  useEffect(() => {\n    if (inputValue.trim()) {\n      const currentTagNames = tags.map(tag => tag.name.toLowerCase());\n      const filtered = memoizedSuggestions.filter(\n        suggestion =>\n          suggestion.toLowerCase().includes(inputValue.toLowerCase()) &&\n          !currentTagNames.includes(suggestion.toLowerCase()),\n      );\n      setFilteredSuggestions(filtered);\n      setShowSuggestions(filtered.length > 0);\n\n      // Animate suggestions appearance only if there are suggestions\n      if (filtered.length > 0) {\n        Animated.timing(fadeAnim, {\n          toValue: 1,\n          duration: 200,\n          useNativeDriver,\n        }).start();\n      }\n    } else {\n      setShowSuggestions(false);\n      Animated.timing(fadeAnim, {\n        toValue: 0,\n        duration: 150,\n        useNativeDriver,\n      }).start();\n    }\n  }, [inputValue, memoizedSuggestions]); // Use memoized suggestions to prevent infinite loops\n\n  const handleAddTag = (tagName?: string) => {\n    const newTagName = (tagName || inputValue).trim().toLowerCase();\n    \n    if (!newTagName) {\n      return;\n    }\n    \n    // Check for duplicates and max tags\n    const currentTagNames = tags.map(tag => tag.name.toLowerCase());\n    if (currentTagNames.includes(newTagName) || tags.length >= maxTags) {\n      setInputValue('');\n      setShowSuggestions(false);\n      return;\n    }\n    \n    const newTag: Tag = { name: newTagName, id: null as any };\n    onChangeTags([...tags, newTag]);\n    setInputValue('');\n    setShowSuggestions(false);\n    \n    // Keep focus on input for continuous tagging\n    setTimeout(() => {\n      inputRef.current?.focus();\n    }, 100);\n  };\n\n  const handleRemoveTag = (indexToRemove: number) => {\n    const updatedTags = tags.filter((_, index) => index !== indexToRemove);\n    onChangeTags(updatedTags);\n  };\n\n  const handleKeyPress = (e: any) => {\n    const key = e.nativeEvent.key;\n    \n    if (key === 'Enter' || key === ' ' || key === ',') {\n      e.preventDefault?.();\n      handleAddTag();\n    } else if (key === 'Backspace' && !inputValue && tags.length > 0) {\n      // Remove last tag when backspace is pressed on empty input\n      handleRemoveTag(tags.length - 1);\n    }\n  };\n\n  const handleSuggestionPress = (suggestion: string) => {\n    handleAddTag(suggestion);\n  };\n\n  const handleInputFocus = () => {\n    if (inputValue.trim() && filteredSuggestions.length > 0) {\n      setShowSuggestions(true);\n    }\n  };\n\n  const handleInputBlur = () => {\n    // Delay hiding suggestions to allow for suggestion tap\n    setTimeout(() => {\n      setShowSuggestions(false);\n    }, 150);\n  };\n\n  return (\n    <View style={styles.container} testID=\"tag-input-container\">\n      {/* Recent Tags Selector */}\n      <RecentTagsSelector\n        onTagSelect={(tag) => {\n          // Add the selected tag to the current tags\n          const newTag: Tag = { \n            name: tag.name, \n            id: tag.id,\n            color: tag.color,\n            created_at: tag.created_at,\n            updated_at: tag.updated_at\n          };\n          onChangeTags([...tags, newTag]);\n        }}\n        selectedTags={tags}\n        maxTags={maxTags}\n      />\n      \n      {/* Tags Display */}\n      {tags.length > 0 && (\n        <ScrollView\n          horizontal\n          showsHorizontalScrollIndicator={false}\n          style={styles.tagsScrollView}\n          contentContainerStyle={styles.tagsContainer}\n          testID=\"tags-scroll-view\"\n          keyboardShouldPersistTaps=\"handled\"\n        >\n          {tags.map((tag, index) => (\n            <Animated.View\n              key={tag.id ? `tag-${tag.id}` : `tag-${tag.name}-${index}`}\n              style={styles.tag}\n              testID={`tag-item-${tag.name}-${index}`}\n            >\n              <Text style={styles.tagText} testID={`tag-text-${tag.name}`}>\n                #{tag.name}\n              </Text>\n              <TouchableOpacity\n                style={styles.tagRemoveButton}\n                onPress={() => handleRemoveTag(index)}\n                testID={`tag-delete-button-${tag.name}-${index}`}\n                accessibilityLabel={`Delete tag ${tag.name}`}\n                hitSlop={{ top: 8, bottom: 8, left: 8, right: 8 }}\n              >\n                <Ionicons name=\"close-circle\" size={18} color={theme.colors.textSecondary} />\n              </TouchableOpacity>\n            </Animated.View>\n          ))}\n        </ScrollView>\n      )}\n      \n      {/* Input Container */}\n      <View style={styles.inputContainer} testID=\"tag-input-field-container\">\n        <View style={styles.inputWrapper}>\n          <Ionicons \n            name=\"pricetag-outline\" \n            size={20} \n            color={theme.colors.textSecondary} \n            style={styles.inputIcon}\n          />\n          <TextInput\n            ref={inputRef}\n            style={styles.input}\n            value={inputValue}\n            onChangeText={setInputValue}\n            onSubmitEditing={() => handleAddTag()}\n            onKeyPress={handleKeyPress}\n            onFocus={handleInputFocus}\n            onBlur={handleInputBlur}\n            placeholder={tags.length >= maxTags ? `Maximum ${maxTags} tags` : placeholder}\n            placeholderTextColor={theme.colors.textSecondary}\n            returnKeyType=\"done\"\n            testID=\"tag-input-field\"\n            editable={tags.length < maxTags}\n            autoCorrect={false}\n            autoCapitalize=\"none\"\n          />\n        </View>\n        <TouchableOpacity\n          style={[\n            styles.addButton,\n            (!inputValue.trim() || tags.length >= maxTags) && styles.disabledButton\n          ]}\n          onPress={() => handleAddTag()}\n          disabled={!inputValue.trim() || tags.length >= maxTags}\n          testID=\"add-tag-button\"\n          accessibilityLabel=\"Add tag\"\n          hitSlop={{ top: 8, bottom: 8, left: 8, right: 8 }}\n        >\n          <Ionicons \n            name=\"add\" \n            size={22} \n            color={theme.colors.onPrimary} \n          />\n        </TouchableOpacity>\n      </View>\n\n      {/* Suggestions */}\n      {showSuggestions && (\n        <Animated.View \n          style={[styles.suggestionsContainer, { opacity: fadeAnim }]}\n          testID=\"suggestions-container\"\n        >\n          <Text style={styles.suggestionsTitle}>Suggestions:</Text>\n          <ScrollView \n            horizontal \n            showsHorizontalScrollIndicator={false}\n            contentContainerStyle={styles.suggestionsContent}\n          >\n            {filteredSuggestions.map((suggestion, index) => (\n              <TouchableOpacity\n                key={`suggestion-${index}`}\n                style={styles.suggestionChip}\n                onPress={() => handleSuggestionPress(suggestion)}\n                testID={`suggestion-${suggestion}`}\n              >\n                <Text style={styles.suggestionText}>#{suggestion}</Text>\n              </TouchableOpacity>\n            ))}\n          </ScrollView>\n        </Animated.View>\n      )}\n      \n      {/* Help Text */}\n      {tags.length < maxTags && inputValue.length === 0 && !showSuggestions && (\n        <Text style={styles.helpText} testID=\"tag-input-help-text\">\n          Press Enter, space, or comma to add • Backspace to remove last tag\n        </Text>\n      )}\n\n      {/* Tag Counter */}\n      <View style={styles.counterContainer}>\n        <Text style={styles.counterText}>\n          {tags.length}/{maxTags} tags\n        </Text>\n      </View>\n    </View>\n  );\n};\n\nconst getStyles = (theme: AppTheme) => StyleSheet.create({\n  container: {\n    marginBottom: theme.spacing.md,\n  },\n  tagsScrollView: {\n    maxHeight: 80,\n    marginBottom: theme.spacing.md,\n  },\n  tagsContainer: {\n    flexDirection: 'row',\n    flexWrap: 'nowrap',\n    alignItems: 'center',\n    paddingVertical: theme.spacing.xs,\n  },\n  tag: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: theme.isDarkMode ? theme.colors.gray700 : theme.colors.primaryLight + '20',\n    borderRadius: theme.borderRadius.full,\n    paddingHorizontal: theme.spacing.md,\n    paddingVertical: theme.spacing.sm,\n    marginRight: theme.spacing.sm,\n    borderWidth: 1,\n    borderColor: theme.isDarkMode ? theme.colors.gray600 : theme.colors.primaryLight + '40',\n    minHeight: 36, // Larger touch target\n  },\n  tagText: {\n    color: theme.isDarkMode ? theme.colors.text : theme.colors.primary,\n    fontSize: theme.typography.fontSizes.sm,\n    marginRight: theme.spacing.sm,\n    fontFamily: theme.typography.fontFamilies.medium,\n    fontWeight: '500',\n  },\n  tagRemoveButton: {\n    padding: theme.spacing.xs,\n    marginLeft: theme.spacing.xs,\n    borderRadius: theme.borderRadius.full,\n  },\n  inputContainer: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginBottom: theme.spacing.sm,\n  },\n  inputWrapper: {\n    flex: 1,\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: theme.colors.inputBackground,\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n    borderRadius: theme.borderRadius.lg,\n    paddingHorizontal: theme.spacing.md,\n    minHeight: 48, // Larger touch target\n  },\n  inputIcon: {\n    marginRight: theme.spacing.sm,\n  },\n  input: {\n    flex: 1,\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.regular,\n    paddingVertical: theme.spacing.md,\n  },\n  addButton: {\n    width: 48,\n    height: 48,\n    borderRadius: theme.borderRadius.lg,\n    backgroundColor: theme.colors.primary,\n    justifyContent: 'center',\n    alignItems: 'center',\n    marginLeft: theme.spacing.md,\n    ...theme.shadows.sm,\n  },\n  disabledButton: {\n    backgroundColor: theme.colors.disabled,\n    opacity: 0.6,\n  },\n  suggestionsContainer: {\n    backgroundColor: theme.colors.card,\n    borderRadius: theme.borderRadius.md,\n    padding: theme.spacing.md,\n    marginBottom: theme.spacing.sm,\n    borderWidth: 1,\n    borderColor: theme.colors.borderLight,\n    ...theme.shadows.sm,\n  },\n  suggestionsTitle: {\n    fontSize: theme.typography.fontSizes.sm,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.medium,\n    marginBottom: theme.spacing.sm,\n  },\n  suggestionsContent: {\n    flexDirection: 'row',\n  },\n  suggestionChip: {\n    backgroundColor: theme.colors.accent + '20',\n    borderRadius: theme.borderRadius.full,\n    paddingHorizontal: theme.spacing.md,\n    paddingVertical: theme.spacing.sm,\n    marginRight: theme.spacing.sm,\n    borderWidth: 1,\n    borderColor: theme.colors.accent + '40',\n  },\n  suggestionText: {\n    fontSize: theme.typography.fontSizes.sm,\n    color: theme.colors.accent,\n    fontFamily: theme.typography.fontFamilies.medium,\n  },\n  helpText: {\n    fontSize: theme.typography.fontSizes.xs,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.regular,\n    lineHeight: theme.typography.lineHeights.normal * theme.typography.fontSizes.xs,\n  },\n  counterContainer: {\n    alignItems: 'flex-end',\n    marginTop: theme.spacing.xs,\n  },\n  counterText: {\n    fontSize: theme.typography.fontSizes.xs,\n    color: theme.colors.textDisabled,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n});\n\nexport default TagInput; ","import React, { useState, useEffect, useCallback, useRef } from 'react';\nimport { \n  View, \n  Text, \n  StyleSheet, \n  TouchableOpacity, \n  ActivityIndicator,\n  Alert,\n  Platform,\n  SafeAreaView,\n  Animated,\n  Dimensions,\n  ScrollView,\n  TextInput\n} from 'react-native';\nimport { useNavigation, useRoute, RouteProp, useFocusEffect } from '@react-navigation/native';\nimport { StackNavigationProp } from '@react-navigation/stack';\nimport { Ionicons } from '@expo/vector-icons';\nimport { format, parseISO } from 'date-fns';\n\nimport { JournalAPI } from '../../services/api';\nimport { JournalEntry, Tag } from '../../types';\nimport { MainStackParamList } from '../../navigation/types';\nimport { useAppTheme } from '../../contexts/ThemeContext';\nimport { AppTheme } from '../../config/theme';\nimport hapticService from '../../services/hapticService';\nimport TagInput from '../../components/TagInput';\n\nconst { width: SCREEN_WIDTH, height: SCREEN_HEIGHT } = Dimensions.get('window');\n\n// Define the type for the route params\ntype JournalEntryDetailRouteProp = RouteProp<MainStackParamList, 'JournalEntryDetail'>;\n\n// Define the type for the navigation prop\ntype JournalEntryDetailNavigationProp = StackNavigationProp<MainStackParamList, 'JournalEntryDetail'>;\n\nconst JournalEntryDetailScreen = () => {\n  const navigation = useNavigation<JournalEntryDetailNavigationProp>();\n  const route = useRoute<JournalEntryDetailRouteProp>();\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n  const { entryId } = route.params;\n  \n  const [entry, setEntry] = useState<JournalEntry | null>(null);\n  const [isLoading, setIsLoading] = useState(true);\n  \n  // Unified edit state - everything is editable when enabled\n  const [isEditMode, setIsEditMode] = useState(false); // Start in view mode by default\n  const [editTitle, setEditTitle] = useState('');\n  const [editContent, setEditContent] = useState('');\n  const [editTags, setEditTags] = useState<Tag[]>([]);\n  const [isSaving, setIsSaving] = useState(false);\n  \n  // Animation values\n  const fadeAnim = useRef(new Animated.Value(0)).current;\n  const slideAnim = useRef(new Animated.Value(50)).current;\n  const scaleAnim = useRef(new Animated.Value(0.95)).current;\n  const scrollY = useRef(new Animated.Value(0)).current;\n  \n  // Text input refs to handle focus issues\n  const titleInputRef = useRef<TextInput>(null);\n  const contentInputRef = useRef<TextInput>(null);\n  \n  // Animated header\n  const headerOpacity = scrollY.interpolate({\n    inputRange: [0, 100],\n    outputRange: [0, 1],\n    extrapolate: 'clamp',\n  });\n\n  const headerScale = scrollY.interpolate({\n    inputRange: [0, 100],\n    outputRange: [0.8, 1],\n    extrapolate: 'clamp',\n  });\n  \n  useFocusEffect(\n    useCallback(() => {\n      fetchEntryDetails();\n      \n      return () => {\n        // Reset animations when leaving\n        fadeAnim.setValue(0);\n        slideAnim.setValue(50);\n        scaleAnim.setValue(0.95);\n      };\n    }, [entryId])\n  );\n\n  useEffect(() => {\n    if (entry) {\n      // Animate in the content\n      Animated.parallel([\n        Animated.timing(fadeAnim, {\n          toValue: 1,\n          duration: 600,\n          useNativeDriver: true,\n        }),\n        Animated.spring(slideAnim, {\n          toValue: 0,\n          tension: 80,\n          friction: 8,\n          useNativeDriver: true,\n        }),\n        Animated.spring(scaleAnim, {\n          toValue: 1,\n          tension: 80,\n          friction: 8,\n          useNativeDriver: true,\n        }),\n      ]).start();\n    }\n  }, [entry]);\n  \n  const fetchEntryDetails = async () => {\n    try {\n      setIsLoading(true);\n      const response = await JournalAPI.getEntry(String(entryId));\n      const entryData = response.data;\n      setEntry(entryData);\n      \n      // Initialize edit state\n      setEditTitle(entryData.title || '');\n      setEditContent(entryData.content || '');\n      setEditTags(entryData.tags || []);\n    } catch (error) {\n      console.error('Error fetching entry details', error);\n      Alert.alert('Error', 'Failed to load journal entry details');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  \n  const handleToggleEdit = () => {\n    hapticService.light();\n    setIsEditMode(!isEditMode);\n  };\n  \n  const handleSaveChanges = async () => {\n    if (!entry) {\n      console.error('No entry to save');\n      return;\n    }\n    \n    try {\n      setIsSaving(true);\n      hapticService.light();\n      \n      const updateData = {\n        title: editTitle,\n        content: editContent,\n        tags: editTags.map(tag => tag.name)\n      };\n      \n      const response = await JournalAPI.updateEntry(String(entryId), updateData);\n      console.log('Entry saved successfully');\n      \n      // Update local entry state with new values\n      const updatedEntry = {\n        ...entry,\n        title: editTitle,\n        content: editContent,\n        tags: editTags\n      };\n      setEntry(updatedEntry);\n      setIsEditMode(false);\n      \n      // Show success feedback\n      hapticService.success();\n    } catch (error) {\n      console.error('Error saving entry:', error);\n      Alert.alert('Error', `Failed to save changes: ${error instanceof Error ? error.message : 'Unknown error'}`);\n      hapticService.error();\n    } finally {\n      setIsSaving(false);\n    }\n  };\n  \n  const handleCancelEdit = () => {\n    hapticService.light();\n    // Reset to original values\n    if (entry) {\n      setEditTitle(entry.title || '');\n      setEditContent(entry.content || '');\n      setEditTags(entry.tags || []);\n    }\n    setIsEditMode(false);\n  };\n  \n  const handleDelete = async () => {\n    hapticService.medium();\n    navigation.navigate('DeleteConfirmation', { entryId });\n  };\n\n  const handleBack = () => {\n    hapticService.light();\n    if (isEditMode) {\n      // Ask to save or discard changes\n      Alert.alert(\n        'Unsaved Changes',\n        'You have unsaved changes. What would you like to do?',\n        [\n          {\n            text: 'Discard',\n            style: 'destructive',\n            onPress: () => {\n              handleCancelEdit();\n              navigation.goBack();\n            }\n          },\n          {\n            text: 'Save & Exit',\n            onPress: async () => {\n              await handleSaveChanges();\n              navigation.goBack();\n            }\n          },\n          {\n            text: 'Cancel',\n            style: 'cancel'\n          }\n        ]\n      );\n    } else {\n      navigation.goBack();\n    }\n  };\n  \n  if (isLoading) {\n    return (\n      <View style={styles.loadingContainer}>\n        <View style={styles.loadingContent}>\n          <ActivityIndicator size=\"large\" color={theme.colors.primary} />\n          <Text style={styles.loadingText}>Loading your entry...</Text>\n        </View>\n      </View>\n    );\n  }\n  \n  if (!entry) {\n    return (\n      <View style={styles.errorContainer}>\n        <View style={styles.errorContent}>\n          <Ionicons name=\"document-text-outline\" size={80} color={theme.colors.textSecondary} />\n          <Text style={styles.errorTitle}>Entry Not Found</Text>\n          <Text style={styles.errorText}>This journal entry might have been deleted or moved.</Text>\n          <TouchableOpacity \n            style={styles.errorButton}\n            onPress={handleBack}\n            activeOpacity={0.8}\n          >\n            <Ionicons name=\"arrow-back\" size={20} color={theme.colors.white} />\n            <Text style={styles.errorButtonText}>Go Back</Text>\n          </TouchableOpacity>\n        </View>\n      </View>\n    );\n  }\n\n  const entryDate = parseISO(entry.entry_date);\n  const isToday = format(new Date(), 'yyyy-MM-dd') === format(entryDate, 'yyyy-MM-dd');\n  const isYesterday = format(new Date(Date.now() - 86400000), 'yyyy-MM-dd') === format(entryDate, 'yyyy-MM-dd');\n\n  const getDateDisplayText = () => {\n    if (isToday) return 'Today';\n    if (isYesterday) return 'Yesterday';\n    return format(entryDate, 'EEEE, MMMM d');\n  };\n\n  return (\n    <SafeAreaView style={styles.container}>\n      {/* Floating Header */}\n      <Animated.View \n        style={[\n          styles.floatingHeader,\n          {\n            opacity: headerOpacity,\n            transform: [{ scale: headerScale }]\n          }\n        ]}\n      >\n        <TouchableOpacity \n          style={styles.headerBackButton}\n          onPress={handleBack}\n          activeOpacity={0.7}\n        >\n          <Ionicons name=\"arrow-back\" size={24} color={theme.colors.text} />\n        </TouchableOpacity>\n        <Text style={styles.floatingHeaderTitle} numberOfLines={1}>\n          {entry.title || 'Journal Entry'}\n        </Text>\n        <View style={styles.headerSpacer} />\n      </Animated.View>\n\n      {/* Main Header */}\n      <View style={styles.mainHeader}>\n        <TouchableOpacity \n          style={styles.backButton}\n          onPress={handleBack}\n          activeOpacity={0.7}\n        >\n          <Ionicons name=\"arrow-back\" size={28} color={theme.colors.text} />\n        </TouchableOpacity>\n        <View style={styles.headerActions}>\n          {isEditMode ? (\n            <>\n              <TouchableOpacity \n                style={[styles.headerActionButton, isSaving && { opacity: 0.5 }]}\n                onPress={() => {\n                  // Blur text inputs first to prevent focus interference on web\n                  titleInputRef.current?.blur();\n                  contentInputRef.current?.blur();\n                  handleSaveChanges();\n                }}\n                activeOpacity={0.7}\n                disabled={isSaving}\n              >\n                {isSaving ? (\n                  <ActivityIndicator size=\"small\" color={theme.colors.primary} />\n                ) : (\n                  <Ionicons name=\"checkmark\" size={24} color={theme.colors.success} />\n                )}\n              </TouchableOpacity>\n              <TouchableOpacity \n                style={styles.headerActionButton}\n                onPress={handleToggleEdit}\n                activeOpacity={0.7}\n              >\n                <Ionicons name=\"eye-outline\" size={24} color={theme.colors.primary} />\n              </TouchableOpacity>\n            </>\n          ) : (\n            <TouchableOpacity \n              style={styles.headerActionButton}\n              onPress={handleToggleEdit}\n              activeOpacity={0.7}\n            >\n              <Ionicons name=\"create-outline\" size={24} color={theme.colors.primary} />\n            </TouchableOpacity>\n          )}\n          <TouchableOpacity \n            style={[styles.headerActionButton, styles.deleteHeaderButton]}\n            onPress={handleDelete}\n            activeOpacity={0.7}\n          >\n            <Ionicons name=\"trash-outline\" size={24} color={theme.colors.error} />\n          </TouchableOpacity>\n        </View>\n      </View>\n      \n      <Animated.ScrollView\n        style={styles.scrollView}\n        showsVerticalScrollIndicator={false}\n        scrollEventThrottle={16}\n        onScroll={Animated.event(\n          [{ nativeEvent: { contentOffset: { y: scrollY } } }],\n          { useNativeDriver: false }\n        )}\n      >\n        <Animated.View \n          style={[\n            styles.content,\n            {\n              opacity: fadeAnim,\n              transform: [\n                { translateY: slideAnim },\n                { scale: scaleAnim }\n              ]\n            }\n          ]}\n        >\n          {/* Hero Date Section */}\n          <View style={styles.heroSection}>\n            <View style={styles.dateContainer}>\n              <Text style={styles.dateText}>{getDateDisplayText()}</Text>\n              <Text style={styles.fullDateText}>\n                {format(entryDate, 'MMMM d, yyyy')}\n              </Text>\n              <View style={styles.timeContainer}>\n                <Ionicons name=\"time-outline\" size={16} color={theme.colors.textSecondary} />\n                <Text style={styles.timeText}>\n                  {format(entryDate, 'h:mm a')}\n                </Text>\n              </View>\n            </View>\n            {entry.audio_url && (\n              <View style={styles.audioIndicator}>\n                <Ionicons name=\"musical-notes\" size={24} color={theme.colors.accent} />\n                <Text style={styles.audioText}>Audio</Text>\n              </View>\n            )}\n          </View>\n\n          {/* Unified Title and Content Section */}\n          <View style={styles.entrySection}>\n            <View style={styles.entryHeader}>\n              <Ionicons name=\"document-text\" size={20} color={theme.colors.primary} />\n              <Text style={styles.entryHeaderText}>Your Entry</Text>\n              {isEditMode && (\n                <Text style={styles.editModeIndicator}>Editing</Text>\n              )}\n            </View>\n            \n            {/* Title - Always Visible, Editable in Edit Mode */}\n            <View style={styles.titleSection}>\n              {isEditMode ? (\n                <TextInput\n                  ref={titleInputRef}\n                  style={styles.titleInput}\n                  value={editTitle}\n                  onChangeText={setEditTitle}\n                  placeholder=\"Enter title...\"\n                  multiline={false}\n                  maxLength={100}\n                />\n              ) : (\n                <Text style={styles.entryTitle}>\n                  {entry.title || 'Untitled Entry'}\n                </Text>\n              )}\n            </View>\n            \n            {/* Content - Always Visible, Editable in Edit Mode */}\n            <View style={styles.contentSection}>\n              {isEditMode ? (\n                <TextInput\n                  ref={contentInputRef}\n                  style={styles.contentInput}\n                  value={editContent}\n                  onChangeText={setEditContent}\n                  placeholder=\"What's on your mind?\"\n                  multiline={true}\n                  numberOfLines={8}\n                  textAlignVertical=\"top\"\n                />\n              ) : (\n                <Text style={styles.entryText}>{entry.content}</Text>\n              )}\n            </View>\n\n            {/* Record Button - Available in Edit Mode */}\n            {isEditMode && (\n              <View style={styles.recordSection}>\n                <TouchableOpacity \n                  style={styles.recordButton}\n                  onPress={() => {\n                    hapticService.light();\n                    navigation.navigate('Record', { journalId: entryId });\n                  }}\n                  activeOpacity={0.8}\n                >\n                  <Ionicons name=\"mic\" size={20} color={theme.colors.white} />\n                  <Text style={styles.recordButtonText}>Record</Text>\n                </TouchableOpacity>\n              </View>\n            )}\n          </View>\n\n          {/* Tags Section - Always Editable */}\n          <View style={styles.tagsSection}>\n            <View style={styles.tagsHeader}>\n              <Ionicons name=\"pricetags\" size={20} color={theme.colors.primary} />\n              <Text style={styles.tagsHeaderText}>Tags</Text>\n              {!isEditMode && (\n                <View style={styles.tagCount}>\n                  <Text style={styles.tagCountText}>{entry.tags?.length || 0}</Text>\n                </View>\n              )}\n            </View>\n            \n            {isEditMode ? (\n              <TagInput\n                tags={editTags}\n                onChangeTags={setEditTags}\n                placeholder=\"Add tags...\"\n                maxTags={10}\n              />\n            ) : (\n              entry.tags && entry.tags.length > 0 && (\n                <View style={styles.tagsList}>\n                  {entry.tags.map((tag: Tag, index: number) => (\n                    <Animated.View \n                      key={tag.id ? String(tag.id) : `${entry.id}-tag-${index}`}\n                      style={[\n                        styles.tag,\n                        {\n                          transform: [{\n                            scale: fadeAnim.interpolate({\n                              inputRange: [0, 1],\n                              outputRange: [0.8, 1],\n                            })\n                          }]\n                        }\n                      ]}\n                    >\n                      <Text style={styles.tagText}>{tag.name}</Text>\n                    </Animated.View>\n                  ))}\n                </View>\n              )\n            )}\n          </View>\n\n          {/* Stats Section */}\n          <View style={styles.statsSection}>\n            <Text style={styles.statsTitle}>Entry Stats</Text>\n            <View style={styles.statsGrid}>\n              <View style={styles.statItem}>\n                <Ionicons name=\"text-outline\" size={24} color={theme.colors.primary} />\n                <Text style={styles.statValue}>\n                  {isEditMode ? editContent.length : entry.content.length}\n                </Text>\n                <Text style={styles.statLabel}>Characters</Text>\n              </View>\n              <View style={styles.statItem}>\n                <Ionicons name=\"library-outline\" size={24} color={theme.colors.accent} />\n                <Text style={styles.statValue}>\n                  {isEditMode \n                    ? editContent.split(' ').filter(word => word.length > 0).length \n                    : entry.content.split(' ').length\n                  }\n                </Text>\n                <Text style={styles.statLabel}>Words</Text>\n              </View>\n              <View style={styles.statItem}>\n                <Ionicons name=\"pricetags-outline\" size={24} color={theme.colors.secondary} />\n                <Text style={styles.statValue}>\n                  {isEditMode ? editTags.length : (entry.tags?.length || 0)}\n                </Text>\n                <Text style={styles.statLabel}>Tags</Text>\n              </View>\n            </View>\n          </View>\n        </Animated.View>\n      </Animated.ScrollView>\n      \n      {/* Floating Action Buttons */}\n      <Animated.View \n        style={[\n          styles.floatingActions,\n          {\n            opacity: fadeAnim,\n            transform: [{ translateY: slideAnim }]\n          }\n        ]}\n      >\n        <TouchableOpacity \n          style={[styles.fab, styles.editFab]} \n          onPress={handleToggleEdit}\n          activeOpacity={0.8}\n        >\n          <Ionicons name=\"create\" size={24} color={theme.colors.white} />\n        </TouchableOpacity>\n        \n        <TouchableOpacity \n          style={[styles.fab, styles.deleteFab]} \n          onPress={handleDelete}\n          activeOpacity={0.8}\n        >\n          <Ionicons name=\"trash\" size={24} color={theme.colors.white} />\n        </TouchableOpacity>\n      </Animated.View>\n    </SafeAreaView>\n  );\n};\n\n// Function to generate styles based on the theme\nconst getStyles = (theme: AppTheme) => StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: theme.colors.background,\n  },\n  loadingContainer: {\n    flex: 1,\n    backgroundColor: theme.colors.background,\n  },\n  loadingContent: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n    paddingHorizontal: theme.spacing.xl,\n  },\n  loadingText: {\n    fontSize: theme.typography.fontSizes.lg,\n    color: theme.colors.textSecondary,\n    marginTop: theme.spacing.lg,\n    fontFamily: theme.typography.fontFamilies.medium,\n  },\n  errorContainer: {\n    flex: 1,\n    backgroundColor: theme.colors.background,\n  },\n  errorContent: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n    paddingHorizontal: theme.spacing.xl,\n  },\n  errorTitle: {\n    fontSize: theme.typography.fontSizes.xxl,\n    fontWeight: 'bold',\n    color: theme.colors.text,\n    marginTop: theme.spacing.lg,\n    marginBottom: theme.spacing.md,\n    fontFamily: theme.typography.fontFamilies.bold,\n  },\n  errorText: {\n    fontSize: theme.typography.fontSizes.lg,\n    color: theme.colors.textSecondary,\n    textAlign: 'center',\n    marginBottom: theme.spacing.xl,\n    lineHeight: theme.typography.lineHeights.normal * theme.typography.fontSizes.lg,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  errorButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: theme.colors.primary,\n    paddingVertical: theme.spacing.lg,\n    paddingHorizontal: theme.spacing.xl,\n    borderRadius: theme.borderRadius.xl,\n    ...theme.shadows.md,\n  },\n  errorButtonText: {\n    color: theme.colors.white,\n    fontSize: theme.typography.fontSizes.lg,\n    fontWeight: '600',\n    marginLeft: theme.spacing.sm,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n  floatingHeader: {\n    position: 'absolute',\n    top: Platform.OS === 'ios' ? 44 : 0,\n    left: 0,\n    right: 0,\n    height: 60,\n    backgroundColor: theme.colors.card,\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: theme.spacing.lg,\n    zIndex: 1000,\n    ...theme.shadows.lg,\n    borderBottomWidth: 1,\n    borderBottomColor: theme.colors.border,\n  },\n  headerBackButton: {\n    width: 40,\n    height: 40,\n    borderRadius: 20,\n    backgroundColor: theme.colors.background,\n    justifyContent: 'center',\n    alignItems: 'center',\n    ...theme.shadows.sm,\n  },\n  floatingHeaderTitle: {\n    flex: 1,\n    fontSize: theme.typography.fontSizes.lg,\n    fontWeight: '600',\n    color: theme.colors.text,\n    textAlign: 'center',\n    marginHorizontal: theme.spacing.md,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n  headerSpacer: {\n    width: 40,\n  },\n  mainHeader: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: theme.spacing.lg,\n    paddingTop: Platform.OS === 'ios' ? 60 : theme.spacing.lg,\n    paddingBottom: theme.spacing.lg,\n    backgroundColor: theme.colors.background,\n  },\n  backButton: {\n    width: 44,\n    height: 44,\n    borderRadius: 22,\n    backgroundColor: theme.colors.card,\n    justifyContent: 'center',\n    alignItems: 'center',\n    ...theme.shadows.md,\n  },\n  headerActions: {\n    flexDirection: 'row',\n    gap: theme.spacing.md,\n  },\n  headerActionButton: {\n    width: 44,\n    height: 44,\n    borderRadius: 22,\n    backgroundColor: theme.colors.card,\n    justifyContent: 'center',\n    alignItems: 'center',\n    ...theme.shadows.md,\n  },\n  deleteHeaderButton: {\n    backgroundColor: theme.colors.errorLight + '20',\n  },\n  scrollView: {\n    flex: 1,\n  },\n  content: {\n    paddingHorizontal: theme.spacing.lg,\n    paddingBottom: 120, // Space for FABs\n  },\n  heroSection: {\n    backgroundColor: theme.colors.card,\n    borderRadius: theme.borderRadius.xxl,\n    padding: theme.spacing.xl,\n    marginBottom: theme.spacing.xl,\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'flex-start',\n    ...theme.shadows.lg,\n    borderWidth: theme.isDarkMode ? 1 : 0,\n    borderColor: theme.colors.border,\n  },\n  dateContainer: {\n    flex: 1,\n  },\n  dateText: {\n    fontSize: theme.typography.fontSizes.xxxl,\n    fontWeight: 'bold',\n    color: theme.colors.text,\n    marginBottom: theme.spacing.xs,\n    fontFamily: theme.typography.fontFamilies.bold,\n    letterSpacing: -1,\n  },\n  fullDateText: {\n    fontSize: theme.typography.fontSizes.lg,\n    color: theme.colors.textSecondary,\n    marginBottom: theme.spacing.sm,\n    fontFamily: theme.typography.fontFamilies.medium,\n  },\n  timeContainer: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: theme.colors.primaryLight + '20',\n    paddingHorizontal: theme.spacing.md,\n    paddingVertical: theme.spacing.sm,\n    borderRadius: theme.borderRadius.full,\n    alignSelf: 'flex-start',\n  },\n  timeText: {\n    fontSize: theme.typography.fontSizes.sm,\n    color: theme.colors.primary,\n    fontWeight: '600',\n    marginLeft: theme.spacing.xs,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n  audioIndicator: {\n    alignItems: 'center',\n    backgroundColor: theme.colors.accentLight + '20',\n    paddingHorizontal: theme.spacing.lg,\n    paddingVertical: theme.spacing.md,\n    borderRadius: theme.borderRadius.xl,\n    borderWidth: 2,\n    borderColor: theme.colors.accent + '30',\n  },\n  audioText: {\n    fontSize: theme.typography.fontSizes.xs,\n    color: theme.colors.accent,\n    fontWeight: '600',\n    marginTop: theme.spacing.xs,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n  entrySection: {\n    backgroundColor: theme.colors.card,\n    borderRadius: theme.borderRadius.xxl,\n    padding: theme.spacing.xl,\n    marginBottom: theme.spacing.xl,\n    ...theme.shadows.md,\n    borderWidth: theme.isDarkMode ? 1 : 0,\n    borderColor: theme.colors.border,\n  },\n  entryHeader: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginBottom: theme.spacing.lg,\n    paddingBottom: theme.spacing.md,\n    borderBottomWidth: 1,\n    borderBottomColor: theme.colors.border,\n  },\n  entryHeaderText: {\n    fontSize: theme.typography.fontSizes.lg,\n    fontWeight: '600',\n    color: theme.colors.text,\n    marginLeft: theme.spacing.sm,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n  entryTitle: {\n    fontSize: theme.typography.fontSizes.xxl,\n    fontWeight: 'bold',\n    color: theme.colors.text,\n    lineHeight: theme.typography.lineHeights.tight * theme.typography.fontSizes.xxl,\n    fontFamily: theme.typography.fontFamilies.bold,\n    letterSpacing: -0.5,\n    marginBottom: theme.spacing.lg,\n  },\n  entryText: {\n    fontSize: theme.typography.fontSizes.lg,\n    lineHeight: theme.typography.lineHeights.loose * theme.typography.fontSizes.lg,\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.regular,\n    letterSpacing: 0.3,\n  },\n  tagsSection: {\n    backgroundColor: theme.colors.card,\n    borderRadius: theme.borderRadius.xxl,\n    padding: theme.spacing.xl,\n    marginBottom: theme.spacing.xl,\n    ...theme.shadows.md,\n    borderWidth: theme.isDarkMode ? 1 : 0,\n    borderColor: theme.colors.border,\n  },\n  tagsHeader: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginBottom: theme.spacing.lg,\n    paddingBottom: theme.spacing.md,\n    borderBottomWidth: 1,\n    borderBottomColor: theme.colors.border,\n  },\n  tagsHeaderText: {\n    fontSize: theme.typography.fontSizes.lg,\n    fontWeight: '600',\n    color: theme.colors.text,\n    marginLeft: theme.spacing.sm,\n    flex: 1,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n  tagCount: {\n    backgroundColor: theme.colors.primary,\n    width: 24,\n    height: 24,\n    borderRadius: 12,\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  tagCountText: {\n    fontSize: theme.typography.fontSizes.xs,\n    color: theme.colors.white,\n    fontWeight: 'bold',\n    fontFamily: theme.typography.fontFamilies.bold,\n  },\n  tagsList: {\n    flexDirection: 'row',\n    flexWrap: 'wrap',\n    gap: theme.spacing.sm,\n  },\n  tag: {\n    backgroundColor: theme.colors.primaryLight + '20',\n    paddingHorizontal: theme.spacing.lg,\n    paddingVertical: theme.spacing.md,\n    borderRadius: theme.borderRadius.full,\n    borderWidth: 2,\n    borderColor: theme.colors.primary + '30',\n    ...theme.shadows.sm,\n  },\n  tagText: {\n    fontSize: theme.typography.fontSizes.sm,\n    color: theme.colors.primary,\n    fontWeight: '600',\n    fontFamily: theme.typography.fontFamilies.semiBold,\n    letterSpacing: 0.5,\n  },\n  statsSection: {\n    backgroundColor: theme.colors.card,\n    borderRadius: theme.borderRadius.xxl,\n    padding: theme.spacing.xl,\n    marginBottom: theme.spacing.xl,\n    ...theme.shadows.md,\n    borderWidth: theme.isDarkMode ? 1 : 0,\n    borderColor: theme.colors.border,\n  },\n  statsTitle: {\n    fontSize: theme.typography.fontSizes.lg,\n    fontWeight: '600',\n    color: theme.colors.text,\n    marginBottom: theme.spacing.lg,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n  statsGrid: {\n    flexDirection: 'row',\n    justifyContent: 'space-around',\n  },\n  statItem: {\n    alignItems: 'center',\n    flex: 1,\n  },\n  statValue: {\n    fontSize: theme.typography.fontSizes.xxl,\n    fontWeight: 'bold',\n    color: theme.colors.text,\n    marginTop: theme.spacing.sm,\n    marginBottom: theme.spacing.xs,\n    fontFamily: theme.typography.fontFamilies.bold,\n  },\n  statLabel: {\n    fontSize: theme.typography.fontSizes.sm,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.medium,\n  },\n  floatingActions: {\n    position: 'absolute',\n    bottom: Platform.OS === 'ios' ? 100 : 85,\n    right: theme.spacing.lg,\n    flexDirection: 'column',\n    gap: theme.spacing.md,\n  },\n  fab: {\n    width: 56,\n    height: 56,\n    borderRadius: 28,\n    justifyContent: 'center',\n    alignItems: 'center',\n    ...theme.shadows.xl,\n    elevation: 8,\n  },\n  editFab: {\n    backgroundColor: theme.colors.primary,\n  },\n  deleteFab: {\n    backgroundColor: theme.colors.error,\n  },\n  // Inline edit styles\n  editModeIndicator: {\n    marginLeft: 'auto',\n    padding: theme.spacing.sm,\n    borderRadius: theme.borderRadius.md,\n    backgroundColor: theme.colors.primaryLight + '20',\n    fontSize: theme.typography.fontSizes.sm,\n    fontWeight: '600',\n    color: theme.colors.primary,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n  titleSection: {\n    marginBottom: theme.spacing.lg,\n  },\n  titleInput: {\n    fontSize: theme.typography.fontSizes.lg,\n    fontWeight: '600',\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n    backgroundColor: theme.colors.inputBackground,\n    borderRadius: theme.borderRadius.lg,\n    padding: theme.spacing.lg,\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n    minHeight: 50,\n  },\n  contentSection: {\n    marginBottom: theme.spacing.lg,\n  },\n  contentInput: {\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.regular,\n    backgroundColor: theme.colors.inputBackground,\n    borderRadius: theme.borderRadius.lg,\n    padding: theme.spacing.lg,\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n    minHeight: 150,\n    lineHeight: theme.typography.lineHeights.loose * theme.typography.fontSizes.md,\n  },\n  recordSection: {\n    alignItems: 'center',\n  },\n  recordButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: theme.colors.primary,\n    paddingVertical: theme.spacing.lg,\n    paddingHorizontal: theme.spacing.xl,\n    borderRadius: theme.borderRadius.full,\n    ...theme.shadows.md,\n  },\n  recordButtonText: {\n    color: theme.colors.white,\n    fontSize: theme.typography.fontSizes.lg,\n    fontWeight: '600',\n    marginLeft: theme.spacing.sm,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n});\n\nexport default JournalEntryDetailScreen; ","import React, { useState, useEffect } from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  TextInput,\n  TouchableOpacity,\n  ActivityIndicator,\n  Alert,\n  Platform,\n  Switch\n} from 'react-native';\nimport { useNavigation, useRoute } from '@react-navigation/native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { format, addDays, addHours, parseISO } from 'date-fns';\nimport DateTimePicker from '@react-native-community/datetimepicker';\n\nimport api from '../../services/api';\nimport SafeScrollView from '../../components/SafeScrollView';\nimport { useAppTheme } from '../../contexts/ThemeContext';\nimport { AppTheme } from '../../config/theme';\n\nconst ReminderFormScreen = () => {\n  const navigation = useNavigation();\n  const route = useRoute();\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n  const { reminderId } = route.params as { reminderId?: string };\n  \n  const [title, setTitle] = useState('');\n  const [note, setNote] = useState('');\n  const [reminderDate, setReminderDate] = useState(new Date());\n  const [isEnabled, setIsEnabled] = useState(true);\n  \n  const [isLoading, setIsLoading] = useState(false);\n  const [isFetchingReminder, setIsFetchingReminder] = useState(false);\n  \n  // Fetch reminder data if editing an existing reminder\n  useEffect(() => {\n    if (reminderId) {\n      fetchReminderData();\n    }\n  }, [reminderId]);\n  \n  const fetchReminderData = async () => {\n    try {\n      setIsFetchingReminder(true);\n      const response = await api.reminder.getReminder(reminderId as string);\n      const reminder = response.data;\n      \n      setTitle(reminder.title || '');\n      setNote(reminder.note || '');\n      setReminderDate(new Date(reminder.reminder_time));\n      setIsEnabled(reminder.is_active);\n    } catch (error) {\n      console.error('Error fetching reminder data', error);\n      Alert.alert('Error', 'Failed to load reminder data');\n    } finally {\n      setIsFetchingReminder(false);\n    }\n  };\n  \n  const handleSave = async () => {\n    // Validate form\n    if (!title.trim()) {\n      Alert.alert('Error', 'Please enter a title for your reminder');\n      return;\n    }\n    \n    try {\n      setIsLoading(true);\n      \n      const reminderData = {\n        title,\n        note,\n        reminder_time: reminderDate.toISOString(),\n        is_active: isEnabled\n      };\n      \n      if (reminderId) {\n        // Update existing reminder\n        await api.reminder.updateReminder(reminderId as string, reminderData);\n        Alert.alert('Success', 'Reminder updated successfully');\n      } else {\n        // Create new reminder\n        await api.reminder.createReminder(reminderData);\n        Alert.alert('Success', 'Reminder created successfully');\n      }\n      \n      navigation.goBack();\n    } catch (error) {\n      console.error('Error saving reminder', error);\n      Alert.alert('Error', 'Failed to save reminder');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  \n  // Date functions\n  const addOneDay = () => {\n    setReminderDate(prevDate => addDays(prevDate, 1));\n  };\n  \n  const subtractOneDay = () => {\n    setReminderDate(prevDate => addDays(prevDate, -1));\n  };\n  \n  const addOneHour = () => {\n    setReminderDate(prevDate => addHours(prevDate, 1));\n  };\n  \n  const subtractOneHour = () => {\n    setReminderDate(prevDate => addHours(prevDate, -1));\n  };\n  \n  if (isFetchingReminder) {\n    return (\n      <View style={styles.loadingContainer}>\n        <ActivityIndicator size=\"large\" color={theme.colors.primary} />\n      </View>\n    );\n  }\n  \n  return (\n    <View style={styles.container}>\n      <SafeScrollView \n        style={styles.scrollContainer}\n        contentContainerStyle={styles.scrollContent}\n        keyboardShouldPersistTaps=\"handled\"\n      >\n        <View style={styles.formGroup}>\n          <Text style={styles.label}>Title</Text>\n          <TextInput\n            style={styles.input}\n            placeholder=\"Reminder title\"\n            value={title}\n            onChangeText={setTitle}\n            placeholderTextColor={theme.colors.textSecondary}\n          />\n        </View>\n        \n        <View style={styles.formGroup}>\n          <Text style={styles.label}>Note</Text>\n          <TextInput\n            style={styles.textArea}\n            multiline\n            numberOfLines={4}\n            placeholder=\"Add a note (optional)\"\n            value={note}\n            onChangeText={setNote}\n            textAlignVertical=\"top\"\n            placeholderTextColor={theme.colors.textSecondary}\n          />\n        </View>\n        \n        <View style={styles.formGroup}>\n          <Text style={styles.label}>Reminder Date & Time</Text>\n          \n          <View style={styles.dateDisplayContainer}>\n            <Text style={styles.dateText}>\n              {format(reminderDate, 'EEEE, MMMM d, yyyy')}\n            </Text>\n            <Text style={styles.timeText}>\n              {format(reminderDate, 'h:mm a')}\n            </Text>\n          </View>\n          \n          <View style={styles.dateControlsContainer}>\n            <View style={styles.dateControls}>\n              <TouchableOpacity\n                style={styles.controlButton}\n                onPress={subtractOneDay}\n              >\n                <Ionicons name=\"remove\" size={theme.typography.fontSizes.xl} color={theme.colors.textSecondary} />\n              </TouchableOpacity>\n              \n              <Text style={styles.controlLabel}>Date</Text>\n              \n              <TouchableOpacity\n                style={styles.controlButton}\n                onPress={addOneDay}\n              >\n                <Ionicons name=\"add\" size={theme.typography.fontSizes.xl} color={theme.colors.textSecondary} />\n              </TouchableOpacity>\n            </View>\n            \n            <View style={styles.dateControls}>\n              <TouchableOpacity\n                style={styles.controlButton}\n                onPress={subtractOneHour}\n              >\n                <Ionicons name=\"remove\" size={theme.typography.fontSizes.xl} color={theme.colors.textSecondary} />\n              </TouchableOpacity>\n              \n              <Text style={styles.controlLabel}>Time</Text>\n              \n              <TouchableOpacity\n                style={styles.controlButton}\n                onPress={addOneHour}\n              >\n                <Ionicons name=\"add\" size={theme.typography.fontSizes.xl} color={theme.colors.textSecondary} />\n              </TouchableOpacity>\n            </View>\n          </View>\n        </View>\n        \n        <View style={styles.switchContainer}>\n          <Text style={styles.label}>Enable Reminder</Text>\n          <Switch\n            trackColor={{ false: theme.colors.gray300, true: theme.colors.primary }}\n            thumbColor={isEnabled ? (theme.isDarkMode ? theme.colors.background : theme.colors.white) : theme.colors.gray100}\n            ios_backgroundColor={theme.colors.gray300}\n            onValueChange={setIsEnabled}\n            value={isEnabled}\n          />\n        </View>\n      </SafeScrollView>\n      \n      <View style={styles.buttonContainer}>\n        <TouchableOpacity\n          style={[styles.button, styles.cancelButton]}\n          onPress={() => navigation.goBack()}\n          disabled={isLoading}\n        >\n          <Text style={styles.cancelButtonText}>Cancel</Text>\n        </TouchableOpacity>\n        \n        <TouchableOpacity\n          style={[\n            styles.button, \n            styles.saveButton,\n            isLoading && styles.disabledButton\n          ]}\n          onPress={handleSave}\n          disabled={isLoading}\n        >\n          {isLoading ? (\n            <ActivityIndicator size=\"small\" color={theme.isDarkMode ? theme.colors.background : theme.colors.white} />\n          ) : (\n            <Text style={styles.saveButtonText}>Save</Text>\n          )}\n        </TouchableOpacity>\n      </View>\n    </View>\n  );\n};\n\n// Function to generate styles based on the theme\nconst getStyles = (theme: AppTheme) => StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: theme.colors.background,\n  },\n  loadingContainer: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n    backgroundColor: theme.colors.background,\n  },\n  scrollContainer: {\n    flex: 1,\n    paddingBottom: theme.spacing.md,\n  },\n  scrollContent: {\n    padding: theme.spacing.lg,\n  },\n  formGroup: {\n    marginBottom: theme.spacing.lg,\n  },\n  label: {\n    fontSize: theme.typography.fontSizes.md,\n    fontWeight: 'bold',\n    color: theme.colors.text,\n    marginBottom: theme.spacing.sm,\n    fontFamily: theme.typography.fontFamilies.bold,\n  },\n  input: {\n    backgroundColor: theme.isDarkMode ? theme.colors.gray800 : theme.colors.white,\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n    borderRadius: 5,\n    paddingHorizontal: theme.spacing.md,\n    paddingVertical: theme.spacing.sm,\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  textArea: {\n    backgroundColor: theme.isDarkMode ? theme.colors.gray800 : theme.colors.white,\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n    borderRadius: 5,\n    padding: theme.spacing.md,\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.text,\n    minHeight: 100,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  dateDisplayContainer: {\n    backgroundColor: theme.isDarkMode ? theme.colors.gray700 : theme.colors.gray100,\n    padding: theme.spacing.md,\n    borderRadius: 5,\n    marginBottom: theme.spacing.md,\n    alignItems: 'center',\n  },\n  dateText: {\n    fontSize: theme.typography.fontSizes.lg,\n    fontWeight: 'bold',\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.bold,\n  },\n  timeText: {\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.textSecondary,\n    marginTop: theme.spacing.xs,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  dateControlsContainer: {\n    flexDirection: 'row',\n    justifyContent: 'space-around',\n    marginBottom: theme.spacing.md,\n  },\n  dateControls: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: theme.isDarkMode ? theme.colors.gray700 : theme.colors.gray100,\n    padding: theme.spacing.sm,\n    borderRadius: 5,\n  },\n  controlButton: {\n    padding: theme.spacing.sm,\n  },\n  controlLabel: {\n    fontSize: theme.typography.fontSizes.sm,\n    color: theme.colors.text,\n    marginHorizontal: theme.spacing.sm,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n  switchContainer: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    paddingVertical: theme.spacing.md,\n    borderTopWidth: 1,\n    borderBottomWidth: 1,\n    borderColor: theme.colors.border,\n    marginTop: theme.spacing.md,\n    marginBottom: theme.spacing.lg,\n    paddingHorizontal: theme.spacing.xs,\n  },\n  buttonContainer: {\n    flexDirection: 'row',\n    justifyContent: 'space-around',\n    paddingVertical: theme.spacing.md,\n    paddingHorizontal: theme.spacing.lg,\n    borderTopWidth: 1,\n    borderTopColor: theme.colors.border,\n    backgroundColor: theme.colors.background,\n  },\n  button: {\n    borderRadius: 5,\n    paddingVertical: theme.spacing.md,\n    paddingHorizontal: theme.spacing.xl,\n    alignItems: 'center',\n    justifyContent: 'center',\n    minWidth: 120,\n  },\n  saveButton: {\n    backgroundColor: theme.colors.primary,\n  },\n  saveButtonText: {\n    color: theme.isDarkMode ? theme.colors.background : theme.colors.white,\n    fontSize: theme.typography.fontSizes.md,\n    fontWeight: 'bold',\n    fontFamily: theme.typography.fontFamilies.bold,\n  },\n  cancelButton: {\n    backgroundColor: theme.colors.gray200,\n  },\n  cancelButtonText: {\n    color: theme.isDarkMode ? theme.colors.text : theme.colors.textSecondary,\n    fontSize: theme.typography.fontSizes.md,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n  disabledButton: {\n    backgroundColor: theme.colors.disabled,\n  },\n});\n\nexport default ReminderFormScreen; ","import React, { useState } from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  TouchableOpacity,\n  SafeAreaView,\n  ActivityIndicator,\n} from 'react-native';\nimport { useNavigation, useRoute, RouteProp } from '@react-navigation/native';\nimport { StackNavigationProp } from '@react-navigation/stack';\nimport { Ionicons } from '@expo/vector-icons';\n\nimport { JournalAPI } from '../../services/api';\nimport { MainStackParamList } from '../../navigation/types';\nimport { useAppTheme } from '../../contexts/ThemeContext';\nimport { AppTheme } from '../../config/theme';\nimport hapticService from '../../services/hapticService';\n\ntype DeleteConfirmationRouteProp = RouteProp<MainStackParamList, 'DeleteConfirmation'>;\ntype DeleteConfirmationNavigationProp = StackNavigationProp<MainStackParamList, 'DeleteConfirmation'>;\n\nconst DeleteConfirmationScreen = () => {\n  const navigation = useNavigation<DeleteConfirmationNavigationProp>();\n  const route = useRoute<DeleteConfirmationRouteProp>();\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n  const { entryId } = route.params;\n  const [isDeleting, setIsDeleting] = useState(false);\n\n  const handleCancel = () => {\n    hapticService.light();\n    navigation.goBack();\n  };\n\n  const handleConfirmDelete = async () => {\n    if (isDeleting) return; // Prevent double-clicking\n    \n    try {\n      setIsDeleting(true);\n      hapticService.medium(); // Strong feedback for destructive action\n      console.log(`[DeleteConfirmation] Deleting entry with ID: ${entryId}`);\n      await JournalAPI.deleteEntry(String(entryId));\n      console.log('[DeleteConfirmation] Delete successful');\n      \n      hapticService.success(); // Success feedback\n      // Navigate back to the main tabs and then to Journal tab\n      navigation.navigate('MainTabs', {\n        screen: 'Journal',\n        params: { screen: 'JournalList' }\n      });\n    } catch (error) {\n      console.error('[DeleteConfirmation] Error deleting entry:', error);\n      // If entry was already deleted (404), treat as success\n      if (error && typeof error === 'object' && 'status' in error && error.status === 404) {\n        console.log('[DeleteConfirmation] Entry already deleted, treating as success');\n        hapticService.success(); // Success feedback for already deleted\n        navigation.navigate('MainTabs', {\n          screen: 'Journal',\n          params: { screen: 'JournalList' }\n        });\n      } else {\n        hapticService.error(); // Error feedback\n        // For other errors, go back to previous screen\n        navigation.goBack();\n      }\n    } finally {\n      setIsDeleting(false);\n    }\n  };\n\n  return (\n    <SafeAreaView style={styles.container}>\n      <View style={styles.content}>\n        <View style={styles.iconContainer}>\n          <Ionicons \n            name=\"trash-outline\" \n            size={theme.spacing.xxl * 2} \n            color={theme.colors.error} \n          />\n        </View>\n        \n        <Text style={styles.title}>Delete Journal Entry</Text>\n        \n        <Text style={styles.message}>\n          Are you sure you want to delete this journal entry? This action cannot be undone.\n        </Text>\n        \n        <View style={styles.buttonContainer}>\n          <TouchableOpacity \n            style={[styles.button, styles.cancelButton, isDeleting && { opacity: 0.5 }]}\n            onPress={handleCancel}\n            disabled={isDeleting}\n          >\n            <Text style={styles.cancelButtonText}>Cancel</Text>\n          </TouchableOpacity>\n          \n          <TouchableOpacity \n            style={[styles.button, styles.deleteButton, isDeleting && { opacity: 0.7 }]}\n            onPress={handleConfirmDelete}\n            disabled={isDeleting}\n          >\n            {isDeleting ? (\n              <ActivityIndicator size=\"small\" color={theme.colors.white} />\n            ) : (\n              <Text style={styles.deleteButtonText}>Delete</Text>\n            )}\n          </TouchableOpacity>\n        </View>\n      </View>\n    </SafeAreaView>\n  );\n};\n\nconst getStyles = (theme: AppTheme) => StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: theme.colors.background,\n  },\n  content: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n    paddingHorizontal: theme.spacing.xl,\n  },\n  iconContainer: {\n    width: theme.spacing.xxl * 3,\n    height: theme.spacing.xxl * 3,\n    borderRadius: theme.spacing.xxl * 1.5,\n    backgroundColor: theme.colors.error + '20',\n    justifyContent: 'center',\n    alignItems: 'center',\n    marginBottom: theme.spacing.xl,\n  },\n  title: {\n    fontSize: theme.typography.fontSizes.xxl,\n    fontWeight: 'bold',\n    color: theme.colors.text,\n    marginBottom: theme.spacing.md,\n    textAlign: 'center',\n    fontFamily: theme.typography.fontFamilies.bold,\n  },\n  message: {\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.textSecondary,\n    textAlign: 'center',\n    lineHeight: theme.typography.lineHeights.normal * theme.typography.fontSizes.md,\n    marginBottom: theme.spacing.xxl,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  buttonContainer: {\n    flexDirection: 'row',\n    width: '100%',\n    gap: theme.spacing.md,\n  },\n  button: {\n    flex: 1,\n    paddingVertical: theme.spacing.lg,\n    borderRadius: 12,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  cancelButton: {\n    backgroundColor: theme.colors.card,\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n  },\n  deleteButton: {\n    backgroundColor: theme.colors.error,\n  },\n  cancelButtonText: {\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.text,\n    fontWeight: '600',\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n  deleteButtonText: {\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.white,\n    fontWeight: '600',\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n});\n\nexport default DeleteConfirmationScreen; ","import React from 'react';\nimport { createStackNavigator } from '@react-navigation/stack';\nimport MainTabNavigator from './MainTabNavigator';\nimport RecordScreen from '../screens/main/RecordScreen';\nimport TagManagementScreen from '../screens/main/TagManagementScreen';\nimport { areSecretTagsEnabled } from '../config/featureFlags';\nimport TagDeleteConfirmationScreen from '../screens/main/TagDeleteConfirmationScreen';\nimport JournalEntryDetailScreen from '../screens/main/JournalEntryDetailScreen';\n\nimport ReminderFormScreen from '../screens/main/ReminderFormScreen';\nimport DeleteConfirmationScreen from '../screens/main/DeleteConfirmationScreen';\nimport { MainStackParamList } from './types';\n\nconst Stack = createStackNavigator<MainStackParamList>();\n\nconst MainNavigator = () => {\n  return (\n    <Stack.Navigator\n      screenOptions={{\n        headerShown: false,\n      }}\n    >\n      <Stack.Screen \n        name=\"MainTabs\" \n        component={MainTabNavigator}\n        options={{ headerShown: false }}\n      />\n      <Stack.Screen\n        name=\"Record\"\n        component={RecordScreen}\n        options={{\n          presentation: 'modal',\n          headerShown: false,\n        }}\n      />\n      {areSecretTagsEnabled() && (\n        <Stack.Screen\n          name=\"TagManagement\"\n          component={TagManagementScreen}\n          options={{\n            presentation: 'modal',\n            headerShown: false,\n          }}\n        />\n      )}\n      <Stack.Screen\n        name=\"TagDeleteConfirmation\"\n        component={TagDeleteConfirmationScreen}\n        options={{\n          presentation: 'modal',\n          headerShown: false,\n        }}\n      />\n      <Stack.Screen\n        name=\"JournalEntryDetail\"\n        component={JournalEntryDetailScreen}\n        options={{\n          headerShown: false, // Custom header in component\n        }}\n      />\n\n      <Stack.Screen\n        name=\"ReminderForm\"\n        component={ReminderFormScreen}\n        options={{\n          headerShown: true,\n          title: 'Reminder',\n          headerStyle: { backgroundColor: '#f8f9fa' },\n          headerTintColor: '#333',\n        }}\n      />\n      <Stack.Screen\n        name=\"DeleteConfirmation\"\n        component={DeleteConfirmationScreen}\n        options={{\n          presentation: 'modal',\n          headerShown: true,\n          title: 'Delete Entry',\n          headerStyle: { backgroundColor: '#f8f9fa' },\n          headerTintColor: '#333',\n        }}\n      />\n    </Stack.Navigator>\n  );\n};\n\nexport default MainNavigator; ","import React, { useEffect } from 'react';\nimport { createStackNavigator } from '@react-navigation/stack';\nimport { View, Text, ActivityIndicator, StyleSheet, Platform } from 'react-native';\n\nimport { useAuth } from '../contexts/AuthContext';\nimport { RootStackParamList } from './types';\nimport logger from '../utils/logger';\n\n// Stack Navigation\nimport AuthNavigator from './AuthNavigator';\nimport MainNavigator from './MainNavigator';\n\nconst Stack = createStackNavigator<RootStackParamList>();\n\nconst Navigation = () => {\n  const { isAuthenticated, isLoading, isInitialLoading, user } = useAuth();\n  \n  // Log navigation state for debugging\n  // console.log('[Navigation/index] Rendering - isAuthenticated:', isAuthenticated, 'isLoading:', isLoading); // Removed diagnostic log\n  useEffect(() => {\n    // Keep logger.info for general state overview\n    logger.info('Navigation state:', { \n      isLoading,\n      isInitialLoading,\n      isAuthenticated,\n      userExists: !!user,\n      platform: Platform.OS,\n      isDev: __DEV__\n    });\n  }, [isLoading, isInitialLoading, isAuthenticated, user]);\n\n  // Only show loading indicator for initial auth check, not for auth operations\n  if (isInitialLoading) {\n    return (\n      <View style={styles.container}>\n        <ActivityIndicator size=\"large\" color=\"#7D4CDB\" />\n        <Text style={styles.loadingText}>Loading...</Text>\n      </View>\n    );\n  }\n\n  return (\n    <Stack.Navigator screenOptions={{ headerShown: false }}>\n      {isAuthenticated ? (\n        // User is signed in\n        <Stack.Screen name=\"Main\" component={MainNavigator} />\n      ) : (\n        // User is not signed in\n        <Stack.Screen name=\"Auth\" component={AuthNavigator} />\n      )}\n    </Stack.Navigator>\n  );\n};\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n    backgroundColor: '#f8f9fa',\n  },\n  loadingText: {\n    marginTop: 10,\n    fontSize: 16,\n    color: '#333',\n  }\n});\n\nexport default Navigation; ","import React, { useEffect, useState, ReactNode } from 'react';\nimport { StatusBar, StatusBarStyle } from 'expo-status-bar';\nimport { SafeAreaProvider } from 'react-native-safe-area-context';\nimport { NavigationContainer } from '@react-navigation/native';\nimport { GestureHandlerRootView } from 'react-native-gesture-handler';\nimport { LogBox, View, Text, StyleSheet, Platform } from 'react-native';\nimport Constants from 'expo-constants';\n\nimport { AuthProvider } from './src/contexts/AuthContext';\nimport Navigation from './src/navigation';\nimport logger from './src/utils/logger';\nimport { ThemeProvider, useAppTheme } from './src/contexts/ThemeContext';\nimport { SettingsProvider } from './src/contexts/SettingsContext';\nimport { HiddenModeProvider } from './src/contexts/HiddenModeContext';\n// import { initializeAppInsights } from './src/services/appInsights'; // Commented out to fix linter error\n\ninterface ErrorBoundaryProps {\n  children: ReactNode;\n}\n\ninterface ErrorBoundaryState {\n  hasError: boolean;\n  error: Error | null;\n}\n\n// Error boundary component\nclass ErrorBoundary extends React.Component<ErrorBoundaryProps, ErrorBoundaryState> {\n  state: ErrorBoundaryState = { hasError: false, error: null };\n\n  static getDerivedStateFromError(error: Error): ErrorBoundaryState {\n    return { hasError: true, error };\n  }\n\n  componentDidCatch(error: Error, errorInfo: React.ErrorInfo): void {\n    logger.error('App error boundary caught error:', { error, errorInfo });\n  }\n\n  render(): React.ReactNode {\n    if (this.state.hasError) {\n      return (\n        <View style={styles.errorContainer}>\n          <Text style={styles.errorTitle}>Something went wrong!</Text>\n          <Text style={styles.errorMessage}>\n            {this.state.error?.toString() || 'An unexpected error occurred.'}\n          </Text>\n          <Text style={styles.errorHint}>Please reload the application.</Text>\n        </View>\n      );\n    }\n\n    return this.props.children;\n  }\n}\n\n// Ignore specific warnings\nLogBox.ignoreLogs([\n  'AsyncStorage has been extracted from react-native',\n  'Possible Unhandled Promise Rejection',\n  'Require cycle:',\n  // Add any other warnings you want to suppress\n]);\n\n// This component will now use the theme context\nconst AppContent = () => {\n  const { theme } = useAppTheme(); // Get theme from context\n  const [isInitialized, setIsInitialized] = useState(false);\n\n  useEffect(() => {\n    const initializeApp = async () => {\n      try {\n        if (__DEV__) {\n          logger.info('Running in development mode', {\n            platform: Platform.OS,\n            version: Platform.Version,\n            constants: Constants.expoConfig?.extra\n          });\n        }\n        \n        logger.info('App initialization completed');\n        \n        setIsInitialized(true);\n      } catch (error) {\n        logger.error('Failed to initialize app:', error);\n        // Still set initialized to true to avoid infinite loading\n        setIsInitialized(true);\n      }\n    };\n\n    initializeApp();\n  }, []);\n\n  // Map theme.colors.statusBar to StatusBarStyle\n  let statusBarStyle: StatusBarStyle = 'auto';\n  if (theme.colors.statusBar === 'dark-content') {\n    statusBarStyle = 'dark';\n  } else if (theme.colors.statusBar === 'light-content') {\n    statusBarStyle = 'light';\n  }\n\n  if (!isInitialized) {\n    // Use StyleSheet for initial loading to avoid theme dependency before provider\n    const initialStyles = StyleSheet.create({\n        loadingContainer: {\n            flex: 1,\n            justifyContent: 'center',\n            alignItems: 'center',\n            backgroundColor: '#FFFFFF', // Default light background before theme loads\n        }\n    });\n    return (\n      <View style={initialStyles.loadingContainer}>\n        <Text>Initializing app...</Text>\n      </View>\n    );\n  }\n\n  return (\n    <SafeAreaProvider>\n      <AuthProvider>\n        <ThemeProvider>\n          <SettingsProvider>\n            <HiddenModeProvider>\n              <NavigationContainer\n                onStateChange={() => {\n                  if (__DEV__) {\n                    logger.debug('Navigation state changed');\n                  }\n                }}\n                fallback={\n                  // Use StyleSheet for initial loading\n                  <View style={styles.loadingContainer}> \n                    <Text>Loading navigation...</Text>\n                  </View>\n                }\n              >\n                <Navigation />\n                <StatusBar style={statusBarStyle} /> {/* Use mapped style */}\n              </NavigationContainer>\n            </HiddenModeProvider>\n          </SettingsProvider>\n        </ThemeProvider>\n      </AuthProvider>\n    </SafeAreaProvider>\n  );\n};\n\nexport default function App() {\n  // initializeAppInsights(); // Commented out\n\n  return (\n    <ErrorBoundary>\n      <GestureHandlerRootView style={{ flex: 1 }}>\n        <ThemeProvider>\n          <SettingsProvider>\n            <HiddenModeProvider>\n              <AppContent />\n            </HiddenModeProvider>\n          </SettingsProvider>\n        </ThemeProvider>\n      </GestureHandlerRootView>\n    </ErrorBoundary>\n  );\n}\n\n// styles in App.tsx can remain for ErrorBoundary or truly global styles not covered by theme provider initially\nconst styles = StyleSheet.create({\n  loadingContainer: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n    // backgroundColor will be set by theme once AppContent loads,\n    // or use a default like in AppContent's initial loading state.\n  },\n  errorContainer: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n    padding: 20,\n    backgroundColor: '#f8f9fa', // This could also become theme.colors.background if ErrorBoundary is themed\n  },\n  errorTitle: {\n    fontSize: 24,\n    fontWeight: 'bold',\n    color: '#e74c3c', // This could also become theme.colors.error\n    marginBottom: 16,\n  },\n  errorMessage: {\n    fontSize: 16,\n    color: '#333',\n    marginBottom: 16,\n    textAlign: 'center',\n  },\n  errorHint: {\n    fontSize: 14,\n    color: '#666',\n  },\n});","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar [chunkIds, fn, priority] = deferred[i];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","var getProto = Object.getPrototypeOf ? (obj) => (Object.getPrototypeOf(obj)) : (obj) => (obj.__proto__);\nvar leafPrototypes;\n// create a fake namespace object\n// mode & 1: value is a module id, require it\n// mode & 2: merge all properties of value into the ns\n// mode & 4: return value when already ns object\n// mode & 16: return value when it's Promise-like\n// mode & 8|1: behave like require\n__webpack_require__.t = function(value, mode) {\n\tif(mode & 1) value = this(value);\n\tif(mode & 8) return value;\n\tif(typeof value === 'object' && value) {\n\t\tif((mode & 4) && value.__esModule) return value;\n\t\tif((mode & 16) && typeof value.then === 'function') return value;\n\t}\n\tvar ns = Object.create(null);\n\t__webpack_require__.r(ns);\n\tvar def = {};\n\tleafPrototypes = leafPrototypes || [null, getProto({}), getProto([]), getProto(getProto)];\n\tfor(var current = mode & 2 && value; typeof current == 'object' && !~leafPrototypes.indexOf(current); current = getProto(current)) {\n\t\tObject.getOwnPropertyNames(current).forEach((key) => (def[key] = () => (value[key])));\n\t}\n\tdef['default'] = () => (value);\n\t__webpack_require__.d(ns, def);\n\treturn ns;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.hmd = (module) => {\n\tmodule = Object.create(module);\n\tif (!module.children) module.children = [];\n\tObject.defineProperty(module, 'exports', {\n\t\tenumerable: true,\n\t\tset: () => {\n\t\t\tthrow new Error('ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: ' + module.id);\n\t\t}\n\t});\n\treturn module;\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.nmd = (module) => {\n\tmodule.paths = [];\n\tif (!module.children) module.children = [];\n\treturn module;\n};","__webpack_require__.p = \"/\";","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t792: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = (chunkId) => (installedChunks[chunkId] === 0);\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some((id) => (installedChunks[id] !== 0))) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkweb\"] = self[\"webpackChunkweb\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [477], () => (__webpack_require__(5036)))\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["logger","_createClass","Logger","_classCallCheck","enabled","this","isWeb","Platform","OS","logDirectory","FileSystem","documentDirectory","logFilePath","isDev","__DEV__","debugEnabled","suppressedWarnings","Set","initializeLogger","key","value","_initializeLogger","_asyncToGenerator","console","log","setupConsoleOverrides","getInfoAsync","exists","makeDirectoryAsync","intermediates","writeAsStringAsync","fileStatus","size","error","apply","arguments","_this","originalWarn","warn","_len","length","args","Array","_key","message","join","suppressedWarning","includes","Date","toISOString","_writeToFile","level","data","logEntry","getTimestamp","toUpperCase","JSON","stringify","encoding","UTF8","Error","code","_x","_x2","_x3","shouldLog","undefined","debug","writeToFile","info","shouldSuppressMessage","_getLogs","readAsStringAsync","warning","add","delete","getApiUrl","_Constants$expoConfig","_Constants$expoConfig2","hostname","window","location","Constants","expoConfig","extra","apiUrl","initialApiUrl","api","axios","create","withCredentials","headers","timeout","defaults","baseURL","interceptors","request","use","config","url","fullURL","replace","constructedUrl","startsWith","Promise","reject","_ref","_config$method","_config$method2","token","AsyncStorage","getItem","Authorization","method","FormData","response","_response$config$meth","status","_ref2","_error$response","_error$response2","_error$response3","_error$response4","_error$response5","_error$response6","_error$response6$data","_error$response7","_error$response7$data","_error$response8","_error$response8$data","_error$response9","_error$response10","originalRequest","originalError","_retry","refreshToken","accessToken","logout","substring","post","refresh_token","access_token","setItem","newAccessToken","common","retryConfig","_objectSpread","refreshError","_refreshError$respons","_refreshError$respons2","responseData","errors","isArray","detail","errorMessage","_ref3","removeItem","JournalAPI","getEntries","params","get","getEntry","id","createEntry","createEncryptedEntry","title","content","encrypted_content","encryption_iv","iv","encryption_salt","salt","encrypted_key","key_derivation_iterations","encryption_algorithm","algorithm","encryption_wrap_iv","wrapIv","entry_date","audio_url","tags","secret_tag_id","secret_tag_hash","updateEntry","put","deleteEntry","searchEntries","query","q","getEntriesBySecretTag","secretTagHash","ReminderAPI","getReminders","getReminder","createReminder","updateReminder","deleteReminder","TagsAPI","getTags","getRecentTags","limit","getEntriesByTag","tagName","createTag","_createTag","tag","updateTag","_updateTag","updates","_x4","_x5","deleteTag","_deleteTag","_x6","opaqueReady","ensureOpaqueReady","_ensureOpaqueReady","opaque","STORAGE_KEYS","OpaqueAuthService","_startRegistration","password","userIdentifier","_opaque$client$startR","startRegistration","clientRegistrationState","registrationRequest","registrationRequestLength","clientRegistrationStateLength","_finishRegistration","registrationResponse","storedState","_JSON$parse","parse","registrationResponseLength","passwordLength","registrationRecord","finishRegistration","_startLogin","result","startLogin","clientLoginState","startLoginRequest","startLoginRequestLength","clientLoginStateLength","loginRequest","_finishLogin","loginResponse","_JSON$parse2","loginResponseLength","loginResult","finishLogin","success","resultType","resultKeys","Object","keys","finishLoginRequest","sessionKey","exportKey","_x7","_x8","_register","name","email","opaque_registration_request","opaque_registration_response","session_id","opaque_registration_record","registrationRecordLength","registrationRecordSample","_x9","_x10","_x11","_login","_loginResponse$data","_finishResponse$data","startResult","client_credential_request","server_credential_response","sessionResult","finishResponse","client_credential_finalization","user","_x12","_x13","_hasRegistrationRecord","_getUserIdentifier","_clearOpaqueData","multiRemove","tempKeys","getAllKeys","filter","instance","opaqueAuth","getInstance","KEY_DERIVATION_INFO","opaqueKeyManager","OpaqueKeyManager","derivedKeys","Map","normalized","padLen","padded","repeat","binary","atob","bytes","Uint8Array","i","charCodeAt","_this$sessionKey","_this$sessionKey$cons","_this$exportKey","_this$exportKey$const","decodeBase64ToBytes","clear","sessionKeyType","sessionKeyConstructor","constructor","exportKeyType","exportKeyConstructor","_deriveTagIdKey","cacheKey","from","has","tagIdKey","deriveKey","set","_deriveEncryptionKey","encryptionKey","_deriveVaultKey","vaultKey","fill","values","_deriveKey","ikm","crypto","subtle","importKey","derivedBits","deriveBits","hash","TextEncoder","encode","AuthContext","createContext","AuthProvider","children","_useState","useState","_useState2","_slicedToArray","isAuthenticated","setIsAuthenticated","_useState3","_useState4","isLoading","setIsLoading","_useState5","_useState6","isInitialLoading","setIsInitialLoading","_useState7","_useState8","setUser","useEffect","checkAuthStatus","storedUser","storedSessionKey","storedExportKey","userData","userId","parseError","initialize","rehydrateError","clearOpaqueData","e","updateUser","_ref4","updatedUserData","newUser","opaqueLogin","_ref5","login","created_at","updated_at","opaqueRegister","_ref6","register","hasOpaqueSupport","_ref7","_jsx","Provider","useAuth","context","useContext","lightModeColors","primary","primaryLight","primaryDark","secondary","secondaryLight","background","surface","card","text","textSecondary","textDisabled","border","borderLight","notification","errorLight","successLight","warningLight","disabled","inputBackground","statusBar","shadow","onPrimary","onSurface","overlay","accent","accentLight","tabBarActive","tabBarInactive","black","white","gray50","gray100","gray200","gray300","gray400","gray500","gray600","gray700","gray800","gray900","skeleton","skeletonHighlight","darkModeColors","typography","fontFamilies","regular","medium","semiBold","bold","light","fontSizes","xs","sm","md","lg","xl","xxl","xxxl","display","lineHeights","tight","normal","loose","letterSpacing","wide","spacing","none","borderRadius","full","shadows","shadowColor","shadowOffset","width","height","shadowOpacity","shadowRadius","elevation","animations","duration","fast","slow","easing","ease","easeIn","easeOut","easeInOut","ThemeContext","ThemeProvider","systemColorScheme","Appearance","getColorScheme","isDarkMode","setIsDarkMode","useSystemTheme","setUseSystemThemeState","loadThemePreference","savedThemeMode","subscription","addChangeListener","colorScheme","remove","toggleTheme","newIsDarkMode","setUseSystemTheme","theme","colors","isSystemTheme","useAppTheme","SafeScrollView","forwardRef","ref","_ref$extraBottomPaddi","extraBottomPadding","contentContainerStyle","props","_objectWithoutProperties","_excluded","tabBarHeight","fabBottomMargin","extraSpacing","safeContentContainerStyle","paddingBottom","Math","max","fabHeight","ScrollView","showsVerticalScrollIndicator","keyboardShouldPersistTaps","scrollEventThrottle","displayName","styles","StyleSheet","container","flex","backgroundColor","paddingTop","statusBarHeight","header","flexDirection","alignItems","justifyContent","padding","borderBottomWidth","borderBottomColor","fontSize","fontWeight","color","closeButton","refreshButton","filterContainer","filterButton","paddingVertical","paddingHorizontal","marginHorizontal","activeFilter","filterText","activeFilterText","loadingContainer","loadingText","marginTop","logsContainer","logs","fontFamily","select","ios","android","default","webNotice","marginBottom","textAlign","codeBlock","footer","borderTopWidth","borderTopColor","clearButton","clearButtonText","visible","onClose","setLogs","loading","setLoading","setFilter","fetchLogs","logData","getLogs","filteredLogs","split","line","upperFilter","clearLogs","Modal","animationType","transparent","onRequestClose","_jsxs","SafeAreaView","style","View","TouchableOpacity","onPress","Ionicons","Text","ActivityIndicator","getStyles","button","minHeight","enabledButton","disabledButton","checkingButton","buttonText","marginLeft","disabledText","mode","confirmPassword","onSuccess","onError","_ref$disabled","_useAuth","authLoading","opaqueSupported","setOpaqueSupported","checkingSupport","setCheckingSupport","checkSupport","supported","handleAuth","trim","trimmedEmail","test","errorMsg","isButtonDisabled","WebBrowser","maybeCompleteAuthSession","scrollContainer","scrollContent","flexGrow","welcomeCard","borderColor","borderWidth","logoContainer","logo","subtitle","formCard","formHeader","formTitle","formSubtitle","errorContainer","errorText","inputContainer","inputWrapper","inputIcon","marginRight","input","eyeIcon","loginButton","dividerContainer","marginVertical","dividerLine","dividerText","googleButton","googleButtonText","registerCard","registerText","registerButton","registerButtonText","debugButton","alignSelf","debugButtonText","navigation","useNavigation","setEmail","setPassword","showPassword","setShowPassword","_useState9","_useState10","setErrorMessage","_useState11","_useState12","showLogViewer","setShowLogViewer","handleGoogleLogin","Image","source","resizeMode","TextInput","placeholder","onChangeText","keyboardType","autoCapitalize","autoCorrect","placeholderTextColor","secureTextEntry","OpaqueAuthButton","navigate","screen","LogViewer","headerContainer","backButton","logoCircle","appName","tagline","successContainer","successText","successTextContainer","signInLinkContainer","signInLinkText","passwordRequirements","requirementsTitle","requirementItem","requirementText","loginCard","loginText","loginButtonText","setName","setConfirmPassword","_useState13","_useState14","_useState15","_useState16","successMessage","setSuccessMessage","handleGoogleRegister","navigateToLogin","Stack","createStackNavigator","Navigator","initialRouteName","screenOptions","headerShown","Screen","component","LoginScreen","RegisterScreen","AudioPrewarmService","state","permissionsGranted","audioModeConfigured","isPrewarmed","lastPrewarmTime","prewarmPromise","_prewarmAudioSystem","now","performPrewarm","_performPrewarm","startTime","prewarmPermissions","prewarmAudioMode","_prewarmPermissions","Audio","granted","_prewarmAudioMode","setAudioModeAsync","allowsRecordingIOS","playsInSilentModeIOS","shouldDuckAndroid","playThroughEarpieceAndroid","staysActiveInBackground","_refreshPrewarm","prewarmAudioSystem","timeSinceLastPrewarm","readyForRecording","isReadyForRecording","SUPPORTED_LANGUAGES","region","validateLanguageCode","languageCode","some","lang","DEFAULT_SETTINGS","defaultLanguage","defaultEntryPrivacy","hiddenModeEnabled","hapticFeedbackEnabled","notificationsEnabled","reminderNotifications","dailyReminderTime","analyticsEnabled","crashReportsEnabled","autoSaveEnabled","autoRecordingEnabled","SETTINGS_STORAGE_KEY","SettingsService","settings","initialized","listeners","_initialize","storedSettings","parsed","settingsToValidate","validateSettings","saveSettings","err","String","_updateSetting","validatedValue","validateSingleSetting","_defineProperty","notifyListeners","_updateSettings","validatedUpdates","_resetToDefaults","_exportSettings","exportData","version","timestamp","_importSettings","jsonData","imported","validatedSettings","updateSettings","listener","currentKeys","newSettings","hasNewSettings","_saveSettings","settingsData","validated","entries","defaultValue","_this2","forEach","getSettings","HapticFeedbackType","HapticService","expoHaptics","Haptics","require","_isHapticEnabled","settingsService","_impact","type","ImpactMedium","isHapticEnabled","triggerExpoHaptic","triggerVibrationFallback","_triggerExpoHaptic","Selection","selectionAsync","ImpactLight","impactAsync","ImpactFeedbackStyle","Light","Medium","ImpactHeavy","Heavy","NotificationSuccess","notificationAsync","NotificationFeedbackType","Success","NotificationWarning","Warning","NotificationError","Vibration","vibrate","_selection","impact","_light","_medium","_heavy","_success","_warning","_error","useNativeDriver","variant","variantColors","getVariantColors","position","shadowContainer","overflow","touchable","opacity","icon","_ref$icon","_ref$size","_ref$variant","_ref$testID","testID","scaleAnim","useRef","Animated","Value","current","pulseAnim","rotateAnim","pulse","loop","sequence","timing","toValue","start","stop","rotation","interpolate","inputRange","outputRange","transform","scale","rotate","onPressIn","hapticService","parallel","spring","onPressOut","tension","friction","activeOpacity","ClientEncryptionService","_getUserSalt","saltBase64","localStorage","USER_SALT_KEY","binaryString","newSalt","getRandomValues","SALT_LENGTH","saltArray","saltBase64New","btoa","fromCharCode","_deriveKeyFromSecret","isWebCryptoAvailable","userSecret","_params$iterations","iterations","DEFAULT_ITERATIONS","encoder","keyMaterial","derivationSalt","getUserSalt","ALGORITHM","KEY_LENGTH","_getUserMasterKey","isInitialized","getExportKey","MASTER_INFO","_generateEntryKey","generateKey","_exportRawKey","raw","_wrapEntryKey","entryKey","masterKey","wrapped","encrypt","exportRawKey","_encryptPerUser","getUserMasterKey","generateEntryKey","IV_LENGTH","encryptedData","wrapEntryKey","encryptedArray","encryptedBase64","_toConsumableArray","ivBase64","wrapIvBase64","wrappedBase64","encryptedContent","wrappedKey","_decryptContent","map","char","ivArray","deriveKeyFromSecret","decryptedData","decrypt","decryptedContent","TextDecoder","decode","_verifyUserSecret","decryptContent","_x14","_clearEncryptionData","KEY_DERIVATION_PARAMS_KEY","charset","randomBytes","byte","_testEncryption","testContent","testSecret","encrypted","encryptContent","clientEncryption","HiddenModeContext","HiddenModeProvider","isHiddenMode","setIsHiddenMode","isSetupRequired","setIsSetupRequired","isUnlocked","setIsUnlocked","setUserSecret","sessionTimeoutMinutes","setSessionTimeoutMinutes","sessionEndTime","setSessionEndTime","sessionTimer","setSessionTimer","HIDDEN_MODE_SETUP_KEY","VERIFICATION_DATA_KEY","SESSION_TIMEOUT_KEY","checkSetupStatus","useCallback","setupCompleted","verificationData","storedTimeout","parseInt","setupHiddenMode","secret","testEncryption","startSessionTimer","unlockHiddenMode","verificationDataJson","lockHiddenMode","clearTimeout","clearHiddenMode","clearEncryptionData","endTime","timer","setTimeout","extendSession","getRemainingSessionTime","floor","setSessionTimeoutWithPersistence","minutes","toString","_ref8","setSessionTimeout","useHiddenMode","pressed","dateContainer","date","time","audioIndicator","lineHeight","tagsContainer","flexWrap","tagText","moreTagsIndicator","moreTagsText","accentLine","bottom","left","right","borderBottomLeftRadius","borderBottomRightRadius","entry","isPressed","setIsPressed","formattedDate","format","parseISO","formattedTime","animatedStyle","Pressable","numberOfLines","maxLength","getPreviewText","slice","index","_tag$id","secretTagIndicator","secretTagText","_ref$showSecretTagInd","showSecretTagIndicator","_ref$secretTagText","TIME_GREETINGS","morning","afternoon","evening","nightOwl","TimePeriod","getCurrentTimePeriod","hour","getHours","MORNING","AFTERNOON","EVENING","NIGHT_OWL","getDynamicGreeting","userName","timePeriod","timeGreetings","mainIndex","arrayLength","seed","toDateString","abs","getRotationIndex","mainGreeting","greetingContainer","greetingCard","greetingContent","greeting","statsContainer","gap","statCard","streakCard","statIcon","statValue","streakValue","weekValue","statLabel","sectionHeader","sectionTitle","seeAllText","emptyContainer","emptyText","startButton","startButtonText","vibeContainer","vibeTitle","vibeButtonsContainer","vibeButton","vibeIcon","vibeLabel","recentEntries","setRecentEntries","totalEntries","currentStreak","entriesThisWeek","stats","setStats","refreshing","setRefreshing","greetingData","useMemo","full_name","displayedEntries","useFocusEffect","React","fetchData","ids","uniqueIds","displayedIds","uniqueDisplayedIds","_entriesResponse$data","_entriesResponse$data2","statsResponse","total_entries","current_streak","entries_this_week","entriesResponse","sort","Alert","alert","handleVibePress","vibeId","prompt","grateful","reflect","inspired","stressed","plan","vibeEmoji","vibeTag","prefilledPrompt","ScreenHeader","refreshControl","RefreshControl","onRefresh","tintColor","JournalCard","entryId","SkeletonLoader","_ref$width","_ref$height","_ref$borderRadius","_ref$animated","animated","animatedValue","animation","JournalCardSkeleton","journalCardSkeleton","journalCardHeader","journalCardFooter","CalendarSkeleton","calendarSkeleton","calendarHeader","calendarGrid","_","margin","SettingsSkeleton","settingsSkeleton","settingsRow","settingsRowLeft","settingsRowText","Dimensions","HIDDEN_ENTRY_TAG","searchContainer","searchBar","searchIcon","searchInput","tagChip","tagChipSelected","tagTextSelected","loaderContainer","skeletonContainer","emptySubtext","listContent","monthSection","monthTitle","safeBottomPadding","scrollToTopButton","zIndex","setEntries","filteredEntries","setFilteredEntries","isRefreshing","setIsRefreshing","searchQuery","setSearchQuery","availableTags","setAvailableTags","selectedTags","setSelectedTags","scrollViewRef","scrollPosition","offset","shouldRestoreScroll","saveScrollPosition","fetchEntries","_response$data$entrie","_response$data","fetchTags","restoreScrollPosition","_scrollViewRef$curren","scrollTo","y","filterEntries","processedEntries","toLowerCase","every","selectedTagName","tagObject","showScrollToTop","setShowScrollToTop","handleScroll","event","contentOffset","nativeEvent","scrollToTop","horizontal","showsHorizontalScrollIndicator","t","concat","toggleTag","onScroll","_Fragment","grouped","monthYear","push","getSectionData","section","sectionIndex","entryIndex","handleEntryPress","OpaqueError","_Error","cause","_callSuper","setPrototypeOf","prototype","_inherits","stack","_wrapNativeSuper","AuthenticationError","_OpaqueError","NetworkError","_OpaqueError2","statusCode","_this3","_OpaqueError3","InitializationError","_this4","_OpaqueError4","MemoryError","_this5","_OpaqueError5","KeyDerivationError","_this6","_OpaqueError6","SerializationError","_this7","SecureMemory","sensitiveData","OpaqueClient","ensureInitialized","clientState","registrationUpload","credentialRequest","credentialResponse","credentialFinalization","_deriveVaultKeys","secretPhrase","tagId","blake2s","dataKey","hkdf","vaultId","bytesToHex","clearAll","_blake2s","outputLength","digest","_hkdf","infoBuffer","_x15","_x16","b","padStart","voicePhraseDetector","VoicePhraseDetector","activeSessions","sessionTimeouts","SESSION_TIMEOUT_MS","MAX_AUTHENTICATION_TIME_MS","PHRASE_NORMALIZATION_REGEX","opaqueClient","_checkForSecretPhrase","transcribedText","found","normalizedPhrase","normalizePhrase","isPanicPhrase","handlePanicMode","action","authResult","authenticateWithOPAQUE","isSessionActive","createSession","deactivateSession","_authenticateWithOPAQUE","phrase","getAvailableSecretTags","authenticate","deriveVaultKey","elapsedTime","_getAvailableSecretTags","_createSession","sessionData","createdAt","expiresAt","timeoutId","_deactivateSession","session","_handlePanicMode","tagIds","clearMemory","panic","_cleanup","_Dimensions$get","isDesktop","calendarMaxWidth","calendarPadding","availableWidth","dayCellSize","min","maxWidth","monthText","calendar","weekDays","weekDayText","daysContainer","dayContainer","selectedDayContainer","dayText","selectedDayText","entryIndicator","selectedEntryIndicator","selectedDateContainer","selectedDateText","addButton","entriesContainer","createButton","createButtonText","entriesListContainer","currentMonth","setCurrentMonth","selectedDate","setSelectedDate","allEntries","setAllEntries","filteredEntriesForSelectedDate","setFilteredEntriesForSelectedDate","hasActiveSecretTags","setHasActiveSecretTags","checkActiveSecretTags","getActiveSessions","interval","setInterval","clearInterval","visibleEntries","fetchEntriesForSelectedDate","allEntriesResponse","include_public","start_date","end_date","handleCreateEntry","renderDay","day","dayString","hasEntriesOnDay","entryDate","getFullYear","getMonth","getDate","isSelected","isSameDay","previousMonth","setMonth","nextMonth","startOfMonth","end","endOfMonth","eachDayOfInterval","getDaysInMonth","FlatList","renderItem","item","keyExtractor","scrollEnabled","nestedScrollEnabled","NotificationService","dailyReminderScheduled","_requestPermissions","canAskAgain","_scheduleDailyReminder","_settings$dailyRemind","Number","_settings$dailyRemind2","hours","isNaN","_cancelDailyReminder","_updateNotificationSettings","scheduleDailyReminder","cancelDailyReminder","_isConfigured","_getPermissionStatus","_showTestNotification","SettingsContext","SettingsProvider","setSettings","setError","initializeSettings","loadedSettings","subscribe","updatedSettings","updateSetting","notificationService","updateNotificationSettings","resetToDefaults","exportSettings","importSettings","contextValue","getSetting","useSettings","containerDisabled","containerNonInteractive","leftSection","iconContainer","textContainer","titleDisabled","subtitleDisabled","rightSection","chevronContainer","leftIcon","leftIconColor","rightElement","_ref$showChevron","showChevron","isInteractive","selection","accessibilityRole","accessibilityLabel","accessibilityHint","onValueChange","switchElement","Switch","trackColor","false","true","thumbColor","ios_backgroundColor","accessibilityState","checked","SettingsRow","rightContainer","selectedText","selectedTextDisabled","placeholderText","fontStyle","modalContainer","modalHeader","headerLeft","modalTitle","headerButton","doneButtonText","optionsList","optionItem","selectedOptionItem","optionItemDisabled","optionContent","optionLabel","selectedOptionLabel","optionLabelDisabled","optionSubtitle","optionSubtitleDisabled","options","selectedValue","_ref$placeholder","isModalVisible","setIsModalVisible","selectedOption","find","option","displayText","label","presentationStyle","selected","bounces","headerTouchable","headerIcon","titleContainer","headerAction","childrenContainer","_ref$initiallyExpande","collapsible","initiallyExpanded","centerContent","headerTitle","headerSpacer","profileBadge","profileBadgeText","statusText","timeText","versionText","bottomSpacing","scrollToTopButtonInner","_user$email","_useAppTheme","_useSettings","scrollToTopOpacity","languageOptions","handleSignOut","confirm","shouldShow","SettingsSection","charAt","SettingsSelector","SettingsToggle","pointerEvents","Tab","createBottomTabNavigator","getNavigatorStyles","tabBarStyle","tabBarLabelStyle","tabBarItemStyle","fabContainer","prewarmAudio","audioPrewarmService","metrics","getPerformanceMetrics","cleanup","handleRecordPress","catch","route","tabBarActiveTintColor","tabBarInactiveTintColor","tabBarIcon","iconName","focused","HomeScreen","tabBarLabel","JournalScreen","CalendarScreen","SettingsScreen","FloatingActionButton","FEATURE_FLAGS","ENABLE_SECRET_TAGS","ENABLE_OFFLINE_SECRET_TAGS","ENABLE_SECRET_TAG_CACHING","ENABLE_SECURITY_MODE_SWITCHING","ENABLE_BORDER_CROSSING_MODE","ENABLE_TEAM_COLLABORATION","ENABLE_CLOUD_BACKUP","DEV_FEATURE_OVERRIDES","getFeatureFlag","areSecretTagsEnabled","SpeechToTextService","maxRetries","retryDelay","_transcribeAudio","audioFilePath","languageCodes","_options$maxAlternati","maxAlternatives","_options$enableSecret","enableWordConfidence","enableSecretTagDetection","_validateLanguageCodes","_performTranscription","initialError","_initialError$respons","_retryWithTokenRefresh","_createTranscriptionError","audioPath","invalidCodes","_performTranscription2","_response$data$transc","formData","_createFormData","append","axiosInstance","transcript","_processTranscriptionResponse","_createFormData2","fetch","blob","fileName","mimeType","File","_uri$split$pop","fileInfo","uri","fileExtension","pop","fileType","_getAudioMimeType","extension","_processTranscriptionResponse2","_data$quality_metrics","_data$quality_metrics2","_data$quality_metrics3","_processedResult$secr","processedResult","detected_language_code","confidence","alternatives","word_confidence","language_confidence","quality_metrics","average_confidence","low_confidence_words","total_words","tagDetection","checkForSecretPhrase","secret_tag_detected","_handleOpaqueTagDetection","reason","toFixed","_handleOpaqueTagDetection2","detection","_retryWithTokenRefresh2","refreshResponse","errorType","_error$response$data","details","_result$secret_tag_de","overall","lowConfidenceRatio","recommendations","DEFAULT_OPTIONS","quality","autoStart","filePrefix","requestPermissionOnMount","maxDuration","RECORDING_DIR","mergedOptions","recording","setRecording","isRecording","setIsRecording","recordingDuration","setRecordingDuration","audioUri","setAudioUri","permissionGranted","setPermissionGranted","timerRef","startTimeRef","recordingInstanceRef","isRequestingPermissionRef","autoStartAttemptedRef","stopAndUnloadAsync","requestPermissionsAndSetupAudioMode","_yield$Audio$requestP","permissionError","ensureRecordingDirExists","stopRecording","finalDuration","getURI","startRecording","qualityPreset","web","newRecording","createAsync","currentTime","elapsed","didCancel","managePermissionsAndAutoStart","cleanupRecordingFile","deleteAsync","onOpen","onMessage","onInterimTranscript","onFinalTranscript","onTranscriptionError","onStatusUpdate","ws","wsStatus","setWsStatus","authToken","setAuthToken","then","onclose","onerror","onmessage","onopen","close","connect","readyState","WebSocket","OPEN","socketUrl","getWebSocketUrl","socket","send","language_code","errorEvent","disconnect","sendMessage","payload","useAudioRecorderLogic","onTranscriptionComplete","onCancel","_ref$autoStart","onAutoSave","transcriptSegments","setTranscriptSegments","currentSegmentTranscript","setCurrentSegmentTranscript","isTranscribingSegment","setIsTranscribingSegment","lastTranscriptionResult","setLastTranscriptionResult","showAlternatives","setShowAlternatives","selectedLanguage","setSelectedLanguage","waveAnim1","waveAnim2","_useAudioRecording","useAudioRecording","recordingError","isProcessing","setIsProcessing","processedUris","setProcessedUris","_useState17","_useState18","hasTranscribedAudio","setHasTranscribedAudio","isMountedRef","callbackCalledRef","stagger","stopAnimation","setValue","handleWebSocketError","handleInterimTranscript","prev","handleFinalTranscript","detectedLanguage","_useWebSocketTranscri","useWebSocketTranscription","disconnectWebSocket","setMode","handleDone","handleAcceptTranscript","fullTranscript","processSegment","_result$transcript","speechToTextService","transcribeAudio","qualityAssessment","getQualityAssessment","isSecretTagCommand","secretTagDetected","normalize","normalizedTranscript","isExactMatch","shouldTreatAsSecretTagCommand","capitalizedTranscript","newSegments","newTranscript","cleanupError","handleMicPress","heavy","canAcceptTranscript","handleLanguageChange","formatDuration","seconds","sanitizeText","SCREEN_HEIGHT","BottomSheet","_ref$snapPoints","snapPoints","_ref$initialSnapPoint","initialSnapPoint","_ref$enablePanGesture","enablePanGesture","_ref$backdropOpacity","backdropOpacity","translateY","backdropOpacity_","lastGestureY","currentSnapIndex","gestureTranslateY","snapPointsInPixels","point","useImperativeHandle","snapTo","onGestureEvent","translationY","onHandlerStateChange","oldState","State","ACTIVE","_event$nativeEvent","velocityY","currentY","targetSnapIndex","minDistance","Infinity","distance","combinedTranslateY","TouchableWithoutFeedback","backdrop","PanGestureHandler","bottomSheet","handle","absoluteFillObject","borderTopLeftRadius","borderTopRightRadius","maxHeight","selector","selectorDisabled","selectorContent","selectorLabel","selectorText","selectorTextDisabled","modalContent","modalSubtitle","searchInputWrapper","resultsCount","languageList","languageItem","selectedLanguageItem","languageInfo","languageName","selectedLanguageName","selectedLanguageCode","checkmarkContainer","emptyState","emptyStateText","emptyStateSubtext","onLanguageChange","modalVisible","setModalVisible","language","langPart","match","getLanguageName","filteredLanguages","returnKeyType","ListEmptyComponent","getItemLayout","initialNumToRender","maxToRenderPerBatch","windowSize","WaveformVisualization","waveformBars","animValue","random","topBar","topRightIcons","timerTextTopLeft","languageButton","lockButton","recordingButtonContainer","spacer","recordingButtonOuter","recordingButton","recordingButtonInner","stopIcon","recordingStatusText","transcriptCard","transcriptHeader","transcriptLabelContainer","transcriptLabel","saveButtonSmall","saveButtonSmallDisabled","saveButtonSmallText","transcriptTextInput","textAlignVertical","transcriptionContainer","transcriptionInput","transcriptionScroll","transcriptionContent","transcriptionText","alternativesScroll","transcriptionLoader","alternativesContainer","alternativesTitle","alternativeItem","alternativeText","alternativeConfidence","modalOverlay","modalCloseButton","saveButtonState","existingContent","onSaveWithCompleteText","isLanguageModalVisible","setLanguageModalVisible","pulseAnimRef","pulseAnimation","editedText","setEditedText","hasUserEdited","setHasUserEdited","effectiveSaveButtonState","isSaving","handleSavePress","textToSave","saveParts","currentTranscript","displayParts","getDisplayText","multiline","editable","alternative","round","LanguageSelector","cleanupAudioFile","onSave","onManualSave","onStateChange","onCommandDetected","_ref$isEditingInitial","isEditingInitialContent","_ref$startRecordingOn","startRecordingOnMount","logic","secret_tag_details","analyzeTranscriptionQuality","handleManualSave","AudioRecorderUI","SecretTagFloatingIndicator","activeTags","primaryTag","floatingContainer","floatingIndicator","colorCode","floatingBadge","floatingBadgeText","indicator","colorDot","compactContainer","compactIndicator","multipleTagsBadge","top","minWidth","multipleTagsText","ZeroKnowledgeEncryption","phraseKeys","deviceEntropy","_getSecureItem","SecureStore","getItemAsync","_setSecureItem","setItemAsync","_deleteSecureItem","deleteItemAsync","_isSecureStorageAvailable","isAvailableAsync","_getDeviceEntropy","storedEntropy","getSecureItem","DEVICE_INFO","base64ToArray","setSecureItem","arrayToBase64","requireAuthentication","authenticationPrompt","_initializePhraseKey","getDeviceEntropy","phraseBytes","combinedKeyMaterial","phraseSalt","phraseKey","phraseKeyInfo","savePhraseKeyInfo","_loadPhraseKey","getPhraseKeyInfo","_encryptEntryWithSecretPhrase","encryptWithKey","_decryptEntryWithSecretPhrase","encryptedEntry","decryptWithKey","_clearSecretPhraseEncryption","deletePhraseKeyInfo","_secureClearAllData","deleteSecureItem","PHRASE_KEYS_INFO","_encryptWithKey","entrySalt","wrapKey","encryptedKey","_decryptWithKey","decryptionKey","unwrapKey","_x17","_x18","_savePhraseKeyInfo","existingKeysStr","filteredKeys","_x19","_getPhraseKeyInfo","keysStr","_x20","_deletePhraseKeyInfo","_x21","array","base64","zeroKnowledgeEncryption","tagManager","LegacyTagManager","_getAllTags","newTag","updatedTag","_getTagById","getAllTags","_getTagsByIds","_getActiveSecretTags","_checkForSecretTagPhrases","_getSecretTags","_activateSecretTag","encryptedJournalService","EncryptedJournalService","_detectAndProcessSecretPhrase","existingTagId","processedContent","detectedTagId","checkForSecretTagPhrases","activateSecretTag","cleanedContent","phraseRegex","RegExp","_createEntry","entryData","secretTagId","forcePublic","optionDetectedTagId","detectAndProcessSecretPhrase","manuallyDetectedTagId","finalEntryData","targetSecretTagId","isPhraseKeyLoaded","createSecretTagEntry","createPublicEntry","createPerUserEncryptedEntry","_createPublicEntry","_createPerUserEncryptedEntry","enc","encryptPerUser","_createSecretTagEntry","encryptEntryWithSecretPhrase","targetTag","getActiveSecretTags","getSecretTags","_createSecretTagEntryUnencrypted","_getEntries","activeTagHashes","secret_tag_hashes","processEntries","_getEntry","_processEntries","activeTagIds","all","decryptSecretTagEntry","_decryptSecretTagEntry","decryptEntryWithSecretPhrase","_searchEntries","_updateEntry","_yield$this$detectAnd","encryptedUpdatePayload","_deleteEntry","onSaveComplete","onSaveError","journalId","setJournalId","setIsSaving","isMounted","isNavigatingRef","currentDataRef","performSave","currentData","audioUrl","_selectedDate$split$m","_selectedDate$split$m2","year","month","UTC","newEntry","newId","save","dataOverride","_ref3$silent","silent","_ref3$navigateOnSucce","navigateOnSuccess","savedId","finalData","contentContainer","recorderContainer","modalHandle","recorderContent","savingOverlay","_route$params","_route$params2","_route$params3","_route$params4","useRoute","showRecorder","hasStartedSaving","setHasStartedSaving","setActiveTags","setTitle","setContent","originalContent","setOriginalContent","setTags","_useState19","_useState20","_useState21","_useState22","setIsLoadingExistingEntry","loadExistingEntry","_entry$tags","entryContent","mountedRef","_useJournalEntry","useJournalEntry","currentTags","canGoBack","goBack","loadActiveTags","activeTagsList","handleTranscriptionComplete","finalTranscript","finalAudioUri","finalContent","finalTitle","words","baseTitle","handleSaveWithCompleteText","completeText","handleRecorderCancel","handleClose","handleAutoSave","newTitle","saveData","getSaveButtonState","handleCommandDetected","hitSlop","AudioRecorder","indicatorGroup","indicatorText","sessionToggle","_ref$showSession","showSession","_ref$showSecurityLeve","showSecurityLevel","onSessionToggle","securityInfo","security_level","getSecurityLevelInfo","authInfo","auth_method","getAuthMethodInfo","device_fingerprint","migrated_from","description","warningContainer","warningHeader","warningTitle","warningText","warningTextBold","warningTips","warningTipTitle","warningTip","warningTipItem","warningBullet","successIcon","successTitle","successDetails","successLabel","successValue","successInstructions","successInstructionText","continueButton","continueButtonText","opaqueIndicatorContainer","securityNotice","borderLeftWidth","borderLeftColor","securityNoticeIcon","securityNoticeText","securityNoticeTextBold","authMethodContainer","authMethodTitle","authMethodOption","authMethodInfo","authMethodLabel","authMethodDescription","securityLevelContainer","securityLevelTitle","securityLevelDescription","securityInfoBox","securityInfoText","inputValid","inputError","validationContainer","validationSuccess","validationError","validationText","validationTextSuccess","validationTextError","colorGrid","colorOption","selectedColorOption","buttonContainer","cancelButton","cancelButtonText","onTagCreated","_ref$existingTagNames","existingTagNames","_ref$enableOpaqueAuth","enableOpaqueAuth","setTagName","activationPhrase","setActivationPhrase","confirmationPhrase","setConfirmationPhrase","selectedColor","setSelectedColor","useOpaqueAuth","securityLevel","setShowConfirmation","justCreated","setJustCreated","validateTagName","existing","validatePhrase","validateConfirmation","confirmation","handleCreateTag","nameError","phraseError","confirmError","_registrationRequest3","_registrationRequest4","_registrationRequest5","_registrationRecord3","phraseLength","secretTagIdentifier","_registrationRequest","_registrationRequest2","registrationRequestType","registrationRequestSample","registrationRequestFull","requestData","tag_name","opaque_registration_request_length","opaque_registration_request_type","opaque_registration_request_sample","tag_handle","_registrationRecord","_registrationRecord2","registrationRecordType","registrationRecordFull","registrationRequestValue","registrationRecordValue","validateBase64","urlSafeDecoded","paddedData","testDecode","serverResponse","secretTag","tag_id","createdTag","color_code","user_id","authentication_count","isOpaque","_response$data2","_response$data3","OpaqueTagIndicator","previewContainer","tagPreview","tagColorIndicator","tagPreviewText","canCreate","autoFocus","activeContainer","tagInfo","colorIndicator","tagDetails","tagDate","statusBadge","activeStatusBadge","activeStatusText","actions","actionButton","toggleButton","activeToggleButton","editButton","deleteButton","actionButtonText","activeActionButtonText","secondaryActionButtonText","activeInfo","activeInfoText","inactiveInfo","inactiveInfoText","dateString","isActive","onActivate","onDeactivate","onEdit","onDelete","handleToggleActivation","handleDeleteConfirmed","toLocaleDateString","tabContainer","tab","activeTab","tabText","activeTabText","regularTagCard","tagDeleteButton","fab","regularTags","setRegularTags","secretTags","setSecretTags","activeSecretTags","setActiveSecretTags","showSecretTagSetup","setShowSecretTagSetup","showRegularTagCreate","setShowRegularTagCreate","selectedTab","setSelectedTab","loadSecretTags","tagsData","loadTags","handleRefresh","handleRegularTagCreate","handleRegularTagCreated","handleRegularTagCreateCancelled","handleSecretTagActivate","credentials","body","ok","handleSecretTagDeactivate","newSet","handleSecretTagEdit","handleSecretTagDelete","handleSecretTagCreated","handleFABPress","renderRegularTag","_onPress","renderSecretTag","SecretTagCard","RegularTagCreate","SecretTagSetup","SESSION_METADATA","DEVICE_FINGERPRINT","LAST_APP_STATE","AsyncStorageAdapter","_store","serialized","_retrieve","_remove","_clear","sessionStorageManager","SessionStorageManager","deviceFingerprint","isAppInBackground","lastBackgroundTime","storageAdapter","setupAppStateHandling","initializeDeviceFingerprint","cleanupExpiredSessions","_storeSessionMetadata","sessions","persistenceData","isLocked","lastAccessed","accessCount","origin","store","_retrieveSessionMetadata","requireReauth","maxAge","allowPartialRecovery","retrieve","cutoffTime","getTime","validSessions","sessionMetadata","_removeSessionMetadata","filteredSessions","retrieveSessionMetadata","storeSessionMetadata","_clearSessionMetadata","wasBackgrounded","_initializeDeviceFingerprint","stored","generateDeviceFingerprint","_generateDeviceFingerprint","platform","Version","screenDimensions","userAgent","timezone","Intl","DateTimeFormat","resolvedOptions","timeZone","locale","navigator","fingerprintData","hashFingerprint","_hashFingerprint","jsonString","AppState","addEventListener","nextAppState","backgroundDuration","_cleanupExpiredSessions","_clearAll","opaqueTagManager","OpaqueTagManager","analyticsEvents","defaultSettings","enableDeviceBinding","requirePhraseConfirmation","sessionTimeout","maxSessionExtensions","enableAnalytics","loadAnalyticsEvents","_createOpaqueTag","getDeviceFingerprint","validateTagCreationRequest","generateTagId","opaqueTag","opaque_server_public_key","last_authentication","storeOpaqueTag","session_key","vault_key","expires_at","recordAnalyticsEvent","metadata","authMethod","session_data","operation","_authenticateOpaqueTag","getOpaqueTag","updateOpaqueTag","authenticationCount","_migrateToOpaque","legacyTag","newActivationPhrase","migrationRequest","activation_phrase","createOpaqueTag","legacyTagId","migrationDate","canMigrate","estimatedTime","securityBenefits","risks","requiresReAuth","_getOpaqueTags","getOpaqueTags","_getActiveTags","_sessionStorageManage","_activateTag","_deactivateTag","deleteOpaqueTag","_deleteOpaqueTag","removeOpaqueTag","substr","_createInitialSession","_storeOpaqueTag","_getOpaqueTag","_updateOpaqueTag","_removeOpaqueTag","_recordAnalyticsEvent","_loadAnalyticsEvents","warningMessage","secretTagWarning","warningSubtext","confirmationContainer","confirmationLabel","confirmationInput","deleteButtonText","tagType","isDeleting","setIsDeleting","confirmationText","setConfirmationText","showConfirmationInput","setShowConfirmationInput","isSecretTag","requiresConfirmation","confirmationRequired","handleDelete","canDelete","scrollView","tagButton","tagButtonSelected","tagButtonDisabled","tagContent","tagHeader","tagIcon","tagNameSelected","tagNameDisabled","tagMeta","tagMetaSelected","tagMetaDisabled","onTagSelect","_ref$maxTags","maxTags","recentTags","setRecentTags","loadRecentTags","formatLastUsed","lastUsed","diffInDays","selectedTag","isDisabled","tagToAdd","handleTagPress","last_used","usage_count","tagsScrollView","tagRemoveButton","suggestionsContainer","suggestionsTitle","suggestionsContent","suggestionChip","suggestionText","helpText","counterContainer","counterText","onChangeTags","_ref$suggestions","suggestions","inputValue","setInputValue","showSuggestions","setShowSuggestions","filteredSuggestions","setFilteredSuggestions","inputRef","fadeAnim","memoizedSuggestions","currentTagNames","filtered","suggestion","handleAddTag","newTagName","_inputRef$current","focus","handleRemoveTag","indexToRemove","updatedTags","RecentTagsSelector","onSubmitEditing","onKeyPress","preventDefault","onFocus","onBlur","handleSuggestionPress","loadingContent","errorContent","errorTitle","errorButton","errorButtonText","floatingHeader","headerBackButton","floatingHeaderTitle","mainHeader","headerActions","headerActionButton","deleteHeaderButton","heroSection","dateText","fullDateText","timeContainer","audioText","entrySection","entryHeader","entryHeaderText","entryTitle","entryText","tagsSection","tagsHeader","tagsHeaderText","tagCount","tagCountText","tagsList","statsSection","statsTitle","statsGrid","statItem","floatingActions","editFab","deleteFab","editModeIndicator","titleSection","titleInput","contentSection","contentInput","recordSection","recordButton","recordButtonText","_entry$tags2","setEntry","isEditMode","setIsEditMode","editTitle","setEditTitle","editContent","setEditContent","editTags","setEditTags","slideAnim","scrollY","titleInputRef","contentInputRef","headerOpacity","extrapolate","headerScale","fetchEntryDetails","handleToggleEdit","handleSaveChanges","updateData","updatedEntry","handleBack","isToday","isYesterday","_titleInputRef$curren","_contentInputRef$curr","blur","TagInput","word","formGroup","textArea","dateDisplayContainer","dateControlsContainer","dateControls","controlButton","controlLabel","switchContainer","saveButton","saveButtonText","reminderId","note","setNote","reminderDate","setReminderDate","isEnabled","setIsEnabled","isFetchingReminder","setIsFetchingReminder","fetchReminderData","reminder","reminder_time","is_active","handleSave","reminderData","prevDate","addDays","addHours","handleConfirmDelete","MainTabNavigator","RecordScreen","presentation","TagManagementScreen","TagDeleteConfirmationScreen","JournalEntryDetailScreen","ReminderFormScreen","headerStyle","headerTintColor","DeleteConfirmationScreen","userExists","MainNavigator","AuthNavigator","ErrorBoundary","_React$Component","hasError","errorInfo","_this$state$error","errorHint","LogBox","ignoreLogs","AppContent","setIsInitialized","initializeApp","statusBarStyle","initialStyles","SafeAreaProvider","NavigationContainer","fallback","Navigation","StatusBar","App","GestureHandlerRootView","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","loaded","__webpack_modules__","call","m","deferred","O","chunkIds","fn","priority","notFulfilled","fulfilled","j","splice","r","n","getter","__esModule","d","a","leafPrototypes","getProto","getPrototypeOf","obj","ns","def","indexOf","getOwnPropertyNames","definition","o","defineProperty","enumerable","g","globalThis","Function","hmd","prop","hasOwnProperty","Symbol","toStringTag","nmd","paths","p","installedChunks","chunkId","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","chunkLoadingGlobal","self","bind","__webpack_exports__"],"sourceRoot":""}