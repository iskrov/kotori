{"version":3,"file":"static/js/main.f81ac833.js","mappings":"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","sources":["src/utils/logger.ts","src/services/api.ts","src/services/opaqueAuth.ts","src/services/opaqueKeyManager.ts","src/contexts/AuthContext.tsx","src/config/theme.ts","src/contexts/ThemeContext.tsx","src/components/SafeScrollView.tsx","src/utils/LogViewer.tsx","src/components/OpaqueAuthButton.tsx","src/screens/auth/LoginScreen.tsx","src/screens/auth/RegisterScreen.tsx","src/navigation/AuthNavigator.tsx","src/services/audioPrewarmService.ts","src/config/languageConfig.ts","src/services/settingsService.ts","src/services/hapticService.ts","src/components/FloatingActionButton.tsx","src/services/clientEncryption.ts","src/contexts/HiddenModeContext.tsx","src/components/JournalCard.tsx","src/components/ScreenHeader.tsx","src/services/greetingService.ts","src/screens/main/HomeScreen.tsx","src/components/SkeletonLoader.tsx","src/screens/main/JournalScreen.tsx","src/services/crypto/errors.ts","src/services/crypto/OpaqueClient.ts","src/services/VoicePhraseDetector.ts","src/screens/main/CalendarScreen.tsx","src/services/notificationService.ts","src/contexts/SettingsContext.tsx","src/components/settings/SettingsRow.tsx","src/components/settings/SettingsToggle.tsx","src/components/settings/SettingsSelector.tsx","src/components/settings/SettingsSection.tsx","src/screens/main/SettingsScreen.tsx","src/navigation/MainTabNavigator.tsx","src/config/featureFlags.ts","src/services/speechToText.ts","src/hooks/useAudioRecording.ts","src/hooks/useWebSocketTranscription.ts","src/hooks/useAudioRecorderLogic.ts","src/components/BottomSheet.tsx","src/components/LanguageSelector.tsx","src/components/AudioRecorderUI.tsx","src/components/AudioRecorder.tsx","src/components/SecretTagIndicator.tsx","src/services/zeroKnowledgeEncryption.ts","src/services/tagManager.ts","src/services/encryptedJournalService.ts","src/hooks/useJournalEntry.ts","src/screens/main/RecordScreen.tsx","src/components/OpaqueTagIndicator.tsx","src/components/SecretTagSetup.tsx","src/components/RegularTagCreate.tsx","src/components/SecretTagCard.tsx","src/screens/main/TagManagementScreen.tsx","src/services/SessionStorageManager.ts","src/services/OpaqueTagManager.ts","src/screens/main/TagDeleteConfirmationScreen.tsx","src/components/RecentTagsSelector.tsx","src/components/TagInput.tsx","src/screens/main/JournalEntryDetailScreen.tsx","src/screens/main/ReminderFormScreen.tsx","src/screens/main/DeleteConfirmationScreen.tsx","src/navigation/MainNavigator.tsx","src/navigation/index.tsx","App.tsx","webpack/bootstrap","webpack/runtime/chunk loaded","webpack/runtime/compat get default export","webpack/runtime/create fake namespace object","webpack/runtime/define property getters","webpack/runtime/global","webpack/runtime/harmony module decorator","webpack/runtime/hasOwnProperty shorthand","webpack/runtime/make namespace object","webpack/runtime/node module decorator","webpack/runtime/publicPath","webpack/runtime/jsonp chunk loading","webpack/startup"],"sourcesContent":["import * as FileSystem from 'expo-file-system';\nimport Constants from 'expo-constants';\nimport { Platform } from 'react-native';\n\ntype LogLevel = 'debug' | 'info' | 'warn' | 'error';\n\nclass Logger {\n  private logDirectory: string;\n  private logFilePath: string;\n  private isWeb: boolean;\n  private enabled: boolean = true;\n  private isDev: boolean;\n  private debugEnabled: boolean;\n  private suppressedWarnings: Set<string>;\n\n  constructor() {\n    this.isWeb = Platform.OS === 'web';\n    this.logDirectory = this.isWeb ? '' : `${FileSystem.documentDirectory}logs/`;\n    this.logFilePath = this.isWeb ? '' : `${this.logDirectory}app.log`;\n    this.isDev = __DEV__;\n    this.debugEnabled = false; // Default to false, can be enabled via enableDebug()\n    this.suppressedWarnings = new Set([\n      'setNativeProps is deprecated', // Third-party library warning\n    ]);\n    this.initializeLogger();\n  }\n\n  private async initializeLogger() {\n    if (this.isWeb && !this.isDev) {\n      return; // Don't log initialization message in production web\n    }\n\n    if (this.isWeb && this.isDev) {\n      console.log('Logger initialized in web development mode');\n      this.setupConsoleOverrides();\n      return;\n    }\n\n    try {\n      const dirInfo = await FileSystem.getInfoAsync(this.logDirectory);\n      if (!dirInfo.exists) {\n        await FileSystem.makeDirectoryAsync(this.logDirectory, { intermediates: true });\n      }\n      \n      // Create log file if it doesn't exist\n      const fileInfo = await FileSystem.getInfoAsync(this.logFilePath);\n      if (!fileInfo.exists) {\n        await FileSystem.writeAsStringAsync(this.logFilePath, '--- Log Start ---\\n');\n      }\n      \n      // Keep log file size in check\n      const fileStatus = await FileSystem.getInfoAsync(this.logFilePath);\n      if (fileStatus.exists && fileStatus.size > 1024 * 1024) { // 1MB max log size\n        await FileSystem.writeAsStringAsync(this.logFilePath, '--- Log Rotated ---\\n');\n      }\n    } catch (error) {\n      console.error('Failed to initialize logger:', error);\n    }\n  }\n\n  private setupConsoleOverrides() {\n    if (!this.isWeb || !this.isDev) return;\n\n    // Override console.warn to filter out suppressed warnings\n    const originalWarn = console.warn;\n    console.warn = (...args: any[]) => {\n      const message = args.join(' ');\n      \n      // Check if this warning should be suppressed\n      for (const suppressedWarning of this.suppressedWarnings) {\n        if (message.includes(suppressedWarning)) {\n          return; // Suppress this warning\n        }\n      }\n      \n      // Allow the warning through\n      originalWarn.apply(console, args);\n    };\n  }\n\n  private getTimestamp(): string {\n    return new Date().toISOString();\n  }\n\n  private async writeToFile(level: LogLevel, message: string, data?: any) {\n    if (!this.enabled || this.isWeb) return;\n    \n    try {\n      let logEntry = `${this.getTimestamp()} [${level.toUpperCase()}] ${message}`;\n      if (data) {\n        logEntry += ` ${JSON.stringify(data, null, 2)}`;\n      }\n      logEntry += '\\n';\n      \n      await FileSystem.writeAsStringAsync(this.logFilePath, logEntry, { \n        encoding: FileSystem.EncodingType.UTF8 \n      });\n    } catch (error: unknown) {\n      if (error instanceof Error && (error as any).code === 'UNAVAILABLE' && this.isWeb) {\n        console.warn('Attempted to write log file on web, which is not supported.');\n      } else {\n        console.error('Failed to write to log file:', error);\n      }\n    }\n  }\n\n  private shouldLog(level: LogLevel): boolean {\n    if (!this.enabled) return false;\n    if (level === 'error' || level === 'warn') return true;\n    if (level === 'debug' && !this.debugEnabled) return false;\n    if (!this.isDev) return true;\n    return this.debugEnabled;\n  }\n\n  private shouldSuppressMessage(message: string): boolean {\n    for (const suppressedWarning of this.suppressedWarnings) {\n      if (message.includes(suppressedWarning)) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  public debug(message: string, data?: any) {\n    if (!this.shouldLog('debug')) return;\n    if (data !== undefined) {\n      console.debug(message, data);\n    } else {\n      console.debug(message);\n    }\n    this.writeToFile('debug', message, data);\n  }\n\n  public info(message: string, data?: any) {\n    if (!this.shouldLog('info')) return;\n    if (data !== undefined) {\n      console.info(message, data);\n    } else {\n      console.info(message);\n    }\n    this.writeToFile('info', message, data);\n  }\n\n  public warn(message: string, data?: any) {\n    // Check if this warning should be suppressed\n    if (this.shouldSuppressMessage(message)) {\n      return;\n    }\n\n    if (data !== undefined) {\n      console.warn(message, data);\n    } else {\n      console.warn(message);\n    }\n    this.writeToFile('warn', message, data);\n  }\n\n  public error(message: string, data?: any) {\n    if (data !== undefined) {\n      console.error(message, data);\n    } else {\n      console.error(message);\n    }\n    this.writeToFile('error', message, data);\n  }\n\n  public async getLogs(): Promise<string> {\n    if (this.isWeb) {\n      return 'Log files are not available in the web environment.';\n    }\n    \n    try {\n      return await FileSystem.readAsStringAsync(this.logFilePath);\n    } catch (error) {\n      console.error('Failed to read log file:', error);\n      return `Error reading logs: ${error}`;\n    }\n  }\n\n  public enable() {\n    this.enabled = true;\n  }\n\n  public disable() {\n    this.enabled = false;\n  }\n\n  public enableDebug() {\n    this.debugEnabled = true;\n  }\n\n  public disableDebug() {\n    this.debugEnabled = false;\n  }\n\n  public addSuppressedWarning(warning: string) {\n    this.suppressedWarnings.add(warning);\n  }\n\n  public removeSuppressedWarning(warning: string) {\n    this.suppressedWarnings.delete(warning);\n  }\n}\n\n// Export singleton instance\nexport const logger = new Logger();\nexport default logger; ","import axios from 'axios';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport Constants from 'expo-constants';\nimport { JournalEntryCreate, JournalEntryUpdate, User, Tag } from '../types';\nimport logger from '../utils/logger';\n\n// Define environment-based API URL\nconst getApiUrl = () => {\n  const ENV = process.env.NODE_ENV || 'development';\n  \n  if (ENV === 'production') {\n    return 'https://api.kotori.io';\n  } else if (ENV === 'staging') {\n    return 'https://staging.api.kotori.io';\n  } else {\n    // Local development - use local IP for the backend\n    const apiUrl = Constants.expoConfig?.extra?.apiUrl || 'http://localhost:8001';\n    logger.info(`Using API URL: ${apiUrl}`);\n    return apiUrl;\n  }\n};\n\n// Create axios instance\nexport const api = axios.create({\n  baseURL: getApiUrl(),\n  headers: {\n    'Content-Type': 'application/json',\n  },\n  timeout: 10000,\n  // Enable credentials for CORS\n  withCredentials: true, \n});\n\n// Debug axios configuration (guarded to avoid test-time undefined access)\ntry {\n  console.log('API Config:', {\n    baseURL: getApiUrl(),\n    withCredentials: true,\n    defaultHeaders: (api && api.defaults && api.defaults.headers) ? api.defaults.headers : undefined\n  });\n} catch (e) {\n  // Ignore logging failures in non-browser test environments\n}\n\n// Add specific debug configuration for handling PUT requests\napi.interceptors.request.use(\n  async (config) => {\n    // If this is a PUT request, add extra debug info\n    if (config.method?.toLowerCase() === 'put') {\n      console.log('Making PUT request to:', config.url);\n      console.log('PUT request headers:', config.headers);\n      console.log('PUT request withCredentials:', config.withCredentials);\n    }\n    return config;\n  },\n  (error) => {\n    return Promise.reject(error);\n  }\n);\n\n// Add request interceptor for authorization headers\napi.interceptors.request.use(\n  async (config) => {\n    try {\n      // Get the access token from storage\n      const token = await AsyncStorage.getItem('access_token');\n      \n      // If token exists, add to headers\n      if (token) {\n        config.headers.Authorization = `Bearer ${token}`;\n        logger.debug(`API Request: ${config.method?.toUpperCase()} ${config.url}`);\n      } else {\n        logger.debug(`Unauthenticated API Request: ${config.method?.toUpperCase()} ${config.url}`);\n      }\n      \n      // If sending FormData, remove the default Content-Type header\n      // to let the browser/axios set the correct multipart/form-data with boundary\n      if (config.data instanceof FormData) {\n        delete config.headers['Content-Type'];\n        logger.debug(`Removed Content-Type header for FormData request to ${config.url}`);\n      }\n      \n      return config;\n    } catch (error) {\n      logger.error('API Interceptor Error', error);\n      return config;\n    }\n  },\n  (error) => {\n    logger.error('API Request Error', error);\n    return Promise.reject(error);\n  }\n);\n\n// Add response interceptor for handling token refresh and errors\napi.interceptors.response.use(\n  (response) => {\n    logger.debug(`API Response: ${response.status} ${response.config.method?.toUpperCase()} ${response.config.url}`);\n    return response;\n  },\n  async (error) => {\n    const originalRequest = error.config;\n    \n    // Handle CORS errors\n    if (error.message && (\n        error.message.includes('Network Error') || \n        error.message.includes('CORS') || \n        error.message.includes('blocked by CORS policy'))) {\n      logger.error('CORS or Network Error', { \n        message: error.message,\n        url: originalRequest?.url,\n        method: originalRequest?.method\n      });\n      return Promise.reject({\n        message: 'Network or CORS error. Check that the backend server is running and properly configured.',\n        status: 0,\n        originalError: error.message\n      });\n    }\n    \n    // Handle network errors\n    if (!error.response) {\n      logger.error('Network Error', { \n        url: originalRequest?.url,\n        method: originalRequest?.method\n      });\n      return Promise.reject({\n        message: 'Network error. Please check your connection and try again.',\n        status: 0\n      });\n    }\n    \n    logger.error('API Error Response', {\n      status: error.response?.status,\n      url: originalRequest.url,\n      method: originalRequest.method,\n      data: error.response?.data\n    });\n    \n    // Handle 401 (Unauthorized) errors\n    if (error.response?.status === 401 && !originalRequest._retry) {\n      originalRequest._retry = true;\n      logger.info(`API Response: 401 Unauthorized for ${originalRequest.url}. Checking authentication type.`);\n      \n      try {\n        // Check if we have OPAQUE authentication (no refresh token)\n        const refreshToken = await AsyncStorage.getItem('refresh_token');\n        const accessToken = await AsyncStorage.getItem('access_token');\n        \n        if (!refreshToken && accessToken) {\n          // OPAQUE authentication - no refresh tokens available\n          logger.warn('OPAQUE authentication detected (no refresh token). User needs to re-authenticate.');\n          await logout();\n          return Promise.reject({\n            message: 'Session expired. Please login again.',\n            status: 401\n          });\n        }\n        \n        if (!refreshToken) {\n          // No refresh token available, logout user\n          logger.warn('No refresh token available, logging out user');\n          await logout();\n          return Promise.reject({\n            message: 'Session expired. No refresh token. Please login again.',\n            status: 401\n          });\n        }\n        \n        // Traditional authentication - attempt token refresh\n        logger.info('Attempting token refresh');\n        logger.info(`Calling /api/v1/auth/refresh with refresh token: ${refreshToken ? refreshToken.substring(0, 10) + '...' : 'null'}`);\n        const response = await axios.post(`${getApiUrl()}/api/v1/auth/refresh`, {\n          refresh_token: refreshToken,\n        });\n        \n        if (response.data.access_token) {\n          logger.info('Token refresh successful. New access token received.');\n          // Save new tokens\n          await AsyncStorage.setItem('access_token', response.data.access_token);\n          \n          if (response.data.refresh_token) {\n            await AsyncStorage.setItem('refresh_token', response.data.refresh_token);\n            logger.info('New refresh token also received and stored.');\n          }\n          \n          // Update header for the instance defaults and the original request\n          const newAccessToken = response.data.access_token;\n          api.defaults.headers.common['Authorization'] = `Bearer ${newAccessToken}`;\n          logger.info(`Retrying original request to ${originalRequest.url} with new token.`);\n          \n          // Create a new config for the retry based on the original request\n          const retryConfig = {\n            ...originalRequest,\n            headers: {\n              ...originalRequest.headers,\n              Authorization: `Bearer ${newAccessToken}`,\n            },\n          };\n\n          // Retry the original request using the base axios with the new config\n          return axios(retryConfig);\n        }\n      } catch (refreshError: any) {\n        // If refresh fails, logout user\n        logger.error('Token refresh failed', { \n          message: refreshError.message, \n          status: refreshError.response?.status,\n          data: refreshError.response?.data \n        });\n        await logout();\n        return Promise.reject({\n          message: 'Session expired. Token refresh failed. Please login again.',\n          status: 401,\n          originalError: refreshError.message\n        });\n      }\n    }\n    \n    // Handle validation errors (422 Unprocessable Entity)\n    if (error.response?.status === 422) {\n      const responseData = error.response.data;\n      \n      if (responseData.errors && Array.isArray(responseData.errors)) {\n        logger.warn('Validation Error', {\n          errors: responseData.errors,\n          url: originalRequest.url\n        });\n        return Promise.reject({\n          message: responseData.detail || 'Validation error',\n          errors: responseData.errors,\n          status: 422\n        });\n      }\n    }\n    \n    // Handle database connection errors\n    if (error.response?.status === 500 && \n        error.response?.data?.detail && \n        typeof error.response.data.detail === 'string' &&\n        error.response.data.detail.includes('connection to server')) {\n      logger.error('Database Connection Error', {\n        detail: error.response.data.detail,\n        url: originalRequest.url\n      });\n      return Promise.reject({\n        message: 'Database connection error. Please try again later.',\n        originalError: error.response.data.detail,\n        status: 500\n      });\n    }\n    \n    // Handle other errors with meaningful messages\n    const errorMessage = error.response?.data?.detail || error.response?.data?.message || 'An error occurred. Please try again.';\n    logger.error('API Error', {\n      message: errorMessage,\n      url: originalRequest.url,\n      status: error.response?.status\n    });\n    return Promise.reject({\n      message: errorMessage,\n      status: error.response?.status\n    });\n  }\n);\n\n// Helper function to handle user logout\nconst logout = async () => {\n  try {\n    logger.info('Performing API logout');\n    // Clear tokens from storage\n    await AsyncStorage.removeItem('access_token');\n    await AsyncStorage.removeItem('refresh_token');\n    await AsyncStorage.removeItem('user');\n    \n    // Clear authorization header\n    delete api.defaults.headers.common.Authorization;\n    \n    // You might want to trigger navigation to login screen or auth context update\n    // This would typically be done via an auth context\n  } catch (error) {\n    logger.error('Logout Error', error);\n  }\n};\n\n// API endpoint functions\n\n// Auth - Dual Authentication System (OAuth + OPAQUE)\nexport const AuthAPI = {\n  // Legacy password login - deprecated, use OPAQUE instead\n  login: (email: string, password: string) => \n    api.post('/api/auth/login/json', { email, password }),\n  \n  // Legacy password register - deprecated, use OPAQUE instead  \n  register: (name: string, email: string, password: string) => \n    api.post('/api/auth/register', { name, email, password }),\n  \n  // OAuth Google Authentication (V1)\n  googleAuth: (idToken: string) => \n    api.post('/api/v1/auth/google', { id_token: idToken }),\n  \n  // Logout (V1)\n  logout: () => api.post('/api/v1/auth/logout'),\n};\n\n// User profile\nexport const UserAPI = {\n  // Get current user profile\n  getProfile: () => api.get('/api/users/me'),\n  \n  // Update user profile\n  updateProfile: (data: {\n    full_name?: string;\n    email?: string;\n    avatar_url?: string;\n  }) => api.put('/api/users/me', data),\n  \n  // Update user password\n  updatePassword: (data: {\n    current_password: string;\n    new_password: string;\n  }) => api.put('/api/users/me/password', data),\n  \n  // Upload avatar\n  uploadAvatar: (imageFile: any) => {\n    const formData = new FormData();\n    formData.append('avatar', imageFile);\n    \n    return api.post('/api/users/me/avatar', formData, {\n      headers: {\n        'Content-Type': 'multipart/form-data',\n      },\n    });\n  },\n\n  updateMe: (data: Partial<User>) =>\n    api.put('/api/users/me', data),\n};\n\n// Journal entries\nexport const JournalAPI = {\n  getEntries: (params: any) => \n    api.get('/api/v1/journals', { params }),\n  \n  getEntry: (id: string) => \n    api.get(`/api/v1/journals/${id}`),\n  \n  // Use trailing slash for POST to avoid 405 due to strict slash matching\n  createEntry: (data: JournalEntryCreate) => \n    api.post('/api/v1/journals/', data),\n\n  // Enhanced method for creating encrypted secret tag entries (legacy secret tags)\n  createEncryptedEntry: (data: {\n    title?: string;\n    encrypted_content: string;    // Base64 encrypted content\n    encrypted_key: string;        // Base64 wrapped entry key\n    iv: string;                   // Base64 IV\n    salt: string;                 // Base64 salt\n    algorithm: string;            // Encryption algorithm\n    wrapIv: string;               // Base64 IV used for key wrapping\n    entry_date?: string;\n    audio_url?: string;\n    tags?: string[];\n    secret_tag_id?: string;       // Secret tag ID\n    secret_tag_hash?: string;     // Secret tag hash for server filtering\n  }) => api.post('/api/journals', {\n    title: data.title || '',\n    content: \"\",  // No plaintext content for secret tag entries\n    encrypted_content: data.encrypted_content,\n    encryption_iv: data.iv,\n    encryption_salt: data.salt,\n    encrypted_key: data.encrypted_key,\n    key_derivation_iterations: 100000,  // Default iterations (legacy)\n    encryption_algorithm: data.algorithm,\n    encryption_wrap_iv: data.wrapIv,\n    entry_date: data.entry_date || new Date().toISOString(),\n    audio_url: data.audio_url,\n    tags: data.tags || [],\n    secret_tag_id: data.secret_tag_id,\n    secret_tag_hash: data.secret_tag_hash,\n  }),\n  \n  updateEntry: (id: string, data: JournalEntryUpdate) => \n    api.put(`/api/v1/journals/${id}`, data),\n  \n  deleteEntry: (id: string) => \n    api.delete(`/api/v1/journals/${id}`),\n  \n  searchEntries: (query: string) => \n    api.get('/api/v1/journals/search', { params: { q: query } }),\n\n  // Get entries by secret tag (for specific tag filtering)\n  getEntriesBySecretTag: (secretTagHash: string, params?: { skip?: number, limit?: number }) =>\n    api.get(`/api/journals/secret-tag/${secretTagHash}`, { params }),\n};\n\n// Reminders\nexport const ReminderAPI = {\n  getReminders: (params?: { page?: number, limit?: number, is_active?: boolean }) => \n    api.get('/api/reminders', { params }),\n  \n  getReminder: (id: string) => \n    api.get(`/api/reminders/${id}`),\n  \n  createReminder: (data: { title: string, note?: string, reminder_time: string, is_active: boolean }) => \n    api.post('/api/reminders', data),\n  \n  updateReminder: (id: string, data: { title?: string, note?: string, reminder_time?: string, is_active?: boolean }) => \n    api.put(`/api/reminders/${id}`, data),\n  \n  deleteReminder: (id: string) => \n    api.delete(`/api/reminders/${id}`),\n};\n\n// Tags\nexport const TagsAPI = {\n  getTags: () => api.get('/api/tags'),\n  \n  getRecentTags: (limit: number = 5) => api.get('/api/tags/recent', { params: { limit } }),\n  \n  getEntriesByTag: (tagName: string) => api.get(`/api/tags/${tagName}/entries`),\n  \n  createTag: async (tag: { name: string; color?: string }) => {\n    const response = await api.post('/api/tags', tag);\n    return response.data;\n  },\n  \n  updateTag: async (id: string, updates: Partial<Tag>) => {\n    const response = await api.put(`/api/tags/${id}`, updates);\n    return response.data;\n  },\n  \n  deleteTag: async (id: string) => {\n    logger.info(`API: Attempting to delete tag with ID: ${id}`);\n    logger.info(`API: DELETE request to: /api/tags/${id}`);\n    const response = await api.delete(`/api/tags/${id}`);\n    logger.info(`API: Delete tag response:`, response.data);\n    return response.data;\n  },\n};\n\n// Audio transcription\nexport const TranscriptionAPI = {\n  transcribeAudio: (audioFile: any) => {\n    // Create form data for file upload\n    const formData = new FormData();\n    formData.append('audio_file', audioFile);\n    \n    return api.post('/api/transcriptions', formData, {\n      headers: {\n        'Content-Type': 'multipart/form-data',\n      },\n    });\n  },\n};\n\nexport const SecretTagAPI = {\n  delete: (tagId: string) => {\n    logger.info(`Sending API request to delete secret tag: ${tagId}`);\n    return api.delete(`/api/v1/secret-tags/${tagId}`);\n  },\n};\n\nexport default {\n  auth: AuthAPI,\n  user: UserAPI,\n  journal: JournalAPI,\n  tags: TagsAPI,\n  transcription: TranscriptionAPI,\n  reminder: ReminderAPI,\n  secretTag: SecretTagAPI,\n};","/**\n * OPAQUE Authentication Service\n * \n * This service handles OPAQUE-based authentication providing zero-knowledge password proof.\n * It works in conjunction with the backend's OPAQUE server implementation.\n */\n\nimport * as opaque from '@serenity-kit/opaque';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { api } from './api';\nimport logger from '../utils/logger';\n\n// Initialize OPAQUE library\nlet opaqueReady = false;\n\nasync function ensureOpaqueReady() {\n  if (!opaqueReady) {\n    if (opaque.ready) {\n      await opaque.ready;\n    }\n    opaqueReady = true;\n    logger.info('OPAQUE library initialized');\n  }\n}\n\n// OPAQUE client types and interfaces\nexport interface OpaqueRegistrationState {\n  clientRegistrationState: string;\n  password: string;\n}\n\nexport interface OpaqueLoginState {\n  clientLoginState: string;\n  password: string;\n}\n\nexport interface OpaqueRegistrationResponse {\n  registrationResponse: string;\n  userIdentifier: string;\n}\n\nexport interface OpaqueLoginResponse {\n  loginResponse: string;\n}\n\nexport interface OpaqueSessionResult {\n  sessionKey: string;\n  exportKey: string;\n  finishLoginRequest: string;\n}\n\nexport interface OpaqueLoginResult {\n  success: boolean;\n  user: {\n    id: string;\n    email: string;\n    full_name: string;\n    is_active: boolean;\n    is_superuser: boolean;\n    created_at: string | null;\n    updated_at: string | null;\n  };\n  token: string;\n  sessionKey: string;\n  exportKey: string;\n}\n\n// Storage keys for OPAQUE data\nconst STORAGE_KEYS = {\n  REGISTRATION_RECORD: 'opaque_registration_record',\n  USER_IDENTIFIER: 'opaque_user_identifier',\n  DEVICE_FINGERPRINT: 'opaque_device_fingerprint',\n  SESSION_DATA: 'opaque_session_data',\n} as const;\n\n/**\n * OPAQUE Authentication Service\n * Provides client-side OPAQUE protocol implementation for zero-knowledge authentication\n */\nexport class OpaqueAuthService {\n  private static instance: OpaqueAuthService;\n\n  private constructor() {}\n\n  public static getInstance(): OpaqueAuthService {\n    if (!OpaqueAuthService.instance) {\n      OpaqueAuthService.instance = new OpaqueAuthService();\n    }\n    return OpaqueAuthService.instance;\n  }\n\n  /**\n   * Start OPAQUE registration process\n   * @param password User's password\n   * @param userIdentifier User identifier (email)\n   * @returns Registration request and client state\n   */\n  public async startRegistration(password: string, userIdentifier: string): Promise<{\n    registrationRequest: string;\n    clientRegistrationState: string;\n  }> {\n    try {\n      await ensureOpaqueReady();\n      logger.info('Starting OPAQUE registration', { userIdentifier });\n\n      // Start registration with OPAQUE client\n      const { clientRegistrationState, registrationRequest } = opaque.client.startRegistration({\n        password,\n      });\n\n      if (!clientRegistrationState || !registrationRequest) {\n        throw new Error('Failed to generate OPAQUE registration request');\n      }\n\n      // Store the client state temporarily for finishing registration\n      await AsyncStorage.setItem(\n        `opaque_registration_state_${userIdentifier}`, \n        JSON.stringify({\n          clientRegistrationState,\n          password,\n          userIdentifier\n        })\n      );\n\n      logger.info('OPAQUE registration started successfully', { \n        registrationRequestLength: registrationRequest.length,\n        clientRegistrationStateLength: clientRegistrationState.length \n      });\n\n      return {\n        registrationRequest,  // Send raw Base64URL to backend\n        clientRegistrationState\n      };\n    } catch (error) {\n      logger.error('OPAQUE registration start failed', error);\n      throw new Error('Failed to start OPAQUE registration');\n    }\n  }\n\n  /**\n   * Complete OPAQUE registration process\n   * @param userIdentifier User identifier\n   * @param registrationResponse Server's registration response\n   * @returns Registration record\n   */\n  public async finishRegistration(\n    userIdentifier: string,\n    registrationResponse: string\n  ): Promise<string> {\n    try {\n      await ensureOpaqueReady();\n      logger.info('Finishing OPAQUE registration', { userIdentifier });\n\n      // Retrieve stored registration state\n      const storedState = await AsyncStorage.getItem(`opaque_registration_state_${userIdentifier}`);\n      if (!storedState) {\n        throw new Error('Registration state not found');\n      }\n\n      const { clientRegistrationState, password } = JSON.parse(storedState);\n\n      // Add detailed logging for debugging\n      logger.info('Retrieved stored registration state', { \n        userIdentifier,\n        clientRegistrationStateLength: clientRegistrationState?.length,\n        registrationResponseLength: registrationResponse?.length,\n        passwordLength: password?.length\n      });\n\n      // Complete registration\n      const { registrationRecord } = opaque.client.finishRegistration({\n        clientRegistrationState,\n        registrationResponse,\n        password,\n      });\n\n      if (!registrationRecord) {\n        throw new Error('Failed to finish registration');\n      }\n\n      // Clean up stored state\n      await AsyncStorage.removeItem(`opaque_registration_state_${userIdentifier}`);\n\n      logger.info('OPAQUE registration finished successfully', { userIdentifier });\n\n      return registrationRecord;  // Return raw Base64URL to backend\n    } catch (error) {\n      logger.error('Failed to finish OPAQUE registration', { userIdentifier, error });\n      throw new Error(`OPAQUE registration finish failed: ${error}`);\n    }\n  }\n\n  /**\n   * Start OPAQUE login process with user credentials\n   * @param password User's password\n   * @param userIdentifier User identifier (email)\n   * @returns Login request and client state\n   */\n  public async startLogin(password: string, userIdentifier: string): Promise<{\n    loginRequest: string;\n    clientLoginState: string;\n  }> {\n    try {\n      await ensureOpaqueReady();\n      logger.info('Starting OPAQUE login', { userIdentifier });\n\n      // Start login with OPAQUE client\n      const result = opaque.client.startLogin({ password });\n\n      if (!result || !result.clientLoginState || !result.startLoginRequest) {\n        throw new Error('Failed to generate OPAQUE login request');\n      }\n\n      // Store the client state temporarily for finishing login\n      await AsyncStorage.setItem(\n        `opaque_login_state_${userIdentifier}`, \n        JSON.stringify({\n          clientLoginState: result.clientLoginState,\n          password,\n          userIdentifier\n        })\n      );\n\n      logger.info('OPAQUE login started successfully', { \n        startLoginRequestLength: result.startLoginRequest.length,\n        clientLoginStateLength: result.clientLoginState.length \n      });\n      \n      return {\n        loginRequest: result.startLoginRequest,  // Send raw Base64URL to backend\n        clientLoginState: result.clientLoginState\n      };\n    } catch (error) {\n      logger.error('OPAQUE login start failed', error);\n      throw new Error('Failed to start OPAQUE login');\n    }\n  }\n\n  /**\n   * Complete OPAQUE login process and derive session keys\n   * @param userIdentifier User identifier\n   * @param loginResponse Server's login response\n   * @returns Session and export keys\n   */\n  public async finishLogin(\n    userIdentifier: string,\n    loginResponse: string\n  ): Promise<OpaqueSessionResult> {\n    try {\n      await ensureOpaqueReady();\n      logger.info('Finishing OPAQUE login', { userIdentifier });\n\n      // Retrieve stored login state\n      const storedState = await AsyncStorage.getItem(`opaque_login_state_${userIdentifier}`);\n      if (!storedState) {\n        throw new Error('Login state not found');\n      }\n\n      const { clientLoginState, password } = JSON.parse(storedState);\n\n      // Add detailed logging for debugging\n      logger.info('Retrieved stored login state', { \n        userIdentifier,\n        clientLoginStateLength: clientLoginState?.length,\n        loginResponseLength: loginResponse?.length,\n        passwordLength: password?.length\n      });\n\n      // Complete login\n      const loginResult = opaque.client.finishLogin({\n        clientLoginState,\n        loginResponse,\n        password,\n      });\n\n      logger.info('OPAQUE finishLogin result', { \n        userIdentifier,\n        success: loginResult !== null,\n        resultType: typeof loginResult,\n        resultKeys: loginResult ? Object.keys(loginResult) : null\n      });\n\n      if (!loginResult) {\n        throw new Error('Failed to finish login');\n      }\n\n      const { finishLoginRequest, sessionKey, exportKey } = loginResult;\n\n      // Clean up stored state\n      await AsyncStorage.removeItem(`opaque_login_state_${userIdentifier}`);\n\n      logger.info('OPAQUE login finished successfully', { userIdentifier });\n\n      return { \n        sessionKey, \n        exportKey, \n        finishLoginRequest\n      };\n    } catch (error) {\n      logger.error('Failed to finish OPAQUE login', { userIdentifier, error });\n      throw new Error(`OPAQUE login finish failed: ${error}`);\n    }\n  }\n\n  /**\n   * Register user with OPAQUE protocol\n   * @param name User's display name\n   * @param email User's email address\n   * @param password User's password\n   */\n  public async register(name: string, email: string, password: string): Promise<void> {\n    try {\n      logger.info('Starting OPAQUE registration flow', { email });\n\n      // Step 1: Start registration\n      const { registrationRequest } = await this.startRegistration(password, email);\n\n      // Step 2: Send registration request to server\n      const response = await api.post('/api/v1/auth/register/start', {\n        userIdentifier: email,\n        opaque_registration_request: registrationRequest,\n        name\n      });\n\n      const { opaque_registration_response: registrationResponse } = response.data;\n\n      // Step 3: Finish registration\n      const registrationRecord = await this.finishRegistration(email, registrationResponse);\n\n      // Step 4: Send registration record to server\n      await api.post('/api/v1/auth/register/finish', {\n        session_id: response.data.session_id,\n        userIdentifier: email,\n        opaque_registration_record: registrationRecord\n      });\n\n      logger.info('Registration record sent to server', { \n        email, \n        registrationRecordLength: registrationRecord.length,\n        registrationRecordSample: registrationRecord.substring(0, 50) + '...'\n      });\n\n      logger.info('OPAQUE registration flow completed successfully');\n    } catch (error) {\n      logger.error('OPAQUE registration flow failed', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Login user with OPAQUE protocol\n   * @param email User's email address\n   * @param password User's password\n   * @returns Complete login result with JWT token and session keys\n   */\n  public async login(email: string, password: string): Promise<OpaqueLoginResult> {\n    try {\n      logger.info('Starting OPAQUE login', { email });\n\n      // Start login process\n      const startResult = await this.startLogin(password, email);\n      const loginResponse = await api.post('/api/v1/auth/login/start', {\n        userIdentifier: email,\n        client_credential_request: startResult.loginRequest,\n      });\n\n      if (!loginResponse.data?.server_credential_response) {\n        throw new Error('Invalid login response from server');\n      }\n\n      // Finish login process\n      const sessionResult = await this.finishLogin(email, loginResponse.data.server_credential_response);\n      \n      // Send finish login request to server\n      const finishResponse = await api.post('/api/v1/auth/login/finish', {\n        session_id: loginResponse.data.session_id,\n        userIdentifier: email,\n        client_credential_finalization: sessionResult.finishLoginRequest,\n      });\n\n      if (!finishResponse.data?.access_token) {\n        throw new Error('Invalid finish login response from server');\n      }\n\n      logger.info('OPAQUE login completed successfully', { email });\n\n      return {\n        success: true,\n        user: finishResponse.data.user,\n        token: finishResponse.data.access_token,\n        sessionKey: sessionResult.sessionKey,\n        exportKey: sessionResult.exportKey,\n      };\n    } catch (error) {\n      logger.error('OPAQUE login failed', { email, error });\n      throw error;\n    }\n  }\n\n  /**\n   * Check if user has OPAQUE registration record stored locally\n   * @returns True if registration record exists\n   */\n  public async hasRegistrationRecord(): Promise<boolean> {\n    try {\n      const record = await AsyncStorage.getItem(STORAGE_KEYS.REGISTRATION_RECORD);\n      return record !== null;\n    } catch (error) {\n      logger.error('Failed to check registration record', error);\n      return false;\n    }\n  }\n\n  /**\n   * Get stored user identifier\n   * @returns User identifier or null if not found\n   */\n  public async getUserIdentifier(): Promise<string | null> {\n    try {\n      return await AsyncStorage.getItem(STORAGE_KEYS.USER_IDENTIFIER);\n    } catch (error) {\n      logger.error('Failed to get user identifier', error);\n      return null;\n    }\n  }\n\n  /**\n   * Clear all OPAQUE data from storage\n   */\n  public async clearOpaqueData(): Promise<void> {\n    try {\n      await AsyncStorage.multiRemove([\n        STORAGE_KEYS.REGISTRATION_RECORD,\n        STORAGE_KEYS.USER_IDENTIFIER\n      ]);\n\n      // Also clear any temporary states\n      const keys = await AsyncStorage.getAllKeys();\n      const tempKeys = keys.filter(key => \n        key.startsWith('opaque_reg_state_') || \n        key.startsWith('opaque_login_state_')\n      );\n      \n      if (tempKeys.length > 0) {\n        await AsyncStorage.multiRemove(tempKeys);\n      }\n\n      logger.info('OPAQUE data cleared successfully');\n    } catch (error) {\n      logger.error('Failed to clear OPAQUE data', error);\n    }\n  }\n}\n\n// Export singleton instance\nexport const opaqueAuth = OpaqueAuthService.getInstance(); ","import { OpaqueSessionResult } from './opaqueAuth';\nimport logger from '../utils/logger';\n\n// Key derivation constants (must match backend)\nconst KEY_DERIVATION_INFO = {\n  TAG_ID_KEY: 'TagID',\n  ENCRYPTION_KEY: 'Encryption',\n  VAULT_KEY: 'VaultKey'\n} as const;\n\n/**\n * Derives cryptographic keys from OPAQUE export key using HKDF\n * This integrates with the backend key derivation system\n */\nexport class OpaqueKeyManager {\n  private sessionKey: Uint8Array | null = null;\n  private exportKey: Uint8Array | null = null;\n  private derivedKeys: Map<string, Uint8Array> = new Map();\n\n  private decodeBase64ToBytes(data: string): Uint8Array {\n    // Accept both base64 and base64url encodings\n    const normalized = data.replace(/-/g, '+').replace(/_/g, '/');\n    const padLen = normalized.length % 4 === 0 ? 0 : 4 - (normalized.length % 4);\n    const padded = normalized + '='.repeat(padLen);\n    const binary = atob(padded);\n    const bytes = new Uint8Array(binary.length);\n    for (let i = 0; i < binary.length; i++) bytes[i] = binary.charCodeAt(i);\n    return bytes;\n  }\n\n  /**\n   * Initialize the key manager with OPAQUE session result\n   * @param sessionResult Result from successful OPAQUE login\n   */\n  public initialize(sessionResult: OpaqueSessionResult): void {\n    // sessionKey/exportKey may arrive as base64(url)-encoded strings from the OPAQUE client.\n    // Normalize to Uint8Array for WebCrypto.\n    const { sessionKey, exportKey } = sessionResult as unknown as {\n      sessionKey: string | Uint8Array;\n      exportKey: string | Uint8Array;\n    };\n\n    this.sessionKey = typeof sessionKey === 'string' ? this.decodeBase64ToBytes(sessionKey) : sessionKey;\n    this.exportKey = typeof exportKey === 'string' ? this.decodeBase64ToBytes(exportKey) : exportKey;\n    this.derivedKeys.clear();\n    \n    logger.info('OPAQUE key manager initialized', {\n      sessionKeyType: typeof this.sessionKey,\n      sessionKeyConstructor: this.sessionKey?.constructor?.name,\n      exportKeyType: typeof this.exportKey,\n      exportKeyConstructor: this.exportKey?.constructor?.name\n    });\n  }\n\n  /**\n   * Derive TagID key for deterministic tag generation\n   * @param salt Optional salt for key derivation\n   * @returns TagID key as Uint8Array\n   */\n  public async deriveTagIdKey(salt?: Uint8Array): Promise<Uint8Array> {\n    if (!this.exportKey) {\n      throw new Error('OPAQUE key manager not initialized');\n    }\n\n    const cacheKey = `tagid_${salt ? Array.from(salt).join(',') : 'default'}`;\n    \n    if (this.derivedKeys.has(cacheKey)) {\n      return this.derivedKeys.get(cacheKey)!;\n    }\n\n    try {\n      const tagIdKey = await this.deriveKey(\n        this.exportKey,\n        KEY_DERIVATION_INFO.TAG_ID_KEY,\n        32, // 256-bit key\n        salt\n      );\n\n      this.derivedKeys.set(cacheKey, tagIdKey);\n      logger.debug('TagID key derived successfully');\n      return tagIdKey;\n    } catch (error) {\n      logger.error('Failed to derive TagID key', error);\n      throw new Error('TagID key derivation failed');\n    }\n  }\n\n  /**\n   * Derive encryption key for vault data protection\n   * @param salt Optional salt for key derivation\n   * @returns Encryption key as Uint8Array\n   */\n  public async deriveEncryptionKey(salt?: Uint8Array): Promise<Uint8Array> {\n    if (!this.exportKey) {\n      throw new Error('OPAQUE key manager not initialized');\n    }\n\n    const cacheKey = `encryption_${salt ? Array.from(salt).join(',') : 'default'}`;\n    \n    if (this.derivedKeys.has(cacheKey)) {\n      return this.derivedKeys.get(cacheKey)!;\n    }\n\n    try {\n      const encryptionKey = await this.deriveKey(\n        this.exportKey,\n        KEY_DERIVATION_INFO.ENCRYPTION_KEY,\n        32, // 256-bit key for AES-256\n        salt\n      );\n\n      this.derivedKeys.set(cacheKey, encryptionKey);\n      logger.debug('Encryption key derived successfully');\n      return encryptionKey;\n    } catch (error) {\n      logger.error('Failed to derive encryption key', error);\n      throw new Error('Encryption key derivation failed');\n    }\n  }\n\n  /**\n   * Derive vault key for journal data encryption\n   * @param salt Optional salt for key derivation\n   * @returns Vault key as Uint8Array\n   */\n  public async deriveVaultKey(salt?: Uint8Array): Promise<Uint8Array> {\n    if (!this.exportKey) {\n      throw new Error('OPAQUE key manager not initialized');\n    }\n\n    const cacheKey = `vault_${salt ? Array.from(salt).join(',') : 'default'}`;\n    \n    if (this.derivedKeys.has(cacheKey)) {\n      return this.derivedKeys.get(cacheKey)!;\n    }\n\n    try {\n      const vaultKey = await this.deriveKey(\n        this.exportKey,\n        KEY_DERIVATION_INFO.VAULT_KEY,\n        32, // 256-bit key\n        salt\n      );\n\n      this.derivedKeys.set(cacheKey, vaultKey);\n      logger.debug('Vault key derived successfully');\n      return vaultKey;\n    } catch (error) {\n      logger.error('Failed to derive vault key', error);\n      throw new Error('Vault key derivation failed');\n    }\n  }\n\n  /**\n   * Get the session key for API authentication\n   * @returns Session key as Uint8Array\n   */\n  public getSessionKey(): Uint8Array {\n    if (!this.sessionKey) {\n      throw new Error('OPAQUE key manager not initialized');\n    }\n    return this.sessionKey;\n  }\n\n  /**\n   * Get the export key for additional key derivation\n   * @returns Export key as Uint8Array\n   */\n  public getExportKey(): Uint8Array {\n    if (!this.exportKey) {\n      throw new Error('OPAQUE key manager not initialized');\n    }\n    return this.exportKey;\n  }\n\n  /**\n   * Check if the key manager is initialized\n   * @returns True if initialized with valid keys\n   */\n  public isInitialized(): boolean {\n    return this.sessionKey !== null && this.exportKey !== null;\n  }\n\n  /**\n   * Clear all derived keys and session data\n   */\n  public clear(): void {\n    // Securely zero out keys if possible\n    if (this.sessionKey) {\n      // Check if it's a Uint8Array before calling fill\n      if (this.sessionKey instanceof Uint8Array) {\n        this.sessionKey.fill(0);\n      }\n      this.sessionKey = null;\n    }\n    \n    if (this.exportKey) {\n      // Check if it's a Uint8Array before calling fill\n      if (this.exportKey instanceof Uint8Array) {\n        this.exportKey.fill(0);\n      }\n      this.exportKey = null;\n    }\n\n    // Clear derived keys\n    for (const key of this.derivedKeys.values()) {\n      if (key instanceof Uint8Array) {\n        key.fill(0);\n      }\n    }\n    this.derivedKeys.clear();\n\n    logger.info('OPAQUE key manager cleared');\n  }\n\n  /**\n   * Internal HKDF key derivation function\n   * Uses Web Crypto API for HKDF-SHA256\n   */\n  private async deriveKey(\n    ikm: Uint8Array,\n    info: string,\n    length: number,\n    salt?: Uint8Array\n  ): Promise<Uint8Array> {\n    try {\n      // Import the input key material\n      const key = await crypto.subtle.importKey(\n        'raw',\n        ikm,\n        'HKDF',\n        false,\n        ['deriveKey', 'deriveBits']\n      );\n\n      // Derive the key using HKDF-SHA256\n      const derivedBits = await crypto.subtle.deriveBits(\n        {\n          name: 'HKDF',\n          hash: 'SHA-256',\n          salt: salt || new Uint8Array(32), // Default to 32-byte zero salt\n          info: new TextEncoder().encode(info)\n        },\n        key,\n        length * 8 // Convert bytes to bits\n      );\n\n      return new Uint8Array(derivedBits);\n    } catch (error) {\n      logger.error('HKDF key derivation failed', error);\n      throw new Error('Key derivation failed');\n    }\n  }\n}\n\n// Export singleton instance\nexport const opaqueKeyManager = new OpaqueKeyManager(); ","import React, { createContext, useState, useContext, useEffect, ReactNode } from 'react';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\n\nimport { api } from '../services/api';\nimport { User } from '../types';\nimport logger from '../utils/logger';\nimport { opaqueAuth, OpaqueSessionResult, OpaqueLoginResult } from '../services/opaqueAuth';\nimport { opaqueKeyManager } from '../services/opaqueKeyManager';\n\n// OPAQUE-only Authentication Context\ninterface AuthContextType {\n  isAuthenticated: boolean;\n  isLoading: boolean;\n  isInitialLoading: boolean;\n  user: User | null;\n  logout: () => Promise<void>;\n  updateUser: (updatedUserData: Partial<User>) => Promise<void>;\n  // OPAQUE zero-knowledge authentication methods\n  opaqueLogin: (email: string, password: string) => Promise<void>;\n  opaqueRegister: (name: string, email: string, password: string) => Promise<void>;\n  hasOpaqueSupport: () => Promise<boolean>;\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\n\ninterface AuthProviderProps {\n  children: ReactNode;\n}\n\nexport const AuthProvider: React.FC<AuthProviderProps> = ({ children }) => {\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [isLoading, setIsLoading] = useState(true);\n  const [isInitialLoading, setIsInitialLoading] = useState(true);\n  const [user, setUser] = useState<User | null>(null);\n  \n  // Check for existing OPAQUE session on startup\n  useEffect(() => {\n    const checkAuthStatus = async () => {\n      try {\n        logger.info('Checking OPAQUE authentication status');\n        \n        const token = await AsyncStorage.getItem('access_token');\n        const storedUser = await AsyncStorage.getItem('user');\n        const storedSessionKey = await AsyncStorage.getItem('opaque_session_key');\n        const storedExportKey = await AsyncStorage.getItem('opaque_export_key');\n        \n        if (token) {\n          logger.info('OPAQUE session token found. Verifying...');\n          // Set authorization header for API requests\n          api.defaults.headers.common.Authorization = `Bearer ${token}`;\n          // Mark as authenticated\n          setIsAuthenticated(true);\n          \n          if (storedUser) {\n            try {\n              const userData = JSON.parse(storedUser);\n              setUser(userData);\n              logger.info('Loaded user data from OPAQUE session:', { userId: userData.id });\n            } catch (parseError) {\n              logger.error('Failed to parse stored user data', parseError);\n              setUser(null);\n            }\n          } else {\n             setUser(null);\n          }\n\n          // Rehydrate OPAQUE keys if available (to enable per-user encryption after refresh)\n          try {\n            if (storedSessionKey && storedExportKey) {\n              opaqueKeyManager.initialize({\n                sessionKey: storedSessionKey,\n                exportKey: storedExportKey,\n                finishLoginRequest: ''\n              } as unknown as OpaqueSessionResult);\n              logger.info('OPAQUE key manager rehydrated from storage');\n            } else {\n              logger.warn('OPAQUE keys not found in storage; per-user encryption will require re-login');\n            }\n          } catch (rehydrateError) {\n            logger.error('Failed to rehydrate OPAQUE keys', rehydrateError);\n            opaqueKeyManager.clear();\n          }\n          \n        } else {\n          // No token found, ensure logged out state\n          setIsAuthenticated(false);\n          setUser(null);\n          delete api.defaults.headers.common.Authorization;\n          logger.info('No OPAQUE session token found');\n        }\n      } catch (error) {\n        logger.error('OPAQUE authentication check failed:', error);\n        // Clear tokens on error\n        try {\n          await AsyncStorage.removeItem('access_token');\n          await AsyncStorage.removeItem('refresh_token');\n          await AsyncStorage.removeItem('user');\n          delete api.defaults.headers.common.Authorization;\n          await opaqueAuth.clearOpaqueData();\n          opaqueKeyManager.clear();\n        } catch (e) {\n          logger.error('Failed to clear auth data:', e);\n        }\n      } finally {\n        setIsLoading(false);\n        setIsInitialLoading(false);\n      }\n    };\n\n    checkAuthStatus();\n  }, []);\n\n  // Logout - Clear all OPAQUE data\n  const logout = async () => {\n    try {\n      logger.info('Logging out OPAQUE user', { userId: user?.id });\n      setIsLoading(true);\n      \n      // Clear all authentication data from storage\n      await AsyncStorage.removeItem('access_token');\n      await AsyncStorage.removeItem('refresh_token');\n      await AsyncStorage.removeItem('user');\n      \n      // Clear OPAQUE data\n      await opaqueAuth.clearOpaqueData();\n      opaqueKeyManager.clear();\n      \n      // Clear API authorization header\n      delete api.defaults.headers.common.Authorization;\n      logger.info('API authorization header cleared');\n      \n      setUser(null);\n      setIsAuthenticated(false);\n      logger.info('OPAQUE logout successful - all auth data cleared');\n    } catch (error: any) {\n      logger.error('OPAQUE logout failed:', { \n        userId: user?.id,\n        status: error.status,\n        message: error.message\n      });\n      \n      // Even if server logout fails, remove all auth data\n      await AsyncStorage.removeItem('access_token');\n      await AsyncStorage.removeItem('refresh_token');\n      await AsyncStorage.removeItem('user');\n      \n      // Clear OPAQUE data\n      await opaqueAuth.clearOpaqueData();\n      opaqueKeyManager.clear();\n      \n      // Clear API authorization header\n      delete api.defaults.headers.common.Authorization;\n      \n      setUser(null);\n      setIsAuthenticated(false);\n      logger.info('OPAQUE logout successful - all auth data cleared (fallback)');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // Function to update local user state and storage\n  const updateUser = async (updatedUserData: Partial<User>) => {\n    if (!user) return; // Only update if a user is currently logged in\n    \n    try {\n      const newUser = { ...user, ...updatedUserData };\n      setUser(newUser);\n      // Update user data in storage as well\n      await AsyncStorage.setItem('user', JSON.stringify(newUser));\n      logger.info('Local user state updated', newUser);\n    } catch (error) {\n      logger.error('Failed to update local user state or storage', error);\n    }\n  };\n\n  // OPAQUE login with zero-knowledge authentication\n  const opaqueLogin = async (email: string, password: string) => {\n    try {\n      logger.info(`OPAQUE login attempt for ${email}`);\n      setIsLoading(true);\n      \n      // Perform OPAQUE authentication - this now returns the login response with JWT token\n      const loginResponse: OpaqueLoginResult = await opaqueAuth.login(email, password);\n      \n      // Initialize key manager with OPAQUE session keys for per-user encryption\n      // Note: We don't need the finishLoginRequest here as it's already been used\n      opaqueKeyManager.initialize({\n        sessionKey: loginResponse.sessionKey,\n        exportKey: loginResponse.exportKey,\n        finishLoginRequest: '' // Not needed for key manager initialization\n      });\n      // Persist keys for session rehydration (web dev convenience)\n      await AsyncStorage.setItem('opaque_session_key', loginResponse.sessionKey);\n      await AsyncStorage.setItem('opaque_export_key', loginResponse.exportKey);\n      \n      // Use JWT token for API authentication\n      api.defaults.headers.common.Authorization = `Bearer ${loginResponse.token}`;\n      \n      logger.info('OPAQUE login successful', { userId: loginResponse.user.id });\n      \n      // Ensure user data has proper date fields (convert null to empty string if needed)\n      const userData = {\n        ...loginResponse.user,\n        created_at: loginResponse.user.created_at || new Date().toISOString(),\n        updated_at: loginResponse.user.updated_at || new Date().toISOString()\n      };\n      \n      // Store JWT token and user data\n      await AsyncStorage.setItem('access_token', loginResponse.token);\n      await AsyncStorage.setItem('user', JSON.stringify(userData));\n      \n      setUser(userData);\n      setIsAuthenticated(true);\n    } catch (error: any) {\n      logger.error('OPAQUE login failed:', { \n        email,\n        status: error.status,\n        message: error.message,\n        response: error.response?.data\n      });\n      // Clear key manager on failure\n      opaqueKeyManager.clear();\n      throw error;\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // OPAQUE registration with zero-knowledge authentication\n  const opaqueRegister = async (name: string, email: string, password: string) => {\n    try {\n      logger.info(`OPAQUE registration attempt for ${email}`);\n      setIsLoading(true);\n      \n      // Perform OPAQUE registration only - don't auto-login\n      await opaqueAuth.register(name, email, password);\n      \n      logger.info('OPAQUE registration successful');\n    } catch (error: any) {\n      logger.error('OPAQUE registration failed:', { \n        email,\n        status: error.status,\n        message: error.message,\n        response: error.response?.data\n      });\n      throw error;\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // Check if OPAQUE is supported and available\n  const hasOpaqueSupport = async (): Promise<boolean> => {\n    try {\n      // OPAQUE is always available in V1 dual authentication system\n      // Check if server is healthy instead\n      const response = await api.get('/api/v1/auth/health');\n      return response.status >= 200 && response.status < 300;\n    } catch (error) {\n      logger.warn('OPAQUE support check failed, assuming not supported', error);\n      return false;\n    }\n  };\n\n  const value = {\n    isAuthenticated,\n    isLoading,\n    isInitialLoading,\n    user,\n    logout,\n    updateUser,\n    opaqueLogin,\n    opaqueRegister,\n    hasOpaqueSupport,\n  };\n\n  return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>;\n};\n\nexport const useAuth = (): AuthContextType => {\n  const context = useContext(AuthContext);\n  if (context === undefined) {\n    throw new Error('useAuth must be used within an AuthProvider');\n  }\n  return context;\n};\n\nexport default AuthContext;","import { Platform } from 'react-native';\n\nexport interface AppColors {\n  primary: string;\n  primaryLight: string;\n  primaryDark: string;\n  secondary: string;\n  secondaryLight: string;\n  background: string;\n  surface: string;\n  card: string;\n  text: string;\n  textSecondary: string;\n  textDisabled: string;\n  border: string;\n  borderLight: string;\n  notification: string;\n  error: string;\n  errorLight: string;\n  success: string;\n  successLight: string;\n  warning: string;\n  warningLight: string;\n  disabled: string;\n  inputBackground: string;\n  statusBar: 'auto' | 'dark-content' | 'light-content';\n  tabBarActive: string;\n  tabBarInactive: string;\n  shadow: string;\n  onPrimary: string;\n  onSurface: string;\n  overlay: string;\n  // Semantic colors for better UX\n  accent: string;\n  accentLight: string;\n  // Grayscale\n  black: string;\n  white: string;\n  gray50: string;\n  gray100: string;\n  gray200: string;\n  gray300: string;\n  gray400: string;\n  gray500: string;\n  gray600: string;\n  gray700: string;\n  gray800: string;\n  gray900: string;\n  // Skeleton colors\n  skeleton: string;\n  skeletonHighlight: string;\n}\n\nexport interface AppTypography {\n  fontFamilies: {\n    regular: string;\n    medium: string;\n    semiBold: string;\n    bold: string;\n    light: string;\n  };\n  fontSizes: {\n    xs: number; // 12\n    sm: number; // 14\n    md: number; // 16 (base)\n    lg: number; // 18\n    xl: number; // 20\n    xxl: number; // 24\n    xxxl: number; // 30\n    display: number; // 36\n  };\n  lineHeights: {\n    tight: number; // 1.25\n    normal: number; // 1.5\n    loose: number; // 1.75\n  };\n  letterSpacing: {\n    tight: number;\n    normal: number;\n    wide: number;\n  };\n}\n\nexport interface AppSpacing {\n  none: number; // 0\n  xs: number;   // 4\n  sm: number;   // 8\n  md: number;   // 16 (base)\n  lg: number;   // 24\n  xl: number;   // 32\n  xxl: number;  // 48\n  xxxl: number; // 64\n}\n\nexport interface AppBorderRadius {\n  none: number;\n  sm: number;   // 4\n  md: number;   // 8\n  lg: number;   // 12\n  xl: number;   // 16\n  xxl: number;  // 24\n  full: number; // 9999\n}\n\nexport interface AppShadows {\n  none: object;\n  sm: object;\n  md: object;\n  lg: object;\n  xl: object;\n}\n\nexport interface AppAnimations {\n  duration: {\n    fast: number;\n    normal: number;\n    slow: number;\n  };\n  easing: {\n    ease: string;\n    easeIn: string;\n    easeOut: string;\n    easeInOut: string;\n  };\n}\n\nexport interface AppTheme {\n  colors: AppColors;\n  typography: AppTypography;\n  spacing: AppSpacing;\n  borderRadius: AppBorderRadius;\n  shadows: AppShadows;\n  animations: AppAnimations;\n  isDarkMode: boolean;\n}\n\n// Enhanced Light Theme with modern color palette\nexport const lightModeColors: AppColors = {\n  primary: '#6366F1', // Modern indigo\n  primaryLight: '#A5B4FC',\n  primaryDark: '#4338CA',\n  secondary: '#06B6D4', // Cyan\n  secondaryLight: '#67E8F9',\n  background: '#FAFAFA',\n  surface: '#FFFFFF',\n  card: '#FFFFFF',\n  text: '#111827',\n  textSecondary: '#6B7280',\n  textDisabled: '#9CA3AF',\n  border: '#E5E7EB',\n  borderLight: '#F3F4F6',\n  notification: '#EF4444',\n  error: '#EF4444',\n  errorLight: '#FEE2E2',\n  success: '#10B981',\n  successLight: '#D1FAE5',\n  warning: '#F59E0B',\n  warningLight: '#FEF3C7',\n  disabled: '#D1D5DB',\n  inputBackground: '#FFFFFF',\n  statusBar: 'dark-content',\n  shadow: 'rgba(0, 0, 0, 0.1)',\n  onPrimary: '#FFFFFF',\n  onSurface: '#111827',\n  overlay: 'rgba(0, 0, 0, 0.5)',\n  accent: '#8B5CF6', // Purple accent\n  accentLight: '#DDD6FE',\n  tabBarActive: '#6366F1',\n  tabBarInactive: '#9CA3AF',\n\n  black: '#000000',\n  white: '#FFFFFF',\n  gray50: '#F9FAFB',\n  gray100: '#F3F4F6',\n  gray200: '#E5E7EB',\n  gray300: '#D1D5DB',\n  gray400: '#9CA3AF',\n  gray500: '#6B7280',\n  gray600: '#4B5563',\n  gray700: '#374151',\n  gray800: '#1F2937',\n  gray900: '#111827',\n  // Skeleton colors\n  skeleton: '#E5E7EB',\n  skeletonHighlight: '#F3F4F6',\n};\n\n// Enhanced Dark Theme\nexport const darkModeColors: AppColors = {\n  primary: '#818CF8', // Lighter indigo for dark mode\n  primaryLight: '#C7D2FE',\n  primaryDark: '#6366F1',\n  secondary: '#22D3EE',\n  secondaryLight: '#7DD3FC',\n  background: '#0F172A',\n  surface: '#1E293B',\n  card: '#1E293B',\n  text: '#F1F5F9',\n  textSecondary: '#94A3B8',\n  textDisabled: '#64748B',\n  border: '#334155',\n  borderLight: '#475569',\n  notification: '#F87171',\n  error: '#F87171',\n  errorLight: '#450A0A',\n  success: '#34D399',\n  successLight: '#064E3B',\n  warning: '#FBBF24',\n  warningLight: '#451A03',\n  disabled: '#475569',\n  inputBackground: '#334155',\n  statusBar: 'light-content',\n  shadow: 'rgba(0, 0, 0, 0.3)',\n  onPrimary: '#0F172A',\n  onSurface: '#F1F5F9',\n  overlay: 'rgba(0, 0, 0, 0.7)',\n  accent: '#A78BFA',\n  accentLight: '#312E81',\n  tabBarActive: '#818CF8',\n  tabBarInactive: '#64748B',\n\n  black: '#000000',\n  white: '#FFFFFF',\n  gray50: '#1E293B',\n  gray100: '#334155',\n  gray200: '#475569',\n  gray300: '#64748B',\n  gray400: '#94A3B8',\n  gray500: '#CBD5E1',\n  gray600: '#E2E8F0',\n  gray700: '#F1F5F9',\n  gray800: '#F8FAFC',\n  gray900: '#FFFFFF',\n  // Skeleton colors\n  skeleton: '#334155',\n  skeletonHighlight: '#475569',\n};\n\nexport const typography: AppTypography = {\n  fontFamilies: {\n    regular: Platform.OS === 'ios' ? 'SF Pro Text' : 'Roboto',\n    medium: Platform.OS === 'ios' ? 'SF Pro Text Medium' : 'Roboto Medium',\n    semiBold: Platform.OS === 'ios' ? 'SF Pro Text Semibold' : 'Roboto Medium',\n    bold: Platform.OS === 'ios' ? 'SF Pro Text Bold' : 'Roboto Bold',\n    light: Platform.OS === 'ios' ? 'SF Pro Text Light' : 'Roboto Light',\n  },\n  fontSizes: {\n    xs: 12,\n    sm: 14,\n    md: 16,\n    lg: 18,\n    xl: 20,\n    xxl: 24,\n    xxxl: 30,\n    display: 36,\n  },\n  lineHeights: {\n    tight: 1.25,\n    normal: 1.5,\n    loose: 1.75,\n  },\n  letterSpacing: {\n    tight: -0.025,\n    normal: 0,\n    wide: 0.025,\n  },\n};\n\nexport const spacing: AppSpacing = {\n  none: 0,\n  xs: 4,\n  sm: 8,\n  md: 16,\n  lg: 24,\n  xl: 32,\n  xxl: 48,\n  xxxl: 64,\n};\n\nexport const borderRadius: AppBorderRadius = {\n  none: 0,\n  sm: 4,\n  md: 8,\n  lg: 12,\n  xl: 16,\n  xxl: 24,\n  full: 9999,\n};\n\nexport const shadows: AppShadows = {\n  none: {\n    shadowColor: 'transparent',\n    shadowOffset: { width: 0, height: 0 },\n    shadowOpacity: 0,\n    shadowRadius: 0,\n    elevation: 0,\n  },\n  sm: {\n    shadowColor: '#000',\n    shadowOffset: { width: 0, height: 1 },\n    shadowOpacity: 0.05,\n    shadowRadius: 2,\n    elevation: 2,\n  },\n  md: {\n    shadowColor: '#000',\n    shadowOffset: { width: 0, height: 4 },\n    shadowOpacity: 0.1,\n    shadowRadius: 6,\n    elevation: 4,\n  },\n  lg: {\n    shadowColor: '#000',\n    shadowOffset: { width: 0, height: 10 },\n    shadowOpacity: 0.15,\n    shadowRadius: 15,\n    elevation: 8,\n  },\n  xl: {\n    shadowColor: '#000',\n    shadowOffset: { width: 0, height: 20 },\n    shadowOpacity: 0.25,\n    shadowRadius: 25,\n    elevation: 12,\n  },\n};\n\nexport const animations: AppAnimations = {\n  duration: {\n    fast: 150,\n    normal: 300,\n    slow: 500,\n  },\n  easing: {\n    ease: 'ease',\n    easeIn: 'ease-in',\n    easeOut: 'ease-out',\n    easeInOut: 'ease-in-out',\n  },\n};\n\n// Default theme export\nconst defaultTheme: AppTheme = {\n  colors: lightModeColors,\n  typography,\n  spacing,\n  borderRadius,\n  shadows,\n  animations,\n  isDarkMode: false,\n};\n\nexport default defaultTheme; ","import React, { createContext, useState, useEffect, useContext, ReactNode } from 'react';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { Appearance } from 'react-native';\n\nimport { AppTheme, lightModeColors, darkModeColors, typography, spacing, borderRadius, shadows, animations } from '../config/theme';\n\ninterface ThemeContextProps {\n  theme: AppTheme;\n  toggleTheme: () => void;\n  isSystemTheme: boolean;\n  setUseSystemTheme: (value: boolean) => void;\n}\n\nconst ThemeContext = createContext<ThemeContextProps | undefined>(undefined);\n\ninterface ThemeProviderProps {\n  children: ReactNode;\n}\n\nexport const ThemeProvider: React.FC<ThemeProviderProps> = ({ children }) => {\n  const systemColorScheme = Appearance.getColorScheme(); // 'light' | 'dark' | null\n  const [isDarkMode, setIsDarkMode] = useState(systemColorScheme === 'dark');\n  const [useSystemTheme, setUseSystemThemeState] = useState(true); // Default to using system theme\n\n  useEffect(() => {\n    const loadThemePreference = async () => {\n      try {\n        const savedThemeMode = await AsyncStorage.getItem('themeMode'); // 'light', 'dark', or 'system'\n        if (savedThemeMode) {\n          if (savedThemeMode === 'system') {\n            setUseSystemThemeState(true);\n            setIsDarkMode(systemColorScheme === 'dark');\n          } else {\n            setUseSystemThemeState(false);\n            setIsDarkMode(savedThemeMode === 'dark');\n          }\n        } else {\n          // If no preference saved, default to system theme\n          setUseSystemThemeState(true);\n          setIsDarkMode(systemColorScheme === 'dark');\n        }\n      } catch (error) {\n        console.error('Failed to load theme preference from storage', error);\n        // Fallback to system theme on error\n        setUseSystemThemeState(true);\n        setIsDarkMode(systemColorScheme === 'dark');\n      }\n    };\n    loadThemePreference();\n  }, [systemColorScheme]);\n\n  useEffect(() => {\n    // Listener for system theme changes\n    const subscription = Appearance.addChangeListener(({ colorScheme }) => {\n      if (useSystemTheme) {\n        setIsDarkMode(colorScheme === 'dark');\n      }\n    });\n    return () => subscription.remove();\n  }, [useSystemTheme]);\n\n  const toggleTheme = async () => {\n    const newIsDarkMode = !isDarkMode;\n    setIsDarkMode(newIsDarkMode);\n    setUseSystemThemeState(false); // Manual toggle means not following system theme anymore\n    try {\n      await AsyncStorage.setItem('themeMode', newIsDarkMode ? 'dark' : 'light');\n    } catch (error) {\n      console.error('Failed to save theme mode to storage', error);\n    }\n  };\n\n  const setUseSystemTheme = async (value: boolean) => {\n    setUseSystemThemeState(value);\n    if (value) {\n      setIsDarkMode(systemColorScheme === 'dark');\n      try {\n        await AsyncStorage.setItem('themeMode', 'system');\n      } catch (error) {\n        console.error('Failed to save theme mode (system) to storage', error);\n      }\n    } else {\n      // If switching off system theme, retain current manual theme (light/dark)\n      // The toggleTheme function or an explicit set (light/dark) will handle AsyncStorage for non-system themes\n      // For simplicity, we can re-save current explicit choice if user toggles system off.\n      try {\n        await AsyncStorage.setItem('themeMode', isDarkMode ? 'dark' : 'light');\n      } catch (error) {\n        console.error('Failed to save theme mode (manual) to storage', error);\n      }\n    }\n  };\n  \n  const currentThemeColors = isDarkMode ? darkModeColors : lightModeColors;\n  const theme: AppTheme = {\n    colors: currentThemeColors,\n    typography,\n    spacing,\n    borderRadius,\n    shadows,\n    animations,\n    isDarkMode,\n  };\n\n  return (\n    <ThemeContext.Provider value={{ theme, toggleTheme, isSystemTheme: useSystemTheme, setUseSystemTheme }}>\n      {children}\n    </ThemeContext.Provider>\n  );\n};\n\nexport const useAppTheme = (): ThemeContextProps => {\n  const context = useContext(ThemeContext);\n  if (!context) {\n    throw new Error('useAppTheme must be used within a ThemeProvider');\n  }\n  return context;\n}; ","import React, { forwardRef } from 'react';\nimport { ScrollView, ScrollViewProps, Platform } from 'react-native';\nimport { useAppTheme } from '../contexts/ThemeContext';\n\ninterface SafeScrollViewProps extends ScrollViewProps {\n  children: React.ReactNode;\n  extraBottomPadding?: number;\n}\n\nconst SafeScrollView = forwardRef<ScrollView, SafeScrollViewProps>(({\n  children,\n  extraBottomPadding = 0,\n  contentContainerStyle,\n  ...props\n}, ref) => {\n  const { theme } = useAppTheme();\n\n  // Calculate safe bottom padding\n  // Tab bar height + FAB height + some extra spacing\n  const tabBarHeight = Platform.OS === 'ios' ? 88 : 75;\n  const fabHeight = 64;\n  const fabBottomMargin = Platform.OS === 'ios' ? 100 : 85;\n  const extraSpacing = theme.spacing.xl;\n  \n  // Use the larger of FAB bottom position or tab bar height, plus extra spacing\n  // Increased padding to ensure content is fully accessible past the floating button\n  const safeBottomPadding = Math.max(fabBottomMargin + fabHeight/2, tabBarHeight) + extraSpacing + extraBottomPadding + 40;\n\n  const safeContentContainerStyle = [\n    {\n      paddingBottom: safeBottomPadding,\n    },\n    contentContainerStyle,\n  ];\n\n  return (\n    <ScrollView\n      ref={ref}\n      {...props}\n      contentContainerStyle={safeContentContainerStyle}\n      showsVerticalScrollIndicator={true}\n      keyboardShouldPersistTaps=\"handled\"\n      scrollEventThrottle={16}\n    >\n      {children}\n    </ScrollView>\n  );\n});\n\nSafeScrollView.displayName = 'SafeScrollView';\n\nexport default SafeScrollView; ","import React, { useState, useEffect } from 'react';\nimport { \n  View, \n  Text, \n  StyleSheet, \n  ScrollView, \n  TouchableOpacity, \n  ActivityIndicator, \n  Modal,\n  SafeAreaView,\n  Platform\n} from 'react-native';\nimport { Ionicons } from '@expo/vector-icons';\nimport Constants from 'expo-constants';\nimport logger from './logger';\n\ninterface LogViewerProps {\n  visible: boolean;\n  onClose: () => void;\n}\n\nconst LogViewer: React.FC<LogViewerProps> = ({ visible, onClose }) => {\n  const [logs, setLogs] = useState<string>('');\n  const [loading, setLoading] = useState<boolean>(true);\n  const [filter, setFilter] = useState<'all' | 'error' | 'warn' | 'info'>('all');\n\n  useEffect(() => {\n    if (visible) {\n      fetchLogs();\n    }\n  }, [visible, filter]);\n\n  const fetchLogs = async () => {\n    setLoading(true);\n    try {\n      const logData = await logger.getLogs();\n      \n      // Apply filters if needed\n      if (filter !== 'all') {\n        const filteredLogs = logData\n          .split('\\n')\n          .filter(line => {\n            const upperFilter = `[${filter.toUpperCase()}]`;\n            return line.includes(upperFilter);\n          })\n          .join('\\n');\n        setLogs(filteredLogs || 'No matching logs found.');\n      } else {\n        setLogs(logData);\n      }\n    } catch (error) {\n      console.error('Error fetching logs:', error);\n      setLogs('Error loading logs. Please try again.');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const clearLogs = async () => {\n    // This is a placeholder - we would implement proper log clearing in the logger\n    setLogs('Logs have been cleared.');\n  };\n\n  const isWeb = Platform.OS === 'web';\n\n  return (\n    <Modal\n      animationType=\"slide\"\n      transparent={false}\n      visible={visible}\n      onRequestClose={onClose}\n    >\n      <SafeAreaView style={styles.container}>\n        <View style={styles.header}>\n          <TouchableOpacity style={styles.closeButton} onPress={onClose}>\n            <Ionicons name=\"close\" size={24} color=\"#333\" />\n          </TouchableOpacity>\n          <Text style={styles.title}>Application Logs</Text>\n          <TouchableOpacity style={styles.refreshButton} onPress={fetchLogs}>\n            <Ionicons name=\"refresh\" size={24} color=\"#333\" />\n          </TouchableOpacity>\n        </View>\n\n        <View style={styles.filterContainer}>\n          <TouchableOpacity \n            style={[styles.filterButton, filter === 'all' && styles.activeFilter]} \n            onPress={() => setFilter('all')}\n          >\n            <Text style={[styles.filterText, filter === 'all' && styles.activeFilterText]}>All</Text>\n          </TouchableOpacity>\n          <TouchableOpacity \n            style={[styles.filterButton, filter === 'error' && styles.activeFilter]} \n            onPress={() => setFilter('error')}\n          >\n            <Text style={[styles.filterText, filter === 'error' && styles.activeFilterText]}>Errors</Text>\n          </TouchableOpacity>\n          <TouchableOpacity \n            style={[styles.filterButton, filter === 'warn' && styles.activeFilter]} \n            onPress={() => setFilter('warn')}\n          >\n            <Text style={[styles.filterText, filter === 'warn' && styles.activeFilterText]}>Warnings</Text>\n          </TouchableOpacity>\n          <TouchableOpacity \n            style={[styles.filterButton, filter === 'info' && styles.activeFilter]} \n            onPress={() => setFilter('info')}\n          >\n            <Text style={[styles.filterText, filter === 'info' && styles.activeFilterText]}>Info</Text>\n          </TouchableOpacity>\n        </View>\n\n        {loading ? (\n          <View style={styles.loadingContainer}>\n            <ActivityIndicator size=\"large\" color=\"#7D4CDB\" />\n            <Text style={styles.loadingText}>Loading logs...</Text>\n          </View>\n        ) : (\n          <ScrollView style={styles.logsContainer}>\n            {isWeb ? (\n              <View>\n                <Text style={styles.webNotice}>\n                  Logs are only available in the developer console on web. \n                  Please check your browser's developer tools.\n                </Text>\n                <Text style={styles.codeBlock}>console.log('View logs here in browser console')</Text>\n              </View>\n            ) : (\n              <Text style={styles.logs}>{logs}</Text>\n            )}\n          </ScrollView>\n        )}\n\n        <View style={styles.footer}>\n          <TouchableOpacity \n            style={styles.clearButton} \n            onPress={clearLogs}\n          >\n            <Text style={styles.clearButtonText}>Clear Logs</Text>\n          </TouchableOpacity>\n        </View>\n      </SafeAreaView>\n    </Modal>\n  );\n};\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: '#f5f5f5',\n    paddingTop: Constants.statusBarHeight,\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    padding: 16,\n    borderBottomWidth: 1,\n    borderBottomColor: '#e0e0e0',\n    backgroundColor: '#fff',\n  },\n  title: {\n    fontSize: 18,\n    fontWeight: 'bold',\n    color: '#333',\n  },\n  closeButton: {\n    padding: 8,\n  },\n  refreshButton: {\n    padding: 8,\n  },\n  filterContainer: {\n    flexDirection: 'row',\n    padding: 8,\n    borderBottomWidth: 1,\n    borderBottomColor: '#e0e0e0',\n    backgroundColor: '#fff',\n  },\n  filterButton: {\n    paddingVertical: 6,\n    paddingHorizontal: 12,\n    borderRadius: 16,\n    marginHorizontal: 4,\n    backgroundColor: '#f0f0f0',\n  },\n  activeFilter: {\n    backgroundColor: '#7D4CDB',\n  },\n  filterText: {\n    fontSize: 14,\n    color: '#666',\n  },\n  activeFilterText: {\n    color: '#fff',\n  },\n  loadingContainer: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  loadingText: {\n    marginTop: 12,\n    fontSize: 16,\n    color: '#666',\n  },\n  logsContainer: {\n    flex: 1,\n    padding: 16,\n    backgroundColor: '#f8f8f8',\n  },\n  logs: {\n    fontFamily: Platform.select({\n      ios: 'Menlo',\n      android: 'monospace',\n      default: 'monospace',\n    }),\n    fontSize: 12,\n    color: '#333',\n  },\n  webNotice: {\n    fontSize: 16,\n    color: '#666',\n    marginBottom: 16,\n    textAlign: 'center',\n  },\n  codeBlock: {\n    fontFamily: 'monospace',\n    fontSize: 14,\n    backgroundColor: '#333',\n    color: '#fff',\n    padding: 16,\n    borderRadius: 8,\n  },\n  footer: {\n    padding: 16,\n    borderTopWidth: 1,\n    borderTopColor: '#e0e0e0',\n    backgroundColor: '#fff',\n  },\n  clearButton: {\n    backgroundColor: '#f44336',\n    borderRadius: 8,\n    padding: 12,\n    alignItems: 'center',\n  },\n  clearButtonText: {\n    color: '#fff',\n    fontWeight: 'bold',\n  },\n});\n\nexport default LogViewer; ","import React, { useState, useEffect } from 'react';\nimport { View, Text, TouchableOpacity, ActivityIndicator, StyleSheet } from 'react-native';\nimport { useAuth } from '../contexts/AuthContext';\nimport { useAppTheme } from '../contexts/ThemeContext';\nimport { AppTheme } from '../config/theme';\nimport logger from '../utils/logger';\n\ninterface OpaqueAuthButtonProps {\n  mode: 'login' | 'register';\n  email: string;\n  password: string;\n  name?: string;\n  confirmPassword?: string;\n  onSuccess?: () => void;\n  onError?: (error: string) => void;\n  disabled?: boolean;\n  style?: any;\n}\n\nconst OpaqueAuthButton: React.FC<OpaqueAuthButtonProps> = ({\n  mode,\n  email,\n  password,\n  name,\n  confirmPassword,\n  onSuccess,\n  onError,\n  disabled = false,\n  style\n}) => {\n  const { \n    opaqueLogin, \n    opaqueRegister, \n    hasOpaqueSupport,\n    isLoading: authLoading \n  } = useAuth();\n  \n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n  \n  const [isLoading, setIsLoading] = useState(false);\n  const [opaqueSupported, setOpaqueSupported] = useState<boolean | null>(null);\n  const [checkingSupport, setCheckingSupport] = useState(true);\n\n  // Check OPAQUE support on component mount\n  useEffect(() => {\n    const checkSupport = async () => {\n      try {\n        setCheckingSupport(true);\n        const supported = await hasOpaqueSupport();\n        setOpaqueSupported(supported);\n        logger.info('Authentication service check completed', { supported });\n      } catch (error) {\n        logger.error('Failed to check authentication service', error);\n        setOpaqueSupported(false);\n      } finally {\n        setCheckingSupport(false);\n      }\n    };\n\n    checkSupport();\n  }, [hasOpaqueSupport]);\n\n  const handleAuth = async () => {\n    // Email validation regex - comprehensive pattern\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n    \n    // Validate required fields with specific messages\n    if (mode === 'register' && !name?.trim()) {\n      onError?.('Please enter your name');\n      return;\n    }\n    if (!email?.trim()) {\n      onError?.('Please enter your email address');\n      return;\n    }\n    \n    // Only apply strict email validation for registration\n    if (mode === 'register') {\n      const trimmedEmail = email.trim();\n      if (!emailRegex.test(trimmedEmail)) {\n        onError?.('Please enter a valid email address (e.g., user@example.com)');\n        return;\n      }\n      \n      // Additional email validation checks for registration\n      if (trimmedEmail.length > 254) {\n        onError?.('Email address is too long');\n        return;\n      }\n      if (trimmedEmail.includes('..')) {\n        onError?.('Email address cannot contain consecutive dots');\n        return;\n      }\n    }\n    if (!password) {\n      onError?.('Please enter a password');\n      return;\n    }\n    if (mode === 'register' && password.length < 8) {\n      onError?.('Password must be at least 8 characters long');\n      return;\n    }\n    if (mode === 'register') {\n      if (password.length > 128) {\n        onError?.('Password is too long (maximum 128 characters)');\n        return;\n      }\n      if (!confirmPassword) {\n        onError?.('Please confirm your password');\n        return;\n      }\n    }\n    if (mode === 'register' && password !== confirmPassword) {\n      onError?.('Passwords do not match');\n      return;\n    }\n\n    if (!opaqueSupported) {\n      onError?.('Authentication service is currently unavailable');\n      return;\n    }\n\n    try {\n      setIsLoading(true);\n      \n      logger.info(`Starting secure ${mode} process`);\n      \n      if (mode === 'login') {\n        await opaqueLogin(email, password);\n      } else {\n        await opaqueRegister(name!, email, password);\n      }\n      \n      onSuccess?.();\n    } catch (error: any) {\n      logger.error(`Secure ${mode} failed:`, error);\n      \n      let errorMsg = `An error occurred during ${mode}. Please try again.`;\n      \n      if (error.status === 401) {\n        errorMsg = 'Invalid email or password. Please try again.';\n      } else if (error.status === 422) {\n        if (error.message && typeof error.message === 'string') {\n          errorMsg = error.message;\n        } else if (error.errors && Array.isArray(error.errors)) {\n          errorMsg = error.errors.join('\\n');\n        }\n      } else if (error.status === 400 && error.message === 'User already exists') {\n        errorMsg = 'An account with this email already exists. Please try signing in instead.';\n      } else if (error.status === 409) {\n        errorMsg = 'An account with this email already exists.';\n      } else if (error.status === 500 && error.message.includes('Database connection error')) {\n        errorMsg = 'Cannot connect to the database. Please make sure the database service is running.';\n      } else if (error.status === 0) {\n        errorMsg = 'Unable to connect to the server. Please check your connection and try again.';\n      } else if (error.message) {\n        errorMsg = error.message;\n      }\n      \n      onError?.(errorMsg);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const isButtonDisabled = disabled || authLoading || isLoading || checkingSupport || !opaqueSupported;\n\n  if (checkingSupport) {\n    return (\n      <View style={[styles.button, styles.checkingButton, style]}>\n        <ActivityIndicator size=\"small\" color={theme.colors.white} />\n        <Text style={styles.buttonText}>Checking Server...</Text>\n      </View>\n    );\n  }\n\n  if (!opaqueSupported) {\n    return (\n      <View style={[styles.button, styles.disabledButton, style]}>\n        <Text style={[styles.buttonText, styles.disabledText]}>Server Unavailable</Text>\n      </View>\n    );\n  }\n\n  return (\n    <TouchableOpacity\n      style={[\n        styles.button,\n        isButtonDisabled ? styles.disabledButton : styles.enabledButton,\n        style\n      ]}\n      onPress={handleAuth}\n      disabled={isButtonDisabled}\n    >\n      {isLoading || authLoading ? (\n        <ActivityIndicator size=\"small\" color={theme.colors.white} />\n      ) : (\n        <Text style={styles.buttonText}>\n          {mode === 'login' ? 'Sign In' : 'Create Account'}\n        </Text>\n      )}\n    </TouchableOpacity>\n  );\n};\n\nconst getStyles = (theme: AppTheme) => StyleSheet.create({\n  button: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    paddingVertical: theme.spacing.md,\n    paddingHorizontal: theme.spacing.lg,\n    borderRadius: theme.borderRadius.lg,\n    minHeight: 56,\n  },\n  enabledButton: {\n    backgroundColor: theme.colors.primary,\n    ...theme.shadows.sm,\n  },\n  disabledButton: {\n    backgroundColor: theme.colors.disabled,\n  },\n  checkingButton: {\n    backgroundColor: theme.colors.warning,\n    ...theme.shadows.sm,\n  },\n  buttonText: {\n    color: theme.colors.white,\n    fontSize: theme.typography.fontSizes.md,\n    fontWeight: '600',\n    fontFamily: theme.typography.fontFamilies.semiBold,\n    marginLeft: theme.spacing.sm,\n  },\n  disabledText: {\n    color: theme.colors.textDisabled,\n  },\n});\n\nexport default OpaqueAuthButton; ","import React, { useState, useEffect } from 'react';\nimport { \n  View, \n  Text, \n  TextInput, \n  TouchableOpacity, \n  StyleSheet, \n  ActivityIndicator,\n  Alert\n} from 'react-native';\nimport { useNavigation } from '@react-navigation/native';\nimport { StackNavigationProp } from '@react-navigation/stack';\nimport { RootStackParamList, MainStackParamList } from '../../navigation/types';\nimport { Ionicons } from '@expo/vector-icons';\nimport * as WebBrowser from 'expo-web-browser';\nimport Constants from 'expo-constants';\n\nimport { useAuth } from '../../contexts/AuthContext';\nimport { useAppTheme } from '../../contexts/ThemeContext';\nimport { AppTheme } from '../../config/theme';\nimport SafeScrollView from '../../components/SafeScrollView';\nimport logger from '../../utils/logger';\nimport LogViewer from '../../utils/LogViewer';\nimport OpaqueAuthButton from '../../components/OpaqueAuthButton';\n\n// Ensure web browser redirect results are handled\nWebBrowser.maybeCompleteAuthSession();\n\ntype LoginScreenNavigationProp = StackNavigationProp<RootStackParamList>;\n\nconst LoginScreen = () => {\n  const navigation = useNavigation<LoginScreenNavigationProp>();\n  const { isLoading: authLoading } = useAuth();\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n  \n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const [showPassword, setShowPassword] = useState(false);\n  const [errorMessage, setErrorMessage] = useState<string | null>(null);\n  const [showLogViewer, setShowLogViewer] = useState(false);\n  \n  // Check if we're in development mode\n  const isDev = __DEV__;\n  \n  // Clear error message when inputs change\n  useEffect(() => {\n    if (errorMessage) {\n      setErrorMessage(null);\n    }\n  }, [email, password]);\n  \n  const handleGoogleLogin = async () => {\n    setErrorMessage('Google login is not available with OPAQUE zero-knowledge authentication. Please use email/password registration and login.');\n  };\n  \n  const navigateToRegister = () => {\n    navigation.navigate('Auth', { screen: 'Register' });\n  };\n\n  const openLogViewer = () => {\n    setShowLogViewer(true);\n  };\n  \n  return (\n    <View style={styles.container}>\n      <SafeScrollView \n        style={styles.scrollContainer}\n        contentContainerStyle={styles.scrollContent}\n        keyboardShouldPersistTaps=\"handled\"\n        showsVerticalScrollIndicator={false}\n      >\n        {/* Welcome Card */}\n        <View style={styles.welcomeCard}>\n          <View style={styles.logoContainer}>\n            <View style={styles.logoCircle}>\n              <Ionicons name=\"mic\" size={32} color={theme.colors.primary} />\n            </View>\n            <Text style={styles.appName}>Welcome Back</Text>\n            <Text style={styles.tagline}>Sign in to continue your journey</Text>\n          </View>\n        </View>\n\n        {/* Login Form Card */}\n        <View style={styles.formCard}>\n          <View style={styles.formHeader}>\n            <Text style={styles.formTitle}>Sign In</Text>\n            <Text style={styles.formSubtitle}>Enter your credentials to access your account</Text>\n          </View>\n\n          {errorMessage && (\n            <View style={styles.errorContainer}>\n              <Ionicons name=\"alert-circle-outline\" size={20} color={theme.colors.error} />\n              <Text style={styles.errorText}>{errorMessage}</Text>\n            </View>\n          )}\n          \n          <View style={styles.inputContainer}>\n            <View style={styles.inputWrapper}>\n              <Ionicons name=\"mail-outline\" size={20} color={theme.colors.textSecondary} style={styles.inputIcon} />\n              <TextInput\n                style={styles.input}\n                placeholder=\"Email address\"\n                value={email}\n                onChangeText={setEmail}\n                keyboardType=\"email-address\"\n                autoCapitalize=\"none\"\n                autoCorrect={false}\n                placeholderTextColor={theme.colors.textDisabled}\n              />\n            </View>\n          </View>\n          \n          <View style={styles.inputContainer}>\n            <View style={styles.inputWrapper}>\n              <Ionicons name=\"lock-closed-outline\" size={20} color={theme.colors.textSecondary} style={styles.inputIcon} />\n              <TextInput\n                style={styles.input}\n                placeholder=\"Password\"\n                value={password}\n                onChangeText={setPassword}\n                secureTextEntry={!showPassword}\n                autoCapitalize=\"none\"\n                autoCorrect={false}\n                placeholderTextColor={theme.colors.textDisabled}\n              />\n              <TouchableOpacity \n                onPress={() => setShowPassword(!showPassword)}\n                style={styles.eyeIcon}\n              >\n                <Ionicons \n                  name={showPassword ? 'eye-off-outline' : 'eye-outline'} \n                  size={20} \n                  color={theme.colors.textSecondary} \n                />\n              </TouchableOpacity>\n            </View>\n          </View>\n          \n          <OpaqueAuthButton\n            mode=\"login\"\n            email={email}\n            password={password}\n            onSuccess={() => {\n              // Navigation will be handled by AuthContext\n              logger.info('Login successful via OPAQUE');\n            }}\n            onError={(error: string) => {\n              setErrorMessage(error);\n            }}\n            disabled={!email || !password || isLoading || authLoading}\n            style={styles.loginButton}\n          />\n          \n          <View style={styles.dividerContainer}>\n            <View style={styles.dividerLine} />\n            <Text style={styles.dividerText}>or</Text>\n            <View style={styles.dividerLine} />\n          </View>\n          \n          <TouchableOpacity \n            style={styles.googleButton}\n            onPress={handleGoogleLogin}\n            disabled={isLoading || authLoading}\n          >\n            <Ionicons name=\"logo-google\" size={20} color=\"#EA4335\" />\n            <Text style={styles.googleButtonText}>Continue with Google</Text>\n          </TouchableOpacity>\n        </View>\n\n        {/* Register Prompt Card */}\n        <View style={styles.registerCard}>\n          <Text style={styles.registerText}>Don't have an account?</Text>\n          <TouchableOpacity onPress={navigateToRegister} style={styles.registerButton}>\n            <Text style={styles.registerButtonText}>Create Account</Text>\n            <Ionicons name=\"arrow-forward\" size={16} color={theme.colors.primary} />\n          </TouchableOpacity>\n        </View>\n\n        {isDev && (\n          <TouchableOpacity \n            style={styles.debugButton}\n            onPress={openLogViewer}\n          >\n            <Ionicons name=\"bug-outline\" size={16} color={theme.colors.textSecondary} />\n            <Text style={styles.debugButtonText}>Show Logs</Text>\n          </TouchableOpacity>\n        )}\n      </SafeScrollView>\n      \n      <LogViewer \n        visible={showLogViewer} \n        onClose={() => setShowLogViewer(false)} \n      />\n    </View>\n  );\n};\n\nconst getStyles = (theme: AppTheme) => StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: theme.colors.background,\n  },\n  scrollContainer: {\n    flex: 1,\n  },\n  scrollContent: {\n    flexGrow: 1,\n    padding: theme.spacing.lg,\n    paddingTop: theme.spacing.xl,\n  },\n  welcomeCard: {\n    backgroundColor: theme.colors.card,\n    borderRadius: theme.borderRadius.xl,\n    padding: theme.spacing.xl,\n    marginBottom: theme.spacing.lg,\n    ...theme.shadows.md,\n    borderColor: theme.isDarkMode ? theme.colors.border : 'transparent',\n    borderWidth: theme.isDarkMode ? 1 : 0,\n  },\n  logoContainer: {\n    alignItems: 'center',\n  },\n  logoCircle: {\n    width: 80,\n    height: 80,\n    borderRadius: 40,\n    backgroundColor: theme.colors.primaryLight + '20',\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginBottom: theme.spacing.lg,\n  },\n  appName: {\n    fontSize: theme.typography.fontSizes.xxxl,\n    fontWeight: 'bold',\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.bold,\n    marginBottom: theme.spacing.sm,\n  },\n  tagline: {\n    fontSize: theme.typography.fontSizes.lg,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.regular,\n    textAlign: 'center',\n  },\n  formCard: {\n    backgroundColor: theme.colors.card,\n    borderRadius: theme.borderRadius.xl,\n    padding: theme.spacing.xl,\n    marginBottom: theme.spacing.lg,\n    ...theme.shadows.md,\n    borderColor: theme.isDarkMode ? theme.colors.border : 'transparent',\n    borderWidth: theme.isDarkMode ? 1 : 0,\n  },\n  formHeader: {\n    marginBottom: theme.spacing.xl,\n  },\n  formTitle: {\n    fontSize: theme.typography.fontSizes.xxl,\n    fontWeight: 'bold',\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.bold,\n    marginBottom: theme.spacing.xs,\n  },\n  formSubtitle: {\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  errorContainer: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: theme.colors.errorLight,\n    borderRadius: theme.borderRadius.md,\n    padding: theme.spacing.md,\n    marginBottom: theme.spacing.lg,\n    borderWidth: 1,\n    borderColor: theme.colors.error + '30',\n  },\n  errorText: {\n    color: theme.colors.error,\n    fontSize: theme.typography.fontSizes.sm,\n    fontFamily: theme.typography.fontFamilies.medium,\n    marginLeft: theme.spacing.sm,\n    flex: 1,\n  },\n  inputContainer: {\n    marginBottom: theme.spacing.lg,\n  },\n  inputWrapper: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: theme.colors.inputBackground,\n    borderRadius: theme.borderRadius.lg,\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n    paddingHorizontal: theme.spacing.md,\n    height: 56,\n  },\n  inputIcon: {\n    marginRight: theme.spacing.md,\n  },\n  input: {\n    flex: 1,\n    fontSize: theme.typography.fontSizes.md,\n    fontFamily: theme.typography.fontFamilies.regular,\n    color: theme.colors.text,\n  },\n  eyeIcon: {\n    padding: theme.spacing.xs,\n  },\n  loginButton: {\n    backgroundColor: theme.colors.primary,\n    borderRadius: theme.borderRadius.lg,\n    height: 56,\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginBottom: theme.spacing.lg,\n    ...theme.shadows.sm,\n  },\n  dividerContainer: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginVertical: theme.spacing.lg,\n  },\n  dividerLine: {\n    flex: 1,\n    height: 1,\n    backgroundColor: theme.colors.border,\n  },\n  dividerText: {\n    marginHorizontal: theme.spacing.md,\n    fontSize: theme.typography.fontSizes.sm,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.medium,\n  },\n  googleButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    backgroundColor: theme.colors.surface,\n    borderRadius: theme.borderRadius.lg,\n    height: 56,\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n    ...theme.shadows.sm,\n  },\n  googleButtonText: {\n    fontSize: theme.typography.fontSizes.md,\n    fontWeight: '600',\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n    marginLeft: theme.spacing.sm,\n  },\n  registerCard: {\n    backgroundColor: theme.colors.card,\n    borderRadius: theme.borderRadius.xl,\n    padding: theme.spacing.lg,\n    marginBottom: theme.spacing.lg,\n    ...theme.shadows.sm,\n    borderColor: theme.isDarkMode ? theme.colors.border : 'transparent',\n    borderWidth: theme.isDarkMode ? 1 : 0,\n  },\n  registerText: {\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.regular,\n    textAlign: 'center',\n    marginBottom: theme.spacing.md,\n  },\n  registerButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    backgroundColor: theme.colors.primaryLight + '20',\n    borderRadius: theme.borderRadius.lg,\n    paddingVertical: theme.spacing.md,\n    paddingHorizontal: theme.spacing.lg,\n  },\n  registerButtonText: {\n    fontSize: theme.typography.fontSizes.md,\n    fontWeight: '600',\n    color: theme.colors.primary,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n    marginRight: theme.spacing.xs,\n  },\n  debugButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    backgroundColor: theme.colors.surface,\n    borderRadius: theme.borderRadius.md,\n    paddingVertical: theme.spacing.sm,\n    paddingHorizontal: theme.spacing.md,\n    marginTop: theme.spacing.lg,\n    alignSelf: 'center',\n  },\n  debugButtonText: {\n    fontSize: theme.typography.fontSizes.xs,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.medium,\n    marginLeft: theme.spacing.xs,\n  },\n});\n\nexport default LoginScreen; ","import React, { useState, useEffect } from 'react';\nimport { \n  View, \n  Text, \n  TextInput, \n  TouchableOpacity, \n  StyleSheet, \n  ActivityIndicator,\n  Alert\n} from 'react-native';\nimport { useNavigation } from '@react-navigation/native';\nimport { StackNavigationProp } from '@react-navigation/stack';\nimport { RootStackParamList } from '../../navigation/types';\nimport { Ionicons } from '@expo/vector-icons';\nimport * as WebBrowser from 'expo-web-browser';\nimport Constants from 'expo-constants';\n\nimport { useAuth } from '../../contexts/AuthContext';\nimport { useAppTheme } from '../../contexts/ThemeContext';\nimport { AppTheme } from '../../config/theme';\nimport SafeScrollView from '../../components/SafeScrollView';\nimport OpaqueAuthButton from '../../components/OpaqueAuthButton';\n\n// Ensure web browser redirect results are handled\nWebBrowser.maybeCompleteAuthSession();\n\ntype RegisterScreenNavigationProp = StackNavigationProp<RootStackParamList>;\n\nconst RegisterScreen = () => {\n  const navigation = useNavigation<RegisterScreenNavigationProp>();\n  const { isLoading: authLoading } = useAuth();\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n  \n  // Debug navigation changes\n  useEffect(() => {\n    console.log('RegisterScreen mounted');\n    return () => {\n      console.log('RegisterScreen unmounted');\n    };\n  }, []);\n  \n  const [name, setName] = useState('');\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const [confirmPassword, setConfirmPassword] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const [showPassword, setShowPassword] = useState(false);\n  const [errorMessage, setErrorMessage] = useState<string | null>(null);\n  const [successMessage, setSuccessMessage] = useState<string | null>(null);\n  \n  // Clear error and success messages when inputs change\n  useEffect(() => {\n    if (errorMessage) {\n      setErrorMessage(null);\n    }\n    if (successMessage) {\n      setSuccessMessage(null);\n    }\n  }, [name, email, password, confirmPassword]);\n  \n  const handleGoogleRegister = async () => {\n    setErrorMessage('Google registration is not available with secure zero-knowledge authentication. Please use email/password registration.');\n  };\n  \n  const navigateToLogin = () => {\n    navigation.navigate('Auth', { screen: 'Login' });\n  };\n  \n  // Check if inputs are valid without side effects\n  // Form validation is now handled by OpaqueAuthButton component\n  \n  return (\n    <View style={styles.container}>\n      <SafeScrollView \n        style={styles.scrollContainer}\n        contentContainerStyle={styles.scrollContent}\n        keyboardShouldPersistTaps=\"handled\"\n        showsVerticalScrollIndicator={false}\n      >\n        {/* Header */}\n        <View style={styles.headerContainer}>\n          <TouchableOpacity \n            style={styles.backButton} \n            onPress={navigateToLogin}\n          >\n            <Ionicons name=\"arrow-back\" size={24} color={theme.colors.text} />\n          </TouchableOpacity>\n        </View>\n\n        {/* Welcome Card */}\n        <View style={styles.welcomeCard}>\n          <View style={styles.logoContainer}>\n            <View style={styles.logoCircle}>\n              <Ionicons name=\"person-add\" size={32} color={theme.colors.primary} />\n            </View>\n            <Text style={styles.appName}>Create Account</Text>\n            <Text style={styles.tagline}>Join us and start your journaling journey</Text>\n          </View>\n        </View>\n\n        {/* Registration Form Card */}\n        <View style={styles.formCard}>\n          <View style={styles.formHeader}>\n            <Text style={styles.formTitle}>Sign Up</Text>\n            <Text style={styles.formSubtitle}>Fill in your information to get started</Text>\n          </View>\n\n          {errorMessage && (\n            <View style={styles.errorContainer}>\n              <Ionicons name=\"alert-circle-outline\" size={20} color={theme.colors.error} />\n              <Text style={styles.errorText}>{errorMessage}</Text>\n            </View>\n          )}\n          \n          {successMessage && (\n            <View style={styles.successContainer}>\n              <Ionicons name=\"checkmark-circle-outline\" size={20} color={theme.colors.success} />\n              <View style={styles.successTextContainer}>\n                <Text style={styles.successText}>{successMessage}</Text>\n                <TouchableOpacity onPress={navigateToLogin} style={styles.signInLinkContainer}>\n                  <Text style={styles.signInLinkText}>Sign in now</Text>\n                  <Ionicons name=\"arrow-forward\" size={16} color={theme.colors.primary} />\n                </TouchableOpacity>\n              </View>\n            </View>\n          )}\n          \n          <View style={styles.inputContainer}>\n            <View style={styles.inputWrapper}>\n              <Ionicons name=\"person-outline\" size={20} color={theme.colors.textSecondary} style={styles.inputIcon} />\n              <TextInput\n                style={styles.input}\n                placeholder=\"Name\"\n                value={name}\n                onChangeText={setName}\n                autoCapitalize=\"words\"\n                autoCorrect={false}\n                placeholderTextColor={theme.colors.textDisabled}\n              />\n            </View>\n          </View>\n          \n          <View style={styles.inputContainer}>\n            <View style={styles.inputWrapper}>\n              <Ionicons name=\"mail-outline\" size={20} color={theme.colors.textSecondary} style={styles.inputIcon} />\n              <TextInput\n                style={styles.input}\n                placeholder=\"Email address\"\n                value={email}\n                onChangeText={setEmail}\n                keyboardType=\"email-address\"\n                autoCapitalize=\"none\"\n                autoCorrect={false}\n                placeholderTextColor={theme.colors.textDisabled}\n              />\n            </View>\n          </View>\n          \n          <View style={styles.inputContainer}>\n            <View style={styles.inputWrapper}>\n              <Ionicons name=\"lock-closed-outline\" size={20} color={theme.colors.textSecondary} style={styles.inputIcon} />\n              <TextInput\n                style={styles.input}\n                placeholder=\"Password\"\n                value={password}\n                onChangeText={setPassword}\n                secureTextEntry={!showPassword}\n                autoCapitalize=\"none\"\n                autoCorrect={false}\n                placeholderTextColor={theme.colors.textDisabled}\n              />\n              <TouchableOpacity \n                onPress={() => setShowPassword(!showPassword)}\n                style={styles.eyeIcon}\n              >\n                <Ionicons \n                  name={showPassword ? 'eye-off-outline' : 'eye-outline'} \n                  size={20} \n                  color={theme.colors.textSecondary} \n                />\n              </TouchableOpacity>\n            </View>\n          </View>\n          \n          <View style={styles.inputContainer}>\n            <View style={styles.inputWrapper}>\n              <Ionicons name=\"lock-closed-outline\" size={20} color={theme.colors.textSecondary} style={styles.inputIcon} />\n              <TextInput\n                style={styles.input}\n                placeholder=\"Confirm Password\"\n                value={confirmPassword}\n                onChangeText={setConfirmPassword}\n                secureTextEntry={!showPassword}\n                autoCapitalize=\"none\"\n                autoCorrect={false}\n                placeholderTextColor={theme.colors.textDisabled}\n              />\n            </View>\n          </View>\n\n          {/* Password Requirements */}\n          <View style={styles.passwordRequirements}>\n            <Text style={styles.requirementsTitle}>Password Requirements:</Text>\n            <View style={styles.requirementItem}>\n              <Ionicons \n                name={password.length >= 8 ? 'checkmark-circle' : 'ellipse-outline'} \n                size={16} \n                color={password.length >= 8 ? theme.colors.success : theme.colors.textDisabled} \n              />\n              <Text style={[styles.requirementText, { color: password.length >= 8 ? theme.colors.success : theme.colors.textDisabled }]}>\n                At least 8 characters\n              </Text>\n            </View>\n            <View style={styles.requirementItem}>\n              <Ionicons \n                name={password === confirmPassword && password.length > 0 ? 'checkmark-circle' : 'ellipse-outline'} \n                size={16} \n                color={password === confirmPassword && password.length > 0 ? theme.colors.success : theme.colors.textDisabled} \n              />\n              <Text style={[styles.requirementText, { color: password === confirmPassword && password.length > 0 ? theme.colors.success : theme.colors.textDisabled }]}>\n                Passwords match\n              </Text>\n            </View>\n          </View>\n          \n          <OpaqueAuthButton\n            mode=\"register\"\n            name={name}\n            email={email}\n            password={password}\n            confirmPassword={confirmPassword}\n            onSuccess={() => {\n              // Show success message instead of navigating\n              setErrorMessage(null);\n              setSuccessMessage('Account created successfully! You can now sign in with your credentials.');\n              console.log('Registration successful via OPAQUE button');\n            }}\n            onError={(error) => {\n              // Show the server error directly - validation should have been done before submission\n              console.log('RegisterScreen onError called with:', error);\n              setSuccessMessage(null);\n              setErrorMessage(error);\n            }}\n            disabled={isLoading || authLoading || !!successMessage}\n            style={styles.registerButton}\n          />\n          \n          <View style={styles.dividerContainer}>\n            <View style={styles.dividerLine} />\n            <Text style={styles.dividerText}>or</Text>\n            <View style={styles.dividerLine} />\n          </View>\n          \n          <TouchableOpacity \n            style={styles.googleButton}\n            onPress={handleGoogleRegister}\n            disabled={isLoading || authLoading}\n          >\n            <Ionicons name=\"logo-google\" size={20} color=\"#EA4335\" />\n            <Text style={styles.googleButtonText}>Continue with Google</Text>\n          </TouchableOpacity>\n        </View>\n\n        {/* Login Prompt Card */}\n        <View style={styles.loginCard}>\n          <Text style={styles.loginText}>Already have an account?</Text>\n          <TouchableOpacity onPress={navigateToLogin} style={styles.loginButton}>\n            <Text style={styles.loginButtonText}>Sign In</Text>\n            <Ionicons name=\"arrow-forward\" size={16} color={theme.colors.primary} />\n          </TouchableOpacity>\n        </View>\n      </SafeScrollView>\n    </View>\n  );\n};\n\nconst getStyles = (theme: AppTheme) => StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: theme.colors.background,\n  },\n  scrollContainer: {\n    flex: 1,\n  },\n  scrollContent: {\n    flexGrow: 1,\n    padding: theme.spacing.lg,\n    paddingTop: theme.spacing.xl,\n  },\n  headerContainer: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginBottom: theme.spacing.lg,\n  },\n  backButton: {\n    width: 40,\n    height: 40,\n    borderRadius: 20,\n    backgroundColor: theme.colors.surface,\n    alignItems: 'center',\n    justifyContent: 'center',\n    ...theme.shadows.sm,\n  },\n  welcomeCard: {\n    backgroundColor: theme.colors.card,\n    borderRadius: theme.borderRadius.xl,\n    padding: theme.spacing.xl,\n    marginBottom: theme.spacing.lg,\n    ...theme.shadows.md,\n    borderColor: theme.isDarkMode ? theme.colors.border : 'transparent',\n    borderWidth: theme.isDarkMode ? 1 : 0,\n  },\n  logoContainer: {\n    alignItems: 'center',\n  },\n  logoCircle: {\n    width: 80,\n    height: 80,\n    borderRadius: 40,\n    backgroundColor: theme.colors.primaryLight + '20',\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginBottom: theme.spacing.lg,\n  },\n  appName: {\n    fontSize: theme.typography.fontSizes.xxxl,\n    fontWeight: 'bold',\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.bold,\n    marginBottom: theme.spacing.sm,\n  },\n  tagline: {\n    fontSize: theme.typography.fontSizes.lg,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.regular,\n    textAlign: 'center',\n  },\n  formCard: {\n    backgroundColor: theme.colors.card,\n    borderRadius: theme.borderRadius.xl,\n    padding: theme.spacing.xl,\n    marginBottom: theme.spacing.lg,\n    ...theme.shadows.md,\n    borderColor: theme.isDarkMode ? theme.colors.border : 'transparent',\n    borderWidth: theme.isDarkMode ? 1 : 0,\n  },\n  formHeader: {\n    marginBottom: theme.spacing.xl,\n  },\n  formTitle: {\n    fontSize: theme.typography.fontSizes.xxl,\n    fontWeight: 'bold',\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.bold,\n    marginBottom: theme.spacing.xs,\n  },\n  formSubtitle: {\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  errorContainer: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: theme.colors.errorLight,\n    borderRadius: theme.borderRadius.md,\n    padding: theme.spacing.md,\n    marginBottom: theme.spacing.lg,\n    borderWidth: 1,\n    borderColor: theme.colors.error + '30',\n  },\n  errorText: {\n    color: theme.colors.error,\n    fontSize: theme.typography.fontSizes.sm,\n    fontFamily: theme.typography.fontFamilies.medium,\n    marginLeft: theme.spacing.sm,\n    flex: 1,\n  },\n  successContainer: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: theme.colors.successLight || theme.colors.success + '20',\n    borderRadius: theme.borderRadius.md,\n    padding: theme.spacing.md,\n    marginBottom: theme.spacing.lg,\n    borderWidth: 1,\n    borderColor: theme.colors.success + '30',\n  },\n  successText: {\n    color: theme.colors.success,\n    fontSize: theme.typography.fontSizes.sm,\n    fontFamily: theme.typography.fontFamilies.medium,\n    marginBottom: theme.spacing.sm,\n  },\n  successTextContainer: {\n    flex: 1,\n    marginLeft: theme.spacing.sm,\n  },\n  signInLinkContainer: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginTop: theme.spacing.xs,\n  },\n  signInLinkText: {\n    color: theme.colors.primary,\n    fontSize: theme.typography.fontSizes.sm,\n    fontFamily: theme.typography.fontFamilies.medium,\n    marginRight: theme.spacing.xs,\n  },\n  inputContainer: {\n    marginBottom: theme.spacing.lg,\n  },\n  inputWrapper: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: theme.colors.inputBackground,\n    borderRadius: theme.borderRadius.lg,\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n    paddingHorizontal: theme.spacing.md,\n    height: 56,\n  },\n  inputIcon: {\n    marginRight: theme.spacing.md,\n  },\n  input: {\n    flex: 1,\n    fontSize: theme.typography.fontSizes.md,\n    fontFamily: theme.typography.fontFamilies.regular,\n    color: theme.colors.text,\n  },\n  eyeIcon: {\n    padding: theme.spacing.xs,\n  },\n  passwordRequirements: {\n    backgroundColor: theme.colors.surface,\n    borderRadius: theme.borderRadius.md,\n    padding: theme.spacing.md,\n    marginBottom: theme.spacing.lg,\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n  },\n  requirementsTitle: {\n    fontSize: theme.typography.fontSizes.sm,\n    fontWeight: '600',\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n    marginBottom: theme.spacing.sm,\n  },\n  requirementItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginBottom: theme.spacing.xs,\n  },\n  requirementText: {\n    fontSize: theme.typography.fontSizes.sm,\n    fontFamily: theme.typography.fontFamilies.regular,\n    marginLeft: theme.spacing.sm,\n  },\n  registerButton: {\n    backgroundColor: theme.colors.primary,\n    borderRadius: theme.borderRadius.lg,\n    height: 56,\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginBottom: theme.spacing.lg,\n    ...theme.shadows.sm,\n  },\n  dividerContainer: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginVertical: theme.spacing.lg,\n  },\n  dividerLine: {\n    flex: 1,\n    height: 1,\n    backgroundColor: theme.colors.border,\n  },\n  dividerText: {\n    marginHorizontal: theme.spacing.md,\n    fontSize: theme.typography.fontSizes.sm,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.medium,\n  },\n  googleButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    backgroundColor: theme.colors.surface,\n    borderRadius: theme.borderRadius.lg,\n    height: 56,\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n    ...theme.shadows.sm,\n  },\n  googleButtonText: {\n    fontSize: theme.typography.fontSizes.md,\n    fontWeight: '600',\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n    marginLeft: theme.spacing.sm,\n  },\n  loginCard: {\n    backgroundColor: theme.colors.card,\n    borderRadius: theme.borderRadius.xl,\n    padding: theme.spacing.lg,\n    marginBottom: theme.spacing.lg,\n    ...theme.shadows.sm,\n    borderColor: theme.isDarkMode ? theme.colors.border : 'transparent',\n    borderWidth: theme.isDarkMode ? 1 : 0,\n  },\n  loginText: {\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.regular,\n    textAlign: 'center',\n    marginBottom: theme.spacing.md,\n  },\n  loginButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    backgroundColor: theme.colors.primaryLight + '20',\n    borderRadius: theme.borderRadius.lg,\n    paddingVertical: theme.spacing.md,\n    paddingHorizontal: theme.spacing.lg,\n  },\n  loginButtonText: {\n    fontSize: theme.typography.fontSizes.md,\n    fontWeight: '600',\n    color: theme.colors.primary,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n    marginRight: theme.spacing.xs,\n  },\n});\n\nexport default RegisterScreen; ","import React from 'react';\nimport { createStackNavigator } from '@react-navigation/stack';\n\nimport { AuthStackParamList } from './types';\nimport LoginScreen from '../screens/auth/LoginScreen';\nimport RegisterScreen from '../screens/auth/RegisterScreen';\n\nconst Stack = createStackNavigator<AuthStackParamList>();\n\nconst AuthNavigator = () => {\n  return (\n    <Stack.Navigator \n      initialRouteName=\"Register\"\n      screenOptions={{\n        headerShown: false,\n      }}\n    >\n      <Stack.Screen name=\"Login\" component={LoginScreen} />\n      <Stack.Screen name=\"Register\" component={RegisterScreen} />\n    </Stack.Navigator>\n  );\n};\n\nexport default AuthNavigator; ","import { Audio } from 'expo-av';\nimport logger from '../utils/logger';\n\ninterface AudioPrewarmState {\n  permissionsGranted: boolean;\n  audioModeConfigured: boolean;\n  isPrewarmed: boolean;\n  lastPrewarmTime: number;\n}\n\n/**\n * Simplified Audio Prewarm Service\n * Pre-configures audio permissions and settings for faster recording initialization\n */\nclass AudioPrewarmService {\n  private state: AudioPrewarmState = {\n    permissionsGranted: false,\n    audioModeConfigured: false,\n    isPrewarmed: false,\n    lastPrewarmTime: 0,\n  };\n\n  private prewarmPromise: Promise<void> | null = null;\n\n  /**\n   * Main prewarm method - can be called multiple times safely\n   */\n  async prewarmAudioSystem(): Promise<void> {\n    // If already prewarming, wait for existing operation\n    if (this.prewarmPromise) {\n      await this.prewarmPromise;\n      return;\n    }\n\n    // If recently prewarmed (within 5 minutes), skip\n    const fiveMinutes = 5 * 60 * 1000;\n    if (this.state.isPrewarmed && (Date.now() - this.state.lastPrewarmTime) < fiveMinutes) {\n      logger.debug('Audio system already prewarmed recently, skipping');\n      return;\n    }\n\n    // Start new prewarm operation\n    this.prewarmPromise = this.performPrewarm();\n    \n    try {\n      await this.prewarmPromise;\n    } finally {\n      this.prewarmPromise = null;\n    }\n  }\n\n  /**\n   * Perform the actual prewarming operations\n   */\n  private async performPrewarm(): Promise<void> {\n    logger.info('Starting audio system prewarm...');\n    const startTime = Date.now();\n\n    try {\n      // Step 1: Request and verify permissions\n      await this.prewarmPermissions();\n\n      // Step 2: Configure audio mode\n      await this.prewarmAudioMode();\n\n      this.state.isPrewarmed = true;\n      this.state.lastPrewarmTime = Date.now();\n\n      const duration = Date.now() - startTime;\n      logger.info(`Audio system prewarm completed in ${duration}ms`);\n    } catch (error) {\n      logger.error('Audio system prewarm failed:', error);\n      this.state.isPrewarmed = false;\n      throw error;\n    }\n  }\n\n  /**\n   * Pre-warm audio permissions\n   */\n  private async prewarmPermissions(): Promise<void> {\n    try {\n      logger.debug('Prewarming audio permissions...');\n      \n      // Request microphone permission\n      const audioPermission = await Audio.requestPermissionsAsync();\n      if (!audioPermission.granted) {\n        logger.warn('Microphone permission not granted during prewarm');\n        this.state.permissionsGranted = false;\n        return;\n      }\n\n      this.state.permissionsGranted = true;\n      logger.debug('Audio permissions prewarmed successfully');\n    } catch (error) {\n      logger.error('Failed to prewarm audio permissions:', error);\n      this.state.permissionsGranted = false;\n      throw error;\n    }\n  }\n\n  /**\n   * Pre-configure audio mode for optimal recording\n   */\n  private async prewarmAudioMode(): Promise<void> {\n    try {\n      logger.debug('Prewarming audio mode configuration...');\n      \n      await Audio.setAudioModeAsync({\n        allowsRecordingIOS: true,\n        playsInSilentModeIOS: true,\n        shouldDuckAndroid: true,\n        playThroughEarpieceAndroid: false,\n        staysActiveInBackground: false,\n      });\n\n      this.state.audioModeConfigured = true;\n      logger.debug('Audio mode prewarmed successfully');\n    } catch (error) {\n      logger.error('Failed to prewarm audio mode:', error);\n      this.state.audioModeConfigured = false;\n      throw error;\n    }\n  }\n\n  /**\n   * Get current prewarm state\n   */\n  getPrewarmState(): AudioPrewarmState {\n    return { ...this.state };\n  }\n\n  /**\n   * Check if audio system is ready for recording\n   */\n  isReadyForRecording(): boolean {\n    return this.state.permissionsGranted && this.state.audioModeConfigured;\n  }\n\n  /**\n   * Force refresh of prewarm state\n   */\n  async refreshPrewarm(): Promise<void> {\n    this.state.isPrewarmed = false;\n    this.state.lastPrewarmTime = 0;\n    await this.prewarmAudioSystem();\n  }\n\n  /**\n   * Get prewarm performance metrics\n   */\n  getPerformanceMetrics(): {\n    isPrewarmed: boolean;\n    lastPrewarmTime: number;\n    timeSinceLastPrewarm: number;\n    readyForRecording: boolean;\n  } {\n    const now = Date.now();\n    return {\n      isPrewarmed: this.state.isPrewarmed,\n      lastPrewarmTime: this.state.lastPrewarmTime,\n      timeSinceLastPrewarm: this.state.lastPrewarmTime > 0 ? now - this.state.lastPrewarmTime : -1,\n      readyForRecording: this.isReadyForRecording(),\n    };\n  }\n\n  /**\n   * Cleanup and reset prewarm state\n   */\n  cleanup(): void {\n    this.state = {\n      permissionsGranted: false,\n      audioModeConfigured: false,\n      isPrewarmed: false,\n      lastPrewarmTime: 0,\n    };\n    this.prewarmPromise = null;\n    logger.debug('Audio prewarm service cleaned up');\n  }\n}\n\n// Export singleton instance\nexport const audioPrewarmService = new AudioPrewarmService();\nexport default audioPrewarmService; ","// Simplified language configuration for single language speech recognition\nexport interface LanguageOption {\n  code: string;\n  name: string;\n  region?: string;\n}\n\n// Simplified list of most common languages for transcription\nexport const SUPPORTED_LANGUAGES: LanguageOption[] = [\n  // Auto-detect option\n  { code: 'auto', name: 'Auto-detect' },\n  \n  // English variants\n  { code: 'en-US', name: 'English', region: 'United States' },\n  { code: 'en-GB', name: 'English', region: 'United Kingdom' },\n  { code: 'en-AU', name: 'English', region: 'Australia' },\n  { code: 'en-CA', name: 'English', region: 'Canada' },\n  \n  // Spanish variants\n  { code: 'es-ES', name: 'Spanish', region: 'Spain' },\n  { code: 'es-MX', name: 'Spanish', region: 'Mexico' },\n  { code: 'es-US', name: 'Spanish', region: 'United States' },\n  \n  // French variants\n  { code: 'fr-FR', name: 'French', region: 'France' },\n  { code: 'fr-CA', name: 'French', region: 'Canada' },\n  \n  // German\n  { code: 'de-DE', name: 'German', region: 'Germany' },\n  \n  // Italian\n  { code: 'it-IT', name: 'Italian', region: 'Italy' },\n  \n  // Portuguese\n  { code: 'pt-BR', name: 'Portuguese', region: 'Brazil' },\n  { code: 'pt-PT', name: 'Portuguese', region: 'Portugal' },\n  \n  // Chinese\n  { code: 'zh-CN', name: 'Chinese', region: 'Simplified' },\n  { code: 'zh-TW', name: 'Chinese', region: 'Traditional' },\n  \n  // Japanese\n  { code: 'ja-JP', name: 'Japanese', region: 'Japan' },\n  \n  // Korean\n  { code: 'ko-KR', name: 'Korean', region: 'South Korea' },\n  \n  // Russian\n  { code: 'ru-RU', name: 'Russian', region: 'Russia' },\n  \n  // Arabic\n  { code: 'ar-SA', name: 'Arabic', region: 'Saudi Arabia' },\n  \n  // Hindi\n  { code: 'hi-IN', name: 'Hindi', region: 'India' },\n  \n  // Dutch\n  { code: 'nl-NL', name: 'Dutch', region: 'Netherlands' },\n  \n  // Polish\n  { code: 'pl-PL', name: 'Polish', region: 'Poland' },\n  \n  // Turkish\n  { code: 'tr-TR', name: 'Turkish', region: 'Turkey' },\n  \n  // Swedish\n  { code: 'sv-SE', name: 'Swedish', region: 'Sweden' },\n  \n  // Norwegian\n  { code: 'no-NO', name: 'Norwegian', region: 'Norway' },\n  \n  // Danish\n  { code: 'da-DK', name: 'Danish', region: 'Denmark' },\n  \n  // Finnish\n  { code: 'fi-FI', name: 'Finnish', region: 'Finland' },\n];\n\n// Get a human-readable language name from a language code\nexport function getLanguageName(languageCode: string): string | null {\n  const language = SUPPORTED_LANGUAGES.find(lang => lang.code === languageCode);\n  if (language) {\n    if (language.code === 'auto') return language.name;\n    return language.region ? `${language.name} (${language.region})` : language.name;\n  }\n  \n  // Try to match by primary language code (before the dash)\n  const langPart = languageCode.split('-')[0];\n  const match = SUPPORTED_LANGUAGES.find(lang => lang.code.startsWith(langPart + '-'));\n  return match ? (match.region ? `${match.name} (${match.region})` : match.name) : null;\n}\n\n// Get default language code\nexport function getDefaultLanguageCode(): string {\n  return 'auto'; // Default to auto-detect\n}\n\n// Validate single language code\nexport function validateLanguageCode(languageCode: string): boolean {\n  return SUPPORTED_LANGUAGES.some(lang => lang.code === languageCode);\n} ","import AsyncStorage from '@react-native-async-storage/async-storage';\nimport logger from '../utils/logger';\nimport { getDefaultLanguageCode, validateLanguageCode } from '../config/languageConfig';\n\n// Settings interface with only functional user preferences\nexport interface UserSettings {\n  // Language & Transcription (FUNCTIONAL)\n  defaultLanguage: string; // Can be 'auto' for auto-detect or specific language code\n  \n  // Privacy & Security (FUNCTIONAL)\n  defaultEntryPrivacy: 'public' | 'hidden';\n  hiddenModeEnabled: boolean;\n  \n  // App Behavior (FUNCTIONAL)\n  hapticFeedbackEnabled: boolean;\n  \n  // Notifications (FUNCTIONAL)\n  notificationsEnabled: boolean;\n  reminderNotifications: boolean;\n  dailyReminderTime: string; // HH:MM format\n  \n  // Advanced (FUNCTIONAL)\n  analyticsEnabled: boolean;\n  crashReportsEnabled: boolean;\n  \n  // Additional (FUNCTIONAL)\n  autoSaveEnabled: boolean;\n  autoRecordingEnabled: boolean;\n}\n\n// Default settings with sensible defaults\nexport const DEFAULT_SETTINGS: UserSettings = {\n  // Language & Transcription\n  defaultLanguage: getDefaultLanguageCode(), // 'auto' for auto-detect\n  \n  // Privacy & Security\n  defaultEntryPrivacy: 'public',\n  hiddenModeEnabled: false,\n  \n  // App Behavior\n  hapticFeedbackEnabled: true,\n  \n  // Notifications\n  notificationsEnabled: true,\n  reminderNotifications: false,\n  dailyReminderTime: '20:00',\n  \n  // Advanced\n  analyticsEnabled: true,\n  crashReportsEnabled: true,\n  \n  // Additional\n  autoSaveEnabled: true,\n  autoRecordingEnabled: true,\n};\n\nconst SETTINGS_STORAGE_KEY = '@kotori_user_settings';\nconst SETTINGS_VERSION = '1.0';\n\nclass SettingsService {\n  private settings: UserSettings = { ...DEFAULT_SETTINGS };\n  private initialized = false;\n  private listeners: Set<(settings: UserSettings) => void> = new Set();\n\n  /**\n   * Initialize the settings service by loading stored preferences\n   */\n  async initialize(): Promise<UserSettings> {\n    if (this.initialized) {\n      return this.settings;\n    }\n\n    try {\n      const storedSettings = await AsyncStorage.getItem(SETTINGS_STORAGE_KEY);\n      \n      if (storedSettings) {\n        const parsed = JSON.parse(storedSettings);\n        \n        // Extract just the settings object if it exists, otherwise use the whole parsed object\n        const settingsToValidate = parsed.settings || parsed;\n        \n        // Merge with defaults to handle new settings added in updates\n        this.settings = {\n          ...DEFAULT_SETTINGS,\n          ...this.validateSettings(settingsToValidate),\n        };\n        \n        logger.info('[SettingsService] Settings loaded from storage');\n      } else {\n        // First time - save defaults\n        await this.saveSettings(this.settings);\n        logger.info('[SettingsService] Initialized with default settings');\n      }\n    } catch (err) {\n      const error = err instanceof Error ? err : new Error(String(err));\n      logger.error('[SettingsService] Failed to load settings:', error);\n      this.settings = { ...DEFAULT_SETTINGS };\n    }\n\n    this.initialized = true;\n    return this.settings;\n  }\n\n  /**\n   * Get current settings (readonly)\n   */\n  getSettings(): UserSettings {\n    return { ...this.settings };\n  }\n\n  /**\n   * Get a specific setting value\n   */\n  getSetting<K extends keyof UserSettings>(key: K): UserSettings[K] {\n    return this.settings[key];\n  }\n\n  /**\n   * Update a single setting\n   */\n  async updateSetting<K extends keyof UserSettings>(\n    key: K, \n    value: UserSettings[K]\n  ): Promise<void> {\n    try {\n      // Validate the setting\n      const validatedValue = this.validateSingleSetting(key, value);\n      \n      // Update local settings\n      this.settings = {\n        ...this.settings,\n        [key]: validatedValue,\n      };\n\n      // Persist to storage\n      await this.saveSettings(this.settings);\n      \n      // Notify listeners\n      this.notifyListeners();\n      \n      logger.info(`[SettingsService] Updated setting: ${String(key)} = ${value}`);\n    } catch (err) {\n      const error = err instanceof Error ? err : new Error(String(err));\n      logger.error(`[SettingsService] Failed to update setting ${String(key)}:`, error);\n      throw error;\n    }\n  }\n\n  /**\n   * Update multiple settings at once\n   */\n  async updateSettings(updates: Partial<UserSettings>): Promise<void> {\n    try {\n      // Validate all updates\n      const validatedUpdates = this.validateSettings(updates);\n      \n      // Update local settings\n      this.settings = {\n        ...this.settings,\n        ...validatedUpdates,\n      };\n\n      // Persist to storage\n      await this.saveSettings(this.settings);\n      \n      // Notify listeners\n      this.notifyListeners();\n      \n      logger.info('[SettingsService] Bulk settings update completed');\n    } catch (err) {\n      const error = err instanceof Error ? err : new Error(String(err));\n      logger.error('[SettingsService] Failed to update settings:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Reset all settings to defaults\n   */\n  async resetToDefaults(): Promise<void> {\n    try {\n      this.settings = { ...DEFAULT_SETTINGS };\n      await this.saveSettings(this.settings);\n      this.notifyListeners();\n      logger.info('[SettingsService] Settings reset to defaults');\n    } catch (err) {\n      const error = err instanceof Error ? err : new Error(String(err));\n      logger.error('[SettingsService] Failed to reset settings:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Export settings as JSON string\n   */\n  async exportSettings(): Promise<string> {\n    const exportData = {\n      version: SETTINGS_VERSION,\n      timestamp: new Date().toISOString(),\n      settings: this.settings,\n    };\n    return JSON.stringify(exportData, null, 2);\n  }\n\n  /**\n   * Import settings from JSON string\n   */\n  async importSettings(jsonData: string): Promise<void> {\n    try {\n      const imported = JSON.parse(jsonData);\n      \n      if (!imported.settings) {\n        throw new Error('Invalid settings format - missing settings object');\n      }\n      \n      // Validate and merge with current settings\n      const validatedSettings = this.validateSettings(imported.settings);\n      await this.updateSettings(validatedSettings);\n      \n      logger.info('[SettingsService] Settings imported successfully');\n    } catch (err) {\n      const error = err instanceof Error ? err : new Error(String(err));\n      logger.error('[SettingsService] Failed to import settings:', error);\n      throw new Error('Failed to import settings: ' + error.message);\n    }\n  }\n\n  /**\n   * Subscribe to settings changes\n   */\n  subscribe(listener: (settings: UserSettings) => void): () => void {\n    this.listeners.add(listener);\n    \n    // Return unsubscribe function\n    return () => {\n      this.listeners.delete(listener);\n    };\n  }\n\n  /**\n   * Get migration recommendations for settings updates\n   */\n  getMigrationInfo(): { hasNewSettings: boolean; newSettings: string[] } {\n    const currentKeys = Object.keys(this.settings);\n    const defaultKeys = Object.keys(DEFAULT_SETTINGS);\n    const newSettings = defaultKeys.filter(key => !currentKeys.includes(key));\n    \n    return {\n      hasNewSettings: newSettings.length > 0,\n      newSettings,\n    };\n  }\n\n  // Private methods\n\n  private async saveSettings(settings: UserSettings): Promise<void> {\n    const settingsData = {\n      version: SETTINGS_VERSION,\n      timestamp: new Date().toISOString(),\n      settings,\n    };\n    \n    await AsyncStorage.setItem(SETTINGS_STORAGE_KEY, JSON.stringify(settingsData));\n  }\n\n  private validateSettings(settings: Partial<UserSettings>): Partial<UserSettings> {\n    const validated: Record<string, any> = {};\n    \n    for (const [key, value] of Object.entries(settings)) {\n      try {\n        const validatedValue = this.validateSingleSetting(\n          key as keyof UserSettings, \n          value\n        );\n        validated[key] = validatedValue;\n      } catch (err) {\n        const error = err instanceof Error ? err : new Error(String(err));\n        logger.warn(`[SettingsService] Invalid setting ${key}: ${error.message}, using default`);\n        // Use default value for invalid settings\n        const defaultValue = DEFAULT_SETTINGS[key as keyof UserSettings];\n        validated[key] = defaultValue;\n      }\n    }\n    \n    return validated as Partial<UserSettings>;\n  }\n\n  private validateSingleSetting<K extends keyof UserSettings>(\n    key: K, \n    value: unknown\n  ): UserSettings[K] {\n    switch (key) {\n      case 'defaultLanguage':\n        if (typeof value !== 'string' || (!validateLanguageCode(value) && value !== 'auto')) {\n          throw new Error(`Invalid language code: ${value}`);\n        }\n        return value as UserSettings[K];\n        \n      case 'dailyReminderTime':\n        if (typeof value !== 'string' || !/^\\d{2}:\\d{2}$/.test(value)) {\n          throw new Error(`Invalid time format: ${value}`);\n        }\n        return value as UserSettings[K];\n        \n      default:\n        // For boolean and other simple types, just ensure correct type\n        if (typeof value !== typeof DEFAULT_SETTINGS[key]) {\n          throw new Error(`Type mismatch for ${key}: expected ${typeof DEFAULT_SETTINGS[key]}, got ${typeof value}`);\n        }\n        return value as UserSettings[K];\n    }\n  }\n\n  private notifyListeners(): void {\n    this.listeners.forEach(listener => {\n      try {\n        listener(this.getSettings());\n      } catch (err) {\n        const error = err instanceof Error ? err : new Error(String(err));\n        logger.error('[SettingsService] Error in settings listener:', error);\n      }\n    });\n  }\n}\n\n// Create and export singleton instance\nexport const settingsService = new SettingsService();\n\nexport default settingsService; ","import { Platform, Vibration } from 'react-native';\nimport logger from '../utils/logger';\n\n// Import settings service to check if haptic feedback is enabled\nimport settingsService from './settingsService';\n\nexport enum HapticFeedbackType {\n  Selection = 'selection',\n  ImpactLight = 'impactLight',\n  ImpactMedium = 'impactMedium',\n  ImpactHeavy = 'impactHeavy',\n  NotificationSuccess = 'notificationSuccess',\n  NotificationWarning = 'notificationWarning',\n  NotificationError = 'notificationError',\n}\n\nclass HapticService {\n  private expoHaptics: any = null;\n  private initialized = false;\n\n  /**\n   * Initialize the haptic service by trying to load Expo Haptics\n   */\n  private async initialize() {\n    if (this.initialized) return;\n\n    try {\n      if (Platform.OS !== 'web') {\n        // Try to import Expo Haptics\n        const { Haptics } = require('expo-haptics');\n        this.expoHaptics = Haptics;\n        logger.info('[HapticService] Expo Haptics initialized successfully');\n      } else {\n        logger.info('[HapticService] Web platform - haptics not supported');\n      }\n    } catch (error) {\n      logger.warn('[HapticService] Expo Haptics not available, will use fallback vibration');\n    }\n\n    this.initialized = true;\n  }\n\n  /**\n   * Check if haptic feedback is enabled in user settings\n   */\n  private async isHapticEnabled(): Promise<boolean> {\n    try {\n      const settings = await settingsService.getSettings();\n      return settings.hapticFeedbackEnabled;\n    } catch (error) {\n      logger.warn('[HapticService] Failed to get haptic setting, defaulting to enabled');\n      return true; // Default to enabled if we can't get settings\n    }\n  }\n\n  /**\n   * Trigger haptic feedback of the specified type\n   */\n  async impact(type: HapticFeedbackType = HapticFeedbackType.ImpactMedium): Promise<void> {\n    try {\n      await this.initialize();\n\n      // Check if haptic feedback is enabled\n      const isEnabled = await this.isHapticEnabled();\n      if (!isEnabled) {\n        logger.debug('[HapticService] Haptic feedback disabled in settings');\n        return;\n      }\n\n      if (Platform.OS === 'web') {\n        // Web doesn't support haptics\n        return;\n      }\n\n      if (this.expoHaptics) {\n        // Use Expo Haptics if available\n        await this.triggerExpoHaptic(type);\n      } else {\n        // Fallback to basic vibration\n        this.triggerVibrationFallback(type);\n      }\n\n      logger.debug(`[HapticService] Haptic feedback triggered: ${type}`);\n    } catch (error) {\n      logger.error('[HapticService] Failed to trigger haptic feedback:', error);\n    }\n  }\n\n  /**\n   * Trigger haptic feedback using Expo Haptics\n   */\n  private async triggerExpoHaptic(type: HapticFeedbackType): Promise<void> {\n    if (!this.expoHaptics) return;\n\n    switch (type) {\n      case HapticFeedbackType.Selection:\n        await this.expoHaptics.selectionAsync();\n        break;\n      case HapticFeedbackType.ImpactLight:\n        await this.expoHaptics.impactAsync(this.expoHaptics.ImpactFeedbackStyle.Light);\n        break;\n      case HapticFeedbackType.ImpactMedium:\n        await this.expoHaptics.impactAsync(this.expoHaptics.ImpactFeedbackStyle.Medium);\n        break;\n      case HapticFeedbackType.ImpactHeavy:\n        await this.expoHaptics.impactAsync(this.expoHaptics.ImpactFeedbackStyle.Heavy);\n        break;\n      case HapticFeedbackType.NotificationSuccess:\n        await this.expoHaptics.notificationAsync(this.expoHaptics.NotificationFeedbackType.Success);\n        break;\n      case HapticFeedbackType.NotificationWarning:\n        await this.expoHaptics.notificationAsync(this.expoHaptics.NotificationFeedbackType.Warning);\n        break;\n      case HapticFeedbackType.NotificationError:\n        await this.expoHaptics.notificationAsync(this.expoHaptics.NotificationFeedbackType.Error);\n        break;\n      default:\n        await this.expoHaptics.impactAsync(this.expoHaptics.ImpactFeedbackStyle.Medium);\n    }\n  }\n\n  /**\n   * Fallback to basic vibration when Expo Haptics is not available\n   */\n  private triggerVibrationFallback(type: HapticFeedbackType): void {\n    let duration: number;\n\n    switch (type) {\n      case HapticFeedbackType.Selection:\n        duration = 20;\n        break;\n      case HapticFeedbackType.ImpactLight:\n        duration = 30;\n        break;\n      case HapticFeedbackType.ImpactMedium:\n        duration = 50;\n        break;\n      case HapticFeedbackType.ImpactHeavy:\n        duration = 80;\n        break;\n      case HapticFeedbackType.NotificationSuccess:\n        duration = 100;\n        break;\n      case HapticFeedbackType.NotificationWarning:\n        duration = 150;\n        break;\n      case HapticFeedbackType.NotificationError:\n        duration = 200;\n        break;\n      default:\n        duration = 50;\n    }\n\n    Vibration.vibrate(duration);\n  }\n\n  /**\n   * Convenience methods for common haptic feedback types\n   */\n  async selection(): Promise<void> {\n    return this.impact(HapticFeedbackType.Selection);\n  }\n\n  async light(): Promise<void> {\n    return this.impact(HapticFeedbackType.ImpactLight);\n  }\n\n  async medium(): Promise<void> {\n    return this.impact(HapticFeedbackType.ImpactMedium);\n  }\n\n  async heavy(): Promise<void> {\n    return this.impact(HapticFeedbackType.ImpactHeavy);\n  }\n\n  async success(): Promise<void> {\n    return this.impact(HapticFeedbackType.NotificationSuccess);\n  }\n\n  async warning(): Promise<void> {\n    return this.impact(HapticFeedbackType.NotificationWarning);\n  }\n\n  async error(): Promise<void> {\n    return this.impact(HapticFeedbackType.NotificationError);\n  }\n}\n\n// Export singleton instance\nconst hapticService = new HapticService();\nexport default hapticService; ","import React, { useRef, useEffect } from 'react';\nimport {\n  View,\n  TouchableOpacity,\n  StyleSheet,\n  Animated,\n  Platform,\n} from 'react-native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { useAppTheme } from '../contexts/ThemeContext';\nimport { AppTheme } from '../config/theme';\nimport hapticService from '../services/hapticService';\n\ninterface FloatingActionButtonProps {\n  onPress: () => void;\n  icon?: keyof typeof Ionicons.glyphMap;\n  size?: number;\n  style?: object;\n  disabled?: boolean;\n  variant?: 'primary' | 'secondary' | 'accent';\n  testID?: string;\n}\n\n// Helper to determine if native driver should be used\nconst useNativeDriver = Platform.OS !== 'web';\n\nconst FloatingActionButton: React.FC<FloatingActionButtonProps> = ({\n  onPress,\n  icon = 'mic',\n  size = 56,\n  style,\n  disabled = false,\n  variant = 'primary',\n  testID = 'floating-action-button',\n}) => {\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme, size, variant);\n  \n  const scaleAnim = useRef(new Animated.Value(1)).current;\n  const pulseAnim = useRef(new Animated.Value(1)).current;\n  const rotateAnim = useRef(new Animated.Value(0)).current;\n\n  // Pulse animation for attention\n  useEffect(() => {\n    const pulse = Animated.loop(\n      Animated.sequence([\n        Animated.timing(pulseAnim, {\n          toValue: 1.05,\n          duration: 1000,\n          useNativeDriver,\n        }),\n        Animated.timing(pulseAnim, {\n          toValue: 1,\n          duration: 1000,\n          useNativeDriver,\n        }),\n      ])\n    );\n    \n    if (!disabled) {\n      pulse.start();\n    }\n    \n    return () => pulse.stop();\n  }, [disabled, pulseAnim]);\n\n  const handlePressIn = () => {\n    if (disabled) return;\n    \n    // Haptic feedback using centralized service\n    hapticService.medium();\n\n    Animated.parallel([\n      Animated.spring(scaleAnim, {\n        toValue: 0.95,\n        useNativeDriver,\n      }),\n      Animated.timing(rotateAnim, {\n        toValue: 1,\n        duration: 150,\n        useNativeDriver,\n      }),\n    ]).start();\n  };\n\n  const handlePressOut = () => {\n    if (disabled) return;\n    \n    Animated.parallel([\n      Animated.spring(scaleAnim, {\n        toValue: 1,\n        tension: 150,\n        friction: 4,\n        useNativeDriver,\n      }),\n      Animated.timing(rotateAnim, {\n        toValue: 0,\n        duration: 150,\n        useNativeDriver,\n      }),\n    ]).start();\n  };\n\n  const handlePress = () => {\n    if (disabled) return;\n    onPress();\n  };\n\n  const rotation = rotateAnim.interpolate({\n    inputRange: [0, 1],\n    outputRange: ['0deg', '15deg'],\n  });\n\n  return (\n    <View style={[styles.container, style]}>\n      <Animated.View\n        style={[\n          styles.shadowContainer,\n          {\n            transform: [{ scale: pulseAnim }],\n          },\n        ]}\n      >\n        <Animated.View\n          style={[\n            styles.button,\n            disabled && styles.disabled,\n            {\n              transform: [\n                { scale: scaleAnim },\n                { rotate: rotation },\n              ],\n            },\n          ]}\n        >\n          <TouchableOpacity\n            style={styles.touchable}\n            onPress={handlePress}\n            onPressIn={handlePressIn}\n            onPressOut={handlePressOut}\n            disabled={disabled}\n            activeOpacity={0.8}\n            testID={testID}\n          >\n            <Ionicons\n              name={icon}\n              size={size * 0.5}\n              color={styles.icon.color}\n            />\n          </TouchableOpacity>\n        </Animated.View>\n      </Animated.View>\n    </View>\n  );\n};\n\nconst getStyles = (theme: AppTheme, size: number, variant: 'primary' | 'secondary' | 'accent') => {\n  const getVariantColors = () => {\n    switch (variant) {\n      case 'secondary':\n        return {\n          backgroundColor: theme.colors.secondary,\n          shadowColor: theme.colors.secondary,\n        };\n      case 'accent':\n        return {\n          backgroundColor: theme.colors.accent,\n          shadowColor: theme.colors.accent,\n        };\n      default:\n        return {\n          backgroundColor: theme.colors.primary,\n          shadowColor: theme.colors.primary,\n        };\n    }\n  };\n\n  const variantColors = getVariantColors();\n\n  return StyleSheet.create({\n    container: {\n      position: 'relative',\n    },\n    shadowContainer: {\n      borderRadius: size / 2,\n      ...theme.shadows.lg,\n      shadowColor: variantColors.shadowColor,\n    },\n    button: {\n      width: size,\n      height: size,\n      borderRadius: size / 2,\n      backgroundColor: variantColors.backgroundColor,\n      justifyContent: 'center',\n      alignItems: 'center',\n      overflow: 'hidden',\n    },\n    touchable: {\n      width: '100%',\n      height: '100%',\n      justifyContent: 'center',\n      alignItems: 'center',\n    },\n    disabled: {\n      backgroundColor: theme.colors.disabled,\n      opacity: 0.6,\n    },\n    icon: {\n      color: theme.colors.onPrimary,\n    },\n  });\n};\n\nexport default FloatingActionButton; ","/**\n * Client-Side Zero-Knowledge Encryption Service\n * \n * This service ensures that encryption keys are derived from user secrets\n * and never leave the user's device. The server cannot decrypt user data.\n */\n\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { Platform } from 'react-native';\nimport logger from '../utils/logger';\nimport { opaqueKeyManager } from './opaqueKeyManager';\n\ninterface EncryptionResult {\n  encryptedContent: string;  // Base64 encoded encrypted data\n  iv: string;               // Base64 encoded initialization vector\n  salt?: string;             // Optional salt (legacy). For per-user encryption we may omit.\n  wrappedKey?: string;       // Base64-wrapped per-entry key using user master key\n  wrapIv?: string;           // Base64 IV used for key wrapping\n  algorithm?: string;        // Algorithm identifier (e.g., AES-GCM)\n}\n\ninterface KeyDerivationParams {\n  userSecret: string;       // User's secret phrase or biometric-derived data\n  salt?: Uint8Array;        // Optional salt for key derivation\n  iterations?: number;      // PBKDF2 iterations\n}\n\nclass ClientEncryptionService {\n  private static readonly ALGORITHM = 'AES-GCM';\n  private static readonly KEY_LENGTH = 256;\n  private static readonly IV_LENGTH = 12; // 96 bits for GCM\n  private static readonly SALT_LENGTH = 32; // 256 bits\n  private static readonly DEFAULT_ITERATIONS = 100000;\n  private static readonly MASTER_INFO = 'UserMasterKey';\n  \n  // Secure storage keys\n  private static readonly USER_SALT_KEY = 'user_encryption_salt';\n  private static readonly KEY_DERIVATION_PARAMS_KEY = 'key_derivation_params';\n\n  /**\n   * Check if Web Crypto API is available\n   */\n  private isWebCryptoAvailable(): boolean {\n    return typeof crypto !== 'undefined' && \n           typeof crypto.subtle !== 'undefined' &&\n           typeof crypto.subtle.deriveKey === 'function';\n  }\n\n  /**\n   * Get or create a user-specific salt for key derivation\n   */\n  private async getUserSalt(): Promise<Uint8Array> {\n    try {\n      // Try to get existing salt from secure storage\n      let saltBase64: string | null = null;\n      \n      if (Platform.OS === 'web') {\n        saltBase64 = localStorage.getItem(ClientEncryptionService.USER_SALT_KEY);\n      } else {\n        // Use AsyncStorage for mobile platforms (Note: consider upgrading to expo-secure-store for production)\n        saltBase64 = await AsyncStorage.getItem(ClientEncryptionService.USER_SALT_KEY);\n      }\n\n      if (saltBase64) {\n        // Convert base64 back to Uint8Array\n        const binaryString = atob(saltBase64);\n        const salt = new Uint8Array(binaryString.length);\n        for (let i = 0; i < binaryString.length; i++) {\n          salt[i] = binaryString.charCodeAt(i);\n        }\n        return salt;\n      }\n\n      // Generate new salt if none exists\n      const newSalt = crypto.getRandomValues(new Uint8Array(ClientEncryptionService.SALT_LENGTH));\n      \n      // Convert to base64 for storage\n      const saltArray = Array.from(newSalt);\n      const saltBase64New = btoa(String.fromCharCode(...saltArray));\n\n      // Store securely\n      if (Platform.OS === 'web') {\n        localStorage.setItem(ClientEncryptionService.USER_SALT_KEY, saltBase64New);\n      } else {\n        await AsyncStorage.setItem(ClientEncryptionService.USER_SALT_KEY, saltBase64New);\n      }\n\n      logger.info('Generated new user salt for encryption');\n      return newSalt;\n    } catch (error) {\n      logger.error('Failed to get or create user salt:', error);\n      throw new Error('Failed to initialize encryption salt');\n    }\n  }\n\n  /**\n   * Derive encryption key from user secret using PBKDF2\n   */\n  private async deriveKeyFromSecret(params: KeyDerivationParams): Promise<CryptoKey> {\n    if (!this.isWebCryptoAvailable()) {\n      throw new Error('Web Crypto API not available');\n    }\n\n    const { userSecret, salt, iterations = ClientEncryptionService.DEFAULT_ITERATIONS } = params;\n    \n    try {\n      // Convert user secret to key material\n      const encoder = new TextEncoder();\n      const keyMaterial = await crypto.subtle.importKey(\n        'raw',\n        encoder.encode(userSecret),\n        'PBKDF2',\n        false,\n        ['deriveKey']\n      );\n\n      // Use provided salt or get user-specific salt\n      const derivationSalt = salt || await this.getUserSalt();\n\n      // Derive the actual encryption key\n      const key = await crypto.subtle.deriveKey(\n        {\n          name: 'PBKDF2',\n          salt: derivationSalt,\n          iterations: iterations,\n          hash: 'SHA-256'\n        },\n        keyMaterial,\n        {\n          name: ClientEncryptionService.ALGORITHM,\n          length: ClientEncryptionService.KEY_LENGTH\n        },\n        false, // Key is not extractable\n        ['encrypt', 'decrypt']\n      );\n\n      return key;\n    } catch (error) {\n      logger.error('Failed to derive encryption key:', error);\n      throw new Error('Key derivation failed');\n    }\n  }\n\n  /**\n   * Derive per-user master key from OPAQUE export key using HKDF\n   * Lives only in memory; never persisted\n   */\n  private async getUserMasterKey(): Promise<CryptoKey> {\n    if (!opaqueKeyManager.isInitialized()) {\n      throw new Error('OPAQUE key manager not initialized');\n    }\n    const exportKey = opaqueKeyManager.getExportKey();\n    // Import raw export key for HKDF\n    const ikm = await crypto.subtle.importKey('raw', exportKey, 'HKDF', false, ['deriveKey']);\n    const masterKey = await crypto.subtle.deriveKey(\n      {\n        name: 'HKDF',\n        hash: 'SHA-256',\n        // Use zero salt by default; exportKey already high entropy; info distinguishes use\n        salt: new Uint8Array(32),\n        info: new TextEncoder().encode(ClientEncryptionService.MASTER_INFO),\n      },\n      ikm,\n      {\n        name: ClientEncryptionService.ALGORITHM,\n        length: ClientEncryptionService.KEY_LENGTH,\n      },\n      false,\n      ['encrypt', 'decrypt', 'wrapKey', 'unwrapKey']\n    );\n    return masterKey;\n  }\n\n  /**\n   * Generate a new random content key for a single entry\n   */\n  private async generateEntryKey(): Promise<CryptoKey> {\n    return await crypto.subtle.generateKey(\n      { name: ClientEncryptionService.ALGORITHM, length: ClientEncryptionService.KEY_LENGTH },\n      true,\n      ['encrypt', 'decrypt']\n    );\n  }\n\n  /**\n   * Export CryptoKey to raw bytes\n   */\n  private async exportRawKey(key: CryptoKey): Promise<Uint8Array> {\n    const raw = await crypto.subtle.exportKey('raw', key);\n    return new Uint8Array(raw);\n  }\n\n  /**\n   * Wrap entry key with per-user master key\n   */\n  private async wrapEntryKey(entryKey: CryptoKey, masterKey: CryptoKey, wrapIv: Uint8Array): Promise<Uint8Array> {\n    const wrapped = await crypto.subtle.encrypt(\n      { name: ClientEncryptionService.ALGORITHM, iv: wrapIv },\n      masterKey,\n      await this.exportRawKey(entryKey)\n    );\n    return new Uint8Array(wrapped);\n  }\n\n  /**\n   * Encrypt content using per-user master key wrapping a per-entry key\n   */\n  async encryptPerUser(content: string): Promise<EncryptionResult> {\n    if (!this.isWebCryptoAvailable()) {\n      throw new Error('Encryption not available on this platform');\n    }\n\n    try {\n      // Derive per-user master key from OPAQUE export key\n      const masterKey = await this.getUserMasterKey();\n      // Generate per-entry key\n      const entryKey = await this.generateEntryKey();\n\n      // Generate random IV\n      const iv = crypto.getRandomValues(new Uint8Array(ClientEncryptionService.IV_LENGTH));\n      const wrapIv = crypto.getRandomValues(new Uint8Array(ClientEncryptionService.IV_LENGTH));\n\n      // Encrypt the content\n      const encoder = new TextEncoder();\n      const encryptedData = await crypto.subtle.encrypt(\n        {\n          name: ClientEncryptionService.ALGORITHM,\n          iv: iv\n        },\n        entryKey,\n        encoder.encode(content)\n      );\n\n      // Wrap entry key with master key\n      const wrapped = await this.wrapEntryKey(entryKey, masterKey, wrapIv);\n\n      // Convert to base64 for storage/transmission\n      const encryptedArray = new Uint8Array(encryptedData);\n      const encryptedBase64 = btoa(String.fromCharCode(...encryptedArray));\n      const ivBase64 = btoa(String.fromCharCode(...iv));\n      const wrapIvBase64 = btoa(String.fromCharCode(...wrapIv));\n      const wrappedBase64 = btoa(String.fromCharCode(...wrapped));\n\n      logger.info('Content encrypted successfully');\n      \n      return {\n        encryptedContent: encryptedBase64,\n        iv: ivBase64,\n        wrappedKey: wrappedBase64,\n        wrapIv: wrapIvBase64,\n        algorithm: ClientEncryptionService.ALGORITHM,\n      };\n    } catch (error) {\n      logger.error('Encryption failed:', error);\n      throw new Error('Failed to encrypt content');\n    }\n  }\n\n  /**\n   * Decrypt content using user-derived key\n   */\n  async decryptContent(\n    encryptedContent: string, \n    iv: string, \n    userSecret: string,\n    salt?: string\n  ): Promise<string> {\n    if (!this.isWebCryptoAvailable()) {\n      throw new Error('Decryption not available on this platform');\n    }\n\n    try {\n      // Convert base64 back to Uint8Array\n      const encryptedData = new Uint8Array(\n        atob(encryptedContent).split('').map(char => char.charCodeAt(0))\n      );\n      const ivArray = new Uint8Array(\n        atob(iv).split('').map(char => char.charCodeAt(0))\n      );\n      \n      // Use provided salt or get stored salt\n      let saltArray: Uint8Array;\n      if (salt) {\n        saltArray = new Uint8Array(\n          atob(salt).split('').map(char => char.charCodeAt(0))\n        );\n      } else {\n        saltArray = await this.getUserSalt();\n      }\n\n      // Derive the same key used for encryption\n      const key = await this.deriveKeyFromSecret({ userSecret, salt: saltArray });\n\n      // Decrypt the content\n      const decryptedData = await crypto.subtle.decrypt(\n        {\n          name: ClientEncryptionService.ALGORITHM,\n          iv: ivArray\n        },\n        key,\n        encryptedData\n      );\n\n      // Convert back to string\n      const decoder = new TextDecoder();\n      const decryptedContent = decoder.decode(decryptedData);\n\n      logger.info('Content decrypted successfully');\n      return decryptedContent;\n    } catch (error) {\n      logger.error('Decryption failed:', error);\n      throw new Error('Failed to decrypt content - invalid key or corrupted data');\n    }\n  }\n\n  /**\n   * Verify if a user secret can decrypt a given encrypted content\n   */\n  async verifyUserSecret(\n    encryptedContent: string,\n    iv: string,\n    userSecret: string,\n    salt?: string\n  ): Promise<boolean> {\n    try {\n      await this.decryptContent(encryptedContent, iv, userSecret, salt);\n      return true;\n    } catch (error) {\n      return false;\n    }\n  }\n\n  /**\n   * Clear stored encryption data (for logout/reset)\n   */\n  async clearEncryptionData(): Promise<void> {\n    try {\n      if (Platform.OS === 'web') {\n        localStorage.removeItem(ClientEncryptionService.USER_SALT_KEY);\n        localStorage.removeItem(ClientEncryptionService.KEY_DERIVATION_PARAMS_KEY);\n      } else {\n        await AsyncStorage.removeItem(ClientEncryptionService.USER_SALT_KEY);\n        await AsyncStorage.removeItem(ClientEncryptionService.KEY_DERIVATION_PARAMS_KEY);\n      }\n      logger.info('Encryption data cleared');\n    } catch (error) {\n      logger.error('Failed to clear encryption data:', error);\n    }\n  }\n\n  /**\n   * Generate a strong random secret for initial setup\n   */\n  generateRandomSecret(length: number = 32): string {\n    const charset = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*';\n    const randomBytes = crypto.getRandomValues(new Uint8Array(length));\n    \n    return Array.from(randomBytes)\n      .map(byte => charset[byte % charset.length])\n      .join('');\n  }\n\n  /**\n   * Test encryption/decryption functionality\n   */\n  async testEncryption(): Promise<boolean> {\n    try {\n      const testContent = 'This is a test message for encryption verification';\n      const testSecret = 'test-user-secret-phrase-123';\n      \n      const encrypted = await this.encryptContent(testContent, testSecret);\n      const decrypted = await this.decryptContent(\n        encrypted.encryptedContent,\n        encrypted.iv,\n        testSecret,\n        encrypted.salt\n      );\n      \n      const success = decrypted === testContent;\n      logger.info('Encryption test:', success ? 'PASSED' : 'FAILED');\n      return success;\n    } catch (error) {\n      logger.error('Encryption test failed:', error);\n      return false;\n    }\n  }\n}\n\n// Export singleton instance\nexport const clientEncryption = new ClientEncryptionService();\nexport default clientEncryption; ","/**\n * Hidden Mode Context with Zero-Knowledge Encryption\n * \n * This context manages hidden mode state and handles client-side encryption\n * using user-controlled secrets that never leave the device.\n */\n\nimport React, { createContext, useContext, useState, useCallback, useEffect } from 'react';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport clientEncryption from '../services/clientEncryption';\nimport logger from '../utils/logger';\n\ninterface HiddenModeContextValue {\n  // State\n  isHiddenMode: boolean;\n  isSetupRequired: boolean;\n  isUnlocked: boolean;\n  \n  // Actions\n  setupHiddenMode: (userSecret: string) => Promise<void>;\n  unlockHiddenMode: (userSecret: string) => Promise<boolean>;\n  lockHiddenMode: () => void;\n  clearHiddenMode: () => Promise<void>;\n  \n  // Encryption utilities\n  encryptContent: (content: string) => Promise<{ encryptedContent: string; iv: string; salt: string }>;\n  decryptContent: (encryptedContent: string, iv: string, salt?: string) => Promise<string>;\n  \n  // Session management\n  sessionTimeoutMinutes: number;\n  setSessionTimeout: (minutes: number) => void;\n  extendSession: () => void;\n  getRemainingSessionTime: () => number;\n}\n\nconst HiddenModeContext = createContext<HiddenModeContextValue | undefined>(undefined);\n\ninterface HiddenModeProviderProps {\n  children: React.ReactNode;\n}\n\nexport const HiddenModeProvider: React.FC<HiddenModeProviderProps> = ({ children }) => {\n  const [isHiddenMode, setIsHiddenMode] = useState(false);\n  const [isSetupRequired, setIsSetupRequired] = useState(true);\n  const [isUnlocked, setIsUnlocked] = useState(false);\n  const [userSecret, setUserSecret] = useState<string | null>(null);\n  const [sessionTimeoutMinutes, setSessionTimeoutMinutes] = useState(2);\n  const [sessionEndTime, setSessionEndTime] = useState<number | null>(null);\n  const [sessionTimer, setSessionTimer] = useState<NodeJS.Timeout | null>(null);\n\n  // Storage keys\n  const HIDDEN_MODE_SETUP_KEY = 'hidden_mode_setup_completed';\n  const VERIFICATION_DATA_KEY = 'hidden_mode_verification';\n  const SESSION_TIMEOUT_KEY = 'hidden_mode_session_timeout';\n\n  /**\n   * Check if hidden mode has been set up\n   */\n  const checkSetupStatus = useCallback(async () => {\n    try {\n      const setupCompleted = await AsyncStorage.getItem(HIDDEN_MODE_SETUP_KEY);\n      const verificationData = await AsyncStorage.getItem(VERIFICATION_DATA_KEY);\n      \n      setIsSetupRequired(!(setupCompleted === 'true' && verificationData));\n      \n      // Load session timeout preference\n      const storedTimeout = await AsyncStorage.getItem(SESSION_TIMEOUT_KEY);\n      if (storedTimeout) {\n        setSessionTimeoutMinutes(parseInt(storedTimeout, 10));\n      }\n    } catch (error) {\n      logger.error('Failed to check hidden mode setup status:', error);\n      setIsSetupRequired(true);\n    }\n  }, []);\n\n  /**\n   * Set up hidden mode with user secret\n   */\n  const setupHiddenMode = useCallback(async (secret: string): Promise<void> => {\n    try {\n      if (!secret || secret.length < 8) {\n        throw new Error('Secret must be at least 8 characters long');\n      }\n\n      // Test encryption with the user secret\n      const testSuccess = await clientEncryption.testEncryption();\n      if (!testSuccess) {\n        throw new Error('Encryption test failed - device may not support required security features');\n      }\n\n      // Create verification data by encrypting a known test string\n      const verificationText = 'HIDDEN_MODE_VERIFICATION_SUCCESS';\n      const verificationData = await clientEncryption.encryptContent(verificationText, secret);\n\n      // Store setup completion and verification data\n      await AsyncStorage.setItem(HIDDEN_MODE_SETUP_KEY, 'true');\n      await AsyncStorage.setItem(VERIFICATION_DATA_KEY, JSON.stringify(verificationData));\n\n      setIsSetupRequired(false);\n      setUserSecret(secret);\n      setIsUnlocked(true);\n      setIsHiddenMode(true);\n\n      // Start session timer\n      startSessionTimer();\n\n      logger.info('Hidden mode setup completed successfully');\n    } catch (error) {\n      logger.error('Hidden mode setup failed:', error);\n      throw error;\n    }\n  }, []);\n\n  /**\n   * Unlock hidden mode with user secret\n   */\n  const unlockHiddenMode = useCallback(async (secret: string): Promise<boolean> => {\n    try {\n      if (!secret) {\n        return false;\n      }\n\n      // Get verification data\n      const verificationDataJson = await AsyncStorage.getItem(VERIFICATION_DATA_KEY);\n      if (!verificationDataJson) {\n        logger.error('No verification data found - hidden mode not set up');\n        return false;\n      }\n\n      const verificationData = JSON.parse(verificationDataJson);\n      \n      // Try to decrypt verification data with provided secret\n      const decryptedText = await clientEncryption.decryptContent(\n        verificationData.encryptedContent,\n        verificationData.iv,\n        secret,\n        verificationData.salt\n      );\n\n      // Check if decryption was successful\n      if (decryptedText === 'HIDDEN_MODE_VERIFICATION_SUCCESS') {\n        setUserSecret(secret);\n        setIsUnlocked(true);\n        setIsHiddenMode(true);\n        startSessionTimer();\n        \n        logger.info('Hidden mode unlocked successfully');\n        return true;\n      } else {\n        logger.warn('Hidden mode unlock failed - incorrect secret');\n        return false;\n      }\n    } catch (error) {\n      logger.error('Hidden mode unlock error:', error);\n      return false;\n    }\n  }, []);\n\n  /**\n   * Lock hidden mode and clear sensitive data\n   */\n  const lockHiddenMode = useCallback(() => {\n    setUserSecret(null);\n    setIsUnlocked(false);\n    setIsHiddenMode(false);\n    setSessionEndTime(null);\n    \n    if (sessionTimer) {\n      clearTimeout(sessionTimer);\n      setSessionTimer(null);\n    }\n    \n    logger.info('Hidden mode locked');\n  }, [sessionTimer]);\n\n  /**\n   * Clear all hidden mode data (reset/delete)\n   */\n  const clearHiddenMode = useCallback(async (): Promise<void> => {\n    try {\n      // Clear stored data\n      await AsyncStorage.removeItem(HIDDEN_MODE_SETUP_KEY);\n      await AsyncStorage.removeItem(VERIFICATION_DATA_KEY);\n      await AsyncStorage.removeItem(SESSION_TIMEOUT_KEY);\n      \n      // Clear encryption data\n      await clientEncryption.clearEncryptionData();\n      \n      // Reset state\n      lockHiddenMode();\n      setIsSetupRequired(true);\n      \n      logger.info('Hidden mode data cleared');\n    } catch (error) {\n      logger.error('Failed to clear hidden mode data:', error);\n      throw error;\n    }\n  }, [lockHiddenMode]);\n\n  /**\n   * Start session timer\n   */\n  const startSessionTimer = useCallback(() => {\n    if (sessionTimer) {\n      clearTimeout(sessionTimer);\n    }\n\n    const endTime = Date.now() + (sessionTimeoutMinutes * 60 * 1000);\n    setSessionEndTime(endTime);\n\n    const timer = setTimeout(() => {\n      logger.info('Hidden mode session timed out');\n      lockHiddenMode();\n    }, sessionTimeoutMinutes * 60 * 1000);\n\n    setSessionTimer(timer);\n  }, [sessionTimeoutMinutes, sessionTimer, lockHiddenMode]);\n\n  /**\n   * Extend current session\n   */\n  const extendSession = useCallback(() => {\n    if (isUnlocked) {\n      startSessionTimer();\n      logger.info('Hidden mode session extended');\n    }\n  }, [isUnlocked, startSessionTimer]);\n\n  /**\n   * Get remaining session time in seconds\n   */\n  const getRemainingSessionTime = useCallback((): number => {\n    if (!sessionEndTime || !isUnlocked) {\n      return 0;\n    }\n    \n    const remaining = Math.max(0, Math.floor((sessionEndTime - Date.now()) / 1000));\n    return remaining;\n  }, [sessionEndTime, isUnlocked]);\n\n  /**\n   * Set session timeout and persist preference\n   */\n  const setSessionTimeoutWithPersistence = useCallback(async (minutes: number) => {\n    setSessionTimeoutMinutes(minutes);\n    try {\n      await AsyncStorage.setItem(SESSION_TIMEOUT_KEY, minutes.toString());\n    } catch (error) {\n      logger.error('Failed to save session timeout preference:', error);\n    }\n  }, []);\n\n  /**\n   * Encrypt content using current user secret\n   */\n  const encryptContent = useCallback(async (content: string) => {\n    if (!userSecret) {\n      throw new Error('Hidden mode not unlocked - cannot encrypt');\n    }\n    \n    return await clientEncryption.encryptContent(content, userSecret);\n  }, [userSecret]);\n\n  /**\n   * Decrypt content using current user secret\n   */\n  const decryptContent = useCallback(async (encryptedContent: string, iv: string, salt?: string) => {\n    if (!userSecret) {\n      throw new Error('Hidden mode not unlocked - cannot decrypt');\n    }\n    \n    return await clientEncryption.decryptContent(encryptedContent, iv, userSecret, salt);\n  }, [userSecret]);\n\n  // Initialize setup status on mount\n  useEffect(() => {\n    checkSetupStatus();\n  }, [checkSetupStatus]);\n\n  // Cleanup timer on unmount\n  useEffect(() => {\n    return () => {\n      if (sessionTimer) {\n        clearTimeout(sessionTimer);\n      }\n    };\n  }, [sessionTimer]);\n\n  const value: HiddenModeContextValue = {\n    // State\n    isHiddenMode,\n    isSetupRequired,\n    isUnlocked,\n    \n    // Actions\n    setupHiddenMode,\n    unlockHiddenMode,\n    lockHiddenMode,\n    clearHiddenMode,\n    \n    // Encryption utilities\n    encryptContent,\n    decryptContent,\n    \n    // Session management\n    sessionTimeoutMinutes,\n    setSessionTimeout: setSessionTimeoutWithPersistence,\n    extendSession,\n    getRemainingSessionTime,\n  };\n\n  return (\n    <HiddenModeContext.Provider value={value}>\n      {children}\n    </HiddenModeContext.Provider>\n  );\n};\n\n/**\n * Hook to use hidden mode context\n */\nexport const useHiddenMode = (): HiddenModeContextValue => {\n  const context = useContext(HiddenModeContext);\n  if (!context) {\n    throw new Error('useHiddenMode must be used within a HiddenModeProvider');\n  }\n  return context;\n};\n\nexport default HiddenModeProvider; ","import React, { useRef, useState } from 'react';\nimport { View, Text, StyleSheet, Pressable, Animated, Platform } from 'react-native';\nimport { format, parseISO } from 'date-fns';\nimport { Ionicons } from '@expo/vector-icons';\n\nimport { JournalEntry, Tag } from '../types';\nimport { useAppTheme } from '../contexts/ThemeContext';\nimport { AppTheme } from '../config/theme';\n\n// Helper to determine if native driver should be used\nconst useNativeDriver = Platform.OS !== 'web';\n\ninterface JournalCardProps {\n  entry: JournalEntry;\n  onPress?: (entry: JournalEntry) => void;\n  style?: object;\n}\n\nconst JournalCard: React.FC<JournalCardProps> = ({ entry, onPress, style }) => {\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n  const [isPressed, setIsPressed] = useState(false);\n  const scaleAnim = useRef(new Animated.Value(1)).current;\n\n  const getPreviewText = (content: string, maxLength: number = 120) => {\n    if (!content) return 'No content';\n    if (content.length <= maxLength) return content;\n    return `${content.substring(0, maxLength)}...`;\n  };\n\n  const formattedDate = format(\n    typeof entry.entry_date === 'string' ? parseISO(entry.entry_date) : entry.entry_date,\n    'MMM dd, yyyy'\n  );\n\n  const formattedTime = format(\n    typeof entry.entry_date === 'string' ? parseISO(entry.entry_date) : entry.entry_date,\n    'h:mm a'\n  );\n\n  const handlePressIn = () => {\n    setIsPressed(true);\n    Animated.spring(scaleAnim, {\n      toValue: 0.98,\n      useNativeDriver,\n      tension: 100,\n      friction: 3,\n    }).start();\n  };\n\n  const handlePressOut = () => {\n    setIsPressed(false);\n    Animated.spring(scaleAnim, {\n      toValue: 1,\n      useNativeDriver,\n      tension: 100,\n      friction: 3,\n    }).start();\n  };\n\n  const handlePress = () => {\n    if (onPress) {\n      onPress(entry);\n    }\n  };\n\n  const animatedStyle = {\n    transform: [{ scale: scaleAnim }],\n    opacity: scaleAnim.interpolate({\n      inputRange: [0.98, 1],\n      outputRange: [0.8, 1],\n    }),\n  };\n  \n  return (\n    <Animated.View style={[animatedStyle, style]}>\n      <Pressable \n        style={[\n          styles.container,\n          isPressed && styles.pressed\n        ]} \n        onPress={handlePress}\n        onPressIn={handlePressIn}\n        onPressOut={handlePressOut}\n        testID=\"journal-card\"\n      >\n        {/* Header with date and audio indicator */}\n        <View style={styles.header}>\n          <View style={styles.dateContainer}>\n            <Text style={styles.date} testID=\"journal-date\">{formattedDate}</Text>\n            <Text style={styles.time}>{formattedTime}</Text>\n          </View>\n          {entry.audio_url && (\n            <View style={styles.audioIndicator}>\n              <Ionicons name=\"musical-notes\" size={18} color={theme.colors.accent} />\n            </View>\n          )}\n        </View>\n        \n        {/* Title */}\n        {entry.title && (\n          <Text style={styles.title} testID=\"journal-title\" numberOfLines={2}>\n            {entry.title}\n          </Text>\n        )}\n        \n        {/* Content preview */}\n        <Text \n          style={styles.content} \n          numberOfLines={3}\n          testID=\"journal-content\"\n        >\n          {getPreviewText(entry.content)}\n        </Text>\n        \n        {/* Tags */}\n        {entry.tags && entry.tags.length > 0 && (\n          <View style={styles.tagsContainer} testID=\"tags-container\">\n            {entry.tags.slice(0, 3).map((tag: Tag, index: number) => (\n              <View key={`${entry.id}-tag-${tag.id || index}-${tag.name}`} style={styles.tag} testID={`tag-${tag.id ?? index}`}>\n                <Text style={styles.tagText}>{tag.name}</Text>\n              </View>\n            ))}\n            {entry.tags.length > 3 && (\n              <View key={`${entry.id}-more-tags`} style={styles.moreTagsIndicator}>\n                <Text style={styles.moreTagsText}>+{entry.tags.length - 3}</Text>\n              </View>\n            )}\n          </View>\n        )}\n\n        {/* Bottom accent line */}\n        <View style={styles.accentLine} />\n      </Pressable>\n    </Animated.View>\n  );\n};\n\nconst getStyles = (theme: AppTheme) => StyleSheet.create({\n  container: {\n    backgroundColor: theme.colors.card,\n    borderRadius: theme.borderRadius.xl,\n    padding: theme.spacing.lg,\n    marginVertical: theme.spacing.sm,\n    marginHorizontal: theme.spacing.xs,\n    ...theme.shadows.md,\n    borderColor: theme.colors.borderLight,\n    borderWidth: theme.isDarkMode ? 1 : 0,\n    overflow: 'hidden',\n  },\n  pressed: {\n    backgroundColor: theme.isDarkMode \n      ? theme.colors.gray800 \n      : theme.colors.gray100,\n  },\n  header: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'flex-start',\n    marginBottom: theme.spacing.md,\n  },\n  dateContainer: {\n    flex: 1,\n  },\n  date: {\n    fontSize: theme.typography.fontSizes.sm,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.medium,\n    marginBottom: theme.spacing.xs / 2,\n  },\n  time: {\n    fontSize: theme.typography.fontSizes.xs,\n    color: theme.colors.textDisabled,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  audioIndicator: {\n    backgroundColor: theme.colors.accentLight,\n    borderRadius: theme.borderRadius.full,\n    padding: theme.spacing.sm,\n    marginLeft: theme.spacing.md,\n  },\n  title: {\n    fontSize: theme.typography.fontSizes.xl,\n    fontWeight: '600',\n    color: theme.colors.text,\n    marginBottom: theme.spacing.md,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n    lineHeight: theme.typography.lineHeights.tight * theme.typography.fontSizes.xl,\n  },\n  content: {\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.textSecondary,\n    marginBottom: theme.spacing.lg,\n    lineHeight: theme.typography.lineHeights.normal * theme.typography.fontSizes.md,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  tagsContainer: {\n    flexDirection: 'row',\n    flexWrap: 'wrap',\n    marginBottom: theme.spacing.sm,\n  },\n  tag: {\n    backgroundColor: theme.isDarkMode ? theme.colors.gray700 : theme.colors.primaryLight + '20',\n    borderRadius: theme.borderRadius.full,\n    paddingHorizontal: theme.spacing.md,\n    paddingVertical: theme.spacing.sm,\n    marginRight: theme.spacing.sm,\n    marginBottom: theme.spacing.sm,\n    borderWidth: 1,\n    borderColor: theme.isDarkMode ? theme.colors.gray600 : theme.colors.primaryLight + '40',\n  },\n  tagText: {\n    fontSize: theme.typography.fontSizes.xs,\n    color: theme.isDarkMode ? theme.colors.text : theme.colors.primary,\n    fontFamily: theme.typography.fontFamilies.medium,\n    fontWeight: '500',\n  },\n  moreTagsIndicator: {\n    backgroundColor: theme.colors.gray300,\n    borderRadius: theme.borderRadius.full,\n    paddingHorizontal: theme.spacing.md,\n    paddingVertical: theme.spacing.sm,\n    marginRight: theme.spacing.sm,\n    marginBottom: theme.spacing.sm,\n  },\n  moreTagsText: {\n    fontSize: theme.typography.fontSizes.xs,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.medium,\n  },\n  accentLine: {\n    position: 'absolute',\n    bottom: 0,\n    left: 0,\n    right: 0,\n    height: 3,\n    backgroundColor: theme.colors.primary,\n    borderBottomLeftRadius: theme.borderRadius.xl,\n    borderBottomRightRadius: theme.borderRadius.xl,\n  },\n});\n\nexport default JournalCard; ","import React from 'react';\nimport { View, Text, StyleSheet } from 'react-native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { useAppTheme } from '../contexts/ThemeContext';\nimport { AppTheme } from '../config/theme';\n\ninterface ScreenHeaderProps {\n  title: string;\n  showSecretTagIndicator?: boolean;\n  secretTagText?: string;\n}\n\nconst ScreenHeader: React.FC<ScreenHeaderProps> = ({ \n  title, \n  showSecretTagIndicator = false, \n  secretTagText = \"Secret Tags Active\" \n}) => {\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n\n  return (\n    <View style={styles.header}>\n      <Text style={styles.title}>{title}</Text>\n      {showSecretTagIndicator && (\n        <View style={styles.secretTagIndicator}>\n          <Ionicons name=\"shield-checkmark\" size={16} color={theme.colors.primary} />\n          <Text style={styles.secretTagText}>{secretTagText}</Text>\n        </View>\n      )}\n    </View>\n  );\n};\n\nconst getStyles = (theme: AppTheme) => StyleSheet.create({\n  header: {\n    backgroundColor: theme.colors.card,\n    paddingHorizontal: theme.spacing.lg,\n    paddingVertical: theme.spacing.lg,\n    borderBottomWidth: 1,\n    borderBottomColor: theme.colors.border,\n    alignItems: 'center',\n  },\n  title: {\n    fontSize: theme.typography.fontSizes.xl,\n    fontWeight: 'bold',\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.bold,\n  },\n  secretTagIndicator: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginTop: theme.spacing.xs,\n    paddingHorizontal: theme.spacing.sm,\n    paddingVertical: theme.spacing.xs,\n    backgroundColor: theme.colors.primaryLight || theme.colors.primary + '20',\n    borderRadius: 12,\n  },\n  secretTagText: {\n    fontSize: theme.typography.fontSizes.xs,\n    color: theme.colors.primary,\n    marginLeft: theme.spacing.xs,\n    fontFamily: theme.typography.fontFamilies.medium,\n  },\n});\n\nexport default ScreenHeader; ","/**\n * Greeting Service for Dynamic Home Screen Messages\n * \n * Provides time-based and context-aware greetings that rotate to keep\n * the user experience fresh and engaging.\n */\n\nexport interface GreetingData {\n  mainGreeting: string;\n}\n\ninterface TimeBasedGreetings {\n  morning: string[];\n  afternoon: string[];\n  evening: string[];\n  nightOwl: string[];\n}\n\n\n\n// Time-based greeting templates\nconst TIME_GREETINGS: TimeBasedGreetings = {\n  morning: [\n    \"Good morning, {userName} \",\n    \"{userName}, let's start fresh \",\n    \"What are you hoping for today, {userName}? \",\n    \"{userName}, the day is yours  what's on your mind? \",\n    \"Morning clarity, {userName} \",\n    \"Ready to capture today's thoughts, {userName}? \",\n    \"Rise and shine, {userName} \",\n    \"{userName}, what dreams are you chasing today? \",\n    \"Morning energy is calling, {userName} \",\n    \"{userName}, ready to make today count? \",\n    \"New day, fresh perspective, {userName} \",\n    \"What's inspiring you this morning, {userName}? \",\n    \"{userName}, time to bloom \",\n    \"Morning motivation time, {userName} \",\n    \"Seize the morning, {userName} \",\n    \"{userName}, what story will today tell? \",\n    \"Morning energy is strong, {userName} \",\n    \"Ready for today's adventure, {userName}? \",\n  ],\n  afternoon: [\n    \"Good afternoon, {userName} \",\n    \"How's your day going, {userName}? \",\n    \"{userName}, got something to reflect on? \",\n    \"Midday pause  want to journal something, {userName}? \",\n    \"Perfect time for reflection, {userName} \",\n    \"What's been on your mind today, {userName}? \",\n    \"{userName}, time for a mental check-in \",\n    \"How are you feeling right now, {userName}? \",\n    \"{userName}, ready to process some thoughts? \",\n    \"What's working well today, {userName}? \",\n    \"{userName}, any insights to capture? \",\n    \"Taking a moment to breathe, {userName}? \",\n    \"What's your energy like today, {userName}? \",\n    \"{userName}, time to organize your thoughts? \",\n    \"Any breakthroughs to record, {userName}? \",\n    \"{userName}, how's your heart feeling? \",\n    \"Ready to dive deeper, {userName}? \",\n    \"What patterns are you noticing, {userName}? \",\n  ],\n  evening: [\n    \"Good evening, {userName} \",\n    \"Evening is perfect for reflection, {userName} \",\n    \"What stood out today, {userName}? \",\n    \"Unwind your thoughts, {userName} \",\n    \"{userName}, time to process the day \",\n    \"Evening reflections, {userName}? \",\n    \"Ready to wind down, {userName}? \",\n    \"What are you grateful for today, {userName}? \",\n    \"{userName}, time to let go of today's stress \",\n    \"Any lessons from today, {userName}? \",\n    \"How did today shape you, {userName}? \",\n    \"{userName}, ready for some evening clarity? \",\n    \"What emotions need attention, {userName}? \",\n    \"{userName}, time to celebrate today's wins? \",\n    \"Any worries to release, {userName}? \",\n    \"What's your heart telling you, {userName}? \",\n    \"Ready to make peace with today, {userName}? \",\n    \"{userName}, time for gentle self-reflection? \",\n  ],\n  nightOwl: [\n    \"Up late, {userName}? \",\n    \"Night thoughts can be powerful, {userName} \",\n    \"{userName}, let's capture what's on your mind \",\n    \"Rest easier  journal it out, {userName} \",\n    \"Late night insights, {userName} \",\n    \"Sometimes the best thoughts come at night, {userName} \",\n    \"What's keeping you up, {userName}? \",\n    \"{userName}, midnight reflections calling? \",\n    \"Ready to quiet the mind, {userName}? \",\n    \"Any deep thoughts to explore, {userName}? \",\n    \"{userName}, night time, right time for journaling? \",\n    \"What's your soul whispering, {userName}? \",\n    \"{userName}, ready to release today's thoughts? \",\n    \"Any dreams to document, {userName}? \",\n    \"{userName}, late night wisdom session? \",\n    \"What's stirring in your heart, {userName}? \",\n    \"{userName}, time to empty the mental jar? \",\n    \"Ready for some nocturnal therapy, {userName}? \",\n  ],\n};\n\n\n\n// Time periods in 24-hour format\nenum TimePeriod {\n  MORNING = 'morning',     // 5:00 - 11:59\n  AFTERNOON = 'afternoon', // 12:00 - 17:59\n  EVENING = 'evening',     // 18:00 - 22:59\n  NIGHT_OWL = 'nightOwl',  // 23:00 - 4:59\n}\n\n/**\n * Determines the current time period based on local device time\n */\nfunction getCurrentTimePeriod(): TimePeriod {\n  const now = new Date();\n  const hour = now.getHours();\n\n  if (hour >= 5 && hour < 12) {\n    return TimePeriod.MORNING;\n  } else if (hour >= 12 && hour < 18) {\n    return TimePeriod.AFTERNOON;\n  } else if (hour >= 18 && hour < 23) {\n    return TimePeriod.EVENING;\n  } else {\n    return TimePeriod.NIGHT_OWL;\n  }\n}\n\n/**\n * Generates a pseudo-random index based on date and time period\n * This ensures greetings rotate but remain consistent within the same time period of the same day\n */\nfunction getRotationIndex(arrayLength: number, timePeriod: TimePeriod): number {\n  const today = new Date();\n  const dateString = today.toDateString(); // \"Mon Oct 09 2023\"\n  const seed = dateString + timePeriod;\n  \n  // Simple hash function for consistent pseudo-randomness\n  let hash = 0;\n  for (let i = 0; i < seed.length; i++) {\n    const char = seed.charCodeAt(i);\n    hash = ((hash << 5) - hash) + char;\n    hash = hash & hash; // Convert to 32-bit integer\n  }\n  \n  return Math.abs(hash) % arrayLength;\n}\n\n\n\n/**\n * Main function to get dynamic greeting based on time\n */\nexport function getDynamicGreeting(\n  userName: string = 'there'\n): GreetingData {\n  const timePeriod = getCurrentTimePeriod();\n  const timeGreetings = TIME_GREETINGS[timePeriod];\n  \n  // Get main greeting with rotation\n  const mainIndex = getRotationIndex(timeGreetings.length, timePeriod);\n  const mainGreeting = timeGreetings[mainIndex].replace('{userName}', userName);\n  \n  return {\n    mainGreeting,\n  };\n}\n\n/**\n * Utility function to get a preview of all possible greetings for testing\n */\nexport function getAllGreetingPreviews(userName: string = 'User'): Record<string, string[]> {\n  const previews: Record<string, string[]> = {};\n  \n  Object.entries(TIME_GREETINGS).forEach(([period, greetings]) => {\n    previews[period] = greetings.map((greeting: string) => \n      greeting.replace('{userName}', userName)\n    );\n  });\n  \n  return previews;\n}\n\n/**\n * Get the current time period as a string (useful for debugging)\n */\nexport function getCurrentTimePeriodString(): string {\n  return getCurrentTimePeriod();\n} ","import React, { useEffect, useState, useMemo } from 'react';\nimport { \n  View, \n  Text, \n  StyleSheet, \n  TouchableOpacity, \n  ActivityIndicator,\n  RefreshControl,\n  Alert,\n  Platform\n} from 'react-native';\nimport { useNavigation, useFocusEffect } from '@react-navigation/native';\nimport { CompositeNavigationProp } from '@react-navigation/native';\nimport { StackNavigationProp } from '@react-navigation/stack';\nimport { BottomTabNavigationProp } from '@react-navigation/bottom-tabs';\nimport { Ionicons } from '@expo/vector-icons';\nimport { format } from 'date-fns';\n\nimport { useAuth } from '../../contexts/AuthContext';\nimport { useHiddenMode } from '../../contexts/HiddenModeContext';\nimport { api } from '../../services/api';\nimport { JournalEntry, Tag } from '../../types';\nimport JournalCard from '../../components/JournalCard';\nimport SafeScrollView from '../../components/SafeScrollView';\nimport ScreenHeader from '../../components/ScreenHeader';\nimport { MainStackParamList, MainTabParamList } from '../../navigation/types';\nimport { logger } from '../../utils/logger';\nimport { useAppTheme } from '../../contexts/ThemeContext';\nimport { AppTheme } from '../../config/theme';\nimport { getDynamicGreeting, GreetingData } from '../../services/greetingService';\n\n// --- Special Tag for Hidden Entries (Client-Side) ---\n// TODO: Move this to a shared constants file\nconst HIDDEN_ENTRY_TAG = \"_hidden_entry\";\n// ----------------------------------------------------\n\ntype HomeScreenNavigationProp = CompositeNavigationProp<\n  BottomTabNavigationProp<MainTabParamList, 'Home'>,\n  StackNavigationProp<MainStackParamList>\n>;\n\nconst HomeScreen = () => {\n  const navigation = useNavigation<HomeScreenNavigationProp>();\n  const { user } = useAuth();\n  const { theme } = useAppTheme();\n  const { isHiddenMode } = useHiddenMode();\n  const styles = getStyles(theme);\n  \n  // Extract first name for greeting\n  const getFirstName = () => {\n    if (user?.full_name) {\n      return user.full_name.split(' ')[0]; // Get first part of the name\n    }\n    return 'there'; // Fallback greeting\n  };\n  \n  const [recentEntries, setRecentEntries] = useState<JournalEntry[]>([]);\n  const [stats, setStats] = useState({\n    totalEntries: 0,\n    currentStreak: 0,\n    entriesThisWeek: 0,\n  });\n  const [loading, setLoading] = useState(true);\n  const [refreshing, setRefreshing] = useState(false);\n\n  // Get dynamic greeting based on time and user name\n  const greetingData: GreetingData = useMemo(() => {\n    return getDynamicGreeting(getFirstName());\n  }, [user?.full_name]);\n\n  // Filter entries based on hidden mode\n  const displayedEntries = useMemo(() => {\n    if (isHiddenMode) {\n      return recentEntries;\n    }\n    // Correctly check if any tag object has a name matching HIDDEN_ENTRY_TAG\n    return recentEntries.filter(entry => \n      !entry.tags.some((tag: Tag) => tag.name === HIDDEN_ENTRY_TAG)\n    );\n  }, [recentEntries, isHiddenMode]);\n\n  // Replace useEffect with useFocusEffect to fetch data whenever the screen comes into focus\n  useFocusEffect(\n    React.useCallback(() => {\n      // Fetch data when the screen gains focus\n      fetchData();\n\n      // Optional: Return a cleanup function if needed\n      // return () => console.log('HomeScreen blurred');\n    }, []) // Dependency array is empty, so it runs on every focus\n  );\n\n  // Log recentEntries IDs when they change, for debugging key prop warning\n  useEffect(() => {\n    if (recentEntries.length > 0) {\n      // Only log in debug mode and check for duplicate IDs\n      const ids = recentEntries.map(entry => entry.id);\n      const uniqueIds = [...new Set(ids)];\n      if (ids.length !== uniqueIds.length) {\n        logger.warn('HomeScreen: Duplicate entry IDs detected!', { ids, uniqueIds });\n      }\n    }\n  }, [recentEntries]);\n\n  // Log displayedEntries IDs when they change, for debugging key prop warning\n  useEffect(() => {\n    if (displayedEntries.length > 0) {\n      // Only check for duplicate IDs in displayed entries\n      const displayedIds = displayedEntries.map(entry => entry.id);\n      const uniqueDisplayedIds = [...new Set(displayedIds)];\n      if (displayedIds.length !== uniqueDisplayedIds.length) {\n        logger.warn('HomeScreen: Duplicate displayed entry IDs detected!', { displayedIds, uniqueDisplayedIds });\n      }\n    }\n  }, [displayedEntries]);\n\n  const fetchData = async () => {\n    try {\n      setLoading(true);\n      \n      // Fetch user stats from the new backend endpoint with the correct prefix\n      const statsResponse = await api.get('/api/users/me/stats');\n      setStats({\n        totalEntries: statsResponse.data.total_entries,\n        currentStreak: statsResponse.data.current_streak,\n        entriesThisWeek: statsResponse.data.entries_this_week,\n      });\n      \n      // Fetch recent entries, ensuring descending order by entry_date\n      const entriesResponse = await api.get('/api/journals/', {\n        params: { \n          limit: 1, // Only show 1 most recent entry on the home screen\n          sort: 'entry_date:desc' // Explicitly request sorting if backend supports it\n        }\n      });\n      setRecentEntries(entriesResponse.data);\n      \n    } catch (error: any) {\n      // Log the specific error\n      logger.error('HomeScreen: Error fetching home data', { \n        message: error.message, \n        status: error.response?.status,\n        data: error.response?.data\n      });\n      // In development mode, don't show error alert\n      if (!__DEV__) {\n        Alert.alert('Error', 'Failed to load your data');\n      }\n    } finally {\n      setLoading(false);\n      setRefreshing(false);\n    }\n  };\n\n  const onRefresh = () => {\n    setRefreshing(true);\n    fetchData();\n  };\n\n  const navigateToRecord = () => {\n    // Navigate to Record modal in the parent MainStack\n    navigation.navigate('Record');\n  };\n\n  const navigateToJournalList = () => {\n    navigation.navigate('Journal', { screen: 'JournalList' });\n  };\n\n  const navigateToDetail = (entryId: number) => {\n    // Navigate to JournalEntryDetail in the main stack\n    navigation.navigate('JournalEntryDetail', { entryId: entryId.toString() });\n  };\n\n  const handleVibePress = (vibeId: string, tag: string) => {\n    // Define vibe prompts based on evidence-driven recommendations\n    const vibePrompts: Record<string, string> = {\n      grateful: \"What are you thankful for?\",\n      reflect: \"What's been on your mind?\", \n      inspired: \"Capture that idea before it fades!\",\n      stressed: \"Want to unload what's weighing you down?\",\n      plan: \"What's your next step or goal?\"\n    };\n\n    // Navigate to Record modal with vibe parameters and prompt\n    const prompt = vibePrompts[vibeId];\n    navigation.navigate('Record', {\n      vibeEmoji: vibeId, // Keep the same parameter name for compatibility\n      vibeTag: tag,\n      prefilledPrompt: prompt,\n    });\n  };\n\n  if (loading && !refreshing) {\n    return (\n      <View style={styles.loadingContainer}>\n        <ActivityIndicator size=\"large\" color={theme.colors.primary} testID=\"loading-indicator\" />\n      </View>\n    );\n  }\n\n  return (\n    <View style={styles.container}>\n      <ScreenHeader title=\"Home\" />\n      \n      <SafeScrollView \n        style={styles.scrollContainer}\n        refreshControl={\n          Platform.OS !== 'web' ? (\n            <RefreshControl refreshing={refreshing} onRefresh={onRefresh} colors={[theme.colors.primary]} tintColor={theme.colors.primary} />\n          ) : undefined\n        }\n      >\n        <View style={styles.greetingContainer}>\n          <View style={styles.greetingCard}>\n            <View style={styles.greetingContent}>\n              <Text style={styles.greeting}>{greetingData.mainGreeting}</Text>\n              <Text style={styles.date}>{format(new Date(), 'EEEE, MMMM d')}</Text>\n            </View>\n          </View>\n        </View>\n\n              <View style={styles.statsContainer}>\n        <View style={styles.statCard}>\n          <Ionicons name=\"book\" size={24} color={theme.colors.primary} style={styles.statIcon} />\n          <Text style={styles.statValue}>{stats.totalEntries}</Text>\n          <Text style={styles.statLabel}>Entries</Text>\n        </View>\n        <View style={[styles.statCard, styles.streakCard]}>\n          <Ionicons name=\"flame\" size={24} color=\"#FF6B35\" style={styles.statIcon} />\n          <Text style={[styles.statValue, styles.streakValue]}>{stats.currentStreak}</Text>\n          <Text style={styles.statLabel}>Streak</Text>\n        </View>\n        <View style={styles.statCard}>\n          <Ionicons name=\"calendar\" size={24} color={theme.colors.secondary} style={styles.statIcon} />\n          <Text style={[styles.statValue, styles.weekValue]}>{stats.entriesThisWeek}</Text>\n          <Text style={styles.statLabel}>Week</Text>\n        </View>\n      </View>\n\n      {/* Current Vibe Section */}\n      <View style={styles.vibeContainer}>\n        <Text style={styles.vibeTitle}>Your Current Vibe </Text>\n        <View style={styles.vibeButtonsContainer}>\n          <TouchableOpacity \n            style={styles.vibeButton}\n            onPress={() => handleVibePress('grateful', 'gratitude')}\n            activeOpacity={0.7}\n          >\n            <Ionicons name=\"heart-outline\" size={24} color=\"#B39DFF\" style={styles.vibeIcon} />\n            <Text style={styles.vibeLabel}>Grateful</Text>\n          </TouchableOpacity>\n          \n          <TouchableOpacity \n            style={styles.vibeButton}\n            onPress={() => handleVibePress('reflect', 'reflection')}\n            activeOpacity={0.7}\n          >\n            <Ionicons name=\"book-outline\" size={24} color=\"#6E7CFF\" style={styles.vibeIcon} />\n            <Text style={styles.vibeLabel}>Reflective</Text>\n          </TouchableOpacity>\n          \n          <TouchableOpacity \n            style={styles.vibeButton}\n            onPress={() => handleVibePress('inspired', 'idea')}\n            activeOpacity={0.7}\n          >\n            <Ionicons name=\"bulb-outline\" size={24} color=\"#FFD966\" style={styles.vibeIcon} />\n            <Text style={styles.vibeLabel}>Inspired</Text>\n          </TouchableOpacity>\n          \n          <TouchableOpacity \n            style={styles.vibeButton}\n            onPress={() => handleVibePress('stressed', 'stress')}\n            activeOpacity={0.7}\n          >\n            <Ionicons name=\"rainy-outline\" size={24} color=\"#8CBFFF\" style={styles.vibeIcon} />\n            <Text style={styles.vibeLabel}>Stressed</Text>\n          </TouchableOpacity>\n          \n          <TouchableOpacity \n            style={styles.vibeButton}\n            onPress={() => handleVibePress('plan', 'plan')}\n            activeOpacity={0.7}\n          >\n            <Ionicons name=\"radio-button-on-outline\" size={24} color=\"#51C1C1\" style={styles.vibeIcon} />\n            <Text style={styles.vibeLabel}>Planning</Text>\n          </TouchableOpacity>\n        </View>\n      </View>\n\n      <View style={styles.sectionHeader}>\n        <Text style={styles.sectionTitle}>Last Entry</Text>\n        <TouchableOpacity onPress={navigateToJournalList}>\n          <Text style={styles.seeAllText}>See All</Text>\n        </TouchableOpacity>\n      </View>\n\n      {displayedEntries.length > 0 ? (\n        <JournalCard \n          key={`home-entry-${displayedEntries[0].id}`} \n          entry={displayedEntries[0]} \n          onPress={() => navigateToDetail(displayedEntries[0].id)}\n        />\n      ) : (\n        <View style={styles.emptyContainer}>\n          <Ionicons name=\"book-outline\" size={theme.spacing.xxl} color={theme.colors.disabled} />\n          <Text style={styles.emptyText}>No journal entries yet</Text>\n          <TouchableOpacity \n            style={styles.startButton}\n            onPress={navigateToRecord}\n          >\n            <Text style={styles.startButtonText}>Start Journaling</Text>\n          </TouchableOpacity>\n        </View>\n      )}\n      </SafeScrollView>\n    </View>\n  );\n};\n\n// Function to generate styles based on the theme\nconst getStyles = (theme: AppTheme) => StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: theme.colors.background,\n  },\n  scrollContainer: {\n    flex: 1,\n  },\n  loadingContainer: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n    backgroundColor: theme.colors.background,\n  },\n  greetingContainer: {\n    paddingHorizontal: theme.spacing.lg,\n    paddingTop: theme.spacing.md,\n    paddingBottom: theme.spacing.lg,\n  },\n  greetingCard: {\n    backgroundColor: theme.colors.card,\n    borderRadius: theme.borderRadius.xl,\n    padding: theme.spacing.lg,\n    elevation: theme.isDarkMode ? 1 : 2,\n    shadowColor: theme.colors.shadow,\n    shadowOffset: { width: 0, height: theme.isDarkMode ? 1 : 2 },\n    shadowOpacity: theme.isDarkMode ? 0.15 : 0.08,\n    shadowRadius: theme.isDarkMode ? 2 : 4,\n    borderColor: theme.isDarkMode ? theme.colors.border : 'transparent',\n    borderWidth: theme.isDarkMode ? 1 : 0,\n  },\n  greetingContent: {\n    alignItems: 'flex-start',\n  },\n  greeting: {\n    fontSize: theme.typography.fontSizes.xl,\n    fontWeight: '600',\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n    lineHeight: theme.typography.lineHeights.tight * theme.typography.fontSizes.xl,\n  },\n\n  date: {\n    fontSize: theme.typography.fontSizes.lg,\n    color: theme.colors.textSecondary,\n    marginTop: theme.spacing.sm,\n    fontFamily: theme.typography.fontFamilies.regular,\n    lineHeight: theme.typography.lineHeights.normal * theme.typography.fontSizes.lg,\n  },\n  statsContainer: {\n    flexDirection: 'row',\n    justifyContent: 'center',\n    alignItems: 'center',\n    paddingHorizontal: theme.spacing.lg,\n    paddingVertical: theme.spacing.lg,\n    gap: theme.spacing.md,\n  },\n  statCard: {\n    backgroundColor: theme.colors.card,\n    borderRadius: 12,\n    padding: theme.spacing.lg,\n    alignItems: 'center',\n    width: '30%',\n    elevation: theme.isDarkMode ? 2 : 3,\n    shadowColor: theme.colors.black,\n    shadowOffset: { width: 0, height: theme.isDarkMode ? 2 : 3 },\n    shadowOpacity: theme.isDarkMode ? 0.2 : 0.08,\n    shadowRadius: theme.isDarkMode ? 3 : 4,\n    borderColor: theme.isDarkMode ? theme.colors.border : 'transparent',\n    borderWidth: theme.isDarkMode ? 1 : 0,\n  },\n  streakCard: {\n    backgroundColor: theme.isDarkMode ? theme.colors.card : '#FFF8F5',\n    borderColor: theme.isDarkMode ? theme.colors.border : '#FFE5D9',\n    borderWidth: 1,\n  },\n  statIcon: {\n    marginBottom: theme.spacing.sm,\n  },\n  statValue: {\n    fontSize: theme.typography.fontSizes.xxl,\n    fontWeight: 'bold',\n    color: theme.colors.primary,\n    fontFamily: theme.typography.fontFamilies.bold,\n    marginBottom: theme.spacing.xs,\n  },\n  streakValue: {\n    color: '#FF6B35',\n  },\n  weekValue: {\n    color: theme.colors.secondary,\n  },\n  statLabel: {\n    fontSize: theme.typography.fontSizes.xs,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.medium,\n    textAlign: 'center',\n    height: 16, // Fixed height for consistent alignment\n    lineHeight: 16,\n  },\n  sectionHeader: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    paddingHorizontal: theme.spacing.lg,\n    paddingTop: theme.spacing.lg,\n    paddingBottom: theme.spacing.sm,\n  },\n  sectionTitle: {\n    fontSize: theme.typography.fontSizes.xl,\n    fontWeight: 'bold',\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.bold,\n  },\n  seeAllText: {\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.primary,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n  emptyContainer: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n    padding: theme.spacing.lg,\n    marginTop: theme.spacing.xxl,\n  },\n  emptyText: {\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.textSecondary,\n    marginTop: theme.spacing.md,\n    marginBottom: theme.spacing.lg,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  startButton: {\n    backgroundColor: theme.colors.primary,\n    paddingVertical: theme.spacing.md,\n    paddingHorizontal: theme.spacing.xl,\n    borderRadius: 25,\n    marginTop: theme.spacing.md,\n  },\n  startButtonText: {\n    color: theme.isDarkMode ? theme.colors.background : theme.colors.white,\n    fontSize: theme.typography.fontSizes.md,\n    fontWeight: 'bold',\n    fontFamily: theme.typography.fontFamilies.bold,\n  },\n  // Vibe section styles\n  vibeContainer: {\n    paddingHorizontal: theme.spacing.lg,\n    paddingVertical: theme.spacing.lg,\n  },\n  vibeTitle: {\n    fontSize: theme.typography.fontSizes.xl,\n    fontWeight: 'bold',\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.bold,\n    marginBottom: theme.spacing.md,\n    textAlign: 'center',\n  },\n  vibeButtonsContainer: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n  },\n  vibeButton: {\n    backgroundColor: theme.colors.card,\n    borderRadius: 12,\n    padding: theme.spacing.md,\n    alignItems: 'center',\n    justifyContent: 'center',\n    width: '18%',\n    elevation: theme.isDarkMode ? 1 : 2,\n    shadowColor: theme.colors.shadow,\n    shadowOffset: { width: 0, height: theme.isDarkMode ? 1 : 2 },\n    shadowOpacity: theme.isDarkMode ? 0.15 : 0.08,\n    shadowRadius: theme.isDarkMode ? 2 : 3,\n    borderColor: theme.isDarkMode ? theme.colors.border : 'transparent',\n    borderWidth: theme.isDarkMode ? 1 : 0,\n  },\n  vibeIcon: {\n    marginBottom: theme.spacing.xs,\n  },\n  vibeLabel: {\n    fontSize: theme.typography.fontSizes.xs,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.medium,\n    textAlign: 'center',\n  },\n  \n});\n\nexport default HomeScreen; ","import React, { useEffect, useRef } from 'react';\nimport { View, StyleSheet, Animated, Dimensions } from 'react-native';\nimport { useAppTheme } from '../contexts/ThemeContext';\nimport { AppTheme } from '../config/theme';\n\ninterface SkeletonLoaderProps {\n  width?: number | string;\n  height?: number;\n  borderRadius?: number;\n  style?: any;\n  animated?: boolean;\n}\n\nconst SkeletonLoader: React.FC<SkeletonLoaderProps> = ({\n  width = '100%',\n  height = 20,\n  borderRadius = 4,\n  style,\n  animated = true,\n}) => {\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n  const animatedValue = useRef(new Animated.Value(0)).current;\n\n  useEffect(() => {\n    if (animated) {\n      const animation = Animated.loop(\n        Animated.sequence([\n          Animated.timing(animatedValue, {\n            toValue: 1,\n            duration: 1000,\n            useNativeDriver: false,\n          }),\n          Animated.timing(animatedValue, {\n            toValue: 0,\n            duration: 1000,\n            useNativeDriver: false,\n          }),\n        ])\n      );\n      animation.start();\n      return () => animation.stop();\n    }\n  }, [animated, animatedValue]);\n\n  const backgroundColor = animated\n    ? animatedValue.interpolate({\n        inputRange: [0, 1],\n        outputRange: [\n          theme.colors.skeleton || theme.colors.gray200,\n          theme.colors.skeletonHighlight || theme.colors.gray300,\n        ],\n      })\n    : theme.colors.skeleton || theme.colors.gray200;\n\n  return (\n    <Animated.View\n      style={[\n        styles.skeleton,\n        {\n          width,\n          height,\n          borderRadius,\n          backgroundColor,\n        },\n        style,\n      ]}\n    />\n  );\n};\n\n// Predefined skeleton components for common use cases\nexport const JournalCardSkeleton: React.FC = () => {\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n\n  return (\n    <View style={styles.journalCardSkeleton}>\n      <View style={styles.journalCardHeader}>\n        <SkeletonLoader width=\"60%\" height={18} />\n        <SkeletonLoader width={80} height={14} />\n      </View>\n      <SkeletonLoader width=\"100%\" height={16} style={{ marginTop: theme.spacing.sm }} />\n      <SkeletonLoader width=\"85%\" height={16} style={{ marginTop: theme.spacing.xs }} />\n      <SkeletonLoader width=\"70%\" height={16} style={{ marginTop: theme.spacing.xs }} />\n      <View style={styles.journalCardFooter}>\n        <SkeletonLoader width={60} height={12} />\n        <SkeletonLoader width={40} height={12} />\n      </View>\n    </View>\n  );\n};\n\nexport const CalendarSkeleton: React.FC = () => {\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n\n  return (\n    <View style={styles.calendarSkeleton}>\n      {/* Calendar header */}\n      <View style={styles.calendarHeader}>\n        <SkeletonLoader width={30} height={30} borderRadius={15} />\n        <SkeletonLoader width={120} height={20} />\n        <SkeletonLoader width={30} height={30} borderRadius={15} />\n      </View>\n      \n      {/* Calendar grid */}\n      <View style={styles.calendarGrid}>\n        {Array.from({ length: 35 }, (_, index) => (\n          <SkeletonLoader\n            key={index}\n            width={35}\n            height={35}\n            borderRadius={4}\n            style={{ margin: 2 }}\n          />\n        ))}\n      </View>\n    </View>\n  );\n};\n\nexport const SettingsSkeleton: React.FC = () => {\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n\n  return (\n    <View style={styles.settingsSkeleton}>\n      {Array.from({ length: 6 }, (_, index) => (\n        <View key={index} style={styles.settingsRow}>\n          <View style={styles.settingsRowLeft}>\n            <SkeletonLoader width={24} height={24} borderRadius={12} />\n            <View style={styles.settingsRowText}>\n              <SkeletonLoader width=\"70%\" height={16} />\n              <SkeletonLoader width=\"50%\" height={12} style={{ marginTop: theme.spacing.xs }} />\n            </View>\n          </View>\n          <SkeletonLoader width={50} height={20} borderRadius={10} />\n        </View>\n      ))}\n    </View>\n  );\n};\n\nconst getStyles = (theme: AppTheme) => {\n  const { width } = Dimensions.get('window');\n  \n  return StyleSheet.create({\n    skeleton: {\n      overflow: 'hidden',\n    },\n    journalCardSkeleton: {\n      backgroundColor: theme.colors.card,\n      padding: theme.spacing.md,\n      marginHorizontal: theme.spacing.md,\n      marginVertical: theme.spacing.sm,\n      borderRadius: theme.spacing.sm,\n      borderWidth: 1,\n      borderColor: theme.colors.border,\n    },\n    journalCardHeader: {\n      flexDirection: 'row',\n      justifyContent: 'space-between',\n      alignItems: 'center',\n      marginBottom: theme.spacing.sm,\n    },\n    journalCardFooter: {\n      flexDirection: 'row',\n      justifyContent: 'space-between',\n      alignItems: 'center',\n      marginTop: theme.spacing.md,\n    },\n    calendarSkeleton: {\n      backgroundColor: theme.colors.card,\n      padding: theme.spacing.md,\n      margin: theme.spacing.md,\n      borderRadius: theme.spacing.sm,\n    },\n    calendarHeader: {\n      flexDirection: 'row',\n      justifyContent: 'space-between',\n      alignItems: 'center',\n      marginBottom: theme.spacing.md,\n    },\n    calendarGrid: {\n      flexDirection: 'row',\n      flexWrap: 'wrap',\n      justifyContent: 'space-around',\n    },\n    settingsSkeleton: {\n      padding: theme.spacing.md,\n    },\n    settingsRow: {\n      flexDirection: 'row',\n      justifyContent: 'space-between',\n      alignItems: 'center',\n      paddingVertical: theme.spacing.md,\n      borderBottomWidth: 1,\n      borderBottomColor: theme.colors.border,\n    },\n    settingsRowLeft: {\n      flexDirection: 'row',\n      alignItems: 'center',\n      flex: 1,\n    },\n    settingsRowText: {\n      marginLeft: theme.spacing.md,\n      flex: 1,\n    },\n  });\n};\n\nexport default SkeletonLoader; ","import React, { useState, useEffect, useCallback, useMemo, useRef } from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  TouchableOpacity,\n  RefreshControl,\n  TextInput,\n  Alert,\n  ScrollView,\n  Platform,\n  FlatList,\n} from 'react-native';\nimport { useNavigation, useFocusEffect } from '@react-navigation/native';\nimport { CompositeNavigationProp } from '@react-navigation/native';\nimport { StackNavigationProp } from '@react-navigation/stack';\nimport { BottomTabNavigationProp } from '@react-navigation/bottom-tabs';\nimport { Ionicons } from '@expo/vector-icons';\nimport { format } from 'date-fns';\n\nimport { JournalAPI, TagsAPI } from '../../services/api';\nimport JournalCard from '../../components/JournalCard';\nimport { JournalCardSkeleton } from '../../components/SkeletonLoader';\nimport SafeScrollView from '../../components/SafeScrollView';\nimport ScreenHeader from '../../components/ScreenHeader';\n\nimport { JournalEntry, Tag } from '../../types';\nimport { MainStackParamList, MainTabParamList, JournalStackParamList } from '../../navigation/types';\nimport { useAppTheme } from '../../contexts/ThemeContext';\nimport { useHiddenMode } from '../../contexts/HiddenModeContext';\nimport { AppTheme } from '../../config/theme';\n\n// --- Special Tag for Hidden Entries (Client-Side) ---\n// TODO: Move this to a shared constants file\nconst HIDDEN_ENTRY_TAG = \"_hidden_entry\";\n// ----------------------------------------------------\n\n// Define navigation prop types for tab navigation with access to main stack\ntype JournalScreenNavigationProp = CompositeNavigationProp<\n  BottomTabNavigationProp<MainTabParamList, 'Journal'>,\n  StackNavigationProp<MainStackParamList>\n>;\n\nconst JournalScreen = () => {\n  const navigation = useNavigation<JournalScreenNavigationProp>();\n  const { theme } = useAppTheme();\n  const { isHiddenMode } = useHiddenMode();\n  const styles = getStyles(theme);\n  \n  // State\n  const [entries, setEntries] = useState<JournalEntry[]>([]);\n  const [filteredEntries, setFilteredEntries] = useState<JournalEntry[]>([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [isRefreshing, setIsRefreshing] = useState(false);\n  const [searchQuery, setSearchQuery] = useState('');\n  const [availableTags, setAvailableTags] = useState<string[]>([]);\n  const [selectedTags, setSelectedTags] = useState<string[]>([]);\n  \n  // Scroll position persistence\n  const scrollViewRef = useRef<ScrollView>(null);\n  const scrollPosition = useRef({ offset: 0 });\n  const shouldRestoreScroll = useRef(false);\n  \n  // Save scroll position when leaving screen\n  const saveScrollPosition = useCallback(() => {\n    if (scrollViewRef.current) {\n      // Save current scroll offset for restoration\n      shouldRestoreScroll.current = true;\n    }\n  }, []);\n\n  // Fetch journal entries from API\n  const fetchEntries = async () => {\n    try {\n      setIsLoading(true);\n      \n      const response = await JournalAPI.getEntries({});\n      setEntries(response.data);\n    } catch (error) {\n      console.error('Error fetching journal entries', error);\n      Alert.alert('Error', 'Failed to load journal entries');\n    } finally {\n      setIsLoading(false);\n      setIsRefreshing(false);\n    }\n  };\n  \n  // Fetch available tags from API\n  const fetchTags = async () => {\n    try {\n      const response = await TagsAPI.getTags();\n      setAvailableTags(response.data.map((tag: Tag) => tag.name));\n    } catch (error) {\n      console.error('Error fetching tags', error);\n    }\n  };\n\n  // Restore scroll position after data loads\n  const restoreScrollPosition = useCallback(() => {\n    if (shouldRestoreScroll.current && scrollViewRef.current && filteredEntries.length > 0) {\n      const timer = setTimeout(() => {\n        try {\n          if (scrollPosition.current.offset > 0) {\n            scrollViewRef.current?.scrollTo({\n              y: scrollPosition.current.offset,\n              animated: false,\n            });\n          }\n          shouldRestoreScroll.current = false;\n        } catch (error) {\n          console.log('Failed to restore scroll position:', error);\n          shouldRestoreScroll.current = false;\n        }\n      }, 100); // Small delay to ensure content is rendered\n\n      return () => clearTimeout(timer);\n    }\n  }, [filteredEntries]);\n\n  // Fetch journal entries when screen is focused\n  useFocusEffect(\n    useCallback(() => {\n      // Test with a small delay\n      const timer = setTimeout(() => {\n        fetchEntries();\n        fetchTags();\n      }, 500); // 500ms delay\n\n      return () => {\n        clearTimeout(timer);\n        saveScrollPosition();\n      };\n    }, []) // Use empty dependency array to avoid circular dependency\n  );\n  \n  // Filter entries whenever search query, selected tags, base entries, or hidden mode changes\n  useEffect(() => {\n    filterEntries();\n  }, [searchQuery, selectedTags, entries, isHiddenMode]);\n\n  // Restore scroll position after filtered entries change\n  useEffect(() => {\n    restoreScrollPosition();\n  }, [restoreScrollPosition]);\n  \n  // Handle refresh\n  const onRefresh = () => {\n    setIsRefreshing(true);\n    fetchEntries();\n  };\n  \n  // Filter entries based on search query and selected tags\n  const filterEntries = () => {\n    let processedEntries = [...entries];\n    \n    // Filter by search query\n    if (searchQuery.trim()) {\n      const query = searchQuery.toLowerCase();\n      processedEntries = processedEntries.filter(entry => \n        entry.title.toLowerCase().includes(query) || \n        entry.content.toLowerCase().includes(query)\n      );\n    }\n    \n    // Filter by selected tags\n    if (selectedTags.length > 0) {\n      processedEntries = processedEntries.filter(entry => \n        selectedTags.every(selectedTagName => \n          entry.tags.some(tagObject => tagObject.name === selectedTagName)\n        )\n      );\n    }\n\n    // Filter by hidden mode status\n    if (!isHiddenMode) {\n      processedEntries = processedEntries.filter(entry => \n        !entry.tags.some(tagObject => tagObject.name === HIDDEN_ENTRY_TAG)\n      );\n    }\n    // If isHiddenMode is true, all entries (that match search/tags) are shown\n    \n    setFilteredEntries(processedEntries);\n  };\n  \n  // Toggle tag selection\n  const toggleTag = (tag: string) => {\n    if (selectedTags.includes(tag)) {\n      setSelectedTags(selectedTags.filter(t => t !== tag));\n    } else {\n      setSelectedTags([...selectedTags, tag]);\n    }\n  };\n  \n  // Navigate to entry creation screen\n  const handleCreateEntry = () => {\n    // Navigate to Record modal in the parent MainStack\n    navigation.navigate('Record');\n  };\n  \n  // Navigate to entry detail screen\n  const handleEntryPress = (entry: JournalEntry) => {\n    console.log('Entry pressed:', entry.id);\n    navigation.navigate('JournalEntryDetail', { entryId: entry.id.toString() });\n  };\n  \n  // Group entries by month for SectionList\n  const getSectionData = () => {\n    const grouped: { [key: string]: JournalEntry[] } = {};\n    \n    filteredEntries.forEach(entry => {\n      const date = new Date(entry.entry_date);\n      const monthYear = format(date, 'MMMM yyyy');\n      \n      if (!grouped[monthYear]) {\n        grouped[monthYear] = [];\n      }\n      \n      grouped[monthYear].push(entry);\n    });\n    \n    const sections = Object.entries(grouped).map(([month, entries]) => ({\n      title: month,\n      data: entries,\n    }));\n    \n    return sections;\n  };\n  \n  // Scroll to top functionality\n  const [showScrollToTop, setShowScrollToTop] = useState(false);\n\n  // Handle scroll events to save position and show/hide scroll-to-top button\n  const handleScroll = useCallback((event: any) => {\n    const { contentOffset } = event.nativeEvent;\n    scrollPosition.current.offset = contentOffset.y;\n    \n    // Show scroll-to-top button when scrolled down more than 200px\n    setShowScrollToTop(contentOffset.y > 200);\n  }, []);\n\n  // Scroll to top function\n  const scrollToTop = useCallback(() => {\n    if (scrollViewRef.current) {\n      scrollViewRef.current.scrollTo({\n        y: 0,\n        animated: true,\n      });\n    }\n  }, []);\n  \n  return (\n    <View style={styles.container}>\n      <ScreenHeader title=\"Journal\" />\n      \n      <View style={styles.searchContainer}>\n        <View style={styles.searchBar}>\n          <Ionicons name=\"search\" size={theme.typography.fontSizes.xl} color={theme.colors.textSecondary} style={styles.searchIcon} />\n          <TextInput\n            style={styles.searchInput}\n            placeholder=\"Search entries...\"\n            value={searchQuery}\n            onChangeText={setSearchQuery}\n            placeholderTextColor={theme.colors.textSecondary}\n          />\n          {searchQuery ? (\n            <TouchableOpacity onPress={() => setSearchQuery('')}>\n              <Ionicons name=\"close-circle\" size={theme.typography.fontSizes.xl} color={theme.colors.textSecondary} />\n            </TouchableOpacity>\n          ) : null}\n        </View>\n      </View>\n      \n      {availableTags.length > 0 && (\n        <View style={styles.tagsContainer}>\n          <ScrollView horizontal showsHorizontalScrollIndicator={false}>\n            {availableTags.map(tag => (\n              <TouchableOpacity\n                key={tag}\n                style={[\n                  styles.tagChip,\n                  selectedTags.includes(tag) && styles.tagChipSelected\n                ]}\n                onPress={() => toggleTag(tag)}\n              >\n                <Text \n                  style={[\n                    styles.tagText,\n                    selectedTags.includes(tag) && styles.tagTextSelected\n                  ]}\n                >\n                  #{tag}\n                </Text>\n              </TouchableOpacity>\n            ))}\n          </ScrollView>\n        </View>\n      )}\n      \n      <SafeScrollView \n        style={{ flex: 1 }} \n        contentContainerStyle={{ flexGrow: 1 }}\n        refreshControl={\n          <RefreshControl\n            refreshing={isRefreshing}\n            onRefresh={onRefresh}\n            colors={[theme.colors.primary]}\n            tintColor={theme.colors.primary}\n          />\n        }\n        onScroll={handleScroll}\n        scrollEventThrottle={16}\n      >\n        {isLoading ? (\n          <View style={styles.skeletonContainer}>\n            {Array.from({ length: 5 }, (_, index) => (\n              <JournalCardSkeleton key={`skeleton-${index}`} />\n            ))}\n          </View>\n        ) : (\n          <>\n            {filteredEntries.length === 0 ? (\n              <View style={styles.emptyContainer}>\n                <Ionicons name=\"journal-outline\" size={theme.spacing.xxl * 1.5} color={theme.colors.disabled} />\n                <Text style={styles.emptyText}>No journal entries found</Text>\n                <Text style={styles.emptySubtext}>\n                  {searchQuery || selectedTags.length > 0 || !isHiddenMode && entries.some(e => e.tags.some(t=>t.name === HIDDEN_ENTRY_TAG)) \n                    ? 'Try changing your search or filters, or check hidden mode.'\n                    : 'Tap the + button to create your first entry'}\n                </Text>\n              </View>\n            ) : (\n              <>\n                {getSectionData().map((section, sectionIndex) => (\n                  <View key={section.title} style={styles.monthSection}>\n                    <Text style={styles.monthTitle}>{section.title}</Text>\n                    {section.data.map((entry, entryIndex) => (\n                      <JournalCard \n                        key={`journal-entry-${entry.id}-${entryIndex}`}\n                        entry={entry}\n                        onPress={() => handleEntryPress(entry)}\n                      />\n                    ))}\n                  </View>\n                ))}\n              </>\n            )}\n          </>\n        )}\n      </SafeScrollView>\n      \n      {/* Scroll to Top Button */}\n      {showScrollToTop && (\n        <TouchableOpacity\n          style={styles.scrollToTopButton}\n          onPress={scrollToTop}\n          activeOpacity={0.8}\n        >\n          <Ionicons \n            name=\"chevron-up\" \n            size={24} \n            color={theme.colors.white} \n          />\n        </TouchableOpacity>\n      )}\n    </View>\n  );\n};\n\n// Function to generate styles based on the theme\nconst getStyles = (theme: AppTheme) => StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: theme.colors.background,\n  },\n\n  searchContainer: {\n    paddingHorizontal: theme.spacing.md,\n    paddingVertical: theme.spacing.sm,\n    backgroundColor: theme.colors.card,\n    borderBottomWidth: 1,\n    borderBottomColor: theme.colors.border,\n  },\n  searchBar: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: theme.colors.inputBackground,\n    borderRadius: theme.spacing.sm,\n    paddingHorizontal: theme.spacing.sm,\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n  },\n  searchIcon: {\n    marginRight: theme.spacing.sm,\n  },\n  searchInput: {\n    flex: 1,\n    paddingVertical: theme.spacing.sm,\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  tagsContainer: {\n    paddingVertical: theme.spacing.sm,\n    paddingHorizontal: theme.spacing.xs,\n    backgroundColor: theme.colors.card,\n    borderBottomWidth: 1,\n    borderBottomColor: theme.colors.border,\n  },\n  tagChip: {\n    paddingVertical: theme.spacing.xs,\n    paddingHorizontal: theme.spacing.md,\n    borderRadius: theme.spacing.lg,\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n    backgroundColor: theme.isDarkMode ? theme.colors.gray700 : theme.colors.gray100,\n    marginRight: theme.spacing.sm,\n  },\n  tagChipSelected: {\n    backgroundColor: theme.colors.primary,\n    borderColor: theme.colors.primary,\n  },\n  tagText: {\n    fontSize: theme.typography.fontSizes.sm,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  tagTextSelected: {\n    color: theme.colors.onPrimary,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n  loaderContainer: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n    backgroundColor: theme.colors.background,\n  },\n  skeletonContainer: {\n    flex: 1,\n    backgroundColor: theme.colors.background,\n    paddingTop: theme.spacing.sm,\n  },\n  emptyContainer: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n    padding: theme.spacing.lg,\n  },\n  emptyText: {\n    fontSize: theme.typography.fontSizes.lg,\n    color: theme.colors.textSecondary,\n    marginTop: theme.spacing.md,\n    textAlign: 'center',\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n  emptySubtext: {\n    fontSize: theme.typography.fontSizes.sm,\n    color: theme.colors.textSecondary,\n    marginTop: theme.spacing.sm,\n    textAlign: 'center',\n    paddingHorizontal: theme.spacing.xl,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  listContent: {\n    paddingBottom: theme.spacing.lg,\n  },\n  monthSection: {\n    marginBottom: theme.spacing.md,\n  },\n  monthTitle: {\n    fontSize: theme.typography.fontSizes.lg,\n    fontWeight: 'bold',\n    color: theme.colors.text,\n    paddingHorizontal: theme.spacing.lg,\n    paddingVertical: theme.spacing.sm,\n    backgroundColor: theme.isDarkMode ? theme.colors.gray800 : theme.colors.gray100,\n    fontFamily: theme.typography.fontFamilies.bold,\n  },\n  safeBottomPadding: {\n    // Base padding plus extra for navigation elements\n    paddingTop: theme.spacing.lg,\n    paddingBottom: Platform.OS === 'ios' ? 200 : 185,\n  },\n  scrollToTopButton: {\n    position: 'absolute',\n    bottom: Platform.OS === 'ios' ? 120 : 105, // Above the tab bar\n    right: theme.spacing.lg,\n    width: 48,\n    height: 48,\n    borderRadius: 24,\n    backgroundColor: theme.colors.primary,\n    justifyContent: 'center',\n    alignItems: 'center',\n    elevation: 8,\n    shadowColor: theme.colors.shadow,\n    shadowOffset: { width: 0, height: 4 },\n    shadowOpacity: 0.3,\n    shadowRadius: 8,\n    zIndex: 1000,\n  },\n});\n\nexport default JournalScreen; ","/**\n * Error types for OPAQUE Client operations\n * Provides structured error handling without information leakage\n */\n\n/**\n * Base error class for all OPAQUE-related errors\n */\nexport class OpaqueError extends Error {\n  public readonly code: string;\n  public readonly timestamp: Date;\n  public readonly cause?: unknown;\n\n  constructor(message: string, cause?: unknown, code = 'OPAQUE_ERROR') {\n    super(message);\n    this.name = 'OpaqueError';\n    this.code = code;\n    this.timestamp = new Date();\n    this.cause = cause;\n\n    // Ensure proper prototype chain for instanceof checks\n    Object.setPrototypeOf(this, OpaqueError.prototype);\n  }\n\n  /**\n   * Get a sanitized error message for logging (no sensitive information)\n   */\n  public getSanitizedMessage(): string {\n    return `${this.code}: ${this.message}`;\n  }\n\n  /**\n   * Get error details for debugging (internal use only)\n   */\n  public getDebugInfo(): Record<string, unknown> {\n    return {\n      code: this.code,\n      message: this.message,\n      timestamp: this.timestamp.toISOString(),\n      cause: this.cause,\n      stack: this.stack\n    };\n  }\n}\n\n/**\n * Authentication-specific error for OPAQUE operations\n */\nexport class AuthenticationError extends OpaqueError {\n  constructor(message: string, cause?: unknown) {\n    super(message, cause, 'AUTHENTICATION_ERROR');\n    this.name = 'AuthenticationError';\n    Object.setPrototypeOf(this, AuthenticationError.prototype);\n  }\n}\n\n/**\n * Network-related error for OPAQUE operations\n */\nexport class NetworkError extends OpaqueError {\n  public readonly statusCode?: number;\n\n  constructor(message: string, statusCode?: number, cause?: unknown) {\n    super(message, cause, 'NETWORK_ERROR');\n    this.name = 'NetworkError';\n    this.statusCode = statusCode;\n    Object.setPrototypeOf(this, NetworkError.prototype);\n  }\n}\n\n/**\n * Initialization error for OPAQUE client\n */\nexport class InitializationError extends OpaqueError {\n  constructor(message: string, cause?: unknown) {\n    super(message, cause, 'INITIALIZATION_ERROR');\n    this.name = 'InitializationError';\n    Object.setPrototypeOf(this, InitializationError.prototype);\n  }\n}\n\n/**\n * Memory management error for OPAQUE operations\n */\nexport class MemoryError extends OpaqueError {\n  constructor(message: string, cause?: unknown) {\n    super(message, cause, 'MEMORY_ERROR');\n    this.name = 'MemoryError';\n    Object.setPrototypeOf(this, MemoryError.prototype);\n  }\n}\n\n/**\n * Key derivation error for OPAQUE operations\n */\nexport class KeyDerivationError extends OpaqueError {\n  constructor(message: string, cause?: unknown) {\n    super(message, cause, 'KEY_DERIVATION_ERROR');\n    this.name = 'KeyDerivationError';\n    Object.setPrototypeOf(this, KeyDerivationError.prototype);\n  }\n}\n\n/**\n * Serialization/deserialization error for OPAQUE data\n */\nexport class SerializationError extends OpaqueError {\n  constructor(message: string, cause?: unknown) {\n    super(message, cause, 'SERIALIZATION_ERROR');\n    this.name = 'SerializationError';\n    Object.setPrototypeOf(this, SerializationError.prototype);\n  }\n}\n\n/**\n * Utility function to create user-friendly error messages\n * Ensures no sensitive information is leaked to users\n */\nexport function createUserMessage(error: OpaqueError): string {\n  switch (error.code) {\n    case 'AUTHENTICATION_ERROR':\n      return 'Authentication failed. Please check your credentials and try again.';\n    case 'NETWORK_ERROR':\n      return 'Network connection failed. Please check your internet connection and try again.';\n    case 'INITIALIZATION_ERROR':\n      return 'Application initialization failed. Please restart the app.';\n    case 'MEMORY_ERROR':\n      return 'Memory operation failed. Please restart the app.';\n    case 'KEY_DERIVATION_ERROR':\n      return 'Security key generation failed. Please try again.';\n    case 'SERIALIZATION_ERROR':\n      return 'Data processing failed. Please try again.';\n    default:\n      return 'An unexpected error occurred. Please try again.';\n  }\n}\n\n/**\n * Utility function to determine if an error is recoverable\n */\nexport function isRecoverableError(error: OpaqueError): boolean {\n  const recoverableCodes = [\n    'NETWORK_ERROR',\n    'AUTHENTICATION_ERROR'\n  ];\n  \n  return recoverableCodes.includes(error.code);\n}\n\n/**\n * Utility function to determine if error should trigger retry\n */\nexport function shouldRetry(error: OpaqueError, attemptCount: number, maxAttempts: number): boolean {\n  if (attemptCount >= maxAttempts) {\n    return false;\n  }\n\n  // Only retry network errors and certain initialization errors\n  return error.code === 'NETWORK_ERROR' || \n         (error.code === 'INITIALIZATION_ERROR' && attemptCount < 2);\n} ","/**\n * OPAQUE Client Wrapper\n * Provides a clean TypeScript interface for OPAQUE protocol operations\n * using the react-native-opaque package for cross-platform compatibility\n */\n\nimport * as opaque from 'react-native-opaque';\nimport { Platform } from 'react-native';\nimport logger from '../../utils/logger';\nimport { OpaqueError, AuthenticationError, NetworkError } from './errors';\n\n// Type definitions for OPAQUE operations\nexport interface RegistrationResult {\n  registrationRequest: string;\n  clientState: string;\n}\n\nexport interface RegistrationResponse {\n  registrationResponse: string;\n}\n\nexport interface RegistrationRecord {\n  registrationUpload: string;\n  exportKey: Uint8Array;\n}\n\nexport interface LoginResult {\n  credentialRequest: string;\n  clientState: string;\n}\n\nexport interface LoginResponse {\n  credentialResponse: string;\n}\n\nexport interface SessionResult {\n  credentialFinalization: string;\n  sessionKey: Uint8Array;\n  exportKey: Uint8Array;\n}\n\nexport interface VaultKeys {\n  tagId: Uint8Array;\n  dataKey: Uint8Array;\n  vaultId: string;\n}\n\n// Memory management for sensitive data\nclass SecureMemory {\n  private static sensitiveData: Set<Uint8Array> = new Set();\n\n  static register(data: Uint8Array): void {\n    this.sensitiveData.add(data);\n  }\n\n  static clear(data: Uint8Array): void {\n    if (this.sensitiveData.has(data)) {\n      data.fill(0);\n      this.sensitiveData.delete(data);\n    }\n  }\n\n  static clearAll(): void {\n    this.sensitiveData.forEach(data => data.fill(0));\n    this.sensitiveData.clear();\n  }\n}\n\n/**\n * OPAQUE Client - Main interface for OPAQUE protocol operations\n */\nexport class OpaqueClient {\n  private static instance: OpaqueClient;\n  private isInitialized = false;\n\n  private constructor() {}\n\n  public static getInstance(): OpaqueClient {\n    if (!OpaqueClient.instance) {\n      OpaqueClient.instance = new OpaqueClient();\n    }\n    return OpaqueClient.instance;\n  }\n\n  /**\n   * Initialize the OPAQUE client\n   * For web platforms, waits for WebAssembly module to load\n   */\n  public async initialize(): Promise<void> {\n    try {\n      if (Platform.OS === 'web') {\n        logger.info('Waiting for OPAQUE WebAssembly module to load');\n        await opaque.ready;\n        logger.info('OPAQUE WebAssembly module loaded successfully');\n      }\n      \n      this.isInitialized = true;\n      logger.info('OPAQUE client initialized successfully');\n    } catch (error) {\n      logger.error('Failed to initialize OPAQUE client', error);\n      throw new OpaqueError('OPAQUE initialization failed', error);\n    }\n  }\n\n  /**\n   * Start OPAQUE registration process\n   * @param password - User password for registration\n   * @returns Registration request and client state\n   */\n  public async startRegistration(password: string): Promise<RegistrationResult> {\n    this.ensureInitialized();\n    \n    try {\n      logger.debug('Starting OPAQUE registration');\n      \n      const result = opaque.client.startRegistration({ password });\n      \n      if (!result || !result.clientRegistrationState || !result.registrationRequest) {\n        throw new OpaqueError('Invalid registration result from OPAQUE library');\n      }\n\n      logger.debug('OPAQUE registration started successfully');\n      return {\n        registrationRequest: result.registrationRequest,\n        clientState: result.clientRegistrationState\n      };\n    } catch (error) {\n      logger.error('OPAQUE registration start failed', error);\n      if (error instanceof OpaqueError) {\n        throw error;\n      }\n      throw new OpaqueError('Failed to start OPAQUE registration', error);\n    }\n  }\n\n  /**\n   * Complete OPAQUE registration process\n   * @param password - User password\n   * @param clientState - Client state from startRegistration\n   * @param response - Server registration response\n   * @returns Registration record and export key\n   */\n  public async finishRegistration(\n    password: string,\n    clientState: string,\n    response: RegistrationResponse\n  ): Promise<RegistrationRecord> {\n    this.ensureInitialized();\n    \n    try {\n      logger.debug('Finishing OPAQUE registration');\n      \n      const result = opaque.client.finishRegistration({\n        password,\n        clientRegistrationState: clientState,\n        registrationResponse: response.registrationResponse\n      });\n\n      if (!result || !result.registrationUpload || !result.exportKey) {\n        throw new OpaqueError('Invalid registration finish result from OPAQUE library');\n      }\n\n      // Register export key for secure memory management\n      SecureMemory.register(result.exportKey);\n\n      logger.debug('OPAQUE registration finished successfully');\n      return {\n        registrationUpload: result.registrationUpload,\n        exportKey: result.exportKey\n      };\n    } catch (error) {\n      logger.error('OPAQUE registration finish failed', error);\n      if (error instanceof OpaqueError) {\n        throw error;\n      }\n      throw new OpaqueError('Failed to finish OPAQUE registration', error);\n    }\n  }\n\n  /**\n   * Start OPAQUE login/authentication process\n   * @param password - User password for authentication\n   * @returns Login request and client state\n   */\n  public async startLogin(password: string): Promise<LoginResult> {\n    this.ensureInitialized();\n    \n    try {\n      logger.debug('Starting OPAQUE login');\n      \n      const result = opaque.client.startLogin({ password });\n      \n      if (!result || !result.clientLoginState || !result.credentialRequest) {\n        throw new OpaqueError('Invalid login result from OPAQUE library');\n      }\n\n      logger.debug('OPAQUE login started successfully');\n      return {\n        credentialRequest: result.credentialRequest,\n        clientState: result.clientLoginState\n      };\n    } catch (error) {\n      logger.error('OPAQUE login start failed', error);\n      if (error instanceof OpaqueError) {\n        throw error;\n      }\n      throw new OpaqueError('Failed to start OPAQUE login', error);\n    }\n  }\n\n  /**\n   * Complete OPAQUE login process\n   * @param password - User password\n   * @param clientState - Client state from startLogin\n   * @param response - Server credential response\n   * @returns Session result with keys\n   */\n  public async finishLogin(\n    password: string,\n    clientState: string,\n    response: LoginResponse\n  ): Promise<SessionResult> {\n    this.ensureInitialized();\n    \n    try {\n      logger.debug('Finishing OPAQUE login');\n      \n      const result = opaque.client.finishLogin({\n        password,\n        clientLoginState: clientState,\n        credentialResponse: response.credentialResponse\n      });\n\n      if (!result || !result.credentialFinalization || !result.sessionKey || !result.exportKey) {\n        throw new AuthenticationError('OPAQUE authentication failed - invalid credentials');\n      }\n\n      // Register sensitive keys for secure memory management\n      SecureMemory.register(result.sessionKey);\n      SecureMemory.register(result.exportKey);\n\n      logger.debug('OPAQUE login finished successfully');\n      return {\n        credentialFinalization: result.credentialFinalization,\n        sessionKey: result.sessionKey,\n        exportKey: result.exportKey\n      };\n    } catch (error) {\n      logger.error('OPAQUE login finish failed', error);\n      if (error instanceof AuthenticationError) {\n        throw error;\n      }\n      if (error instanceof OpaqueError) {\n        throw error;\n      }\n      throw new OpaqueError('Failed to finish OPAQUE login', error);\n    }\n  }\n\n  /**\n   * Derive vault keys from export key for data encryption\n   * @param exportKey - Export key from OPAQUE session\n   * @param secretPhrase - The secret phrase used as additional input\n   * @returns Vault keys for encryption operations\n   */\n  public async deriveVaultKeys(exportKey: Uint8Array, secretPhrase: string): Promise<VaultKeys> {\n    try {\n      logger.debug('Deriving vault keys from export key');\n      \n      // Use BLAKE2s to generate tag ID (consistent with server)\n      const tagId = await this.blake2s(secretPhrase.trim().toLowerCase(), 16);\n      \n      // Derive data key using HKDF with tag ID as salt\n      const dataKey = await this.hkdf(exportKey, tagId, 'VaultDataKey', 32);\n      \n      // Generate vault ID from tag ID\n      const vaultId = this.bytesToHex(tagId);\n\n      // Register keys for secure memory management\n      SecureMemory.register(tagId);\n      SecureMemory.register(dataKey);\n\n      logger.debug('Vault keys derived successfully');\n      return {\n        tagId,\n        dataKey,\n        vaultId\n      };\n    } catch (error) {\n      logger.error('Failed to derive vault keys', error);\n      throw new OpaqueError('Vault key derivation failed', error);\n    }\n  }\n\n  /**\n   * Clear all sensitive data from memory\n   */\n  public clearMemory(): void {\n    try {\n      SecureMemory.clearAll();\n      logger.debug('OPAQUE client memory cleared');\n    } catch (error) {\n      logger.error('Failed to clear OPAQUE client memory', error);\n    }\n  }\n\n  /**\n   * Check if the client is properly initialized\n   */\n  public getInitializationStatus(): boolean {\n    return this.isInitialized;\n  }\n\n  // Private helper methods\n\n  private ensureInitialized(): void {\n    if (!this.isInitialized) {\n      throw new OpaqueError('OPAQUE client not initialized. Call initialize() first.');\n    }\n  }\n\n  private async blake2s(input: string, outputLength: number): Promise<Uint8Array> {\n    // Using SHA-256 as fallback since BLAKE2s might not be available\n    // In production, should use proper BLAKE2s implementation\n    const encoder = new TextEncoder();\n    const data = encoder.encode(input);\n    const hash = await crypto.subtle.digest('SHA-256', data);\n    return new Uint8Array(hash.slice(0, outputLength));\n  }\n\n  private async hkdf(\n    ikm: Uint8Array,\n    salt: Uint8Array,\n    info: string,\n    length: number\n  ): Promise<Uint8Array> {\n    try {\n      const key = await crypto.subtle.importKey('raw', ikm, 'HKDF', false, ['deriveBits']);\n      const infoBuffer = new TextEncoder().encode(info);\n      \n      const derivedBits = await crypto.subtle.deriveBits(\n        {\n          name: 'HKDF',\n          hash: 'SHA-256',\n          salt,\n          info: infoBuffer\n        },\n        key,\n        length * 8\n      );\n      \n      return new Uint8Array(derivedBits);\n    } catch (error) {\n      throw new OpaqueError('HKDF derivation failed', error);\n    }\n  }\n\n  private bytesToHex(bytes: Uint8Array): string {\n    return Array.from(bytes)\n      .map(b => b.toString(16).padStart(2, '0'))\n      .join('');\n  }\n}\n\n// Export singleton instance\nexport const opaqueClient = OpaqueClient.getInstance(); ","/**\n * Voice Phrase Detector Service\n * \n * Integrates OPAQUE zero-knowledge authentication with voice phrase detection.\n * Replaces the legacy tag manager phrase detection with secure OPAQUE protocol.\n * \n * Features:\n * - OPAQUE-based authentication for voice phrases\n * - Automatic session management for successful authentications  \n * - Secure memory management with automatic cleanup\n * - Performance-optimized for voice processing pipeline\n */\n\nimport { OpaqueClient } from './crypto/OpaqueClient';\nimport { OpaqueError, AuthenticationError, NetworkError } from './crypto/errors';\nimport { SecretTag, SessionData, AuthenticationResult } from './crypto/types';\nimport logger from '../utils/logger';\n\nexport interface VoiceAuthenticationResult {\n  success: boolean;\n  tagId?: string;\n  tagName?: string;\n  sessionKey?: Uint8Array;\n  vaultKey?: Uint8Array;\n  error?: string;\n}\n\nexport interface PhraseDetectionResult {\n  found: boolean;\n  tagId?: string;\n  tagName?: string;\n  action?: 'activate' | 'deactivate' | 'panic';\n}\n\n/**\n * Service for detecting and authenticating voice phrases using OPAQUE protocol\n */\nexport class VoicePhraseDetector {\n  private static instance: VoicePhraseDetector;\n  private opaqueClient: OpaqueClient;\n  private activeSessions: Map<string, SessionData> = new Map();\n  private sessionTimeouts: Map<string, NodeJS.Timeout> = new Map();\n  \n  // Configuration\n  private readonly SESSION_TIMEOUT_MS = 15 * 60 * 1000; // 15 minutes\n  private readonly MAX_AUTHENTICATION_TIME_MS = 2000; // 2 seconds max\n  private readonly PHRASE_NORMALIZATION_REGEX = /[^a-zA-Z0-9\\s]/g;\n\n  private constructor() {\n    this.opaqueClient = OpaqueClient.getInstance();\n  }\n\n  public static getInstance(): VoicePhraseDetector {\n    if (!VoicePhraseDetector.instance) {\n      VoicePhraseDetector.instance = new VoicePhraseDetector();\n    }\n    return VoicePhraseDetector.instance;\n  }\n\n  /**\n   * Main entry point: Check if transcribed voice contains secret phrases\n   * and authenticate using OPAQUE protocol\n   */\n  public async checkForSecretPhrase(transcribedText: string): Promise<PhraseDetectionResult> {\n    if (!transcribedText?.trim()) {\n      return { found: false };\n    }\n\n    try {\n      logger.info(`[VoicePhraseDetector] Checking phrase: \"${transcribedText}\"`);\n      \n      // Normalize the transcribed text for consistent matching\n      const normalizedPhrase = this.normalizePhrase(transcribedText);\n      \n      // Check for panic phrase first (highest priority)\n      if (this.isPanicPhrase(normalizedPhrase)) {\n        logger.warn('[VoicePhraseDetector] Panic phrase detected');\n        await this.handlePanicMode();\n        return {\n          found: true,\n          action: 'panic'\n        };\n      }\n\n      // Attempt OPAQUE authentication with the normalized phrase\n      const authResult = await this.authenticateWithOPAQUE(normalizedPhrase);\n      \n      if (authResult.success && authResult.tagId) {\n        // Check if tag is currently active\n        const isActive = this.isSessionActive(authResult.tagId);\n        const action = isActive ? 'deactivate' : 'activate';\n        \n        if (action === 'activate') {\n          // Create new session for successful authentication\n          await this.createSession(authResult.tagId, authResult.tagName!, authResult.sessionKey!, authResult.vaultKey!);\n        } else {\n          // Deactivate existing session\n          await this.deactivateSession(authResult.tagId);\n        }\n\n        logger.info(`[VoicePhraseDetector] Authentication successful: ${authResult.tagName} (${action})`);\n        \n        return {\n          found: true,\n          tagId: authResult.tagId,\n          tagName: authResult.tagName,\n          action\n        };\n      }\n\n      // No authentication successful\n      logger.info('[VoicePhraseDetector] No secret phrase detected');\n      return { found: false };\n\n    } catch (error) {\n      logger.error('[VoicePhraseDetector] Error during phrase detection:', error);\n      return { found: false };\n    }\n  }\n\n  /**\n   * Authenticate a phrase using OPAQUE protocol\n   */\n  private async authenticateWithOPAQUE(phrase: string): Promise<VoiceAuthenticationResult> {\n    const startTime = Date.now();\n    \n    try {\n      // Get all available secret tags (server will return tag metadata without secrets)\n      const availableTags = await this.getAvailableSecretTags();\n      \n      if (availableTags.length === 0) {\n        return { success: false, error: 'No secret tags configured' };\n      }\n\n      // Try to authenticate with each tag using OPAQUE\n      for (const tag of availableTags) {\n        try {\n          // Check timeout constraint\n          if (Date.now() - startTime > this.MAX_AUTHENTICATION_TIME_MS) {\n            logger.warn('[VoicePhraseDetector] Authentication timeout reached');\n            break;\n          }\n\n          // Attempt OPAQUE authentication with tag ID and phrase\n          const authResult = await this.opaqueClient.authenticate(tag.id, phrase);\n          \n          if (authResult.success) {\n            // Derive vault key from session key\n            const vaultKey = await this.opaqueClient.deriveVaultKey(authResult.sessionKey!, tag.id);\n            \n            return {\n              success: true,\n              tagId: tag.id,\n              tagName: tag.name,\n              sessionKey: authResult.sessionKey,\n              vaultKey\n            };\n          }\n        } catch (error) {\n          // Continue trying other tags - don't fail immediately\n          if (error instanceof AuthenticationError) {\n            logger.debug(`[VoicePhraseDetector] Authentication failed for tag ${tag.id}: ${error.message}`);\n          } else {\n            logger.warn(`[VoicePhraseDetector] Unexpected error for tag ${tag.id}:`, error);\n          }\n          continue;\n        }\n      }\n\n      // No successful authentication\n      const elapsedTime = Date.now() - startTime;\n      logger.info(`[VoicePhraseDetector] Authentication failed for all tags (${elapsedTime}ms)`);\n      \n      return { success: false, error: 'Authentication failed' };\n\n    } catch (error) {\n      const elapsedTime = Date.now() - startTime;\n      logger.error(`[VoicePhraseDetector] OPAQUE authentication error (${elapsedTime}ms):`, error);\n      \n      if (error instanceof NetworkError) {\n        return { success: false, error: 'Network error during authentication' };\n      } else if (error instanceof OpaqueError) {\n        return { success: false, error: 'Authentication protocol error' };\n      }\n      \n      return { success: false, error: 'Unknown authentication error' };\n    }\n  }\n\n  /**\n   * Get available secret tags from server (metadata only, no secrets)\n   */\n  private async getAvailableSecretTags(): Promise<SecretTag[]> {\n    try {\n      // This would call the backend API to get user's secret tag metadata\n      // Implementation would depend on the existing API structure\n      // For now, return empty array - this will be implemented in subsequent tasks\n      logger.info('[VoicePhraseDetector] Getting available secret tags from server');\n      return [];\n    } catch (error) {\n      logger.error('[VoicePhraseDetector] Failed to get available secret tags:', error);\n      return [];\n    }\n  }\n\n  /**\n   * Create a new active session for successful authentication\n   */\n  private async createSession(tagId: string, tagName: string, sessionKey: Uint8Array, vaultKey: Uint8Array): Promise<void> {\n    try {\n      // Clear any existing session for this tag\n      await this.deactivateSession(tagId);\n\n      // Create new session\n      const sessionData: SessionData = {\n        tagId,\n        tagName,\n        sessionKey,\n        vaultKey,\n        createdAt: new Date(),\n        expiresAt: new Date(Date.now() + this.SESSION_TIMEOUT_MS)\n      };\n\n      this.activeSessions.set(tagId, sessionData);\n\n      // Set automatic cleanup timeout\n      const timeoutId = setTimeout(() => {\n        this.deactivateSession(tagId);\n      }, this.SESSION_TIMEOUT_MS);\n\n      this.sessionTimeouts.set(tagId, timeoutId);\n\n      logger.info(`[VoicePhraseDetector] Session created for tag: ${tagName} (expires in ${this.SESSION_TIMEOUT_MS / 1000}s)`);\n    } catch (error) {\n      logger.error('[VoicePhraseDetector] Failed to create session:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Deactivate an active session and clean up memory\n   */\n  private async deactivateSession(tagId: string): Promise<void> {\n    try {\n      const session = this.activeSessions.get(tagId);\n      if (session) {\n        // Clear sensitive data from memory\n        session.sessionKey.fill(0);\n        session.vaultKey.fill(0);\n        \n        this.activeSessions.delete(tagId);\n        logger.info(`[VoicePhraseDetector] Session deactivated for tag: ${session.tagName}`);\n      }\n\n      // Clear timeout if exists\n      const timeoutId = this.sessionTimeouts.get(tagId);\n      if (timeoutId) {\n        clearTimeout(timeoutId);\n        this.sessionTimeouts.delete(tagId);\n      }\n    } catch (error) {\n      logger.error('[VoicePhraseDetector] Error deactivating session:', error);\n    }\n  }\n\n  /**\n   * Check if a session is currently active for a tag\n   */\n  public isSessionActive(tagId: string): boolean {\n    const session = this.activeSessions.get(tagId);\n    if (!session) {\n      return false;\n    }\n\n    // Check if session has expired\n    if (session.expiresAt < new Date()) {\n      this.deactivateSession(tagId);\n      return false;\n    }\n\n    return true;\n  }\n\n  /**\n   * Get active session data for a tag\n   */\n  public getActiveSession(tagId: string): SessionData | null {\n    if (!this.isSessionActive(tagId)) {\n      return null;\n    }\n    return this.activeSessions.get(tagId) || null;\n  }\n\n  /**\n   * Get all currently active sessions\n   */\n  public getActiveSessions(): SessionData[] {\n    const activeSessions: SessionData[] = [];\n    \n    for (const [tagId, session] of this.activeSessions) {\n      if (this.isSessionActive(tagId)) {\n        activeSessions.push(session);\n      }\n    }\n    \n    return activeSessions;\n  }\n\n  /**\n   * Handle panic mode - clear all sessions and sensitive data\n   */\n  private async handlePanicMode(): Promise<void> {\n    try {\n      logger.warn('[VoicePhraseDetector] Entering panic mode - clearing all sessions');\n\n      // Deactivate all sessions\n      const tagIds = Array.from(this.activeSessions.keys());\n      for (const tagId of tagIds) {\n        await this.deactivateSession(tagId);\n      }\n\n      // Clear OPAQUE client memory\n      await this.opaqueClient.clearMemory();\n\n      logger.info('[VoicePhraseDetector] Panic mode complete - all sensitive data cleared');\n    } catch (error) {\n      logger.error('[VoicePhraseDetector] Error during panic mode:', error);\n    }\n  }\n\n  /**\n   * Normalize phrase for consistent matching\n   */\n  private normalizePhrase(phrase: string): string {\n    return phrase\n      .toLowerCase()\n      .trim()\n      .replace(this.PHRASE_NORMALIZATION_REGEX, '')\n      .replace(/\\s+/g, ' ');\n  }\n\n  /**\n   * Check if phrase is a panic phrase\n   */\n  private isPanicPhrase(normalizedPhrase: string): boolean {\n    const panicPhrases = [\n      'emergency delete everything',\n      'panic mode now',\n      'destroy all data'\n    ];\n\n    return panicPhrases.some(panic => normalizedPhrase.includes(panic));\n  }\n\n  /**\n   * Clean up all resources\n   */\n  public async cleanup(): Promise<void> {\n    try {\n      logger.info('[VoicePhraseDetector] Cleaning up resources');\n\n      // Deactivate all sessions\n      const tagIds = Array.from(this.activeSessions.keys());\n      for (const tagId of tagIds) {\n        await this.deactivateSession(tagId);\n      }\n\n      // Clear all timeouts\n      for (const timeoutId of this.sessionTimeouts.values()) {\n        clearTimeout(timeoutId);\n      }\n      this.sessionTimeouts.clear();\n\n      logger.info('[VoicePhraseDetector] Cleanup complete');\n    } catch (error) {\n      logger.error('[VoicePhraseDetector] Error during cleanup:', error);\n    }\n  }\n}\n\n// Export singleton instance\nexport const voicePhraseDetector = VoicePhraseDetector.getInstance(); ","import React, { useState, useEffect, useMemo, useRef, useCallback } from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  TouchableOpacity,\n  FlatList,\n  ActivityIndicator,\n  Alert,\n  Dimensions,\n  Platform,\n  RefreshControl,\n} from 'react-native';\nimport { useNavigation, useFocusEffect } from '@react-navigation/native';\nimport { CompositeNavigationProp } from '@react-navigation/native';\nimport { StackNavigationProp } from '@react-navigation/stack';\nimport { BottomTabNavigationProp } from '@react-navigation/bottom-tabs';\nimport { format, parseISO, startOfMonth, endOfMonth, eachDayOfInterval, isSameDay } from 'date-fns';\nimport { Ionicons } from '@expo/vector-icons';\n\nimport { JournalAPI } from '../../services/api';\nimport { JournalEntry, Tag } from '../../types';\nimport JournalCard from '../../components/JournalCard';\nimport SafeScrollView from '../../components/SafeScrollView';\nimport ScreenHeader from '../../components/ScreenHeader';\nimport { CalendarSkeleton, JournalCardSkeleton } from '../../components/SkeletonLoader';\nimport { MainStackParamList, MainTabParamList, JournalStackParamList } from '../../navigation/types';\nimport { useAppTheme } from '../../contexts/ThemeContext';\nimport { voicePhraseDetector } from '../../services/VoicePhraseDetector';\nimport { AppTheme } from '../../config/theme';\n\ntype CalendarScreenNavigationProp = CompositeNavigationProp<\n  BottomTabNavigationProp<MainTabParamList, 'Calendar'>,\n  StackNavigationProp<MainStackParamList>\n>;\n\nconst CalendarScreen = () => {\n  const navigation = useNavigation<CalendarScreenNavigationProp>();\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n  \n  const [currentMonth, setCurrentMonth] = useState(new Date());\n  const [selectedDate, setSelectedDate] = useState(new Date());\n  const [allEntries, setAllEntries] = useState<JournalEntry[]>([]);\n  const [filteredEntriesForSelectedDate, setFilteredEntriesForSelectedDate] = useState<JournalEntry[]>([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [hasActiveSecretTags, setHasActiveSecretTags] = useState(false);\n  const [isRefreshing, setIsRefreshing] = useState(false);\n  \n  // Scroll to top functionality\n  const [showScrollToTop, setShowScrollToTop] = useState(false);\n  const scrollViewRef = useRef<any>(null);\n  \n  // Handle scroll events to show/hide scroll-to-top button\n  const handleScroll = useCallback((event: any) => {\n    const { contentOffset } = event.nativeEvent;\n    \n    // Show scroll-to-top button when scrolled down more than 200px\n    setShowScrollToTop(contentOffset.y > 200);\n  }, []);\n\n  // Scroll to top function\n  const scrollToTop = useCallback(() => {\n    if (scrollViewRef.current) {\n      scrollViewRef.current.scrollTo({\n        y: 0,\n        animated: true,\n      });\n    }\n  }, []);\n  \n  // Check for active secret tags\n  useEffect(() => {\n    const checkActiveSecretTags = async () => {\n      const activeSessions = voicePhraseDetector.getActiveSessions();\n      setHasActiveSecretTags(activeSessions.length > 0);\n    };\n    \n    checkActiveSecretTags();\n    // Check periodically for secret tag changes\n    const interval = setInterval(checkActiveSecretTags, 1000);\n    \n    return () => clearInterval(interval);\n  }, []);\n  \n  const visibleEntries = useMemo(() => {\n    // For now, return all entries - filtering will happen server-side\n    return allEntries;\n  }, [allEntries, hasActiveSecretTags]);\n  \n  useFocusEffect(\n    React.useCallback(() => {\n      fetchEntries();\n      // Also refresh entries for the currently selected date when returning to screen\n      if (selectedDate) {\n        fetchEntriesForSelectedDate(selectedDate);\n      }\n    }, [selectedDate])\n  );\n  \n  useEffect(() => {\n    // When the selectedDate changes, fetch entries for that date\n    if (selectedDate) {\n      fetchEntriesForSelectedDate(selectedDate);\n    }\n  }, [selectedDate]);\n\n  // Keep a separate effect for when secret tag visibility changes\n  useEffect(() => {\n    if (selectedDate && allEntries.length > 0) {\n      // Refresh filtered entries when secret tags change\n      fetchEntriesForSelectedDate(selectedDate);\n    }\n  }, [hasActiveSecretTags]);\n  \n  const getDaysInMonth = () => {\n    const start = startOfMonth(currentMonth);\n    const end = endOfMonth(currentMonth);\n    return eachDayOfInterval({ start, end });\n  };\n  \n  const fetchEntries = async () => {\n    try {\n      setIsLoading(true);\n      \n      // Fetch all entries for date indicators in the calendar\n      const allEntriesResponse = await JournalAPI.getEntries({\n        limit: 100,  // Fetch more entries to show indicators properly\n        include_public: true\n      });\n      const entries = Array.isArray(allEntriesResponse.data) \n        ? allEntriesResponse.data \n        : allEntriesResponse.data.entries || [];\n      setAllEntries(entries as JournalEntry[]);\n      \n      // Also trigger filtering for the selected date\n      await fetchEntriesForSelectedDate(selectedDate);\n    } catch (error) {\n      console.error('Error fetching journal entries', error);\n      Alert.alert('Error', 'Failed to load journal entries');\n    } finally {\n      setIsLoading(false);\n      setIsRefreshing(false);\n    }\n  };\n\n  // Handle pull-to-refresh\n  const onRefresh = React.useCallback(() => {\n    setIsRefreshing(true);\n    fetchEntries();\n  }, [selectedDate]);\n  \n  // New function to fetch entries for a specific date\n  const fetchEntriesForSelectedDate = async (date: Date) => {\n    try {\n      // Format date as YYYY-MM-DD for API query\n      const formattedDate = format(date, 'yyyy-MM-dd');\n      \n      // Use start_date and end_date parameters to filter by exact date\n      const response = await JournalAPI.getEntries({\n        // Filter by the specific date using both start_date and end_date\n        start_date: formattedDate,\n        end_date: formattedDate,\n        include_public: true\n      });\n      \n      // Use entries as-is (server-side filtering handles secret tags)\n      const entries = response.data as JournalEntry[];\n      const filtered = entries;\n      \n      setFilteredEntriesForSelectedDate(filtered);\n    } catch (error) {\n      console.error(`Error fetching entries for date ${format(date, 'yyyy-MM-dd')}`, error);\n      setFilteredEntriesForSelectedDate([]);\n    }\n  };\n  \n  // Replace filterEntriesByDate with a function that triggers fetchEntriesForSelectedDate\n  const filterEntriesByDate = () => {\n    fetchEntriesForSelectedDate(selectedDate);\n  };\n  \n  const goToPreviousMonth = () => {\n    const previousMonth = new Date(currentMonth);\n    previousMonth.setMonth(previousMonth.getMonth() - 1);\n    setCurrentMonth(previousMonth);\n  };\n  \n  const goToNextMonth = () => {\n    const nextMonth = new Date(currentMonth);\n    nextMonth.setMonth(nextMonth.getMonth() + 1);\n    setCurrentMonth(nextMonth);\n  };\n  \n  const handleCreateEntry = () => {\n    // Pass the selected date to the Record screen\n    const formattedDate = format(selectedDate, 'yyyy-MM-dd');\n    navigation.navigate('Record', { \n      selectedDate: formattedDate\n    });\n  };\n  \n  const handleEntryPress = (entry: JournalEntry) => {\n    // Navigate to JournalEntryDetail in the main stack\n    navigation.navigate('JournalEntryDetail', { entryId: entry.id.toString() });\n  };\n  \n  const renderDay = (day: Date) => {\n    const dayString = format(day, 'd');\n    const hasEntriesOnDay = visibleEntries.some(entry => {\n      try {\n        const entryDate = parseISO(entry.entry_date);\n        return entryDate.getFullYear() === day.getFullYear() &&\n               entryDate.getMonth() === day.getMonth() &&\n               entryDate.getDate() === day.getDate();\n      } catch (e) {\n        console.error(`Error parsing entry_date for indicator: ${entry.entry_date}`, e);\n        return false;\n      }\n    });\n    \n    const isSelected = isSameDay(day, selectedDate); \n    \n    return (\n      <TouchableOpacity \n        style={[\n          styles.dayContainer,\n          isSelected && styles.selectedDayContainer\n        ]} \n        onPress={() => {\n          setSelectedDate(day);\n          // Fetch entries immediately for better user experience\n          fetchEntriesForSelectedDate(day);\n        }}\n      >\n        <Text style={[\n          styles.dayText,\n          isSelected && styles.selectedDayText\n        ]}>\n          {dayString}\n        </Text>\n        \n        {hasEntriesOnDay && <View style={[\n          styles.entryIndicator,\n          isSelected && styles.selectedEntryIndicator\n        ]} />}\n      </TouchableOpacity>\n    );\n  };\n  \n  const renderEntry = ({ item, index }: { item: JournalEntry; index: number }) => (\n    <JournalCard \n      entry={item}\n      onPress={() => handleEntryPress(item)}\n      key={`calendar-entry-${item.id}-${index}`}\n    />\n  );\n  \n  return (\n    <View style={styles.container}>\n      <ScreenHeader \n        title=\"Calendar\" \n        showSecretTagIndicator={hasActiveSecretTags}\n        secretTagText=\"Secret Tags Active\"\n      />\n      \n      <SafeScrollView \n        style={{ flex: 1 }} \n        contentContainerStyle={{ flexGrow: 1 }}\n        refreshControl={\n          <RefreshControl\n            refreshing={isRefreshing}\n            onRefresh={onRefresh}\n            colors={[theme.colors.primary]}\n            tintColor={theme.colors.primary}\n          />\n        }\n        onScroll={handleScroll}\n        ref={scrollViewRef}\n      >\n        <View style={styles.calendarHeader}>\n          <TouchableOpacity onPress={goToPreviousMonth}>\n            <Ionicons name=\"chevron-back\" size={theme.typography.fontSizes.xxl} color={theme.colors.text} />\n          </TouchableOpacity>\n          \n          <Text style={styles.monthText}>\n            {format(currentMonth, 'MMMM yyyy')}\n          </Text>\n          \n          <TouchableOpacity onPress={goToNextMonth}>\n            <Ionicons name=\"chevron-forward\" size={theme.typography.fontSizes.xxl} color={theme.colors.text} />\n          </TouchableOpacity>\n        </View>\n        \n        <View style={styles.calendar}>\n          <View style={styles.weekDays}>\n            {['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'].map((day) => (\n              <Text key={day} style={styles.weekDayText}>{day}</Text>\n            ))}\n          </View>\n          \n          <View style={styles.daysContainer}>\n            {getDaysInMonth().map((day) => (\n              <View key={day.toISOString()}>\n                {renderDay(day)}\n              </View>\n            ))}\n          </View>\n        </View>\n        \n        <View style={styles.selectedDateContainer}>\n          <Text style={styles.selectedDateText}>\n            {format(selectedDate, 'EEEE, MMMM d, yyyy')}\n          </Text>\n          \n          <TouchableOpacity \n            style={styles.addButton}\n            onPress={handleCreateEntry}\n          >\n            <Ionicons name=\"add\" size={theme.typography.fontSizes.xxl} color={theme.isDarkMode ? theme.colors.background : theme.colors.white} />\n          </TouchableOpacity>\n        </View>\n        \n        {isLoading ? (\n          <View style={styles.skeletonContainer}>\n            <CalendarSkeleton />\n            {Array.from({ length: 3 }, (_, index) => (\n              <JournalCardSkeleton key={`skeleton-${index}`} />\n            ))}\n          </View>\n        ) : (\n          <View style={styles.entriesContainer}>\n            {filteredEntriesForSelectedDate.length === 0 ? (\n              <View style={styles.emptyContainer}>\n                <Ionicons name=\"calendar-outline\" size={theme.spacing.xxl * 1.5} color={theme.colors.disabled} />\n                <Text style={styles.emptyText}>\n                  {\"No entries for this date\"}\n                </Text>\n                <TouchableOpacity \n                  style={styles.createButton}\n                  onPress={handleCreateEntry}\n                >\n                  <Text style={styles.createButtonText}>Create Entry</Text>\n                </TouchableOpacity>\n              </View>\n            ) : (\n              <View style={styles.entriesListContainer}>\n                <FlatList\n                  data={filteredEntriesForSelectedDate}\n                  renderItem={renderEntry}\n                  keyExtractor={(item, index) => `calendar-list-${item.id}-${index}`}\n                  contentContainerStyle={[styles.listContent, { paddingBottom: 40 }]}\n                  scrollEnabled={true}\n                  nestedScrollEnabled={true}\n                />\n              </View>\n            )}\n          </View>\n        )}\n      </SafeScrollView>\n      \n      {/* Scroll to Top Button */}\n      {showScrollToTop && (\n        <TouchableOpacity\n          style={styles.scrollToTopButton}\n          onPress={scrollToTop}\n          activeOpacity={0.8}\n        >\n          <Ionicons \n            name=\"chevron-up\" \n            size={24} \n            color={theme.colors.white} \n          />\n        </TouchableOpacity>\n      )}\n    </View>\n  );\n};\n\nconst getStyles = (theme: AppTheme) => {\n  const { width, height } = Dimensions.get('window');\n  const isDesktop = width > 768; // Consider devices wider than 768px as desktop\n  const isTablet = width > 480 && width <= 768;\n  \n  // Calculate responsive calendar dimensions\n  const calendarMaxWidth = isDesktop ? 600 : width - (theme.spacing.md * 2);\n  const calendarPadding = isDesktop ? theme.spacing.xl : theme.spacing.md;\n  \n  // Calculate day cell size - ensure calendar fits within screen\n  const availableWidth = calendarMaxWidth - (theme.spacing.sm * 2);\n  const dayCellSize = Math.min(\n    availableWidth / 7, // Ensure 7 days fit in one row\n    isDesktop ? 60 : 45  // Max size constraints\n  );\n  \n  return StyleSheet.create({\n    container: {\n      flex: 1,\n      backgroundColor: theme.colors.background,\n    },\n\n    calendarHeader: {\n      flexDirection: 'row',\n      justifyContent: 'space-between',\n      alignItems: 'center',\n      paddingHorizontal: calendarPadding,\n      paddingVertical: theme.spacing.md,\n      borderBottomWidth: 1,\n      borderBottomColor: theme.colors.border,\n      maxWidth: calendarMaxWidth,\n      alignSelf: 'center',\n      width: '100%',\n    },\n    monthText: {\n      fontSize: theme.typography.fontSizes.lg,\n      fontWeight: 'bold',\n      color: theme.colors.text,\n      fontFamily: theme.typography.fontFamilies.bold,\n    },\n    calendar: {\n      paddingHorizontal: theme.spacing.sm,\n      paddingVertical: theme.spacing.md,\n      backgroundColor: theme.colors.card,\n      margin: theme.spacing.md,\n      borderRadius: 8,\n      maxWidth: calendarMaxWidth,\n      alignSelf: 'center',\n      width: isDesktop ? calendarMaxWidth : '100%',\n    },\n    weekDays: {\n      flexDirection: 'row',\n      justifyContent: 'space-around',\n      marginBottom: theme.spacing.sm,\n    },\n    weekDayText: {\n      fontSize: isDesktop ? theme.typography.fontSizes.sm : theme.typography.fontSizes.xs,\n      color: theme.colors.textSecondary,\n      fontFamily: theme.typography.fontFamilies.semiBold,\n      width: dayCellSize,\n      textAlign: 'center',\n    },\n    daysContainer: {\n      flexDirection: 'row',\n      flexWrap: 'wrap',\n      justifyContent: 'space-around',\n    },\n    dayContainer: {\n      width: dayCellSize,\n      height: dayCellSize,\n      justifyContent: 'center',\n      alignItems: 'center',\n      borderWidth: 1,\n      borderColor: 'transparent',\n      borderRadius: 5,\n      margin: 1,\n    },\n    selectedDayContainer: {\n      backgroundColor: theme.colors.primary,\n      borderColor: theme.colors.primary,\n      borderRadius: 20,\n    },\n    dayText: {\n      fontSize: isDesktop ? theme.typography.fontSizes.sm : theme.typography.fontSizes.xs,\n      color: theme.colors.text,\n      fontFamily: theme.typography.fontFamilies.regular,\n    },\n    selectedDayText: {\n      color: theme.isDarkMode ? theme.colors.background : theme.colors.white,\n      fontWeight: 'bold',\n      fontFamily: theme.typography.fontFamilies.bold,\n    },\n    entryIndicator: {\n      width: 4,\n      height: 4,\n      borderRadius: 2,\n      backgroundColor: theme.colors.secondary,\n      position: 'absolute',\n      bottom: isDesktop ? 6 : 4,\n    },\n    selectedEntryIndicator: {\n      backgroundColor: theme.isDarkMode ? theme.colors.background : theme.colors.white,\n    },\n    selectedDateContainer: {\n      padding: theme.spacing.md,\n      flexDirection: 'row',\n      justifyContent: 'space-between',\n      alignItems: 'center',\n      borderTopWidth: 1,\n      borderBottomWidth: 1,\n      borderColor: theme.colors.border,\n      backgroundColor: theme.colors.card,\n      maxWidth: calendarMaxWidth,\n      alignSelf: 'center',\n      width: isDesktop ? calendarMaxWidth : '100%',\n    },\n    selectedDateText: {\n      fontSize: theme.typography.fontSizes.md,\n      fontWeight: 'bold',\n      color: theme.colors.text,\n      fontFamily: theme.typography.fontFamilies.bold,\n    },\n    addButton: {\n      backgroundColor: theme.colors.primary,\n      padding: theme.spacing.sm,\n      borderRadius: 20,\n    },\n    loaderContainer: {\n      flex: 1,\n      justifyContent: 'center',\n      alignItems: 'center',\n      backgroundColor: theme.colors.background,\n    },\n    skeletonContainer: {\n      flex: 1,\n      backgroundColor: theme.colors.background,\n    },\n    entriesContainer: {\n      flex: 1,\n      maxWidth: calendarMaxWidth,\n      alignSelf: 'center',\n      width: isDesktop ? calendarMaxWidth : '100%',\n    },\n    emptyContainer: {\n      flex: 1,\n      justifyContent: 'center',\n      alignItems: 'center',\n      padding: theme.spacing.lg,\n      minHeight: isDesktop ? 200 : 150,\n    },\n    emptyText: {\n      fontSize: theme.typography.fontSizes.md,\n      color: theme.colors.textSecondary,\n      marginTop: theme.spacing.md,\n      marginBottom: theme.spacing.lg,\n      textAlign: 'center',\n      fontFamily: theme.typography.fontFamilies.regular,\n    },\n    createButton: {\n      backgroundColor: theme.colors.primary,\n      paddingVertical: theme.spacing.md,\n      paddingHorizontal: theme.spacing.xl,\n      borderRadius: 25,\n    },\n    createButtonText: {\n      color: theme.isDarkMode ? theme.colors.background : theme.colors.white,\n      fontSize: theme.typography.fontSizes.md,\n      fontWeight: 'bold',\n      fontFamily: theme.typography.fontFamilies.bold,\n    },\n    listContent: {\n      padding: theme.spacing.md,\n      paddingBottom: Platform.OS === 'ios' ? 60 : 50, // Extra bottom padding for navigation\n    },\n    scrollContainer: {\n      flex: 1,\n    },\n    scrollContent: {\n      flexGrow: 1,\n    },\n    entriesListContainer: {\n      minHeight: isDesktop ? 300 : 200,\n    },\n    scrollToTopButton: {\n      position: 'absolute',\n      bottom: Platform.OS === 'ios' ? 120 : 105, // Above the tab bar\n      right: theme.spacing.lg,\n      width: 48,\n      height: 48,\n      borderRadius: 24,\n      backgroundColor: theme.colors.primary,\n      justifyContent: 'center',\n      alignItems: 'center',\n      elevation: 8,\n      shadowColor: theme.colors.shadow,\n      shadowOffset: { width: 0, height: 4 },\n      shadowOpacity: 0.3,\n      shadowRadius: 8,\n      zIndex: 1000,\n    },\n  });\n};\n\nexport default CalendarScreen; \n \n ","import { Platform, Alert } from 'react-native';\nimport settingsService from './settingsService';\nimport logger from '../utils/logger';\n\nexport interface NotificationPermissions {\n  granted: boolean;\n  canAskAgain: boolean;\n  status: 'granted' | 'denied' | 'undetermined';\n}\n\nclass NotificationService {\n  private initialized = false;\n  private dailyReminderScheduled = false;\n\n  /**\n   * Initialize the notification service\n   * Note: This is a simplified version. In a full implementation,\n   * you would install expo-notifications and use proper notification APIs.\n   */\n  async initialize(): Promise<boolean> {\n    try {\n      if (this.initialized) return true;\n\n      logger.info('[NotificationService] Initialized (simplified version)');\n      this.initialized = true;\n      return true;\n    } catch (error) {\n      logger.error('[NotificationService] Failed to initialize:', error);\n      return false;\n    }\n  }\n\n  /**\n   * Request notification permissions\n   * Note: This is a placeholder. In a full implementation,\n   * you would use expo-notifications to request actual permissions.\n   */\n  async requestPermissions(): Promise<NotificationPermissions> {\n    try {\n      // For now, we'll simulate permission request\n      logger.info('[NotificationService] Permission request (simulated)');\n      \n      return {\n        granted: true, // Simulated as granted\n        canAskAgain: true,\n        status: 'granted',\n      };\n    } catch (error) {\n      logger.error('[NotificationService] Failed to request permissions:', error);\n      return {\n        granted: false,\n        canAskAgain: false,\n        status: 'denied',\n      };\n    }\n  }\n\n  /**\n   * Schedule daily journal reminder based on user settings\n   * Note: This is a placeholder. In a full implementation,\n   * you would use expo-notifications to schedule actual notifications.\n   */\n  async scheduleDailyReminder(): Promise<boolean> {\n    try {\n      const settings = await settingsService.getSettings();\n      \n      // Check if notifications and reminders are enabled\n      if (!settings.notificationsEnabled || !settings.reminderNotifications) {\n        logger.info('[NotificationService] Daily reminders disabled in settings');\n        this.dailyReminderScheduled = false;\n        return false;\n      }\n\n      // Parse the reminder time (HH:MM format)\n      const [hours, minutes] = settings.dailyReminderTime.split(':').map(Number);\n      \n      if (isNaN(hours) || isNaN(minutes) || hours < 0 || hours > 23 || minutes < 0 || minutes > 59) {\n        logger.error(`[NotificationService] Invalid reminder time: ${settings.dailyReminderTime}`);\n        return false;\n      }\n\n      // Simulate scheduling the notification\n      this.dailyReminderScheduled = true;\n      logger.info(`[NotificationService] Scheduled daily reminder at ${settings.dailyReminderTime} (simulated)`);\n      \n      // In a real implementation, you would:\n      // await Notifications.scheduleNotificationAsync({...});\n      \n      return true;\n    } catch (error) {\n      logger.error('[NotificationService] Failed to schedule daily reminder:', error);\n      return false;\n    }\n  }\n\n  /**\n   * Cancel the daily journal reminder\n   */\n  async cancelDailyReminder(): Promise<void> {\n    try {\n      this.dailyReminderScheduled = false;\n      logger.info('[NotificationService] Cancelled daily reminder (simulated)');\n      \n      // In a real implementation, you would:\n      // await Notifications.cancelScheduledNotificationAsync(identifier);\n    } catch (error) {\n      logger.error('[NotificationService] Failed to cancel daily reminder:', error);\n    }\n  }\n\n  /**\n   * Update notification settings - call this when user changes notification preferences\n   */\n  async updateNotificationSettings(): Promise<void> {\n    try {\n      const settings = await settingsService.getSettings();\n      \n      if (settings.reminderNotifications && settings.notificationsEnabled) {\n        // Reschedule daily reminder with new settings\n        await this.scheduleDailyReminder();\n      } else {\n        // Cancel daily reminder if disabled\n        await this.cancelDailyReminder();\n      }\n      \n      logger.info('[NotificationService] Updated notification settings');\n    } catch (error) {\n      logger.error('[NotificationService] Failed to update notification settings:', error);\n    }\n  }\n\n  /**\n   * Check if notifications are properly configured\n   */\n  async isConfigured(): Promise<boolean> {\n    try {\n      // For now, always return true since we're using a simplified version\n      return true;\n    } catch (error) {\n      logger.error('[NotificationService] Failed to check configuration:', error);\n      return false;\n    }\n  }\n\n  /**\n   * Get notification permission status\n   */\n  async getPermissionStatus(): Promise<'granted' | 'denied' | 'undetermined'> {\n    try {\n      // For now, always return granted since we're using a simplified version\n      return 'granted';\n    } catch (error) {\n      logger.error('[NotificationService] Failed to get permission status:', error);\n      return 'denied';\n    }\n  }\n\n  /**\n   * Show a test notification (for development/testing)\n   */\n  async showTestNotification(): Promise<void> {\n    try {\n      const settings = await settingsService.getSettings();\n      \n      if (!settings.notificationsEnabled) {\n        Alert.alert('Notifications Disabled', 'Please enable notifications in settings to test.');\n        return;\n      }\n\n      Alert.alert(\n        ' Journal Reminder',\n        'This is a test notification. In a full implementation, this would be a proper push notification.',\n        [{ text: 'OK' }]\n      );\n      \n      logger.info('[NotificationService] Showed test notification');\n    } catch (error) {\n      logger.error('[NotificationService] Failed to show test notification:', error);\n    }\n  }\n\n  /**\n   * Get the current reminder schedule status\n   */\n  isDailyReminderScheduled(): boolean {\n    return this.dailyReminderScheduled;\n  }\n}\n\n// Export singleton instance\nconst notificationService = new NotificationService();\nexport default notificationService; ","import React, { createContext, useContext, useState, useEffect, ReactNode } from 'react';\nimport settingsService, { UserSettings, DEFAULT_SETTINGS } from '../services/settingsService';\nimport notificationService from '../services/notificationService';\nimport logger from '../utils/logger';\n\ninterface SettingsContextValue {\n  settings: UserSettings;\n  isLoading: boolean;\n  error: string | null;\n  updateSetting: <K extends keyof UserSettings>(key: K, value: UserSettings[K]) => Promise<void>;\n  updateSettings: (updates: Partial<UserSettings>) => Promise<void>;\n  resetToDefaults: () => Promise<void>;\n  exportSettings: () => Promise<string>;\n  importSettings: (jsonData: string) => Promise<void>;\n  getSetting: <K extends keyof UserSettings>(key: K) => UserSettings[K];\n}\n\nconst SettingsContext = createContext<SettingsContextValue | undefined>(undefined);\n\ninterface SettingsProviderProps {\n  children: ReactNode;\n}\n\nexport const SettingsProvider: React.FC<SettingsProviderProps> = ({ children }) => {\n  const [settings, setSettings] = useState<UserSettings>(DEFAULT_SETTINGS);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  // Initialize settings on mount\n  useEffect(() => {\n    const initializeSettings = async () => {\n      try {\n        setIsLoading(true);\n        setError(null);\n        \n        const loadedSettings = await settingsService.initialize();\n        setSettings(loadedSettings);\n        \n        logger.info('[SettingsContext] Settings initialized successfully');\n      } catch (err) {\n        const errorMessage = err instanceof Error ? err.message : 'Failed to initialize settings';\n        logger.error('[SettingsContext] Settings initialization failed:', err);\n        setError(errorMessage);\n        \n        // Fallback to defaults on error\n        setSettings(DEFAULT_SETTINGS);\n      } finally {\n        setIsLoading(false);\n      }\n    };\n\n    initializeSettings();\n  }, []);\n\n  // Subscribe to settings changes from the service\n  useEffect(() => {\n    const unsubscribe = settingsService.subscribe((updatedSettings) => {\n      setSettings(updatedSettings);\n      logger.debug('[SettingsContext] Settings updated via subscription');\n    });\n\n    return unsubscribe;\n  }, []);\n\n  // Update a single setting\n  const updateSetting = async <K extends keyof UserSettings>(\n    key: K, \n    value: UserSettings[K]\n  ): Promise<void> => {\n    try {\n      setError(null);\n      await settingsService.updateSetting(key, value);\n      \n      // Update notification settings if notification-related settings changed\n      if (key === 'notificationsEnabled' || key === 'reminderNotifications' || key === 'dailyReminderTime') {\n        await notificationService.updateNotificationSettings();\n        logger.info(`[SettingsContext] Updated notification settings after ${key} change`);\n      }\n      \n      // Settings will be updated via subscription\n    } catch (err) {\n      const errorMessage = err instanceof Error ? err.message : `Failed to update ${key}`;\n      logger.error(`[SettingsContext] Failed to update setting ${key}:`, err);\n      setError(errorMessage);\n      throw err; // Re-throw for component error handling\n    }\n  };\n\n  // Update multiple settings\n  const updateSettings = async (updates: Partial<UserSettings>): Promise<void> => {\n    try {\n      setError(null);\n      await settingsService.updateSettings(updates);\n      // Settings will be updated via subscription\n    } catch (err) {\n      const errorMessage = err instanceof Error ? err.message : 'Failed to update settings';\n      logger.error('[SettingsContext] Failed to update settings:', err);\n      setError(errorMessage);\n      throw err; // Re-throw for component error handling\n    }\n  };\n\n  // Reset all settings to defaults\n  const resetToDefaults = async (): Promise<void> => {\n    try {\n      setError(null);\n      await settingsService.resetToDefaults();\n      // Settings will be updated via subscription\n      logger.info('[SettingsContext] Settings reset to defaults');\n    } catch (err) {\n      const errorMessage = err instanceof Error ? err.message : 'Failed to reset settings';\n      logger.error('[SettingsContext] Failed to reset settings:', err);\n      setError(errorMessage);\n      throw err; // Re-throw for component error handling\n    }\n  };\n\n  // Export settings\n  const exportSettings = async (): Promise<string> => {\n    try {\n      setError(null);\n      const exportData = await settingsService.exportSettings();\n      logger.info('[SettingsContext] Settings exported successfully');\n      return exportData;\n    } catch (err) {\n      const errorMessage = err instanceof Error ? err.message : 'Failed to export settings';\n      logger.error('[SettingsContext] Failed to export settings:', err);\n      setError(errorMessage);\n      throw err; // Re-throw for component error handling\n    }\n  };\n\n  // Import settings\n  const importSettings = async (jsonData: string): Promise<void> => {\n    try {\n      setError(null);\n      await settingsService.importSettings(jsonData);\n      // Settings will be updated via subscription\n      logger.info('[SettingsContext] Settings imported successfully');\n    } catch (err) {\n      const errorMessage = err instanceof Error ? err.message : 'Failed to import settings';\n      logger.error('[SettingsContext] Failed to import settings:', err);\n      setError(errorMessage);\n      throw err; // Re-throw for component error handling\n    }\n  };\n\n  // Get a specific setting value\n  const getSetting = <K extends keyof UserSettings>(key: K): UserSettings[K] => {\n    return settings[key];\n  };\n\n  const contextValue: SettingsContextValue = {\n    settings,\n    isLoading,\n    error,\n    updateSetting,\n    updateSettings,\n    resetToDefaults,\n    exportSettings,\n    importSettings,\n    getSetting,\n  };\n\n  return (\n    <SettingsContext.Provider value={contextValue}>\n      {children}\n    </SettingsContext.Provider>\n  );\n};\n\nexport const useSettings = (): SettingsContextValue => {\n  const context = useContext(SettingsContext);\n  if (context === undefined) {\n    throw new Error('useSettings must be used within a SettingsProvider');\n  }\n  return context;\n};\n\nexport default SettingsContext; ","import React from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  TouchableOpacity,\n  ViewStyle,\n  TextStyle,\n} from 'react-native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { useAppTheme } from '../../contexts/ThemeContext';\nimport { AppTheme } from '../../config/theme';\nimport hapticService from '../../services/hapticService';\n\ninterface SettingsRowProps {\n  title: string;\n  subtitle?: string;\n  leftIcon?: keyof typeof Ionicons.glyphMap;\n  leftIconColor?: string;\n  rightElement?: React.ReactNode;\n  onPress?: () => void;\n  disabled?: boolean;\n  style?: ViewStyle;\n  showChevron?: boolean;\n  testID?: string;\n}\n\nconst SettingsRow: React.FC<SettingsRowProps> = ({\n  title,\n  subtitle,\n  leftIcon,\n  leftIconColor,\n  rightElement,\n  onPress,\n  disabled = false,\n  style,\n  showChevron = false,\n  testID,\n}) => {\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n\n  const handlePress = () => {\n    if (!disabled && onPress) {\n      hapticService.selection(); // Light haptic feedback for settings interactions\n      onPress();\n    }\n  };\n\n  const isInteractive = !!onPress && !disabled;\n\n  return (\n    <TouchableOpacity\n      style={[\n        styles.container,\n        disabled && styles.containerDisabled,\n        !isInteractive && styles.containerNonInteractive,\n        style,\n      ]}\n      onPress={handlePress}\n      disabled={!isInteractive}\n      activeOpacity={isInteractive ? 0.7 : 1}\n      testID={testID}\n      accessibilityRole={isInteractive ? 'button' : 'text'}\n      accessibilityLabel={subtitle ? `${title}, ${subtitle}` : title}\n      accessibilityHint={isInteractive ? 'Tap to modify this setting' : undefined}\n    >\n      <View style={styles.leftSection}>\n        {leftIcon && (\n          <View style={styles.iconContainer}>\n            <Ionicons\n              name={leftIcon}\n              size={22}\n              color={disabled ? theme.colors.disabled : (leftIconColor || theme.colors.primary)}\n            />\n          </View>\n        )}\n        \n        <View style={styles.textContainer}>\n          <Text \n            style={[\n              styles.title,\n              disabled && styles.titleDisabled,\n            ]}\n          >\n            {title}\n          </Text>\n          \n          {subtitle && (\n            <Text \n              style={[\n                styles.subtitle,\n                disabled && styles.subtitleDisabled,\n              ]}\n            >\n              {subtitle}\n            </Text>\n          )}\n        </View>\n      </View>\n\n      <View style={styles.rightSection}>\n        {rightElement}\n        \n        {showChevron && isInteractive && (\n          <View style={styles.chevronContainer}>\n            <Ionicons\n              name=\"chevron-forward\"\n              size={20}\n              color={disabled ? theme.colors.disabled : theme.colors.textSecondary}\n            />\n          </View>\n        )}\n      </View>\n    </TouchableOpacity>\n  );\n};\n\nconst getStyles = (theme: AppTheme) => StyleSheet.create({\n  container: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    paddingVertical: theme.spacing.md,\n    paddingHorizontal: theme.spacing.lg,\n    backgroundColor: theme.colors.card,\n    borderBottomWidth: 1,\n    borderBottomColor: theme.colors.border,\n    minHeight: 64,\n  },\n  containerDisabled: {\n    opacity: 0.6,\n  },\n  containerNonInteractive: {\n    // No special styling for non-interactive rows\n  },\n  leftSection: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    flex: 1,\n  },\n  iconContainer: {\n    width: 40,\n    height: 40,\n    borderRadius: theme.borderRadius.lg,\n    backgroundColor: theme.colors.primaryLight + '20',\n    justifyContent: 'center',\n    alignItems: 'center',\n    marginRight: theme.spacing.md,\n  },\n  textContainer: {\n    flex: 1,\n  },\n  title: {\n    fontSize: theme.typography.fontSizes.md,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n    color: theme.colors.text,\n    marginBottom: theme.spacing.xs,\n  },\n  titleDisabled: {\n    color: theme.colors.textSecondary,\n  },\n  subtitle: {\n    fontSize: theme.typography.fontSizes.sm,\n    fontFamily: theme.typography.fontFamilies.regular,\n    color: theme.colors.textSecondary,\n    lineHeight: 18,\n  },\n  subtitleDisabled: {\n    color: theme.colors.border,\n  },\n  rightSection: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginLeft: theme.spacing.md,\n  },\n  chevronContainer: {\n    marginLeft: theme.spacing.sm,\n  },\n});\n\nexport default SettingsRow; ","import React from 'react';\nimport { Switch, ViewStyle } from 'react-native';\nimport { useAppTheme } from '../../contexts/ThemeContext';\nimport SettingsRow from './SettingsRow';\nimport { Ionicons } from '@expo/vector-icons';\n\ninterface SettingsToggleProps {\n  title: string;\n  subtitle?: string;\n  leftIcon?: keyof typeof Ionicons.glyphMap;\n  value: boolean;\n  onValueChange: (value: boolean) => void;\n  disabled?: boolean;\n  style?: ViewStyle;\n  testID?: string;\n}\n\nconst SettingsToggle: React.FC<SettingsToggleProps> = ({\n  title,\n  subtitle,\n  leftIcon,\n  value,\n  onValueChange,\n  disabled = false,\n  style,\n  testID,\n}) => {\n  const { theme } = useAppTheme();\n\n  const handleToggle = () => {\n    if (!disabled) {\n      onValueChange(!value);\n    }\n  };\n\n  const switchElement = (\n    <Switch\n      trackColor={{ \n        false: theme.colors.gray300, \n        true: theme.colors.primary + '80' \n      }}\n      thumbColor={value ? theme.colors.primary : theme.colors.gray100}\n      ios_backgroundColor={theme.colors.gray300}\n      onValueChange={onValueChange}\n      value={value}\n      disabled={disabled}\n      accessibilityLabel={`${title} toggle`}\n      accessibilityRole=\"switch\"\n      accessibilityState={{ checked: value }}\n    />\n  );\n\n  return (\n    <SettingsRow\n      title={title}\n      subtitle={subtitle}\n      leftIcon={leftIcon}\n      rightElement={switchElement}\n      onPress={handleToggle}\n      disabled={disabled}\n      style={style}\n      testID={testID}\n    />\n  );\n};\n\nexport default SettingsToggle; ","import React, { useState } from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  ViewStyle,\n  Modal,\n  TouchableOpacity,\n  FlatList,\n} from 'react-native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { useAppTheme } from '../../contexts/ThemeContext';\nimport { AppTheme } from '../../config/theme';\nimport SettingsRow from './SettingsRow';\n\nexport interface SettingsOption {\n  value: string;\n  label: string;\n  subtitle?: string;\n  disabled?: boolean;\n}\n\ninterface SettingsSelectorProps {\n  title: string;\n  subtitle?: string;\n  leftIcon?: keyof typeof Ionicons.glyphMap;\n  options: SettingsOption[];\n  selectedValue: string;\n  onValueChange: (value: string) => void;\n  disabled?: boolean;\n  style?: ViewStyle;\n  testID?: string;\n  placeholder?: string;\n}\n\nconst SettingsSelector: React.FC<SettingsSelectorProps> = ({\n  title,\n  subtitle,\n  leftIcon,\n  options,\n  selectedValue,\n  onValueChange,\n  disabled = false,\n  style,\n  testID,\n  placeholder = 'Select an option',\n}) => {\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n  const [isModalVisible, setIsModalVisible] = useState(false);\n\n  const selectedOption = options.find(option => option.value === selectedValue);\n  const displayText = selectedOption?.label || placeholder;\n\n  const handleOptionSelect = (value: string) => {\n    onValueChange(value);\n    setIsModalVisible(false);\n  };\n\n  const handlePress = () => {\n    if (!disabled) {\n      setIsModalVisible(true);\n    }\n  };\n\n  const rightElement = (\n    <View style={styles.rightContainer}>\n      <Text \n        style={[\n          styles.selectedText,\n          disabled && styles.selectedTextDisabled,\n          !selectedOption && styles.placeholderText,\n        ]}\n      >\n        {displayText}\n      </Text>\n    </View>\n  );\n\n  const renderOption = ({ item }: { item: SettingsOption }) => (\n    <TouchableOpacity\n      style={[\n        styles.optionItem,\n        item.value === selectedValue && styles.selectedOptionItem,\n        item.disabled && styles.optionItemDisabled,\n      ]}\n      onPress={() => handleOptionSelect(item.value)}\n      disabled={item.disabled}\n      accessibilityRole=\"button\"\n      accessibilityLabel={item.label}\n      accessibilityState={{ selected: item.value === selectedValue }}\n    >\n      <View style={styles.optionContent}>\n        <Text \n          style={[\n            styles.optionLabel,\n            item.value === selectedValue && styles.selectedOptionLabel,\n            item.disabled && styles.optionLabelDisabled,\n          ]}\n        >\n          {item.label}\n        </Text>\n        \n        {item.subtitle && (\n          <Text \n            style={[\n              styles.optionSubtitle,\n              item.disabled && styles.optionSubtitleDisabled,\n            ]}\n          >\n            {item.subtitle}\n          </Text>\n        )}\n      </View>\n      \n      {item.value === selectedValue && (\n        <Ionicons \n          name=\"checkmark-circle\" \n          size={24} \n          color={theme.colors.primary} \n        />\n      )}\n    </TouchableOpacity>\n  );\n\n  return (\n    <>\n      <SettingsRow\n        title={title}\n        subtitle={subtitle}\n        leftIcon={leftIcon}\n        rightElement={rightElement}\n        onPress={handlePress}\n        disabled={disabled}\n        style={style}\n        showChevron={true}\n        testID={testID}\n      />\n\n      <Modal\n        visible={isModalVisible}\n        animationType=\"slide\"\n        presentationStyle=\"pageSheet\"\n        onRequestClose={() => setIsModalVisible(false)}\n      >\n        <View style={styles.modalContainer}>\n          {/* Modal Header */}\n          <View style={styles.modalHeader}>\n            <View style={styles.headerLeft} />\n            \n            <Text style={styles.modalTitle}>{title}</Text>\n            \n            <TouchableOpacity\n              style={styles.headerButton}\n              onPress={() => setIsModalVisible(false)}\n              accessibilityLabel=\"Close\"\n              accessibilityRole=\"button\"\n            >\n              <Text style={styles.doneButtonText}>Done</Text>\n            </TouchableOpacity>\n          </View>\n\n          {/* Options List */}\n          <FlatList\n            data={options}\n            keyExtractor={(item) => item.value}\n            renderItem={renderOption}\n            style={styles.optionsList}\n            showsVerticalScrollIndicator={true}\n            bounces={true}\n          />\n        </View>\n      </Modal>\n    </>\n  );\n};\n\nconst getStyles = (theme: AppTheme) => StyleSheet.create({\n  rightContainer: {\n    alignItems: 'flex-end',\n  },\n  selectedText: {\n    fontSize: theme.typography.fontSizes.md,\n    fontFamily: theme.typography.fontFamilies.regular,\n    color: theme.colors.textSecondary,\n    textAlign: 'right',\n  },\n  selectedTextDisabled: {\n    color: theme.colors.disabled,\n  },\n  placeholderText: {\n    fontStyle: 'italic',\n    color: theme.colors.textDisabled,\n  },\n  modalContainer: {\n    flex: 1,\n    backgroundColor: theme.colors.background,\n  },\n  modalHeader: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: theme.spacing.lg,\n    paddingVertical: theme.spacing.md,\n    borderBottomWidth: 1,\n    borderBottomColor: theme.colors.border,\n    backgroundColor: theme.colors.card,\n  },\n  headerLeft: {\n    width: 60, // Balance the header\n  },\n  modalTitle: {\n    fontSize: theme.typography.fontSizes.lg,\n    fontFamily: theme.typography.fontFamilies.bold,\n    color: theme.colors.text,\n    textAlign: 'center',\n  },\n  headerButton: {\n    width: 60,\n    alignItems: 'flex-end',\n  },\n  doneButtonText: {\n    fontSize: theme.typography.fontSizes.md,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n    color: theme.colors.primary,\n  },\n  optionsList: {\n    flex: 1,\n  },\n  optionItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingVertical: theme.spacing.lg,\n    paddingHorizontal: theme.spacing.lg,\n    backgroundColor: theme.colors.card,\n    borderBottomWidth: 1,\n    borderBottomColor: theme.colors.border,\n    minHeight: 64,\n  },\n  selectedOptionItem: {\n    backgroundColor: theme.colors.primaryLight + '20',\n  },\n  optionItemDisabled: {\n    opacity: 0.5,\n  },\n  optionContent: {\n    flex: 1,\n  },\n  optionLabel: {\n    fontSize: theme.typography.fontSizes.md,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n    color: theme.colors.text,\n  },\n  selectedOptionLabel: {\n    color: theme.colors.primary,\n  },\n  optionLabelDisabled: {\n    color: theme.colors.disabled,\n  },\n  optionSubtitle: {\n    fontSize: theme.typography.fontSizes.sm,\n    fontFamily: theme.typography.fontFamilies.regular,\n    color: theme.colors.textSecondary,\n    marginTop: theme.spacing.xs,\n  },\n  optionSubtitleDisabled: {\n    color: theme.colors.disabled,\n  },\n});\n\nexport default SettingsSelector; ","import React, { useState } from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  TouchableOpacity,\n  Animated,\n  LayoutAnimation,\n  Platform,\n} from 'react-native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { useAppTheme } from '../../contexts/ThemeContext';\nimport { AppTheme } from '../../config/theme';\n\ninterface SettingsSectionProps {\n  title: string;\n  subtitle?: string;\n  icon?: keyof typeof Ionicons.glyphMap;\n  children: React.ReactNode;\n  collapsible?: boolean;\n  initiallyExpanded?: boolean;\n  headerAction?: React.ReactNode;\n}\n\nconst SettingsSection: React.FC<SettingsSectionProps> = ({\n  title,\n  subtitle,\n  icon,\n  children,\n  collapsible = false,\n  initiallyExpanded = true,\n  headerAction,\n}) => {\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n  const [isExpanded, setIsExpanded] = useState(initiallyExpanded);\n\n  const toggleExpanded = () => {\n    if (collapsible) {\n      // Use LayoutAnimation for smooth collapse/expand\n      if (Platform.OS !== 'web') {\n        LayoutAnimation.configureNext({\n          duration: 300,\n          create: { type: 'easeInEaseOut', property: 'opacity' },\n          update: { type: 'easeInEaseOut' },\n          delete: { type: 'easeInEaseOut', property: 'opacity' },\n        });\n      }\n      setIsExpanded(!isExpanded);\n    }\n  };\n\n  return (\n    <View style={styles.container}>\n      <View style={styles.header}>\n        {icon && (\n          <Ionicons name={icon} size={20} color={theme.colors.textSecondary} style={styles.headerIcon} />\n        )}\n        <View style={styles.titleContainer}>\n          <Text style={styles.title}>{title}</Text>\n          {subtitle && <Text style={styles.subtitle}>{subtitle}</Text>}\n        </View>\n        {headerAction && (\n          <View style={styles.headerAction}>\n            {headerAction}\n          </View>\n        )}\n      </View>\n      <View style={styles.childrenContainer}>{children}</View>\n    </View>\n  );\n};\n\nconst getStyles = (theme: AppTheme) =>\n  StyleSheet.create({\n    container: {\n      marginVertical: theme.spacing.sm,\n      marginHorizontal: theme.spacing.md,\n      backgroundColor: theme.colors.card,\n      borderRadius: theme.borderRadius.lg,\n      overflow: 'hidden',\n      ...theme.shadows.sm,\n    },\n    header: {\n      flexDirection: 'row',\n      alignItems: 'center',\n      paddingVertical: theme.spacing.sm,\n      paddingHorizontal: theme.spacing.md,\n      backgroundColor: theme.colors.card,\n      borderBottomWidth: 1,\n      borderBottomColor: theme.colors.border,\n    },\n    headerTouchable: {\n      flexDirection: 'row',\n      alignItems: 'center',\n      flex: 1,\n    },\n    headerIcon: {\n      marginRight: theme.spacing.md,\n    },\n    titleContainer: {\n      flex: 1,\n    },\n    title: {\n      fontSize: theme.typography.fontSizes.lg,\n      fontFamily: theme.typography.fontFamilies.bold,\n      color: theme.colors.text,\n    },\n    headerAction: {\n      marginLeft: theme.spacing.md,\n    },\n    subtitle: {\n      fontSize: theme.typography.fontSizes.sm,\n      color: theme.colors.textSecondary,\n      marginLeft: theme.spacing.sm,\n      padding: theme.spacing.xs,\n    },\n    childrenContainer: {\n      paddingHorizontal: theme.spacing.md,\n      paddingBottom: theme.spacing.md,\n    },\n    iconContainer: {\n      width: 40,\n      height: 40,\n      borderRadius: theme.borderRadius.md,\n      backgroundColor: theme.colors.primaryLight + '20',\n      justifyContent: 'center',\n      alignItems: 'center',\n      marginRight: theme.spacing.md,\n    },\n    content: {\n      paddingHorizontal: theme.spacing.md,\n      paddingBottom: theme.spacing.sm,\n      backgroundColor: theme.colors.card,\n    },\n  });\n\nexport default SettingsSection; ","import React, { useState, useEffect } from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  TouchableOpacity,\n  Alert,\n  Switch,\n  ActivityIndicator,\n  RefreshControl,\n  Animated,\n} from 'react-native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { useNavigation } from '@react-navigation/native';\nimport { CompositeNavigationProp } from '@react-navigation/native';\nimport { BottomTabNavigationProp } from '@react-navigation/bottom-tabs';\nimport { StackNavigationProp } from '@react-navigation/stack';\n\nimport { useAuth } from '../../contexts/AuthContext';\nimport { useAppTheme } from '../../contexts/ThemeContext';\nimport { useSettings } from '../../contexts/SettingsContext';\nimport { AppTheme } from '../../config/theme';\nimport { MainStackParamList, MainTabParamList } from '../../navigation/types';\nimport { SUPPORTED_LANGUAGES } from '../../config/languageConfig';\nimport logger from '../../utils/logger';\nimport SafeScrollView from '../../components/SafeScrollView';\nimport { SettingsSkeleton } from '../../components/SkeletonLoader';\nimport ScreenHeader from '../../components/ScreenHeader';\n\n// Settings components\nimport SettingsRow from '../../components/settings/SettingsRow';\nimport SettingsToggle from '../../components/settings/SettingsToggle';\nimport SettingsSelector from '../../components/settings/SettingsSelector';\nimport SettingsSection from '../../components/settings/SettingsSection';\n\ninterface SettingsOption {\n  value: string;\n  label: string;\n  subtitle?: string;\n}\n\ntype SettingsScreenNavigationProp = CompositeNavigationProp<\n  BottomTabNavigationProp<MainTabParamList, 'Settings'>,\n  StackNavigationProp<MainStackParamList>\n>;\n\nconst SettingsScreen: React.FC = () => {\n  const navigation = useNavigation<SettingsScreenNavigationProp>();\n  const { user, logout } = useAuth();\n  const { theme, toggleTheme, isSystemTheme, setUseSystemTheme } = useAppTheme();\n  const { settings, updateSetting, isLoading } = useSettings();\n  const styles = getStyles(theme);\n  const [isRefreshing, setIsRefreshing] = useState(false);\n  \n  // Scroll to top functionality\n  const scrollViewRef = React.useRef<any>(null);\n  const [showScrollToTop, setShowScrollToTop] = useState(false);\n  const scrollToTopOpacity = React.useRef(new Animated.Value(0)).current;\n  \n  const handleScroll = (event: any) => {\n    const scrollY = event.nativeEvent.contentOffset.y;\n    const shouldShow = scrollY > 200;\n    \n    if (shouldShow !== showScrollToTop) {\n      setShowScrollToTop(shouldShow);\n      Animated.timing(scrollToTopOpacity, {\n        toValue: shouldShow ? 1 : 0,\n        duration: 200,\n        useNativeDriver: false, // Changed to false for web compatibility\n      }).start();\n    }\n  };\n  \n  const scrollToTop = () => {\n    scrollViewRef.current?.scrollTo({ y: 0, animated: true });\n  };\n\n  // Loading state\n  if (isLoading) {\n    return (\n      <View style={styles.container}>\n        <SettingsSkeleton />\n      </View>\n    );\n  }\n\n  // Language options for selector\n  const languageOptions: SettingsOption[] = SUPPORTED_LANGUAGES.map(lang => ({\n    value: lang.code,\n    label: lang.name,\n    subtitle: lang.region ? `${lang.region}` : undefined,\n  }));\n\n  const handleSignOut = async () => {\n    // For web platform, use window.confirm instead of Alert.alert\n    const confirmed = window.confirm('Are you sure you want to sign out?');\n    \n    if (confirmed) {\n      try {\n        logger.info('[SettingsScreen] User confirmed sign out');\n        await logout();\n        logger.info('[SettingsScreen] User signed out successfully');\n      } catch (error) {\n        logger.error('[SettingsScreen] Error during sign out:', error);\n        window.alert('Failed to sign out. Please try again.');\n      }\n    }\n  };\n\n  // Handle pull-to-refresh\n  const onRefresh = React.useCallback(() => {\n    setIsRefreshing(true);\n    // Simulate refresh by resetting the refresh state\n    setTimeout(() => {\n      setIsRefreshing(false);\n    }, 1000);\n  }, []);\n\n  return (\n    <View style={styles.container}>\n      <ScreenHeader title=\"Settings\" />\n      <SafeScrollView \n        ref={scrollViewRef}\n        style={styles.container} \n        contentContainerStyle={styles.scrollContent}\n        showsVerticalScrollIndicator={false}\n        onScroll={handleScroll}\n        scrollEventThrottle={16}\n        refreshControl={\n          <RefreshControl\n            refreshing={isRefreshing}\n            onRefresh={onRefresh}\n            colors={[theme.colors.primary]}\n            tintColor={theme.colors.primary}\n          />\n        }\n      >\n      {/* Profile Section */}\n      <SettingsSection\n        title=\"Profile\"\n        icon=\"person\"\n      >\n        <SettingsRow\n          title=\"Account\"\n          subtitle={user?.email || 'No email available'}\n          leftIcon=\"mail\"\n          rightElement={\n            <View style={styles.profileBadge}>\n              <Text style={styles.profileBadgeText}>\n                {user?.email?.charAt(0).toUpperCase() || 'U'}\n              </Text>\n            </View>\n          }\n        />\n\n        <SettingsRow\n          title=\"Sign Out\"\n          subtitle=\"Sign out of your account\"\n          leftIcon=\"log-out\"\n          onPress={handleSignOut}\n          showChevron={true}\n        />\n      </SettingsSection>\n\n      {/* Language & Transcription Section */}\n      <SettingsSection\n        title=\"Language & Transcription\"\n        icon=\"language\"\n      >\n        <SettingsSelector\n          title=\"Default Language\"\n          subtitle=\"Language for voice transcription\"\n          leftIcon=\"globe\"\n          options={languageOptions}\n          selectedValue={settings.defaultLanguage}\n          onValueChange={(value) => updateSetting('defaultLanguage', value)}\n        />\n      </SettingsSection>\n\n      {/* Privacy & Security Section */}\n      <SettingsSection\n        title=\"Privacy & Security\"\n        icon=\"shield-checkmark\"\n      >\n        <SettingsRow\n          title=\"Tags\"\n          subtitle=\"Manage regular and privacy tags\"\n          leftIcon=\"pricetag\"\n          onPress={() => navigation.navigate('TagManagement')}\n          showChevron={true}\n        />\n\n        <SettingsToggle\n          title=\"Analytics\"\n          subtitle=\"Help improve the app\"\n          leftIcon=\"analytics\"\n          value={settings.analyticsEnabled}\n          onValueChange={(value) => updateSetting('analyticsEnabled', value)}\n        />\n\n        <SettingsToggle\n          title=\"Crash Reports\"\n          subtitle=\"Send crash reports to developers\"\n          leftIcon=\"bug\"\n          value={settings.crashReportsEnabled}\n          onValueChange={(value) => updateSetting('crashReportsEnabled', value)}\n        />\n      </SettingsSection>\n\n      {/* App Settings Section */}\n      <SettingsSection\n        title=\"App Settings\"\n        icon=\"settings\"\n      >\n        <SettingsToggle\n          title=\"Dark Mode\"\n          subtitle={isSystemTheme ? \"Following system setting\" : \"Manual override\"}\n          leftIcon=\"moon\"\n          value={theme.isDarkMode}\n          onValueChange={() => {\n            if (isSystemTheme) setUseSystemTheme(false);\n            toggleTheme();\n          }}\n          disabled={isSystemTheme}\n        />\n        \n        <SettingsToggle\n          title=\"Use System Theme\"\n          subtitle=\"Follow device theme setting\"\n          leftIcon=\"phone-portrait\"\n          value={isSystemTheme}\n          onValueChange={setUseSystemTheme}\n        />\n\n        <SettingsToggle\n          title=\"Haptic Feedback\"\n          subtitle=\"Enable subtle vibrations for interactions\"\n          leftIcon=\"pulse-outline\"\n          value={settings.hapticFeedbackEnabled}\n          onValueChange={(value) =>\n            updateSetting('hapticFeedbackEnabled', value)\n          }\n        />\n        \n        <SettingsToggle\n          title=\"Auto-Save Entry\"\n          subtitle=\"Automatically save during recording\"\n          leftIcon=\"save-outline\"\n          value={settings.autoSaveEnabled}\n          onValueChange={(value) =>\n            updateSetting('autoSaveEnabled', value)\n          }\n        />\n        \n        <SettingsToggle\n          title=\"Auto-Start Recording\"\n          subtitle=\"Automatically start recording when opening record screen\"\n          leftIcon=\"mic-outline\"\n          value={settings.autoRecordingEnabled}\n          onValueChange={(value) =>\n            updateSetting('autoRecordingEnabled', value)\n          }\n        />\n      </SettingsSection>\n\n      {/* Notifications Section */}\n      <SettingsSection\n        title=\"Notifications\"\n        icon=\"notifications\"\n      >\n        <SettingsToggle\n          title=\"Push Notifications\"\n          subtitle=\"Receive app notifications\"\n          leftIcon=\"notifications\"\n          value={settings.notificationsEnabled}\n          onValueChange={(value) => updateSetting('notificationsEnabled', value)}\n        />\n\n        <SettingsToggle\n          title=\"Daily Reminders\"\n          subtitle=\"Reminder to write in your journal\"\n          leftIcon=\"time\"\n          value={settings.reminderNotifications}\n          onValueChange={(value) => updateSetting('reminderNotifications', value)}\n        />\n\n        {settings.reminderNotifications && (\n          <SettingsRow\n            title=\"Reminder Time\"\n            subtitle={`Daily reminder at ${settings.dailyReminderTime}`}\n            leftIcon=\"alarm\"\n            rightElement={\n              <Text style={styles.timeText}>{settings.dailyReminderTime}</Text>\n            }\n            onPress={() => {\n              // TODO: Implement time picker\n              Alert.alert('Coming Soon', 'Time picker will be available in a future update.');\n            }}\n            showChevron={true}\n          />\n        )}\n      </SettingsSection>\n\n      {/* About Section */}\n      <SettingsSection\n        title=\"About\"\n        icon=\"information-circle\"\n      >\n        <SettingsRow\n          title=\"Version\"\n          subtitle=\"Current app version\"\n          leftIcon=\"code-working\"\n          rightElement={\n            <Text style={styles.versionText}>1.0.0</Text>\n          }\n        />\n\n        <SettingsRow\n          title=\"Privacy Policy\"\n          subtitle=\"View our privacy policy\"\n          leftIcon=\"document-text\"\n          onPress={() => {\n            Alert.alert('Privacy Policy', 'Privacy policy will be available soon.');\n          }}\n          showChevron={true}\n        />\n\n        <SettingsRow\n          title=\"Terms of Service\"\n          subtitle=\"View terms and conditions\"\n          leftIcon=\"document\"\n          onPress={() => {\n            Alert.alert('Terms of Service', 'Terms of service will be available soon.');\n          }}\n          showChevron={true}\n        />\n      </SettingsSection>\n\n      {/* Bottom spacing */}\n      <View style={styles.bottomSpacing} />\n    </SafeScrollView>\n    \n    {/* Scroll to top button */}\n    <Animated.View \n      style={[\n        styles.scrollToTopButton,\n        {\n          opacity: scrollToTopOpacity,\n          transform: [{\n            scale: scrollToTopOpacity.interpolate({\n              inputRange: [0, 1],\n              outputRange: [0.8, 1],\n            })\n          }]\n        }\n      ]}\n      pointerEvents={showScrollToTop ? 'auto' : 'none'}\n    >\n      <TouchableOpacity\n        style={styles.scrollToTopButtonInner}\n        onPress={scrollToTop}\n        activeOpacity={0.7}\n      >\n        <Ionicons name=\"chevron-up\" size={24} color={theme.colors.background} />\n      </TouchableOpacity>\n    </Animated.View>\n  </View>\n  );\n};\n\nconst getStyles = (theme: AppTheme) => StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: theme.colors.background,\n  },\n  scrollContent: {\n    paddingBottom: 100,\n  },\n  centerContent: {\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  loadingText: {\n    marginTop: theme.spacing.md,\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: theme.spacing.lg,\n    paddingTop: theme.spacing.xl,\n    paddingBottom: theme.spacing.lg,\n    borderBottomWidth: 1,\n    borderBottomColor: theme.colors.border,\n  },\n  backButton: {\n    width: 40,\n    height: 40,\n    borderRadius: 20,\n    backgroundColor: theme.colors.card,\n    justifyContent: 'center',\n    alignItems: 'center',\n    ...theme.shadows.sm,\n  },\n  headerTitle: {\n    fontSize: theme.typography.fontSizes.xl,\n    fontWeight: 'bold',\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.bold,\n  },\n  headerSpacer: {\n    width: 40,\n  },\n  profileBadge: {\n    width: 36,\n    height: 36,\n    borderRadius: 18,\n    backgroundColor: theme.colors.primary,\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  profileBadgeText: {\n    fontSize: theme.typography.fontSizes.md,\n    fontWeight: 'bold',\n    color: theme.colors.background,\n    fontFamily: theme.typography.fontFamilies.bold,\n  },\n  statusText: {\n    fontSize: theme.typography.fontSizes.sm,\n    fontFamily: theme.typography.fontFamilies.medium,\n  },\n  timeText: {\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  versionText: {\n    fontSize: theme.typography.fontSizes.sm,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  bottomSpacing: {\n    height: theme.spacing.xxxl,\n  },\n  scrollToTopButton: {\n    position: 'absolute',\n    bottom: 30,\n    right: 20,\n    zIndex: 1000,\n  },\n  scrollToTopButtonInner: {\n    width: 50,\n    height: 50,\n    borderRadius: 25,\n    backgroundColor: theme.colors.primary,\n    justifyContent: 'center',\n    alignItems: 'center',\n    ...theme.shadows.lg,\n  },\n});\n\nexport default SettingsScreen; ","import React, { useEffect, useCallback } from 'react';\nimport { createBottomTabNavigator } from '@react-navigation/bottom-tabs';\nimport { createStackNavigator } from '@react-navigation/stack';\nimport { Ionicons } from '@expo/vector-icons';\nimport { View, StyleSheet, Platform } from 'react-native';\nimport { StackNavigationProp } from '@react-navigation/stack';\nimport { useAppTheme } from '../contexts/ThemeContext';\nimport { AppTheme } from '../config/theme';\nimport { MainTabParamList, MainStackParamList } from './types';\nimport logger from '../utils/logger';\nimport audioPrewarmService from '../services/audioPrewarmService';\n\n// Import our modern FloatingActionButton\nimport FloatingActionButton from '../components/FloatingActionButton';\n\nimport HomeScreen from '../screens/main/HomeScreen';\nimport JournalScreen from '../screens/main/JournalScreen';\nimport CalendarScreen from '../screens/main/CalendarScreen';\nimport SettingsScreen from '../screens/main/SettingsScreen';\n\nconst Tab = createBottomTabNavigator<MainTabParamList>();\n\ntype MainTabNavigatorProps = {\n  navigation: StackNavigationProp<MainStackParamList, 'MainTabs'>;\n};\n\n\n\nconst MainTabNavigator = ({ navigation }: MainTabNavigatorProps) => {\n  const { theme } = useAppTheme();\n  const styles = getNavigatorStyles(theme);\n\n  // Pre-warm audio system when MainTabNavigator mounts\n  useEffect(() => {\n    const prewarmAudio = async () => {\n      try {\n        logger.info('[MainTabNavigator] Starting audio system prewarm...');\n        await audioPrewarmService.prewarmAudioSystem();\n        \n        const metrics = audioPrewarmService.getPerformanceMetrics();\n        logger.info('[MainTabNavigator] Audio prewarm completed:', metrics);\n      } catch (error) {\n        logger.error('[MainTabNavigator] Audio prewarm failed:', error);\n      }\n    };\n\n    prewarmAudio();\n\n    // Cleanup on unmount\n    return () => {\n      audioPrewarmService.cleanup();\n    };\n  }, []);\n\n  const handleRecordPress = useCallback(() => {\n    logger.info('[MainTabNavigator] FloatingActionButton pressed. Navigating to Record screen.');\n    \n    // Check if audio system is ready\n    const isReady = audioPrewarmService.isReadyForRecording();\n    if (!isReady) {\n      logger.warn('[MainTabNavigator] Audio system not ready, attempting to prewarm...');\n      audioPrewarmService.prewarmAudioSystem().catch(error => {\n        logger.error('[MainTabNavigator] Failed to prewarm audio system:', error);\n      });\n    }\n    \n    // Navigate to the Record screen using the navigation prop from the parent StackNavigator\n    navigation.navigate('Record');\n  }, [navigation]);\n\n  return (\n    <View style={styles.container}>\n      <Tab.Navigator\n        screenOptions={({ route }) => ({\n          headerShown: false,\n          tabBarActiveTintColor: theme.colors.tabBarActive,\n          tabBarInactiveTintColor: theme.colors.tabBarInactive,\n          tabBarStyle: styles.tabBarStyle,\n          tabBarLabelStyle: styles.tabBarLabelStyle,\n          tabBarItemStyle: styles.tabBarItemStyle,\n          tabBarIcon: ({ focused, color, size }) => {\n            let iconName: keyof typeof Ionicons.glyphMap | undefined;\n            if (route.name === 'Home') iconName = focused ? 'home' : 'home-outline';\n            else if (route.name === 'Journal') iconName = focused ? 'book' : 'book-outline';\n            else if (route.name === 'Calendar') iconName = focused ? 'calendar' : 'calendar-outline';\n            else if (route.name === 'Settings') iconName = focused ? 'cog' : 'cog-outline';\n\n            if (!iconName) return <View style={{width:size, height:size}}/>;\n            return <Ionicons name={iconName} size={focused ? size + 2 : size} color={color} />;\n          },\n        })}\n      >\n        <Tab.Screen name=\"Home\" component={HomeScreen} options={{ tabBarLabel: 'Home'}} />\n        <Tab.Screen name=\"Journal\" component={JournalScreen} options={{ tabBarLabel: 'Journal'}} />\n        <Tab.Screen name=\"Calendar\" component={CalendarScreen} options={{ tabBarLabel: 'Calendar'}} />\n        <Tab.Screen name=\"Settings\" component={SettingsScreen} options={{ tabBarLabel: 'Settings'}}/>\n      </Tab.Navigator>\n      \n      {/* Floating Action Button positioned over the tab bar */}\n      <View style={styles.fabContainer}>\n        <FloatingActionButton\n          onPress={handleRecordPress}\n          icon=\"mic\"\n          size={64}\n          variant=\"primary\"\n          testID=\"main-record-button\"\n        />\n      </View>\n    </View>\n  );\n};\n\nconst getNavigatorStyles = (theme: AppTheme) => StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  tabBarStyle: {\n    backgroundColor: theme.colors.card,\n    borderTopColor: theme.colors.borderLight,\n    borderTopWidth: 1,\n    height: Platform.OS === 'ios' ? 88 : 75,\n    paddingBottom: Platform.OS === 'ios' ? 24 : 8,\n    paddingTop: 8,\n    paddingHorizontal: theme.spacing.sm,\n    ...theme.shadows.lg,\n    // Modern floating tab bar effect\n    marginHorizontal: theme.spacing.md,\n    marginBottom: Platform.OS === 'ios' ? theme.spacing.lg : theme.spacing.md,\n    borderRadius: theme.borderRadius.xl,\n    position: 'absolute',\n    left: 0,\n    right: 0,\n    bottom: 0,\n  },\n  tabBarLabelStyle: {\n    fontSize: theme.typography.fontSizes.xs,\n    fontFamily: theme.typography.fontFamilies.medium,\n    marginBottom: Platform.OS === 'ios' ? 0 : theme.spacing.xs,\n    marginTop: theme.spacing.xs,\n  },\n  tabBarItemStyle: {\n    paddingVertical: theme.spacing.xs,\n    borderRadius: theme.borderRadius.md,\n  },\n  fabContainer: {\n    position: 'absolute',\n    bottom: Platform.OS === 'ios' ? 100 : 85, // Position above tab bar\n    alignSelf: 'center',\n    zIndex: 1000,\n  },\n});\n\nexport default MainTabNavigator; ","/**\n * Feature Flags Configuration\n * \n * Central location for controlling app features during development and deployment.\n * This allows us to disable features temporarily while preserving code for future releases.\n */\n\nexport interface FeatureFlags {\n  // Secret Tags Features\n  ENABLE_OFFLINE_SECRET_TAGS: boolean;\n  ENABLE_SECRET_TAG_CACHING: boolean;\n  ENABLE_SECURITY_MODE_SWITCHING: boolean;\n  ENABLE_BORDER_CROSSING_MODE: boolean;\n  // Global kill-switch for all secret-tag UI & detection paths\n  ENABLE_SECRET_TAGS: boolean;\n  \n  // Future features can be added here\n  ENABLE_TEAM_COLLABORATION: boolean;\n  ENABLE_CLOUD_BACKUP: boolean;\n}\n\n/**\n * Current feature flag configuration for production deployment\n * \n * TEMPORARILY DISABLED FOR INITIAL LAUNCH:\n * - Offline secret tags functionality\n * - Security mode switching \n * - Border crossing data clearing\n * \n * These features are fully implemented and tested, but disabled to simplify\n * the initial user experience and reduce complexity for the first release.\n * \n * To re-enable offline features for future releases, change the relevant\n * flags to true and the system will seamlessly restore full functionality.\n */\nexport const FEATURE_FLAGS: FeatureFlags = {\n  // Global kill-switch (default OFF for Kotori)\n  ENABLE_SECRET_TAGS: false,\n  // Secret Tags - TEMPORARILY DISABLED FOR LAUNCH SIMPLIFICATION\n  ENABLE_OFFLINE_SECRET_TAGS: false,        // Disable offline caching\n  ENABLE_SECRET_TAG_CACHING: false,         // Disable local storage of tags\n  ENABLE_SECURITY_MODE_SWITCHING: false,    // Hide online/offline mode toggle\n  ENABLE_BORDER_CROSSING_MODE: false,       // Disable data clearing features\n  \n  // Future features - Not yet implemented\n  ENABLE_TEAM_COLLABORATION: false,\n  ENABLE_CLOUD_BACKUP: false,\n};\n\n/**\n * Development override flags (for testing disabled features during development)\n * Set via environment variables or developer settings\n */\nexport const DEV_FEATURE_OVERRIDES: Partial<FeatureFlags> = {\n  // Uncomment to test offline features during development:\n  // ENABLE_OFFLINE_SECRET_TAGS: true,\n  // ENABLE_SECRET_TAG_CACHING: true,\n  // ENABLE_SECURITY_MODE_SWITCHING: true,\n  // ENABLE_BORDER_CROSSING_MODE: true,\n};\n\n/**\n * Get the current feature flag value with development overrides\n */\nexport function getFeatureFlag<K extends keyof FeatureFlags>(key: K): boolean {\n  // Check for development override first\n  if (DEV_FEATURE_OVERRIDES[key] !== undefined) {\n    return DEV_FEATURE_OVERRIDES[key] as boolean;\n  }\n  \n  // Return production flag value\n  return FEATURE_FLAGS[key];\n}\n\n/**\n * Check if offline secret tag features are enabled\n */\nexport function isOfflineSecretTagsEnabled(): boolean {\n  return getFeatureFlag('ENABLE_SECRET_TAGS') && getFeatureFlag('ENABLE_OFFLINE_SECRET_TAGS');\n}\n\n/**\n * Check if security mode switching is enabled\n */\nexport function isSecurityModeSwitchingEnabled(): boolean {\n  return getFeatureFlag('ENABLE_SECRET_TAGS') && getFeatureFlag('ENABLE_SECURITY_MODE_SWITCHING');\n}\n\n/**\n * Check if secret tag caching is enabled  \n */\nexport function isSecretTagCachingEnabled(): boolean {\n  return getFeatureFlag('ENABLE_SECRET_TAGS') && getFeatureFlag('ENABLE_SECRET_TAG_CACHING');\n}\n\n/**\n * Check if border crossing mode is enabled\n */\nexport function isBorderCrossingModeEnabled(): boolean {\n  return getFeatureFlag('ENABLE_SECRET_TAGS') && getFeatureFlag('ENABLE_BORDER_CROSSING_MODE');\n} \n\nexport function areSecretTagsEnabled(): boolean {\n  return getFeatureFlag('ENABLE_SECRET_TAGS');\n}","import { Platform } from 'react-native';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport logger from '../utils/logger';\n// Import the NAMED export 'api' (the axios instance) and alias it\nimport { api as axiosInstance } from './api';\nimport axios from 'axios';\nimport * as FileSystem from 'expo-file-system';\nimport { validateLanguageCode } from '../config/languageConfig';\nimport { voicePhraseDetector } from './VoicePhraseDetector';\nimport { areSecretTagsEnabled } from '../config/featureFlags';\n\n// Enhanced types for multi-language transcription\ninterface TranscriptionResult {\n  transcript: string;\n  detected_language_code?: string;\n  confidence: number;\n  alternatives: Array<{\n    transcript: string;\n    confidence: number;\n  }>;\n  word_confidence: Array<{\n    word: string;\n    confidence: number;\n    start_time: number;\n    end_time: number;\n  }>;\n  language_confidence: number;\n  quality_metrics: {\n    average_confidence: number;\n    low_confidence_words: number;\n    total_words: number;\n  };\n  secret_tag_detected?: {\n    found: boolean;\n    tagId?: string;\n    tagName?: string;\n    action?: 'activate' | 'deactivate' | 'panic';\n  };\n}\n\ninterface TranscriptionOptions {\n  languageCodes?: string[]; // Enhanced to support multiple language codes\n  maxAlternatives?: number;\n  enableWordConfidence?: boolean;\n  confidenceThreshold?: number;\n  enableSecretTagDetection?: boolean; // Enable secret tag phrase detection\n}\n\ninterface TranscriptionError {\n  type: 'validation' | 'network' | 'server' | 'authentication' | 'unknown';\n  message: string;\n  details?: any;\n}\n\n/**\n * Enhanced Speech-to-Text Service with multi-language support and secret tag detection\n */\nclass SpeechToTextService {\n  private static instance: SpeechToTextService;\n\n  public static getInstance(): SpeechToTextService {\n    if (!SpeechToTextService.instance) {\n      SpeechToTextService.instance = new SpeechToTextService();\n    }\n    return SpeechToTextService.instance;\n  }\n\n  private readonly maxRetries = 2;\n  private readonly retryDelay = 1000; // 1 second\n\n  constructor() {\n    logger.info('Enhanced SpeechToTextService initialized for multi-language support');\n  }\n\n  /**\n   * Enhanced transcription method with multi-language support and secret tag detection\n   */\n  public async transcribeAudio(\n    audioFilePath: string,\n    options: TranscriptionOptions = {}\n  ): Promise<TranscriptionResult> {\n    const { \n      languageCodes, \n      maxAlternatives = 3, \n      enableWordConfidence = true,\n      enableSecretTagDetection = true \n    } = options;\n    \n    logger.info(\n      `Requesting enhanced transcription for audio file: ${audioFilePath}, ` +\n      `Languages: ${languageCodes ? languageCodes.join(', ') : 'auto-detect'}, ` +\n      `Max alternatives: ${maxAlternatives}, ` +\n      `Secret tag detection: ${enableSecretTagDetection}`\n    );\n    \n    try {\n      // Validate language codes if provided\n      if (languageCodes && languageCodes.length > 0) {\n        this._validateLanguageCodes(languageCodes);\n      }\n\n      // --- First attempt with current token ---\n      try {\n        return await this._performTranscription(audioFilePath, languageCodes, enableSecretTagDetection);\n      } \n      catch (initialError: any) {\n        // Handle 401 with manual refresh and retry\n        if (initialError.response?.status === 401) {\n          logger.info('Got 401, manually refreshing token and retrying...');\n          return await this._retryWithTokenRefresh(audioFilePath, languageCodes, enableSecretTagDetection);\n        }\n        \n        // If not a 401 error, just rethrow the original error\n        throw this._createTranscriptionError(initialError);\n      }\n    } \n    catch (error: any) {\n      // Final error handling for errors outside the 401/retry flow\n      logger.error('Failed to transcribe audio via enhanced backend API', {\n        message: error.message,\n        type: error.type || 'unknown',\n        languageCodes,\n        audioPath: audioFilePath\n      });\n      throw error;\n    }\n  }\n\n  /**\n   * Validate language codes before sending to backend\n   */\n  private _validateLanguageCodes(languageCodes: string[]): void {\n    if (languageCodes.length > 4) {\n      throw this._createTranscriptionError({\n        type: 'validation',\n        message: `Too many language codes. Maximum 4 allowed, got ${languageCodes.length}`\n      });\n    }\n\n    // Use simplified validation from languageConfig\n    const invalidCodes = languageCodes.filter(code => {\n      return code !== 'auto' && !validateLanguageCode(code);\n    });\n\n    if (invalidCodes.length > 0) {\n      throw this._createTranscriptionError({\n        type: 'validation',\n        message: `Invalid language codes: ${invalidCodes.join(', ')}. Please use supported language codes.`\n      });\n    }\n  }\n\n  /**\n   * Perform the actual transcription request\n   */\n  private async _performTranscription(\n    audioFilePath: string, \n    languageCodes?: string[],\n    enableSecretTagDetection: boolean = true\n  ): Promise<TranscriptionResult> {\n    // Create FormData with audio file\n    const formData = await this._createFormData(audioFilePath);\n    \n    // Add language codes if provided\n    if (languageCodes && languageCodes.length > 0) {\n      formData.append('language_codes_json', JSON.stringify(languageCodes));\n      logger.info(`Added language codes to request: ${JSON.stringify(languageCodes)}`);\n    }\n    \n    // Get current token\n    const token = await AsyncStorage.getItem('access_token');\n    if (!token) {\n      throw this._createTranscriptionError({\n        type: 'authentication',\n        message: 'Authentication token not found'\n      });\n    }\n    \n    logger.info('Sending enhanced audio file to backend /api/speech/transcribe...');\n    \n    const response = await axiosInstance.post<any>(\n      '/api/speech/transcribe',\n      formData,\n      {\n        headers: {\n          'Authorization': `Bearer ${token}`,\n        },\n        timeout: 30000, // 30 second timeout for transcription\n      }\n    );\n    \n    logger.info(\n      `Enhanced transcription received successfully. ` +\n      `Transcript length: ${response.data.transcript?.length || 0}`\n    );\n    \n    // Process the response and add secret tag detection\n    const processedResult = await this._processTranscriptionResponse(response.data, enableSecretTagDetection);\n    \n    return processedResult;\n  }\n\n  /**\n   * Create FormData for the transcription request\n   */\n  private async _createFormData(audioFilePath: string): Promise<FormData> {\n    const formData = new FormData();\n    \n    if (Platform.OS === 'web') {\n      logger.info('Web platform detected, fetching blob data...');\n      const response = await fetch(audioFilePath);\n      const blob = await response.blob();\n      const fileName = `recording-${Date.now()}.wav`;\n      \n      formData.append('file', new File([blob], fileName, { \n        type: blob.type || 'audio/wav'\n      }));\n      \n      logger.info(`Appended blob to FormData: ${fileName}, type: ${blob.type || 'audio/wav'}, size: ${blob.size}`);\n    } else {\n      // Native platform handling\n      const fileInfo = await FileSystem.getInfoAsync(audioFilePath);\n      if (!fileInfo.exists) {\n        throw this._createTranscriptionError({\n          type: 'validation',\n          message: `Audio file not found: ${audioFilePath}`\n        });\n      }\n\n      const uri = fileInfo.uri;\n      const fileExtension = uri.split('.').pop()?.toLowerCase();\n      const fileType = this._getAudioMimeType(fileExtension);\n      const fileName = uri.split('/').pop() || `recording-${Date.now()}.${fileExtension}`;\n      \n      // For React Native, we need to use the specific format for file uploads\n      (formData as any).append('file', {\n        uri,\n        name: fileName,\n        type: fileType,\n      });\n      \n      logger.info(`Appended native file to FormData: ${fileName}, type: ${fileType}`);\n    }\n    \n    return formData;\n  }\n\n  /**\n   * Get audio MIME type based on file extension\n   */\n  private _getAudioMimeType(extension?: string): string {\n    const mimeTypes: { [key: string]: string } = {\n      'wav': 'audio/wav',\n      'mp3': 'audio/mpeg',\n      'mp4': 'audio/mp4',\n      'm4a': 'audio/mp4',\n      'aac': 'audio/aac',\n      'ogg': 'audio/ogg',\n      'webm': 'audio/webm',\n      'flac': 'audio/flac'\n    };\n    \n    return mimeTypes[extension || 'wav'] || 'audio/wav';\n  }\n\n  /**\n   * Process and validate transcription response with secret tag detection\n   */\n  private async _processTranscriptionResponse(data: any, enableSecretTagDetection: boolean): Promise<TranscriptionResult> {\n    // Ensure all required fields are present with defaults\n    const processedResult: TranscriptionResult = {\n      transcript: data.transcript || '',\n      detected_language_code: data.detected_language_code || undefined,\n      confidence: typeof data.confidence === 'number' ? data.confidence : 0.8, // Default confidence\n      alternatives: Array.isArray(data.alternatives) ? data.alternatives : [],\n      word_confidence: Array.isArray(data.word_confidence) ? data.word_confidence : [],\n      language_confidence: typeof data.language_confidence === 'number' ? data.language_confidence : 0.8,\n      quality_metrics: {\n        average_confidence: data.quality_metrics?.average_confidence || 0.8,\n        low_confidence_words: data.quality_metrics?.low_confidence_words || 0,\n        total_words: data.quality_metrics?.total_words || 0,\n        ...data.quality_metrics\n      }\n    };\n\n    // Perform OPAQUE-based secret phrase detection only when globally enabled\n    if (areSecretTagsEnabled() && enableSecretTagDetection && processedResult.transcript.trim()) {\n      try {\n        logger.info(`[OPAQUE Voice Detection] Starting detection for transcript: \"${processedResult.transcript}\"`);\n        \n        // Use new OPAQUE-based voice phrase detector\n        const tagDetection = await voicePhraseDetector.checkForSecretPhrase(processedResult.transcript);\n        processedResult.secret_tag_detected = tagDetection;\n        \n        logger.info(`[OPAQUE Voice Detection] Detection result:`, tagDetection);\n        \n        if (tagDetection.found) {\n          logger.info(`OPAQUE secret phrase authenticated: ${tagDetection.tagName} (${tagDetection.action})`);\n          \n          // Handle the detected secret tag action (session management happens in VoicePhraseDetector)\n          await this._handleOpaqueTagDetection(tagDetection);\n        } else {\n          logger.info(`[OPAQUE Voice Detection] No secret phrases authenticated in: \"${processedResult.transcript}\"`);\n        }\n      } catch (error) {\n        logger.error('Error during OPAQUE voice detection:', error);\n        // Don't fail the transcription if secret tag detection fails\n        processedResult.secret_tag_detected = { found: false };\n      }\n    } else {\n      processedResult.secret_tag_detected = { found: false };\n      const reason = !areSecretTagsEnabled()\n        ? 'Disabled by global feature flag'\n        : (processedResult.transcript.trim() ? 'Detection disabled by option' : 'Skipped - empty transcript');\n      logger.info(`[OPAQUE Voice Detection] ${reason}`);\n    }\n\n    // Log quality metrics\n    logger.info(\n      `Transcription quality metrics - ` +\n      `Avg confidence: ${processedResult.quality_metrics.average_confidence.toFixed(2)}, ` +\n      `Low confidence words: ${processedResult.quality_metrics.low_confidence_words}/${processedResult.quality_metrics.total_words}, ` +\n      `Language confidence: ${processedResult.language_confidence.toFixed(2)}, ` +\n      `Secret tag detected: ${processedResult.secret_tag_detected?.found || false}`\n    );\n\n    return processedResult;\n  }\n\n  /**\n   * Handle OPAQUE tag detection results\n   */\n  private async _handleOpaqueTagDetection(detection: any): Promise<void> {\n    try {\n      if (detection.action === 'panic') {\n        // Handle panic mode - OPAQUE client handles memory cleanup\n        logger.warn('Panic mode detected via OPAQUE authentication');\n        // Panic mode cleanup is already handled in VoicePhraseDetector\n        return;\n      }\n\n      if (detection.tagId) {\n        if (detection.action === 'activate') {\n          logger.info(`OPAQUE secret tag session activated: ${detection.tagName}`);\n          // Session management is handled in VoicePhraseDetector\n        } else if (detection.action === 'deactivate') {\n          logger.info(`OPAQUE secret tag session deactivated: ${detection.tagName}`);\n          // Session cleanup is handled in VoicePhraseDetector\n        }\n      }\n    } catch (error) {\n      logger.error('Failed to handle OPAQUE tag detection:', error);\n      // Don't throw - this shouldn't fail the transcription\n    }\n  }\n\n\n\n  /**\n   * Retry transcription with token refresh\n   */\n  private async _retryWithTokenRefresh(\n    audioFilePath: string, \n    languageCodes?: string[],\n    enableSecretTagDetection: boolean = true\n  ): Promise<TranscriptionResult> {\n    try {\n      // Attempt to refresh the token\n      const refreshToken = await AsyncStorage.getItem('refresh_token');\n      if (!refreshToken) {\n        throw this._createTranscriptionError({\n          type: 'authentication',\n          message: 'No refresh token available for retry'\n        });\n      }\n\n      logger.info('Attempting to refresh access token...');\n      \n      // Call refresh endpoint\n      const refreshResponse = await axios.post('/api/v1/auth/refresh', {\n        refresh_token: refreshToken,\n      });\n\n      if (refreshResponse.data.access_token) {\n        // Save new token\n        await AsyncStorage.setItem('access_token', refreshResponse.data.access_token);\n        \n        if (refreshResponse.data.refresh_token) {\n          await AsyncStorage.setItem('refresh_token', refreshResponse.data.refresh_token);\n        }\n\n        logger.info('Token refreshed successfully, retrying transcription...');\n        \n        // Retry the transcription with new token\n        return await this._performTranscription(audioFilePath, languageCodes, enableSecretTagDetection);\n      } else {\n        throw this._createTranscriptionError({\n          type: 'authentication',\n          message: 'Token refresh failed - no access token received'\n        });\n      }\n    } catch (refreshError: any) {\n      logger.error('Token refresh failed:', refreshError);\n      throw this._createTranscriptionError({\n        type: 'authentication',\n        message: 'Authentication failed and token refresh unsuccessful'\n      });\n    }\n  }\n\n  /**\n   * Create standardized transcription error\n   */\n  private _createTranscriptionError(error: any): TranscriptionError {\n    if (error.type && error.message) {\n      return error; // Already a TranscriptionError\n    }\n\n    let errorType: TranscriptionError['type'] = 'unknown';\n    let errorMessage = 'Unknown transcription error';\n\n    if (error.response) {\n      // HTTP error response\n      const status = error.response.status;\n      const detail = error.response.data?.detail || error.response.statusText;\n      \n      if (status === 401) {\n        errorType = 'authentication';\n        errorMessage = 'Authentication failed';\n      } else if (status === 422) {\n        errorType = 'validation';\n        errorMessage = detail || 'Validation error';\n      } else if (status >= 500) {\n        errorType = 'server';\n        errorMessage = detail || 'Server error';\n      } else {\n        errorType = 'network';\n        errorMessage = detail || `HTTP ${status} error`;\n      }\n    } else if (error.request) {\n      // Network error\n      errorType = 'network';\n      errorMessage = 'Network error - unable to reach server';\n    } else {\n      // Other error\n      errorMessage = error.message || 'Unknown error occurred';\n    }\n\n    return {\n      type: errorType,\n      message: errorMessage,\n      details: error.response?.data || error\n    };\n  }\n\n  /**\n   * Get transcription quality assessment\n   */\n  public getQualityAssessment(result: TranscriptionResult): {\n    overall: 'excellent' | 'good' | 'fair' | 'poor';\n    confidence: number;\n    recommendations: string[];\n  } {\n    const confidence = result.confidence;\n    const lowConfidenceRatio = result.quality_metrics.total_words > 0 \n      ? result.quality_metrics.low_confidence_words / result.quality_metrics.total_words \n      : 0;\n\n    let overall: 'excellent' | 'good' | 'fair' | 'poor';\n    const recommendations: string[] = [];\n\n    if (confidence >= 0.9 && lowConfidenceRatio < 0.1) {\n      overall = 'excellent';\n    } else if (confidence >= 0.8 && lowConfidenceRatio < 0.2) {\n      overall = 'good';\n    } else if (confidence >= 0.7 && lowConfidenceRatio < 0.3) {\n      overall = 'fair';\n      recommendations.push('Consider speaking more clearly for better accuracy');\n    } else {\n      overall = 'poor';\n      recommendations.push('Try speaking more slowly and clearly');\n      recommendations.push('Ensure you are in a quiet environment');\n      if (result.alternatives.length > 0) {\n        recommendations.push('Check alternative transcriptions below');\n      }\n    }\n\n    if (lowConfidenceRatio > 0.2) {\n      recommendations.push('Some words had low confidence - review the transcript carefully');\n    }\n\n    if (!result.detected_language_code) {\n      recommendations.push('Language detection failed - try selecting specific languages');\n    }\n\n    if (result.secret_tag_detected?.found) {\n      recommendations.push(`Secret tag detected: ${result.secret_tag_detected.tagName || 'Unknown'}`);\n    }\n\n    return {\n      overall,\n      confidence,\n      recommendations\n    };\n  }\n}\n\n// Export singleton instance\nconst speechToTextService = SpeechToTextService.getInstance();\nexport default speechToTextService; ","import { useState, useEffect, useRef, useCallback } from 'react';\nimport { Alert, Platform } from 'react-native';\nimport { Audio } from 'expo-av';\nimport * as FileSystem from 'expo-file-system';\nimport logger from '../utils/logger';\n\nexport interface AudioRecordingOptions {\n  quality?: keyof typeof Audio.RecordingOptionsPresets;\n  autoStart?: boolean;\n  filePrefix?: string;\n  requestPermissionOnMount?: boolean;\n  maxDuration?: number; // in seconds, 0 means unlimited\n}\n\nconst DEFAULT_OPTIONS: AudioRecordingOptions = {\n  quality: 'HIGH_QUALITY',\n  autoStart: false,\n  filePrefix: 'recording_',\n  requestPermissionOnMount: true,\n  maxDuration: 0,\n};\n\nexport interface AudioRecordingHook {\n  isRecording: boolean;\n  recordingDuration: number;\n  audioUri: string | null;\n  startRecording: () => Promise<void>;\n  stopRecording: () => Promise<void>;\n  cleanupRecordingFile: (uri: string | null) => Promise<void>;\n  permissionGranted: boolean;\n  error: Error | null;\n}\n\nconst useAudioRecording = (options?: AudioRecordingOptions): AudioRecordingHook => {\n  const RECORDING_DIR = FileSystem.documentDirectory + 'recordings/';\n  const mergedOptions = { ...DEFAULT_OPTIONS, ...options };\n  const [recording, setRecording] = useState<Audio.Recording | null>(null);\n  const [isRecording, setIsRecording] = useState(false);\n  const [recordingDuration, setRecordingDuration] = useState(0);\n  const [audioUri, setAudioUri] = useState<string | null>(null);\n  const [permissionGranted, setPermissionGranted] = useState(false);\n  const [error, setError] = useState<Error | null>(null);\n  const timerRef = useRef<NodeJS.Timeout | null>(null);\n  const startTimeRef = useRef<number>(0);\n  const recordingInstanceRef = useRef<Audio.Recording | null>(null);\n  const isRequestingPermissionRef = useRef(false);\n  const autoStartAttemptedRef = useRef(false); // Track if auto-start has been attempted\n  \n  // Effect to keep recordingInstanceRef updated with the latest recording object\n  useEffect(() => {\n    recordingInstanceRef.current = recording;\n  }, [recording]);\n  \n  // Debug effect for recordingDuration changes\n  useEffect(() => {\n    logger.debug(`[useAudioRecording] recordingDuration updated: ${recordingDuration}s`);\n  }, [recordingDuration]);\n  \n  // Robust unmount cleanup effect\n  useEffect(() => {\n    return () => {\n      logger.info('[useAudioRecording] Component unmounting. Performing final cleanup.');\n      if (timerRef.current) {\n        logger.info('[useAudioRecording] Unmount: Clearing timer interval.');\n        clearInterval(timerRef.current);\n        timerRef.current = null;\n      }\n      // Also ensure the Audio.Recording object is stopped and unloaded.\n      if (recordingInstanceRef.current) {\n        logger.warn('[useAudioRecording] Unmount: Stopping and unloading active Audio.Recording object.');\n        recordingInstanceRef.current.stopAndUnloadAsync()\n          .catch(e => logger.error('Error stopping/unloading recording on unmount', e));\n        recordingInstanceRef.current = null; // Clear the ref\n      }\n    };\n  }, []); // Empty dependency array ensures this runs only on unmount\n  \n  const requestPermissionsAndSetupAudioMode = useCallback(async () => {\n    if (isRequestingPermissionRef.current) {\n      logger.debug(\"[useAudioRecording] Permission request already in progress.\");\n      return; // Exit if a request is already happening\n    }\n    isRequestingPermissionRef.current = true;\n    setError(null); // Clear previous errors before a new attempt\n\n    try {\n      logger.info(\"[useAudioRecording] Requesting audio permissions via Expo AV.\");\n      const { granted, status } = await Audio.requestPermissionsAsync();\n      logger.info(`[useAudioRecording] Expo AV permission request result: granted=${granted}, status=${status}.`);\n      \n      if (granted) {\n        await Audio.setAudioModeAsync({\n          allowsRecordingIOS: true,\n          playsInSilentModeIOS: true,\n          staysActiveInBackground: false,\n          shouldDuckAndroid: true,\n          playThroughEarpieceAndroid: false,\n        });\n        logger.info('[useAudioRecording] Audio mode set successfully after permission grant.');\n        setPermissionGranted(true); // Set state to true\n      } else {\n        const permissionError = new Error('Audio recording permission is needed to record audio.');\n        logger.warn('[useAudioRecording] Audio recording permission not granted by user.');\n        setError(permissionError);\n        setPermissionGranted(false); // Ensure state is false\n      }\n    } catch (error) {\n      const err = error instanceof Error ? error : new Error('Failed to request permissions or set audio mode');\n      logger.error('[useAudioRecording] Catch block: Audio permission/setup error:', err);\n      setError(err);\n      setPermissionGranted(false); // Ensure state is false on error\n    } finally {\n      isRequestingPermissionRef.current = false; // Reset the flag\n    }\n  }, []); // Empty dependency array: this callback is stable and manages state internally.\n  \n  const ensureRecordingDirExists = async () => {\n    if (Platform.OS !== 'web') {\n      const dirInfo = await FileSystem.getInfoAsync(RECORDING_DIR);\n      if (!dirInfo.exists) {\n        logger.info(`Creating directory for recordings: ${RECORDING_DIR}`);\n        await FileSystem.makeDirectoryAsync(RECORDING_DIR, { intermediates: true });\n      }\n    }\n  };\n\n  // Function to stop recording - defined early so it can be referenced in updateTimer\n  const stopRecording = useCallback(async () => {\n    if (!recording) {\n      logger.warn('stopRecording called when no recording is active.');\n      return;\n    }\n\n    logger.info('Stopping audio recording...');\n    setIsRecording(false);\n    \n    // Calculate final duration before clearing timer and resetting refs\n    const finalDuration = startTimeRef.current ? Math.floor((Date.now() - startTimeRef.current) / 1000) : 0;\n    logger.info(`[useAudioRecording] Final duration: ${finalDuration}s`);\n    \n    // IMPORTANT: Clear timer interval BEFORE resetting startTimeRef to avoid timer ticks with startTimeRef=0\n    if (timerRef.current) {\n      clearInterval(timerRef.current);\n      timerRef.current = null;\n    }\n    \n    // Set the final duration and then reset startTimeRef (order matters)\n    setRecordingDuration(finalDuration);\n    startTimeRef.current = 0;\n\n    try {\n      await recording.stopAndUnloadAsync();\n      const uri = recording.getURI();\n      logger.info(`Recording stopped. URI: ${uri}, duration: ${finalDuration}s`);\n      setAudioUri(uri);\n      setRecording(null);\n    } catch (err) {\n      const error = err instanceof Error ? err : new Error('Failed to stop recording');\n      logger.error('Failed to stop and unload recording', error);\n      setError(error);\n      setAudioUri(null); // Ensure URI is null on error\n    }\n  }, [recording]); // Only depend on recording\n\n  // Start recording implementation\n  const startRecording = useCallback(async () => {\n    setError(null);\n    logger.info('[useAudioRecording] Attempting to start recording...');\n\n    // Critical check: Rely on the permissionGranted state.\n    if (!permissionGranted) {\n        logger.error('[useAudioRecording] startRecording: Permissions are NOT granted. Aborting recording attempt.');\n        setError(new Error('Audio recording permission has not been granted. Please grant permission first.'));\n        return; // Do not proceed if permissions are not already granted\n    }\n\n    if (isRecording) {\n        logger.warn('[useAudioRecording] startRecording called while already recording. Ignoring call.');\n        return;\n    }\n\n    try {\n      // First clear any existing timer\n      if (timerRef.current) {\n        clearInterval(timerRef.current);\n        timerRef.current = null;\n      }\n      \n      logger.info('[useAudioRecording] Ensuring recording directory exists...');\n      await ensureRecordingDirExists();\n      logger.info('[useAudioRecording] Setting audio mode for recording...');\n      await Audio.setAudioModeAsync({\n        allowsRecordingIOS: true,\n        playsInSilentModeIOS: true,\n        shouldDuckAndroid: true,\n        playThroughEarpieceAndroid: false,\n        staysActiveInBackground: false,\n      });\n\n      // Set recording options based on quality preference\n      const qualityPreset = mergedOptions.quality || 'HIGH_QUALITY';\n      const options: Audio.RecordingOptions = {\n        ...Audio.RecordingOptionsPresets[qualityPreset],\n      };\n      \n      if (Platform.OS === 'web') {\n        options.web = { mimeType: 'audio/webm' };\n      }\n      \n      logger.info('[useAudioRecording] Creating recording instance...');\n      const { recording: newRecording } = await Audio.Recording.createAsync(options);\n      setRecording(newRecording);\n      \n      // Reset duration and set start time BEFORE setting isRecording\n      setRecordingDuration(0);\n      const now = Date.now();\n      startTimeRef.current = now;\n      logger.info(`[useAudioRecording] Setting start time to ${now}`);\n      \n      setIsRecording(true);\n      setAudioUri(null); // Reset previous URI\n\n      logger.info('[useAudioRecording] Starting timer interval...');\n      // Use a direct function instead of updateTimer to ensure closure has latest startTimeRef\n      timerRef.current = setInterval(() => {\n        const currentTime = Date.now();\n        \n        // Safety check: If startTimeRef is 0 or otherwise invalid, stop the timer\n        if (!startTimeRef.current) {\n          logger.warn('[useAudioRecording] Timer tick with invalid startTimeRef (0). Clearing interval.');\n          if (timerRef.current) {\n            clearInterval(timerRef.current);\n            timerRef.current = null;\n          }\n          return;\n        }\n        \n        const elapsed = Math.floor((currentTime - startTimeRef.current) / 1000);\n        logger.info(`Timer tick: current=${currentTime}, start=${startTimeRef.current}, elapsed=${elapsed}s`);\n        \n        // Only update the duration if we have a valid elapsed time (prevents displaying astronomical values)\n        if (elapsed >= 0 && elapsed < 86400) { // Sanity check: < 24 hours\n          setRecordingDuration(elapsed);\n        } else {\n          logger.warn(`[useAudioRecording] Invalid elapsed time calculated: ${elapsed}s. Ignoring this tick.`);\n        }\n        \n        // Check max duration\n        if (mergedOptions.maxDuration && \n            mergedOptions.maxDuration > 0 && \n            elapsed >= mergedOptions.maxDuration) {\n          logger.info(`Max duration reached: ${elapsed}s, stopping`);\n          if (timerRef.current) {\n            clearInterval(timerRef.current);\n            timerRef.current = null;\n          }\n          stopRecording();\n        }\n      }, 1000);\n      \n      logger.info('[useAudioRecording] Started audio recording successfully');\n    } catch (err) {\n      const error = err instanceof Error ? err : new Error('Failed to start recording');\n      logger.error('[useAudioRecording] Failed to start recording', error);\n      setError(error);\n      setIsRecording(false);\n      startTimeRef.current = 0;\n      if (timerRef.current) {\n        clearInterval(timerRef.current);\n        timerRef.current = null;\n      }\n    }\n  }, [isRecording, mergedOptions.quality, mergedOptions.maxDuration, stopRecording, ensureRecordingDirExists]);\n\n  // Function to update timer based on elapsed time\n  const updateTimer = useCallback(() => {\n    if (!startTimeRef.current) {\n      logger.warn('[useAudioRecording] updateTimer called but startTimeRef is not set');\n      return;\n    }\n    \n    const now = Date.now();\n    const elapsed = Math.floor((now - startTimeRef.current) / 1000);\n    logger.info(`[useAudioRecording] Timer tick, now: ${now}, start: ${startTimeRef.current}, elapsed: ${elapsed}s`);\n    \n    // Update recordingDuration state with actual elapsed time\n    setRecordingDuration(elapsed);\n    \n    // Check for max duration\n    if (mergedOptions.maxDuration && \n        mergedOptions.maxDuration > 0 && \n        elapsed >= mergedOptions.maxDuration) {\n      logger.info(`[useAudioRecording] Max duration of ${mergedOptions.maxDuration}s reached, stopping recording`);\n      stopRecording();\n    }\n  }, [mergedOptions.maxDuration, stopRecording]);\n\n  // This useEffect handles permission requests on mount and auto-start logic.\n  // It relies on permissionGranted state being updated by requestPermissionsAndSetupAudioMode.\n  useEffect(() => {\n    let didCancel = false; // To prevent state updates on unmounted component\n\n    const managePermissionsAndAutoStart = async () => {\n      if (mergedOptions.requestPermissionOnMount && !permissionGranted) {\n        // Only call if no request is currently in progress\n        if (!isRequestingPermissionRef.current) {\n          logger.info(\"[useAudioRecording] Mount/PermissionEffect: Permissions not granted and no request in progress. Initiating request.\");\n          // requestPermissionsAndSetupAudioMode is async but we don't need to await it here\n          // as its purpose is to update state, which will cause this effect to re-run.\n          requestPermissionsAndSetupAudioMode();\n        } else {\n          logger.debug(\"[useAudioRecording] Mount/PermissionEffect: Permission request already in progress. Waiting for completion.\");\n        }\n        // Important: Return early. Let the re-run of this effect (due to permissionGranted state change) handle auto-start.\n        return;\n      }\n\n      // This part of the logic runs if: \n      // 1. Permissions were already granted on mount.\n      // 2. Permissions became granted after a request, and the effect re-ran.\n      if (permissionGranted && mergedOptions.autoStart && !isRecording && !autoStartAttemptedRef.current) {\n        if (!didCancel) { // Check if component is still mounted\n          logger.info('[useAudioRecording] Mount/PermissionEffect: Permissions granted. Auto-start conditions met. Calling startRecording.');\n          autoStartAttemptedRef.current = true; // Mark that we've attempted auto-start\n          startRecording(); // Not awaiting, it's a fire-and-forget from this effect's perspective\n        }\n      } else if (permissionGranted && mergedOptions.autoStart && isRecording) {\n        logger.debug('[useAudioRecording] Mount/PermissionEffect: Permissions granted and auto-start enabled, but already recording.');\n      } else if (permissionGranted && !mergedOptions.autoStart) {\n        logger.debug('[useAudioRecording] Mount/PermissionEffect: Permissions granted, but auto-start is not enabled.');\n      } else if (permissionGranted && mergedOptions.autoStart && autoStartAttemptedRef.current) {\n        logger.debug('[useAudioRecording] Mount/PermissionEffect: Auto-start already attempted, skipping to prevent infinite loop.');\n      }\n    };\n\n    managePermissionsAndAutoStart();\n\n    return () => {\n      didCancel = true; // Cleanup function to set didCancel on unmount\n    };\n  }, [\n    mergedOptions.requestPermissionOnMount,\n    mergedOptions.autoStart,\n    permissionGranted, // Key dependency: effect re-runs when this changes\n    isRecording,\n    requestPermissionsAndSetupAudioMode, // Stable callback\n    startRecording // Callback, its stability depends on its own deps\n  ]);\n\n  const cleanupRecordingFile = useCallback(async (uri: string | null) => {\n    if (uri && Platform.OS !== 'web') {\n        try {\n            const fileInfo = await FileSystem.getInfoAsync(uri);\n            if (fileInfo.exists) {\n                logger.info(`Cleaning up temporary recording file: ${uri}`);\n                await FileSystem.deleteAsync(uri);\n            }\n        } catch (err) {\n            logger.error(`Failed to delete recording file ${uri}`, err);\n        }\n    }\n  }, []);\n\n  return {\n    isRecording,\n    recordingDuration,\n    audioUri,\n    startRecording,\n    stopRecording,\n    cleanupRecordingFile,\n    permissionGranted,\n    error,\n  };\n};\n\nexport default useAudioRecording; ","import { useState, useEffect, useRef, useCallback } from 'react';\nimport { Alert } from 'react-native';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport Constants from 'expo-constants';\nimport logger from '../utils/logger';\n\nexport type WebSocketStatus = 'disconnected' | 'connecting' | 'connected' | 'error';\n\ninterface WebSocketTranscriptionHookProps {\n  onOpen?: () => void;\n  onClose?: (event: { code: number; reason: string }) => void;\n  onMessage?: (data: any) => void; // For raw messages if needed\n  onInterimTranscript?: (text: string) => void;\n  onFinalTranscript?: (text: string, detectedLanguage?: string) => void;\n  onTranscriptionError?: (errorMessage: string) => void;\n  onStatusUpdate?: (statusMessage: string) => void; // For general status messages from WS\n}\n\nexport interface WebSocketTranscriptionHook {\n  wsStatus: WebSocketStatus;\n  connect: () => Promise<void>;\n  disconnect: () => void;\n  sendMessage: (message: string | object) => boolean; // Returns true if message was sent\n  // sendAudioChunk: (chunk: Blob | ArrayBuffer) => boolean; // Future: for live streaming\n}\n\nconst useWebSocketTranscription = ({\n  onOpen,\n  onClose,\n  onMessage,\n  onInterimTranscript,\n  onFinalTranscript,\n  onTranscriptionError,\n  onStatusUpdate,\n}: WebSocketTranscriptionHookProps): WebSocketTranscriptionHook => {\n  const ws = useRef<WebSocket | null>(null);\n  const [wsStatus, setWsStatus] = useState<WebSocketStatus>('disconnected');\n  const [authToken, setAuthToken] = useState<string | null>(null);\n\n  useEffect(() => {\n    // Fetch token on mount, but don't auto-connect\n    AsyncStorage.getItem('access_token').then(token => {\n      if (token) {\n        setAuthToken(token);\n      } else {\n        logger.warn('WebSocket: Auth token not found on initial load.');\n      }\n    });\n\n    // Cleanup WebSocket on unmount\n    return () => {\n      if (ws.current) {\n        logger.info('useWebSocketTranscription unmounting, closing WebSocket.');\n        ws.current.onclose = null; // Avoid triggering onClose callback during forced close\n        ws.current.onerror = null;\n        ws.current.onmessage = null;\n        ws.current.onopen = null;\n        ws.current.close();\n        ws.current = null;\n      }\n    };\n  }, []);\n\n  const connect = useCallback(async () => {\n    if (ws.current && ws.current.readyState === WebSocket.OPEN) {\n      logger.info('WebSocket already connected.');\n      setWsStatus('connected'); // Ensure status is correct\n      onOpen?.();\n      return;\n    }\n\n    if (wsStatus === 'connecting') {\n      logger.info('WebSocket connection attempt already in progress.');\n      return;\n    }\n\n    let token = authToken;\n    if (!token) {\n      logger.info('WebSocket: Auth token not in state, re-fetching...');\n      token = await AsyncStorage.getItem('access_token');\n    }\n\n    if (!token) {\n      logger.error('WebSocket: Cannot connect. No auth token found (key: access_token).');\n      setWsStatus('error');\n      onTranscriptionError?.('Authentication Error: Missing token.');\n      Alert.alert('Authentication Error', 'Could not connect to transcription service. Please log in again.');\n      return;\n    }\n    setAuthToken(token); // Store it if re-fetched\n\n    setWsStatus('connecting');\n    logger.info('Attempting WebSocket connection...');\n\n    const apiUrl = Constants.expoConfig?.extra?.apiUrl || 'http://localhost:8001';\n    const wsUrl = apiUrl.replace(/^http/, 'ws') + '/ws/transcribe';\n    logger.info(`Connecting to WebSocket: ${wsUrl}`);\n\n    try {\n      const socket = new WebSocket(wsUrl);\n      ws.current = socket;\n\n      socket.onopen = () => {\n        logger.info('WebSocket Connected!');\n        setWsStatus('connected');\n        // Send authentication token\n        socket.send(JSON.stringify({ type: 'auth', token }));\n        onOpen?.();\n      };\n\n      socket.onmessage = (event) => {\n        try {\n          const message = JSON.parse(event.data as string);\n          logger.debug('WebSocket message received:', message);\n          onMessage?.(message); // Generic message handler\n\n          if (message.type === 'interim_transcript') {\n            onInterimTranscript?.(message.text);\n          } else if (message.type === 'final_transcript') {\n            onFinalTranscript?.(message.text, message.language_code); // Assuming language_code might be present\n          } else if (message.type === 'error') {\n            logger.error('WebSocket server error:', message.message);\n            onTranscriptionError?.(message.message);\n             // setWsStatus('error'); // Let onClose handle status for critical errors, or decide specific logic\n          } else if (message.type === 'status') {\n            logger.info('WebSocket status update:', message.message);\n            onStatusUpdate?.(message.message);\n          } else if (message.type === 'language_detected'){\n            logger.info('Language detected by server:', message.code);\n            // Potentially call a specific handler if needed, or use onStatusUpdate\n          }\n\n        } catch (e) {\n          logger.error('Failed to parse WebSocket message:', e);\n          onTranscriptionError?.('Received malformed message from server.');\n        }\n      };\n\n      socket.onerror = (errorEvent) => {\n        // The error object in onerror is often not very detailed directly.\n        // True error details might be in the reason for onclose.\n        logger.error('WebSocket Error Event:', errorEvent);\n        setWsStatus('error');\n        onTranscriptionError?.('WebSocket connection error. Please try again.');\n        // Don't Alert here, let the component decide based on onTranscriptionError\n      };\n\n      socket.onclose = (event) => {\n        logger.info('WebSocket Closed:', { code: event.code, reason: event.reason });\n        ws.current = null; // Clear the ref\n        // Only set to disconnected if not already in error state from onerror\n        if (wsStatus !== 'error') {\n             setWsStatus('disconnected');\n        }\n        onClose?.({ code: event.code, reason: event.reason });\n        // Alert.alert('Connection Closed', `Transcription service disconnected: ${event.reason || event.code}`);\n      };\n    } catch (e) {\n        logger.error('Failed to create WebSocket object or initial connection error:', e);\n        setWsStatus('error');\n        onTranscriptionError?.('Could not establish connection to transcription service.');\n        ws.current = null;\n    }\n  }, [authToken, wsStatus, onOpen, onClose, onMessage, onInterimTranscript, onFinalTranscript, onTranscriptionError, onStatusUpdate]);\n\n  const disconnect = useCallback(() => {\n    if (ws.current) {\n      logger.info('Manually disconnecting WebSocket...');\n      ws.current.close(); // Simplest call, 0 arguments\n      // onclose handler will set ws.current to null and update status\n    }\n  }, []);\n\n  const sendMessage = useCallback((message: string | object): boolean => {\n    if (ws.current && ws.current.readyState === WebSocket.OPEN) {\n      try {\n        const payload = typeof message === 'string' ? message : JSON.stringify(message);\n        ws.current.send(payload);\n        logger.debug('WebSocket message sent:', payload);\n        return true;\n      } catch (error) {\n        logger.error('Failed to send WebSocket message:', error);\n        onTranscriptionError?.('Failed to send message to server.');\n        return false;\n      }\n    } else {\n      logger.warn('Cannot send WebSocket message: Connection not open.');\n      // onTranscriptionError?.('Cannot send message: Connection not open.'); // Could be too noisy\n      return false;\n    }\n  }, [onTranscriptionError]);\n\n  return {\n    wsStatus,\n    connect,\n    disconnect,\n    sendMessage,\n  };\n};\n\nexport default useWebSocketTranscription; ","import { useState, useEffect, useCallback, useRef } from 'react';\nimport { Alert, Animated, Platform } from 'react-native';\nimport { Audio } from 'expo-av';\nimport speechToTextService from '../services/speechToText';\nimport logger from '../utils/logger';\nimport hapticService from '../services/hapticService';\n\n// Import hooks\nimport useAudioRecording from './useAudioRecording';\nimport useWebSocketTranscription, { WebSocketStatus } from './useWebSocketTranscription';\nimport { useSettings } from '../contexts/SettingsContext';\n\n// Import simplified config\nimport { \n  getDefaultLanguageCode, \n  validateLanguageCode\n} from '../config/languageConfig';\n\n// Enhanced transcription result interface\nexport interface TranscriptionResult {\n  transcript: string;\n  detected_language_code?: string;\n  confidence: number;\n  alternatives: Array<{\n    transcript: string;\n    confidence: number;\n  }>;\n  word_confidence: Array<{\n    word: string;\n    confidence: number;\n    start_time: number;\n    end_time: number;\n  }>;\n  language_confidence: number;\n  quality_metrics: {\n    average_confidence: number;\n    low_confidence_words: number;\n    total_words: number;\n  };\n  secret_tag_detected?: {\n    found: boolean;\n    tagId?: string;\n    tagName?: string;\n    action?: 'activate' | 'deactivate' | 'panic';\n  };\n}\n\ninterface UseAudioRecorderLogicProps {\n  onTranscriptionComplete: (text: string, audioUri?: string, detectedLanguage?: string | null, confidence?: number) => void;\n  onCancel: () => void;\n  autoStart?: boolean;\n  onAutoSave: (currentTranscript: string) => void;\n}\n\nexport const useAudioRecorderLogic = ({ \n  onTranscriptionComplete, \n  onCancel,\n  autoStart = false,\n  onAutoSave,\n}: UseAudioRecorderLogicProps) => {\n  // Get user settings for default language\n  const { settings } = useSettings();\n  \n  // Enhanced states for transcription\n  const [transcriptSegments, setTranscriptSegments] = useState<string[]>([]);\n  const [currentSegmentTranscript, setCurrentSegmentTranscript] = useState('');\n  const [isTranscribingSegment, setIsTranscribingSegment] = useState(false);\n  const [lastTranscriptionResult, setLastTranscriptionResult] = useState<TranscriptionResult | null>(null);\n  const [showAlternatives, setShowAlternatives] = useState(false);\n\n\n  // Use user's default language setting\n  const [selectedLanguage, setSelectedLanguage] = useState<string>(settings.defaultLanguage);\n\n  // Update selected language when user changes default language setting\n  useEffect(() => {\n    setSelectedLanguage(settings.defaultLanguage);\n    logger.info(`[AudioRecorderLogic] Default language updated to: ${settings.defaultLanguage}`);\n  }, [settings.defaultLanguage]);\n\n  // Animation refs\n  const pulseAnim = useRef(new Animated.Value(1)).current;\n  const waveAnim1 = useRef(new Animated.Value(0)).current;\n  const waveAnim2 = useRef(new Animated.Value(0)).current;\n\n  // Audio recording hook\n  const {\n    isRecording,\n    recordingDuration,\n    audioUri,\n    startRecording,\n    stopRecording,\n    cleanupRecordingFile,\n    permissionGranted,\n    error: recordingError\n  } = useAudioRecording({\n    requestPermissionOnMount: true,\n    autoStart: autoStart\n  });\n\n  // Enhanced state management\n  const [isProcessing, setIsProcessing] = useState(false);\n  const [processedUris, setProcessedUris] = useState<Set<string>>(new Set());\n  const [hasTranscribedAudio, setHasTranscribedAudio] = useState(false);\n  \n  // Refs to track component state\n  const isMountedRef = useRef(true);\n  const callbackCalledRef = useRef(false);\n\n  // Animation effects\n  useEffect(() => {\n    if (isRecording) {\n      Animated.loop(\n        Animated.sequence([\n          Animated.timing(pulseAnim, { toValue: 1.1, duration: 700, useNativeDriver: Platform.OS !== 'web' }),\n          Animated.timing(pulseAnim, { toValue: 1, duration: 700, useNativeDriver: Platform.OS !== 'web' }),\n        ])\n      ).start();\n      Animated.loop(\n        Animated.stagger(300, [\n          Animated.sequence([\n            Animated.timing(waveAnim1, { toValue: 1, duration: 800, useNativeDriver: Platform.OS !== 'web' }),\n            Animated.timing(waveAnim1, { toValue: 0, duration: 800, useNativeDriver: Platform.OS !== 'web' }),\n          ]),\n          Animated.sequence([\n            Animated.timing(waveAnim2, { toValue: 1, duration: 800, useNativeDriver: Platform.OS !== 'web' }),\n            Animated.timing(waveAnim2, { toValue: 0, duration: 800, useNativeDriver: Platform.OS !== 'web' }),\n          ])\n        ])\n      ).start();\n    } else {\n      pulseAnim.stopAnimation();\n      pulseAnim.setValue(1);\n      waveAnim1.stopAnimation();\n      waveAnim1.setValue(0);\n      waveAnim2.stopAnimation();\n      waveAnim2.setValue(0);\n    }\n  }, [isRecording, pulseAnim, waveAnim1, waveAnim2]);\n\n  // WebSocket handlers\n  const handleWebSocketError = useCallback((errorMessage: string) => {\n    logger.error('WebSocket Transcription Error:', errorMessage);\n    if (isMountedRef.current) {\n      setIsProcessing(false);\n      setCurrentSegmentTranscript(\"Error with live transcription.\");\n    }\n  }, []);\n\n  const handleInterimTranscript = useCallback((text: string) => {\n    logger.debug('Interim transcript received (WS):', text);\n    if (isMountedRef.current) {\n      setCurrentSegmentTranscript(prev => prev + text);\n    }\n  }, []);\n\n  const handleFinalTranscript = useCallback((text: string, detectedLanguage?: string) => {\n    logger.info(`Final transcript (WS): ${text}, lang: ${detectedLanguage}`);\n    if (isMountedRef.current) {\n      setCurrentSegmentTranscript(text + ' '); \n    }\n  }, []);\n\n  // WebSocket hook\n  const {\n    wsStatus,\n    connect: connectWebSocket,\n    disconnect: disconnectWebSocket,\n    sendMessage: sendWsMessage,\n  } = useWebSocketTranscription({\n    onInterimTranscript: handleInterimTranscript,\n    onFinalTranscript: handleFinalTranscript,\n    onTranscriptionError: handleWebSocketError,\n    onOpen: () => logger.info('AudioRecorder: WebSocket connection opened.'),\n    onClose: (event) => logger.info('AudioRecorder: WebSocket connection closed.', event),\n  });\n\n  // Effect 1: Mount/Unmount setup - should only run once\n  useEffect(() => {\n    isMountedRef.current = true;\n    logger.info('AudioRecorder: Component did mount.');\n\n    // Reset states for enhanced recording when component mounts\n    setTranscriptSegments([]);\n    setCurrentSegmentTranscript('');\n    setIsTranscribingSegment(false);\n    setLastTranscriptionResult(null);\n    setShowAlternatives(false);\n\n    callbackCalledRef.current = false;\n    setHasTranscribedAudio(false);\n\n    return () => {\n      logger.info('AudioRecorder: Component will unmount. Performing final cleanup.');\n      isMountedRef.current = false;\n      disconnectWebSocket();\n    };\n  }, []); // Empty dependency array - runs only on mount/unmount\n\n  // Effect to set audio mode *after* permission is granted via the hook's request\n  useEffect(() => {\n    if (permissionGranted) {\n      const setMode = async () => {\n        logger.info('[AudioRecorder] Permission is granted, ensuring audio mode is set.');\n        try {\n          await Audio.setAudioModeAsync({\n            allowsRecordingIOS: true,\n            playsInSilentModeIOS: true,\n            shouldDuckAndroid: true,\n            playThroughEarpieceAndroid: false,\n          });\n          logger.info('[AudioRecorder] Audio mode set successfully (on permissionGranted change).');\n        } catch (err) {\n          logger.error('[AudioRecorder] Failed to set audio mode (on permissionGranted change):', err);\n        }\n      };\n      setMode();\n    }\n  }, [permissionGranted]);\n\n  // Simplified function to safely handle the done/cancel action (X button)\n  const handleDone = useCallback(() => {\n    logger.info('AudioRecorder: handleDone (X button) called, closing recorder and discarding changes.');\n    if (isMountedRef.current) {\n      if (isRecording) { // If recording, stop it first\n        stopRecording().catch(err => \n          logger.error('Error stopping recording during handleDone:', err)\n        );\n      }\n      onCancel();\n    }\n  }, [isRecording, stopRecording, onCancel]);\n\n  // Enhanced function to accept transcript with quality metrics\n  const handleAcceptTranscript = useCallback(() => {\n    if (!isMountedRef.current || callbackCalledRef.current) return;\n\n    const fullTranscript = transcriptSegments.join('\\n').trim();\n    if (!fullTranscript) {\n      logger.warn('No transcript to accept.');\n      return;\n    }\n\n    callbackCalledRef.current = true;\n    setHasTranscribedAudio(true);\n\n    const confidence = lastTranscriptionResult?.confidence || 0;\n    const detectedLanguage = lastTranscriptionResult?.detected_language_code as string | undefined;\n\n    logger.info(\n      `Accepting enhanced transcript: \"${fullTranscript.substring(0, 50)}...\", ` +\n      `confidence: ${confidence.toFixed(2)}, language: ${detectedLanguage || 'unknown'}`\n    );\n\n    hapticService.success(); // Success haptic feedback for accepting transcript\n    onTranscriptionComplete(fullTranscript, audioUri || undefined, detectedLanguage, confidence);\n  }, [transcriptSegments, lastTranscriptionResult, audioUri, onTranscriptionComplete]);\n\n  // Function to determine if secret tag detection should be treated as a command or normal content\n  const shouldTreatAsSecretTagCommand = (transcript: string, secretTagDetected: any): boolean => {\n    if (!secretTagDetected?.tagName) return false;\n    \n    // Normalize function: lowercase, remove punctuation and spaces, keep only letters and numbers\n    const normalize = (text: string): string => {\n      return text.toLowerCase().replace(/[^a-z0-9]/g, '');\n    };\n    \n    const normalizedTranscript = normalize(transcript);\n    const normalizedPhrase = normalize(secretTagDetected.tagName);\n    \n    // Secret tag activation requires exact match after normalization\n    const isExactMatch = normalizedTranscript === normalizedPhrase;\n    \n    if (isExactMatch) {\n      logger.info(`[shouldTreatAsSecretTagCommand] Exact match found - transcript: \"${normalizedTranscript}\" matches phrase: \"${normalizedPhrase}\"`);\n    } else {\n      logger.info(`[shouldTreatAsSecretTagCommand] No exact match - transcript: \"${normalizedTranscript}\" vs phrase: \"${normalizedPhrase}\"`);\n    }\n    \n    return isExactMatch;\n  };\n\n  // Simplified segment processing with single language support\n  const processSegment = async (uri: string, languageCode: string) => {\n    if (!isMountedRef.current || processedUris.has(uri)) {\n      logger.info(`[processSegment] Skipping ${uri} - component unmounted or already processed.`);\n      return;\n    }\n\n    setProcessedUris(prev => new Set(prev).add(uri));\n    setIsTranscribingSegment(true);\n    setCurrentSegmentTranscript('Processing...');\n\n    try {\n      logger.info(`[processSegment] Starting transcription for ${uri} with language: ${languageCode}`);\n      \n      // Use speech service with single language code (or auto-detect) and secret tag detection\n      const languageCodes = languageCode === 'auto' ? undefined : [languageCode];\n      const result = await speechToTextService.transcribeAudio(uri, {\n        languageCodes,\n        maxAlternatives: 3,\n        enableWordConfidence: true,\n        enableSecretTagDetection: true\n      });\n\n      if (!isMountedRef.current) {\n        logger.info('[processSegment] Component unmounted during transcription, ignoring result.');\n        return;\n      }\n\n      // Store enhanced transcription result\n      setLastTranscriptionResult(result);\n      \n      // Get quality assessment\n      const qualityAssessment = speechToTextService.getQualityAssessment(result);\n\n      const transcript = result.transcript?.trim();\n      if (transcript) {\n        // Check if a secret tag was detected\n        if (result.secret_tag_detected?.found) {\n          // Determine if this should be treated as a secret tag command or normal content\n          const isSecretTagCommand = shouldTreatAsSecretTagCommand(transcript, result.secret_tag_detected);\n          \n          if (isSecretTagCommand) {\n            logger.info(`[processSegment] Secret tag command detected - not adding \"${transcript}\" to transcript segments`);\n            const action = result.secret_tag_detected.action === 'activate' ? 'activated' : 'deactivated';\n            setCurrentSegmentTranscript(`Secret tag ${action} successfully`);\n            \n            // Show brief success message then clear\n            setTimeout(() => {\n              if (isMountedRef.current) {\n                setCurrentSegmentTranscript('');\n              }\n            }, 2000);\n            \n            return; // Exit early - don't add to segments or trigger auto-save\n          } else {\n            logger.info(`[processSegment] Secret tag detected but treating as normal content: \"${transcript}\"`);\n            // Continue with normal processing - this will create an entry\n          }\n        }\n        \n        // Capitalize first letter of the transcript segment\n        const capitalizedTranscript = transcript.charAt(0).toUpperCase() + transcript.slice(1);\n        \n        logger.info(\n          `[processSegment] Transcription completed - ` +\n          `Text: \"${transcript.substring(0, 50)}...\", ` +\n          `Confidence: ${result.confidence.toFixed(2)}, ` +\n          `Language: ${result.detected_language_code || languageCode}, ` +\n          `Quality: ${qualityAssessment.overall}, ` +\n          `Alternatives: ${result.alternatives.length}`\n        );\n\n        // Show quality recommendations if needed\n        if (qualityAssessment.recommendations.length > 0) {\n          logger.info(`Quality recommendations: ${qualityAssessment.recommendations.join(', ')}`);\n        }\n        \n        // Update transcript segments first\n        setTranscriptSegments(prev => {\n          const newSegments = [...prev, capitalizedTranscript];\n          logger.info(`[processSegment] Updated transcript segments: ${newSegments.length} segments, latest: \"${capitalizedTranscript}\"`);\n          \n          // Trigger auto-save with the complete transcript INSIDE the state update\n          if (settings.autoSaveEnabled && onAutoSave) {\n            const newTranscript = newSegments.join('\\n');\n            logger.info(`[AutoSave] Triggering auto-save due to new segment. Full transcript: \"${newTranscript}\"`);\n            // Use setTimeout to ensure the state update completes first\n            setTimeout(() => {\n              onAutoSave(newTranscript);\n            }, 0);\n          }\n          \n          return newSegments;\n        });\n        \n        setCurrentSegmentTranscript('');\n      } else {\n        setCurrentSegmentTranscript('No speech detected in this segment.');\n        logger.warn('[processSegment] No transcript received from service.');\n      }\n\n    } catch (error: any) {\n      logger.error('[processSegment] Transcription failed:', error);\n      if (isMountedRef.current) {\n        setCurrentSegmentTranscript(`Error: ${error.message || 'Transcription failed'}`);\n      }\n    } finally {\n      if (isMountedRef.current) {\n        setIsTranscribingSegment(false);\n      }\n      \n      // Clean up the audio file\n      try {\n        await cleanupRecordingFile(uri);\n        logger.info(`[processSegment] Cleaned up audio file: ${uri}`);\n      } catch (cleanupError) {\n        logger.error(`[processSegment] Failed to clean up audio file ${uri}:`, cleanupError);\n      }\n    }\n  };\n\n  // Simplified effect to process audio with selected language\n  useEffect(() => {\n    if (audioUri && !isRecording && !processedUris.has(audioUri) && permissionGranted) {\n      // Validate language code\n      if (selectedLanguage !== 'auto' && !validateLanguageCode(selectedLanguage)) {\n        logger.error(`Invalid language selection: ${selectedLanguage}`);\n        Alert.alert('Language Selection Error', 'Invalid language selected. Using auto-detect.');\n        setSelectedLanguage('auto');\n        return;\n      }\n\n      logger.info(\n        `[AudioRecorder] useEffect detected new audioUri: ${audioUri} ` +\n        `for language: ${selectedLanguage}. Starting processSegment.`\n      );\n      \n      processSegment(audioUri, selectedLanguage);\n    }\n  }, [audioUri, isRecording, processedUris, permissionGranted, selectedLanguage]);\n\n  const handleMicPress = async () => {\n    if (!permissionGranted) {\n      Alert.alert('Permissions Required', 'Audio recording permission is needed to record.');\n      logger.warn('Mic pressed but permission not granted.');\n      return;\n    }\n\n    if (isRecording) {\n      logger.info('[AudioRecorder] Mic press: Stopping current recording segment.');\n      hapticService.medium(); // Medium haptic feedback for stop action\n      try {\n        await stopRecording();\n      } catch (error) {\n        logger.error('[AudioRecorder] Error stopping recording segment:', error);\n      }\n    } else { // Not recording\n      if (isTranscribingSegment) {\n        logger.info('[AudioRecorder] Mic press: Still transcribing previous segment. Please wait.');\n        hapticService.warning(); // Warning haptic for blocked action\n        Alert.alert('Processing', 'Still processing the previous audio. Please wait a moment.');\n        return;\n      }\n      \n      // Reset callback flag for new recording session\n      callbackCalledRef.current = false;\n      \n      logger.info('[AudioRecorder] Mic press: Starting new recording segment.');\n      hapticService.heavy(); // Heavy haptic feedback for start recording action\n      try {\n        await startRecording();\n      } catch (error) {\n        logger.error('[AudioRecorder] Error starting new recording segment:', error);\n        Alert.alert('Error Starting Recording', 'Could not start a new recording. Please try again.');\n      }\n    }\n  };\n\n  // Language selection handler\n  const handleLanguageChange = (languageCode: string) => {\n    if (validateLanguageCode(languageCode) || languageCode === 'auto') {\n      setSelectedLanguage(languageCode);\n      logger.info(`Language changed to: ${languageCode}`);\n    } else {\n      logger.error(`Invalid language code: ${languageCode}`);\n    }\n  };\n\n  const formatDuration = (seconds: number) => {\n    const mins = Math.floor(seconds / 60);\n    const secs = seconds % 60;\n    return `${mins}:${secs.toString().padStart(2, '0')}`;\n  };\n\n  // Function to sanitize/clean transcript text\n  const sanitizeText = (text: string): string => {\n    return text.replace(/^[\\(\\[\\\\-\\*]+\\s*/g, '').trim();\n  };\n\n  const canAcceptTranscript = !isRecording && !isTranscribingSegment && transcriptSegments.length > 0;\n\n  return {\n    // State\n    transcriptSegments,\n    setTranscriptSegments,\n    currentSegmentTranscript,\n    isTranscribingSegment,\n    lastTranscriptionResult,\n    showAlternatives,\n    setShowAlternatives,\n    selectedLanguage,\n    isProcessing,\n    hasTranscribedAudio,\n    canAcceptTranscript,\n    \n    // Animation refs\n    pulseAnim,\n    waveAnim1,\n    waveAnim2,\n    \n    // Audio recording state\n    isRecording,\n    recordingDuration,\n    audioUri,\n    permissionGranted,\n    recordingError,\n    \n    // Handlers\n    handleMicPress,\n    handleAcceptTranscript,\n    handleDone,\n    handleLanguageChange,\n    formatDuration,\n    sanitizeText,\n  };\n};","import React, { useRef, useEffect, useImperativeHandle, forwardRef, useCallback } from 'react';\nimport {\n  View,\n  StyleSheet,\n  Animated,\n  Dimensions,\n  TouchableWithoutFeedback,\n  Modal,\n  Platform,\n} from 'react-native';\nimport { PanGestureHandler, State } from 'react-native-gesture-handler';\nimport { useAppTheme } from '../contexts/ThemeContext';\nimport { AppTheme } from '../config/theme';\n\nconst { height: SCREEN_HEIGHT } = Dimensions.get('window');\n\n// Helper for native driver compatibility\nconst useNativeDriver = Platform.OS !== 'web';\n\ninterface BottomSheetProps {\n  children: React.ReactNode;\n  visible: boolean;\n  onClose: () => void;\n  snapPoints?: number[];\n  initialSnapPoint?: number;\n  enablePanGesture?: boolean;\n  backdropOpacity?: number;\n  style?: object;\n}\n\nexport interface BottomSheetRef {\n  snapTo: (index: number) => void;\n  close: () => void;\n}\n\nconst BottomSheet = forwardRef<BottomSheetRef, BottomSheetProps>(({\n  children,\n  visible,\n  onClose,\n  snapPoints = [0.3, 0.6, 0.9],\n  initialSnapPoint = 1,\n  enablePanGesture = true,\n  backdropOpacity = 0.5,\n  style,\n}, ref) => {\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n  \n  const translateY = useRef(new Animated.Value(SCREEN_HEIGHT)).current;\n  const backdropOpacity_ = useRef(new Animated.Value(0)).current;\n  const lastGestureY = useRef(0);\n  const currentSnapIndex = useRef(initialSnapPoint);\n  const gestureTranslateY = useRef(new Animated.Value(0)).current;\n\n  const snapPointsInPixels = snapPoints.map(point => SCREEN_HEIGHT * (1 - point));\n\n  useImperativeHandle(ref, () => ({\n    snapTo: (index: number) => {\n      if (index >= 0 && index < snapPointsInPixels.length) {\n        currentSnapIndex.current = index;\n        Animated.spring(translateY, {\n          toValue: snapPointsInPixels[index],\n          useNativeDriver,\n        }).start();\n      }\n    },\n    close: () => {\n      onClose();\n    },\n  }));\n\n  useEffect(() => {\n    if (visible) {\n      // Show bottom sheet\n      Animated.parallel([\n        Animated.spring(translateY, {\n          toValue: snapPointsInPixels[initialSnapPoint],\n          useNativeDriver,\n        }),\n        Animated.timing(backdropOpacity_, {\n          toValue: 1,\n          duration: 300,\n          useNativeDriver,\n        }),\n      ]).start();\n      currentSnapIndex.current = initialSnapPoint;\n    } else {\n      // Hide bottom sheet\n      Animated.parallel([\n        Animated.spring(translateY, {\n          toValue: SCREEN_HEIGHT,\n          useNativeDriver,\n        }),\n        Animated.timing(backdropOpacity_, {\n          toValue: 0,\n          duration: 300,\n          useNativeDriver,\n        }),\n      ]).start();\n    }\n  }, [visible, initialSnapPoint]);\n\n  // Use a more React-friendly approach for gesture handling\n  const onGestureEvent = useCallback(\n    Animated.event(\n      [{ nativeEvent: { translationY: gestureTranslateY } }],\n      { \n        useNativeDriver: false, // Set to false for web compatibility\n        listener: (event: any) => {\n          // Optional: Add any additional gesture handling here\n          if (!enablePanGesture) return;\n          \n          const { translationY } = event.nativeEvent;\n          lastGestureY.current = translationY;\n        }\n      }\n    ),\n    [enablePanGesture, gestureTranslateY]\n  );\n\n  const onHandlerStateChange = useCallback((event: any) => {\n    if (!enablePanGesture) return;\n\n    if (event.nativeEvent.oldState === State.ACTIVE) {\n      const { translationY, velocityY } = event.nativeEvent;\n      const currentY = snapPointsInPixels[currentSnapIndex.current] + translationY;\n      \n      // Reset gesture value\n      gestureTranslateY.setValue(0);\n      \n      // Determine which snap point to go to\n      let targetSnapIndex = currentSnapIndex.current;\n      \n      if (velocityY > 500) {\n        // Fast downward swipe - go to next snap point or close\n        targetSnapIndex = Math.min(currentSnapIndex.current + 1, snapPointsInPixels.length - 1);\n        if (targetSnapIndex === snapPointsInPixels.length - 1 && translationY > 100) {\n          onClose();\n          return;\n        }\n      } else if (velocityY < -500) {\n        // Fast upward swipe - go to previous snap point\n        targetSnapIndex = Math.max(currentSnapIndex.current - 1, 0);\n      } else {\n        // Find closest snap point\n        let minDistance = Infinity;\n        snapPointsInPixels.forEach((point, index) => {\n          const distance = Math.abs(currentY - point);\n          if (distance < minDistance) {\n            minDistance = distance;\n            targetSnapIndex = index;\n          }\n        });\n        \n        // If dragged down significantly, close\n        if (currentY > SCREEN_HEIGHT * 0.8) {\n          onClose();\n          return;\n        }\n      }\n\n      currentSnapIndex.current = targetSnapIndex;\n      Animated.spring(translateY, {\n        toValue: snapPointsInPixels[targetSnapIndex],\n        useNativeDriver,\n      }).start();\n    }\n  }, [enablePanGesture, snapPointsInPixels, onClose, translateY]);\n\n  const handleBackdropPress = () => {\n    onClose();\n  };\n\n  if (!visible) {\n    return null;\n  }\n\n  // Combine translateY and gestureTranslateY for smoother gestures\n  const combinedTranslateY = Animated.add(translateY, gestureTranslateY);\n\n  const content = (\n    <View style={styles.container}>\n      \n      <TouchableWithoutFeedback onPress={handleBackdropPress}>\n        <Animated.View\n          style={[\n            styles.backdrop,\n            {\n              opacity: backdropOpacity_.interpolate({\n                inputRange: [0, 1],\n                outputRange: [0, backdropOpacity],\n              }),\n            },\n          ]}\n        />\n      </TouchableWithoutFeedback>\n\n      <PanGestureHandler\n        onGestureEvent={onGestureEvent}\n        onHandlerStateChange={onHandlerStateChange}\n        enabled={enablePanGesture}\n      >\n        <Animated.View\n          style={[\n            styles.bottomSheet,\n            style,\n            {\n              transform: [{ translateY: combinedTranslateY }],\n            },\n          ]}\n        >\n          <View style={styles.handle} />\n          <View style={styles.content}>\n            {children}\n          </View>\n        </Animated.View>\n      </PanGestureHandler>\n    </View>\n  );\n\n  if (Platform.OS === 'ios') {\n    return (\n      <Modal\n        transparent\n        visible={visible}\n        animationType=\"none\"\n        onRequestClose={onClose}\n      >\n        {content}\n      </Modal>\n    );\n  }\n\n  return content;\n});\n\nconst getStyles = (theme: AppTheme) => StyleSheet.create({\n  container: {\n    flex: 1,\n    justifyContent: 'flex-end',\n  },\n  backdrop: {\n    ...StyleSheet.absoluteFillObject,\n    backgroundColor: theme.colors.overlay,\n  },\n  bottomSheet: {\n    backgroundColor: theme.colors.surface,\n    borderTopLeftRadius: theme.borderRadius.xxl,\n    borderTopRightRadius: theme.borderRadius.xxl,\n    minHeight: SCREEN_HEIGHT * 0.3,\n    maxHeight: SCREEN_HEIGHT * 0.95,\n    ...theme.shadows.xl,\n  },\n  handle: {\n    width: 40,\n    height: 4,\n    backgroundColor: theme.colors.border,\n    borderRadius: 2,\n    alignSelf: 'center',\n    marginTop: theme.spacing.md,\n    marginBottom: theme.spacing.lg,\n  },\n  content: {\n    flex: 1,\n    paddingHorizontal: theme.spacing.lg,\n    paddingBottom: theme.spacing.xl,\n  },\n});\n\nexport default BottomSheet; ","import React, { useState, useRef } from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  TouchableOpacity,\n  FlatList,\n  TextInput,\n} from 'react-native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { useAppTheme } from '../contexts/ThemeContext';\nimport { AppTheme } from '../config/theme';\nimport { LanguageOption, SUPPORTED_LANGUAGES, getLanguageName } from '../config/languageConfig';\nimport BottomSheet, { BottomSheetRef } from './BottomSheet';\n\ninterface LanguageSelectorProps {\n  selectedLanguage: string;\n  onLanguageChange: (languageCode: string) => void;\n  disabled?: boolean;\n}\n\nconst LanguageSelector: React.FC<LanguageSelectorProps> = ({\n  selectedLanguage,\n  onLanguageChange,\n  disabled = false,\n}) => {\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n  const [modalVisible, setModalVisible] = useState(false);\n  const [searchQuery, setSearchQuery] = useState('');\n  const bottomSheetRef = useRef<BottomSheetRef>(null);\n\n  const selectedLanguageName = getLanguageName(selectedLanguage) || 'Auto-detect';\n\n  // Filter languages based on search query\n  const filteredLanguages = SUPPORTED_LANGUAGES.filter(language => {\n    if (!searchQuery.trim()) return true;\n    \n    const query = searchQuery.toLowerCase();\n    return (\n      language.name.toLowerCase().includes(query) ||\n      language.code.toLowerCase().includes(query) ||\n      (language.region && language.region.toLowerCase().includes(query))\n    );\n  });\n\n  const handleLanguageSelect = (languageCode: string) => {\n    onLanguageChange(languageCode);\n    setModalVisible(false);\n    setSearchQuery(''); // Clear search when closing\n  };\n\n  const handleOpenSelector = () => {\n    if (!disabled) {\n      setModalVisible(true);\n    }\n  };\n\n  const handleCloseSelector = () => {\n    setModalVisible(false);\n    setSearchQuery(''); // Clear search when closing\n  };\n\n  const renderLanguageItem = ({ item }: { item: LanguageOption }) => (\n    <TouchableOpacity\n      style={[\n        styles.languageItem,\n        item.code === selectedLanguage && styles.selectedLanguageItem\n      ]}\n      onPress={() => handleLanguageSelect(item.code)}\n      accessibilityLabel={`Select ${item.name} language`}\n      accessibilityRole=\"button\"\n    >\n      <View style={styles.languageInfo}>\n        <Text style={[\n          styles.languageName,\n          item.code === selectedLanguage && styles.selectedLanguageName\n        ]}>\n          {item.region ? `${item.name} (${item.region})` : item.name}\n        </Text><Text style={[\n          styles.languageCode,\n          item.code === selectedLanguage && styles.selectedLanguageCode\n        ]}>\n          {item.code}\n        </Text>\n      </View>{item.code === selectedLanguage && (\n        <View style={styles.checkmarkContainer}>\n          <Ionicons name=\"checkmark-circle\" size={24} color={theme.colors.primary} />\n        </View>\n      )}\n    </TouchableOpacity>\n  );\n\n  const renderEmptyState = () => (\n    <View style={styles.emptyState}>\n      <Ionicons name=\"search-outline\" size={48} color={theme.colors.textDisabled} /><Text style={styles.emptyStateText}>No languages found</Text><Text style={styles.emptyStateSubtext}>Try a different search term</Text>\n    </View>\n  );\n\n  return (\n    <View style={styles.container}>\n      <TouchableOpacity\n        style={[styles.selector, disabled && styles.selectorDisabled]}\n        onPress={handleOpenSelector}\n        disabled={disabled}\n        accessibilityLabel={`Current language: ${selectedLanguageName}. Tap to change.`}\n        accessibilityRole=\"button\"\n        accessibilityHint=\"Opens language selection menu\"\n      >\n        <View style={styles.selectorContent}>\n          <View style={styles.iconContainer}>\n            <Ionicons \n              name=\"language\" \n              size={22} \n              color={disabled ? theme.colors.disabled : theme.colors.primary} \n            />\n          </View><View style={styles.textContainer}>\n            <Text style={styles.selectorLabel}>Language</Text><Text style={[\n              styles.selectorText,\n              disabled && styles.selectorTextDisabled\n            ]}>\n              {selectedLanguageName}\n            </Text>\n          </View>\n        </View><Ionicons \n          name=\"chevron-down\" \n          size={20} \n          color={disabled ? theme.colors.disabled : theme.colors.textSecondary} \n        />\n      </TouchableOpacity><BottomSheet\n        visible={modalVisible}\n        onClose={handleCloseSelector}\n        snapPoints={[0.7, 0.9]}\n        initialSnapPoint={0}\n      >\n        <View style={styles.modalContent}>\n          <View style={styles.modalHeader}>\n            <Text style={styles.modalTitle}>Select Language</Text><Text style={styles.modalSubtitle}>\n              Choose your preferred language for voice transcription\n            </Text>\n          </View><View style={styles.searchContainer}>\n            <View style={styles.searchInputWrapper}>\n              <Ionicons \n                name=\"search\" \n                size={20} \n                color={theme.colors.textSecondary} \n                style={styles.searchIcon}\n              /><TextInput\n                style={styles.searchInput}\n                value={searchQuery}\n                onChangeText={setSearchQuery}\n                placeholder=\"Search languages...\"\n                placeholderTextColor={theme.colors.textSecondary}\n                returnKeyType=\"search\"\n                autoCorrect={false}\n                autoCapitalize=\"none\"\n              />{searchQuery.length > 0 && (\n                <TouchableOpacity\n                  onPress={() => setSearchQuery('')}\n                  style={styles.clearButton}\n                  accessibilityLabel=\"Clear search\"\n                >\n                  <Ionicons name=\"close-circle\" size={20} color={theme.colors.textSecondary} />\n                </TouchableOpacity>\n              )}\n            </View>\n          </View>{searchQuery.trim() && (\n            <Text style={styles.resultsCount}>\n              {filteredLanguages.length} language{filteredLanguages.length === 1 ? '' : 's'} found\n            </Text>\n          )}<FlatList\n            data={filteredLanguages}\n            keyExtractor={(item) => item.code}\n            renderItem={renderLanguageItem}\n            style={styles.languageList}\n            showsVerticalScrollIndicator={true}\n            ListEmptyComponent={renderEmptyState}\n            keyboardShouldPersistTaps=\"handled\"\n            getItemLayout={(data, index) => ({\n              length: 72,\n              offset: 72 * index,\n              index,\n            })}\n            initialNumToRender={10}\n            maxToRenderPerBatch={10}\n            windowSize={10}\n          />\n        </View>\n      </BottomSheet>\n    </View>\n  );\n};\n\nconst getStyles = (theme: AppTheme) => StyleSheet.create({\n  container: {\n    marginVertical: theme.spacing.md,\n  },\n  selector: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    backgroundColor: theme.colors.card,\n    borderRadius: theme.borderRadius.lg,\n    paddingHorizontal: theme.spacing.lg,\n    paddingVertical: theme.spacing.lg,\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n    minHeight: 64,\n    ...theme.shadows.sm,\n  },\n  selectorDisabled: {\n    opacity: 0.6,\n    backgroundColor: theme.colors.disabled,\n  },\n  selectorContent: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    flex: 1,\n  },\n  iconContainer: {\n    width: 40,\n    height: 40,\n    borderRadius: theme.borderRadius.lg,\n    backgroundColor: theme.colors.primaryLight + '20',\n    justifyContent: 'center',\n    alignItems: 'center',\n    marginRight: theme.spacing.md,\n  },\n  textContainer: {\n    flex: 1,\n  },\n  selectorLabel: {\n    fontSize: theme.typography.fontSizes.sm,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.medium,\n    marginBottom: theme.spacing.xs,\n  },\n  selectorText: {\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n  selectorTextDisabled: {\n    color: theme.colors.disabled,\n  },\n  modalContent: {\n    flex: 1,\n  },\n  modalHeader: {\n    marginBottom: theme.spacing.lg,\n  },\n  modalTitle: {\n    fontSize: theme.typography.fontSizes.xl,\n    fontWeight: 'bold',\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.bold,\n    marginBottom: theme.spacing.xs,\n  },\n  modalSubtitle: {\n    fontSize: theme.typography.fontSizes.sm,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  searchContainer: {\n    marginBottom: theme.spacing.lg,\n  },\n  searchInputWrapper: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: theme.colors.inputBackground,\n    borderRadius: theme.borderRadius.lg,\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n    paddingHorizontal: theme.spacing.md,\n    minHeight: 48,\n  },\n  searchIcon: {\n    marginRight: theme.spacing.sm,\n  },\n  searchInput: {\n    flex: 1,\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.regular,\n    paddingVertical: theme.spacing.md,\n  },\n  clearButton: {\n    padding: theme.spacing.xs,\n    marginLeft: theme.spacing.sm,\n  },\n  resultsCount: {\n    fontSize: theme.typography.fontSizes.sm,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.regular,\n    marginBottom: theme.spacing.md,\n    textAlign: 'center',\n  },\n  languageList: {\n    flex: 1,\n  },\n  languageItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingVertical: theme.spacing.lg,\n    paddingHorizontal: theme.spacing.md,\n    borderRadius: theme.borderRadius.md,\n    marginBottom: theme.spacing.xs,\n    minHeight: 72,\n  },\n  selectedLanguageItem: {\n    backgroundColor: theme.colors.primaryLight + '20',\n    borderWidth: 1,\n    borderColor: theme.colors.primaryLight + '40',\n  },\n  languageInfo: {\n    flex: 1,\n  },\n  languageName: {\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n    marginBottom: theme.spacing.xs,\n  },\n  selectedLanguageName: {\n    color: theme.colors.primary,\n  },\n  languageCode: {\n    fontSize: theme.typography.fontSizes.sm,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  selectedLanguageCode: {\n    color: theme.colors.primary,\n  },\n  checkmarkContainer: {\n    marginLeft: theme.spacing.md,\n  },\n  emptyState: {\n    alignItems: 'center',\n    justifyContent: 'center',\n    paddingVertical: theme.spacing.xxxl,\n  },\n  emptyStateText: {\n    fontSize: theme.typography.fontSizes.lg,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n    marginTop: theme.spacing.md,\n    marginBottom: theme.spacing.xs,\n  },\n  emptyStateSubtext: {\n    fontSize: theme.typography.fontSizes.sm,\n    color: theme.colors.textDisabled,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n});\n\nexport default LanguageSelector; ","import React, { useState, useEffect, useRef, useCallback } from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  TouchableOpacity,\n  ActivityIndicator,\n  ScrollView,\n  Animated,\n  Platform,\n  TextInput,\n  Modal,\n} from 'react-native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { useAppTheme } from '../contexts/ThemeContext';\nimport { AppTheme } from '../config/theme';\nimport { TranscriptionResult } from '../hooks/useAudioRecorderLogic';\nimport { getLanguageName } from '../config/languageConfig';\n\n// Import simple language selector\nimport LanguageSelector from './LanguageSelector';\n\n// Helper function to add alpha to hex colors\nconst addAlpha = (color: string, alpha: string): string => {\n  // If color already has alpha, return as is\n  if (color.length === 9) return color;\n  // Add alpha to 6-digit hex color\n  if (color.length === 7) return color + alpha;\n  // For other formats, just return the color (won't add alpha)\n  return color;\n};\n\ninterface SaveButtonState {\n  text: string;\n  disabled: boolean;\n  isSaving: boolean;\n}\n\ninterface AudioRecorderUIProps {\n  // State props\n  transcriptSegments: string[];\n  setTranscriptSegments: React.Dispatch<React.SetStateAction<string[]>>;\n  currentSegmentTranscript: string;\n  isTranscribingSegment: boolean;\n  lastTranscriptionResult: TranscriptionResult | null;\n  showAlternatives: boolean;\n\n  selectedLanguage: string;\n  isProcessing: boolean;\n  canAcceptTranscript: boolean;\n  \n  // Animation refs\n  pulseAnim: Animated.Value;\n  waveAnim1: Animated.Value;\n  waveAnim2: Animated.Value;\n  \n  // Audio recording state\n  isRecording: boolean;\n  recordingDuration: number;\n  permissionGranted: boolean;\n  \n  // Handlers\n  handleMicPress: () => void;\n  handleAcceptTranscript: () => void;\n  handleLanguageChange: (languageCode: string) => void;\n  formatDuration: (seconds: number) => string;\n  setShowAlternatives: (show: boolean) => void;\n  \n  // Save button state\n  saveButtonState?: SaveButtonState;\n  \n  // Optional close handler for modal mode\n  onClose?: () => void;\n  \n  // Optional existing content to show as context\n  existingContent?: string;\n  \n  // Optional handler for saving with complete edited text\n  onSaveWithCompleteText?: (completeText: string) => void;\n}\n\n// Waveform component for dynamic visualization\nconst WaveformVisualization: React.FC<{\n  isRecording: boolean;\n  waveAnim1: Animated.Value;\n  waveAnim2: Animated.Value;\n  theme: AppTheme;\n}> = ({ isRecording, waveAnim1, waveAnim2, theme }) => {\n  const waveformBars = Array.from({ length: 12 }, (_, i) => {\n    // Create staggered animation for each bar\n    const animValue = i % 2 === 0 ? waveAnim1 : waveAnim2;\n    const delay = i * 50; // Stagger the animation\n    \n    return (\n      <Animated.View\n        key={i}\n        style={[\n          {\n            width: 3,\n            backgroundColor: theme.colors.primary,\n            marginHorizontal: 1,\n            borderRadius: 1.5,\n          },\n          {\n            height: animValue.interpolate({\n              inputRange: [0, 1],\n              outputRange: [8, 25 + Math.random() * 15], // Random heights for more dynamic look\n            }),\n          },\n        ]}\n      />\n    );\n  });\n\n  return (\n    <View style={{\n      flexDirection: 'row',\n      alignItems: 'center',\n      justifyContent: 'center',\n      height: 40,\n      marginVertical: theme.spacing.sm, // Further reduced spacing\n    }}>\n      {waveformBars}\n    </View>\n  );\n};\n\nexport const AudioRecorderUI: React.FC<AudioRecorderUIProps> = ({\n  transcriptSegments,\n  setTranscriptSegments,\n  currentSegmentTranscript,\n  isTranscribingSegment,\n  lastTranscriptionResult,\n  showAlternatives,\n  selectedLanguage,\n  isProcessing,\n  canAcceptTranscript,\n  pulseAnim,\n  waveAnim1,\n  waveAnim2,\n  isRecording,\n  recordingDuration,\n  permissionGranted,\n  handleMicPress,\n  handleAcceptTranscript,\n  handleLanguageChange,\n  formatDuration,\n  setShowAlternatives,\n  saveButtonState,\n  onClose,\n  existingContent,\n  onSaveWithCompleteText,\n}) => {\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n  const [isLanguageModalVisible, setLanguageModalVisible] = useState(false);\n  const pulseAnimRef = useRef(new Animated.Value(1)).current;\n\n  // Animate recording button pulse\n  useEffect(() => {\n    if (isRecording) {\n      const pulseAnimation = Animated.loop(\n        Animated.sequence([\n          Animated.timing(pulseAnimRef, {\n            toValue: 1.1,\n            duration: 800,\n            useNativeDriver: true,\n          }),\n          Animated.timing(pulseAnimRef, {\n            toValue: 1,\n            duration: 800,\n            useNativeDriver: true,\n          }),\n        ])\n      );\n      pulseAnimation.start();\n      return () => pulseAnimation.stop();\n    } else {\n      pulseAnimRef.setValue(1);\n    }\n  }, [isRecording, pulseAnimRef]);\n\n  // Track user-edited text separately to avoid feedback loops\n  const [editedText, setEditedText] = useState(existingContent || '');\n  const [hasUserEdited, setHasUserEdited] = useState(false);\n\n  // Compute display text for the TextInput\n  const getDisplayText = () => {\n    // If user has manually edited the text, use that\n    if (hasUserEdited) {\n      return editedText;\n    }\n    \n    // Build the complete display text from all available sources\n    let displayParts = [];\n    \n    // Add existing content if available\n    if (existingContent && existingContent.trim()) {\n      displayParts.push(existingContent);\n    }\n    \n    // Add completed segments if available\n    if (transcriptSegments.length > 0) {\n      displayParts.push(transcriptSegments.join('\\n'));\n    }\n    \n    // Add current segment being transcribed ONLY during active transcription\n    if (isTranscribingSegment && \n        currentSegmentTranscript && \n        currentSegmentTranscript.trim() && \n        currentSegmentTranscript !== 'Processing...') {\n      displayParts.push(currentSegmentTranscript);\n    }\n    \n    return displayParts.join('\\n\\n');\n  };\n\n  // Get effective save button state\n  const effectiveSaveButtonState = saveButtonState || {\n    text: 'Save',\n    disabled: !canAcceptTranscript,\n    isSaving: false\n  };\n\n  // Handle save button press\n  const handleSavePress = useCallback(() => {\n    if (onSaveWithCompleteText && existingContent) {\n      // Get the current text for saving\n      let textToSave;\n      if (hasUserEdited) {\n        // User has manually edited\n        textToSave = editedText;\n      } else {\n        // Build the complete text from all available sources (same as display logic)\n        let saveParts = [];\n        \n        // Add existing content if available\n        if (existingContent && existingContent.trim()) {\n          saveParts.push(existingContent);\n        }\n        \n        // Add completed segments if available\n        if (transcriptSegments.length > 0) {\n          saveParts.push(transcriptSegments.join('\\n'));\n        }\n        \n        textToSave = saveParts.join('\\n\\n');\n      }\n      \n      onSaveWithCompleteText(textToSave);\n      \n      // After save, update the display to show the saved content\n      setEditedText(textToSave);\n      setHasUserEdited(true); // Mark as edited so it shows the saved content\n      // Clear transcript segments to prevent re-accumulation\n      setTranscriptSegments([]);\n    } else {\n      // For new entries, get the current transcript and save it\n      const currentTranscript = transcriptSegments.join('\\n').trim();\n      if (currentTranscript) {\n        handleAcceptTranscript();\n        // After save, update display to show the saved content\n        setEditedText(currentTranscript);\n        setHasUserEdited(true);\n        // Clear segments to prevent accumulation\n        setTranscriptSegments([]);\n      }\n    }\n  }, [onSaveWithCompleteText, existingContent, editedText, hasUserEdited, transcriptSegments, handleAcceptTranscript, setTranscriptSegments]);\n\n  // Get display text for transcription area\n  const getTranscriptionDisplayText = () => {\n    if (isTranscribingSegment) {\n      return 'Processing audio...';\n    }\n    if (editedText) {\n      return editedText;\n    }\n    if (isRecording) {\n      return 'Listening...';\n    }\n    return 'Tap the microphone to start recording';\n  };\n\n  return (\n    <View style={styles.container}>\n      {/* Top Bar with Timer and Icons */}\n      <View style={styles.topBar}>\n        {/* Timer - Top Left */}\n        <Text style={styles.timerTextTopLeft}>\n          {formatDuration(recordingDuration)}\n        </Text>\n        \n        {/* Icons - Top Right */}\n        <View style={styles.topRightIcons}>\n          {/* Language Icon */}\n          <TouchableOpacity\n            style={styles.languageButton}\n            onPress={() => setLanguageModalVisible(true)}\n            disabled={isRecording}\n          >\n            <Ionicons \n              name=\"language\" \n              size={20} \n              color={isRecording ? theme.colors.disabled : theme.colors.primary} \n            />\n          </TouchableOpacity>\n          \n          {/* Lock Icon */}\n          <TouchableOpacity\n            style={styles.lockButton}\n            onPress={() => setLanguageModalVisible(true)}\n            disabled={isRecording}\n          >\n            <Ionicons \n              name=\"lock-closed\" \n              size={20} \n              color={isRecording ? theme.colors.disabled : theme.colors.textSecondary} \n            />\n          </TouchableOpacity>\n        </View>\n      </View>\n      \n      {/* Waveform Visualization */}\n      <WaveformVisualization\n        isRecording={isRecording}\n        waveAnim1={waveAnim1}\n        waveAnim2={waveAnim2}\n        theme={theme}\n      />\n      \n      {/* Recording Button */}\n      <View style={styles.recordingButtonContainer}>\n        <Animated.View style={[\n          styles.recordingButtonOuter,\n          { transform: [{ scale: pulseAnimRef }] }\n        ]}>\n          <TouchableOpacity\n            style={[\n              styles.recordingButton,\n              { backgroundColor: isRecording ? '#E53E3E' : theme.colors.primary }\n            ]}\n            onPress={handleMicPress}\n            disabled={!permissionGranted}\n          >\n            <View style={styles.recordingButtonInner}>\n              {isRecording ? (\n                <View style={styles.stopIcon} />\n              ) : (\n                <Ionicons name=\"mic\" size={32} color=\"white\" />\n              )}\n            </View>\n          </TouchableOpacity>\n        </Animated.View>\n      </View>\n      \n      {/* Recording Status */}\n      <Text style={styles.recordingStatusText}>\n        {isRecording ? 'Recording in progress' : 'Ready to record'}\n      </Text>\n      \n      {/* Spacer to push transcript to bottom */}\n      <View style={styles.spacer} />\n        \n      {/* Transcript Card - Bottom Area */}\n      <View style={styles.transcriptCard}>\n        {/* Header with Transcript label and Save button */}\n        <View style={styles.transcriptHeader}>\n          <View style={styles.transcriptLabelContainer}>\n            <Ionicons name=\"document-text\" size={20} color={theme.colors.primary} />\n            <Text style={styles.transcriptLabel}>Transcript</Text>\n          </View>\n          \n          <TouchableOpacity\n            style={[\n              styles.saveButtonSmall,\n              effectiveSaveButtonState.disabled && styles.saveButtonSmallDisabled\n            ]}\n            onPress={handleSavePress}\n            disabled={effectiveSaveButtonState.disabled}\n          >\n            {effectiveSaveButtonState.isSaving ? (\n              <ActivityIndicator size=\"small\" color=\"white\" />\n            ) : (\n              <Text style={styles.saveButtonSmallText}>Save</Text>\n            )}\n          </TouchableOpacity>\n        </View>\n        \n        {/* Editable Text Area */}\n        <TextInput\n          style={styles.transcriptTextInput}\n          value={getDisplayText()}\n          onChangeText={(text) => {\n            // Only allow editing when not transcribing\n            if (!isTranscribingSegment) {\n              setEditedText(text);\n              setHasUserEdited(true);\n            }\n          }}\n          multiline\n          placeholder={isTranscribingSegment ? 'Processing audio...' : (isRecording ? 'Listening...' : 'Tap the microphone to start recording')}\n          placeholderTextColor={theme.colors.textSecondary}\n          textAlignVertical=\"top\"\n          editable={!isTranscribingSegment}\n        />\n        \n        {isTranscribingSegment && (\n          <ActivityIndicator\n            size=\"small\"\n            color={theme.colors.primary}\n            style={styles.transcriptionLoader}\n          />\n        )}\n        \n        {/* Transcription Alternatives */}\n        {showAlternatives && lastTranscriptionResult?.alternatives && lastTranscriptionResult.alternatives.length > 0 && (\n          <ScrollView style={styles.alternativesScroll} showsVerticalScrollIndicator={false}>\n            <View style={styles.alternativesContainer}>\n              <Text style={styles.alternativesTitle}>Alternative transcriptions:</Text>\n              {lastTranscriptionResult.alternatives.map((alternative, index) => (\n                <TouchableOpacity\n                  key={index}\n                  style={styles.alternativeItem}\n                  onPress={() => {\n                    if (alternative.transcript && alternative.transcript.trim()) {\n                      setTranscriptSegments([alternative.transcript]);\n                      setShowAlternatives(false);\n                    }\n                  }}\n                >\n                  <Text style={styles.alternativeText}>{alternative.transcript}</Text>\n                  {alternative.confidence !== undefined && (\n                    <Text style={styles.alternativeConfidence}>\n                      {Math.round(alternative.confidence * 100)}%\n                    </Text>\n                  )}\n                </TouchableOpacity>\n              ))}\n            </View>\n          </ScrollView>\n        )}\n      </View>\n\n      {/* Language Selector Modal */}\n      <Modal\n        animationType=\"slide\"\n        transparent={true}\n        visible={isLanguageModalVisible}\n        onRequestClose={() => setLanguageModalVisible(false)}\n      >\n        <View style={styles.modalOverlay}>\n          <View style={styles.modalContent}>\n            <View style={styles.modalHeader}>\n              <Text style={styles.modalTitle}>Select Language</Text>\n              <TouchableOpacity\n                style={styles.modalCloseButton}\n                onPress={() => setLanguageModalVisible(false)}\n              >\n                <Ionicons name=\"close\" size={24} color={theme.colors.text} />\n              </TouchableOpacity>\n            </View>\n            <LanguageSelector\n              selectedLanguage={selectedLanguage}\n              onLanguageChange={(languageCode) => {\n                handleLanguageChange(languageCode);\n                setLanguageModalVisible(false);\n              }}\n            />\n          </View>\n        </View>\n      </Modal>\n    </View>\n  );\n};\n\nconst getStyles = (theme: AppTheme) => StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: 'transparent',\n  },\n  \n  // Top bar with timer and icons\n  topBar: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    paddingHorizontal: theme.spacing.lg,\n    paddingTop: theme.spacing.md,\n    paddingBottom: theme.spacing.sm,\n  },\n  \n  // Icons container in top-right\n  topRightIcons: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 12,\n  },\n  \n  // Timer in top-left\n  timerTextTopLeft: {\n    fontSize: 32,\n    fontWeight: '300',\n    color: theme.colors.text,\n    fontFamily: Platform.OS === 'ios' ? 'Helvetica Neue' : 'Roboto',\n  },\n  \n  // Language button\n  languageButton: {\n    padding: 8,\n    borderRadius: 20,\n    backgroundColor: theme.colors.surface,\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n  },\n  \n  // Lock button (language selector)\n  lockButton: {\n    padding: 8,\n    borderRadius: 20,\n    backgroundColor: theme.colors.surface,\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n  },\n  \n  // Recording button\n  recordingButtonContainer: {\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginVertical: theme.spacing.lg,\n  },\n  \n  // Spacer to push transcript to bottom - make it much smaller\n  spacer: {\n    flex: 0.3, // Further reduced from 0.5\n    minHeight: 10,\n  },\n  recordingButtonOuter: {\n    width: 120,\n    height: 120,\n    borderRadius: 60,\n    backgroundColor: 'rgba(99, 102, 241, 0.2)',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  recordingButton: {\n    width: 90,\n    height: 90,\n    borderRadius: 45,\n    alignItems: 'center',\n    justifyContent: 'center',\n    elevation: 4,\n    shadowColor: '#000',\n    shadowOffset: { width: 0, height: 2 },\n    shadowOpacity: 0.25,\n    shadowRadius: 4,\n  },\n  recordingButtonInner: {\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  stopIcon: {\n    width: 24,\n    height: 24,\n    backgroundColor: 'white',\n    borderRadius: 4,\n  },\n  \n  // Recording status\n  recordingStatusText: {\n    fontSize: 16,\n    color: '#E53E3E',\n    fontWeight: '500',\n    marginTop: theme.spacing.sm,\n    textAlign: 'center',\n  },\n  \n  // Transcript card - simplified and taking more space\n  transcriptCard: {\n    backgroundColor: theme.colors.card,\n    borderRadius: theme.borderRadius.xl,\n    marginHorizontal: theme.spacing.md,\n    marginTop: theme.spacing.md,\n    marginBottom: theme.spacing.lg, // Add bottom margin for proper spacing\n    ...theme.shadows.md,\n    borderColor: theme.colors.borderLight,\n    borderWidth: theme.isDarkMode ? 1 : 0,\n    overflow: 'hidden',\n    flex: 1, // Take remaining space\n    minHeight: 250, // Ensure substantial minimum height\n  },\n  transcriptHeader: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    paddingHorizontal: theme.spacing.lg,\n    paddingVertical: theme.spacing.md,\n    backgroundColor: theme.isDarkMode ? theme.colors.gray800 : theme.colors.gray50,\n    borderBottomWidth: 1,\n    borderBottomColor: theme.colors.borderLight,\n  },\n  transcriptLabelContainer: {\n    flexDirection: 'row',\n    alignItems: 'center',\n  },\n  transcriptLabel: {\n    fontSize: theme.typography.fontSizes.md,\n    fontWeight: '600',\n    color: theme.colors.text,\n    marginLeft: theme.spacing.sm,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n  saveButtonSmall: {\n    backgroundColor: theme.colors.primary,\n    paddingHorizontal: theme.spacing.md,\n    paddingVertical: theme.spacing.sm,\n    borderRadius: theme.borderRadius.full,\n  },\n  saveButtonSmallDisabled: {\n    backgroundColor: theme.colors.disabled,\n  },\n  saveButtonSmallText: {\n    color: theme.colors.onPrimary,\n    fontSize: theme.typography.fontSizes.sm,\n    fontWeight: '600',\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n  transcriptTextInput: {\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.text,\n    lineHeight: theme.typography.lineHeights.normal * theme.typography.fontSizes.md,\n    padding: theme.spacing.lg,\n    flex: 1, // Take remaining space in the card\n    textAlignVertical: 'top',\n    fontFamily: theme.typography.fontFamilies.regular,\n    backgroundColor: 'transparent',\n  },\n  \n  // Legacy transcription display (keeping for compatibility)\n  transcriptionContainer: {\n    width: '100%',\n    height: 120,\n    backgroundColor: theme.colors.surface,\n    borderRadius: 16,\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n    marginTop: 20,\n    position: 'relative',\n  },\n  transcriptionInput: {\n    flex: 1,\n    fontSize: 16,\n    color: theme.colors.text,\n    lineHeight: 22,\n    padding: 16,\n    textAlignVertical: 'top',\n  },\n  transcriptionScroll: {\n    flex: 1,\n  },\n  transcriptionContent: {\n    padding: 16,\n    minHeight: 88,\n  },\n  transcriptionText: {\n    fontSize: 16,\n    color: theme.colors.text,\n    lineHeight: 22,\n  },\n  alternativesScroll: {\n    maxHeight: 80,\n    paddingHorizontal: theme.spacing.lg,\n    paddingBottom: theme.spacing.sm,\n  },\n  transcriptionLoader: {\n    position: 'absolute',\n    bottom: theme.spacing.md,\n    right: theme.spacing.md,\n  },\n  \n  // Alternatives styles\n  alternativesContainer: {\n    marginTop: theme.spacing.md,\n    paddingTop: theme.spacing.md,\n    borderTopWidth: 1,\n    borderTopColor: theme.colors.borderLight,\n  },\n  alternativesTitle: {\n    fontSize: theme.typography.fontSizes.sm,\n    fontWeight: '600',\n    color: theme.colors.textSecondary,\n    marginBottom: theme.spacing.sm,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n  alternativeItem: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    paddingVertical: theme.spacing.sm,\n    paddingHorizontal: theme.spacing.md,\n    backgroundColor: theme.isDarkMode ? theme.colors.gray700 : theme.colors.gray100,\n    borderRadius: theme.borderRadius.md,\n    marginBottom: theme.spacing.xs,\n    borderWidth: 1,\n    borderColor: theme.colors.borderLight,\n  },\n  alternativeText: {\n    fontSize: theme.typography.fontSizes.sm,\n    color: theme.colors.text,\n    flex: 1,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  alternativeConfidence: {\n    fontSize: theme.typography.fontSizes.xs,\n    color: theme.colors.textSecondary,\n    marginLeft: theme.spacing.sm,\n    fontWeight: '500',\n    fontFamily: theme.typography.fontFamilies.medium,\n  },\n  \n  // Modal styles\n  modalOverlay: {\n    flex: 1,\n    backgroundColor: 'rgba(0, 0, 0, 0.5)',\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  modalContent: {\n    backgroundColor: theme.colors.background,\n    borderRadius: 16,\n    padding: 20,\n    width: '90%',\n    maxHeight: '80%',\n  },\n  modalHeader: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    marginBottom: 20,\n  },\n  modalTitle: {\n    fontSize: 20,\n    fontWeight: 'bold',\n    color: theme.colors.text,\n  },\n  modalCloseButton: {\n    padding: 4,\n  },\n});\n\nexport default AudioRecorderUI; ","import React, { useCallback, useEffect } from 'react';\nimport { View, StyleSheet } from 'react-native';\nimport { useAudioRecorderLogic } from '../hooks/useAudioRecorderLogic';\nimport AudioRecorderUI from './AudioRecorderUI';\nimport logger from '../utils/logger';\nimport speechToTextService from '../services/speechToText';\n\n\nconst analyzeTranscriptionQuality = (result: any): { recommendations: string[] } => {\n  const recommendations = [];\n  if (result.confidence < 0.85) {\n    recommendations.push('Low transcription confidence.');\n  }\n  if (result.secret_tag_detected) {\n    recommendations.push(`Secret tag detected: ${result.secret_tag_details?.tagName}`);\n  }\n  return { recommendations };\n};\n\nconst cleanupAudioFile = (uri: string) => {\n  logger.info(`[cleanupAudioFile] Cleaned up audio file: ${uri}`);\n};\n\ninterface AudioRecorderProps {\n  onSave?: (transcript: string) => void;\n  onManualSave?: (transcript: string, audioUri?: string) => void;\n  onTranscriptionComplete?: (transcript: string) => void;\n  onCancel?: () => void;\n  onAutoSave?: (transcript: string) => void;\n  onStateChange?: (newState: string) => void;\n  onCommandDetected?: () => void;\n  isEditingInitialContent?: boolean;\n  saveButtonState?: { text: string; disabled: boolean; isSaving: boolean };\n  startRecordingOnMount?: boolean;\n  existingContent?: string;\n  onSaveWithCompleteText?: (completeText: string) => void;\n}\n\nconst AudioRecorder: React.FC<AudioRecorderProps> = ({\n  onSave,\n  onManualSave,\n  onTranscriptionComplete,\n  onCancel,\n  onAutoSave,\n  onStateChange,\n  onCommandDetected,\n  isEditingInitialContent = false,\n  saveButtonState,\n  startRecordingOnMount = true,\n  existingContent,\n  onSaveWithCompleteText,\n}) => {\n  const handleTranscriptionComplete = (text: string, audioUri?: string, detectedLanguage?: string | null, confidence?: number) => {\n    logger.info('[AudioRecorder] onTranscriptionComplete triggered.');\n    onTranscriptionComplete?.(text);\n    onSave?.(text);\n  };\n  \n  const handleCancel = () => {\n    logger.info('[AudioRecorder] onCancel called.');\n    onCancel?.();\n  };\n\n  const handleAutoSave = (text: string) => {\n    logger.info('[AudioRecorder] onAutoSave called.');\n    onAutoSave?.(text);\n  };\n  \n  const processSegment = useCallback(\n    async (audioUri: string, language: string): Promise<{ text: string } | null> => {\n      try {\n        const result = await speechToTextService.transcribeAudio(audioUri, { \n          languageCodes: [language],\n          enableSecretTagDetection: true \n        });\n        if (!result) {\n          cleanupAudioFile(audioUri);\n          return null;\n        }\n        const { transcript, secret_tag_detected } = result;\n        \n        // Check if secret tag was detected (handled by speechToText service)\n        if (secret_tag_detected?.found) {\n          logger.info(`OPAQUE secret tag detected: ${secret_tag_detected.tagName} (${secret_tag_detected.action})`);\n          // Treat secret tag phrases as commands (don't add to transcript)\n          logger.info('[processSegment] Transcript was a secret tag command. Halting processing.');\n          cleanupAudioFile(audioUri);\n          onCommandDetected?.();\n          return null;\n        }\n        \n        analyzeTranscriptionQuality(result);\n        cleanupAudioFile(audioUri);\n        return { text: transcript };\n      } catch (error) {\n        logger.error(\"Error during transcription processSegment\", error);\n        cleanupAudioFile(audioUri);\n        return null;\n      }\n    },\n    [onCommandDetected]\n  );\n\n  const logic = useAudioRecorderLogic({\n    onTranscriptionComplete: handleTranscriptionComplete,\n    onCancel: handleCancel,\n    onAutoSave: handleAutoSave,\n    autoStart: startRecordingOnMount && !isEditingInitialContent,\n  });\n\n  useEffect(() => {\n    onStateChange?.(logic.isRecording ? 'recording' : 'idle');\n  }, [logic.isRecording, onStateChange]);\n\n  const handleManualSave = useCallback(() => {\n    const fullTranscript = logic.transcriptSegments.join('\\n').trim();\n    if (fullTranscript) {\n      onManualSave?.(fullTranscript);\n      onSave?.(fullTranscript);\n    }\n  }, [logic.transcriptSegments, onManualSave, onSave]);\n\n  return (\n    <View style={styles.container}>\n      <AudioRecorderUI\n        isRecording={logic.isRecording}\n        transcriptSegments={logic.transcriptSegments}\n        setTranscriptSegments={logic.setTranscriptSegments}\n        currentSegmentTranscript={logic.currentSegmentTranscript}\n        isTranscribingSegment={logic.isTranscribingSegment}\n        lastTranscriptionResult={logic.lastTranscriptionResult}\n        showAlternatives={logic.showAlternatives}\n        setShowAlternatives={logic.setShowAlternatives}\n        selectedLanguage={logic.selectedLanguage}\n        isProcessing={logic.isProcessing}\n        canAcceptTranscript={logic.canAcceptTranscript}\n        pulseAnim={logic.pulseAnim}\n        waveAnim1={logic.waveAnim1}\n        waveAnim2={logic.waveAnim2}\n        recordingDuration={logic.recordingDuration}\n        permissionGranted={logic.permissionGranted}\n        handleMicPress={logic.handleMicPress}\n        handleAcceptTranscript={handleManualSave}\n        handleLanguageChange={logic.handleLanguageChange}\n        formatDuration={logic.formatDuration}\n        onClose={onCancel}\n        existingContent={existingContent}\n        onSaveWithCompleteText={onSaveWithCompleteText}\n      />\n    </View>\n  );\n};\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n});\n\nexport default AudioRecorder; ","/**\n * Secret Tag Indicator Component\n * \n * Shows active secret tags status in the UI with visual indicators.\n * Displays in recording screen, journal screens, etc.\n */\n\nimport React, { useState, useEffect } from 'react';\nimport {\n  View,\n  Text,\n  TouchableOpacity,\n  StyleSheet,\n  Animated,\n  Platform,\n} from 'react-native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { useAppTheme } from '../contexts/ThemeContext';\nimport { AppTheme } from '../config/theme';\nimport { SecretTagV2 } from '../services/secretTagOnlineManager';\nimport { areSecretTagsEnabled } from '../config/featureFlags';\nimport logger from '../utils/logger';\n\n// Helper to determine if native driver should be used\nconst useNativeDriver = Platform.OS !== 'web';\n\ninterface SecretTagIndicatorProps {\n  activeTags: SecretTagV2[];\n  onPress?: () => void;\n  compact?: boolean;\n  showPulse?: boolean;\n}\n\nconst SecretTagIndicator: React.FC<SecretTagIndicatorProps> = ({\n  activeTags,\n  onPress,\n  compact = false,\n  showPulse = true,\n}) => {\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n  \n  const [pulseAnim] = useState(new Animated.Value(1));\n\n  // Pulse animation for active state\n  useEffect(() => {\n    if (showPulse && activeTags.length > 0) {\n      const pulse = Animated.loop(\n        Animated.sequence([\n          Animated.timing(pulseAnim, {\n            toValue: 1.1,\n            duration: 1000,\n            useNativeDriver,\n          }),\n          Animated.timing(pulseAnim, {\n            toValue: 1,\n            duration: 1000,\n            useNativeDriver,\n          }),\n        ])\n      );\n      pulse.start();\n      \n      return () => pulse.stop();\n    }\n  }, [activeTags.length, showPulse, pulseAnim]);\n\n  // Don't render if feature disabled or no active tags\n  if (!areSecretTagsEnabled() || activeTags.length === 0) {\n    return null;\n  }\n\n  const primaryTag = activeTags[0];\n  const hasMultipleTags = activeTags.length > 1;\n\n  if (compact) {\n    return (\n      <TouchableOpacity\n        style={styles.compactContainer}\n        onPress={onPress}\n        activeOpacity={0.7}\n      >\n        <Animated.View style={[\n          styles.compactIndicator,\n          { backgroundColor: primaryTag.colorCode },\n          showPulse && { transform: [{ scale: pulseAnim }] }\n        ]}>\n          <Ionicons name=\"shield-checkmark\" size={12} color={theme.colors.background} />\n        </Animated.View>\n        {hasMultipleTags && (\n          <View style={styles.multipleTagsBadge}>\n            <Text style={styles.multipleTagsText}>+{activeTags.length - 1}</Text>\n          </View>\n        )}\n      </TouchableOpacity>\n    );\n  }\n\n  return (\n    <TouchableOpacity\n      style={styles.container}\n      onPress={onPress}\n      activeOpacity={0.8}\n    >\n      <Animated.View style={[\n        styles.indicator,\n        { borderColor: primaryTag.colorCode },\n        showPulse && { transform: [{ scale: pulseAnim }] }\n      ]}>\n        <View style={[styles.colorDot, { backgroundColor: primaryTag.colorCode }]} />\n        <View style={styles.content}>\n          <View style={styles.header}>\n            <Ionicons name=\"shield-checkmark\" size={16} color={theme.colors.primary} />\n            <Text style={styles.title}>Secret Tag Active</Text>\n          </View>\n          \n          <Text style={styles.tagName} numberOfLines={1}>\n            {primaryTag.name}\n            {hasMultipleTags && ` +${activeTags.length - 1} more`}\n          </Text>\n          \n          <Text style={styles.subtitle}>\n            New entries will be encrypted\n          </Text>\n        </View>\n        \n        {onPress && (\n          <Ionicons name=\"chevron-forward\" size={16} color={theme.colors.textSecondary} />\n        )}\n      </Animated.View>\n    </TouchableOpacity>\n  );\n};\n\n/**\n * Mini version for floating display\n */\nexport const SecretTagFloatingIndicator: React.FC<{\n  activeTags: SecretTagV2[];\n  onPress?: () => void;\n}> = ({ activeTags, onPress }) => {\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n  \n  const [pulseAnim] = useState(new Animated.Value(1));\n\n  useEffect(() => {\n    if (activeTags.length > 0) {\n      const pulse = Animated.loop(\n        Animated.sequence([\n          Animated.timing(pulseAnim, {\n            toValue: 1.2,\n            duration: 1500,\n            useNativeDriver,\n          }),\n          Animated.timing(pulseAnim, {\n            toValue: 1,\n            duration: 1500,\n            useNativeDriver,\n          }),\n        ])\n      );\n      pulse.start();\n      \n      return () => pulse.stop();\n    }\n  }, [activeTags.length, pulseAnim]);\n\n  if (!areSecretTagsEnabled() || activeTags.length === 0) {\n    return null;\n  }\n\n  const primaryTag = activeTags[0];\n\n  return (\n    <TouchableOpacity\n      style={styles.floatingContainer}\n      onPress={onPress}\n      activeOpacity={0.8}\n    >\n      <Animated.View style={[\n        styles.floatingIndicator,\n        { backgroundColor: primaryTag.colorCode },\n        { transform: [{ scale: pulseAnim }] }\n      ]}>\n        <Ionicons name=\"shield-checkmark\" size={16} color={theme.colors.background} />\n        {activeTags.length > 1 && (\n          <View style={styles.floatingBadge}>\n            <Text style={styles.floatingBadgeText}>{activeTags.length}</Text>\n          </View>\n        )}\n      </Animated.View>\n    </TouchableOpacity>\n  );\n};\n\nconst getStyles = (theme: AppTheme) => StyleSheet.create({\n  container: {\n    marginVertical: theme.spacing.xs,\n  },\n  indicator: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: theme.colors.card,\n    borderRadius: 12,\n    padding: theme.spacing.md,\n    borderWidth: 2,\n    borderColor: theme.colors.primary,\n    ...theme.shadows.sm,\n  },\n  colorDot: {\n    width: 8,\n    height: 8,\n    borderRadius: 4,\n    marginRight: theme.spacing.sm,\n  },\n  content: {\n    flex: 1,\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginBottom: 2,\n  },\n  title: {\n    fontSize: theme.typography.fontSizes.sm,\n    fontWeight: '600',\n    color: theme.colors.primary,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n    marginLeft: 4,\n  },\n  tagName: {\n    fontSize: theme.typography.fontSizes.md,\n    fontWeight: '500',\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.medium,\n    marginBottom: 2,\n  },\n  subtitle: {\n    fontSize: theme.typography.fontSizes.xs,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  compactContainer: {\n    position: 'relative',\n  },\n  compactIndicator: {\n    width: 24,\n    height: 24,\n    borderRadius: 12,\n    justifyContent: 'center',\n    alignItems: 'center',\n    ...theme.shadows.sm,\n  },\n  multipleTagsBadge: {\n    position: 'absolute',\n    top: -4,\n    right: -4,\n    backgroundColor: theme.colors.error,\n    borderRadius: 8,\n    minWidth: 16,\n    height: 16,\n    justifyContent: 'center',\n    alignItems: 'center',\n    paddingHorizontal: 4,\n  },\n  multipleTagsText: {\n    fontSize: 10,\n    fontWeight: 'bold',\n    color: theme.colors.background,\n    fontFamily: theme.typography.fontFamilies.bold,\n  },\n  floatingContainer: {\n    position: 'absolute',\n    top: theme.spacing.lg,\n    right: theme.spacing.lg,\n    zIndex: 1000,\n  },\n  floatingIndicator: {\n    width: 48,\n    height: 48,\n    borderRadius: 24,\n    justifyContent: 'center',\n    alignItems: 'center',\n    ...theme.shadows.lg,\n    position: 'relative',\n  },\n  floatingBadge: {\n    position: 'absolute',\n    top: -4,\n    right: -4,\n    backgroundColor: theme.colors.background,\n    borderRadius: 10,\n    minWidth: 20,\n    height: 20,\n    justifyContent: 'center',\n    alignItems: 'center',\n    paddingHorizontal: 4,\n    borderWidth: 2,\n    borderColor: theme.colors.primary,\n  },\n  floatingBadgeText: {\n    fontSize: 12,\n    fontWeight: 'bold',\n    color: theme.colors.primary,\n    fontFamily: theme.typography.fontFamilies.bold,\n  },\n});\n\nexport default SecretTagIndicator; ","/**\n * Zero-Knowledge Encryption Service\n * \n * This service ensures TRUE PRIVACY by:\n * - All encryption/decryption happens on user device only\n * - Each secret phrase directly becomes an encryption key\n * - Keys stored in hardware-backed secure storage (iOS Secure Enclave/Android Keystore)\n * - Server cannot decrypt any user data under any circumstances\n * - Per-entry encryption with forward secrecy\n * - Complete isolation between secret tags\n */\n\nimport * as SecureStore from 'expo-secure-store';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { Platform } from 'react-native';\nimport logger from '../utils/logger';\n\nexport interface EncryptedEntry {\n  encryptedContent: string;  // Base64 encoded encrypted data\n  encryptedKey: string;      // Entry key encrypted with phrase-derived key\n  iv: string;                // Base64 encoded initialization vector for content\n  salt: string;              // Base64 encoded salt for this entry\n  algorithm: string;         // Encryption algorithm used\n  wrapIv: string;            // Base64 encoded IV used for key wrapping\n}\n\nexport interface PhraseKeyInfo {\n  tagId: string;             // Secret tag ID\n  phraseSalt: string;        // Base64 encoded salt for phrase key derivation\n  iterations: number;        // PBKDF2 iterations\n  createdAt: number;         // Timestamp of key creation\n}\n\nclass ZeroKnowledgeEncryption {\n  private static readonly ALGORITHM = 'AES-GCM';\n  private static readonly KEY_LENGTH = 256;\n  private static readonly IV_LENGTH = 12; // 96 bits for GCM\n  private static readonly SALT_LENGTH = 32; // 256 bits\n  private static readonly DEFAULT_ITERATIONS = 100000;\n  \n  // Hardware-backed storage keys\n  private static readonly DEVICE_INFO = 'zk_device_info';\n  private static readonly PHRASE_KEYS_INFO = 'zk_phrase_keys_info';\n  \n  private phraseKeys: Map<string, CryptoKey> = new Map(); // tagId -> CryptoKey\n  private deviceEntropy: Uint8Array | null = null;\n\n  /**\n   * Secure storage abstraction for web compatibility\n   */\n  private async getSecureItem(key: string): Promise<string | null> {\n    if (Platform.OS === 'web') {\n      return AsyncStorage.getItem(key);\n    } else {\n      return SecureStore.getItemAsync(key);\n    }\n  }\n\n  /**\n   * Secure storage setter with authentication\n   */\n  private async setSecureItem(\n    key: string, \n    value: string, \n    options?: SecureStore.SecureStoreOptions\n  ): Promise<void> {\n    if (Platform.OS === 'web') {\n      await AsyncStorage.setItem(key, value);\n    } else {\n      await SecureStore.setItemAsync(key, value, options);\n    }\n  }\n\n  /**\n   * Secure storage deletion\n   */\n  private async deleteSecureItem(key: string): Promise<void> {\n    if (Platform.OS === 'web') {\n      await AsyncStorage.removeItem(key);\n    } else {\n      await SecureStore.deleteItemAsync(key);\n    }\n  }\n\n  /**\n   * Check if Web Crypto API is available\n   */\n  private isWebCryptoAvailable(): boolean {\n    return typeof crypto !== 'undefined' && \n           typeof crypto.subtle !== 'undefined' &&\n           typeof crypto.subtle.deriveKey === 'function';\n  }\n\n  /**\n   * Check if secure storage is available\n   */\n  private async isSecureStorageAvailable(): Promise<boolean> {\n    if (Platform.OS === 'web') {\n      return true; // AsyncStorage is always available on web\n    } else {\n      return SecureStore.isAvailableAsync();\n    }\n  }\n\n  /**\n   * Get or generate device-specific entropy\n   */\n  private async getDeviceEntropy(): Promise<Uint8Array> {\n    if (this.deviceEntropy) {\n      return this.deviceEntropy;\n    }\n\n    try {\n      const storedEntropy = await this.getSecureItem(ZeroKnowledgeEncryption.DEVICE_INFO);\n      \n      if (storedEntropy) {\n        this.deviceEntropy = this.base64ToArray(storedEntropy);\n        return this.deviceEntropy;\n      }\n\n      // Generate new device entropy\n      this.deviceEntropy = crypto.getRandomValues(new Uint8Array(ZeroKnowledgeEncryption.SALT_LENGTH));\n      \n      await this.setSecureItem(\n        ZeroKnowledgeEncryption.DEVICE_INFO,\n        this.arrayToBase64(this.deviceEntropy),\n        {\n          requireAuthentication: false, // Device entropy doesn't need auth\n          authenticationPrompt: 'Authenticate to access device encryption'\n        }\n      );\n\n      logger.info('Generated new device entropy for encryption');\n      return this.deviceEntropy;\n    } catch (error) {\n      logger.error('Failed to get device entropy:', error);\n      throw new Error('Failed to initialize device entropy');\n    }\n  }\n\n  /**\n   * Initialize phrase-specific encryption key for a secret tag\n   */\n  async initializePhraseKey(tagId: string, secretPhrase: string): Promise<boolean> {\n    if (!this.isWebCryptoAvailable()) {\n      throw new Error('Web Crypto API not available');\n    }\n\n    try {\n      // Get device-specific entropy\n      const deviceEntropy = await this.getDeviceEntropy();\n      \n      // Create phrase-specific key material\n      const encoder = new TextEncoder();\n      const phraseBytes = encoder.encode(secretPhrase);\n      \n      // Combine secret phrase + device entropy for unique key per phrase\n      const combinedKeyMaterial = new Uint8Array(phraseBytes.length + deviceEntropy.length);\n      combinedKeyMaterial.set(phraseBytes, 0);\n      combinedKeyMaterial.set(deviceEntropy, phraseBytes.length);\n\n      // Import key material for PBKDF2\n      const keyMaterial = await crypto.subtle.importKey(\n        'raw',\n        combinedKeyMaterial,\n        'PBKDF2',\n        false,\n        ['deriveKey']\n      );\n\n      // Generate unique salt for this phrase\n      const phraseSalt = crypto.getRandomValues(new Uint8Array(ZeroKnowledgeEncryption.SALT_LENGTH));\n\n      // Derive phrase-specific encryption key\n      const phraseKey = await crypto.subtle.deriveKey(\n        {\n          name: 'PBKDF2',\n          salt: phraseSalt,\n          iterations: ZeroKnowledgeEncryption.DEFAULT_ITERATIONS,\n          hash: 'SHA-256'\n        },\n        keyMaterial,\n        {\n          name: ZeroKnowledgeEncryption.ALGORITHM,\n          length: ZeroKnowledgeEncryption.KEY_LENGTH\n        },\n        false, // Key is not extractable\n        ['encrypt', 'decrypt', 'wrapKey', 'unwrapKey']\n      );\n\n      // Store phrase key in memory\n      this.phraseKeys.set(tagId, phraseKey);\n\n      // Store phrase key info securely\n      const phraseKeyInfo: PhraseKeyInfo = {\n        tagId: tagId,\n        phraseSalt: this.arrayToBase64(phraseSalt),\n        iterations: ZeroKnowledgeEncryption.DEFAULT_ITERATIONS,\n        createdAt: Date.now()\n      };\n\n      await this.savePhraseKeyInfo(phraseKeyInfo);\n\n      // Clear sensitive data from memory\n      combinedKeyMaterial.fill(0);\n      \n      logger.info(`Secret phrase key initialized for tag: ${tagId}`);\n      return true;\n\n    } catch (error) {\n      logger.error(`Failed to initialize phrase key for tag ${tagId}:`, error);\n      return false;\n    }\n  }\n\n  /**\n   * Load existing phrase-specific encryption key\n   */\n  async loadPhraseKey(tagId: string, secretPhrase: string): Promise<boolean> {\n    if (!this.isWebCryptoAvailable()) {\n      throw new Error('Web Crypto API not available');\n    }\n\n    try {\n      // Get phrase key info\n      const phraseKeyInfo = await this.getPhraseKeyInfo(tagId);\n      if (!phraseKeyInfo) {\n        logger.warn(`No phrase key info found for tag: ${tagId}`);\n        return false;\n      }\n\n      // Get device-specific entropy\n      const deviceEntropy = await this.getDeviceEntropy();\n      \n      // Recreate the same key derivation process\n      const encoder = new TextEncoder();\n      const phraseBytes = encoder.encode(secretPhrase);\n      \n      const combinedKeyMaterial = new Uint8Array(phraseBytes.length + deviceEntropy.length);\n      combinedKeyMaterial.set(phraseBytes, 0);\n      combinedKeyMaterial.set(deviceEntropy, phraseBytes.length);\n\n      const keyMaterial = await crypto.subtle.importKey(\n        'raw',\n        combinedKeyMaterial,\n        'PBKDF2',\n        false,\n        ['deriveKey']\n      );\n\n      const phraseSalt = this.base64ToArray(phraseKeyInfo.phraseSalt);\n\n      const phraseKey = await crypto.subtle.deriveKey(\n        {\n          name: 'PBKDF2',\n          salt: phraseSalt,\n          iterations: phraseKeyInfo.iterations,\n          hash: 'SHA-256'\n        },\n        keyMaterial,\n        {\n          name: ZeroKnowledgeEncryption.ALGORITHM,\n          length: ZeroKnowledgeEncryption.KEY_LENGTH\n        },\n        false,\n        ['encrypt', 'decrypt', 'wrapKey', 'unwrapKey']\n      );\n\n      // Store phrase key in memory\n      this.phraseKeys.set(tagId, phraseKey);\n\n      // Clear sensitive data\n      combinedKeyMaterial.fill(0);\n      \n      logger.info(`Secret phrase key loaded for tag: ${tagId}`);\n      return true;\n\n    } catch (error) {\n      logger.error(`Failed to load phrase key for tag ${tagId}:`, error);\n      return false;\n    }\n  }\n\n  /**\n   * Encrypt journal entry content with phrase-specific key\n   */\n  async encryptEntryWithSecretPhrase(content: string, tagId: string): Promise<EncryptedEntry> {\n    const phraseKey = this.phraseKeys.get(tagId);\n    if (!phraseKey) {\n      throw new Error(`Secret phrase key not loaded for tag: ${tagId}`);\n    }\n\n    return this.encryptWithKey(content, phraseKey);\n  }\n\n  /**\n   * Decrypt journal entry content with phrase-specific key\n   */\n  async decryptEntryWithSecretPhrase(encryptedEntry: EncryptedEntry, tagId: string): Promise<string> {\n    const phraseKey = this.phraseKeys.get(tagId);\n    if (!phraseKey) {\n      throw new Error(`Secret phrase key not loaded for tag: ${tagId}`);\n    }\n\n    return this.decryptWithKey(encryptedEntry, phraseKey);\n  }\n\n  /**\n   * Check if a secret phrase key is loaded for a tag\n   */\n  isPhraseKeyLoaded(tagId: string): boolean {\n    return this.phraseKeys.has(tagId);\n  }\n\n  /**\n   * Unload a secret phrase key from memory\n   */\n  unloadPhraseKey(tagId: string): void {\n    this.phraseKeys.delete(tagId);\n    logger.info(`Secret phrase key unloaded for tag: ${tagId}`);\n  }\n\n  /**\n   * Clear a secret tag's phrase encryption data permanently\n   */\n  async clearSecretPhraseEncryption(tagId: string): Promise<void> {\n    try {\n      // Remove from memory\n      this.phraseKeys.delete(tagId);\n      \n      // Remove from secure storage\n      await this.deletePhraseKeyInfo(tagId);\n      \n      logger.info(`Secret phrase encryption cleared for tag: ${tagId}`);\n    } catch (error) {\n      logger.error(`Failed to clear phrase encryption for tag ${tagId}:`, error);\n      throw error;\n    }\n  }\n\n  /**\n   * Securely clear all encryption data\n   */\n  async secureClearAllData(): Promise<void> {\n    try {\n      // Clear all phrase keys from memory\n      this.phraseKeys.clear();\n      \n      // Clear device entropy\n      this.deviceEntropy = null;\n      \n      // Remove all secure storage data\n      await this.deleteSecureItem(ZeroKnowledgeEncryption.DEVICE_INFO);\n      await this.deleteSecureItem(ZeroKnowledgeEncryption.PHRASE_KEYS_INFO);\n      \n      logger.info('All encryption data securely cleared');\n    } catch (error) {\n      logger.error('Failed to clear all encryption data:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Generic encryption with any key\n   */\n  private async encryptWithKey(content: string, encryptionKey: CryptoKey): Promise<EncryptedEntry> {\n    try {\n      // Generate unique key for this entry\n      const entryKey = await crypto.subtle.generateKey(\n        {\n          name: ZeroKnowledgeEncryption.ALGORITHM,\n          length: ZeroKnowledgeEncryption.KEY_LENGTH\n        },\n        true, // Extractable for wrapping\n        ['encrypt', 'decrypt']\n      );\n\n      // Generate unique salt and IV for this entry\n      const entrySalt = crypto.getRandomValues(new Uint8Array(ZeroKnowledgeEncryption.SALT_LENGTH));\n      const iv = crypto.getRandomValues(new Uint8Array(ZeroKnowledgeEncryption.IV_LENGTH));\n      const wrapIv = crypto.getRandomValues(new Uint8Array(ZeroKnowledgeEncryption.IV_LENGTH));\n\n      // Encrypt the content with entry key\n      const encoder = new TextEncoder();\n      const encryptedContent = await crypto.subtle.encrypt(\n        {\n          name: ZeroKnowledgeEncryption.ALGORITHM,\n          iv: iv\n        },\n        entryKey,\n        encoder.encode(content)\n      );\n\n      // Wrap (encrypt) the entry key with phrase key\n      const wrappedKey = await crypto.subtle.wrapKey(\n        'raw',\n        entryKey,\n        encryptionKey,\n        {\n          name: ZeroKnowledgeEncryption.ALGORITHM,\n          iv: wrapIv\n        }\n      );\n\n      return {\n        encryptedContent: this.arrayToBase64(new Uint8Array(encryptedContent)),\n        encryptedKey: this.arrayToBase64(new Uint8Array(wrappedKey)),\n        iv: this.arrayToBase64(iv),\n        salt: this.arrayToBase64(entrySalt),\n        algorithm: ZeroKnowledgeEncryption.ALGORITHM,\n        wrapIv: this.arrayToBase64(wrapIv)\n      };\n\n    } catch (error) {\n      logger.error('Failed to encrypt entry:', error);\n      throw new Error('Encryption failed');\n    }\n  }\n\n  /**\n   * Generic decryption with any key\n   */\n  private async decryptWithKey(encryptedEntry: EncryptedEntry, decryptionKey: CryptoKey): Promise<string> {\n    try {\n      // Convert base64 to arrays\n      const encryptedContent = this.base64ToArray(encryptedEntry.encryptedContent);\n      const encryptedKey = this.base64ToArray(encryptedEntry.encryptedKey);\n      const iv = this.base64ToArray(encryptedEntry.iv);\n      const wrapIv = this.base64ToArray(encryptedEntry.wrapIv);\n\n      // Unwrap (decrypt) the entry key with phrase key\n      const entryKey = await crypto.subtle.unwrapKey(\n        'raw',\n        encryptedKey,\n        decryptionKey,\n        {\n          name: ZeroKnowledgeEncryption.ALGORITHM,\n          iv: wrapIv\n        },\n        {\n          name: ZeroKnowledgeEncryption.ALGORITHM,\n          length: ZeroKnowledgeEncryption.KEY_LENGTH\n        },\n        false,\n        ['decrypt']\n      );\n\n      // Decrypt the content with entry key\n      const decryptedContent = await crypto.subtle.decrypt(\n        {\n          name: ZeroKnowledgeEncryption.ALGORITHM,\n          iv: iv\n        },\n        entryKey,\n        encryptedContent\n      );\n\n      // Convert back to string\n      const decoder = new TextDecoder();\n      return decoder.decode(decryptedContent);\n\n    } catch (error) {\n      logger.error('Failed to decrypt entry:', error);\n      throw new Error('Decryption failed - invalid phrase or corrupted data');\n    }\n  }\n\n  /**\n   * Save phrase key info to secure storage\n   */\n  private async savePhraseKeyInfo(phraseKeyInfo: PhraseKeyInfo): Promise<void> {\n    try {\n      const existingKeysStr = await this.getSecureItem(ZeroKnowledgeEncryption.PHRASE_KEYS_INFO);\n      const existingKeys: PhraseKeyInfo[] = existingKeysStr ? JSON.parse(existingKeysStr) : [];\n      \n      // Remove existing info for this tag\n      const filteredKeys = existingKeys.filter(info => info.tagId !== phraseKeyInfo.tagId);\n      filteredKeys.push(phraseKeyInfo);\n\n      await this.setSecureItem(\n        ZeroKnowledgeEncryption.PHRASE_KEYS_INFO,\n        JSON.stringify(filteredKeys),\n        {\n          requireAuthentication: true,\n          authenticationPrompt: 'Authenticate to manage secret phrase keys'\n        }\n      );\n    } catch (error) {\n      logger.error('Failed to save phrase key info:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get phrase key info from secure storage\n   */\n  private async getPhraseKeyInfo(tagId: string): Promise<PhraseKeyInfo | null> {\n    try {\n      const keysStr = await this.getSecureItem(ZeroKnowledgeEncryption.PHRASE_KEYS_INFO);\n      if (!keysStr) {\n        return null;\n      }\n\n      const keys: PhraseKeyInfo[] = JSON.parse(keysStr);\n      return keys.find(info => info.tagId === tagId) || null;\n    } catch (error) {\n      logger.error('Failed to get phrase key info:', error);\n      return null;\n    }\n  }\n\n  /**\n   * Delete phrase key info from secure storage\n   */\n  private async deletePhraseKeyInfo(tagId: string): Promise<void> {\n    try {\n      const keysStr = await this.getSecureItem(ZeroKnowledgeEncryption.PHRASE_KEYS_INFO);\n      if (!keysStr) {\n        return;\n      }\n\n      const keys: PhraseKeyInfo[] = JSON.parse(keysStr);\n      const filteredKeys = keys.filter(info => info.tagId !== tagId);\n\n      if (filteredKeys.length === 0) {\n        await this.deleteSecureItem(ZeroKnowledgeEncryption.PHRASE_KEYS_INFO);\n      } else {\n        await this.setSecureItem(\n          ZeroKnowledgeEncryption.PHRASE_KEYS_INFO,\n          JSON.stringify(filteredKeys),\n          {\n            requireAuthentication: true,\n            authenticationPrompt: 'Authenticate to manage secret phrase keys'\n          }\n        );\n      }\n    } catch (error) {\n      logger.error('Failed to delete phrase key info:', error);\n      throw error;\n    }\n  }\n\n  // Utility methods\n  private arrayToBase64(array: Uint8Array): string {\n    const binaryString = Array.from(array, byte => String.fromCharCode(byte)).join('');\n    return btoa(binaryString);\n  }\n\n  private base64ToArray(base64: string): Uint8Array {\n    const binaryString = atob(base64);\n    return new Uint8Array(binaryString.length).map((_, i) => binaryString.charCodeAt(i));\n  }\n}\n\n// Export singleton instance\nexport const zeroKnowledgeEncryption = new ZeroKnowledgeEncryption();\nexport default zeroKnowledgeEncryption; ","/**\n * Legacy Tag Manager Service\n * \n * This service provides backward compatibility for the legacy tag management system\n * while redirecting to the new OPAQUE-based system.\n */\n\nimport { Tag } from '../types';\nimport { TagsAPI } from './api';\nimport logger from '../utils/logger';\nimport { areSecretTagsEnabled } from '../config/featureFlags';\n\nexport interface TagManagerInterface {\n  getAllTags(): Promise<Tag[]>;\n  createTag(name: string, color?: string): Promise<Tag>;\n  updateTag(id: string, updates: Partial<Tag>): Promise<Tag>;\n  deleteTag(id: string): Promise<void>;\n  getTagById(id: string): Promise<Tag | null>;\n  getTagsByIds(ids: string[]): Promise<Tag[]>;\n  // OPAQUE-specific methods\n  getActiveSecretTags(): Promise<any[]>;\n  checkForSecretTagPhrases(content: string): Promise<{ found: boolean; tagId?: string; tagName?: string; action?: string }>;\n  getSecretTags(): Promise<any[]>;\n  activateSecretTag(tagId: string): Promise<void>;\n}\n\n/**\n * Legacy Tag Manager Implementation\n * \n * This implementation provides compatibility with the old tag management system\n * while delegating to the new OPAQUE-based system where appropriate.\n */\nclass LegacyTagManager implements TagManagerInterface {\n  /**\n   * Get all tags (regular tags only, not secret tags)\n   */\n  async getAllTags(): Promise<Tag[]> {\n    try {\n      logger.info('Legacy tagManager: Getting all regular tags from API');\n      const response = await TagsAPI.getTags();\n      const tags = response.data || [];\n      logger.info(`Legacy tagManager: Found ${tags.length} regular tags`);\n      return tags;\n    } catch (error) {\n      logger.error('Failed to get all tags:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Create a new regular tag\n   */\n  async createTag(name: string, color?: string): Promise<Tag> {\n    try {\n      logger.info('Legacy tagManager: Creating regular tag:', { name, color });\n      \n      const newTag = await TagsAPI.createTag({\n        name: name.trim(),\n        color: color || '#007AFF'\n      });\n\n      logger.info('Legacy tagManager: Created regular tag:', newTag);\n      return newTag;\n    } catch (error) {\n      logger.error('Failed to create tag:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Update an existing tag\n   */\n  async updateTag(id: string, updates: Partial<Tag>): Promise<Tag> {\n    try {\n      logger.info('Legacy tagManager: Updating tag:', { id, updates });\n      \n      const updatedTag = await TagsAPI.updateTag(id, updates);\n      logger.info('Legacy tagManager: Updated tag:', updatedTag);\n      return updatedTag;\n    } catch (error) {\n      logger.error('Failed to update tag:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Delete a tag\n   */\n  async deleteTag(id: string): Promise<void> {\n    try {\n      logger.info('Legacy tagManager: Deleting tag:', { id });\n      \n      await TagsAPI.deleteTag(id);\n      logger.info('Legacy tagManager: Deleted tag successfully');\n    } catch (error) {\n      logger.error('Failed to delete tag:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get a tag by ID\n   */\n  async getTagById(id: string): Promise<Tag | null> {\n    try {\n      logger.info('Legacy tagManager: Getting tag by ID:', { id });\n      \n      const allTags = await this.getAllTags();\n      const tag = allTags.find(t => String(t.id) === id) || null;\n      \n      logger.info('Legacy tagManager: Found tag:', tag);\n      return tag;\n    } catch (error) {\n      logger.error('Failed to get tag by ID:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get tags by IDs\n   */\n  async getTagsByIds(ids: string[]): Promise<Tag[]> {\n    try {\n      logger.info('Legacy tagManager: Getting tags by IDs:', { ids });\n      \n      const allTags = await this.getAllTags();\n      const tags = allTags.filter(t => ids.includes(String(t.id)));\n      \n      logger.info(`Legacy tagManager: Found ${tags.length} tags`);\n      return tags;\n    } catch (error) {\n      logger.error('Failed to get tags by IDs:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get active secret tags (OPAQUE-based)\n   */\n  async getActiveSecretTags(): Promise<any[]> {\n    try {\n      logger.info('Legacy tagManager: Getting active secret tags');\n      if (!areSecretTagsEnabled()) {\n        return [];\n      }\n      // TODO: Implement active secret tags retrieval from backend\n      // For now, return empty array to avoid breaking the interface\n      logger.warn('getActiveSecretTags not yet implemented - returning empty array');\n      return [];\n    } catch (error) {\n      logger.error('Failed to get active secret tags:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Check for secret tag phrases in content\n   */\n  async checkForSecretTagPhrases(content: string): Promise<{ found: boolean; tagId?: string; tagName?: string; action?: string }> {\n    try {\n      logger.info('Legacy tagManager: Checking for secret tag phrases');\n      if (!areSecretTagsEnabled()) {\n        return { found: false };\n      }\n      // TODO: Implement phrase detection logic with backend\n      // For now, return not found to avoid breaking the interface\n      logger.warn('checkForSecretTagPhrases not yet implemented - returning not found');\n      return { found: false };\n    } catch (error) {\n      logger.error('Failed to check for secret tag phrases:', error);\n      return { found: false };\n    }\n  }\n\n  /**\n   * Get all secret tags (OPAQUE-based)\n   */\n  async getSecretTags(): Promise<any[]> {\n    try {\n      logger.info('Legacy tagManager: Getting all secret tags');\n      if (!areSecretTagsEnabled()) {\n        return [];\n      }\n      // TODO: Implement secret tags retrieval from backend API\n      // For now, return empty array to avoid breaking the interface\n      logger.warn('getSecretTags not yet implemented - returning empty array');\n      return [];\n    } catch (error) {\n      logger.error('Failed to get secret tags:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Activate a secret tag\n   */\n  async activateSecretTag(tagId: string): Promise<void> {\n    try {\n      logger.info('Legacy tagManager: Activating secret tag:', { tagId });\n      if (!areSecretTagsEnabled()) {\n        return;\n      }\n      // TODO: Implement secret tag activation with backend API\n      // For now, just log to avoid breaking the interface\n      logger.warn('activateSecretTag not yet implemented - no action taken');\n    } catch (error) {\n      logger.error('Failed to activate secret tag:', error);\n      throw error;\n    }\n  }\n}\n\n// Export the legacy tag manager instance\nexport const tagManager = new LegacyTagManager();\n\n// Export default for compatibility\nexport default tagManager; ","/**\n * Encrypted Journal Service\n * \n * High-level service that integrates phrase-based zero-knowledge encryption with journal operations.\n * Handles transparent encryption/decryption for secret tag entries using secret phrases directly as keys.\n */\n\nimport { JournalAPI } from './api';\nimport { zeroKnowledgeEncryption } from './zeroKnowledgeEncryption';\nimport { tagManager } from './tagManager';\nimport logger from '../utils/logger';\nimport { clientEncryption } from './clientEncryption';\nimport { areSecretTagsEnabled } from '../config/featureFlags';\n\nexport interface JournalEntryData {\n  id?: number;\n  title?: string;\n  content: string;\n  entry_date?: string;\n  audio_url?: string;\n  tags?: string[];\n  secret_tag_id?: string | null;  // Secret tag ID (if any)\n  created_at?: string;\n  updated_at?: string;\n}\n\nexport interface CreateEntryOptions {\n  secretTagId?: string;    // Specific secret tag to use\n  forcePublic?: boolean;   // Force entry to be public (no secret tag)\n  detectedTagId?: string;  // Tag detected from voice activation\n}\n\nclass EncryptedJournalService {\n  /**\n   * Reusable logic to detect and handle secret tag phrases in content.\n   * This can be called from both create and update operations.\n   * @returns {Promise<{\n   *   processedContent: string;\n   *   detectedTagId: string | null;\n   * }>}\n   */\n  private async detectAndProcessSecretPhrase(\n    content: string,\n    existingTagId: string | null = null\n  ): Promise<{ processedContent: string; detectedTagId: string | null }> {\n    if (!content) {\n      return { processedContent: content, detectedTagId: existingTagId };\n    }\n\n    try {\n      const detection = await tagManager.checkForSecretTagPhrases(content);\n      if (detection.found && detection.tagId && detection.action === 'activate') {\n        logger.info(`Secret tag activation phrase detected in content for tag: ${detection.tagName} (${detection.tagId})`);\n        \n        // Activate the tag\n        await tagManager.activateSecretTag(detection.tagId);\n        \n        // Clean the activation phrase from the content\n        let cleanedContent = content;\n        if (detection.tagName) {\n          // Create a regex to find the phrase (case-insensitive) and remove it\n          const phraseRegex = new RegExp(detection.tagName.replace(/[-\\/\\\\^$*+?.()|[\\]{}]/g, '\\\\$&'), 'gi');\n          cleanedContent = content.replace(phraseRegex, '').trim();\n        }\n        \n        return {\n          processedContent: cleanedContent,\n          detectedTagId: detection.tagId,\n        };\n      }\n    } catch (error) {\n      logger.error('Error during secret phrase detection, proceeding with original content.', error);\n    }\n\n    // If no phrase is detected, return original content and tag ID\n    return { processedContent: content, detectedTagId: existingTagId };\n  }\n\n  /**\n   * Create a journal entry, automatically encrypting based on active secret tags\n   */\n  async createEntry(\n    entryData: Omit<JournalEntryData, 'id'>,\n    options: CreateEntryOptions = {}\n  ): Promise<JournalEntryData> {\n    const { secretTagId, forcePublic, detectedTagId: optionDetectedTagId } = options;\n    \n    // Process content for secret phrases unless forced public\n    const { processedContent, detectedTagId: manuallyDetectedTagId } = forcePublic\n      ? { processedContent: entryData.content, detectedTagId: null }\n      : await this.detectAndProcessSecretPhrase(entryData.content, null);\n\n    const finalEntryData = {\n      ...entryData,\n      content: processedContent,\n    };\n    \n    // Determine the final secret tag to use for this entry\n    const targetSecretTagId = secretTagId || optionDetectedTagId || manuallyDetectedTagId;\n\n    // If secret tags feature is disabled, use per-user encryption path\n    if (!areSecretTagsEnabled()) {\n      return this.createPerUserEncryptedEntry(finalEntryData);\n    }\n\n    if (targetSecretTagId && zeroKnowledgeEncryption.isPhraseKeyLoaded(targetSecretTagId)) {\n      return this.createSecretTagEntry(finalEntryData, targetSecretTagId);\n    }\n\n    if (targetSecretTagId && !zeroKnowledgeEncryption.isPhraseKeyLoaded(targetSecretTagId)) {\n      logger.warn(`Entry should use secret tag ${targetSecretTagId} but phrase encryption not ready, creating public entry`);\n    }\n    // Fall back to public entry\n    return this.createPublicEntry(finalEntryData);\n  }\n\n  /**\n   * Create a public (non-encrypted) journal entry\n   */\n  private async createPublicEntry(entryData: Omit<JournalEntryData, 'id'>): Promise<JournalEntryData> {\n    try {\n      const response = await JournalAPI.createEntry({\n        title: entryData.title || '',\n        content: entryData.content,\n        entry_date: entryData.entry_date || new Date().toISOString(),\n        audio_url: entryData.audio_url,\n        tags: entryData.tags || [],\n        // Remove secret tag references in per-user encryption mode\n      });\n      \n      logger.info('Created public journal entry');\n      return response.data;\n    } catch (error) {\n      logger.error('Failed to create public journal entry:', error);\n      throw new Error('Failed to create journal entry');\n    }\n  }\n\n  /**\n   * Create a per-user encrypted journal entry (no secret tags)\n   */\n  private async createPerUserEncryptedEntry(entryData: Omit<JournalEntryData, 'id'>): Promise<JournalEntryData> {\n    try {\n      const enc = await clientEncryption.encryptPerUser(entryData.content);\n      const response = await JournalAPI.createEntry({\n        title: entryData.title || '',\n        content: '',\n        entry_date: entryData.entry_date || new Date().toISOString(),\n        audio_url: entryData.audio_url,\n        tags: entryData.tags || [],\n        encrypted_content: enc.encryptedContent,\n        encryption_iv: enc.iv,\n        encrypted_key: enc.wrappedKey,\n        encryption_wrap_iv: enc.wrapIv,\n        encryption_algorithm: enc.algorithm || 'AES-GCM',\n      } as any);\n      logger.info('Created per-user encrypted journal entry');\n      return {\n        ...response.data,\n        content: entryData.content,\n      };\n    } catch (error) {\n      logger.error('Failed to create per-user encrypted journal entry:', error);\n      throw new Error('Failed to create encrypted journal entry');\n    }\n  }\n\n  /**\n   * Create a secret tag (encrypted) journal entry\n   */\n  private async createSecretTagEntry(\n    entryData: Omit<JournalEntryData, 'id'>, \n    secretTagId: string\n  ): Promise<JournalEntryData> {\n    if (!zeroKnowledgeEncryption.isPhraseKeyLoaded(secretTagId)) {\n      throw new Error(`Secret tag encryption not loaded for tag: ${secretTagId}`);\n    }\n\n    try {\n      // Encrypt the content with tag-specific key\n      const encrypted = await zeroKnowledgeEncryption.encryptEntryWithSecretPhrase(\n        entryData.content, \n        secretTagId\n      );\n      \n      // Get server-side tag hashes for this tag\n      const activeTagHashes = await tagManager.getActiveSecretTags();\n      const secretTags = await tagManager.getSecretTags();\n      const targetTag = secretTags.find((tag: any) => tag.id === secretTagId);\n      \n      if (!targetTag) {\n        throw new Error(`Secret tag not found: ${secretTagId}`);\n      }\n      \n      // Create the encrypted entry\n      const response = await JournalAPI.createEncryptedEntry({\n        title: entryData.title || '',\n        encrypted_content: encrypted.encryptedContent,\n        encrypted_key: encrypted.encryptedKey,\n        iv: encrypted.iv,\n        salt: encrypted.salt,\n        algorithm: encrypted.algorithm,\n        entry_date: entryData.entry_date || new Date().toISOString(),\n        audio_url: entryData.audio_url,\n        tags: entryData.tags || [],\n        wrapIv: encrypted.wrapIv,\n        secret_tag_id: secretTagId,\n        secret_tag_hash: targetTag.id,\n      });\n      \n      logger.info(`Created secret tag journal entry with tag: ${secretTagId}`);\n      \n      // Return with decrypted content for immediate use\n      return {\n        ...response.data,\n        content: entryData.content, // Return original content for UI\n        secret_tag_id: secretTagId,\n      };\n    } catch (error) {\n      logger.error('Failed to create secret tag journal entry:', error);\n      throw new Error('Failed to create encrypted journal entry');\n    }\n  }\n\n  /**\n   * Create a secret tag entry without encryption (when encryption keys not ready)\n   */\n  private async createSecretTagEntryUnencrypted(\n    entryData: Omit<JournalEntryData, 'id'>, \n    secretTagId: string\n  ): Promise<JournalEntryData> {\n    try {\n      // Get server-side tag hashes for this tag\n      const secretTags = await tagManager.getSecretTags();\n      const targetTag = secretTags.find((tag: any) => tag.id === secretTagId);\n      \n      if (!targetTag) {\n        throw new Error(`Secret tag not found: ${secretTagId}`);\n      }\n      \n      // Create the entry with secret tag metadata but unencrypted content\n      const response = await JournalAPI.createEntry({\n        title: entryData.title || '',\n        content: entryData.content, // Store unencrypted for now\n        entry_date: entryData.entry_date || new Date().toISOString(),\n        audio_url: entryData.audio_url,\n        tags: entryData.tags || [],\n        secret_tag_id: secretTagId,\n        secret_tag_hash: targetTag.id,\n      });\n      \n      logger.info(`Created secret tag journal entry (unencrypted) with tag: ${secretTagId}`);\n      \n      return {\n        ...response.data,\n        secret_tag_id: secretTagId,\n      };\n    } catch (error) {\n      logger.error('Failed to create secret tag journal entry (unencrypted):', error);\n      throw new Error('Failed to create journal entry with secret tag');\n    }\n  }\n\n  /**\n   * Get journal entries, automatically filtering and decrypting based on active secret tags\n   */\n  async getEntries(options: {\n    page?: number;\n    limit?: number;\n    tags?: string[];\n    entry_date?: string;\n    includeAllSecretTags?: boolean;\n  } = {}): Promise<JournalEntryData[]> {\n    try {\n      // Get active secret tags for server-side filtering\n      const activeTags = await tagManager.getActiveSecretTags();\n      const activeTagHashes = activeTags.map((tag: any) => tag.id);\n      \n      // Fetch entries with secret tag filtering\n      const response = await JournalAPI.getEntries({\n        ...options,\n        secret_tag_hashes: activeTagHashes,\n        include_public: true, // Always include public entries\n      });\n      \n      const entries = response.data.entries || response.data;\n      \n      // Filter and decrypt entries based on active secret tags\n      return this.processEntries(entries);\n    } catch (error) {\n      logger.error('Failed to get journal entries:', error);\n      throw new Error('Failed to retrieve journal entries');\n    }\n  }\n\n  /**\n   * Get a specific journal entry by ID, automatically decrypting if it's a secret tag entry\n   */\n  async getEntry(id: number): Promise<JournalEntryData | null> {\n    try {\n      const response = await JournalAPI.getEntry(id);\n      const entry = response.data;\n      \n      if (!entry) return null;\n      \n      const processedEntries = await this.processEntries([entry]);\n      return processedEntries.length > 0 ? processedEntries[0] : null;\n    } catch (error) {\n      logger.error(`Failed to get journal entry ${id}:`, error);\n      throw new Error('Failed to retrieve journal entry');\n    }\n  }\n\n  /**\n   * Process entries: filter based on active secret tags and decrypt if necessary\n   */\n  private async processEntries(entries: any[]): Promise<JournalEntryData[]> {\n    // Filter entries based on active secret tags - for now just return all entries\n    // TODO: Implement filtering logic in tagManager\n    const filteredEntries = entries;\n    \n    // Decrypt secret tag entries if we have the keys loaded\n    const activeTags = await tagManager.getActiveSecretTags();\n    const activeTagIds = activeTags.map((tag: any) => tag.id);\n    \n    const processedEntries = await Promise.all(\n      filteredEntries.map(async (entry: any) => {\n        if (entry.secret_tag_id && activeTagIds.includes(entry.secret_tag_id)) {\n          return this.decryptSecretTagEntry(entry);\n        }\n        return entry;\n      })\n    );\n    \n    return processedEntries.filter(entry => entry !== null) as JournalEntryData[];\n  }\n\n  /**\n   * Decrypt a secret tag journal entry\n   */\n  private async decryptSecretTagEntry(entry: any): Promise<JournalEntryData | null> {\n    const secretTagId = entry.secret_tag_id;\n    \n    if (!secretTagId) {\n      logger.warn('Entry has no secret tag ID, cannot decrypt');\n      return null;\n    }\n\n    if (!zeroKnowledgeEncryption.isPhraseKeyLoaded(secretTagId)) {\n      logger.warn(`Cannot decrypt entry: secret tag key not loaded for ${secretTagId}`);\n      return null;\n    }\n\n    try {\n      // Check if we have the necessary encryption fields\n      if (!entry.encrypted_content || !entry.encryption_iv || !entry.encryption_salt) {\n        logger.warn('Entry missing encryption fields, cannot decrypt');\n        return null;\n      }\n\n      const encrypted = {\n        encryptedContent: entry.encrypted_content,\n        encryptedKey: entry.encrypted_key || '',\n        iv: entry.encryption_iv,\n        salt: entry.encryption_salt,\n        algorithm: entry.encryption_algorithm || 'AES-GCM',\n        wrapIv: entry.encryption_wrap_iv || entry.encryption_iv,\n      };\n\n      const decryptedContent = await zeroKnowledgeEncryption.decryptEntryWithSecretPhrase(\n        encrypted, \n        secretTagId\n      );\n      \n      return {\n        ...entry,\n        content: decryptedContent,\n      };\n    } catch (error) {\n      logger.error('Failed to decrypt secret tag journal entry:', error);\n      // Return entry with encrypted content as fallback\n      return {\n        ...entry,\n        content: '[Encrypted Content - Unable to Decrypt]',\n      };\n    }\n  }\n\n  /**\n   * Search journal entries (only in accessible entries)\n   */\n  async searchEntries(query: string): Promise<JournalEntryData[]> {\n    try {\n      // Get active tag hashes for filtering\n      const activeTags = await tagManager.getActiveSecretTags();\n      const activeTagHashes = activeTags.map((tag: any) => tag.id);\n      \n      const response = await JournalAPI.searchEntries(query, {\n        secret_tag_hashes: activeTagHashes,\n        include_public: true,\n      });\n      \n      const entries = response.data.entries || response.data;\n      return this.processEntries(entries);\n    } catch (error) {\n      logger.error('Failed to search journal entries:', error);\n      throw new Error('Failed to search journal entries');\n    }\n  }\n\n  /**\n   * Update a journal entry\n   */\n  async updateEntry(id: number, updates: Partial<JournalEntryData>): Promise<JournalEntryData> {\n    try {\n      // If content is being updated, check it for secret phrases\n      if (typeof updates.content === 'string') {\n        const { processedContent, detectedTagId } = await this.detectAndProcessSecretPhrase(updates.content);\n        \n        // Update the content with the cleaned version\n        updates.content = processedContent;\n\n        // Secret tags path if enabled\n        if (areSecretTagsEnabled() && detectedTagId && zeroKnowledgeEncryption.isPhraseKeyLoaded(detectedTagId)) {\n          logger.info(`Secret phrase detected during update. Encrypting entry ${id} with tag ${detectedTagId}.`);\n          \n          const encrypted = await zeroKnowledgeEncryption.encryptEntryWithSecretPhrase(processedContent, detectedTagId);\n          const secretTags = await tagManager.getSecretTags();\n          const targetTag = secretTags.find((tag: any) => tag.id === detectedTagId);\n\n          if (!targetTag) {\n            throw new Error(`Secret tag not found: ${detectedTagId}`);\n          }\n          \n          const encryptedUpdatePayload = {\n            ...updates,\n            content: \"\", // Clear plaintext content for the backend\n            encrypted_content: encrypted.encryptedContent,\n            encrypted_key: encrypted.encryptedKey,\n            iv: encrypted.iv,\n            salt: encrypted.salt,\n            algorithm: encrypted.algorithm,\n            wrapIv: encrypted.wrapIv,\n            secret_tag_id: detectedTagId,\n            secret_tag_hash: targetTag.id,\n          };\n          \n          const response = await JournalAPI.updateEntry(id, encryptedUpdatePayload);\n          return {\n            ...response.data,\n            content: processedContent, // Return decrypted content for UI\n          };\n        }\n\n        // Per-user encryption path when secret tags disabled\n        if (!areSecretTagsEnabled()) {\n          logger.info(`Updating entry ${id} with per-user encryption.`);\n          const enc = await clientEncryption.encryptPerUser(processedContent);\n          const encryptedUpdatePayload: any = {\n            ...updates,\n            content: '',\n            encrypted_content: enc.encryptedContent,\n            encryption_iv: enc.iv,\n            encrypted_key: enc.wrappedKey,\n            encryption_wrap_iv: enc.wrapIv,\n            encryption_algorithm: enc.algorithm || 'AES-GCM',\n          };\n          const response = await JournalAPI.updateEntry(id, encryptedUpdatePayload);\n          return { ...response.data, content: processedContent };\n        }\n      }\n      \n      // If no secret phrase was detected or encryption is not ready, perform a standard public update\n      logger.info(`Updating public journal entry ${id}.`);\n      const response = await JournalAPI.updateEntry(id, updates);\n      return response.data;\n    } catch (error) {\n      logger.error(`Failed to update journal entry ${id}:`, error);\n      throw new Error('Failed to update journal entry');\n    }\n  }\n\n  /**\n   * Delete a journal entry\n   */\n  async deleteEntry(id: string): Promise<void> {\n    try {\n      await JournalAPI.deleteEntry(String(id));\n      logger.info(`Deleted journal entry ${String(id)}`);\n    } catch (error) {\n      logger.error(`Failed to delete journal entry ${id}:`, error);\n      throw new Error('Failed to delete journal entry');\n    }\n  }\n}\n\n// Export singleton instance\nexport const encryptedJournalService = new EncryptedJournalService();\nexport default encryptedJournalService; ","import { useState, useRef, useCallback, useEffect } from 'react';\nimport { format } from 'date-fns';\nimport { encryptedJournalService } from '../services/encryptedJournalService';\nimport { JournalEntry } from '../types';\nimport logger from '../utils/logger';\n\nexport interface JournalData {\n  id: string | null;\n  title: string;\n  content: string;\n  tags: string[];\n  audioUri: string | null;\n}\n\nexport interface SaveOptions {\n  silent?: boolean; // If true, no navigation or error callbacks\n  navigateOnSuccess?: boolean; // If true, trigger navigation on success\n}\n\nexport interface JournalEntryHook {\n  journalId: string | null;\n  isSaving: boolean;\n  save: (data?: Partial<JournalData>, options?: SaveOptions) => Promise<string | null>;\n  error: Error | null;\n}\n\ninterface UseJournalEntryOptions {\n  initialData?: Partial<JournalData>;\n  selectedDate?: string; // Date in YYYY-MM-DD format from calendar\n  onSaveComplete?: (id: string | null) => void;\n  onSaveError?: (error: Error) => void;\n}\n\nconst DEFAULT_OPTIONS: UseJournalEntryOptions = {};\n\nconst useJournalEntry = (data: JournalData, options?: UseJournalEntryOptions): JournalEntryHook => {\n  const mergedOptions = { ...DEFAULT_OPTIONS, ...options };\n  const { selectedDate, onSaveComplete, onSaveError } = mergedOptions;\n  const [journalId, setJournalId] = useState<string | null>(data.id);\n  const [isSaving, setIsSaving] = useState(false);\n  const [error, setError] = useState<Error | null>(null);\n  const isMounted = useRef(true);\n  const isNavigatingRef = useRef(false);\n  \n  // Add a reference to always hold the latest data\n  const currentDataRef = useRef<JournalData>(data);\n  \n  // Keep the data reference updated\n  useEffect(() => {\n    currentDataRef.current = {\n      ...data,\n      id: journalId || data.id, // Always use the most up-to-date ID\n    };\n  }, [data, journalId]);\n\n  // Cleanup on unmount\n  useEffect(() => {\n    return () => {\n      isMounted.current = false;\n      // Important: Mark as navigating on unmount to prevent further saves\n      isNavigatingRef.current = true;\n    };\n  }, []);\n\n  // Core save function: handles create (POST) or update (PUT)\n  const performSave = useCallback(async (currentData: JournalData): Promise<string | null> => {\n    // Check if component unmounted or navigation started\n    if (!isMounted.current || isNavigatingRef.current) {\n      logger.warn('performSave: Save aborted: Component unmounting or navigation in progress');\n      return null;\n    }\n    \n    // Check if there's anything to save\n    if (!currentData.content.trim() && !currentData.title.trim() && !currentData.audioUri) {\n      logger.warn('performSave: Save skipped: No title, content, or audio URI.');\n      return null;\n    }\n      \n    // Don't send blob URLs to backend - they can't be accessed by the server\n    let audioUrl = null;\n    if (currentData.audioUri && !currentData.audioUri.startsWith('blob:')) {\n      audioUrl = currentData.audioUri;\n    } else if (currentData.audioUri) {\n      logger.info('performSave: Detected blob URL for audio. This will not be sent to backend.');\n    }\n    \n    // Use selectedDate if provided, otherwise use current date\n    let entryDate: string;\n    if (selectedDate) {\n      // Parse the selectedDate (YYYY-MM-DD format) and create a proper UTC date\n      // Set it to noon UTC to avoid timezone issues\n      const [year, month, day] = selectedDate.split('-').map(Number);\n      const utcDate = new Date(Date.UTC(year, month - 1, day, 12, 0, 0, 0));\n      entryDate = utcDate.toISOString();\n      logger.info(`performSave: Using selectedDate ${selectedDate}, converted to UTC: ${entryDate}`);\n    } else {\n      entryDate = new Date().toISOString();\n      logger.info(`performSave: Using current date: ${entryDate}`);\n    }\n      \n    const entryData = {\n      title: currentData.title.trim() || `Journal - ${format(new Date(), 'yyyy-MM-dd HH:mm')}`,\n      content: currentData.content.trim(),\n      entry_date: entryDate,\n      audio_url: audioUrl || undefined, // Convert null to undefined for type compatibility\n      tags: currentData.tags,\n    };\n\n    try {\n      // Final check before API call\n      if (!isMounted.current || isNavigatingRef.current) {\n        logger.warn('performSave: Save aborted just before API call: Component unmounting or navigation in progress');\n        return null;\n      }\n      \n      let response;\n      if (currentData.id !== null) {\n        logger.info(`performSave: Updating journal entry ID: ${currentData.id}`);\n        const updatedEntry = await encryptedJournalService.updateEntry(currentData.id, entryData);\n        logger.info(`performSave: Journal entry ID: ${currentData.id} updated.`);\n        return currentData.id;\n      } else {\n        logger.info('performSave: Creating new journal entry with data:', entryData);\n        const newEntry = await encryptedJournalService.createEntry(entryData);\n        const newId = String(newEntry.id);\n        logger.info(`performSave: New journal entry created with ID: ${newId}`);\n        if (isMounted.current && !isNavigatingRef.current) {\n          setJournalId(newId);\n        }\n        return newId;\n      }\n    } catch (err) {\n      // Only set error if still mounted and not navigating\n      if (isMounted.current && !isNavigatingRef.current) {\n        const error = err instanceof Error ? err : new Error('Error saving journal entry');\n        logger.error('performSave: Error saving journal entry', error);\n        setError(error);\n        if (onSaveError) {\n          onSaveError(error);\n        }\n      } else {\n          logger.warn('performSave: Save error occurred, but component unmounted or navigating. Error not propagated.', err);\n      }\n      // Rethrow so the caller knows it failed, even if state isn't updated\n      throw err; \n    }\n  }, [onSaveError, selectedDate]);\n\n  // Immediate save function\n  const save = useCallback(async (dataOverride?: Partial<JournalData>, options?: SaveOptions): Promise<string | null> => {\n    const { silent = false, navigateOnSuccess = false } = options || {};\n    \n    // Check if already saving\n    if (isSaving) {\n      logger.debug('save: Save skipped: Another save operation is in progress.');\n      return null;\n    }\n\n    // Check mounted status before proceeding\n    if (!isMounted.current || isNavigatingRef.current) {\n      logger.warn('save: Save aborted: Component unmounting or navigation in progress');\n      return null;\n    }\n    \n    logger.info(`save: Starting ${silent ? 'silent' : 'manual'} save operation...`);\n    \n    setIsSaving(true);\n    setError(null);\n    let savedId: string | null = null;\n    \n    try {\n      // Merge current data with any overrides\n      const currentData = currentDataRef.current;\n      const finalData: JournalData = {\n        ...currentData,\n        ...dataOverride,\n      };\n      \n      // Perform the save operation\n      savedId = await performSave(finalData);\n      logger.info(`save: performSave completed. Result ID: ${savedId}.`);\n      \n      // Handle success callbacks only if component is still mounted\n      if (isMounted.current && !isNavigatingRef.current) {\n        if (savedId !== null) {\n          setJournalId(savedId);\n          \n          // Only trigger navigation callback for non-silent saves\n          if (!silent && navigateOnSuccess && onSaveComplete) {\n            logger.info('save: Triggering navigation callback.');\n            onSaveComplete(savedId);\n          } else {\n            logger.info(`save: Success (${silent ? 'silent' : 'manual'}) - no navigation.`);\n          }\n        }\n      }\n      \n      return savedId;\n    } catch (err) {\n      logger.error('save: Save operation failed:', err);\n      \n      // Only trigger error callback for non-silent saves\n      if (!silent && isMounted.current && !isNavigatingRef.current && onSaveError) {\n        const error = err instanceof Error ? err : new Error('Error saving journal entry');\n        setError(error);\n        onSaveError(error);\n      } else if (silent) {\n        logger.info('save: Silent save failed - no error callback triggered.');\n      }\n      \n      return null;\n    } finally {\n      // Ensure isSaving is set to false only if the component is still mounted\n      if (isMounted.current) {\n        setIsSaving(false);\n      }\n    }\n  }, [performSave, isSaving, onSaveComplete, onSaveError]);\n\n  // Add a comprehensive unmount cleanup at the end of the hook, after all functions are defined\n  useEffect(() => {\n    return () => {\n      // This will run when the component unmounts\n      logger.info('Final cleanup on unmount');\n      \n      // Ensure we're marked as unmounted and navigating\n      isMounted.current = false;\n      isNavigatingRef.current = true;\n    };\n  }, []);\n\n  return {\n    journalId,\n    isSaving,\n    save,\n    error,\n  };\n};\n\nexport default useJournalEntry; ","import React, { useState, useEffect, useRef, useCallback, useMemo } from 'react';\nimport {\n  View,\n  StyleSheet,\n  Text,\n  TouchableOpacity,\n  KeyboardAvoidingView,\n  Platform,\n  ActivityIndicator,\n  Alert,\n} from 'react-native';\nimport { useNavigation, useRoute, RouteProp, useIsFocused } from '@react-navigation/native';\nimport { StackNavigationProp } from '@react-navigation/stack';\nimport { Ionicons } from '@expo/vector-icons';\n\n// Types\nimport { MainStackParamList, RecordScreenParams } from '../../navigation/types'; // Removed RootStackParamList\n\n// Components\nimport AudioRecorder from '../../components/AudioRecorder';\nimport { SecretTagFloatingIndicator } from '../../components/SecretTagIndicator';\nimport { areSecretTagsEnabled } from '../../config/featureFlags';\n\n// Hooks\nimport useJournalEntry from '../../hooks/useJournalEntry'; // Removed JournalData import as it's implicitly used\nimport { getLanguageName } from '../../config/languageConfig';\nimport { useHiddenMode } from '../../contexts/HiddenModeContext';\nimport { useSettings } from '../../contexts/SettingsContext';\nimport { tagManager } from '../../services/tagManager';\nimport { SecretTagV2 } from '../../services/secretTagOnlineManager';\n\n// Utils\nimport logger from '../../utils/logger';\nimport { useAppTheme } from '../../contexts/ThemeContext';\nimport { AppTheme } from '../../config/theme';\nimport { JournalAPI } from '../../services/api';\n\n// --- Special Tag for Hidden Entries (Client-Side) ---\nconst HIDDEN_ENTRY_TAG = \"_hidden_entry\";\n// ----------------------------------------------------\n\n// Type definitions for navigation and route\ntype RecordScreenRouteProp = RouteProp<MainStackParamList, 'Record'>;\ntype RecordScreenNavigationProp = StackNavigationProp<MainStackParamList, 'Record'>;\n\nconst RecordScreen: React.FC = () => {\n  logger.info('RecordScreen instance created/rendered.');\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n  const navigation = useNavigation<RecordScreenNavigationProp>();\n  const route = useRoute<RecordScreenRouteProp>();\n  const { isHiddenMode } = useHiddenMode();\n  const { settings } = useSettings();\n  \n  // Use the Auto Recording setting instead of route parameter\n  const startRecordingOnMount = settings.autoRecordingEnabled;\n  \n  // Log the auto-recording behavior\n  useEffect(() => {\n    if (startRecordingOnMount) {\n      logger.info('[RecordScreen] Auto-recording is enabled - recording will start automatically');\n    } else {\n      logger.info('[RecordScreen] Auto-recording is disabled - user must manually start recording');\n    }\n  }, [startRecordingOnMount]);\n  const selectedDate = route.params?.selectedDate; // Get selectedDate from route params\n  const journalId = route.params?.journalId; // Get journalId for appending to existing entry\n  const vibeEmoji = route.params?.vibeEmoji; // Get vibe emoji\n  const vibeTag = route.params?.vibeTag; // Get vibe tag\n  \n  // Log if using a custom date or vibe parameters\n  useEffect(() => {\n    if (selectedDate) {\n      logger.info(`[RecordScreen] Using selected date from calendar: ${selectedDate}`);\n    } else {\n      logger.info('[RecordScreen] Using current date for new entry');\n    }\n    \n    if (journalId) {\n      logger.info(`[RecordScreen] Appending to existing entry: ${journalId}`);\n    } else {\n      logger.info('[RecordScreen] Creating new entry');\n    }\n    \n    if (vibeEmoji && vibeTag) {\n      logger.info(`[RecordScreen] Vibe check-in: ${vibeEmoji} (tag: ${vibeTag})`);\n    }\n  }, [selectedDate, journalId, vibeEmoji, vibeTag]);\n\n  // UI states\n  const [isLoading, setIsLoading] = useState(false);\n  const [showRecorder, setShowRecorder] = useState(true); // Start with recorder visible\n  const [hasStartedSaving, setHasStartedSaving] = useState(false);\n  const [activeTags, setActiveTags] = useState<SecretTagV2[]>([]);\n  const [recorderState, setRecorderState] = useState('idle');\n  \n  // Data states for saving the entry\n  const [title, setTitle] = useState('');\n  const [content, setContent] = useState('');\n  const [originalContent, setOriginalContent] = useState(''); // Preserve original content for editing mode\n  const [tags, setTags] = useState<string[]>(vibeTag ? [vibeTag] : ['journal']);\n  const [audioUri, setAudioUri] = useState<string | null>(null);\n  const [isLoadingExistingEntry, setIsLoadingExistingEntry] = useState(false);\n  \n  // Load existing entry data if journalId is provided\n  useEffect(() => {\n    if (journalId) {\n             const loadExistingEntry = async () => {\n         try {\n           setIsLoadingExistingEntry(true);\n           const response = await JournalAPI.getEntry(parseInt(journalId));\n           const entry = response.data;\n           \n           logger.info(`[RecordScreen] Loaded existing entry for appending: ${entry.title}`);\n           setTitle(entry.title || '');\n           const entryContent = entry.content || '';\n           setContent(entryContent);\n           setOriginalContent(entryContent); // Store original content separately\n           setTags(entry.tags?.map((tag: any) => tag.name) || ['journal']);\n           setAudioUri(entry.audio_url);\n         } catch (error) {\n           logger.error(`[RecordScreen] Failed to load existing entry ${journalId}:`, error);\n           // Continue with empty data if loading fails\n         } finally {\n           setIsLoadingExistingEntry(false);\n         }\n       };\n      \n      loadExistingEntry();\n    }\n  }, [journalId]);\n  \n  const mountedRef = useRef(true);\n\n  const {\n    isSaving,\n    save,\n  } = useJournalEntry(\n    useMemo(() => {\n      let currentTags = tags;\n      if (isHiddenMode && !currentTags.includes(HIDDEN_ENTRY_TAG)) {\n        currentTags = [...currentTags, HIDDEN_ENTRY_TAG];\n      } else if (!isHiddenMode && currentTags.includes(HIDDEN_ENTRY_TAG)) {\n        currentTags = currentTags.filter(t => t !== HIDDEN_ENTRY_TAG);\n      }\n      return {\n        id: journalId || null, // Use existing entry ID if provided\n        title,\n        content,\n        tags: currentTags,\n        audioUri,\n      };\n    }, [title, content, tags, audioUri, isHiddenMode]),\n    {\n      selectedDate: selectedDate, // Pass selectedDate from route params\n      onSaveComplete: useCallback((savedId: string | null) => {\n        if (!mountedRef.current) {\n          logger.debug('[RecordScreen] onSaveComplete: Aborted (unmounted).');\n          return;\n        }\n        if (savedId) {\n          logger.info(`[RecordScreen] Save successful (ID: ${savedId}). Navigating back.`);\n        } else {\n          logger.warn('[RecordScreen] Save completed but no ID received. Navigating back anyway.');\n        }\n        \n        // If we were appending to an existing entry, go back to the detail screen\n        // Otherwise just go back to the previous screen\n        if (navigation.canGoBack()) {\n          navigation.goBack();\n        }\n      }, [navigation]),\n      onSaveError: useCallback((error: Error) => {\n        if (!mountedRef.current) {\n          logger.debug('[RecordScreen] onSaveError: Aborted (unmounted).');\n          return;\n        }\n        logger.error('[RecordScreen] Save failed:', error);\n        Alert.alert('Save Failed', 'Could not save the recording. Please try again.', [\n          { text: 'OK', onPress: () => {\n            if (navigation.canGoBack()) {\n              navigation.goBack();\n            }\n          } }\n        ]);\n      }, [navigation])\n    }\n  );\n\n  useEffect(() => {\n    mountedRef.current = true;\n    return () => {\n      mountedRef.current = false;\n    };\n  }, []);\n\n  // Load active secret tags\n  useEffect(() => {\n    if (!areSecretTagsEnabled()) {\n      setActiveTags([]);\n      return;\n    }\n    const loadActiveTags = async () => {\n      try {\n        const activeTagsList = await tagManager.getActiveSecretTags();\n        setActiveTags(activeTagsList);\n      } catch (error) {\n        logger.error('Failed to load active secret tags:', error);\n      }\n    };\n\n    loadActiveTags();\n  }, []);\n\n  const handleTranscriptionComplete = useCallback((finalTranscript: string) => {\n    // This logic is being disabled to prevent race conditions with manual saves.\n    // The save operation will now only be triggered by the user pressing the save button.\n    logger.info('[RecordScreen] Transcription completed, but auto-save is disabled.');\n    // logger.log('[RecordScreen] Transcription completed. Preparing to save...');\n    // setSaveData({\n    //   content: finalTranscript,\n    //   options: { silent: false, navigate: true },\n    // });\n  }, []);\n\n  // Handle manual save from AudioRecorder\n  const handleManualSave = useCallback(async (newTranscript: string, finalAudioUri?: string) => {\n    if (!mountedRef.current || isSaving) return;\n    \n    logger.info('[RecordScreen] Manual save triggered.');\n    \n    // Combine existing content with new transcript\n    const finalContent = journalId && originalContent \n      ? originalContent + '\\n\\n' + newTranscript \n      : newTranscript;\n    \n    // Only set title if it's empty (don't override existing titles)\n    let finalTitle = title;\n    if (newTranscript && !title) {\n      const words = newTranscript.split(' ');\n      const baseTitle = words.slice(0, 5).join(' ') + (words.length > 5 ? '...' : '');\n      // Add vibe emoji prefix if this is a vibe check-in\n      finalTitle = vibeEmoji ? `${vibeEmoji} ${baseTitle}` : baseTitle;\n      setTitle(finalTitle);\n    }\n    \n    // Update content state for UI consistency\n    setContent(finalContent);\n    if (finalAudioUri) setAudioUri(finalAudioUri);\n    \n    setHasStartedSaving(true);\n    \n    try {\n      // Pass the content explicitly to save function instead of relying on state\n      await save({\n        content: finalContent,\n        title: finalTitle,\n      });\n    } catch (error) {\n      logger.error('[RecordScreen] Manual save failed:', error);\n    }\n  }, [save, title, isSaving, journalId, originalContent]);\n\n  // Handle save with complete edited text (for editing mode)\n  const handleSaveWithCompleteText = useCallback(async (completeText: string) => {\n    if (!mountedRef.current || isSaving) return;\n    \n    logger.info('[RecordScreen] Save with complete text triggered.');\n    \n    // Only set title if it's empty (don't override existing titles)\n    let finalTitle = title;\n    if (completeText && !title) {\n      const words = completeText.split(' ');\n      const baseTitle = words.slice(0, 5).join(' ') + (words.length > 5 ? '...' : '');\n      // Generate clean title without vibe prefix\n      finalTitle = baseTitle;\n      setTitle(finalTitle);\n    }\n    \n    setHasStartedSaving(true);\n    \n    try {\n      // Pass the complete text directly to save function instead of relying on state\n      await save({\n        content: completeText,\n        title: finalTitle,\n      });\n    } catch (error) {\n      logger.error('[RecordScreen] Save with complete text failed:', error);\n    }\n  }, [save, title, isSaving]);\n\n  const handleRecorderCancel = useCallback(() => {\n    if (!mountedRef.current) {\n      logger.debug('[RecordScreen] handleRecorderCancel: Aborted (unmounted).');\n      return;\n    }\n    logger.info('[RecordScreen] Recording cancelled.');\n    if (navigation.canGoBack()) {\n      navigation.goBack();\n    }\n  }, [navigation]);\n\n  // Handle close button press\n  const handleClose = useCallback(() => {\n    if (!mountedRef.current) {\n      logger.debug('[RecordScreen] handleClose: Aborted (unmounted).');\n      return;\n    }\n    logger.info('[RecordScreen] Close button pressed.');\n    if (navigation.canGoBack()) {\n      navigation.goBack();\n    }\n  }, [navigation]);\n\n  // Handle auto-save from AudioRecorder\n  const handleAutoSave = useCallback(async (currentTranscript: string) => {\n    if (!mountedRef.current) {\n      logger.debug('[RecordScreen] handleAutoSave: Aborted (unmounted).');\n      return;\n    }\n    logger.info('[RecordScreen] Auto-save triggered by new segment.');\n    \n    // Auto-generate title from the first few words if not already set\n    let newTitle = title;\n    if (!title && currentTranscript) {\n      const words = currentTranscript.split(' ');\n      const baseTitle = words.slice(0, 5).join(' ') + (words.length > 5 ? '...' : '');\n      // Generate clean title without vibe prefix\n      const generatedTitle = baseTitle;\n      newTitle = generatedTitle;\n      setTitle(generatedTitle);\n    }\n    \n    // For auto-save, determine the complete content to save\n    let contentToSave;\n    if (journalId && originalContent) {\n      // For existing entries, combine original content with new transcript\n      contentToSave = `${originalContent}\\n\\n${currentTranscript}`;\n    } else {\n      // For new entries, just use the current transcript\n      contentToSave = currentTranscript;\n      // DON'T update content state for new entries to avoid duplication in display\n      // The UI will show transcriptSegments, and auto-save works silently\n    }\n    \n    // Prepare data for save\n    const saveData = {\n      title: newTitle,\n      content: contentToSave,\n    };\n    \n    // Use new save function with explicit data and silent mode\n    try {\n      const savedId = await save(saveData, { \n        silent: true // Silent save - no navigation or error dialogs\n      });\n      \n      if (savedId) {\n        logger.info(`[RecordScreen] Auto-save successful. Entry ID: ${savedId}`);\n        // For new entries, update the journalId so subsequent saves are updates\n        if (!journalId) {\n          // This is now an existing entry for future operations\n          // But don't set originalContent to avoid affecting the display\n        }\n      } else {\n        logger.warn('[RecordScreen] Auto-save completed but no ID returned.');\n      }\n    } catch (error) {\n      logger.error('[RecordScreen] Auto-save failed:', error);\n    }\n  }, [save, title, journalId, originalContent]);\n\n  // Determine save button state\n  const getSaveButtonState = useCallback(() => {\n    if (isSaving) {\n      return { text: 'Saving...', disabled: true, isSaving: true };\n    }\n    if (hasStartedSaving && !isSaving) {\n      return { text: 'Saved', disabled: true, isSaving: false };\n    }\n    return { text: 'Save', disabled: false, isSaving: false };\n  }, [isSaving, hasStartedSaving]);\n\n  const handleCommandDetected = useCallback(() => {\n    logger.info('[RecordScreen] Secret tag command detected. Navigating back.');\n    navigation.goBack();\n  }, [navigation]);\n\n  if (isLoading && !showRecorder) { // Show loading only if recorder isn't active yet\n    return (\n      <View style={styles.container}>\n        <View style={styles.modalOverlay} />\n        <View style={styles.recorderContainer}>\n          {/* Modal Header */}\n          <View style={styles.modalHeader}>\n            <View style={styles.modalHandle} />\n            <TouchableOpacity\n              style={styles.closeButton}\n              onPress={handleClose}\n              hitSlop={{ top: 10, bottom: 10, left: 10, right: 10 }}\n            >\n              <Ionicons\n                name=\"close\"\n                size={24}\n                color={theme.colors.textSecondary}\n              />\n            </TouchableOpacity>\n          </View>\n          <View style={styles.loadingContainer}>\n            <ActivityIndicator size=\"large\" color={theme.colors.primary} />\n            <Text style={styles.loadingText}>Loading Recorder...</Text>\n          </View>\n        </View>\n      </View>\n    );\n  }\n  \n  return (\n    <View style={styles.container}> \n      {/* Modal overlay background - only show if this is a new entry (not appending) */}\n      {!journalId && <View style={styles.modalOverlay} />}\n      \n      <View style={styles.contentContainer}>\n        {showRecorder ? (\n          <View style={styles.recorderContainer}>\n            {/* Modal Header with Drag Handle and Close Button */}\n            <View style={styles.modalHeader}>\n              {!journalId && <View style={styles.modalHandle} />}\n              {journalId && (\n                <Text style={styles.headerTitle}>\n                  Add to Entry\n                </Text>\n              )}\n              <TouchableOpacity\n                style={styles.closeButton}\n                onPress={handleClose}\n                hitSlop={{ top: 10, bottom: 10, left: 10, right: 10 }}\n              >\n                <Ionicons\n                  name={journalId ? \"arrow-back\" : \"close\"}\n                  size={24}\n                  color={theme.colors.textSecondary}\n                />\n              </TouchableOpacity>\n            </View>\n\n            {/* Audio Recorder Content */}\n            <View style={styles.recorderContent}>\n              <AudioRecorder\n                onTranscriptionComplete={handleTranscriptionComplete}\n                onCancel={handleRecorderCancel}\n                onManualSave={handleManualSave}\n                onAutoSave={handleAutoSave}\n                saveButtonState={getSaveButtonState()}\n                startRecordingOnMount={startRecordingOnMount}\n                onCommandDetected={handleCommandDetected}\n                existingContent={originalContent || content}\n                onSaveWithCompleteText={handleSaveWithCompleteText}\n              />\n              \n              {/* Secret Tag Floating Indicator */}\n              {areSecretTagsEnabled() && (\n                <SecretTagFloatingIndicator\n                  activeTags={activeTags}\n                  onPress={() => navigation.navigate('TagManagement')}\n                />\n              )}\n            </View>\n          </View>\n        ) : (\n          <View style={styles.recorderContainer}>\n            {/* Modal Header */}\n            <View style={styles.modalHeader}>\n              <View style={styles.modalHandle} />\n              <TouchableOpacity\n                style={styles.closeButton}\n                onPress={handleClose}\n                hitSlop={{ top: 10, bottom: 10, left: 10, right: 10 }}\n              >\n                <Ionicons\n                  name=\"close\"\n                  size={24}\n                  color={theme.colors.textSecondary}\n                />\n              </TouchableOpacity>\n            </View>\n            <View style={styles.loadingContainer}>\n              <ActivityIndicator size=\"large\" color={theme.colors.primary} />\n              <Text style={styles.loadingText}>Processing Recording...</Text>\n            </View>\n          </View>\n        )}\n      </View>\n\n      {isSaving && (\n        <View style={styles.savingOverlay}> \n          <ActivityIndicator size=\"large\" color={theme.colors.primary} />\n          <Text style={styles.loadingText}>\n            Saving Entry...\n          </Text>\n        </View>\n      )}\n    </View>\n  );\n};\n\nconst getStyles = (theme: AppTheme) => StyleSheet.create({\n  container: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  modalOverlay: {\n    ...StyleSheet.absoluteFillObject,\n    backgroundColor: 'rgba(0, 0, 0, 0.4)',\n    zIndex: 1,\n  },\n  contentContainer: {\n    flex: 1,\n    width: '100%',\n    zIndex: 2,\n  },\n  recorderContainer: {\n    flex: 1,\n    width: '100%',\n    backgroundColor: theme.colors.background,\n  },\n  modalHeader: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    paddingHorizontal: theme.spacing.lg,\n    paddingTop: Platform.OS === 'ios' ? 60 : theme.spacing.xl, // Account for status bar\n    paddingBottom: theme.spacing.sm,\n    borderBottomWidth: 1,\n    borderBottomColor: theme.colors.border,\n    backgroundColor: theme.colors.background,\n  },\n  modalHandle: {\n    width: 40,\n    height: 4,\n    backgroundColor: theme.colors.border,\n    borderRadius: 2,\n    position: 'absolute',\n    top: Platform.OS === 'ios' ? 50 : theme.spacing.md,\n    left: '50%',\n    marginLeft: -20,\n  },\n  closeButton: {\n    width: 40,\n    height: 40,\n    borderRadius: 20,\n    backgroundColor: theme.colors.card,\n    justifyContent: 'center',\n    alignItems: 'center',\n    marginLeft: 'auto',\n    ...theme.shadows.sm,\n  },\n  recorderContent: {\n    flex: 1,\n  },\n  loadingContainer: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n    paddingVertical: theme.spacing.xl,\n  },\n  savingOverlay: {\n    ...StyleSheet.absoluteFillObject,\n    backgroundColor: 'rgba(0, 0, 0, 0.7)',\n    justifyContent: 'center',\n    alignItems: 'center',\n    zIndex: 3,\n  },\n  loadingText: {\n    marginTop: theme.spacing.md,\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  headerTitle: {\n    fontSize: theme.typography.fontSizes.lg,\n    fontWeight: '600',\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n});\n\nexport default RecordScreen; ","/**\n * OPAQUE Tag Indicator Component\n * \n * Visual indicator for OPAQUE-based secret tags showing security level,\n * session status, and authentication method.\n */\n\nimport React from 'react';\nimport { View, Text, TouchableOpacity, StyleSheet } from 'react-native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { useAppTheme } from '../contexts/ThemeContext';\nimport { AppTheme } from '../config/theme';\nimport { OpaqueTagIndicatorProps } from '../types/opaqueTypes';\nimport { areSecretTagsEnabled } from '../config/featureFlags';\n\nconst OpaqueTagIndicator: React.FC<OpaqueTagIndicatorProps> = ({\n  tag,\n  showSession = true,\n  showSecurityLevel = true,\n  onSessionToggle,\n  size = 'medium'\n}) => {\n  if (!areSecretTagsEnabled()) {\n    return null;\n  }\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme, size);\n\n  // Get security level color and icon\n  const getSecurityLevelInfo = () => {\n    switch (tag.security_level) {\n      case 'enhanced':\n        return {\n          color: '#00C851', // Green\n          icon: 'shield-checkmark' as const,\n          label: 'Enhanced'\n        };\n      case 'standard':\n        return {\n          color: '#007AFF', // Blue\n          icon: 'shield' as const,\n          label: 'Standard'\n        };\n      case 'legacy':\n        return {\n          color: '#FF9500', // Orange\n          icon: 'shield-outline' as const,\n          label: 'Legacy'\n        };\n      default:\n        return {\n          color: '#8E8E93', // Gray\n          icon: 'shield-outline' as const,\n          label: 'Unknown'\n        };\n    }\n  };\n\n  // Get authentication method info\n  const getAuthMethodInfo = () => {\n    switch (tag.auth_method) {\n      case 'opaque':\n        return {\n          color: '#00C851', // Green\n          icon: 'key' as const,\n          label: 'OPAQUE'\n        };\n      case 'legacy':\n        return {\n          color: '#FF9500', // Orange\n          icon: 'key-outline' as const,\n          label: 'Legacy'\n        };\n      default:\n        return {\n          color: '#8E8E93', // Gray\n          icon: 'key-outline' as const,\n          label: 'Unknown'\n        };\n    }\n  };\n\n  const securityInfo = getSecurityLevelInfo();\n  const authInfo = getAuthMethodInfo();\n\n  return (\n    <View style={styles.container}>\n      {/* Security Level Indicator */}\n      {showSecurityLevel && (\n        <View style={styles.indicatorGroup}>\n          <View style={[styles.indicator, { backgroundColor: securityInfo.color + '20' }]}>\n            <Ionicons \n              name={securityInfo.icon} \n              size={size === 'small' ? 12 : size === 'large' ? 18 : 14}\n              color={securityInfo.color}\n            />\n            {size !== 'small' && (\n              <Text style={[styles.indicatorText, { color: securityInfo.color }]}>\n                {securityInfo.label}\n              </Text>\n            )}\n          </View>\n        </View>\n      )}\n\n      {/* Authentication Method Indicator */}\n      <View style={styles.indicatorGroup}>\n        <View style={[styles.indicator, { backgroundColor: authInfo.color + '20' }]}>\n          <Ionicons \n            name={authInfo.icon} \n            size={size === 'small' ? 12 : size === 'large' ? 18 : 14}\n            color={authInfo.color}\n          />\n          {size !== 'small' && (\n            <Text style={[styles.indicatorText, { color: authInfo.color }]}>\n              {authInfo.label}\n            </Text>\n          )}\n        </View>\n      </View>\n\n      {/* Session Status Indicator */}\n      {showSession && onSessionToggle && (\n        <TouchableOpacity \n          style={styles.sessionToggle}\n          onPress={() => onSessionToggle(tag.id)}\n          accessibilityLabel=\"Toggle session status\"\n          accessibilityRole=\"button\"\n        >\n          <View style={[styles.indicator, { backgroundColor: theme.colors.primary + '20' }]}>\n            <Ionicons \n              name=\"time\" \n              size={size === 'small' ? 12 : size === 'large' ? 18 : 14}\n              color={theme.colors.primary}\n            />\n            {size !== 'small' && (\n              <Text style={[styles.indicatorText, { color: theme.colors.primary }]}>\n                Session\n              </Text>\n            )}\n          </View>\n        </TouchableOpacity>\n      )}\n\n      {/* Device Binding Indicator */}\n      {tag.device_fingerprint && (\n        <View style={styles.indicatorGroup}>\n          <View style={[styles.indicator, { backgroundColor: '#00C851' + '20' }]}>\n            <Ionicons \n              name=\"phone-portrait\" \n              size={size === 'small' ? 12 : size === 'large' ? 18 : 14}\n              color=\"#00C851\"\n            />\n            {size === 'large' && (\n              <Text style={[styles.indicatorText, { color: '#00C851' }]}>\n                Device Bound\n              </Text>\n            )}\n          </View>\n        </View>\n      )}\n\n      {/* Migration Indicator */}\n      {tag.migrated_from && (\n        <View style={styles.indicatorGroup}>\n          <View style={[styles.indicator, { backgroundColor: '#FF9500' + '20' }]}>\n            <Ionicons \n              name=\"refresh\" \n              size={size === 'small' ? 12 : size === 'large' ? 18 : 14}\n              color=\"#FF9500\"\n            />\n            {size === 'large' && (\n              <Text style={[styles.indicatorText, { color: '#FF9500' }]}>\n                Migrated\n              </Text>\n            )}\n          </View>\n        </View>\n      )}\n    </View>\n  );\n};\n\nconst getStyles = (theme: AppTheme, size: 'small' | 'medium' | 'large') => {\n  const padding = size === 'small' ? 4 : size === 'large' ? 8 : 6;\n  const fontSize = size === 'small' ? 10 : size === 'large' ? 12 : 11;\n  const spacing = size === 'small' ? 4 : size === 'large' ? 8 : 6;\n\n  return StyleSheet.create({\n    container: {\n      flexDirection: 'row',\n      alignItems: 'center',\n      flexWrap: 'wrap',\n      gap: spacing,\n    },\n    indicatorGroup: {\n      flexDirection: 'row',\n      alignItems: 'center',\n    },\n    indicator: {\n      flexDirection: 'row',\n      alignItems: 'center',\n      paddingHorizontal: padding,\n      paddingVertical: padding / 2,\n      borderRadius: 12,\n      gap: 4,\n    },\n    indicatorText: {\n      fontSize,\n      fontWeight: '500',\n      fontFamily: theme.typography.fontFamilies.medium,\n    },\n    sessionToggle: {\n      // Add touch feedback styles if needed\n    },\n  });\n};\n\nexport default OpaqueTagIndicator; ","/**\n * Secret Tag Setup Component\n * \n * Allows users to create new secret tags with custom names, phrases, and colors.\n * Enhanced to support both legacy and OPAQUE-based authentication methods.\n */\n\nimport React, { useState, useCallback } from 'react';\nimport {\n  View,\n  Text,\n  TextInput,\n  TouchableOpacity,\n  StyleSheet,\n  Alert,\n  ActivityIndicator,\n  ScrollView,\n} from 'react-native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { useAppTheme } from '../contexts/ThemeContext';\nimport { AppTheme } from '../config/theme';\nimport OpaqueTagIndicator from './OpaqueTagIndicator';\nimport logger from '../utils/logger';\nimport { OpaqueSecretTag } from '../types/opaqueTypes';\nimport { api } from '../services/api';\nimport { OpaqueAuthService } from '../services/opaqueAuth';\nimport { areSecretTagsEnabled } from '../config/featureFlags';\nimport { tagManager } from '../services/tagManager';\n\ninterface SecretTagSetupProps {\n  onTagCreated?: (tagId: string) => void;\n  onCancel?: () => void;\n  existingTagNames?: string[];\n  enableOpaqueAuth?: boolean; // Feature flag for OPAQUE authentication\n}\n\nconst SecretTagSetup: React.FC<SecretTagSetupProps> = ({\n  onTagCreated,\n  onCancel,\n  existingTagNames = [],\n  enableOpaqueAuth = true,\n}) => {\n  if (!areSecretTagsEnabled()) {\n    return null;\n  }\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n  \n  const [tagName, setTagName] = useState('');\n  const [activationPhrase, setActivationPhrase] = useState('');\n  const [confirmationPhrase, setConfirmationPhrase] = useState('');\n  const [selectedColor, setSelectedColor] = useState('#007AFF');\n  const [isLoading, setIsLoading] = useState(false);\n  const [useOpaqueAuth, setUseOpaqueAuth] = useState(true);\n  const [securityLevel] = useState<'standard' | 'enhanced'>('standard'); // Always use standard - no user selection needed\n  const [showConfirmation, setShowConfirmation] = useState(false);\n  const [justCreated, setJustCreated] = useState<{ \n    tagName: string; \n    phrase: string; \n    isOpaque: boolean;\n    tag?: OpaqueSecretTag;\n  } | null>(null);\n\n  // Predefined color options\n  const colorOptions = [\n    '#007AFF', // Blue\n    '#34C759', // Green\n    '#FF9500', // Orange\n    '#FF3B30', // Red\n    '#AF52DE', // Purple\n    '#FF2D92', // Pink\n    '#5AC8FA', // Light Blue\n    '#FFCC00', // Yellow\n    '#FF6B6B', // Light Red\n    '#4ECDC4', // Teal\n    '#45B7D1', // Sky Blue\n    '#96CEB4', // Mint Green\n  ];\n\n  /**\n   * Validate tag name\n   */\n  const validateTagName = useCallback((name: string): string | null => {\n    if (!name.trim()) {\n      return 'Tag name cannot be empty';\n    }\n    \n    if (name.length < 2) {\n      return 'Tag name must be at least 2 characters';\n    }\n    \n    if (name.length > 50) {\n      return 'Tag name must be less than 50 characters';\n    }\n    \n    if (existingTagNames.some(existing => existing.toLowerCase() === name.toLowerCase())) {\n      return 'A tag with this name already exists';\n    }\n    \n    return null;\n  }, [existingTagNames]);\n\n  /**\n   * Validate activation phrase\n   */\n  const validatePhrase = useCallback((phrase: string): string | null => {\n    if (!phrase.trim()) {\n      return 'Activation phrase cannot be empty';\n    }\n    \n    if (phrase.length < 3) {\n      return 'Activation phrase must be at least 3 characters';\n    }\n    \n    if (phrase.length > 100) {\n      return 'Activation phrase must be less than 100 characters';\n    }\n    \n    // Check for common words that might be accidentally triggered\n    const commonWords = ['the', 'and', 'or', 'but', 'in', 'on', 'at', 'to', 'for', 'of', 'with', 'by'];\n    if (commonWords.includes(phrase.toLowerCase().trim())) {\n      return 'Please choose a more unique phrase to avoid accidental activation';\n    }\n    \n    return null;\n  }, []);\n\n  /**\n   * Validate phrase confirmation\n   */\n  const validateConfirmation = useCallback((phrase: string, confirmation: string): string | null => {\n    if (!confirmation.trim()) {\n      return 'Please confirm your activation phrase';\n    }\n    \n    if (phrase !== confirmation) {\n      return 'Phrases do not match';\n    }\n    \n    return null;\n  }, []);\n\n  /**\n   * Handle tag creation using OPAQUE protocol\n   */\n  const handleCreateTag = useCallback(async () => {\n    // Validate inputs\n    const nameError = validateTagName(tagName);\n    if (nameError) {\n      Alert.alert('Invalid Name', nameError);\n      return;\n    }\n\n    const phraseError = validatePhrase(activationPhrase);\n    if (phraseError) {\n      Alert.alert('Invalid Phrase', phraseError);\n      return;\n    }\n\n    // Validate confirmation phrase (required for OPAQUE tags)\n    const confirmError = validateConfirmation(activationPhrase, confirmationPhrase);\n    if (confirmError) {\n      Alert.alert('Invalid Confirmation', confirmError);\n      return;\n    }\n\n    setIsLoading(true);\n\n    try {\n      const phrase = activationPhrase.trim();\n      \n      logger.info(' UPDATED CODE: Starting OPAQUE secret tag registration', { \n        tagName: tagName.trim(),\n        phraseLength: phrase.length,\n        timestamp: new Date().toISOString()\n      });\n\n      // Use the exact same OPAQUE flow as user registration\n      const opaqueAuth = OpaqueAuthService.getInstance();\n      \n      // Create a unique identifier for this secret tag registration\n      const secretTagIdentifier = `secret-tag-${tagName.trim().toLowerCase().replace(/\\s+/g, '-')}-${Date.now()}`;\n      \n      logger.info('Step 1: Starting OPAQUE registration with OpaqueAuthService');\n      \n      // Step 1: Start OPAQUE registration (same as user registration)\n      let registrationRequest;\n      try {\n        const result = await opaqueAuth.startRegistration(phrase, secretTagIdentifier);\n        registrationRequest = result.registrationRequest;\n        \n        logger.info('Step 1 Complete: OPAQUE startRegistration result', {\n          registrationRequestType: typeof registrationRequest,\n          registrationRequestLength: registrationRequest?.length,\n          registrationRequestSample: registrationRequest?.slice(0, 50),\n          registrationRequestFull: registrationRequest\n        });\n      } catch (error) {\n        logger.error('Step 1 Failed: OPAQUE startRegistration error', error);\n        throw new Error(`OPAQUE startRegistration failed: ${error instanceof Error ? error.message : String(error)}`);\n      }\n      \n      logger.info('Step 2: Sending registration request to server');\n      \n      // Debug: Log exactly what we're sending\n      const requestData = {\n        opaque_registration_request: registrationRequest,\n        tag_name: tagName.trim(),\n        color: selectedColor\n      };\n      \n      logger.info('Request data being sent to backend:', {\n        opaque_registration_request_length: registrationRequest?.length,\n        opaque_registration_request_type: typeof registrationRequest,\n        opaque_registration_request_sample: registrationRequest?.slice(0, 20),\n        tag_name: requestData.tag_name,\n        color: requestData.color\n      });\n      \n      // Step 2: Send registration request to server (secret tags endpoint)\n      const response = await api.post('/api/v1/secret-tags/register/start', requestData);\n\n      const { opaque_registration_response: registrationResponse, session_id, tag_handle } = response.data;\n      \n      if (!registrationResponse) {\n        throw new Error('Invalid server registration response');\n      }\n\n      logger.info('Step 3: Completing OPAQUE registration');\n      \n      // Step 3: Finish OPAQUE registration (same as user registration)\n      let registrationRecord;\n      try {\n        registrationRecord = await opaqueAuth.finishRegistration(secretTagIdentifier, registrationResponse);\n        \n        logger.info('Step 3 Complete: OPAQUE finishRegistration result', {\n          registrationRecordType: typeof registrationRecord,\n          registrationRecordLength: registrationRecord?.length,\n          registrationRecordSample: registrationRecord?.slice(0, 50),\n          registrationRecordFull: registrationRecord\n        });\n      } catch (error) {\n        logger.error('Step 3 Failed: OPAQUE finishRegistration error', error);\n        throw new Error(`OPAQUE finishRegistration failed: ${error instanceof Error ? error.message : String(error)}`);\n      }\n      \n      if (!registrationRecord) {\n        throw new Error('Failed to complete OPAQUE registration');\n      }\n\n      logger.info('Step 4: Creating secret tag with OPAQUE data', {\n        registrationRequestType: typeof registrationRequest,\n        registrationRequestLength: registrationRequest?.length,\n        registrationRequestValue: registrationRequest,\n        registrationRecordType: typeof registrationRecord,\n        registrationRecordLength: registrationRecord?.length,\n        registrationRecordValue: registrationRecord\n      });\n      \n      // Step 4: Generate salt (16 bytes)\n      const saltBytes = Array.from({ length: 16 }, () => Math.floor(Math.random() * 256));\n      \n      // Step 5: Register the secret tag with the OPAQUE data\n      // Add debugging to see what data we're actually sending\n      logger.info('OPAQUE data before sending to backend:', {\n        registrationRequestType: typeof registrationRequest,\n        registrationRequestLength: registrationRequest.length,\n        registrationRequestSample: registrationRequest.slice(0, 20),\n        registrationRecordType: typeof registrationRecord,\n        registrationRecordLength: registrationRecord.length,\n        registrationRecordSample: registrationRecord.slice(0, 20)\n      });\n      \n      // Test base64 validity before sending\n      logger.info(' About to validate base64 data:', {\n        registrationRequestType: typeof registrationRequest,\n        registrationRequestValue: registrationRequest,\n        registrationRecordType: typeof registrationRecord,\n        registrationRecordValue: registrationRecord\n      });\n      \n      // Validate base64/base64url encoding (OPAQUE uses URL-safe base64)\n      const validateBase64 = (data: string, name: string): void => {\n        try {\n          // Try URL-safe base64 first (OPAQUE standard)\n          const urlSafeDecoded = data.replace(/-/g, '+').replace(/_/g, '/');\n          // Add padding if needed\n          const padding = urlSafeDecoded.length % 4;\n          const paddedData = padding ? urlSafeDecoded + '='.repeat(4 - padding) : urlSafeDecoded;\n          const testDecode = atob(paddedData);\n          logger.info(` ${name} base64url valid (length: ${testDecode.length})`);\n        } catch (error) {\n          logger.error(` ${name} base64 validation failed:`, error);\n          throw new Error(`${name} is not valid base64/base64url`);\n        }\n      };\n\n      try {\n        logger.info(' Validating OPAQUE base64 data...');\n        validateBase64(registrationRequest, 'registrationRequest');\n        validateBase64(registrationRecord, 'registrationRecord');\n        logger.info(' All OPAQUE base64 validation passed');\n      } catch (error) {\n        logger.error('Base64 validation failed:', error);\n        throw new Error('OPAQUE data is not valid base64');\n      }\n      \n      const serverResponse = await api.post('/api/v1/secret-tags/register/finish', {\n        session_id: session_id,\n        opaque_registration_record: registrationRecord\n      });\n\n      if (!serverResponse.data) {\n        throw new Error('Invalid registration response from server');\n      }\n\n      // Step 3: Complete OPAQUE registration (if backend provides registration response)\n      // Note: For secret tags, we might not need the full two-step flow depending on backend implementation\n      // The backend should handle the OPAQUE verification internally\n      \n      const secretTag = serverResponse.data;\n      const tagId = secretTag.tag_id;\n      \n      // Convert to OpaqueSecretTag format for display\n      const createdTag: OpaqueSecretTag = {\n        id: tagId,\n        tag_name: secretTag.tag_name,\n        color_code: secretTag.color_code,\n        created_at: secretTag.created_at,\n        updated_at: secretTag.updated_at,\n        user_id: secretTag.user_id || 0,\n        auth_method: 'opaque' as const,\n        security_level: securityLevel,\n        authentication_count: 0\n      };\n      \n      logger.info('OPAQUE secret tag created successfully:', tagId);\n      \n      // Set success state with created tag info\n      setJustCreated({\n        tagName: tagName.trim(),\n        phrase,\n        isOpaque: true, // Always OPAQUE now\n        tag: createdTag\n      });\n\n      // Clear form\n      setTagName('');\n      setActivationPhrase('');\n      setConfirmationPhrase('');\n      setSelectedColor('#007AFF');\n      setShowConfirmation(false);\n\n      // Call the callback after a short delay to let user see the success message\n      setTimeout(() => {\n        onTagCreated?.(tagId);\n      }, 3000);\n      \n    } catch (error) {\n      logger.error('Failed to create secret tag:', error);\n      \n      // Log detailed error information for debugging\n      if (error && typeof error === 'object' && 'response' in error) {\n        const response = (error as any).response;\n        if (response?.data?.detail) {\n          logger.error('Backend validation error detail:', response.data.detail);\n        }\n        if (response?.data?.errors) {\n          logger.error('Backend validation errors:', response.data.errors);\n        }\n      }\n      \n      Alert.alert(\n        'Creation Failed',\n        error instanceof Error ? error.message : 'Failed to create secret tag'\n      );\n    } finally {\n      setIsLoading(false);\n    }\n  }, [\n    tagName, \n    activationPhrase, \n    confirmationPhrase,\n    selectedColor, \n    securityLevel,\n    validateTagName, \n    validatePhrase, \n    validateConfirmation,\n    onTagCreated\n  ]);\n\n  // Show success message if tag was just created\n  if (justCreated) {\n    return (\n      <View style={styles.container}>\n        <View style={styles.successContainer}>\n          <View style={styles.successIcon}>\n            <Ionicons \n              name={justCreated.isOpaque ? \"shield-checkmark\" : \"checkmark-circle\"} \n              size={64} \n              color={justCreated.isOpaque ? '#00C851' : (theme.colors.success || '#34C759')} \n            />\n          </View>\n          \n          <Text style={styles.successTitle}>\n            {justCreated.isOpaque ? 'OPAQUE Secret Tag Created!' : 'Secret Tag Created!'}\n          </Text>\n\n          {/* Show OPAQUE tag indicator if applicable */}\n          {justCreated.isOpaque && justCreated.tag && (\n            <View style={styles.opaqueIndicatorContainer}>\n              <OpaqueTagIndicator \n                tag={justCreated.tag}\n                showSession={false}\n                showSecurityLevel={true}\n                size=\"large\"\n              />\n            </View>\n          )}\n          \n          <View style={styles.successDetails}>\n            <Text style={styles.successLabel}>Tag Name:</Text>\n            <Text style={styles.successValue}>{justCreated.tagName}</Text>\n            \n            <Text style={styles.successLabel}>Activation Phrase:</Text>\n            <Text style={styles.successValue}>\"{justCreated.phrase}\"</Text>\n\n            {justCreated.isOpaque && (\n              <>\n                <Text style={styles.successLabel}>Authentication:</Text>\n                <Text style={styles.successValue}>Zero-Knowledge OPAQUE</Text>\n              </>\n            )}\n          </View>\n\n          <View style={styles.successInstructions}>\n            <Text style={styles.successInstructionText}>\n              Your tag is protected with OPAQUE zero-knowledge authentication. \n              Include your activation phrase in journal entries to automatically access encrypted content.\n            </Text>\n          </View>\n\n          {justCreated.isOpaque && (\n            <View style={styles.securityNotice}>\n              <View style={styles.securityNoticeIcon}>\n                <Ionicons name=\"warning\" size={20} color=\"#FF9500\" />\n              </View>\n              <Text style={styles.securityNoticeText}>\n                <Text style={styles.securityNoticeTextBold}>Important:</Text> This phrase cannot be recovered if forgotten. \n                Your encrypted entries will be permanently inaccessible without it.\n              </Text>\n            </View>\n          )}\n\n          <TouchableOpacity \n            style={styles.continueButton}\n            onPress={() => {\n              setJustCreated(null);\n              onTagCreated?.(justCreated.tagName);\n            }}\n          >\n            <Text style={styles.continueButtonText}>Continue</Text>\n          </TouchableOpacity>\n        </View>\n      </View>\n    );\n  }\n\n  return (\n    <ScrollView style={styles.container}>\n      <View style={styles.card}>\n        <Text style={styles.title}>Create Secret Tag</Text>\n        \n        <Text style={styles.description}>\n          Secret tags provide independent privacy levels for your journal entries.\n          Include your activation phrase in journal entries to automatically access encrypted content.\n        </Text>\n\n        {/* Security Information */}\n        <View style={styles.securityLevelContainer}>\n          <Text style={styles.securityLevelTitle}>Security Level</Text>\n          <Text style={styles.securityLevelDescription}>\n            All tags use OPAQUE zero-knowledge authentication with server-side phrase detection.\n            Neither we nor anyone else can see or recover your secret tags or entries.\n          </Text>\n          <View style={styles.securityInfoBox}>\n            <Ionicons \n              name=\"shield-checkmark\" \n              size={24} \n              color=\"#00C851\" \n            />\n            <Text style={styles.securityInfoText}>\n              Zero-Knowledge OPAQUE Authentication\n            </Text>\n          </View>\n        </View>\n\n        {/* Critical Warning Section */}\n        <View style={styles.warningContainer}>\n          <View style={styles.warningHeader}>\n            <Ionicons name=\"warning\" size={20} color={theme.colors.error} />\n            <Text style={styles.warningTitle}>\n              {useOpaqueAuth && enableOpaqueAuth \n                ? 'IMPORTANT: OPAQUE Zero-Knowledge Privacy'\n                : 'IMPORTANT: Zero-Knowledge Privacy'\n              }\n            </Text>\n          </View>\n          \n          <Text style={styles.warningText}>\n            This tag uses OPAQUE zero-knowledge authentication with server-side phrase detection.\n            Neither we nor anyone else can see or recover your secret tags or entries.\n          </Text>\n          \n          <Text style={styles.warningTextBold}>\n            If you forget your activation phrase, all entries with this tag will be permanently lost. There is no recovery method.\n          </Text>\n          \n          <Text style={styles.warningTextBold}>\n            To access encrypted entries, type your exact activation phrase in a journal entry.\n          </Text>\n          \n          <View style={styles.warningTips}>\n            <Text style={styles.warningTipTitle}>Tips for remembering phrases:</Text>\n            <View style={styles.warningTipItem}>\n              <View style={styles.warningBullet} />\n              <Text style={styles.warningTip}>Use phrases that are meaningful to you</Text>\n            </View>\n            <View style={styles.warningTipItem}>\n              <View style={styles.warningBullet} />\n              <Text style={styles.warningTip}>Consider writing them down in a secure location</Text>\n            </View>\n            <View style={styles.warningTipItem}>\n              <View style={styles.warningBullet} />\n              <Text style={styles.warningTip}>Test your phrases after creation</Text>\n            </View>\n            {useOpaqueAuth && enableOpaqueAuth && (\n              <View style={styles.warningTipItem}>\n                <View style={styles.warningBullet} />\n                <Text style={styles.warningTip}>Ensure this device remains accessible for future use</Text>\n              </View>\n            )}\n          </View>\n        </View>\n\n        {/* Tag Name Input */}\n        <View style={styles.inputContainer}>\n          <Text style={styles.label}>Tag Name</Text>\n          <TextInput\n            style={[\n              styles.input,\n              tagName && validateTagName(tagName) ? styles.inputError : styles.inputValid\n            ]}\n            value={tagName}\n            onChangeText={setTagName}\n            placeholder=\"e.g., Work Private, Personal Thoughts\"\n            autoCapitalize=\"words\"\n            autoCorrect={false}\n            maxLength={50}\n          />\n          <View style={[\n            styles.validationContainer,\n            tagName && validateTagName(tagName) ? styles.validationError : styles.validationSuccess\n          ]}>\n            <Text style={[\n              styles.validationText,\n              tagName && validateTagName(tagName) ? styles.validationTextError : styles.validationTextSuccess\n            ]}>\n              {tagName && validateTagName(tagName) ? validateTagName(tagName) : tagName ? ' Tag name looks good' : 'Enter a unique tag name'}\n            </Text>\n          </View>\n        </View>\n\n        {/* Activation Phrase Input */}\n        <View style={styles.inputContainer}>\n          <Text style={styles.label}>Activation Phrase</Text>\n          <TextInput\n            style={[\n              styles.input,\n              activationPhrase && validatePhrase(activationPhrase) ? styles.inputError : styles.inputValid\n            ]}\n            value={activationPhrase}\n            onChangeText={setActivationPhrase}\n            placeholder=\"e.g., activate work mode, private thoughts\"\n            autoCapitalize=\"none\"\n            autoCorrect={false}\n            maxLength={100}\n          />\n          <View style={[\n            styles.validationContainer,\n            activationPhrase && validatePhrase(activationPhrase) ? styles.validationError : styles.validationSuccess\n          ]}>\n            <Text style={[\n              styles.validationText,\n              activationPhrase && validatePhrase(activationPhrase) ? styles.validationTextError : styles.validationTextSuccess\n            ]}>\n              {activationPhrase && validatePhrase(activationPhrase) ? validatePhrase(activationPhrase) : activationPhrase ? ' Activation phrase looks good' : 'Enter a unique activation phrase'}\n            </Text>\n          </View>\n        </View>\n\n        {/* Confirmation Phrase Input - Only for OPAQUE */}\n        {useOpaqueAuth && enableOpaqueAuth && (\n          <View style={styles.inputContainer}>\n            <Text style={styles.label}>Confirm Activation Phrase</Text>\n            <TextInput\n              style={[\n                styles.input,\n                confirmationPhrase && validateConfirmation(activationPhrase, confirmationPhrase) ? styles.inputError : styles.inputValid\n              ]}\n              value={confirmationPhrase}\n              onChangeText={setConfirmationPhrase}\n              placeholder=\"Re-enter your activation phrase\"\n              autoCapitalize=\"none\"\n              autoCorrect={false}\n              maxLength={100}\n            />\n            <View style={[\n              styles.validationContainer,\n              confirmationPhrase && validateConfirmation(activationPhrase, confirmationPhrase) ? styles.validationError : styles.validationSuccess\n            ]}>\n              <Text style={[\n                styles.validationText,\n                confirmationPhrase && validateConfirmation(activationPhrase, confirmationPhrase) ? styles.validationTextError : styles.validationTextSuccess\n              ]}>\n                {confirmationPhrase && validateConfirmation(activationPhrase, confirmationPhrase) \n                  ? validateConfirmation(activationPhrase, confirmationPhrase) \n                  : confirmationPhrase && activationPhrase === confirmationPhrase \n                    ? ' Phrases match' \n                    : 'Confirm your activation phrase'\n                }\n              </Text>\n            </View>\n          </View>\n        )}\n\n        {/* Color Selection */}\n        <View style={styles.inputContainer}>\n          <Text style={styles.label}>Tag Color</Text>\n          <View style={styles.colorGrid}>\n            {colorOptions.map((color) => (\n              <TouchableOpacity\n                key={color}\n                style={[\n                  styles.colorOption,\n                  { backgroundColor: color },\n                  selectedColor === color && styles.selectedColorOption,\n                ]}\n                onPress={() => setSelectedColor(color)}\n              >\n                {selectedColor === color && (\n                  <Ionicons name=\"checkmark\" size={16} color={theme.colors.background} />\n                )}\n              </TouchableOpacity>\n            ))}\n          </View>\n        </View>\n\n        {/* Action Buttons */}\n        <View style={styles.buttonContainer}>\n          <TouchableOpacity \n            style={[styles.button, styles.cancelButton]}\n            onPress={onCancel}\n            disabled={isLoading}\n          >\n            <Text style={styles.cancelButtonText}>Cancel</Text>\n          </TouchableOpacity>\n\n          <TouchableOpacity \n            style={[styles.button, styles.createButton]}\n            onPress={handleCreateTag}\n            disabled={isLoading || !tagName || !activationPhrase}\n          >\n            {isLoading ? (\n              <ActivityIndicator color=\"#FFFFFF\" />\n            ) : (\n              <Text style={styles.buttonText}>Create Secret Tag</Text>\n            )}\n          </TouchableOpacity>\n        </View>\n      </View>\n    </ScrollView>\n  );\n};\n\nconst getStyles = (theme: AppTheme) => StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: theme.colors.background,\n  },\n  card: {\n    backgroundColor: theme.colors.card,\n    margin: theme.spacing.lg,\n    padding: theme.spacing.xl,\n    borderRadius: 12,\n    ...theme.shadows.sm,\n  },\n  title: {\n    fontSize: theme.typography.fontSizes.xl,\n    fontWeight: 'bold',\n    textAlign: 'center',\n    marginBottom: theme.spacing.lg,\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.bold,\n  },\n  description: {\n    fontSize: theme.typography.fontSizes.md,\n    lineHeight: 24,\n    textAlign: 'center',\n    marginBottom: theme.spacing.xl,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n\n  // Warning Section Styles\n  warningContainer: {\n    backgroundColor: '#FFF3CD',\n    borderColor: '#FFEAA7',\n    borderWidth: 1,\n    borderRadius: 8,\n    padding: theme.spacing.lg,\n    marginBottom: theme.spacing.xl,\n  },\n  warningHeader: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginBottom: theme.spacing.md,\n  },\n  warningTitle: {\n    fontSize: theme.typography.fontSizes.md,\n    fontWeight: 'bold',\n    color: theme.colors.error,\n    marginLeft: theme.spacing.sm,\n    fontFamily: theme.typography.fontFamilies.bold,\n  },\n  warningText: {\n    fontSize: theme.typography.fontSizes.sm,\n    color: '#856404',\n    lineHeight: 20,\n    marginBottom: theme.spacing.sm,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  warningTextBold: {\n    fontSize: theme.typography.fontSizes.sm,\n    color: '#721C24',\n    lineHeight: 20,\n    fontWeight: 'bold',\n    marginBottom: theme.spacing.md,\n    fontFamily: theme.typography.fontFamilies.bold,\n  },\n  warningTips: {\n    marginTop: theme.spacing.sm,\n  },\n  warningTipTitle: {\n    fontSize: theme.typography.fontSizes.sm,\n    fontWeight: '600',\n    color: '#856404',\n    marginBottom: theme.spacing.xs,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n  warningTip: {\n    fontSize: theme.typography.fontSizes.sm,\n    color: '#856404',\n    lineHeight: 18,\n    fontFamily: theme.typography.fontFamilies.regular,\n    flex: 1,\n  },\n  warningTipItem: {\n    marginBottom: 2,\n    flexDirection: 'row',\n    alignItems: 'flex-start',\n  },\n  warningBullet: {\n    width: 4,\n    height: 4,\n    borderRadius: 2,\n    backgroundColor: '#856404',\n    marginTop: 7,\n    marginRight: theme.spacing.xs,\n  },\n\n  // Success Screen Styles\n  successContainer: {\n    flex: 1,\n    backgroundColor: theme.colors.card,\n    margin: theme.spacing.lg,\n    padding: theme.spacing.xl,\n    borderRadius: 12,\n    alignItems: 'center',\n    justifyContent: 'center',\n    ...theme.shadows.sm,\n  },\n  successIcon: {\n    marginBottom: theme.spacing.xl,\n  },\n  successTitle: {\n    fontSize: theme.typography.fontSizes.xxl,\n    fontWeight: 'bold',\n    color: theme.colors.success || '#34C759',\n    textAlign: 'center',\n    marginBottom: theme.spacing.xl,\n    fontFamily: theme.typography.fontFamilies.bold,\n  },\n  successDetails: {\n    width: '100%',\n    marginBottom: theme.spacing.xl,\n  },\n  successLabel: {\n    fontSize: theme.typography.fontSizes.sm,\n    color: theme.colors.textSecondary,\n    fontWeight: '600',\n    marginBottom: theme.spacing.xs,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n  successValue: {\n    fontSize: theme.typography.fontSizes.lg,\n    color: theme.colors.text,\n    fontWeight: 'bold',\n    marginBottom: theme.spacing.lg,\n    fontFamily: theme.typography.fontFamilies.bold,\n  },\n  successInstructions: {\n    width: '100%',\n    marginBottom: theme.spacing.xl,\n  },\n  successInstructionText: {\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.textSecondary,\n    textAlign: 'center',\n    lineHeight: 22,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  continueButton: {\n    backgroundColor: theme.colors.primary,\n    paddingHorizontal: theme.spacing.xl,\n    paddingVertical: theme.spacing.lg,\n    borderRadius: 8,\n    minWidth: 120,\n  },\n  continueButtonText: {\n    color: theme.colors.background,\n    fontSize: theme.typography.fontSizes.md,\n    fontWeight: '600',\n    textAlign: 'center',\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n\n  // OPAQUE-specific styles\n  opaqueIndicatorContainer: {\n    marginVertical: theme.spacing.md,\n    alignItems: 'center',\n  },\n  securityNotice: {\n    flexDirection: 'row',\n    backgroundColor: '#FFF9E6',\n    padding: theme.spacing.md,\n    borderRadius: 8,\n    marginTop: theme.spacing.md,\n    borderLeftWidth: 4,\n    borderLeftColor: '#FF9500',\n  },\n  securityNoticeIcon: {\n    marginRight: theme.spacing.sm,\n    marginTop: 2,\n  },\n  securityNoticeText: {\n    flex: 1,\n    fontSize: theme.typography.fontSizes.sm,\n    color: '#8B4513',\n    lineHeight: 20,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  securityNoticeTextBold: {\n    fontWeight: '600',\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n\n  // Authentication Method styles\n  authMethodContainer: {\n    marginBottom: theme.spacing.lg,\n    backgroundColor: theme.colors.surface,\n    padding: theme.spacing.md,\n    borderRadius: 8,\n  },\n  authMethodTitle: {\n    fontSize: theme.typography.fontSizes.md,\n    fontWeight: '600',\n    marginBottom: theme.spacing.md,\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n  authMethodOption: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n  },\n  authMethodInfo: {\n    flex: 1,\n    marginRight: theme.spacing.md,\n  },\n  authMethodLabel: {\n    fontSize: theme.typography.fontSizes.md,\n    fontWeight: '500',\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.medium,\n  },\n  authMethodDescription: {\n    fontSize: theme.typography.fontSizes.sm,\n    color: theme.colors.textSecondary,\n    marginTop: 2,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n\n  // Security Level styles\n  securityLevelContainer: {\n    marginTop: theme.spacing.md,\n  },\n  securityLevelTitle: {\n    fontSize: theme.typography.fontSizes.sm,\n    fontWeight: '600',\n    marginBottom: theme.spacing.sm,\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n  securityLevelDescription: {\n    fontSize: theme.typography.fontSizes.sm,\n    color: theme.colors.textSecondary,\n    marginBottom: theme.spacing.md,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  securityInfoBox: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    padding: theme.spacing.md,\n    borderRadius: 8,\n    borderWidth: 1,\n    borderColor: '#00C851',\n    backgroundColor: '#00C851' + '10',\n  },\n  securityInfoText: {\n    marginLeft: theme.spacing.sm,\n    fontSize: theme.typography.fontSizes.md,\n    color: '#00C851',\n    fontFamily: theme.typography.fontFamilies.semiBold,\n    fontWeight: '600',\n  },\n\n  // Form Input Styles\n  inputContainer: {\n    marginBottom: theme.spacing.lg,\n  },\n  label: {\n    fontSize: theme.typography.fontSizes.md,\n    fontWeight: '600',\n    marginBottom: theme.spacing.sm,\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n  input: {\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n    borderRadius: 8,\n    padding: theme.spacing.md,\n    fontSize: theme.typography.fontSizes.md,\n    backgroundColor: theme.colors.card,\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  inputValid: {\n    borderColor: '#34C759', // Green border for valid input\n  },\n  inputError: {\n    borderColor: theme.colors.error, // Red border for invalid input\n  },\n  validationContainer: {\n    marginTop: theme.spacing.xs,\n    paddingHorizontal: theme.spacing.xs,\n    paddingVertical: 4,\n    borderRadius: 4,\n    minHeight: 20,\n  },\n  validationSuccess: {\n    backgroundColor: '#E8F5E8', // Light green background\n  },\n  validationError: {\n    backgroundColor: '#FFF2F2', // Light red background\n  },\n  validationText: {\n    fontSize: theme.typography.fontSizes.sm,\n    fontFamily: theme.typography.fontFamilies.regular,\n    lineHeight: 16,\n  },\n  validationTextSuccess: {\n    color: '#22C55E', // Green text for success\n  },\n  validationTextError: {\n    color: theme.colors.error, // Red text for errors\n  },\n  colorGrid: {\n    flexDirection: 'row',\n    flexWrap: 'wrap',\n    justifyContent: 'space-between',\n  },\n  colorOption: {\n    width: 40,\n    height: 40,\n    borderRadius: 20,\n    marginBottom: theme.spacing.sm,\n    justifyContent: 'center',\n    alignItems: 'center',\n    borderWidth: 2,\n    borderColor: 'transparent',\n  },\n  selectedColorOption: {\n    borderColor: theme.colors.text,\n    borderWidth: 3,\n  },\n\n  buttonContainer: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    marginBottom: theme.spacing.lg,\n  },\n  button: {\n    flex: 1,\n    padding: theme.spacing.lg,\n    borderRadius: 8,\n    alignItems: 'center',\n    marginHorizontal: theme.spacing.sm,\n  },\n  createButton: {\n    backgroundColor: theme.colors.primary,\n  },\n  cancelButton: {\n    backgroundColor: 'transparent',\n    borderWidth: 1,\n    borderColor: theme.colors.textSecondary,\n  },\n  buttonText: {\n    color: theme.colors.background,\n    fontSize: theme.typography.fontSizes.md,\n    fontWeight: '600',\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n  cancelButtonText: {\n    color: theme.colors.textSecondary,\n    fontSize: theme.typography.fontSizes.md,\n    fontWeight: '600',\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n});\n\nexport default SecretTagSetup; ","/**\n * Regular Tag Create Component\n * \n * Simple modal for creating regular tags with name and color selection.\n * Works cross-platform (web, iOS, Android).\n */\n\nimport React, { useState, useCallback } from 'react';\nimport {\n  View,\n  Text,\n  TextInput,\n  TouchableOpacity,\n  StyleSheet,\n  Alert,\n  ActivityIndicator,\n  ScrollView,\n} from 'react-native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { useAppTheme } from '../contexts/ThemeContext';\nimport { AppTheme } from '../config/theme';\nimport { TagsAPI } from '../services/api';\nimport logger from '../utils/logger';\nimport { Tag } from '../types';\n\ninterface RegularTagCreateProps {\n  onTagCreated?: (tag: Tag) => void;\n  onCancel?: () => void;\n  existingTagNames?: string[];\n}\n\nconst RegularTagCreate: React.FC<RegularTagCreateProps> = ({\n  onTagCreated,\n  onCancel,\n  existingTagNames = [],\n}) => {\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n  \n  const [tagName, setTagName] = useState('');\n  const [selectedColor, setSelectedColor] = useState('#007AFF');\n  const [isLoading, setIsLoading] = useState(false);\n\n  // Predefined color options\n  const colorOptions = [\n    '#007AFF', // Blue\n    '#34C759', // Green\n    '#FF9500', // Orange\n    '#FF3B30', // Red\n    '#AF52DE', // Purple\n    '#FF2D92', // Pink\n    '#5AC8FA', // Light Blue\n    '#FFCC00', // Yellow\n    '#FF6B6B', // Light Red\n    '#4ECDC4', // Teal\n    '#45B7D1', // Sky Blue\n    '#96CEB4', // Mint Green\n  ];\n\n  /**\n   * Validate tag name\n   */\n  const validateTagName = useCallback((name: string): string | null => {\n    if (!name.trim()) {\n      return 'Tag name cannot be empty';\n    }\n    \n    if (name.length < 2) {\n      return 'Tag name must be at least 2 characters';\n    }\n    \n    if (name.length > 50) {\n      return 'Tag name must be less than 50 characters';\n    }\n    \n    if (existingTagNames.some(existing => existing.toLowerCase() === name.toLowerCase())) {\n      return 'A tag with this name already exists';\n    }\n    \n    return null;\n  }, [existingTagNames]);\n\n  /**\n   * Handle tag creation\n   */\n  const handleCreateTag = useCallback(async () => {\n    // Validate inputs\n    const nameError = validateTagName(tagName);\n    if (nameError) {\n      Alert.alert('Invalid Name', nameError);\n      return;\n    }\n\n    setIsLoading(true);\n\n    try {\n      // Create tag via API\n      const newTag = await TagsAPI.createTag({\n        name: tagName.trim(),\n        color: selectedColor\n      });\n\n      logger.info('Regular tag created:', newTag);\n      onTagCreated?.(newTag);\n      \n      // Clear form\n      setTagName('');\n      setSelectedColor('#007AFF');\n      \n    } catch (error) {\n      logger.error('Failed to create regular tag:', error);\n      Alert.alert(\n        'Creation Failed',\n        error instanceof Error ? error.message : 'Failed to create tag'\n      );\n    } finally {\n      setIsLoading(false);\n    }\n  }, [tagName, selectedColor, validateTagName, onTagCreated]);\n\n  const canCreate = tagName.trim() && !isLoading;\n\n  return (\n    <View style={styles.container}>\n      <ScrollView style={styles.content} keyboardShouldPersistTaps=\"handled\">\n        {/* Header */}\n        <View style={styles.header}>\n          <Text style={styles.title}>Create Regular Tag</Text>\n          <Text style={styles.subtitle}>\n            Regular tags help organize your journal entries\n          </Text>\n        </View>\n\n        {/* Tag Name Input */}\n        <View style={styles.inputContainer}>\n          <Text style={styles.label}>Tag Name</Text>\n          <TextInput\n            style={styles.input}\n            value={tagName}\n            onChangeText={setTagName}\n            placeholder=\"e.g., Work, Personal, Travel\"\n            placeholderTextColor={theme.colors.textSecondary}\n            maxLength={50}\n            autoCapitalize=\"words\"\n            autoCorrect={false}\n            autoFocus={true}\n          />\n        </View>\n\n        {/* Color Selection */}\n        <View style={styles.inputContainer}>\n          <Text style={styles.label}>Tag Color</Text>\n          <View style={styles.colorGrid}>\n            {colorOptions.map((color) => (\n              <TouchableOpacity\n                key={color}\n                style={[\n                  styles.colorOption,\n                  { backgroundColor: color },\n                  selectedColor === color && styles.selectedColorOption,\n                ]}\n                onPress={() => setSelectedColor(color)}\n              >\n                {selectedColor === color && (\n                  <Ionicons name=\"checkmark\" size={16} color=\"white\" />\n                )}\n              </TouchableOpacity>\n            ))}\n          </View>\n        </View>\n\n        {/* Preview */}\n        <View style={styles.previewContainer}>\n          <Text style={styles.label}>Preview</Text>\n          <View style={styles.tagPreview}>\n            <View style={[styles.tagColorIndicator, { backgroundColor: selectedColor }]} />\n            <Text style={styles.tagPreviewText}>{tagName || 'Your tag name'}</Text>\n          </View>\n        </View>\n      </ScrollView>\n\n      {/* Action Buttons */}\n      <View style={styles.buttonContainer}>\n        <TouchableOpacity \n          style={[styles.button, styles.cancelButton]}\n          onPress={onCancel}\n          disabled={isLoading}\n        >\n          <Text style={styles.cancelButtonText}>Cancel</Text>\n        </TouchableOpacity>\n\n        <TouchableOpacity \n          style={[\n            styles.button, \n            styles.createButton,\n            !canCreate && styles.disabledButton\n          ]}\n          onPress={handleCreateTag}\n          disabled={!canCreate}\n        >\n          {isLoading ? (\n            <ActivityIndicator color=\"white\" />\n          ) : (\n            <Text style={styles.createButtonText}>Create Tag</Text>\n          )}\n        </TouchableOpacity>\n      </View>\n    </View>\n  );\n};\n\nconst getStyles = (theme: AppTheme) => StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: theme.colors.background,\n  },\n  content: {\n    flex: 1,\n    padding: theme.spacing.lg,\n  },\n  header: {\n    marginBottom: theme.spacing.xl,\n    alignItems: 'center',\n  },\n  title: {\n    fontSize: theme.typography.fontSizes.xxl,\n    fontWeight: 'bold',\n    color: theme.colors.text,\n    textAlign: 'center',\n    marginBottom: theme.spacing.sm,\n    fontFamily: theme.typography.fontFamilies.bold,\n  },\n  subtitle: {\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.textSecondary,\n    textAlign: 'center',\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  inputContainer: {\n    marginBottom: theme.spacing.xl,\n  },\n  label: {\n    fontSize: theme.typography.fontSizes.md,\n    fontWeight: '600',\n    color: theme.colors.text,\n    marginBottom: theme.spacing.sm,\n    fontFamily: theme.typography.fontFamilies.medium,\n  },\n  input: {\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n    borderRadius: theme.borderRadius.md,\n    padding: theme.spacing.md,\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.text,\n    backgroundColor: theme.colors.inputBackground,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  colorGrid: {\n    flexDirection: 'row',\n    flexWrap: 'wrap',\n    gap: theme.spacing.md,\n  },\n  colorOption: {\n    width: 44,\n    height: 44,\n    borderRadius: 22,\n    justifyContent: 'center',\n    alignItems: 'center',\n    borderWidth: 2,\n    borderColor: 'transparent',\n  },\n  selectedColorOption: {\n    borderColor: theme.colors.text,\n    borderWidth: 3,\n  },\n  previewContainer: {\n    marginBottom: theme.spacing.xl,\n  },\n  tagPreview: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: theme.colors.card,\n    padding: theme.spacing.md,\n    borderRadius: theme.borderRadius.md,\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n  },\n  tagColorIndicator: {\n    width: 16,\n    height: 16,\n    borderRadius: 8,\n    marginRight: theme.spacing.md,\n  },\n  tagPreviewText: {\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  buttonContainer: {\n    flexDirection: 'row',\n    padding: theme.spacing.lg,\n    gap: theme.spacing.md,\n    borderTopWidth: 1,\n    borderTopColor: theme.colors.border,\n    backgroundColor: theme.colors.card,\n  },\n  button: {\n    flex: 1,\n    paddingVertical: theme.spacing.md,\n    paddingHorizontal: theme.spacing.lg,\n    borderRadius: theme.borderRadius.md,\n    alignItems: 'center',\n    justifyContent: 'center',\n    minHeight: 48,\n  },\n  cancelButton: {\n    backgroundColor: theme.colors.card,\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n  },\n  cancelButtonText: {\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.medium,\n  },\n  createButton: {\n    backgroundColor: theme.colors.primary,\n  },\n  createButtonText: {\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.onPrimary,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n  disabledButton: {\n    opacity: 0.5,\n  },\n});\n\nexport default RegularTagCreate; ","/**\n * Secret Tag Card Component\n * \n * Displays an individual secret tag with management actions like edit, delete, and activation status.\n */\n\nimport React, { useState } from 'react';\nimport {\n  View,\n  Text,\n  TouchableOpacity,\n  StyleSheet,\n  Alert,\n  ActivityIndicator,\n  Platform,\n} from 'react-native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { useAppTheme } from '../contexts/ThemeContext';\nimport { AppTheme } from '../config/theme';\nimport { SecretTagV2 } from '../services/secretTagOnlineManager';\nimport { areSecretTagsEnabled } from '../config/featureFlags';\nimport logger from '../utils/logger';\n\ninterface SecretTagCardProps {\n  tag: SecretTagV2;\n  isActive: boolean;\n  onActivate: (tagId: string) => Promise<void>;\n  onDeactivate: (tagId: string) => Promise<void>;\n  onEdit: (tag: SecretTagV2) => void;\n  onDelete: (tagId: string) => Promise<void>;\n}\n\nconst SecretTagCard: React.FC<SecretTagCardProps> = ({\n  tag,\n  isActive,\n  onActivate,\n  onDeactivate,\n  onEdit,\n  onDelete,\n}) => {\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n  \n  const [isLoading, setIsLoading] = useState(false);\n\n  /**\n   * Handle tag activation/deactivation\n   */\n  const handleToggleActivation = async () => {\n    setIsLoading(true);\n    try {\n      if (isActive) {\n        await onDeactivate(tag.id);\n      } else {\n        await onActivate(tag.id);\n      }\n    } catch (error) {\n      logger.error('Failed to toggle tag activation:', error);\n      Alert.alert(\n        'Error',\n        error instanceof Error ? error.message : 'Failed to toggle tag activation'\n      );\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  /**\n   * Handle tag deletion with confirmation\n   */\n  const handleDelete = () => {\n    console.log(`Delete button clicked for tag: ${tag.name}, isActive: ${isActive}`);\n    \n    // Check if tag is active before allowing deletion\n    if (!isActive) {\n      // Use browser-compatible alert for web\n      if (Platform.OS === 'web') {\n        window.alert('Secret tags can only be deleted when they are active. Please activate the tag first, then try deleting it.');\n      } else {\n        Alert.alert(\n          'Cannot Delete Tag',\n          'Secret tags can only be deleted when they are active. Please activate the tag first, then try deleting it.',\n          [{ text: 'OK', style: 'default' }]\n        );\n      }\n      return;\n    }\n\n    // Use browser-compatible confirm for web\n    if (Platform.OS === 'web') {\n      const confirmed = window.confirm(\n        `Are you sure you want to delete \"${tag.name}\"? This action cannot be undone.\\n\\nNote: Only active tags can be deleted for security reasons.`\n      );\n      \n      if (confirmed) {\n        handleDeleteConfirmed();\n      }\n    } else {\n      Alert.alert(\n        'Delete Secret Tag',\n        `Are you sure you want to delete \"${tag.name}\"? This action cannot be undone.\\n\\nNote: Only active tags can be deleted for security reasons.`,\n        [\n          { text: 'Cancel', style: 'cancel' },\n          {\n            text: 'Delete',\n            style: 'destructive',\n            onPress: handleDeleteConfirmed,\n          },\n        ]\n      );\n    }\n  };\n\n  /**\n   * Handle the actual deletion after confirmation\n   */\n  const handleDeleteConfirmed = async () => {\n    try {\n      console.log(`Proceeding with deletion of tag: ${tag.name}`);\n      await onDelete(tag.id);\n      \n      // Show success message\n      if (Platform.OS === 'web') {\n        window.alert('The secret tag has been permanently deleted.');\n      } else {\n        Alert.alert('Tag Deleted', 'The secret tag has been permanently deleted.');\n      }\n    } catch (error) {\n      logger.error('Failed to delete tag:', error);\n      const errorMessage = error instanceof Error ? error.message : 'Failed to delete tag';\n      \n      if (Platform.OS === 'web') {\n        window.alert(`Error: ${errorMessage}`);\n      } else {\n        Alert.alert('Error', errorMessage);\n      }\n    }\n  };\n\n  /**\n   * Format creation date\n   */\n  const formatDate = (dateString: string): string => {\n    const date = new Date(dateString);\n    return date.toLocaleDateString('en-US', {\n      year: 'numeric',\n      month: 'short',\n      day: 'numeric',\n    });\n  };\n\n  if (!areSecretTagsEnabled()) {\n    return null;\n  }\n\n  return (\n    <View style={[styles.container, isActive && styles.activeContainer]}>\n      {/* Tag Header */}\n      <View style={styles.header}>\n        <View style={styles.tagInfo}>\n          <View style={[styles.colorIndicator, { backgroundColor: tag.colorCode }]} />\n          <View style={styles.tagDetails}>\n            <Text style={styles.tagName}>{tag.name}</Text>\n            <Text style={styles.tagDate}>Created {formatDate(tag.createdAt)}</Text>\n          </View>\n        </View>\n        \n        {/* Status Badge */}\n        <View style={[styles.statusBadge, isActive && styles.activeStatusBadge]}>\n          <Text style={[styles.statusText, isActive && styles.activeStatusText]}>\n            {isActive ? 'Active' : 'Inactive'}\n          </Text>\n        </View>\n      </View>\n\n      {/* Tag Actions */}\n      <View style={styles.actions}>\n        {/* Activation Toggle */}\n        <TouchableOpacity\n          style={[styles.actionButton, styles.toggleButton, isActive && styles.activeToggleButton]}\n          onPress={handleToggleActivation}\n          disabled={isLoading}\n        >\n          {isLoading ? (\n            <ActivityIndicator size=\"small\" color={isActive ? theme.colors.background : theme.colors.primary} />\n          ) : (\n            <>\n              <Ionicons\n                name={isActive ? 'eye-off' : 'eye'}\n                size={16}\n                color={isActive ? theme.colors.background : theme.colors.primary}\n              />\n              <Text style={[styles.actionButtonText, isActive && styles.activeActionButtonText]}>\n                {isActive ? 'Deactivate' : 'Activate'}\n              </Text>\n            </>\n          )}\n        </TouchableOpacity>\n\n        {/* Edit Button */}\n        <TouchableOpacity\n          style={[styles.actionButton, styles.editButton]}\n          onPress={() => onEdit(tag)}\n          disabled={isLoading}\n        >\n          <Ionicons name=\"pencil\" size={16} color={theme.colors.textSecondary} />\n          <Text style={styles.secondaryActionButtonText}>Edit</Text>\n        </TouchableOpacity>\n\n        {/* Delete Button */}\n        <TouchableOpacity\n          style={[\n            styles.actionButton, \n            styles.deleteButton,\n            !isActive && styles.disabledButton\n          ]}\n          onPress={handleDelete}\n          disabled={isLoading || !isActive}\n        >\n          <Ionicons \n            name=\"trash\" \n            size={16} \n            color={!isActive ? theme.colors.textSecondary : theme.colors.error} \n          />\n          <Text style={[\n            styles.secondaryActionButtonText, \n            { color: !isActive ? theme.colors.textSecondary : theme.colors.error }\n          ]}>\n            Delete\n          </Text>\n        </TouchableOpacity>\n      </View>\n\n      {/* Active Tag Info */}\n      {isActive && (\n        <View style={styles.activeInfo}>\n          <Ionicons name=\"information-circle\" size={16} color={theme.colors.primary} />\n          <Text style={styles.activeInfoText}>\n            This tag is currently active. New entries will be encrypted with this tag. You can delete this tag while it's active.\n          </Text>\n        </View>\n      )}\n\n      {/* Inactive Tag Info */}\n      {!isActive && (\n        <View style={styles.inactiveInfo}>\n          <Ionicons name=\"information-circle-outline\" size={16} color={theme.colors.textSecondary} />\n          <Text style={styles.inactiveInfoText}>\n            Activate this tag to enable deletion and encryption features.\n          </Text>\n        </View>\n      )}\n    </View>\n  );\n};\n\nconst getStyles = (theme: AppTheme) => StyleSheet.create({\n  container: {\n    backgroundColor: theme.colors.card,\n    borderRadius: 12,\n    padding: theme.spacing.lg,\n    marginBottom: theme.spacing.md,\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n    ...theme.shadows.sm,\n  },\n  activeContainer: {\n    borderColor: theme.colors.primary,\n    borderWidth: 2,\n  },\n  header: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    marginBottom: theme.spacing.md,\n  },\n  tagInfo: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    flex: 1,\n  },\n  colorIndicator: {\n    width: 12,\n    height: 12,\n    borderRadius: 6,\n    marginRight: theme.spacing.sm,\n  },\n  tagDetails: {\n    flex: 1,\n  },\n  tagName: {\n    fontSize: theme.typography.fontSizes.lg,\n    fontWeight: '600',\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n    marginBottom: 2,\n  },\n  tagDate: {\n    fontSize: theme.typography.fontSizes.sm,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  statusBadge: {\n    paddingHorizontal: theme.spacing.sm,\n    paddingVertical: 4,\n    borderRadius: 12,\n    backgroundColor: theme.colors.card,\n  },\n  activeStatusBadge: {\n    backgroundColor: theme.colors.primary,\n  },\n  statusText: {\n    fontSize: theme.typography.fontSizes.xs,\n    fontWeight: '600',\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n  activeStatusText: {\n    color: theme.colors.background,\n  },\n  actions: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    marginBottom: theme.spacing.sm,\n  },\n  actionButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    paddingHorizontal: theme.spacing.md,\n    paddingVertical: theme.spacing.sm,\n    borderRadius: 8,\n    flex: 1,\n    marginHorizontal: 2,\n    justifyContent: 'center',\n  },\n  toggleButton: {\n    backgroundColor: 'transparent',\n    borderWidth: 1,\n    borderColor: theme.colors.primary,\n  },\n  activeToggleButton: {\n    backgroundColor: theme.colors.primary,\n  },\n  editButton: {\n    backgroundColor: 'transparent',\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n  },\n  deleteButton: {\n    backgroundColor: 'transparent',\n    borderWidth: 1,\n    borderColor: theme.colors.error,\n  },\n  actionButtonText: {\n    fontSize: theme.typography.fontSizes.sm,\n    fontWeight: '600',\n    color: theme.colors.primary,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n    marginLeft: 4,\n  },\n  activeActionButtonText: {\n    color: theme.colors.background,\n  },\n  secondaryActionButtonText: {\n    fontSize: theme.typography.fontSizes.sm,\n    fontWeight: '600',\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n    marginLeft: 4,\n  },\n  activeInfo: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: theme.colors.primaryLight || theme.colors.primary + '20',\n    padding: theme.spacing.sm,\n    borderRadius: 8,\n    marginTop: theme.spacing.sm,\n  },\n  activeInfoText: {\n    fontSize: theme.typography.fontSizes.sm,\n    color: theme.colors.primary,\n    fontFamily: theme.typography.fontFamilies.regular,\n    marginLeft: theme.spacing.xs,\n    flex: 1,\n  },\n  inactiveInfo: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: theme.colors.card,\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n    padding: theme.spacing.sm,\n    borderRadius: 8,\n    marginTop: theme.spacing.sm,\n  },\n  inactiveInfoText: {\n    fontSize: theme.typography.fontSizes.sm,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.regular,\n    marginLeft: theme.spacing.xs,\n    flex: 1,\n  },\n  disabledButton: {\n    opacity: 0.5,\n    borderColor: theme.colors.border,\n  },\n});\n\nexport default SecretTagCard; ","/**\n * Tag Management Screen\n * \n * Provides an interface for managing both regular tags and secret tags.\n * Integrates with the OPAQUE-based secret tag system.\n */\n\nimport React, { useState, useEffect, useCallback } from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  TouchableOpacity,\n  FlatList,\n  Alert,\n  ActivityIndicator,\n  RefreshControl,\n} from 'react-native';\nimport { useNavigation } from '@react-navigation/native';\nimport { StackNavigationProp } from '@react-navigation/stack';\nimport { Ionicons } from '@expo/vector-icons';\n\nimport { MainStackParamList } from '../../navigation/types';\nimport { useAppTheme } from '../../contexts/ThemeContext';\nimport { AppTheme } from '../../config/theme';\nimport { tagManager } from '../../services/tagManager';\nimport { api } from '../../services/api';\nimport SecretTagSetup from '../../components/SecretTagSetup';\nimport RegularTagCreate from '../../components/RegularTagCreate';\nimport SecretTagCard from '../../components/SecretTagCard';\nimport ScreenHeader from '../../components/ScreenHeader';\nimport { Tag } from '../../types';\nimport { OpaqueSecretTag } from '../../types/opaqueTypes';\nimport logger from '../../utils/logger';\nimport { areSecretTagsEnabled } from '../../config/featureFlags';\n\ntype TagManagementNavigationProp = StackNavigationProp<MainStackParamList, 'TagManagement'>;\n\ninterface TagManagementScreenProps {}\n\nconst TagManagementScreen: React.FC<TagManagementScreenProps> = () => {\n  // If secret tags are disabled globally, render nothing\n  if (!areSecretTagsEnabled()) {\n    return null;\n  }\n  const navigation = useNavigation<TagManagementNavigationProp>();\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n\n  // State\n  const [regularTags, setRegularTags] = useState<Tag[]>([]);\n  const [secretTags, setSecretTags] = useState<OpaqueSecretTag[]>([]);\n  const [activeSecretTags, setActiveSecretTags] = useState<Set<string>>(new Set());\n  const [isLoading, setIsLoading] = useState(true);\n  const [isRefreshing, setIsRefreshing] = useState(false);\n  const [showSecretTagSetup, setShowSecretTagSetup] = useState(false);\n  const [showRegularTagCreate, setShowRegularTagCreate] = useState(false);\n  const [selectedTab, setSelectedTab] = useState<'regular' | 'secret'>('regular');\n\n  /**\n   * Load secret tags from server\n   */\n  const loadSecretTags = useCallback(async () => {\n    try {\n      logger.info('Loading secret tags from server');\n      \n      // Use the proper API service with authentication headers\n      const response = await api.get('/api/v1/secret-tags');\n      \n      // Backend returns SecretTagListResponse with tags array\n      const tagsData = response.data?.tags || [];\n      setSecretTags(tagsData.map((tag: any) => ({\n        ...tag,\n        id: tag.tag_id, // Convert tag_id to id for consistency\n        auth_method: 'opaque' as const,\n        security_level: 'standard' as const,\n        authentication_count: 0\n      })));\n      logger.info(`Loaded ${tagsData.length} secret tags`);\n    } catch (error) {\n      logger.error('Error loading secret tags:', error);\n      setSecretTags([]);\n    }\n  }, []);\n\n  /**\n   * Load all tags (regular and secret)\n   */\n  const loadTags = useCallback(async () => {\n    setIsLoading(true);\n    try {\n      // Load regular tags\n      const tags = await tagManager.getAllTags();\n      setRegularTags(tags);\n      \n      // Load secret tags\n      await loadSecretTags();\n      \n    } catch (error) {\n      logger.error('Failed to load tags:', error);\n      Alert.alert('Error', 'Failed to load tags');\n    } finally {\n      setIsLoading(false);\n    }\n  }, [loadSecretTags]);\n\n  /**\n   * Refresh tags\n   */\n  const handleRefresh = useCallback(async () => {\n    setIsRefreshing(true);\n    await loadTags();\n    setIsRefreshing(false);\n  }, [loadTags]);\n\n  /**\n   * Handle regular tag creation\n   */\n  const handleRegularTagCreate = useCallback(() => {\n    setShowRegularTagCreate(true);\n  }, []);\n\n  /**\n   * Handle regular tag created callback\n   */\n  const handleRegularTagCreated = useCallback((newTag: Tag) => {\n    setRegularTags(prev => [...prev, newTag]);\n    setShowRegularTagCreate(false);\n    logger.info('Regular tag created:', newTag);\n  }, []);\n\n  /**\n   * Handle regular tag create cancelled\n   */\n  const handleRegularTagCreateCancelled = useCallback(() => {\n    setShowRegularTagCreate(false);\n  }, []);\n\n  /**\n   * Handle secret tag activation\n   */\n  const handleSecretTagActivate = useCallback(async (tagId: string) => {\n    try {\n      // Use the speech API for activation (this is client-side managed)\n      const response = await fetch('/api/speech/secret-tag/activate', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        credentials: 'include',\n        body: JSON.stringify({\n          tag_id: tagId,\n          action: 'activate'\n        })\n      });\n\n      if (response.ok) {\n        setActiveSecretTags(prev => new Set([...prev, tagId]));\n        logger.info('Secret tag activated:', tagId);\n      } else {\n        throw new Error('Failed to activate secret tag');\n      }\n    } catch (error) {\n      logger.error('Failed to activate secret tag:', error);\n      throw error;\n    }\n  }, []);\n\n  /**\n   * Handle secret tag deactivation\n   */\n  const handleSecretTagDeactivate = useCallback(async (tagId: string) => {\n    try {\n      // Use the speech API for deactivation (this is client-side managed)\n      const response = await fetch('/api/speech/secret-tag/activate', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        credentials: 'include',\n        body: JSON.stringify({\n          tag_id: tagId,\n          action: 'deactivate'\n        })\n      });\n\n      if (response.ok) {\n        setActiveSecretTags(prev => {\n          const newSet = new Set(prev);\n          newSet.delete(tagId);\n          return newSet;\n        });\n        logger.info('Secret tag deactivated:', tagId);\n      } else {\n        throw new Error('Failed to deactivate secret tag');\n      }\n    } catch (error) {\n      logger.error('Failed to deactivate secret tag:', error);\n      throw error;\n    }\n  }, []);\n\n  /**\n   * Handle secret tag editing\n   */\n  const handleSecretTagEdit = useCallback((tag: OpaqueSecretTag) => {\n    // For now, show an alert. In a full implementation, this would open an edit modal\n    Alert.alert('Edit Tag', `Editing \"${tag.tag_name}\" is not yet implemented.`);\n  }, []);\n\n  /**\n   * Handle secret tag deletion\n   */\n  const handleSecretTagDelete = useCallback(async (tagId: string) => {\n    try {\n      // Use the V1 secret tags API endpoint for deletion\n      const response = await api.delete(`/api/v1/secret-tags/${tagId}`);\n\n              if (response.status >= 200 && response.status < 300) {\n        setSecretTags(prev => prev.filter(tag => tag.id !== tagId));\n        setActiveSecretTags(prev => {\n          const newSet = new Set(prev);\n          newSet.delete(tagId);\n          return newSet;\n        });\n        logger.info('Secret tag deleted:', tagId);\n      } else {\n        throw new Error('Failed to delete secret tag');\n      }\n    } catch (error) {\n      logger.error('Failed to delete secret tag:', error);\n      throw error;\n    }\n  }, []);\n\n  /**\n   * Handle secret tag creation\n   */\n  const handleSecretTagCreated = useCallback((tagId: string) => {\n    setShowSecretTagSetup(false);\n    loadTags(); // Refresh the tags list\n  }, [loadTags]);\n\n  /**\n   * Handle FAB press\n   */\n  const handleFABPress = useCallback(() => {\n    if (selectedTab === 'regular') {\n      handleRegularTagCreate();\n    } else {\n      setShowSecretTagSetup(true);\n    }\n  }, [selectedTab, handleRegularTagCreate]);\n\n  // Load tags on mount\n  useEffect(() => {\n    loadTags();\n  }, [loadTags]);\n\n  /**\n   * Render regular tag item\n   */\n  const renderRegularTag = useCallback(({ item }: { item: Tag }) => (\n    <View style={styles.regularTagCard}>\n      <View style={styles.tagInfo}>\n        <View style={[styles.tagColorIndicator, { backgroundColor: item.color }]} />\n        <Text style={styles.tagName}>{item.name}</Text>\n      </View>\n      <TouchableOpacity\n        style={styles.tagDeleteButton}\n        onPress={() => {\n          Alert.alert(\n            'Delete Tag',\n            `Are you sure you want to delete \"${item.name}\"?`,\n            [\n              { text: 'Cancel', style: 'cancel' },\n              {\n                text: 'Delete',\n                style: 'destructive',\n                onPress: async () => {\n                  try {\n                    await tagManager.deleteTag(String(item.id));\n                    setRegularTags(prev => prev.filter(tag => tag.id !== item.id));\n                  } catch (error) {\n                    Alert.alert('Error', 'Failed to delete tag');\n                  }\n                },\n              },\n            ]\n          );\n        }}\n      >\n        <Ionicons name=\"trash\" size={18} color={theme.colors.error} />\n      </TouchableOpacity>\n    </View>\n  ), [styles, theme.colors.error]);\n\n  /**\n   * Render secret tag item\n   */\n  const renderSecretTag = useCallback(({ item }: { item: OpaqueSecretTag }) => (\n    <SecretTagCard\n      tag={item}\n      isActive={activeSecretTags.has(item.id)}\n      onActivate={handleSecretTagActivate}\n      onDeactivate={handleSecretTagDeactivate}\n      onEdit={handleSecretTagEdit}\n      onDelete={handleSecretTagDelete}\n    />\n  ), [activeSecretTags, handleSecretTagActivate, handleSecretTagDeactivate, handleSecretTagEdit, handleSecretTagDelete]);\n\n  // If showing regular tag creation modal\n  if (showRegularTagCreate) {\n    return (\n      <View style={styles.container}>\n        <ScreenHeader title=\"Create Regular Tag\" />\n        <RegularTagCreate\n          onTagCreated={handleRegularTagCreated}\n          onCancel={handleRegularTagCreateCancelled}\n          existingTagNames={regularTags.map(tag => tag.name)}\n        />\n      </View>\n    );\n  }\n\n  // If showing secret tag setup modal\n  if (showSecretTagSetup) {\n    return (\n      <View style={styles.container}>\n        <ScreenHeader title=\"Create Secret Tag\" />\n        <SecretTagSetup\n          onTagCreated={handleSecretTagCreated}\n          onCancel={() => setShowSecretTagSetup(false)}\n          existingTagNames={secretTags.map(tag => tag.tag_name)}\n          enableOpaqueAuth={true}\n        />\n      </View>\n    );\n  }\n\n  return (\n    <View style={styles.container}>\n      <ScreenHeader title=\"Tag Management\" />\n      \n      {/* Tab Selector */}\n      <View style={styles.tabContainer}>\n        <TouchableOpacity\n          style={[styles.tab, selectedTab === 'regular' && styles.activeTab]}\n          onPress={() => setSelectedTab('regular')}\n        >\n          <Ionicons \n            name=\"pricetag\" \n            size={20} \n            color={selectedTab === 'regular' ? theme.colors.primary : theme.colors.textSecondary} \n          />\n          <Text style={[styles.tabText, selectedTab === 'regular' && styles.activeTabText]}>\n            Regular Tags\n          </Text>\n        </TouchableOpacity>\n        \n        <TouchableOpacity\n          style={[styles.tab, selectedTab === 'secret' && styles.activeTab]}\n          onPress={() => setSelectedTab('secret')}\n        >\n          <Ionicons \n            name=\"shield\" \n            size={20} \n            color={selectedTab === 'secret' ? theme.colors.primary : theme.colors.textSecondary} \n          />\n          <Text style={[styles.tabText, selectedTab === 'secret' && styles.activeTabText]}>\n            Secret Tags\n          </Text>\n        </TouchableOpacity>\n      </View>\n\n      {/* Content */}\n      <View style={styles.content}>\n        {isLoading ? (\n          <View style={styles.loadingContainer}>\n            <ActivityIndicator size=\"large\" color={theme.colors.primary} />\n            <Text style={styles.loadingText}>Loading tags...</Text>\n          </View>\n        ) : (\n          <>\n            {selectedTab === 'regular' ? (\n              <FlatList\n                data={regularTags}\n                renderItem={renderRegularTag}\n                keyExtractor={(item) => String(item.id)}\n                refreshControl={\n                  <RefreshControl\n                    refreshing={isRefreshing}\n                    onRefresh={handleRefresh}\n                    colors={[theme.colors.primary]}\n                  />\n                }\n                ListEmptyComponent={\n                  <View style={styles.emptyContainer}>\n                    <Ionicons name=\"pricetag-outline\" size={64} color={theme.colors.textSecondary} />\n                    <Text style={styles.emptyText}>No regular tags yet</Text>\n                    <Text style={styles.emptySubtext}>\n                      Tap the + button to create your first tag\n                    </Text>\n                  </View>\n                }\n              />\n            ) : (\n              <FlatList\n                data={secretTags}\n                renderItem={renderSecretTag}\n                keyExtractor={(item) => item.id}\n                refreshControl={\n                  <RefreshControl\n                    refreshing={isRefreshing}\n                    onRefresh={handleRefresh}\n                    colors={[theme.colors.primary]}\n                  />\n                }\n                ListEmptyComponent={\n                  <View style={styles.emptyContainer}>\n                    <Ionicons name=\"shield-outline\" size={64} color={theme.colors.textSecondary} />\n                    <Text style={styles.emptyText}>No secret tags yet</Text>\n                    <Text style={styles.emptySubtext}>\n                      Tap the + button to create your first secret tag\n                    </Text>\n                  </View>\n                }\n              />\n            )}\n          </>\n        )}\n      </View>\n\n      {/* Floating Action Button */}\n      <TouchableOpacity\n        style={styles.fab}\n        onPress={handleFABPress}\n      >\n        <Ionicons name=\"add\" size={24} color={theme.colors.onPrimary} />\n      </TouchableOpacity>\n\n      {/* Back Button */}\n      <TouchableOpacity\n        style={styles.backButton}\n        onPress={() => navigation.goBack()}\n      >\n        <Ionicons name=\"arrow-back\" size={24} color={theme.colors.text} />\n      </TouchableOpacity>\n    </View>\n  );\n};\n\nconst getStyles = (theme: AppTheme) => StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: theme.colors.background,\n  },\n  tabContainer: {\n    flexDirection: 'row',\n    backgroundColor: theme.colors.card,\n    borderBottomWidth: 1,\n    borderBottomColor: theme.colors.border,\n  },\n  tab: {\n    flex: 1,\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    paddingVertical: theme.spacing.md,\n    paddingHorizontal: theme.spacing.lg,\n  },\n  activeTab: {\n    borderBottomWidth: 2,\n    borderBottomColor: theme.colors.primary,\n  },\n  tabText: {\n    marginLeft: theme.spacing.sm,\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  activeTabText: {\n    color: theme.colors.primary,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n  content: {\n    flex: 1,\n    padding: theme.spacing.md,\n  },\n  loadingContainer: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  loadingText: {\n    marginTop: theme.spacing.md,\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  regularTagCard: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    backgroundColor: theme.colors.card,\n    padding: theme.spacing.md,\n    marginBottom: theme.spacing.sm,\n    borderRadius: theme.borderRadius.lg,\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n  },\n  tagInfo: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    flex: 1,\n  },\n  tagColorIndicator: {\n    width: 16,\n    height: 16,\n    borderRadius: 8,\n    marginRight: theme.spacing.md,\n  },\n  tagName: {\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  tagDeleteButton: {\n    padding: theme.spacing.sm,\n  },\n  emptyContainer: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n    paddingVertical: theme.spacing.xxl,\n  },\n  emptyText: {\n    fontSize: theme.typography.fontSizes.lg,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n    marginTop: theme.spacing.md,\n  },\n  emptySubtext: {\n    fontSize: theme.typography.fontSizes.sm,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.regular,\n    textAlign: 'center',\n    marginTop: theme.spacing.sm,\n    paddingHorizontal: theme.spacing.xl,\n  },\n  fab: {\n    position: 'absolute',\n    bottom: theme.spacing.xl,\n    right: theme.spacing.xl,\n    width: 56,\n    height: 56,\n    borderRadius: 28,\n    backgroundColor: theme.colors.primary,\n    justifyContent: 'center',\n    alignItems: 'center',\n    elevation: 8,\n    shadowColor: '#000',\n    shadowOffset: { width: 0, height: 2 },\n    shadowOpacity: 0.25,\n    shadowRadius: 4,\n  },\n  backButton: {\n    position: 'absolute',\n    top: theme.spacing.xl,\n    left: theme.spacing.md,\n    width: 40,\n    height: 40,\n    borderRadius: 20,\n    backgroundColor: theme.colors.card,\n    justifyContent: 'center',\n    alignItems: 'center',\n    elevation: 2,\n    shadowColor: '#000',\n    shadowOffset: { width: 0, height: 1 },\n    shadowOpacity: 0.2,\n    shadowRadius: 2,\n  },\n});\n\nexport default TagManagementScreen; ","/**\n * Session Storage Manager\n * \n * Handles persistence of session metadata (not sensitive data) across app restarts.\n * Ensures no session keys or other sensitive information is stored persistently.\n */\n\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { AppState, Platform } from 'react-native';\nimport logger from '../utils/logger';\nimport {\n  SessionPersistenceData,\n  SessionMetadata,\n  SessionStorageAdapter,\n  DeviceFingerprint,\n  SessionRecoveryOptions\n} from '../types/sessionTypes';\n\nconst STORAGE_KEYS = {\n  SESSION_METADATA: 'opaque_session_metadata',\n  DEVICE_FINGERPRINT: 'device_fingerprint',\n  LAST_APP_STATE: 'last_app_state'\n} as const;\n\n/**\n * AsyncStorage implementation of SessionStorageAdapter\n */\nclass AsyncStorageAdapter implements SessionStorageAdapter {\n  async store(key: string, data: SessionPersistenceData[]): Promise<void> {\n    try {\n      const serialized = JSON.stringify(data);\n      await AsyncStorage.setItem(key, serialized);\n    } catch (error) {\n      logger.error(`Failed to store session data for key ${key}:`, error);\n      throw error;\n    }\n  }\n\n  async retrieve(key: string): Promise<SessionPersistenceData[] | null> {\n    try {\n      const serialized = await AsyncStorage.getItem(key);\n      if (!serialized) {\n        return null;\n      }\n      return JSON.parse(serialized);\n    } catch (error) {\n      logger.error(`Failed to retrieve session data for key ${key}:`, error);\n      return null;\n    }\n  }\n\n  async remove(key: string): Promise<void> {\n    try {\n      await AsyncStorage.removeItem(key);\n    } catch (error) {\n      logger.error(`Failed to remove session data for key ${key}:`, error);\n      throw error;\n    }\n  }\n\n  async clear(): Promise<void> {\n    try {\n      const keys = Object.values(STORAGE_KEYS);\n      await AsyncStorage.multiRemove(keys);\n    } catch (error) {\n      logger.error('Failed to clear session storage:', error);\n      throw error;\n    }\n  }\n}\n\n/**\n * Session Storage Manager\n */\nexport class SessionStorageManager {\n  private static instance: SessionStorageManager;\n  private storageAdapter: SessionStorageAdapter;\n  private deviceFingerprint: DeviceFingerprint | null = null;\n  private isAppInBackground = false;\n  private lastBackgroundTime: Date | null = null;\n\n  private constructor() {\n    this.storageAdapter = new AsyncStorageAdapter();\n    this.setupAppStateHandling();\n  }\n\n  public static getInstance(): SessionStorageManager {\n    if (!SessionStorageManager.instance) {\n      SessionStorageManager.instance = new SessionStorageManager();\n    }\n    return SessionStorageManager.instance;\n  }\n\n  /**\n   * Initialize the storage manager and device fingerprinting\n   */\n  public async initialize(): Promise<void> {\n    try {\n      logger.info('Initializing SessionStorageManager');\n      \n      // Generate or retrieve device fingerprint\n      await this.initializeDeviceFingerprint();\n      \n      // Clean up expired session metadata\n      await this.cleanupExpiredSessions();\n      \n      logger.info('SessionStorageManager initialized successfully');\n    } catch (error) {\n      logger.error('Failed to initialize SessionStorageManager:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Store session metadata for persistence\n   */\n  public async storeSessionMetadata(sessions: SessionMetadata[]): Promise<void> {\n    try {\n      const persistenceData: SessionPersistenceData[] = sessions.map(session => ({\n        tagId: session.tagId,\n        tagName: session.tagName,\n        createdAt: session.createdAt.toISOString(),\n        expiresAt: session.expiresAt.toISOString(),\n        deviceFingerprint: session.deviceFingerprint,\n        isLocked: session.isLocked,\n        lastAccessed: session.lastAccessed.toISOString(),\n        accessCount: session.accessCount,\n        origin: session.origin\n      }));\n\n      await this.storageAdapter.store(STORAGE_KEYS.SESSION_METADATA, persistenceData);\n      logger.info(`Stored metadata for ${persistenceData.length} sessions`);\n    } catch (error) {\n      logger.error('Failed to store session metadata:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Retrieve session metadata for recovery\n   */\n  public async retrieveSessionMetadata(options: SessionRecoveryOptions = {\n    requireReauth: true,\n    maxAge: 24 * 60 * 60 * 1000, // 24 hours\n    allowPartialRecovery: true\n  }): Promise<SessionMetadata[]> {\n    try {\n      const persistenceData = await this.storageAdapter.retrieve(STORAGE_KEYS.SESSION_METADATA);\n      \n      if (!persistenceData || persistenceData.length === 0) {\n        logger.info('No session metadata found for recovery');\n        return [];\n      }\n\n      const now = new Date();\n      const maxAge = options.maxAge || 24 * 60 * 60 * 1000;\n      const cutoffTime = new Date(now.getTime() - maxAge);\n\n      const validSessions: SessionMetadata[] = [];\n\n      for (const data of persistenceData) {\n        try {\n          const createdAt = new Date(data.createdAt);\n          const expiresAt = new Date(data.expiresAt);\n          const lastAccessed = new Date(data.lastAccessed);\n\n          // Check if session is too old\n          if (createdAt < cutoffTime) {\n            logger.debug(`Session ${data.tagId} too old, skipping recovery`);\n            continue;\n          }\n\n          // Check if session has expired\n          if (expiresAt < now) {\n            logger.debug(`Session ${data.tagId} expired, skipping recovery`);\n            continue;\n          }\n\n          // Check device fingerprint match\n          if (this.deviceFingerprint && data.deviceFingerprint !== this.deviceFingerprint.hash) {\n            logger.warn(`Session ${data.tagId} device fingerprint mismatch, skipping recovery`);\n            continue;\n          }\n\n          const sessionMetadata: SessionMetadata = {\n            tagId: data.tagId,\n            tagName: data.tagName,\n            createdAt,\n            expiresAt,\n            deviceFingerprint: data.deviceFingerprint,\n            isLocked: data.isLocked,\n            lastAccessed,\n            accessCount: data.accessCount,\n            origin: data.origin\n          };\n\n          validSessions.push(sessionMetadata);\n        } catch (error) {\n          logger.warn(`Failed to parse session metadata for ${data.tagId}:`, error);\n          if (!options.allowPartialRecovery) {\n            throw error;\n          }\n        }\n      }\n\n      logger.info(`Retrieved ${validSessions.length} valid sessions for recovery`);\n      return validSessions;\n    } catch (error) {\n      logger.error('Failed to retrieve session metadata:', error);\n      if (options.allowPartialRecovery) {\n        return [];\n      }\n      throw error;\n    }\n  }\n\n  /**\n   * Remove specific session metadata\n   */\n  public async removeSessionMetadata(tagId: string): Promise<void> {\n    try {\n      const sessions = await this.retrieveSessionMetadata({ \n        requireReauth: true,\n        maxAge: 24 * 60 * 60 * 1000,\n        allowPartialRecovery: true \n      });\n      const filteredSessions = sessions.filter(session => session.tagId !== tagId);\n      await this.storeSessionMetadata(filteredSessions);\n      logger.info(`Removed session metadata for tag ${tagId}`);\n    } catch (error) {\n      logger.error(`Failed to remove session metadata for tag ${tagId}:`, error);\n      throw error;\n    }\n  }\n\n  /**\n   * Clear all session metadata\n   */\n  public async clearSessionMetadata(): Promise<void> {\n    try {\n      await this.storageAdapter.remove(STORAGE_KEYS.SESSION_METADATA);\n      logger.info('Cleared all session metadata');\n    } catch (error) {\n      logger.error('Failed to clear session metadata:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get current device fingerprint\n   */\n  public getDeviceFingerprint(): DeviceFingerprint | null {\n    return this.deviceFingerprint;\n  }\n\n  /**\n   * Check if app was recently backgrounded\n   */\n  public getBackgroundInfo(): { wasBackgrounded: boolean; duration: number | null } {\n    if (!this.lastBackgroundTime) {\n      return { wasBackgrounded: false, duration: null };\n    }\n\n    const now = new Date();\n    const duration = now.getTime() - this.lastBackgroundTime.getTime();\n    \n    return {\n      wasBackgrounded: true,\n      duration\n    };\n  }\n\n  /**\n   * Initialize device fingerprinting\n   */\n  private async initializeDeviceFingerprint(): Promise<void> {\n    try {\n      // Try to retrieve existing fingerprint\n      const stored = await AsyncStorage.getItem(STORAGE_KEYS.DEVICE_FINGERPRINT);\n      if (stored) {\n        this.deviceFingerprint = JSON.parse(stored);\n        logger.debug('Retrieved existing device fingerprint');\n        return;\n      }\n\n      // Generate new fingerprint\n      this.deviceFingerprint = await this.generateDeviceFingerprint();\n      \n      // Store for future use\n      await AsyncStorage.setItem(\n        STORAGE_KEYS.DEVICE_FINGERPRINT,\n        JSON.stringify(this.deviceFingerprint)\n      );\n      \n      logger.info('Generated new device fingerprint');\n    } catch (error) {\n      logger.error('Failed to initialize device fingerprint:', error);\n      // Continue without fingerprinting if it fails\n      this.deviceFingerprint = null;\n    }\n  }\n\n  /**\n   * Generate device fingerprint for session binding\n   */\n  private async generateDeviceFingerprint(): Promise<DeviceFingerprint> {\n    try {\n      const platform = Platform.OS;\n      const version = Platform.Version.toString();\n      \n      // Get screen dimensions (if available)\n      let screenDimensions = 'unknown';\n      if (typeof window !== 'undefined' && window.screen) {\n        screenDimensions = `${window.screen.width}x${window.screen.height}`;\n      }\n\n      // Get timezone\n      const timezone = Intl.DateTimeFormat().resolvedOptions().timeZone;\n      \n      // Get language\n      const language = Intl.DateTimeFormat().resolvedOptions().locale;\n      \n      // Get user agent (web only)\n      let userAgent: string | undefined;\n      if (Platform.OS === 'web' && typeof navigator !== 'undefined') {\n        userAgent = navigator.userAgent;\n      }\n\n      // Create fingerprint data\n      const fingerprintData = {\n        platform,\n        version,\n        screenDimensions,\n        timezone,\n        language,\n        userAgent\n      };\n\n      // Generate hash of fingerprint data\n      const hash = await this.hashFingerprint(fingerprintData);\n\n      return {\n        ...fingerprintData,\n        hash\n      };\n    } catch (error) {\n      logger.error('Failed to generate device fingerprint:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Hash fingerprint data for consistency\n   */\n  private async hashFingerprint(data: any): Promise<string> {\n    try {\n      const jsonString = JSON.stringify(data);\n      \n      // Simple hash implementation for React Native\n      let hash = 0;\n      for (let i = 0; i < jsonString.length; i++) {\n        const char = jsonString.charCodeAt(i);\n        hash = ((hash << 5) - hash) + char;\n        hash = hash & hash; // Convert to 32-bit integer\n      }\n      \n      return Math.abs(hash).toString(16);\n    } catch (error) {\n      logger.error('Failed to hash fingerprint:', error);\n      return 'unknown';\n    }\n  }\n\n  /**\n   * Setup app state handling for background detection\n   */\n  private setupAppStateHandling(): void {\n    AppState.addEventListener('change', (nextAppState) => {\n      if (nextAppState === 'background') {\n        this.isAppInBackground = true;\n        this.lastBackgroundTime = new Date();\n        logger.debug('App moved to background');\n      } else if (nextAppState === 'active' && this.isAppInBackground) {\n        this.isAppInBackground = false;\n        const backgroundDuration = this.lastBackgroundTime \n          ? new Date().getTime() - this.lastBackgroundTime.getTime()\n          : 0;\n        logger.debug(`App returned to foreground after ${backgroundDuration}ms`);\n      }\n    });\n  }\n\n  /**\n   * Clean up expired session metadata\n   */\n  private async cleanupExpiredSessions(): Promise<void> {\n    try {\n      const sessions = await this.retrieveSessionMetadata({ \n        requireReauth: true,\n        maxAge: 24 * 60 * 60 * 1000,\n        allowPartialRecovery: true \n      });\n      const now = new Date();\n      const validSessions = sessions.filter(session => session.expiresAt > now);\n      \n      if (validSessions.length < sessions.length) {\n        await this.storeSessionMetadata(validSessions);\n        logger.info(`Cleaned up ${sessions.length - validSessions.length} expired session metadata`);\n      }\n    } catch (error) {\n      logger.error('Failed to cleanup expired sessions:', error);\n      // Don't throw - this is cleanup, not critical\n    }\n  }\n\n  /**\n   * Clear all storage data\n   */\n  public async clearAll(): Promise<void> {\n    try {\n      await this.storageAdapter.clear();\n      this.deviceFingerprint = null;\n      this.lastBackgroundTime = null;\n      logger.info('Cleared all session storage data');\n    } catch (error) {\n      logger.error('Failed to clear session storage:', error);\n      throw error;\n    }\n  }\n}\n\n// Export singleton instance\nexport const sessionStorageManager = SessionStorageManager.getInstance(); ","/**\n * OPAQUE Tag Manager\n * \n * Service for managing OPAQUE-based secret tags with enhanced security\n * features while maintaining compatibility with existing tag systems.\n */\n\nimport { OpaqueClient } from './crypto/OpaqueClient';\n// SessionManager was archived; use SessionStorageManager for initialization\nimport { voicePhraseDetector } from './VoicePhraseDetector';\nimport { sessionStorageManager } from './SessionStorageManager';\nimport logger from '../utils/logger';\nimport {\n  OpaqueSecretTag,\n  OpaqueTagCreationRequest,\n  OpaqueTagCreationResponse,\n  OpaqueTagAuthRequest,\n  OpaqueTagAuthResponse,\n  OpaqueTagMigration,\n  OpaqueTagSettings,\n  OpaqueTagAnalyticsEvent\n} from '../types/opaqueTypes';\nimport { SecretTag } from '../types';\n\n/**\n * OPAQUE Tag Manager Service\n */\nexport class OpaqueTagManager {\n  private static instance: OpaqueTagManager;\n  private opaqueClient: OpaqueClient;\n  private isInitialized = false;\n  private analyticsEvents: OpaqueTagAnalyticsEvent[] = [];\n  \n  // Default settings\n  private defaultSettings: OpaqueTagSettings = {\n    enableDeviceBinding: true,\n    requirePhraseConfirmation: true,\n    sessionTimeout: 15, // minutes\n    maxSessionExtensions: 5,\n    enableAnalytics: true,\n    securityLevel: 'standard'\n  };\n\n  private constructor() {\n    this.opaqueClient = OpaqueClient.getInstance();\n  }\n\n  public static getInstance(): OpaqueTagManager {\n    if (!OpaqueTagManager.instance) {\n      OpaqueTagManager.instance = new OpaqueTagManager();\n    }\n    return OpaqueTagManager.instance;\n  }\n\n  /**\n   * Initialize the OPAQUE tag manager\n   */\n  public async initialize(): Promise<void> {\n    if (this.isInitialized) {\n      logger.debug('OpaqueTagManager already initialized');\n      return;\n    }\n\n    try {\n      logger.info('Initializing OpaqueTagManager');\n\n      // Initialize dependencies\n      await this.opaqueClient.initialize();\n      await sessionStorageManager.initialize();\n\n      // Load existing analytics events\n      await this.loadAnalyticsEvents();\n\n      this.isInitialized = true;\n      logger.info('OpaqueTagManager initialized successfully');\n    } catch (error) {\n      logger.error('Failed to initialize OpaqueTagManager:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Create a new OPAQUE-based secret tag\n   */\n  public async createOpaqueTag(request: OpaqueTagCreationRequest): Promise<OpaqueTagCreationResponse> {\n    try {\n      if (!this.isInitialized) {\n        await this.initialize();\n      }\n\n      logger.info(`Creating OPAQUE tag: ${request.tag_name}`);\n\n      // Get device fingerprint\n      const deviceFingerprint = sessionStorageManager.getDeviceFingerprint();\n      if (!deviceFingerprint) {\n        throw new Error('Device fingerprinting required for OPAQUE tags');\n      }\n\n      // Validate request\n      this.validateTagCreationRequest(request);\n\n      // Generate unique tag ID\n      const tagId = this.generateTagId();\n\n      // For now, we'll create a placeholder OPAQUE tag\n      // In a full implementation, this would integrate with the actual OPAQUE server\n      logger.info(`Generated OPAQUE tag ID: ${tagId}`);\n\n      // Create OPAQUE secret tag\n      const opaqueTag: OpaqueSecretTag = {\n        id: tagId,\n        tag_name: request.tag_name,\n        color_code: request.color_code,\n        created_at: new Date().toISOString(),\n        updated_at: new Date().toISOString(),\n        user_id: 1, // TODO: Get from auth context\n        \n        // OPAQUE-specific fields\n        opaque_server_public_key: 'placeholder_key', // TODO: Real server key\n        auth_method: 'opaque',\n        device_fingerprint: deviceFingerprint.hash,\n        \n        // Enhanced security fields\n        security_level: request.security_level,\n        last_authentication: new Date().toISOString(),\n        authentication_count: 0\n      };\n\n      // Store tag locally (encrypted)\n      await this.storeOpaqueTag(opaqueTag);\n\n      // Create session data placeholder\n      const sessionData = {\n        session_key: 'placeholder_session_key',\n        vault_key: 'placeholder_vault_key',\n        expires_at: new Date(Date.now() + 15 * 60 * 1000).toISOString() // 15 minutes\n      };\n\n      // Record analytics event\n      await this.recordAnalyticsEvent({\n        type: 'creation',\n        tagId,\n        timestamp: new Date(),\n        deviceFingerprint: deviceFingerprint.hash,\n        securityLevel: request.security_level,\n        metadata: {\n          tagName: request.tag_name,\n          authMethod: 'manual'\n        }\n      });\n\n      logger.info(`OPAQUE tag created successfully: ${tagId}`);\n\n      return {\n        success: true,\n        tag: opaqueTag,\n        session_data: sessionData\n      };\n    } catch (error) {\n      logger.error('Failed to create OPAQUE tag:', error);\n      \n      // Record error event\n      await this.recordAnalyticsEvent({\n        type: 'error',\n        tagId: request.tag_name, // Use tag name as fallback\n        timestamp: new Date(),\n        deviceFingerprint: request.device_fingerprint,\n        securityLevel: request.security_level,\n        metadata: {\n          error: error instanceof Error ? error.message : 'Unknown error',\n          operation: 'creation'\n        }\n      });\n\n      return {\n        success: false,\n        tag: {} as OpaqueSecretTag,\n        error: error instanceof Error ? error.message : 'Failed to create OPAQUE tag'\n      };\n    }\n  }\n\n  /**\n   * Authenticate with an OPAQUE tag\n   */\n  public async authenticateOpaqueTag(request: OpaqueTagAuthRequest): Promise<OpaqueTagAuthResponse> {\n    try {\n      logger.info(`Authenticating OPAQUE tag: ${request.tag_id}`);\n\n      // Get device fingerprint\n      const deviceFingerprint = sessionStorageManager.getDeviceFingerprint();\n      if (!deviceFingerprint) {\n        throw new Error('Device fingerprinting required for OPAQUE authentication');\n      }\n\n      // Verify device fingerprint matches\n      const tag = await this.getOpaqueTag(request.tag_id);\n      if (tag && tag.device_fingerprint !== deviceFingerprint.hash) {\n        throw new Error('Device fingerprint mismatch');\n      }\n\n      // For now, simulate authentication success\n      // In a full implementation, this would integrate with the actual OPAQUE server\n      logger.info(`Simulating OPAQUE authentication for tag: ${request.tag_id}`);\n\n      // Update tag authentication info\n      if (tag) {\n        tag.last_authentication = new Date().toISOString();\n        tag.authentication_count = (tag.authentication_count || 0) + 1;\n        await this.updateOpaqueTag(tag);\n      }\n\n      // Create session data\n      const sessionData = {\n        session_key: 'placeholder_session_key',\n        vault_key: 'placeholder_vault_key',\n        expires_at: new Date(Date.now() + 15 * 60 * 1000).toISOString() // 15 minutes\n      };\n\n      // Record analytics event\n      await this.recordAnalyticsEvent({\n        type: 'authentication',\n        tagId: request.tag_id,\n        timestamp: new Date(),\n        deviceFingerprint: deviceFingerprint.hash,\n        securityLevel: tag?.security_level || 'standard',\n        metadata: {\n          authenticationCount: tag?.authentication_count || 1\n        }\n      });\n\n      logger.info(`OPAQUE tag authenticated successfully: ${request.tag_id}`);\n\n      return {\n        success: true,\n        session_data: sessionData\n      };\n    } catch (error) {\n      logger.error('Failed to authenticate OPAQUE tag:', error);\n      \n      // Record error event\n      await this.recordAnalyticsEvent({\n        type: 'error',\n        tagId: request.tag_id,\n        timestamp: new Date(),\n        deviceFingerprint: request.device_fingerprint,\n        securityLevel: 'standard',\n        metadata: {\n          error: error instanceof Error ? error.message : 'Unknown error',\n          operation: 'authentication'\n        }\n      });\n\n      return {\n        success: false,\n        error: error instanceof Error ? error.message : 'Authentication failed'\n      };\n    }\n  }\n\n  /**\n   * Migrate legacy tag to OPAQUE\n   */\n  public async migrateToOpaque(\n    legacyTag: SecretTag,\n    newActivationPhrase: string\n  ): Promise<OpaqueTagCreationResponse> {\n    try {\n      logger.info(`Migrating legacy tag to OPAQUE: ${legacyTag.id}`);\n\n      // Get device fingerprint\n      const deviceFingerprint = sessionStorageManager.getDeviceFingerprint();\n      if (!deviceFingerprint) {\n        throw new Error('Device fingerprinting required for OPAQUE migration');\n      }\n\n      // Create OPAQUE tag with legacy tag info\n      const migrationRequest: OpaqueTagCreationRequest = {\n        tag_name: legacyTag.tag_name,\n        activation_phrase: newActivationPhrase,\n        color_code: legacyTag.color_code,\n        device_fingerprint: deviceFingerprint.hash,\n        security_level: 'standard'\n      };\n\n      // Create the OPAQUE tag\n      const result = await this.createOpaqueTag(migrationRequest);\n\n      if (result.success) {\n        logger.info(`Legacy tag migrated successfully: ${legacyTag.id} -> ${result.tag.id}`);\n        \n        // Record migration event\n        await this.recordAnalyticsEvent({\n          type: 'migration',\n          tagId: result.tag.id,\n          timestamp: new Date(),\n          deviceFingerprint: deviceFingerprint.hash,\n          securityLevel: 'standard',\n          metadata: {\n            legacyTagId: legacyTag.id,\n            migrationDate: new Date().toISOString()\n          }\n        });\n      }\n\n      return result;\n    } catch (error) {\n      logger.error('Failed to migrate legacy tag to OPAQUE:', error);\n      return {\n        success: false,\n        tag: {} as OpaqueSecretTag,\n        error: error instanceof Error ? error.message : 'Migration failed'\n      };\n    }\n  }\n\n  /**\n   * Get migration information for a legacy tag\n   */\n  public getMigrationInfo(legacyTag: SecretTag): OpaqueTagMigration {\n    const securityBenefits = [\n      'Zero-knowledge authentication',\n      'Device binding protection',\n      'Enhanced session management',\n      'Advanced security analytics',\n      'Protection against server breaches'\n    ];\n\n    const risks = [\n      'New activation phrase required',\n      'Cannot recover if phrase is forgotten',\n      'Requires device re-authentication'\n    ];\n\n    return {\n      canMigrate: true,\n      legacyTag,\n      estimatedTime: 30, // seconds\n      securityBenefits,\n      risks,\n      requiresReAuth: true\n    };\n  }\n\n  /**\n   * Get all OPAQUE tags for current user\n   */\n  public async getOpaqueTags(): Promise<OpaqueSecretTag[]> {\n    try {\n      // TODO: Implement storage retrieval\n      logger.debug('Retrieving OPAQUE tags');\n      return [];\n    } catch (error) {\n      logger.error('Failed to retrieve OPAQUE tags:', error);\n      return [];\n    }\n  }\n\n  /**\n   * Get all OPAQUE tags for current user (alias for getOpaqueTags)\n   */\n  public async getAllTags(): Promise<OpaqueSecretTag[]> {\n    return this.getOpaqueTags();\n  }\n\n  /**\n   * Get currently active OPAQUE tags\n   */\n  public async getActiveTags(): Promise<OpaqueSecretTag[]> {\n    try {\n      logger.debug('Retrieving active OPAQUE tags');\n      \n      // Get active sessions from voice phrase detector\n      const activeSessions = voicePhraseDetector.getActiveSessions();\n      \n      // Convert sessions to OpaqueSecretTag format\n      const activeTags: OpaqueSecretTag[] = activeSessions.map(session => ({\n        id: session.tagId,\n        tag_name: session.tagName,\n        color_code: '#FF3B30', // Default color for secret tags\n        created_at: session.createdAt.toISOString(),\n        updated_at: session.lastAccessed.toISOString(),\n        user_id: 1, // TODO: Get from auth context\n        \n        // OPAQUE-specific fields\n        opaque_server_public_key: '', // TODO: Retrieve from storage\n        auth_method: 'opaque',\n        device_fingerprint: sessionStorageManager.getDeviceFingerprint()?.hash || '',\n        \n        // Enhanced security fields\n        security_level: 'standard',\n        last_authentication: session.lastAccessed.toISOString(),\n        authentication_count: 0\n      }));\n      \n      logger.debug(`Found ${activeTags.length} active OPAQUE tags`);\n      return activeTags;\n    } catch (error) {\n      logger.error('Failed to retrieve active OPAQUE tags:', error);\n      return [];\n    }\n  }\n\n  /**\n   * Activate an OPAQUE tag (create a session)\n   */\n  public async activateTag(tagId: string): Promise<void> {\n    try {\n      logger.info(`Activating OPAQUE tag: ${tagId}`);\n      \n      // For now, we'll need the user to provide the activation phrase\n      // In a full implementation, this would require authentication\n      throw new Error('Tag activation requires authentication with activation phrase');\n    } catch (error) {\n      logger.error(`Failed to activate OPAQUE tag ${tagId}:`, error);\n      throw error;\n    }\n  }\n\n  /**\n   * Deactivate an OPAQUE tag (end the session)\n   */\n  public async deactivateTag(tagId: string): Promise<void> {\n    try {\n      logger.info(`Deactivating OPAQUE tag: ${tagId}`);\n      \n      // Check if session is active and let VoicePhraseDetector handle cleanup\n      if (voicePhraseDetector.isSessionActive(tagId)) {\n        // We can't directly call deactivateSession as it's private\n        // For now, we'll use the cleanup method which deactivates all sessions\n        // In a full implementation, there would be a public method to deactivate specific sessions\n        logger.info(`OPAQUE tag ${tagId} is active, cleanup will be handled by session timeout`);\n      }\n      \n      logger.info(`OPAQUE tag deactivated successfully: ${tagId}`);\n    } catch (error) {\n      logger.error(`Failed to deactivate OPAQUE tag ${tagId}:`, error);\n      throw error;\n    }\n  }\n\n  /**\n   * Delete an OPAQUE tag (alias for deleteOpaqueTag)\n   */\n  public async deleteTag(tagId: string): Promise<void> {\n    const result = await this.deleteOpaqueTag(tagId);\n    if (!result) {\n      throw new Error(`Failed to delete OPAQUE tag: ${tagId}`);\n    }\n  }\n\n  /**\n   * Delete an OPAQUE tag\n   */\n  public async deleteOpaqueTag(tagId: string): Promise<boolean> {\n    try {\n      logger.info(`Deleting OPAQUE tag: ${tagId}`);\n\n      // Check if there's an active session and note it\n      if (voicePhraseDetector.isSessionActive(tagId)) {\n        logger.info(`OPAQUE tag ${tagId} has active session, it will be cleaned up`);\n      }\n\n      // Remove from local storage\n      await this.removeOpaqueTag(tagId);\n\n      logger.info(`OPAQUE tag deleted successfully: ${tagId}`);\n      return true;\n    } catch (error) {\n      logger.error('Failed to delete OPAQUE tag:', error);\n      return false;\n    }\n  }\n\n  /**\n   * Get analytics events\n   */\n  public getAnalyticsEvents(): OpaqueTagAnalyticsEvent[] {\n    return [...this.analyticsEvents];\n  }\n\n  /**\n   * Validate tag creation request\n   */\n  private validateTagCreationRequest(request: OpaqueTagCreationRequest): void {\n    if (!request.tag_name || request.tag_name.trim().length < 2) {\n      throw new Error('Tag name must be at least 2 characters');\n    }\n\n    if (!request.activation_phrase || request.activation_phrase.trim().length < 3) {\n      throw new Error('Activation phrase must be at least 3 characters');\n    }\n\n    if (!request.color_code || !request.color_code.match(/^#[0-9A-Fa-f]{6}$/)) {\n      throw new Error('Invalid color code');\n    }\n\n    if (!request.device_fingerprint) {\n      throw new Error('Device fingerprint required');\n    }\n  }\n\n  /**\n   * Generate unique tag ID\n   */\n  private generateTagId(): string {\n    return `opaque_tag_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n  }\n\n  /**\n   * Create initial session after tag creation\n   */\n  private async createInitialSession(tagId: string, phrase: string) {\n    // TODO: Implement with actual OPAQUE client integration\n    // For now, return placeholder session data\n    logger.debug(`Creating initial session for tag: ${tagId}`);\n    \n    return {\n      session_key: 'placeholder_session_key',\n      vault_key: 'placeholder_vault_key',\n      expires_at: new Date(Date.now() + 15 * 60 * 1000).toISOString()\n    };\n  }\n\n  /**\n   * Store OPAQUE tag locally\n   */\n  private async storeOpaqueTag(tag: OpaqueSecretTag): Promise<void> {\n    // TODO: Implement encrypted local storage\n    logger.debug(`Storing OPAQUE tag: ${tag.id}`);\n  }\n\n  /**\n   * Get OPAQUE tag by ID\n   */\n  private async getOpaqueTag(tagId: string): Promise<OpaqueSecretTag | null> {\n    // TODO: Implement storage retrieval\n    logger.debug(`Retrieving OPAQUE tag: ${tagId}`);\n    return null;\n  }\n\n  /**\n   * Update OPAQUE tag\n   */\n  private async updateOpaqueTag(tag: OpaqueSecretTag): Promise<void> {\n    tag.updated_at = new Date().toISOString();\n    // TODO: Implement storage update\n    logger.debug(`Updating OPAQUE tag: ${tag.id}`);\n  }\n\n  /**\n   * Remove OPAQUE tag from storage\n   */\n  private async removeOpaqueTag(tagId: string): Promise<void> {\n    // TODO: Implement storage removal\n    logger.debug(`Removing OPAQUE tag: ${tagId}`);\n  }\n\n  /**\n   * Record analytics event\n   */\n  private async recordAnalyticsEvent(event: OpaqueTagAnalyticsEvent): Promise<void> {\n    try {\n      this.analyticsEvents.push(event);\n      \n      // Keep only last 1000 events\n      if (this.analyticsEvents.length > 1000) {\n        this.analyticsEvents = this.analyticsEvents.slice(-1000);\n      }\n\n      // TODO: Persist to storage\n      logger.debug(`Recorded analytics event: ${event.type} for tag ${event.tagId}`);\n    } catch (error) {\n      logger.error('Failed to record analytics event:', error);\n    }\n  }\n\n  /**\n   * Load analytics events from storage\n   */\n  private async loadAnalyticsEvents(): Promise<void> {\n    try {\n      // TODO: Load from storage\n      logger.debug('Loading analytics events');\n    } catch (error) {\n      logger.error('Failed to load analytics events:', error);\n    }\n  }\n\n  /**\n   * Clean up resources\n   */\n  public async cleanup(): Promise<void> {\n    try {\n      logger.info('Cleaning up OpaqueTagManager');\n      \n      this.analyticsEvents = [];\n      this.isInitialized = false;\n      \n      logger.info('OpaqueTagManager cleanup complete');\n    } catch (error) {\n      logger.error('Error during OpaqueTagManager cleanup:', error);\n      throw error;\n    }\n  }\n}\n\n// Export singleton instance\nexport const opaqueTagManager = OpaqueTagManager.getInstance(); ","/**\n * Tag Delete Confirmation Screen\n * \n * Provides a secure confirmation dialog for deleting tags, with special handling\n * for secret tags that require additional security verification.\n */\n\nimport React, { useState, useEffect } from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  TouchableOpacity,\n  Alert,\n  ActivityIndicator,\n  TextInput,\n} from 'react-native';\nimport { useNavigation, useRoute, RouteProp } from '@react-navigation/native';\nimport { StackNavigationProp } from '@react-navigation/stack';\nimport { Ionicons } from '@expo/vector-icons';\n\nimport { MainStackParamList } from '../../navigation/types';\nimport { useAppTheme } from '../../contexts/ThemeContext';\nimport { AppTheme } from '../../config/theme';\nimport { tagManager } from '../../services/tagManager';\nimport { opaqueTagManager } from '../../services/OpaqueTagManager';\nimport ScreenHeader from '../../components/ScreenHeader';\nimport logger from '../../utils/logger';\n\ntype TagDeleteConfirmationRouteProp = RouteProp<MainStackParamList, 'TagDeleteConfirmation'>;\ntype TagDeleteConfirmationNavigationProp = StackNavigationProp<MainStackParamList, 'TagDeleteConfirmation'>;\n\nconst TagDeleteConfirmationScreen: React.FC = () => {\n  const navigation = useNavigation<TagDeleteConfirmationNavigationProp>();\n  const route = useRoute<TagDeleteConfirmationRouteProp>();\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n\n  const { tagId, tagName, tagType } = route.params;\n\n  // State\n  const [isDeleting, setIsDeleting] = useState(false);\n  const [confirmationText, setConfirmationText] = useState('');\n  const [showConfirmationInput, setShowConfirmationInput] = useState(false);\n\n  // For secret tags, require typing the tag name to confirm\n  const isSecretTag = tagType === 'secret';\n  const requiresConfirmation = isSecretTag;\n  const confirmationRequired = requiresConfirmation ? tagName : 'DELETE';\n\n  useEffect(() => {\n    if (requiresConfirmation) {\n      setShowConfirmationInput(true);\n    }\n  }, [requiresConfirmation]);\n\n  /**\n   * Handle tag deletion\n   */\n  const handleDelete = async () => {\n    if (requiresConfirmation && confirmationText !== confirmationRequired) {\n      Alert.alert(\n        'Confirmation Required',\n        `Please type \"${confirmationRequired}\" to confirm deletion.`\n      );\n      return;\n    }\n\n    setIsDeleting(true);\n    \n    try {\n      if (isSecretTag) {\n        await opaqueTagManager.deleteTag(tagId);\n        logger.info('Secret tag deleted:', { tagId, tagName });\n      } else {\n        await tagManager.deleteTag(tagId);\n        logger.info('Regular tag deleted:', { tagId, tagName });\n      }\n\n      Alert.alert(\n        'Tag Deleted',\n        `\"${tagName}\" has been permanently deleted.`,\n        [\n          {\n            text: 'OK',\n            onPress: () => navigation.goBack(),\n          },\n        ]\n      );\n    } catch (error) {\n      logger.error('Failed to delete tag:', error);\n      Alert.alert(\n        'Delete Failed',\n        error instanceof Error ? error.message : 'Failed to delete tag. Please try again.'\n      );\n    } finally {\n      setIsDeleting(false);\n    }\n  };\n\n  /**\n   * Handle cancellation\n   */\n  const handleCancel = () => {\n    navigation.goBack();\n  };\n\n  const canDelete = !requiresConfirmation || confirmationText === confirmationRequired;\n\n  return (\n    <View style={styles.container}>\n      <ScreenHeader title=\"Delete Tag\" />\n      \n      <View style={styles.content}>\n        {/* Warning Icon */}\n        <View style={styles.warningContainer}>\n          <Ionicons \n            name={isSecretTag ? \"shield-outline\" : \"warning-outline\"} \n            size={64} \n            color={theme.colors.error} \n          />\n        </View>\n\n        {/* Warning Text */}\n        <Text style={styles.warningTitle}>\n          {isSecretTag ? 'Delete Secret Tag?' : 'Delete Tag?'}\n        </Text>\n        \n        <Text style={styles.warningMessage}>\n          Are you sure you want to permanently delete \"{tagName}\"?\n        </Text>\n\n        {isSecretTag && (\n          <Text style={styles.secretTagWarning}>\n            This is a secret tag with encrypted data. Once deleted, all associated \n            encrypted entries will become permanently inaccessible.\n          </Text>\n        )}\n\n        <Text style={styles.warningSubtext}>\n          This action cannot be undone.\n        </Text>\n\n        {/* Confirmation Input */}\n        {showConfirmationInput && (\n          <View style={styles.confirmationContainer}>\n            <Text style={styles.confirmationLabel}>\n              Type \"{confirmationRequired}\" to confirm:\n            </Text>\n            <TextInput\n              style={styles.confirmationInput}\n              value={confirmationText}\n              onChangeText={setConfirmationText}\n              placeholder={confirmationRequired}\n              placeholderTextColor={theme.colors.textSecondary}\n              autoCapitalize=\"none\"\n              autoCorrect={false}\n            />\n          </View>\n        )}\n\n        {/* Action Buttons */}\n        <View style={styles.buttonContainer}>\n          <TouchableOpacity\n            style={[styles.button, styles.cancelButton]}\n            onPress={handleCancel}\n            disabled={isDeleting}\n          >\n            <Text style={styles.cancelButtonText}>Cancel</Text>\n          </TouchableOpacity>\n\n          <TouchableOpacity\n            style={[\n              styles.button,\n              styles.deleteButton,\n              (!canDelete || isDeleting) && styles.disabledButton,\n            ]}\n            onPress={handleDelete}\n            disabled={!canDelete || isDeleting}\n          >\n            {isDeleting ? (\n              <ActivityIndicator size=\"small\" color={theme.colors.onError} />\n            ) : (\n              <Text style={styles.deleteButtonText}>Delete</Text>\n            )}\n          </TouchableOpacity>\n        </View>\n\n        {/* Security Notice */}\n        {isSecretTag && (\n          <View style={styles.securityNotice}>\n            <Ionicons name=\"information-circle\" size={16} color={theme.colors.textSecondary} />\n            <Text style={styles.securityNoticeText}>\n              Secret tags can only be deleted when they are active for security reasons.\n            </Text>\n          </View>\n        )}\n      </View>\n    </View>\n  );\n};\n\nconst getStyles = (theme: AppTheme) => StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: theme.colors.background,\n  },\n  content: {\n    flex: 1,\n    padding: theme.spacing.xl,\n    justifyContent: 'center',\n  },\n  warningContainer: {\n    alignItems: 'center',\n    marginBottom: theme.spacing.xl,\n  },\n  warningTitle: {\n    fontSize: theme.typography.fontSizes.xxl,\n    fontWeight: 'bold',\n    color: theme.colors.error,\n    textAlign: 'center',\n    marginBottom: theme.spacing.md,\n    fontFamily: theme.typography.fontFamilies.bold,\n  },\n  warningMessage: {\n    fontSize: theme.typography.fontSizes.lg,\n    color: theme.colors.text,\n    textAlign: 'center',\n    marginBottom: theme.spacing.md,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  secretTagWarning: {\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.error,\n    textAlign: 'center',\n    marginBottom: theme.spacing.md,\n    fontFamily: theme.typography.fontFamilies.medium,\n    backgroundColor: theme.colors.errorLight || theme.colors.error + '20',\n    padding: theme.spacing.md,\n    borderRadius: theme.borderRadius.md,\n    borderWidth: 1,\n    borderColor: theme.colors.error + '40',\n  },\n  warningSubtext: {\n    fontSize: theme.typography.fontSizes.sm,\n    color: theme.colors.textSecondary,\n    textAlign: 'center',\n    marginBottom: theme.spacing.xl,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  confirmationContainer: {\n    marginBottom: theme.spacing.xl,\n  },\n  confirmationLabel: {\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.text,\n    marginBottom: theme.spacing.sm,\n    fontFamily: theme.typography.fontFamilies.medium,\n  },\n  confirmationInput: {\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n    borderRadius: theme.borderRadius.md,\n    padding: theme.spacing.md,\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.text,\n    backgroundColor: theme.colors.inputBackground,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  buttonContainer: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    gap: theme.spacing.md,\n  },\n  button: {\n    flex: 1,\n    paddingVertical: theme.spacing.md,\n    paddingHorizontal: theme.spacing.lg,\n    borderRadius: theme.borderRadius.md,\n    alignItems: 'center',\n    justifyContent: 'center',\n    minHeight: 48,\n  },\n  cancelButton: {\n    backgroundColor: theme.colors.card,\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n  },\n  cancelButtonText: {\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.medium,\n  },\n  deleteButton: {\n    backgroundColor: theme.colors.error,\n  },\n  deleteButtonText: {\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.onError || theme.colors.white,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n  disabledButton: {\n    opacity: 0.5,\n  },\n  securityNotice: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginTop: theme.spacing.xl,\n    padding: theme.spacing.md,\n    backgroundColor: theme.colors.card,\n    borderRadius: theme.borderRadius.md,\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n  },\n  securityNoticeText: {\n    fontSize: theme.typography.fontSizes.sm,\n    color: theme.colors.textSecondary,\n    marginLeft: theme.spacing.sm,\n    flex: 1,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n});\n\nexport default TagDeleteConfirmationScreen; ","import React, { useState, useEffect } from 'react';\nimport {\n  View,\n  Text,\n  TouchableOpacity,\n  StyleSheet,\n  ScrollView,\n  ActivityIndicator,\n} from 'react-native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { useAppTheme } from '../contexts/ThemeContext';\nimport { AppTheme } from '../config/theme';\nimport { Tag } from '../types';\nimport { TagsAPI } from '../services/api';\nimport logger from '../utils/logger';\n\ninterface RecentTag extends Tag {\n  last_used: string;\n  usage_count: number;\n}\n\ninterface RecentTagsSelectorProps {\n  onTagSelect: (tag: Tag) => void;\n  selectedTags: Tag[];\n  maxTags?: number;\n}\n\nconst RecentTagsSelector: React.FC<RecentTagsSelectorProps> = ({\n  onTagSelect,\n  selectedTags,\n  maxTags = 10,\n}) => {\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n  const [recentTags, setRecentTags] = useState<RecentTag[]>([]);\n  const [isLoading, setIsLoading] = useState(false);\n\n  useEffect(() => {\n    loadRecentTags();\n  }, []);\n\n  const loadRecentTags = async () => {\n    try {\n      setIsLoading(true);\n      const response = await TagsAPI.getRecentTags(5);\n      setRecentTags(response.data);\n    } catch (error) {\n      logger.error('Failed to load recent tags:', error);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleTagPress = (tag: RecentTag) => {\n    // Check if tag is already selected\n    const isSelected = selectedTags.some(selectedTag => \n      selectedTag.id === tag.id || selectedTag.name.toLowerCase() === tag.name.toLowerCase()\n    );\n    \n    if (isSelected) {\n      return; // Don't add duplicate tags\n    }\n\n    if (selectedTags.length >= maxTags) {\n      return; // Don't exceed max tags\n    }\n\n    // Convert RecentTag to Tag format\n    const tagToAdd: Tag = {\n      id: tag.id,\n      name: tag.name,\n      color: tag.color,\n      created_at: tag.created_at,\n      updated_at: tag.updated_at,\n    };\n\n    onTagSelect(tagToAdd);\n  };\n\n  const formatLastUsed = (lastUsed: string) => {\n    const date = new Date(lastUsed);\n    const now = new Date();\n    const diffInDays = Math.floor((now.getTime() - date.getTime()) / (1000 * 60 * 60 * 24));\n    \n    if (diffInDays === 0) {\n      return 'Today';\n    } else if (diffInDays === 1) {\n      return 'Yesterday';\n    } else if (diffInDays < 7) {\n      return `${diffInDays} days ago`;\n    } else {\n      return date.toLocaleDateString();\n    }\n  };\n\n  if (isLoading) {\n    return (\n      <View style={styles.loadingContainer}>\n        <ActivityIndicator size=\"small\" color={theme.colors.primary} />\n        <Text style={styles.loadingText}>Loading recent tags...</Text>\n      </View>\n    );\n  }\n\n  if (recentTags.length === 0) {\n    return null; // Don't show anything if no recent tags\n  }\n\n  return (\n    <View style={styles.container}>\n      <Text style={styles.title}>Recent Tags</Text>\n      <ScrollView \n        horizontal \n        showsHorizontalScrollIndicator={false}\n        style={styles.scrollView}\n        contentContainerStyle={styles.scrollContent}\n      >\n        {recentTags.map((tag) => {\n          const isSelected = selectedTags.some(selectedTag => \n            selectedTag.id === tag.id || selectedTag.name.toLowerCase() === tag.name.toLowerCase()\n          );\n          const isDisabled = selectedTags.length >= maxTags && !isSelected;\n          \n          return (\n            <TouchableOpacity\n              key={tag.id}\n              style={[\n                styles.tagButton,\n                isSelected && styles.tagButtonSelected,\n                isDisabled && styles.tagButtonDisabled,\n              ]}\n              onPress={() => handleTagPress(tag)}\n              disabled={isSelected || isDisabled}\n              activeOpacity={0.7}\n            >\n              <View style={styles.tagContent}>\n                <View style={styles.tagHeader}>\n                  <Ionicons \n                    name=\"pricetag\" \n                    size={16} \n                    color={tag.color || theme.colors.primary}\n                    style={styles.tagIcon}\n                  />\n                  <Text style={[\n                    styles.tagName,\n                    isSelected && styles.tagNameSelected,\n                    isDisabled && styles.tagNameDisabled,\n                  ]}>\n                    {tag.name}\n                  </Text>\n                </View>\n                <Text style={[\n                  styles.tagMeta,\n                  isSelected && styles.tagMetaSelected,\n                  isDisabled && styles.tagMetaDisabled,\n                ]}>\n                  {formatLastUsed(tag.last_used)}  {tag.usage_count} uses\n                </Text>\n              </View>\n            </TouchableOpacity>\n          );\n        })}\n      </ScrollView>\n    </View>\n  );\n};\n\nconst getStyles = (theme: AppTheme) => StyleSheet.create({\n  container: {\n    marginBottom: theme.spacing.md,\n  },\n  title: {\n    fontSize: 16,\n    fontWeight: '600',\n    color: theme.colors.text,\n    marginBottom: theme.spacing.sm,\n    marginLeft: theme.spacing.xs,\n  },\n  scrollView: {\n    flexGrow: 0,\n  },\n  scrollContent: {\n    paddingHorizontal: theme.spacing.xs,\n  },\n  loadingContainer: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    padding: theme.spacing.md,\n  },\n  loadingText: {\n    marginLeft: theme.spacing.sm,\n    color: theme.colors.textSecondary,\n    fontSize: 14,\n  },\n  tagButton: {\n    backgroundColor: theme.colors.surface,\n    borderRadius: theme.borderRadius.md,\n    padding: theme.spacing.sm,\n    marginRight: theme.spacing.sm,\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n    minWidth: 120,\n  },\n  tagButtonSelected: {\n    backgroundColor: theme.colors.primary + '20',\n    borderColor: theme.colors.primary,\n  },\n  tagButtonDisabled: {\n    opacity: 0.5,\n  },\n  tagContent: {\n    alignItems: 'flex-start',\n  },\n  tagHeader: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginBottom: 2,\n  },\n  tagIcon: {\n    marginRight: 4,\n  },\n  tagName: {\n    fontSize: 14,\n    fontWeight: '500',\n    color: theme.colors.text,\n    flex: 1,\n  },\n  tagNameSelected: {\n    color: theme.colors.primary,\n  },\n  tagNameDisabled: {\n    color: theme.colors.textSecondary,\n  },\n  tagMeta: {\n    fontSize: 12,\n    color: theme.colors.textSecondary,\n  },\n  tagMetaSelected: {\n    color: theme.colors.primary + 'CC',\n  },\n  tagMetaDisabled: {\n    color: theme.colors.textSecondary + '80',\n  },\n});\n\nexport default RecentTagsSelector; ","import React, { useState, useRef, useEffect, useMemo } from 'react';\nimport {\n  View,\n  Text,\n  TextInput,\n  TouchableOpacity,\n  StyleSheet,\n  ScrollView,\n  Animated,\n  Keyboard,\n  Platform,\n} from 'react-native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { useAppTheme } from '../contexts/ThemeContext';\nimport { AppTheme } from '../config/theme';\nimport { Tag } from '../types'; // Make sure this path is correct\nimport RecentTagsSelector from './RecentTagsSelector';\n\n// Helper to determine if native driver should be used\nconst useNativeDriver = Platform.OS !== 'web';\n\ninterface TagInputProps {\n  tags: Tag[];\n  onChangeTags: (tags: Tag[]) => void;\n  maxTags?: number;\n  placeholder?: string;\n  suggestions?: string[]; // Common tags for autocomplete\n}\n\nconst TagInput: React.FC<TagInputProps> = ({\n  tags,\n  onChangeTags,\n  maxTags = 10,\n  placeholder = \"Add tag...\",\n  suggestions = []\n}) => {\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n  const [inputValue, setInputValue] = useState('');\n  const [showSuggestions, setShowSuggestions] = useState(false);\n  const [filteredSuggestions, setFilteredSuggestions] = useState<string[]>([]);\n  const inputRef = useRef<TextInput>(null);\n  const fadeAnim = useRef(new Animated.Value(0)).current;\n\n  // Memoize suggestions to prevent unnecessary re-renders\n  const memoizedSuggestions = useMemo(() => suggestions, [suggestions]);\n\n  // Filter suggestions based on input\n  useEffect(() => {\n    if (inputValue.trim()) {\n      const currentTagNames = tags.map(tag => tag.name.toLowerCase());\n      const filtered = memoizedSuggestions.filter(\n        suggestion =>\n          suggestion.toLowerCase().includes(inputValue.toLowerCase()) &&\n          !currentTagNames.includes(suggestion.toLowerCase()),\n      );\n      setFilteredSuggestions(filtered);\n      setShowSuggestions(filtered.length > 0);\n\n      // Animate suggestions appearance only if there are suggestions\n      if (filtered.length > 0) {\n        Animated.timing(fadeAnim, {\n          toValue: 1,\n          duration: 200,\n          useNativeDriver,\n        }).start();\n      }\n    } else {\n      setShowSuggestions(false);\n      Animated.timing(fadeAnim, {\n        toValue: 0,\n        duration: 150,\n        useNativeDriver,\n      }).start();\n    }\n  }, [inputValue, memoizedSuggestions]); // Use memoized suggestions to prevent infinite loops\n\n  const handleAddTag = (tagName?: string) => {\n    const newTagName = (tagName || inputValue).trim().toLowerCase();\n    \n    if (!newTagName) {\n      return;\n    }\n    \n    // Check for duplicates and max tags\n    const currentTagNames = tags.map(tag => tag.name.toLowerCase());\n    if (currentTagNames.includes(newTagName) || tags.length >= maxTags) {\n      setInputValue('');\n      setShowSuggestions(false);\n      return;\n    }\n    \n    const newTag: Tag = { name: newTagName, id: null as any };\n    onChangeTags([...tags, newTag]);\n    setInputValue('');\n    setShowSuggestions(false);\n    \n    // Keep focus on input for continuous tagging\n    setTimeout(() => {\n      inputRef.current?.focus();\n    }, 100);\n  };\n\n  const handleRemoveTag = (indexToRemove: number) => {\n    const updatedTags = tags.filter((_, index) => index !== indexToRemove);\n    onChangeTags(updatedTags);\n  };\n\n  const handleKeyPress = (e: any) => {\n    const key = e.nativeEvent.key;\n    \n    if (key === 'Enter' || key === ' ' || key === ',') {\n      e.preventDefault?.();\n      handleAddTag();\n    } else if (key === 'Backspace' && !inputValue && tags.length > 0) {\n      // Remove last tag when backspace is pressed on empty input\n      handleRemoveTag(tags.length - 1);\n    }\n  };\n\n  const handleSuggestionPress = (suggestion: string) => {\n    handleAddTag(suggestion);\n  };\n\n  const handleInputFocus = () => {\n    if (inputValue.trim() && filteredSuggestions.length > 0) {\n      setShowSuggestions(true);\n    }\n  };\n\n  const handleInputBlur = () => {\n    // Delay hiding suggestions to allow for suggestion tap\n    setTimeout(() => {\n      setShowSuggestions(false);\n    }, 150);\n  };\n\n  return (\n    <View style={styles.container} testID=\"tag-input-container\">\n      {/* Recent Tags Selector */}\n      <RecentTagsSelector\n        onTagSelect={(tag) => {\n          // Add the selected tag to the current tags\n          const newTag: Tag = { \n            name: tag.name, \n            id: tag.id,\n            color: tag.color,\n            created_at: tag.created_at,\n            updated_at: tag.updated_at\n          };\n          onChangeTags([...tags, newTag]);\n        }}\n        selectedTags={tags}\n        maxTags={maxTags}\n      />\n      \n      {/* Tags Display */}\n      {tags.length > 0 && (\n        <ScrollView\n          horizontal\n          showsHorizontalScrollIndicator={false}\n          style={styles.tagsScrollView}\n          contentContainerStyle={styles.tagsContainer}\n          testID=\"tags-scroll-view\"\n          keyboardShouldPersistTaps=\"handled\"\n        >\n          {tags.map((tag, index) => (\n            <Animated.View\n              key={tag.id ? `tag-${tag.id}` : `tag-${tag.name}-${index}`}\n              style={styles.tag}\n              testID={`tag-item-${tag.name}-${index}`}\n            >\n              <Text style={styles.tagText} testID={`tag-text-${tag.name}`}>\n                #{tag.name}\n              </Text>\n              <TouchableOpacity\n                style={styles.tagRemoveButton}\n                onPress={() => handleRemoveTag(index)}\n                testID={`tag-delete-button-${tag.name}-${index}`}\n                accessibilityLabel={`Delete tag ${tag.name}`}\n                hitSlop={{ top: 8, bottom: 8, left: 8, right: 8 }}\n              >\n                <Ionicons name=\"close-circle\" size={18} color={theme.colors.textSecondary} />\n              </TouchableOpacity>\n            </Animated.View>\n          ))}\n        </ScrollView>\n      )}\n      \n      {/* Input Container */}\n      <View style={styles.inputContainer} testID=\"tag-input-field-container\">\n        <View style={styles.inputWrapper}>\n          <Ionicons \n            name=\"pricetag-outline\" \n            size={20} \n            color={theme.colors.textSecondary} \n            style={styles.inputIcon}\n          />\n          <TextInput\n            ref={inputRef}\n            style={styles.input}\n            value={inputValue}\n            onChangeText={setInputValue}\n            onSubmitEditing={() => handleAddTag()}\n            onKeyPress={handleKeyPress}\n            onFocus={handleInputFocus}\n            onBlur={handleInputBlur}\n            placeholder={tags.length >= maxTags ? `Maximum ${maxTags} tags` : placeholder}\n            placeholderTextColor={theme.colors.textSecondary}\n            returnKeyType=\"done\"\n            testID=\"tag-input-field\"\n            editable={tags.length < maxTags}\n            autoCorrect={false}\n            autoCapitalize=\"none\"\n          />\n        </View>\n        <TouchableOpacity\n          style={[\n            styles.addButton,\n            (!inputValue.trim() || tags.length >= maxTags) && styles.disabledButton\n          ]}\n          onPress={() => handleAddTag()}\n          disabled={!inputValue.trim() || tags.length >= maxTags}\n          testID=\"add-tag-button\"\n          accessibilityLabel=\"Add tag\"\n          hitSlop={{ top: 8, bottom: 8, left: 8, right: 8 }}\n        >\n          <Ionicons \n            name=\"add\" \n            size={22} \n            color={theme.colors.onPrimary} \n          />\n        </TouchableOpacity>\n      </View>\n\n      {/* Suggestions */}\n      {showSuggestions && (\n        <Animated.View \n          style={[styles.suggestionsContainer, { opacity: fadeAnim }]}\n          testID=\"suggestions-container\"\n        >\n          <Text style={styles.suggestionsTitle}>Suggestions:</Text>\n          <ScrollView \n            horizontal \n            showsHorizontalScrollIndicator={false}\n            contentContainerStyle={styles.suggestionsContent}\n          >\n            {filteredSuggestions.map((suggestion, index) => (\n              <TouchableOpacity\n                key={`suggestion-${index}`}\n                style={styles.suggestionChip}\n                onPress={() => handleSuggestionPress(suggestion)}\n                testID={`suggestion-${suggestion}`}\n              >\n                <Text style={styles.suggestionText}>#{suggestion}</Text>\n              </TouchableOpacity>\n            ))}\n          </ScrollView>\n        </Animated.View>\n      )}\n      \n      {/* Help Text */}\n      {tags.length < maxTags && inputValue.length === 0 && !showSuggestions && (\n        <Text style={styles.helpText} testID=\"tag-input-help-text\">\n          Press Enter, space, or comma to add  Backspace to remove last tag\n        </Text>\n      )}\n\n      {/* Tag Counter */}\n      <View style={styles.counterContainer}>\n        <Text style={styles.counterText}>\n          {tags.length}/{maxTags} tags\n        </Text>\n      </View>\n    </View>\n  );\n};\n\nconst getStyles = (theme: AppTheme) => StyleSheet.create({\n  container: {\n    marginBottom: theme.spacing.md,\n  },\n  tagsScrollView: {\n    maxHeight: 80,\n    marginBottom: theme.spacing.md,\n  },\n  tagsContainer: {\n    flexDirection: 'row',\n    flexWrap: 'nowrap',\n    alignItems: 'center',\n    paddingVertical: theme.spacing.xs,\n  },\n  tag: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: theme.isDarkMode ? theme.colors.gray700 : theme.colors.primaryLight + '20',\n    borderRadius: theme.borderRadius.full,\n    paddingHorizontal: theme.spacing.md,\n    paddingVertical: theme.spacing.sm,\n    marginRight: theme.spacing.sm,\n    borderWidth: 1,\n    borderColor: theme.isDarkMode ? theme.colors.gray600 : theme.colors.primaryLight + '40',\n    minHeight: 36, // Larger touch target\n  },\n  tagText: {\n    color: theme.isDarkMode ? theme.colors.text : theme.colors.primary,\n    fontSize: theme.typography.fontSizes.sm,\n    marginRight: theme.spacing.sm,\n    fontFamily: theme.typography.fontFamilies.medium,\n    fontWeight: '500',\n  },\n  tagRemoveButton: {\n    padding: theme.spacing.xs,\n    marginLeft: theme.spacing.xs,\n    borderRadius: theme.borderRadius.full,\n  },\n  inputContainer: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginBottom: theme.spacing.sm,\n  },\n  inputWrapper: {\n    flex: 1,\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: theme.colors.inputBackground,\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n    borderRadius: theme.borderRadius.lg,\n    paddingHorizontal: theme.spacing.md,\n    minHeight: 48, // Larger touch target\n  },\n  inputIcon: {\n    marginRight: theme.spacing.sm,\n  },\n  input: {\n    flex: 1,\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.regular,\n    paddingVertical: theme.spacing.md,\n  },\n  addButton: {\n    width: 48,\n    height: 48,\n    borderRadius: theme.borderRadius.lg,\n    backgroundColor: theme.colors.primary,\n    justifyContent: 'center',\n    alignItems: 'center',\n    marginLeft: theme.spacing.md,\n    ...theme.shadows.sm,\n  },\n  disabledButton: {\n    backgroundColor: theme.colors.disabled,\n    opacity: 0.6,\n  },\n  suggestionsContainer: {\n    backgroundColor: theme.colors.card,\n    borderRadius: theme.borderRadius.md,\n    padding: theme.spacing.md,\n    marginBottom: theme.spacing.sm,\n    borderWidth: 1,\n    borderColor: theme.colors.borderLight,\n    ...theme.shadows.sm,\n  },\n  suggestionsTitle: {\n    fontSize: theme.typography.fontSizes.sm,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.medium,\n    marginBottom: theme.spacing.sm,\n  },\n  suggestionsContent: {\n    flexDirection: 'row',\n  },\n  suggestionChip: {\n    backgroundColor: theme.colors.accent + '20',\n    borderRadius: theme.borderRadius.full,\n    paddingHorizontal: theme.spacing.md,\n    paddingVertical: theme.spacing.sm,\n    marginRight: theme.spacing.sm,\n    borderWidth: 1,\n    borderColor: theme.colors.accent + '40',\n  },\n  suggestionText: {\n    fontSize: theme.typography.fontSizes.sm,\n    color: theme.colors.accent,\n    fontFamily: theme.typography.fontFamilies.medium,\n  },\n  helpText: {\n    fontSize: theme.typography.fontSizes.xs,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.regular,\n    lineHeight: theme.typography.lineHeights.normal * theme.typography.fontSizes.xs,\n  },\n  counterContainer: {\n    alignItems: 'flex-end',\n    marginTop: theme.spacing.xs,\n  },\n  counterText: {\n    fontSize: theme.typography.fontSizes.xs,\n    color: theme.colors.textDisabled,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n});\n\nexport default TagInput; ","import React, { useState, useEffect, useCallback, useRef } from 'react';\nimport { \n  View, \n  Text, \n  StyleSheet, \n  TouchableOpacity, \n  ActivityIndicator,\n  Alert,\n  Platform,\n  SafeAreaView,\n  Animated,\n  Dimensions,\n  ScrollView,\n  TextInput\n} from 'react-native';\nimport { useNavigation, useRoute, RouteProp, useFocusEffect } from '@react-navigation/native';\nimport { StackNavigationProp } from '@react-navigation/stack';\nimport { Ionicons } from '@expo/vector-icons';\nimport { format, parseISO } from 'date-fns';\n\nimport { JournalAPI } from '../../services/api';\nimport { JournalEntry, Tag } from '../../types';\nimport { MainStackParamList } from '../../navigation/types';\nimport { useAppTheme } from '../../contexts/ThemeContext';\nimport { AppTheme } from '../../config/theme';\nimport hapticService from '../../services/hapticService';\nimport TagInput from '../../components/TagInput';\n\nconst { width: SCREEN_WIDTH, height: SCREEN_HEIGHT } = Dimensions.get('window');\n\n// Define the type for the route params\ntype JournalEntryDetailRouteProp = RouteProp<MainStackParamList, 'JournalEntryDetail'>;\n\n// Define the type for the navigation prop\ntype JournalEntryDetailNavigationProp = StackNavigationProp<MainStackParamList, 'JournalEntryDetail'>;\n\nconst JournalEntryDetailScreen = () => {\n  const navigation = useNavigation<JournalEntryDetailNavigationProp>();\n  const route = useRoute<JournalEntryDetailRouteProp>();\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n  const { entryId } = route.params;\n  \n  const [entry, setEntry] = useState<JournalEntry | null>(null);\n  const [isLoading, setIsLoading] = useState(true);\n  \n  // Unified edit state - everything is editable when enabled\n  const [isEditMode, setIsEditMode] = useState(false); // Start in view mode by default\n  const [editTitle, setEditTitle] = useState('');\n  const [editContent, setEditContent] = useState('');\n  const [editTags, setEditTags] = useState<Tag[]>([]);\n  const [isSaving, setIsSaving] = useState(false);\n  \n  // Animation values\n  const fadeAnim = useRef(new Animated.Value(0)).current;\n  const slideAnim = useRef(new Animated.Value(50)).current;\n  const scaleAnim = useRef(new Animated.Value(0.95)).current;\n  const scrollY = useRef(new Animated.Value(0)).current;\n  \n  // Text input refs to handle focus issues\n  const titleInputRef = useRef<TextInput>(null);\n  const contentInputRef = useRef<TextInput>(null);\n  \n  // Animated header\n  const headerOpacity = scrollY.interpolate({\n    inputRange: [0, 100],\n    outputRange: [0, 1],\n    extrapolate: 'clamp',\n  });\n\n  const headerScale = scrollY.interpolate({\n    inputRange: [0, 100],\n    outputRange: [0.8, 1],\n    extrapolate: 'clamp',\n  });\n  \n  useFocusEffect(\n    useCallback(() => {\n      fetchEntryDetails();\n      \n      return () => {\n        // Reset animations when leaving\n        fadeAnim.setValue(0);\n        slideAnim.setValue(50);\n        scaleAnim.setValue(0.95);\n      };\n    }, [entryId])\n  );\n\n  useEffect(() => {\n    if (entry) {\n      // Animate in the content\n      Animated.parallel([\n        Animated.timing(fadeAnim, {\n          toValue: 1,\n          duration: 600,\n          useNativeDriver: true,\n        }),\n        Animated.spring(slideAnim, {\n          toValue: 0,\n          tension: 80,\n          friction: 8,\n          useNativeDriver: true,\n        }),\n        Animated.spring(scaleAnim, {\n          toValue: 1,\n          tension: 80,\n          friction: 8,\n          useNativeDriver: true,\n        }),\n      ]).start();\n    }\n  }, [entry]);\n  \n  const fetchEntryDetails = async () => {\n    try {\n      setIsLoading(true);\n      const response = await JournalAPI.getEntry(String(entryId));\n      const entryData = response.data;\n      setEntry(entryData);\n      \n      // Initialize edit state\n      setEditTitle(entryData.title || '');\n      setEditContent(entryData.content || '');\n      setEditTags(entryData.tags || []);\n    } catch (error) {\n      console.error('Error fetching entry details', error);\n      Alert.alert('Error', 'Failed to load journal entry details');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  \n  const handleToggleEdit = () => {\n    hapticService.light();\n    setIsEditMode(!isEditMode);\n  };\n  \n  const handleSaveChanges = async () => {\n    if (!entry) {\n      console.error('No entry to save');\n      return;\n    }\n    \n    try {\n      setIsSaving(true);\n      hapticService.light();\n      \n      const updateData = {\n        title: editTitle,\n        content: editContent,\n        tags: editTags.map(tag => tag.name)\n      };\n      \n      const response = await JournalAPI.updateEntry(String(entryId), updateData);\n      console.log('Entry saved successfully');\n      \n      // Update local entry state with new values\n      const updatedEntry = {\n        ...entry,\n        title: editTitle,\n        content: editContent,\n        tags: editTags\n      };\n      setEntry(updatedEntry);\n      setIsEditMode(false);\n      \n      // Show success feedback\n      hapticService.success();\n    } catch (error) {\n      console.error('Error saving entry:', error);\n      Alert.alert('Error', `Failed to save changes: ${error instanceof Error ? error.message : 'Unknown error'}`);\n      hapticService.error();\n    } finally {\n      setIsSaving(false);\n    }\n  };\n  \n  const handleCancelEdit = () => {\n    hapticService.light();\n    // Reset to original values\n    if (entry) {\n      setEditTitle(entry.title || '');\n      setEditContent(entry.content || '');\n      setEditTags(entry.tags || []);\n    }\n    setIsEditMode(false);\n  };\n  \n  const handleDelete = async () => {\n    hapticService.medium();\n    navigation.navigate('DeleteConfirmation', { entryId });\n  };\n\n  const handleBack = () => {\n    hapticService.light();\n    if (isEditMode) {\n      // Ask to save or discard changes\n      Alert.alert(\n        'Unsaved Changes',\n        'You have unsaved changes. What would you like to do?',\n        [\n          {\n            text: 'Discard',\n            style: 'destructive',\n            onPress: () => {\n              handleCancelEdit();\n              navigation.goBack();\n            }\n          },\n          {\n            text: 'Save & Exit',\n            onPress: async () => {\n              await handleSaveChanges();\n              navigation.goBack();\n            }\n          },\n          {\n            text: 'Cancel',\n            style: 'cancel'\n          }\n        ]\n      );\n    } else {\n      navigation.goBack();\n    }\n  };\n  \n  if (isLoading) {\n    return (\n      <View style={styles.loadingContainer}>\n        <View style={styles.loadingContent}>\n          <ActivityIndicator size=\"large\" color={theme.colors.primary} />\n          <Text style={styles.loadingText}>Loading your entry...</Text>\n        </View>\n      </View>\n    );\n  }\n  \n  if (!entry) {\n    return (\n      <View style={styles.errorContainer}>\n        <View style={styles.errorContent}>\n          <Ionicons name=\"document-text-outline\" size={80} color={theme.colors.textSecondary} />\n          <Text style={styles.errorTitle}>Entry Not Found</Text>\n          <Text style={styles.errorText}>This journal entry might have been deleted or moved.</Text>\n          <TouchableOpacity \n            style={styles.errorButton}\n            onPress={handleBack}\n            activeOpacity={0.8}\n          >\n            <Ionicons name=\"arrow-back\" size={20} color={theme.colors.white} />\n            <Text style={styles.errorButtonText}>Go Back</Text>\n          </TouchableOpacity>\n        </View>\n      </View>\n    );\n  }\n\n  const entryDate = parseISO(entry.entry_date);\n  const isToday = format(new Date(), 'yyyy-MM-dd') === format(entryDate, 'yyyy-MM-dd');\n  const isYesterday = format(new Date(Date.now() - 86400000), 'yyyy-MM-dd') === format(entryDate, 'yyyy-MM-dd');\n\n  const getDateDisplayText = () => {\n    if (isToday) return 'Today';\n    if (isYesterday) return 'Yesterday';\n    return format(entryDate, 'EEEE, MMMM d');\n  };\n\n  return (\n    <SafeAreaView style={styles.container}>\n      {/* Floating Header */}\n      <Animated.View \n        style={[\n          styles.floatingHeader,\n          {\n            opacity: headerOpacity,\n            transform: [{ scale: headerScale }]\n          }\n        ]}\n      >\n        <TouchableOpacity \n          style={styles.headerBackButton}\n          onPress={handleBack}\n          activeOpacity={0.7}\n        >\n          <Ionicons name=\"arrow-back\" size={24} color={theme.colors.text} />\n        </TouchableOpacity>\n        <Text style={styles.floatingHeaderTitle} numberOfLines={1}>\n          {entry.title || 'Journal Entry'}\n        </Text>\n        <View style={styles.headerSpacer} />\n      </Animated.View>\n\n      {/* Main Header */}\n      <View style={styles.mainHeader}>\n        <TouchableOpacity \n          style={styles.backButton}\n          onPress={handleBack}\n          activeOpacity={0.7}\n        >\n          <Ionicons name=\"arrow-back\" size={28} color={theme.colors.text} />\n        </TouchableOpacity>\n        <View style={styles.headerActions}>\n          {isEditMode ? (\n            <>\n              <TouchableOpacity \n                style={[styles.headerActionButton, isSaving && { opacity: 0.5 }]}\n                onPress={() => {\n                  // Blur text inputs first to prevent focus interference on web\n                  titleInputRef.current?.blur();\n                  contentInputRef.current?.blur();\n                  handleSaveChanges();\n                }}\n                activeOpacity={0.7}\n                disabled={isSaving}\n              >\n                {isSaving ? (\n                  <ActivityIndicator size=\"small\" color={theme.colors.primary} />\n                ) : (\n                  <Ionicons name=\"checkmark\" size={24} color={theme.colors.success} />\n                )}\n              </TouchableOpacity>\n              <TouchableOpacity \n                style={styles.headerActionButton}\n                onPress={handleToggleEdit}\n                activeOpacity={0.7}\n              >\n                <Ionicons name=\"eye-outline\" size={24} color={theme.colors.primary} />\n              </TouchableOpacity>\n            </>\n          ) : (\n            <TouchableOpacity \n              style={styles.headerActionButton}\n              onPress={handleToggleEdit}\n              activeOpacity={0.7}\n            >\n              <Ionicons name=\"create-outline\" size={24} color={theme.colors.primary} />\n            </TouchableOpacity>\n          )}\n          <TouchableOpacity \n            style={[styles.headerActionButton, styles.deleteHeaderButton]}\n            onPress={handleDelete}\n            activeOpacity={0.7}\n          >\n            <Ionicons name=\"trash-outline\" size={24} color={theme.colors.error} />\n          </TouchableOpacity>\n        </View>\n      </View>\n      \n      <Animated.ScrollView\n        style={styles.scrollView}\n        showsVerticalScrollIndicator={false}\n        scrollEventThrottle={16}\n        onScroll={Animated.event(\n          [{ nativeEvent: { contentOffset: { y: scrollY } } }],\n          { useNativeDriver: false }\n        )}\n      >\n        <Animated.View \n          style={[\n            styles.content,\n            {\n              opacity: fadeAnim,\n              transform: [\n                { translateY: slideAnim },\n                { scale: scaleAnim }\n              ]\n            }\n          ]}\n        >\n          {/* Hero Date Section */}\n          <View style={styles.heroSection}>\n            <View style={styles.dateContainer}>\n              <Text style={styles.dateText}>{getDateDisplayText()}</Text>\n              <Text style={styles.fullDateText}>\n                {format(entryDate, 'MMMM d, yyyy')}\n              </Text>\n              <View style={styles.timeContainer}>\n                <Ionicons name=\"time-outline\" size={16} color={theme.colors.textSecondary} />\n                <Text style={styles.timeText}>\n                  {format(entryDate, 'h:mm a')}\n                </Text>\n              </View>\n            </View>\n            {entry.audio_url && (\n              <View style={styles.audioIndicator}>\n                <Ionicons name=\"musical-notes\" size={24} color={theme.colors.accent} />\n                <Text style={styles.audioText}>Audio</Text>\n              </View>\n            )}\n          </View>\n\n          {/* Unified Title and Content Section */}\n          <View style={styles.entrySection}>\n            <View style={styles.entryHeader}>\n              <Ionicons name=\"document-text\" size={20} color={theme.colors.primary} />\n              <Text style={styles.entryHeaderText}>Your Entry</Text>\n              {isEditMode && (\n                <Text style={styles.editModeIndicator}>Editing</Text>\n              )}\n            </View>\n            \n            {/* Title - Always Visible, Editable in Edit Mode */}\n            <View style={styles.titleSection}>\n              {isEditMode ? (\n                <TextInput\n                  ref={titleInputRef}\n                  style={styles.titleInput}\n                  value={editTitle}\n                  onChangeText={setEditTitle}\n                  placeholder=\"Enter title...\"\n                  multiline={false}\n                  maxLength={100}\n                />\n              ) : (\n                <Text style={styles.entryTitle}>\n                  {entry.title || 'Untitled Entry'}\n                </Text>\n              )}\n            </View>\n            \n            {/* Content - Always Visible, Editable in Edit Mode */}\n            <View style={styles.contentSection}>\n              {isEditMode ? (\n                <TextInput\n                  ref={contentInputRef}\n                  style={styles.contentInput}\n                  value={editContent}\n                  onChangeText={setEditContent}\n                  placeholder=\"What's on your mind?\"\n                  multiline={true}\n                  numberOfLines={8}\n                  textAlignVertical=\"top\"\n                />\n              ) : (\n                <Text style={styles.entryText}>{entry.content}</Text>\n              )}\n            </View>\n\n            {/* Record Button - Available in Edit Mode */}\n            {isEditMode && (\n              <View style={styles.recordSection}>\n                <TouchableOpacity \n                  style={styles.recordButton}\n                  onPress={() => {\n                    hapticService.light();\n                    navigation.navigate('Record', { journalId: entryId });\n                  }}\n                  activeOpacity={0.8}\n                >\n                  <Ionicons name=\"mic\" size={20} color={theme.colors.white} />\n                  <Text style={styles.recordButtonText}>Record</Text>\n                </TouchableOpacity>\n              </View>\n            )}\n          </View>\n\n          {/* Tags Section - Always Editable */}\n          <View style={styles.tagsSection}>\n            <View style={styles.tagsHeader}>\n              <Ionicons name=\"pricetags\" size={20} color={theme.colors.primary} />\n              <Text style={styles.tagsHeaderText}>Tags</Text>\n              {!isEditMode && (\n                <View style={styles.tagCount}>\n                  <Text style={styles.tagCountText}>{entry.tags?.length || 0}</Text>\n                </View>\n              )}\n            </View>\n            \n            {isEditMode ? (\n              <TagInput\n                tags={editTags}\n                onChangeTags={setEditTags}\n                placeholder=\"Add tags...\"\n                maxTags={10}\n              />\n            ) : (\n              entry.tags && entry.tags.length > 0 && (\n                <View style={styles.tagsList}>\n                  {entry.tags.map((tag: Tag, index: number) => (\n                    <Animated.View \n                      key={tag.id ? String(tag.id) : `${entry.id}-tag-${index}`}\n                      style={[\n                        styles.tag,\n                        {\n                          transform: [{\n                            scale: fadeAnim.interpolate({\n                              inputRange: [0, 1],\n                              outputRange: [0.8, 1],\n                            })\n                          }]\n                        }\n                      ]}\n                    >\n                      <Text style={styles.tagText}>{tag.name}</Text>\n                    </Animated.View>\n                  ))}\n                </View>\n              )\n            )}\n          </View>\n\n          {/* Stats Section */}\n          <View style={styles.statsSection}>\n            <Text style={styles.statsTitle}>Entry Stats</Text>\n            <View style={styles.statsGrid}>\n              <View style={styles.statItem}>\n                <Ionicons name=\"text-outline\" size={24} color={theme.colors.primary} />\n                <Text style={styles.statValue}>\n                  {isEditMode ? editContent.length : entry.content.length}\n                </Text>\n                <Text style={styles.statLabel}>Characters</Text>\n              </View>\n              <View style={styles.statItem}>\n                <Ionicons name=\"library-outline\" size={24} color={theme.colors.accent} />\n                <Text style={styles.statValue}>\n                  {isEditMode \n                    ? editContent.split(' ').filter(word => word.length > 0).length \n                    : entry.content.split(' ').length\n                  }\n                </Text>\n                <Text style={styles.statLabel}>Words</Text>\n              </View>\n              <View style={styles.statItem}>\n                <Ionicons name=\"pricetags-outline\" size={24} color={theme.colors.secondary} />\n                <Text style={styles.statValue}>\n                  {isEditMode ? editTags.length : (entry.tags?.length || 0)}\n                </Text>\n                <Text style={styles.statLabel}>Tags</Text>\n              </View>\n            </View>\n          </View>\n        </Animated.View>\n      </Animated.ScrollView>\n      \n      {/* Floating Action Buttons */}\n      <Animated.View \n        style={[\n          styles.floatingActions,\n          {\n            opacity: fadeAnim,\n            transform: [{ translateY: slideAnim }]\n          }\n        ]}\n      >\n        <TouchableOpacity \n          style={[styles.fab, styles.editFab]} \n          onPress={handleToggleEdit}\n          activeOpacity={0.8}\n        >\n          <Ionicons name=\"create\" size={24} color={theme.colors.white} />\n        </TouchableOpacity>\n        \n        <TouchableOpacity \n          style={[styles.fab, styles.deleteFab]} \n          onPress={handleDelete}\n          activeOpacity={0.8}\n        >\n          <Ionicons name=\"trash\" size={24} color={theme.colors.white} />\n        </TouchableOpacity>\n      </Animated.View>\n    </SafeAreaView>\n  );\n};\n\n// Function to generate styles based on the theme\nconst getStyles = (theme: AppTheme) => StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: theme.colors.background,\n  },\n  loadingContainer: {\n    flex: 1,\n    backgroundColor: theme.colors.background,\n  },\n  loadingContent: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n    paddingHorizontal: theme.spacing.xl,\n  },\n  loadingText: {\n    fontSize: theme.typography.fontSizes.lg,\n    color: theme.colors.textSecondary,\n    marginTop: theme.spacing.lg,\n    fontFamily: theme.typography.fontFamilies.medium,\n  },\n  errorContainer: {\n    flex: 1,\n    backgroundColor: theme.colors.background,\n  },\n  errorContent: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n    paddingHorizontal: theme.spacing.xl,\n  },\n  errorTitle: {\n    fontSize: theme.typography.fontSizes.xxl,\n    fontWeight: 'bold',\n    color: theme.colors.text,\n    marginTop: theme.spacing.lg,\n    marginBottom: theme.spacing.md,\n    fontFamily: theme.typography.fontFamilies.bold,\n  },\n  errorText: {\n    fontSize: theme.typography.fontSizes.lg,\n    color: theme.colors.textSecondary,\n    textAlign: 'center',\n    marginBottom: theme.spacing.xl,\n    lineHeight: theme.typography.lineHeights.normal * theme.typography.fontSizes.lg,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  errorButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: theme.colors.primary,\n    paddingVertical: theme.spacing.lg,\n    paddingHorizontal: theme.spacing.xl,\n    borderRadius: theme.borderRadius.xl,\n    ...theme.shadows.md,\n  },\n  errorButtonText: {\n    color: theme.colors.white,\n    fontSize: theme.typography.fontSizes.lg,\n    fontWeight: '600',\n    marginLeft: theme.spacing.sm,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n  floatingHeader: {\n    position: 'absolute',\n    top: Platform.OS === 'ios' ? 44 : 0,\n    left: 0,\n    right: 0,\n    height: 60,\n    backgroundColor: theme.colors.card,\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: theme.spacing.lg,\n    zIndex: 1000,\n    ...theme.shadows.lg,\n    borderBottomWidth: 1,\n    borderBottomColor: theme.colors.border,\n  },\n  headerBackButton: {\n    width: 40,\n    height: 40,\n    borderRadius: 20,\n    backgroundColor: theme.colors.background,\n    justifyContent: 'center',\n    alignItems: 'center',\n    ...theme.shadows.sm,\n  },\n  floatingHeaderTitle: {\n    flex: 1,\n    fontSize: theme.typography.fontSizes.lg,\n    fontWeight: '600',\n    color: theme.colors.text,\n    textAlign: 'center',\n    marginHorizontal: theme.spacing.md,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n  headerSpacer: {\n    width: 40,\n  },\n  mainHeader: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: theme.spacing.lg,\n    paddingTop: Platform.OS === 'ios' ? 60 : theme.spacing.lg,\n    paddingBottom: theme.spacing.lg,\n    backgroundColor: theme.colors.background,\n  },\n  backButton: {\n    width: 44,\n    height: 44,\n    borderRadius: 22,\n    backgroundColor: theme.colors.card,\n    justifyContent: 'center',\n    alignItems: 'center',\n    ...theme.shadows.md,\n  },\n  headerActions: {\n    flexDirection: 'row',\n    gap: theme.spacing.md,\n  },\n  headerActionButton: {\n    width: 44,\n    height: 44,\n    borderRadius: 22,\n    backgroundColor: theme.colors.card,\n    justifyContent: 'center',\n    alignItems: 'center',\n    ...theme.shadows.md,\n  },\n  deleteHeaderButton: {\n    backgroundColor: theme.colors.errorLight + '20',\n  },\n  scrollView: {\n    flex: 1,\n  },\n  content: {\n    paddingHorizontal: theme.spacing.lg,\n    paddingBottom: 120, // Space for FABs\n  },\n  heroSection: {\n    backgroundColor: theme.colors.card,\n    borderRadius: theme.borderRadius.xxl,\n    padding: theme.spacing.xl,\n    marginBottom: theme.spacing.xl,\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'flex-start',\n    ...theme.shadows.lg,\n    borderWidth: theme.isDarkMode ? 1 : 0,\n    borderColor: theme.colors.border,\n  },\n  dateContainer: {\n    flex: 1,\n  },\n  dateText: {\n    fontSize: theme.typography.fontSizes.xxxl,\n    fontWeight: 'bold',\n    color: theme.colors.text,\n    marginBottom: theme.spacing.xs,\n    fontFamily: theme.typography.fontFamilies.bold,\n    letterSpacing: -1,\n  },\n  fullDateText: {\n    fontSize: theme.typography.fontSizes.lg,\n    color: theme.colors.textSecondary,\n    marginBottom: theme.spacing.sm,\n    fontFamily: theme.typography.fontFamilies.medium,\n  },\n  timeContainer: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: theme.colors.primaryLight + '20',\n    paddingHorizontal: theme.spacing.md,\n    paddingVertical: theme.spacing.sm,\n    borderRadius: theme.borderRadius.full,\n    alignSelf: 'flex-start',\n  },\n  timeText: {\n    fontSize: theme.typography.fontSizes.sm,\n    color: theme.colors.primary,\n    fontWeight: '600',\n    marginLeft: theme.spacing.xs,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n  audioIndicator: {\n    alignItems: 'center',\n    backgroundColor: theme.colors.accentLight + '20',\n    paddingHorizontal: theme.spacing.lg,\n    paddingVertical: theme.spacing.md,\n    borderRadius: theme.borderRadius.xl,\n    borderWidth: 2,\n    borderColor: theme.colors.accent + '30',\n  },\n  audioText: {\n    fontSize: theme.typography.fontSizes.xs,\n    color: theme.colors.accent,\n    fontWeight: '600',\n    marginTop: theme.spacing.xs,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n  entrySection: {\n    backgroundColor: theme.colors.card,\n    borderRadius: theme.borderRadius.xxl,\n    padding: theme.spacing.xl,\n    marginBottom: theme.spacing.xl,\n    ...theme.shadows.md,\n    borderWidth: theme.isDarkMode ? 1 : 0,\n    borderColor: theme.colors.border,\n  },\n  entryHeader: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginBottom: theme.spacing.lg,\n    paddingBottom: theme.spacing.md,\n    borderBottomWidth: 1,\n    borderBottomColor: theme.colors.border,\n  },\n  entryHeaderText: {\n    fontSize: theme.typography.fontSizes.lg,\n    fontWeight: '600',\n    color: theme.colors.text,\n    marginLeft: theme.spacing.sm,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n  entryTitle: {\n    fontSize: theme.typography.fontSizes.xxl,\n    fontWeight: 'bold',\n    color: theme.colors.text,\n    lineHeight: theme.typography.lineHeights.tight * theme.typography.fontSizes.xxl,\n    fontFamily: theme.typography.fontFamilies.bold,\n    letterSpacing: -0.5,\n    marginBottom: theme.spacing.lg,\n  },\n  entryText: {\n    fontSize: theme.typography.fontSizes.lg,\n    lineHeight: theme.typography.lineHeights.loose * theme.typography.fontSizes.lg,\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.regular,\n    letterSpacing: 0.3,\n  },\n  tagsSection: {\n    backgroundColor: theme.colors.card,\n    borderRadius: theme.borderRadius.xxl,\n    padding: theme.spacing.xl,\n    marginBottom: theme.spacing.xl,\n    ...theme.shadows.md,\n    borderWidth: theme.isDarkMode ? 1 : 0,\n    borderColor: theme.colors.border,\n  },\n  tagsHeader: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginBottom: theme.spacing.lg,\n    paddingBottom: theme.spacing.md,\n    borderBottomWidth: 1,\n    borderBottomColor: theme.colors.border,\n  },\n  tagsHeaderText: {\n    fontSize: theme.typography.fontSizes.lg,\n    fontWeight: '600',\n    color: theme.colors.text,\n    marginLeft: theme.spacing.sm,\n    flex: 1,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n  tagCount: {\n    backgroundColor: theme.colors.primary,\n    width: 24,\n    height: 24,\n    borderRadius: 12,\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  tagCountText: {\n    fontSize: theme.typography.fontSizes.xs,\n    color: theme.colors.white,\n    fontWeight: 'bold',\n    fontFamily: theme.typography.fontFamilies.bold,\n  },\n  tagsList: {\n    flexDirection: 'row',\n    flexWrap: 'wrap',\n    gap: theme.spacing.sm,\n  },\n  tag: {\n    backgroundColor: theme.colors.primaryLight + '20',\n    paddingHorizontal: theme.spacing.lg,\n    paddingVertical: theme.spacing.md,\n    borderRadius: theme.borderRadius.full,\n    borderWidth: 2,\n    borderColor: theme.colors.primary + '30',\n    ...theme.shadows.sm,\n  },\n  tagText: {\n    fontSize: theme.typography.fontSizes.sm,\n    color: theme.colors.primary,\n    fontWeight: '600',\n    fontFamily: theme.typography.fontFamilies.semiBold,\n    letterSpacing: 0.5,\n  },\n  statsSection: {\n    backgroundColor: theme.colors.card,\n    borderRadius: theme.borderRadius.xxl,\n    padding: theme.spacing.xl,\n    marginBottom: theme.spacing.xl,\n    ...theme.shadows.md,\n    borderWidth: theme.isDarkMode ? 1 : 0,\n    borderColor: theme.colors.border,\n  },\n  statsTitle: {\n    fontSize: theme.typography.fontSizes.lg,\n    fontWeight: '600',\n    color: theme.colors.text,\n    marginBottom: theme.spacing.lg,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n  statsGrid: {\n    flexDirection: 'row',\n    justifyContent: 'space-around',\n  },\n  statItem: {\n    alignItems: 'center',\n    flex: 1,\n  },\n  statValue: {\n    fontSize: theme.typography.fontSizes.xxl,\n    fontWeight: 'bold',\n    color: theme.colors.text,\n    marginTop: theme.spacing.sm,\n    marginBottom: theme.spacing.xs,\n    fontFamily: theme.typography.fontFamilies.bold,\n  },\n  statLabel: {\n    fontSize: theme.typography.fontSizes.sm,\n    color: theme.colors.textSecondary,\n    fontFamily: theme.typography.fontFamilies.medium,\n  },\n  floatingActions: {\n    position: 'absolute',\n    bottom: Platform.OS === 'ios' ? 100 : 85,\n    right: theme.spacing.lg,\n    flexDirection: 'column',\n    gap: theme.spacing.md,\n  },\n  fab: {\n    width: 56,\n    height: 56,\n    borderRadius: 28,\n    justifyContent: 'center',\n    alignItems: 'center',\n    ...theme.shadows.xl,\n    elevation: 8,\n  },\n  editFab: {\n    backgroundColor: theme.colors.primary,\n  },\n  deleteFab: {\n    backgroundColor: theme.colors.error,\n  },\n  // Inline edit styles\n  editModeIndicator: {\n    marginLeft: 'auto',\n    padding: theme.spacing.sm,\n    borderRadius: theme.borderRadius.md,\n    backgroundColor: theme.colors.primaryLight + '20',\n    fontSize: theme.typography.fontSizes.sm,\n    fontWeight: '600',\n    color: theme.colors.primary,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n  titleSection: {\n    marginBottom: theme.spacing.lg,\n  },\n  titleInput: {\n    fontSize: theme.typography.fontSizes.lg,\n    fontWeight: '600',\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n    backgroundColor: theme.colors.inputBackground,\n    borderRadius: theme.borderRadius.lg,\n    padding: theme.spacing.lg,\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n    minHeight: 50,\n  },\n  contentSection: {\n    marginBottom: theme.spacing.lg,\n  },\n  contentInput: {\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.regular,\n    backgroundColor: theme.colors.inputBackground,\n    borderRadius: theme.borderRadius.lg,\n    padding: theme.spacing.lg,\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n    minHeight: 150,\n    lineHeight: theme.typography.lineHeights.loose * theme.typography.fontSizes.md,\n  },\n  recordSection: {\n    alignItems: 'center',\n  },\n  recordButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: theme.colors.primary,\n    paddingVertical: theme.spacing.lg,\n    paddingHorizontal: theme.spacing.xl,\n    borderRadius: theme.borderRadius.full,\n    ...theme.shadows.md,\n  },\n  recordButtonText: {\n    color: theme.colors.white,\n    fontSize: theme.typography.fontSizes.lg,\n    fontWeight: '600',\n    marginLeft: theme.spacing.sm,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n});\n\nexport default JournalEntryDetailScreen; ","import React, { useState, useEffect } from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  TextInput,\n  TouchableOpacity,\n  ActivityIndicator,\n  Alert,\n  Platform,\n  Switch\n} from 'react-native';\nimport { useNavigation, useRoute } from '@react-navigation/native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { format, addDays, addHours, parseISO } from 'date-fns';\nimport DateTimePicker from '@react-native-community/datetimepicker';\n\nimport api from '../../services/api';\nimport SafeScrollView from '../../components/SafeScrollView';\nimport { useAppTheme } from '../../contexts/ThemeContext';\nimport { AppTheme } from '../../config/theme';\n\nconst ReminderFormScreen = () => {\n  const navigation = useNavigation();\n  const route = useRoute();\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n  const { reminderId } = route.params as { reminderId?: string };\n  \n  const [title, setTitle] = useState('');\n  const [note, setNote] = useState('');\n  const [reminderDate, setReminderDate] = useState(new Date());\n  const [isEnabled, setIsEnabled] = useState(true);\n  \n  const [isLoading, setIsLoading] = useState(false);\n  const [isFetchingReminder, setIsFetchingReminder] = useState(false);\n  \n  // Fetch reminder data if editing an existing reminder\n  useEffect(() => {\n    if (reminderId) {\n      fetchReminderData();\n    }\n  }, [reminderId]);\n  \n  const fetchReminderData = async () => {\n    try {\n      setIsFetchingReminder(true);\n      const response = await api.reminder.getReminder(reminderId as string);\n      const reminder = response.data;\n      \n      setTitle(reminder.title || '');\n      setNote(reminder.note || '');\n      setReminderDate(new Date(reminder.reminder_time));\n      setIsEnabled(reminder.is_active);\n    } catch (error) {\n      console.error('Error fetching reminder data', error);\n      Alert.alert('Error', 'Failed to load reminder data');\n    } finally {\n      setIsFetchingReminder(false);\n    }\n  };\n  \n  const handleSave = async () => {\n    // Validate form\n    if (!title.trim()) {\n      Alert.alert('Error', 'Please enter a title for your reminder');\n      return;\n    }\n    \n    try {\n      setIsLoading(true);\n      \n      const reminderData = {\n        title,\n        note,\n        reminder_time: reminderDate.toISOString(),\n        is_active: isEnabled\n      };\n      \n      if (reminderId) {\n        // Update existing reminder\n        await api.reminder.updateReminder(reminderId as string, reminderData);\n        Alert.alert('Success', 'Reminder updated successfully');\n      } else {\n        // Create new reminder\n        await api.reminder.createReminder(reminderData);\n        Alert.alert('Success', 'Reminder created successfully');\n      }\n      \n      navigation.goBack();\n    } catch (error) {\n      console.error('Error saving reminder', error);\n      Alert.alert('Error', 'Failed to save reminder');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  \n  // Date functions\n  const addOneDay = () => {\n    setReminderDate(prevDate => addDays(prevDate, 1));\n  };\n  \n  const subtractOneDay = () => {\n    setReminderDate(prevDate => addDays(prevDate, -1));\n  };\n  \n  const addOneHour = () => {\n    setReminderDate(prevDate => addHours(prevDate, 1));\n  };\n  \n  const subtractOneHour = () => {\n    setReminderDate(prevDate => addHours(prevDate, -1));\n  };\n  \n  if (isFetchingReminder) {\n    return (\n      <View style={styles.loadingContainer}>\n        <ActivityIndicator size=\"large\" color={theme.colors.primary} />\n      </View>\n    );\n  }\n  \n  return (\n    <View style={styles.container}>\n      <SafeScrollView \n        style={styles.scrollContainer}\n        contentContainerStyle={styles.scrollContent}\n        keyboardShouldPersistTaps=\"handled\"\n      >\n        <View style={styles.formGroup}>\n          <Text style={styles.label}>Title</Text>\n          <TextInput\n            style={styles.input}\n            placeholder=\"Reminder title\"\n            value={title}\n            onChangeText={setTitle}\n            placeholderTextColor={theme.colors.textSecondary}\n          />\n        </View>\n        \n        <View style={styles.formGroup}>\n          <Text style={styles.label}>Note</Text>\n          <TextInput\n            style={styles.textArea}\n            multiline\n            numberOfLines={4}\n            placeholder=\"Add a note (optional)\"\n            value={note}\n            onChangeText={setNote}\n            textAlignVertical=\"top\"\n            placeholderTextColor={theme.colors.textSecondary}\n          />\n        </View>\n        \n        <View style={styles.formGroup}>\n          <Text style={styles.label}>Reminder Date & Time</Text>\n          \n          <View style={styles.dateDisplayContainer}>\n            <Text style={styles.dateText}>\n              {format(reminderDate, 'EEEE, MMMM d, yyyy')}\n            </Text>\n            <Text style={styles.timeText}>\n              {format(reminderDate, 'h:mm a')}\n            </Text>\n          </View>\n          \n          <View style={styles.dateControlsContainer}>\n            <View style={styles.dateControls}>\n              <TouchableOpacity\n                style={styles.controlButton}\n                onPress={subtractOneDay}\n              >\n                <Ionicons name=\"remove\" size={theme.typography.fontSizes.xl} color={theme.colors.textSecondary} />\n              </TouchableOpacity>\n              \n              <Text style={styles.controlLabel}>Date</Text>\n              \n              <TouchableOpacity\n                style={styles.controlButton}\n                onPress={addOneDay}\n              >\n                <Ionicons name=\"add\" size={theme.typography.fontSizes.xl} color={theme.colors.textSecondary} />\n              </TouchableOpacity>\n            </View>\n            \n            <View style={styles.dateControls}>\n              <TouchableOpacity\n                style={styles.controlButton}\n                onPress={subtractOneHour}\n              >\n                <Ionicons name=\"remove\" size={theme.typography.fontSizes.xl} color={theme.colors.textSecondary} />\n              </TouchableOpacity>\n              \n              <Text style={styles.controlLabel}>Time</Text>\n              \n              <TouchableOpacity\n                style={styles.controlButton}\n                onPress={addOneHour}\n              >\n                <Ionicons name=\"add\" size={theme.typography.fontSizes.xl} color={theme.colors.textSecondary} />\n              </TouchableOpacity>\n            </View>\n          </View>\n        </View>\n        \n        <View style={styles.switchContainer}>\n          <Text style={styles.label}>Enable Reminder</Text>\n          <Switch\n            trackColor={{ false: theme.colors.gray300, true: theme.colors.primary }}\n            thumbColor={isEnabled ? (theme.isDarkMode ? theme.colors.background : theme.colors.white) : theme.colors.gray100}\n            ios_backgroundColor={theme.colors.gray300}\n            onValueChange={setIsEnabled}\n            value={isEnabled}\n          />\n        </View>\n      </SafeScrollView>\n      \n      <View style={styles.buttonContainer}>\n        <TouchableOpacity\n          style={[styles.button, styles.cancelButton]}\n          onPress={() => navigation.goBack()}\n          disabled={isLoading}\n        >\n          <Text style={styles.cancelButtonText}>Cancel</Text>\n        </TouchableOpacity>\n        \n        <TouchableOpacity\n          style={[\n            styles.button, \n            styles.saveButton,\n            isLoading && styles.disabledButton\n          ]}\n          onPress={handleSave}\n          disabled={isLoading}\n        >\n          {isLoading ? (\n            <ActivityIndicator size=\"small\" color={theme.isDarkMode ? theme.colors.background : theme.colors.white} />\n          ) : (\n            <Text style={styles.saveButtonText}>Save</Text>\n          )}\n        </TouchableOpacity>\n      </View>\n    </View>\n  );\n};\n\n// Function to generate styles based on the theme\nconst getStyles = (theme: AppTheme) => StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: theme.colors.background,\n  },\n  loadingContainer: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n    backgroundColor: theme.colors.background,\n  },\n  scrollContainer: {\n    flex: 1,\n    paddingBottom: theme.spacing.md,\n  },\n  scrollContent: {\n    padding: theme.spacing.lg,\n  },\n  formGroup: {\n    marginBottom: theme.spacing.lg,\n  },\n  label: {\n    fontSize: theme.typography.fontSizes.md,\n    fontWeight: 'bold',\n    color: theme.colors.text,\n    marginBottom: theme.spacing.sm,\n    fontFamily: theme.typography.fontFamilies.bold,\n  },\n  input: {\n    backgroundColor: theme.isDarkMode ? theme.colors.gray800 : theme.colors.white,\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n    borderRadius: 5,\n    paddingHorizontal: theme.spacing.md,\n    paddingVertical: theme.spacing.sm,\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  textArea: {\n    backgroundColor: theme.isDarkMode ? theme.colors.gray800 : theme.colors.white,\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n    borderRadius: 5,\n    padding: theme.spacing.md,\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.text,\n    minHeight: 100,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  dateDisplayContainer: {\n    backgroundColor: theme.isDarkMode ? theme.colors.gray700 : theme.colors.gray100,\n    padding: theme.spacing.md,\n    borderRadius: 5,\n    marginBottom: theme.spacing.md,\n    alignItems: 'center',\n  },\n  dateText: {\n    fontSize: theme.typography.fontSizes.lg,\n    fontWeight: 'bold',\n    color: theme.colors.text,\n    fontFamily: theme.typography.fontFamilies.bold,\n  },\n  timeText: {\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.textSecondary,\n    marginTop: theme.spacing.xs,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  dateControlsContainer: {\n    flexDirection: 'row',\n    justifyContent: 'space-around',\n    marginBottom: theme.spacing.md,\n  },\n  dateControls: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: theme.isDarkMode ? theme.colors.gray700 : theme.colors.gray100,\n    padding: theme.spacing.sm,\n    borderRadius: 5,\n  },\n  controlButton: {\n    padding: theme.spacing.sm,\n  },\n  controlLabel: {\n    fontSize: theme.typography.fontSizes.sm,\n    color: theme.colors.text,\n    marginHorizontal: theme.spacing.sm,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n  switchContainer: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    paddingVertical: theme.spacing.md,\n    borderTopWidth: 1,\n    borderBottomWidth: 1,\n    borderColor: theme.colors.border,\n    marginTop: theme.spacing.md,\n    marginBottom: theme.spacing.lg,\n    paddingHorizontal: theme.spacing.xs,\n  },\n  buttonContainer: {\n    flexDirection: 'row',\n    justifyContent: 'space-around',\n    paddingVertical: theme.spacing.md,\n    paddingHorizontal: theme.spacing.lg,\n    borderTopWidth: 1,\n    borderTopColor: theme.colors.border,\n    backgroundColor: theme.colors.background,\n  },\n  button: {\n    borderRadius: 5,\n    paddingVertical: theme.spacing.md,\n    paddingHorizontal: theme.spacing.xl,\n    alignItems: 'center',\n    justifyContent: 'center',\n    minWidth: 120,\n  },\n  saveButton: {\n    backgroundColor: theme.colors.primary,\n  },\n  saveButtonText: {\n    color: theme.isDarkMode ? theme.colors.background : theme.colors.white,\n    fontSize: theme.typography.fontSizes.md,\n    fontWeight: 'bold',\n    fontFamily: theme.typography.fontFamilies.bold,\n  },\n  cancelButton: {\n    backgroundColor: theme.colors.gray200,\n  },\n  cancelButtonText: {\n    color: theme.isDarkMode ? theme.colors.text : theme.colors.textSecondary,\n    fontSize: theme.typography.fontSizes.md,\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n  disabledButton: {\n    backgroundColor: theme.colors.disabled,\n  },\n});\n\nexport default ReminderFormScreen; ","import React, { useState } from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  TouchableOpacity,\n  SafeAreaView,\n  ActivityIndicator,\n} from 'react-native';\nimport { useNavigation, useRoute, RouteProp } from '@react-navigation/native';\nimport { StackNavigationProp } from '@react-navigation/stack';\nimport { Ionicons } from '@expo/vector-icons';\n\nimport { JournalAPI } from '../../services/api';\nimport { MainStackParamList } from '../../navigation/types';\nimport { useAppTheme } from '../../contexts/ThemeContext';\nimport { AppTheme } from '../../config/theme';\nimport hapticService from '../../services/hapticService';\n\ntype DeleteConfirmationRouteProp = RouteProp<MainStackParamList, 'DeleteConfirmation'>;\ntype DeleteConfirmationNavigationProp = StackNavigationProp<MainStackParamList, 'DeleteConfirmation'>;\n\nconst DeleteConfirmationScreen = () => {\n  const navigation = useNavigation<DeleteConfirmationNavigationProp>();\n  const route = useRoute<DeleteConfirmationRouteProp>();\n  const { theme } = useAppTheme();\n  const styles = getStyles(theme);\n  const { entryId } = route.params;\n  const [isDeleting, setIsDeleting] = useState(false);\n\n  const handleCancel = () => {\n    hapticService.light();\n    navigation.goBack();\n  };\n\n  const handleConfirmDelete = async () => {\n    if (isDeleting) return; // Prevent double-clicking\n    \n    try {\n      setIsDeleting(true);\n      hapticService.medium(); // Strong feedback for destructive action\n      console.log(`[DeleteConfirmation] Deleting entry with ID: ${entryId}`);\n      await JournalAPI.deleteEntry(String(entryId));\n      console.log('[DeleteConfirmation] Delete successful');\n      \n      hapticService.success(); // Success feedback\n      // Navigate back to the main tabs and then to Journal tab\n      navigation.navigate('MainTabs', {\n        screen: 'Journal',\n        params: { screen: 'JournalList' }\n      });\n    } catch (error) {\n      console.error('[DeleteConfirmation] Error deleting entry:', error);\n      // If entry was already deleted (404), treat as success\n      if (error && typeof error === 'object' && 'status' in error && error.status === 404) {\n        console.log('[DeleteConfirmation] Entry already deleted, treating as success');\n        hapticService.success(); // Success feedback for already deleted\n        navigation.navigate('MainTabs', {\n          screen: 'Journal',\n          params: { screen: 'JournalList' }\n        });\n      } else {\n        hapticService.error(); // Error feedback\n        // For other errors, go back to previous screen\n        navigation.goBack();\n      }\n    } finally {\n      setIsDeleting(false);\n    }\n  };\n\n  return (\n    <SafeAreaView style={styles.container}>\n      <View style={styles.content}>\n        <View style={styles.iconContainer}>\n          <Ionicons \n            name=\"trash-outline\" \n            size={theme.spacing.xxl * 2} \n            color={theme.colors.error} \n          />\n        </View>\n        \n        <Text style={styles.title}>Delete Journal Entry</Text>\n        \n        <Text style={styles.message}>\n          Are you sure you want to delete this journal entry? This action cannot be undone.\n        </Text>\n        \n        <View style={styles.buttonContainer}>\n          <TouchableOpacity \n            style={[styles.button, styles.cancelButton, isDeleting && { opacity: 0.5 }]}\n            onPress={handleCancel}\n            disabled={isDeleting}\n          >\n            <Text style={styles.cancelButtonText}>Cancel</Text>\n          </TouchableOpacity>\n          \n          <TouchableOpacity \n            style={[styles.button, styles.deleteButton, isDeleting && { opacity: 0.7 }]}\n            onPress={handleConfirmDelete}\n            disabled={isDeleting}\n          >\n            {isDeleting ? (\n              <ActivityIndicator size=\"small\" color={theme.colors.white} />\n            ) : (\n              <Text style={styles.deleteButtonText}>Delete</Text>\n            )}\n          </TouchableOpacity>\n        </View>\n      </View>\n    </SafeAreaView>\n  );\n};\n\nconst getStyles = (theme: AppTheme) => StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: theme.colors.background,\n  },\n  content: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n    paddingHorizontal: theme.spacing.xl,\n  },\n  iconContainer: {\n    width: theme.spacing.xxl * 3,\n    height: theme.spacing.xxl * 3,\n    borderRadius: theme.spacing.xxl * 1.5,\n    backgroundColor: theme.colors.error + '20',\n    justifyContent: 'center',\n    alignItems: 'center',\n    marginBottom: theme.spacing.xl,\n  },\n  title: {\n    fontSize: theme.typography.fontSizes.xxl,\n    fontWeight: 'bold',\n    color: theme.colors.text,\n    marginBottom: theme.spacing.md,\n    textAlign: 'center',\n    fontFamily: theme.typography.fontFamilies.bold,\n  },\n  message: {\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.textSecondary,\n    textAlign: 'center',\n    lineHeight: theme.typography.lineHeights.normal * theme.typography.fontSizes.md,\n    marginBottom: theme.spacing.xxl,\n    fontFamily: theme.typography.fontFamilies.regular,\n  },\n  buttonContainer: {\n    flexDirection: 'row',\n    width: '100%',\n    gap: theme.spacing.md,\n  },\n  button: {\n    flex: 1,\n    paddingVertical: theme.spacing.lg,\n    borderRadius: 12,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  cancelButton: {\n    backgroundColor: theme.colors.card,\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n  },\n  deleteButton: {\n    backgroundColor: theme.colors.error,\n  },\n  cancelButtonText: {\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.text,\n    fontWeight: '600',\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n  deleteButtonText: {\n    fontSize: theme.typography.fontSizes.md,\n    color: theme.colors.white,\n    fontWeight: '600',\n    fontFamily: theme.typography.fontFamilies.semiBold,\n  },\n});\n\nexport default DeleteConfirmationScreen; ","import React from 'react';\nimport { createStackNavigator } from '@react-navigation/stack';\nimport MainTabNavigator from './MainTabNavigator';\nimport RecordScreen from '../screens/main/RecordScreen';\nimport TagManagementScreen from '../screens/main/TagManagementScreen';\nimport { areSecretTagsEnabled } from '../config/featureFlags';\nimport TagDeleteConfirmationScreen from '../screens/main/TagDeleteConfirmationScreen';\nimport JournalEntryDetailScreen from '../screens/main/JournalEntryDetailScreen';\n\nimport ReminderFormScreen from '../screens/main/ReminderFormScreen';\nimport DeleteConfirmationScreen from '../screens/main/DeleteConfirmationScreen';\nimport { MainStackParamList } from './types';\n\nconst Stack = createStackNavigator<MainStackParamList>();\n\nconst MainNavigator = () => {\n  return (\n    <Stack.Navigator\n      screenOptions={{\n        headerShown: false,\n      }}\n    >\n      <Stack.Screen \n        name=\"MainTabs\" \n        component={MainTabNavigator}\n        options={{ headerShown: false }}\n      />\n      <Stack.Screen\n        name=\"Record\"\n        component={RecordScreen}\n        options={{\n          presentation: 'modal',\n          headerShown: false,\n        }}\n      />\n      {areSecretTagsEnabled() && (\n        <Stack.Screen\n          name=\"TagManagement\"\n          component={TagManagementScreen}\n          options={{\n            presentation: 'modal',\n            headerShown: false,\n          }}\n        />\n      )}\n      <Stack.Screen\n        name=\"TagDeleteConfirmation\"\n        component={TagDeleteConfirmationScreen}\n        options={{\n          presentation: 'modal',\n          headerShown: false,\n        }}\n      />\n      <Stack.Screen\n        name=\"JournalEntryDetail\"\n        component={JournalEntryDetailScreen}\n        options={{\n          headerShown: false, // Custom header in component\n        }}\n      />\n\n      <Stack.Screen\n        name=\"ReminderForm\"\n        component={ReminderFormScreen}\n        options={{\n          headerShown: true,\n          title: 'Reminder',\n          headerStyle: { backgroundColor: '#f8f9fa' },\n          headerTintColor: '#333',\n        }}\n      />\n      <Stack.Screen\n        name=\"DeleteConfirmation\"\n        component={DeleteConfirmationScreen}\n        options={{\n          presentation: 'modal',\n          headerShown: true,\n          title: 'Delete Entry',\n          headerStyle: { backgroundColor: '#f8f9fa' },\n          headerTintColor: '#333',\n        }}\n      />\n    </Stack.Navigator>\n  );\n};\n\nexport default MainNavigator; ","import React, { useEffect } from 'react';\nimport { createStackNavigator } from '@react-navigation/stack';\nimport { View, Text, ActivityIndicator, StyleSheet, Platform } from 'react-native';\n\nimport { useAuth } from '../contexts/AuthContext';\nimport { RootStackParamList } from './types';\nimport logger from '../utils/logger';\n\n// Stack Navigation\nimport AuthNavigator from './AuthNavigator';\nimport MainNavigator from './MainNavigator';\n\nconst Stack = createStackNavigator<RootStackParamList>();\n\nconst Navigation = () => {\n  const { isAuthenticated, isLoading, isInitialLoading, user } = useAuth();\n  \n  // Log navigation state for debugging\n  // console.log('[Navigation/index] Rendering - isAuthenticated:', isAuthenticated, 'isLoading:', isLoading); // Removed diagnostic log\n  useEffect(() => {\n    // Keep logger.info for general state overview\n    logger.info('Navigation state:', { \n      isLoading,\n      isInitialLoading,\n      isAuthenticated,\n      userExists: !!user,\n      platform: Platform.OS,\n      isDev: __DEV__\n    });\n  }, [isLoading, isInitialLoading, isAuthenticated, user]);\n\n  // Only show loading indicator for initial auth check, not for auth operations\n  if (isInitialLoading) {\n    return (\n      <View style={styles.container}>\n        <ActivityIndicator size=\"large\" color=\"#7D4CDB\" />\n        <Text style={styles.loadingText}>Loading...</Text>\n      </View>\n    );\n  }\n\n  return (\n    <Stack.Navigator screenOptions={{ headerShown: false }}>\n      {isAuthenticated ? (\n        // User is signed in\n        <Stack.Screen name=\"Main\" component={MainNavigator} />\n      ) : (\n        // User is not signed in\n        <Stack.Screen name=\"Auth\" component={AuthNavigator} />\n      )}\n    </Stack.Navigator>\n  );\n};\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n    backgroundColor: '#f8f9fa',\n  },\n  loadingText: {\n    marginTop: 10,\n    fontSize: 16,\n    color: '#333',\n  }\n});\n\nexport default Navigation; ","import React, { useEffect, useState, ReactNode } from 'react';\nimport { StatusBar, StatusBarStyle } from 'expo-status-bar';\nimport { SafeAreaProvider } from 'react-native-safe-area-context';\nimport { NavigationContainer } from '@react-navigation/native';\nimport { GestureHandlerRootView } from 'react-native-gesture-handler';\nimport { LogBox, View, Text, StyleSheet, Platform } from 'react-native';\nimport Constants from 'expo-constants';\n\nimport { AuthProvider } from './src/contexts/AuthContext';\nimport Navigation from './src/navigation';\nimport logger from './src/utils/logger';\nimport { ThemeProvider, useAppTheme } from './src/contexts/ThemeContext';\nimport { SettingsProvider } from './src/contexts/SettingsContext';\nimport { HiddenModeProvider } from './src/contexts/HiddenModeContext';\n// import { initializeAppInsights } from './src/services/appInsights'; // Commented out to fix linter error\n\ninterface ErrorBoundaryProps {\n  children: ReactNode;\n}\n\ninterface ErrorBoundaryState {\n  hasError: boolean;\n  error: Error | null;\n}\n\n// Error boundary component\nclass ErrorBoundary extends React.Component<ErrorBoundaryProps, ErrorBoundaryState> {\n  state: ErrorBoundaryState = { hasError: false, error: null };\n\n  static getDerivedStateFromError(error: Error): ErrorBoundaryState {\n    return { hasError: true, error };\n  }\n\n  componentDidCatch(error: Error, errorInfo: React.ErrorInfo): void {\n    logger.error('App error boundary caught error:', { error, errorInfo });\n  }\n\n  render(): React.ReactNode {\n    if (this.state.hasError) {\n      return (\n        <View style={styles.errorContainer}>\n          <Text style={styles.errorTitle}>Something went wrong!</Text>\n          <Text style={styles.errorMessage}>\n            {this.state.error?.toString() || 'An unexpected error occurred.'}\n          </Text>\n          <Text style={styles.errorHint}>Please reload the application.</Text>\n        </View>\n      );\n    }\n\n    return this.props.children;\n  }\n}\n\n// Ignore specific warnings\nLogBox.ignoreLogs([\n  'AsyncStorage has been extracted from react-native',\n  'Possible Unhandled Promise Rejection',\n  'Require cycle:',\n  // Add any other warnings you want to suppress\n]);\n\n// This component will now use the theme context\nconst AppContent = () => {\n  const { theme } = useAppTheme(); // Get theme from context\n  const [isInitialized, setIsInitialized] = useState(false);\n\n  useEffect(() => {\n    const initializeApp = async () => {\n      try {\n        if (__DEV__) {\n          logger.info('Running in development mode', {\n            platform: Platform.OS,\n            version: Platform.Version,\n            constants: Constants.expoConfig?.extra\n          });\n        }\n        \n        logger.info('App initialization completed');\n        \n        setIsInitialized(true);\n      } catch (error) {\n        logger.error('Failed to initialize app:', error);\n        // Still set initialized to true to avoid infinite loading\n        setIsInitialized(true);\n      }\n    };\n\n    initializeApp();\n  }, []);\n\n  // Map theme.colors.statusBar to StatusBarStyle\n  let statusBarStyle: StatusBarStyle = 'auto';\n  if (theme.colors.statusBar === 'dark-content') {\n    statusBarStyle = 'dark';\n  } else if (theme.colors.statusBar === 'light-content') {\n    statusBarStyle = 'light';\n  }\n\n  if (!isInitialized) {\n    // Use StyleSheet for initial loading to avoid theme dependency before provider\n    const initialStyles = StyleSheet.create({\n        loadingContainer: {\n            flex: 1,\n            justifyContent: 'center',\n            alignItems: 'center',\n            backgroundColor: '#FFFFFF', // Default light background before theme loads\n        }\n    });\n    return (\n      <View style={initialStyles.loadingContainer}>\n        <Text>Initializing app...</Text>\n      </View>\n    );\n  }\n\n  return (\n    <SafeAreaProvider>\n      <AuthProvider>\n        <ThemeProvider>\n          <SettingsProvider>\n            <HiddenModeProvider>\n              <NavigationContainer\n                onStateChange={() => {\n                  if (__DEV__) {\n                    logger.debug('Navigation state changed');\n                  }\n                }}\n                fallback={\n                  // Use StyleSheet for initial loading\n                  <View style={styles.loadingContainer}> \n                    <Text>Loading navigation...</Text>\n                  </View>\n                }\n              >\n                <Navigation />\n                <StatusBar style={statusBarStyle} /> {/* Use mapped style */}\n              </NavigationContainer>\n            </HiddenModeProvider>\n          </SettingsProvider>\n        </ThemeProvider>\n      </AuthProvider>\n    </SafeAreaProvider>\n  );\n};\n\nexport default function App() {\n  // initializeAppInsights(); // Commented out\n\n  return (\n    <ErrorBoundary>\n      <GestureHandlerRootView style={{ flex: 1 }}>\n        <ThemeProvider>\n          <SettingsProvider>\n            <HiddenModeProvider>\n              <AppContent />\n            </HiddenModeProvider>\n          </SettingsProvider>\n        </ThemeProvider>\n      </GestureHandlerRootView>\n    </ErrorBoundary>\n  );\n}\n\n// styles in App.tsx can remain for ErrorBoundary or truly global styles not covered by theme provider initially\nconst styles = StyleSheet.create({\n  loadingContainer: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n    // backgroundColor will be set by theme once AppContent loads,\n    // or use a default like in AppContent's initial loading state.\n  },\n  errorContainer: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n    padding: 20,\n    backgroundColor: '#f8f9fa', // This could also become theme.colors.background if ErrorBoundary is themed\n  },\n  errorTitle: {\n    fontSize: 24,\n    fontWeight: 'bold',\n    color: '#e74c3c', // This could also become theme.colors.error\n    marginBottom: 16,\n  },\n  errorMessage: {\n    fontSize: 16,\n    color: '#333',\n    marginBottom: 16,\n    textAlign: 'center',\n  },\n  errorHint: {\n    fontSize: 14,\n    color: '#666',\n  },\n});","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar [chunkIds, fn, priority] = deferred[i];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","var getProto = Object.getPrototypeOf ? (obj) => (Object.getPrototypeOf(obj)) : (obj) => (obj.__proto__);\nvar leafPrototypes;\n// create a fake namespace object\n// mode & 1: value is a module id, require it\n// mode & 2: merge all properties of value into the ns\n// mode & 4: return value when already ns object\n// mode & 16: return value when it's Promise-like\n// mode & 8|1: behave like require\n__webpack_require__.t = function(value, mode) {\n\tif(mode & 1) value = this(value);\n\tif(mode & 8) return value;\n\tif(typeof value === 'object' && value) {\n\t\tif((mode & 4) && value.__esModule) return value;\n\t\tif((mode & 16) && typeof value.then === 'function') return value;\n\t}\n\tvar ns = Object.create(null);\n\t__webpack_require__.r(ns);\n\tvar def = {};\n\tleafPrototypes = leafPrototypes || [null, getProto({}), getProto([]), getProto(getProto)];\n\tfor(var current = mode & 2 && value; typeof current == 'object' && !~leafPrototypes.indexOf(current); current = getProto(current)) {\n\t\tObject.getOwnPropertyNames(current).forEach((key) => (def[key] = () => (value[key])));\n\t}\n\tdef['default'] = () => (value);\n\t__webpack_require__.d(ns, def);\n\treturn ns;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.hmd = (module) => {\n\tmodule = Object.create(module);\n\tif (!module.children) module.children = [];\n\tObject.defineProperty(module, 'exports', {\n\t\tenumerable: true,\n\t\tset: () => {\n\t\t\tthrow new Error('ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: ' + module.id);\n\t\t}\n\t});\n\treturn module;\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.nmd = (module) => {\n\tmodule.paths = [];\n\tif (!module.children) module.children = [];\n\treturn module;\n};","__webpack_require__.p = \"/\";","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t792: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = (chunkId) => (installedChunks[chunkId] === 0);\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some((id) => (installedChunks[id] !== 0))) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkweb\"] = self[\"webpackChunkweb\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [483], () => (__webpack_require__(5036)))\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["logger","_createClass","Logger","_classCallCheck","enabled","this","isWeb","Platform","OS","logDirectory","FileSystem","documentDirectory","logFilePath","isDev","__DEV__","debugEnabled","suppressedWarnings","Set","initializeLogger","key","value","_initializeLogger","_asyncToGenerator","console","log","setupConsoleOverrides","getInfoAsync","exists","makeDirectoryAsync","intermediates","writeAsStringAsync","fileStatus","size","error","apply","arguments","_this","originalWarn","warn","_len","length","args","Array","_key","message","join","suppressedWarning","includes","Date","toISOString","_writeToFile","level","data","logEntry","getTimestamp","toUpperCase","JSON","stringify","encoding","UTF8","Error","code","_x","_x2","_x3","shouldLog","undefined","debug","writeToFile","info","shouldSuppressMessage","_getLogs","readAsStringAsync","warning","add","delete","api","axios","create","baseURL","headers","timeout","withCredentials","defaultHeaders","defaults","e","interceptors","request","use","_ref","config","_config$method","method","toLowerCase","url","Promise","reject","_ref2","_config$method2","_config$method3","token","AsyncStorage","getItem","Authorization","FormData","response","_response$config$meth","status","_ref3","_error$response","_error$response2","_error$response3","_error$response4","_error$response5","_error$response6","_error$response6$data","_error$response7","_error$response7$data","_error$response8","_error$response8$data","_error$response9","_error$response10","originalRequest","originalError","_retry","refreshToken","accessToken","logout","substring","post","getApiUrl","refresh_token","access_token","setItem","newAccessToken","common","retryConfig","_objectSpread","refreshError","_refreshError$respons","_refreshError$respons2","responseData","errors","isArray","detail","errorMessage","_ref4","removeItem","JournalAPI","getEntries","params","get","getEntry","id","createEntry","createEncryptedEntry","title","content","encrypted_content","encryption_iv","iv","encryption_salt","salt","encrypted_key","key_derivation_iterations","encryption_algorithm","algorithm","encryption_wrap_iv","wrapIv","entry_date","audio_url","tags","secret_tag_id","secret_tag_hash","updateEntry","put","deleteEntry","searchEntries","query","q","getEntriesBySecretTag","secretTagHash","ReminderAPI","getReminders","getReminder","createReminder","updateReminder","deleteReminder","TagsAPI","getTags","getRecentTags","limit","getEntriesByTag","tagName","createTag","_createTag","tag","_x4","updateTag","_updateTag","updates","_x5","_x6","deleteTag","_deleteTag","_x7","opaqueReady","ensureOpaqueReady","_ensureOpaqueReady","opaque","STORAGE_KEYS","OpaqueAuthService","_startRegistration","password","userIdentifier","_opaque$client$startR","startRegistration","clientRegistrationState","registrationRequest","registrationRequestLength","clientRegistrationStateLength","_finishRegistration","registrationResponse","storedState","_JSON$parse","parse","registrationResponseLength","passwordLength","registrationRecord","finishRegistration","_startLogin","result","startLogin","clientLoginState","startLoginRequest","startLoginRequestLength","clientLoginStateLength","loginRequest","_finishLogin","loginResponse","_JSON$parse2","loginResponseLength","loginResult","finishLogin","success","resultType","resultKeys","Object","keys","finishLoginRequest","sessionKey","exportKey","_x8","_register","name","email","opaque_registration_request","opaque_registration_response","session_id","opaque_registration_record","registrationRecordLength","registrationRecordSample","_x9","_x10","_x11","_login","_loginResponse$data","_finishResponse$data","startResult","client_credential_request","server_credential_response","sessionResult","finishResponse","client_credential_finalization","user","_x12","_x13","_hasRegistrationRecord","_getUserIdentifier","_clearOpaqueData","multiRemove","tempKeys","getAllKeys","filter","startsWith","instance","opaqueAuth","getInstance","KEY_DERIVATION_INFO","opaqueKeyManager","OpaqueKeyManager","derivedKeys","Map","normalized","replace","padLen","padded","repeat","binary","atob","bytes","Uint8Array","i","charCodeAt","_this$sessionKey","_this$sessionKey$cons","_this$exportKey","_this$exportKey$const","decodeBase64ToBytes","clear","sessionKeyType","sessionKeyConstructor","constructor","exportKeyType","exportKeyConstructor","_deriveTagIdKey","cacheKey","from","has","tagIdKey","deriveKey","set","_deriveEncryptionKey","encryptionKey","_deriveVaultKey","vaultKey","fill","values","_deriveKey","ikm","crypto","subtle","importKey","derivedBits","deriveBits","hash","TextEncoder","encode","AuthContext","createContext","AuthProvider","children","_useState","useState","_useState2","_slicedToArray","isAuthenticated","setIsAuthenticated","_useState3","_useState4","isLoading","setIsLoading","_useState5","_useState6","isInitialLoading","setIsInitialLoading","_useState7","_useState8","setUser","useEffect","checkAuthStatus","storedUser","storedSessionKey","storedExportKey","userData","userId","parseError","initialize","rehydrateError","clearOpaqueData","updateUser","updatedUserData","newUser","opaqueLogin","_ref5","login","created_at","updated_at","opaqueRegister","_ref6","register","hasOpaqueSupport","_ref7","_jsx","Provider","useAuth","context","useContext","lightModeColors","primary","primaryLight","primaryDark","secondary","secondaryLight","background","surface","card","text","textSecondary","textDisabled","border","borderLight","notification","errorLight","successLight","warningLight","disabled","inputBackground","statusBar","shadow","onPrimary","onSurface","overlay","accent","accentLight","tabBarActive","tabBarInactive","black","white","gray50","gray100","gray200","gray300","gray400","gray500","gray600","gray700","gray800","gray900","skeleton","skeletonHighlight","darkModeColors","typography","fontFamilies","regular","medium","semiBold","bold","light","fontSizes","xs","sm","md","lg","xl","xxl","xxxl","display","lineHeights","tight","normal","loose","letterSpacing","wide","spacing","none","borderRadius","full","shadows","shadowColor","shadowOffset","width","height","shadowOpacity","shadowRadius","elevation","animations","duration","fast","slow","easing","ease","easeIn","easeOut","easeInOut","ThemeContext","ThemeProvider","systemColorScheme","Appearance","getColorScheme","isDarkMode","setIsDarkMode","useSystemTheme","setUseSystemThemeState","loadThemePreference","savedThemeMode","subscription","addChangeListener","colorScheme","remove","toggleTheme","newIsDarkMode","setUseSystemTheme","theme","colors","isSystemTheme","useAppTheme","SafeScrollView","forwardRef","ref","_ref$extraBottomPaddi","extraBottomPadding","contentContainerStyle","props","_objectWithoutProperties","_excluded","tabBarHeight","fabBottomMargin","extraSpacing","safeContentContainerStyle","paddingBottom","Math","max","fabHeight","ScrollView","showsVerticalScrollIndicator","keyboardShouldPersistTaps","scrollEventThrottle","displayName","styles","StyleSheet","container","flex","backgroundColor","paddingTop","Constants","statusBarHeight","header","flexDirection","alignItems","justifyContent","padding","borderBottomWidth","borderBottomColor","fontSize","fontWeight","color","closeButton","refreshButton","filterContainer","filterButton","paddingVertical","paddingHorizontal","marginHorizontal","activeFilter","filterText","activeFilterText","loadingContainer","loadingText","marginTop","logsContainer","logs","fontFamily","select","ios","android","default","webNotice","marginBottom","textAlign","codeBlock","footer","borderTopWidth","borderTopColor","clearButton","clearButtonText","visible","onClose","setLogs","loading","setLoading","setFilter","fetchLogs","logData","getLogs","filteredLogs","split","line","upperFilter","clearLogs","Modal","animationType","transparent","onRequestClose","_jsxs","SafeAreaView","style","View","TouchableOpacity","onPress","Ionicons","Text","ActivityIndicator","getStyles","button","minHeight","enabledButton","disabledButton","checkingButton","buttonText","marginLeft","disabledText","mode","confirmPassword","onSuccess","onError","_ref$disabled","_useAuth","authLoading","opaqueSupported","setOpaqueSupported","checkingSupport","setCheckingSupport","checkSupport","supported","handleAuth","trim","trimmedEmail","test","errorMsg","isButtonDisabled","WebBrowser","maybeCompleteAuthSession","scrollContainer","scrollContent","flexGrow","welcomeCard","borderColor","borderWidth","logoContainer","logoCircle","appName","tagline","formCard","formHeader","formTitle","formSubtitle","errorContainer","errorText","inputContainer","inputWrapper","inputIcon","marginRight","input","eyeIcon","loginButton","dividerContainer","marginVertical","dividerLine","dividerText","googleButton","googleButtonText","registerCard","registerText","registerButton","registerButtonText","debugButton","alignSelf","debugButtonText","navigation","useNavigation","setEmail","setPassword","showPassword","setShowPassword","_useState9","_useState10","setErrorMessage","_useState11","_useState12","showLogViewer","setShowLogViewer","handleGoogleLogin","TextInput","placeholder","onChangeText","keyboardType","autoCapitalize","autoCorrect","placeholderTextColor","secureTextEntry","OpaqueAuthButton","navigate","screen","LogViewer","headerContainer","backButton","successContainer","successText","successTextContainer","signInLinkContainer","signInLinkText","passwordRequirements","requirementsTitle","requirementItem","requirementText","loginCard","loginText","loginButtonText","setName","setConfirmPassword","_useState13","_useState14","_useState15","_useState16","successMessage","setSuccessMessage","handleGoogleRegister","navigateToLogin","Stack","createStackNavigator","Navigator","initialRouteName","screenOptions","headerShown","Screen","component","LoginScreen","RegisterScreen","AudioPrewarmService","state","permissionsGranted","audioModeConfigured","isPrewarmed","lastPrewarmTime","prewarmPromise","_prewarmAudioSystem","now","performPrewarm","_performPrewarm","startTime","prewarmPermissions","prewarmAudioMode","_prewarmPermissions","Audio","granted","_prewarmAudioMode","setAudioModeAsync","allowsRecordingIOS","playsInSilentModeIOS","shouldDuckAndroid","playThroughEarpieceAndroid","staysActiveInBackground","_refreshPrewarm","prewarmAudioSystem","timeSinceLastPrewarm","readyForRecording","isReadyForRecording","SUPPORTED_LANGUAGES","region","validateLanguageCode","languageCode","some","lang","DEFAULT_SETTINGS","defaultLanguage","defaultEntryPrivacy","hiddenModeEnabled","hapticFeedbackEnabled","notificationsEnabled","reminderNotifications","dailyReminderTime","analyticsEnabled","crashReportsEnabled","autoSaveEnabled","autoRecordingEnabled","SETTINGS_STORAGE_KEY","SettingsService","settings","initialized","listeners","_initialize","storedSettings","parsed","settingsToValidate","validateSettings","saveSettings","err","String","_updateSetting","validatedValue","validateSingleSetting","_defineProperty","notifyListeners","_updateSettings","validatedUpdates","_resetToDefaults","_exportSettings","exportData","version","timestamp","_importSettings","jsonData","imported","validatedSettings","updateSettings","listener","currentKeys","newSettings","hasNewSettings","_saveSettings","settingsData","validated","entries","defaultValue","_this2","forEach","getSettings","HapticFeedbackType","HapticService","expoHaptics","Haptics","require","_isHapticEnabled","settingsService","_impact","type","ImpactMedium","isHapticEnabled","triggerExpoHaptic","triggerVibrationFallback","_triggerExpoHaptic","Selection","selectionAsync","ImpactLight","impactAsync","ImpactFeedbackStyle","Light","Medium","ImpactHeavy","Heavy","NotificationSuccess","notificationAsync","NotificationFeedbackType","Success","NotificationWarning","Warning","NotificationError","Vibration","vibrate","_selection","impact","_light","_medium","_heavy","_success","_warning","_error","useNativeDriver","variant","variantColors","getVariantColors","position","shadowContainer","overflow","touchable","opacity","icon","_ref$icon","_ref$size","_ref$variant","_ref$testID","testID","scaleAnim","useRef","Animated","Value","current","pulseAnim","rotateAnim","pulse","loop","sequence","timing","toValue","start","stop","rotation","interpolate","inputRange","outputRange","transform","scale","rotate","onPressIn","hapticService","parallel","spring","onPressOut","tension","friction","activeOpacity","ClientEncryptionService","_getUserSalt","saltBase64","localStorage","USER_SALT_KEY","binaryString","newSalt","getRandomValues","SALT_LENGTH","saltArray","saltBase64New","btoa","fromCharCode","_deriveKeyFromSecret","isWebCryptoAvailable","userSecret","_params$iterations","iterations","DEFAULT_ITERATIONS","encoder","keyMaterial","derivationSalt","getUserSalt","ALGORITHM","KEY_LENGTH","_getUserMasterKey","isInitialized","getExportKey","MASTER_INFO","_generateEntryKey","generateKey","_exportRawKey","raw","_wrapEntryKey","entryKey","masterKey","wrapped","encrypt","exportRawKey","_encryptPerUser","getUserMasterKey","generateEntryKey","IV_LENGTH","encryptedData","wrapEntryKey","encryptedArray","encryptedBase64","_toConsumableArray","ivBase64","wrapIvBase64","wrappedBase64","encryptedContent","wrappedKey","_decryptContent","map","char","ivArray","deriveKeyFromSecret","decryptedData","decrypt","decryptedContent","TextDecoder","decode","_verifyUserSecret","decryptContent","_x14","_clearEncryptionData","KEY_DERIVATION_PARAMS_KEY","charset","randomBytes","byte","_testEncryption","testContent","testSecret","encrypted","encryptContent","clientEncryption","HiddenModeContext","HiddenModeProvider","isHiddenMode","setIsHiddenMode","isSetupRequired","setIsSetupRequired","isUnlocked","setIsUnlocked","setUserSecret","sessionTimeoutMinutes","setSessionTimeoutMinutes","sessionEndTime","setSessionEndTime","sessionTimer","setSessionTimer","HIDDEN_MODE_SETUP_KEY","VERIFICATION_DATA_KEY","SESSION_TIMEOUT_KEY","checkSetupStatus","useCallback","setupCompleted","verificationData","storedTimeout","parseInt","setupHiddenMode","secret","testEncryption","startSessionTimer","unlockHiddenMode","verificationDataJson","lockHiddenMode","clearTimeout","clearHiddenMode","clearEncryptionData","endTime","timer","setTimeout","extendSession","getRemainingSessionTime","floor","setSessionTimeoutWithPersistence","minutes","toString","_ref8","setSessionTimeout","useHiddenMode","pressed","dateContainer","date","time","audioIndicator","lineHeight","tagsContainer","flexWrap","tagText","moreTagsIndicator","moreTagsText","accentLine","bottom","left","right","borderBottomLeftRadius","borderBottomRightRadius","entry","isPressed","setIsPressed","formattedDate","format","parseISO","formattedTime","animatedStyle","Pressable","numberOfLines","maxLength","getPreviewText","slice","index","_tag$id","secretTagIndicator","secretTagText","_ref$showSecretTagInd","showSecretTagIndicator","_ref$secretTagText","TIME_GREETINGS","morning","afternoon","evening","nightOwl","TimePeriod","getCurrentTimePeriod","hour","getHours","MORNING","AFTERNOON","EVENING","NIGHT_OWL","getDynamicGreeting","userName","timePeriod","timeGreetings","mainIndex","arrayLength","seed","toDateString","abs","getRotationIndex","mainGreeting","greetingContainer","greetingCard","greetingContent","greeting","statsContainer","gap","statCard","streakCard","statIcon","statValue","streakValue","weekValue","statLabel","sectionHeader","sectionTitle","seeAllText","emptyContainer","emptyText","startButton","startButtonText","vibeContainer","vibeTitle","vibeButtonsContainer","vibeButton","vibeIcon","vibeLabel","recentEntries","setRecentEntries","totalEntries","currentStreak","entriesThisWeek","stats","setStats","refreshing","setRefreshing","greetingData","useMemo","full_name","displayedEntries","useFocusEffect","React","fetchData","ids","uniqueIds","displayedIds","uniqueDisplayedIds","statsResponse","total_entries","current_streak","entries_this_week","entriesResponse","sort","Alert","alert","handleVibePress","vibeId","prompt","grateful","reflect","inspired","stressed","plan","vibeEmoji","vibeTag","prefilledPrompt","ScreenHeader","refreshControl","RefreshControl","onRefresh","tintColor","JournalCard","entryId","SkeletonLoader","_ref$width","_ref$height","_ref$borderRadius","_ref$animated","animated","animatedValue","animation","JournalCardSkeleton","journalCardSkeleton","journalCardHeader","journalCardFooter","CalendarSkeleton","calendarSkeleton","calendarHeader","calendarGrid","_","margin","SettingsSkeleton","settingsSkeleton","settingsRow","settingsRowLeft","settingsRowText","Dimensions","HIDDEN_ENTRY_TAG","searchContainer","searchBar","searchIcon","searchInput","tagChip","tagChipSelected","tagTextSelected","loaderContainer","skeletonContainer","emptySubtext","listContent","monthSection","monthTitle","safeBottomPadding","scrollToTopButton","zIndex","setEntries","filteredEntries","setFilteredEntries","isRefreshing","setIsRefreshing","searchQuery","setSearchQuery","availableTags","setAvailableTags","selectedTags","setSelectedTags","scrollViewRef","scrollPosition","offset","shouldRestoreScroll","saveScrollPosition","fetchEntries","fetchTags","restoreScrollPosition","_scrollViewRef$curren","scrollTo","y","filterEntries","processedEntries","every","selectedTagName","tagObject","showScrollToTop","setShowScrollToTop","handleScroll","event","contentOffset","nativeEvent","scrollToTop","horizontal","showsHorizontalScrollIndicator","t","concat","toggleTag","onScroll","_Fragment","grouped","monthYear","push","getSectionData","section","sectionIndex","entryIndex","handleEntryPress","OpaqueError","_Error","cause","_callSuper","setPrototypeOf","prototype","_inherits","stack","_wrapNativeSuper","AuthenticationError","_OpaqueError","NetworkError","_OpaqueError2","statusCode","_this3","_OpaqueError3","InitializationError","_this4","_OpaqueError4","MemoryError","_this5","_OpaqueError5","KeyDerivationError","_this6","_OpaqueError6","SerializationError","_this7","SecureMemory","sensitiveData","OpaqueClient","ensureInitialized","clientState","registrationUpload","credentialRequest","credentialResponse","credentialFinalization","_deriveVaultKeys","secretPhrase","tagId","blake2s","dataKey","hkdf","vaultId","bytesToHex","clearAll","_blake2s","outputLength","digest","_hkdf","infoBuffer","_x15","_x16","b","padStart","voicePhraseDetector","VoicePhraseDetector","activeSessions","sessionTimeouts","SESSION_TIMEOUT_MS","MAX_AUTHENTICATION_TIME_MS","PHRASE_NORMALIZATION_REGEX","opaqueClient","_checkForSecretPhrase","transcribedText","found","normalizedPhrase","normalizePhrase","isPanicPhrase","handlePanicMode","action","authResult","authenticateWithOPAQUE","isSessionActive","createSession","deactivateSession","_authenticateWithOPAQUE","phrase","getAvailableSecretTags","authenticate","deriveVaultKey","elapsedTime","_getAvailableSecretTags","_createSession","sessionData","createdAt","expiresAt","timeoutId","_deactivateSession","session","_handlePanicMode","tagIds","clearMemory","panic","_cleanup","_Dimensions$get","isDesktop","calendarMaxWidth","calendarPadding","availableWidth","dayCellSize","min","maxWidth","monthText","calendar","weekDays","weekDayText","daysContainer","dayContainer","selectedDayContainer","dayText","selectedDayText","entryIndicator","selectedEntryIndicator","selectedDateContainer","selectedDateText","addButton","entriesContainer","createButton","createButtonText","entriesListContainer","currentMonth","setCurrentMonth","selectedDate","setSelectedDate","allEntries","setAllEntries","filteredEntriesForSelectedDate","setFilteredEntriesForSelectedDate","hasActiveSecretTags","setHasActiveSecretTags","checkActiveSecretTags","getActiveSessions","interval","setInterval","clearInterval","visibleEntries","fetchEntriesForSelectedDate","allEntriesResponse","include_public","start_date","end_date","handleCreateEntry","renderDay","day","dayString","hasEntriesOnDay","entryDate","getFullYear","getMonth","getDate","isSelected","isSameDay","previousMonth","setMonth","nextMonth","startOfMonth","end","endOfMonth","eachDayOfInterval","getDaysInMonth","FlatList","renderItem","item","keyExtractor","scrollEnabled","nestedScrollEnabled","NotificationService","dailyReminderScheduled","_requestPermissions","canAskAgain","_scheduleDailyReminder","_settings$dailyRemind","Number","_settings$dailyRemind2","hours","isNaN","_cancelDailyReminder","_updateNotificationSettings","scheduleDailyReminder","cancelDailyReminder","_isConfigured","_getPermissionStatus","_showTestNotification","SettingsContext","SettingsProvider","setSettings","setError","initializeSettings","loadedSettings","subscribe","updatedSettings","updateSetting","notificationService","updateNotificationSettings","resetToDefaults","exportSettings","importSettings","contextValue","getSetting","useSettings","containerDisabled","containerNonInteractive","leftSection","iconContainer","textContainer","titleDisabled","subtitle","subtitleDisabled","rightSection","chevronContainer","leftIcon","leftIconColor","rightElement","_ref$showChevron","showChevron","isInteractive","selection","accessibilityRole","accessibilityLabel","accessibilityHint","onValueChange","switchElement","Switch","trackColor","false","true","thumbColor","ios_backgroundColor","accessibilityState","checked","SettingsRow","rightContainer","selectedText","selectedTextDisabled","placeholderText","fontStyle","modalContainer","modalHeader","headerLeft","modalTitle","headerButton","doneButtonText","optionsList","optionItem","selectedOptionItem","optionItemDisabled","optionContent","optionLabel","selectedOptionLabel","optionLabelDisabled","optionSubtitle","optionSubtitleDisabled","options","selectedValue","_ref$placeholder","isModalVisible","setIsModalVisible","selectedOption","find","option","displayText","label","presentationStyle","selected","bounces","headerTouchable","headerIcon","titleContainer","headerAction","childrenContainer","_ref$initiallyExpande","collapsible","initiallyExpanded","centerContent","headerTitle","headerSpacer","profileBadge","profileBadgeText","statusText","timeText","versionText","bottomSpacing","scrollToTopButtonInner","_user$email","_useAppTheme","_useSettings","scrollToTopOpacity","languageOptions","handleSignOut","window","confirm","shouldShow","SettingsSection","charAt","SettingsSelector","SettingsToggle","pointerEvents","Tab","createBottomTabNavigator","getNavigatorStyles","tabBarStyle","tabBarLabelStyle","tabBarItemStyle","fabContainer","prewarmAudio","audioPrewarmService","metrics","getPerformanceMetrics","cleanup","handleRecordPress","catch","route","tabBarActiveTintColor","tabBarInactiveTintColor","tabBarIcon","iconName","focused","HomeScreen","tabBarLabel","JournalScreen","CalendarScreen","SettingsScreen","FloatingActionButton","FEATURE_FLAGS","ENABLE_SECRET_TAGS","ENABLE_OFFLINE_SECRET_TAGS","ENABLE_SECRET_TAG_CACHING","ENABLE_SECURITY_MODE_SWITCHING","ENABLE_BORDER_CROSSING_MODE","ENABLE_TEAM_COLLABORATION","ENABLE_CLOUD_BACKUP","DEV_FEATURE_OVERRIDES","getFeatureFlag","areSecretTagsEnabled","SpeechToTextService","maxRetries","retryDelay","_transcribeAudio","audioFilePath","languageCodes","_options$maxAlternati","maxAlternatives","_options$enableSecret","enableWordConfidence","enableSecretTagDetection","_validateLanguageCodes","_performTranscription","initialError","_initialError$respons","_retryWithTokenRefresh","_createTranscriptionError","audioPath","invalidCodes","_performTranscription2","_response$data$transc","formData","_createFormData","append","axiosInstance","transcript","_processTranscriptionResponse","_createFormData2","fetch","blob","fileName","File","_uri$split$pop","fileInfo","uri","fileExtension","pop","fileType","_getAudioMimeType","extension","_processTranscriptionResponse2","_data$quality_metrics","_data$quality_metrics2","_data$quality_metrics3","_processedResult$secr","processedResult","detected_language_code","confidence","alternatives","word_confidence","language_confidence","quality_metrics","average_confidence","low_confidence_words","total_words","tagDetection","checkForSecretPhrase","secret_tag_detected","_handleOpaqueTagDetection","reason","toFixed","_handleOpaqueTagDetection2","detection","_retryWithTokenRefresh2","refreshResponse","errorType","_error$response$data","details","_result$secret_tag_de","overall","lowConfidenceRatio","recommendations","DEFAULT_OPTIONS","quality","autoStart","filePrefix","requestPermissionOnMount","maxDuration","RECORDING_DIR","mergedOptions","recording","setRecording","isRecording","setIsRecording","recordingDuration","setRecordingDuration","audioUri","setAudioUri","permissionGranted","setPermissionGranted","timerRef","startTimeRef","recordingInstanceRef","isRequestingPermissionRef","autoStartAttemptedRef","stopAndUnloadAsync","requestPermissionsAndSetupAudioMode","_yield$Audio$requestP","permissionError","ensureRecordingDirExists","stopRecording","finalDuration","getURI","startRecording","qualityPreset","web","mimeType","newRecording","createAsync","currentTime","elapsed","didCancel","managePermissionsAndAutoStart","cleanupRecordingFile","deleteAsync","onOpen","onMessage","onInterimTranscript","onFinalTranscript","onTranscriptionError","onStatusUpdate","ws","wsStatus","setWsStatus","authToken","setAuthToken","then","onclose","onerror","onmessage","onopen","close","connect","_Constants$expoConfig","_Constants$expoConfig2","readyState","WebSocket","OPEN","wsUrl","expoConfig","extra","apiUrl","socket","send","language_code","errorEvent","disconnect","sendMessage","payload","useAudioRecorderLogic","onTranscriptionComplete","onCancel","_ref$autoStart","onAutoSave","transcriptSegments","setTranscriptSegments","currentSegmentTranscript","setCurrentSegmentTranscript","isTranscribingSegment","setIsTranscribingSegment","lastTranscriptionResult","setLastTranscriptionResult","showAlternatives","setShowAlternatives","selectedLanguage","setSelectedLanguage","waveAnim1","waveAnim2","_useAudioRecording","useAudioRecording","recordingError","isProcessing","setIsProcessing","processedUris","setProcessedUris","_useState17","_useState18","hasTranscribedAudio","setHasTranscribedAudio","isMountedRef","callbackCalledRef","stagger","stopAnimation","setValue","handleWebSocketError","handleInterimTranscript","prev","handleFinalTranscript","detectedLanguage","_useWebSocketTranscri","useWebSocketTranscription","disconnectWebSocket","setMode","handleDone","handleAcceptTranscript","fullTranscript","processSegment","_result$transcript","speechToTextService","transcribeAudio","qualityAssessment","getQualityAssessment","isSecretTagCommand","secretTagDetected","normalize","normalizedTranscript","isExactMatch","shouldTreatAsSecretTagCommand","capitalizedTranscript","newSegments","newTranscript","cleanupError","handleMicPress","heavy","canAcceptTranscript","handleLanguageChange","formatDuration","seconds","sanitizeText","SCREEN_HEIGHT","BottomSheet","_ref$snapPoints","snapPoints","_ref$initialSnapPoint","initialSnapPoint","_ref$enablePanGesture","enablePanGesture","_ref$backdropOpacity","backdropOpacity","translateY","backdropOpacity_","lastGestureY","currentSnapIndex","gestureTranslateY","snapPointsInPixels","point","useImperativeHandle","snapTo","onGestureEvent","translationY","onHandlerStateChange","oldState","State","ACTIVE","_event$nativeEvent","velocityY","currentY","targetSnapIndex","minDistance","Infinity","distance","combinedTranslateY","TouchableWithoutFeedback","backdrop","PanGestureHandler","bottomSheet","handle","absoluteFillObject","borderTopLeftRadius","borderTopRightRadius","maxHeight","selector","selectorDisabled","selectorContent","selectorLabel","selectorText","selectorTextDisabled","modalContent","modalSubtitle","searchInputWrapper","resultsCount","languageList","languageItem","selectedLanguageItem","languageInfo","languageName","selectedLanguageName","selectedLanguageCode","checkmarkContainer","emptyState","emptyStateText","emptyStateSubtext","onLanguageChange","modalVisible","setModalVisible","language","langPart","match","getLanguageName","filteredLanguages","returnKeyType","ListEmptyComponent","getItemLayout","initialNumToRender","maxToRenderPerBatch","windowSize","WaveformVisualization","waveformBars","animValue","random","topBar","topRightIcons","timerTextTopLeft","languageButton","lockButton","recordingButtonContainer","spacer","recordingButtonOuter","recordingButton","recordingButtonInner","stopIcon","recordingStatusText","transcriptCard","transcriptHeader","transcriptLabelContainer","transcriptLabel","saveButtonSmall","saveButtonSmallDisabled","saveButtonSmallText","transcriptTextInput","textAlignVertical","transcriptionContainer","transcriptionInput","transcriptionScroll","transcriptionContent","transcriptionText","alternativesScroll","transcriptionLoader","alternativesContainer","alternativesTitle","alternativeItem","alternativeText","alternativeConfidence","modalOverlay","modalCloseButton","saveButtonState","existingContent","onSaveWithCompleteText","isLanguageModalVisible","setLanguageModalVisible","pulseAnimRef","pulseAnimation","editedText","setEditedText","hasUserEdited","setHasUserEdited","effectiveSaveButtonState","isSaving","handleSavePress","textToSave","saveParts","currentTranscript","displayParts","getDisplayText","multiline","editable","alternative","round","LanguageSelector","cleanupAudioFile","onSave","onManualSave","onStateChange","onCommandDetected","_ref$isEditingInitial","isEditingInitialContent","_ref$startRecordingOn","startRecordingOnMount","logic","secret_tag_details","analyzeTranscriptionQuality","handleManualSave","AudioRecorderUI","SecretTagFloatingIndicator","activeTags","primaryTag","floatingContainer","floatingIndicator","colorCode","floatingBadge","floatingBadgeText","indicator","colorDot","compactContainer","compactIndicator","multipleTagsBadge","top","minWidth","multipleTagsText","ZeroKnowledgeEncryption","phraseKeys","deviceEntropy","_getSecureItem","SecureStore","getItemAsync","_setSecureItem","setItemAsync","_deleteSecureItem","deleteItemAsync","_isSecureStorageAvailable","isAvailableAsync","_getDeviceEntropy","storedEntropy","getSecureItem","DEVICE_INFO","base64ToArray","setSecureItem","arrayToBase64","requireAuthentication","authenticationPrompt","_initializePhraseKey","getDeviceEntropy","phraseBytes","combinedKeyMaterial","phraseSalt","phraseKey","phraseKeyInfo","savePhraseKeyInfo","_loadPhraseKey","getPhraseKeyInfo","_encryptEntryWithSecretPhrase","encryptWithKey","_decryptEntryWithSecretPhrase","encryptedEntry","decryptWithKey","_clearSecretPhraseEncryption","deletePhraseKeyInfo","_secureClearAllData","deleteSecureItem","PHRASE_KEYS_INFO","_encryptWithKey","entrySalt","wrapKey","encryptedKey","_decryptWithKey","decryptionKey","unwrapKey","_x17","_x18","_savePhraseKeyInfo","existingKeysStr","filteredKeys","_x19","_getPhraseKeyInfo","keysStr","_x20","_deletePhraseKeyInfo","_x21","array","base64","zeroKnowledgeEncryption","tagManager","LegacyTagManager","_getAllTags","newTag","updatedTag","_getTagById","getAllTags","_getTagsByIds","_getActiveSecretTags","_checkForSecretTagPhrases","_getSecretTags","_activateSecretTag","encryptedJournalService","EncryptedJournalService","_detectAndProcessSecretPhrase","existingTagId","processedContent","detectedTagId","checkForSecretTagPhrases","activateSecretTag","cleanedContent","phraseRegex","RegExp","_createEntry","entryData","secretTagId","forcePublic","optionDetectedTagId","detectAndProcessSecretPhrase","manuallyDetectedTagId","finalEntryData","targetSecretTagId","isPhraseKeyLoaded","createSecretTagEntry","createPublicEntry","createPerUserEncryptedEntry","_createPublicEntry","_createPerUserEncryptedEntry","enc","encryptPerUser","_createSecretTagEntry","encryptEntryWithSecretPhrase","targetTag","getActiveSecretTags","getSecretTags","_createSecretTagEntryUnencrypted","_getEntries","activeTagHashes","secret_tag_hashes","processEntries","_getEntry","_processEntries","activeTagIds","all","decryptSecretTagEntry","_decryptSecretTagEntry","decryptEntryWithSecretPhrase","_searchEntries","_updateEntry","_yield$this$detectAnd","encryptedUpdatePayload","_deleteEntry","onSaveComplete","onSaveError","journalId","setJournalId","setIsSaving","isMounted","isNavigatingRef","currentDataRef","performSave","currentData","audioUrl","_selectedDate$split$m","_selectedDate$split$m2","year","month","UTC","newEntry","newId","save","dataOverride","_ref3$silent","silent","_ref3$navigateOnSucce","navigateOnSuccess","savedId","finalData","contentContainer","recorderContainer","modalHandle","recorderContent","savingOverlay","_route$params","_route$params2","_route$params3","_route$params4","useRoute","showRecorder","hasStartedSaving","setHasStartedSaving","setActiveTags","setTitle","setContent","originalContent","setOriginalContent","setTags","_useState19","_useState20","_useState21","_useState22","setIsLoadingExistingEntry","loadExistingEntry","_entry$tags","entryContent","mountedRef","_useJournalEntry","useJournalEntry","currentTags","canGoBack","goBack","loadActiveTags","activeTagsList","handleTranscriptionComplete","finalTranscript","finalAudioUri","finalContent","finalTitle","words","baseTitle","handleSaveWithCompleteText","completeText","handleRecorderCancel","handleClose","handleAutoSave","newTitle","saveData","getSaveButtonState","handleCommandDetected","hitSlop","AudioRecorder","indicatorGroup","indicatorText","sessionToggle","_ref$showSession","showSession","_ref$showSecurityLeve","showSecurityLevel","onSessionToggle","securityInfo","security_level","getSecurityLevelInfo","authInfo","auth_method","getAuthMethodInfo","device_fingerprint","migrated_from","description","warningContainer","warningHeader","warningTitle","warningText","warningTextBold","warningTips","warningTipTitle","warningTip","warningTipItem","warningBullet","successIcon","successTitle","successDetails","successLabel","successValue","successInstructions","successInstructionText","continueButton","continueButtonText","opaqueIndicatorContainer","securityNotice","borderLeftWidth","borderLeftColor","securityNoticeIcon","securityNoticeText","securityNoticeTextBold","authMethodContainer","authMethodTitle","authMethodOption","authMethodInfo","authMethodLabel","authMethodDescription","securityLevelContainer","securityLevelTitle","securityLevelDescription","securityInfoBox","securityInfoText","inputValid","inputError","validationContainer","validationSuccess","validationError","validationText","validationTextSuccess","validationTextError","colorGrid","colorOption","selectedColorOption","buttonContainer","cancelButton","cancelButtonText","onTagCreated","_ref$existingTagNames","existingTagNames","_ref$enableOpaqueAuth","enableOpaqueAuth","setTagName","activationPhrase","setActivationPhrase","confirmationPhrase","setConfirmationPhrase","selectedColor","setSelectedColor","useOpaqueAuth","securityLevel","setShowConfirmation","justCreated","setJustCreated","validateTagName","existing","validatePhrase","validateConfirmation","confirmation","handleCreateTag","nameError","phraseError","confirmError","_registrationRequest3","_registrationRequest4","_registrationRequest5","_registrationRecord3","phraseLength","secretTagIdentifier","_registrationRequest","_registrationRequest2","registrationRequestType","registrationRequestSample","registrationRequestFull","requestData","tag_name","opaque_registration_request_length","opaque_registration_request_type","opaque_registration_request_sample","_response$data","tag_handle","_registrationRecord","_registrationRecord2","registrationRecordType","registrationRecordFull","registrationRequestValue","registrationRecordValue","validateBase64","urlSafeDecoded","paddedData","testDecode","serverResponse","secretTag","tag_id","createdTag","color_code","user_id","authentication_count","isOpaque","_response$data2","_response$data3","OpaqueTagIndicator","previewContainer","tagPreview","tagColorIndicator","tagPreviewText","canCreate","autoFocus","activeContainer","tagInfo","colorIndicator","tagDetails","tagDate","statusBadge","activeStatusBadge","activeStatusText","actions","actionButton","toggleButton","activeToggleButton","editButton","deleteButton","actionButtonText","activeActionButtonText","secondaryActionButtonText","activeInfo","activeInfoText","inactiveInfo","inactiveInfoText","dateString","isActive","onActivate","onDeactivate","onEdit","onDelete","handleToggleActivation","handleDeleteConfirmed","toLocaleDateString","tabContainer","tab","activeTab","tabText","activeTabText","regularTagCard","tagDeleteButton","fab","regularTags","setRegularTags","secretTags","setSecretTags","activeSecretTags","setActiveSecretTags","showSecretTagSetup","setShowSecretTagSetup","showRegularTagCreate","setShowRegularTagCreate","selectedTab","setSelectedTab","loadSecretTags","tagsData","loadTags","handleRefresh","handleRegularTagCreate","handleRegularTagCreated","handleRegularTagCreateCancelled","handleSecretTagActivate","credentials","body","ok","handleSecretTagDeactivate","newSet","handleSecretTagEdit","handleSecretTagDelete","handleSecretTagCreated","handleFABPress","renderRegularTag","_onPress","renderSecretTag","SecretTagCard","RegularTagCreate","SecretTagSetup","SESSION_METADATA","DEVICE_FINGERPRINT","LAST_APP_STATE","AsyncStorageAdapter","_store","serialized","_retrieve","_remove","_clear","sessionStorageManager","SessionStorageManager","deviceFingerprint","isAppInBackground","lastBackgroundTime","storageAdapter","setupAppStateHandling","initializeDeviceFingerprint","cleanupExpiredSessions","_storeSessionMetadata","sessions","persistenceData","isLocked","lastAccessed","accessCount","origin","store","_retrieveSessionMetadata","requireReauth","maxAge","allowPartialRecovery","retrieve","cutoffTime","getTime","validSessions","sessionMetadata","_removeSessionMetadata","filteredSessions","retrieveSessionMetadata","storeSessionMetadata","_clearSessionMetadata","wasBackgrounded","_initializeDeviceFingerprint","stored","generateDeviceFingerprint","_generateDeviceFingerprint","platform","Version","screenDimensions","userAgent","timezone","Intl","DateTimeFormat","resolvedOptions","timeZone","locale","navigator","fingerprintData","hashFingerprint","_hashFingerprint","jsonString","AppState","addEventListener","nextAppState","backgroundDuration","_cleanupExpiredSessions","_clearAll","opaqueTagManager","OpaqueTagManager","analyticsEvents","defaultSettings","enableDeviceBinding","requirePhraseConfirmation","sessionTimeout","maxSessionExtensions","enableAnalytics","loadAnalyticsEvents","_createOpaqueTag","getDeviceFingerprint","validateTagCreationRequest","generateTagId","opaqueTag","opaque_server_public_key","last_authentication","storeOpaqueTag","session_key","vault_key","expires_at","recordAnalyticsEvent","metadata","authMethod","session_data","operation","_authenticateOpaqueTag","getOpaqueTag","updateOpaqueTag","authenticationCount","_migrateToOpaque","legacyTag","newActivationPhrase","migrationRequest","activation_phrase","createOpaqueTag","legacyTagId","migrationDate","canMigrate","estimatedTime","securityBenefits","risks","requiresReAuth","_getOpaqueTags","getOpaqueTags","_getActiveTags","_sessionStorageManage","_activateTag","_deactivateTag","deleteOpaqueTag","_deleteOpaqueTag","removeOpaqueTag","substr","_createInitialSession","_storeOpaqueTag","_getOpaqueTag","_updateOpaqueTag","_removeOpaqueTag","_recordAnalyticsEvent","_loadAnalyticsEvents","warningMessage","secretTagWarning","warningSubtext","confirmationContainer","confirmationLabel","confirmationInput","deleteButtonText","tagType","isDeleting","setIsDeleting","confirmationText","setConfirmationText","showConfirmationInput","setShowConfirmationInput","isSecretTag","requiresConfirmation","confirmationRequired","handleDelete","canDelete","scrollView","tagButton","tagButtonSelected","tagButtonDisabled","tagContent","tagHeader","tagIcon","tagNameSelected","tagNameDisabled","tagMeta","tagMetaSelected","tagMetaDisabled","onTagSelect","_ref$maxTags","maxTags","recentTags","setRecentTags","loadRecentTags","formatLastUsed","lastUsed","diffInDays","selectedTag","isDisabled","tagToAdd","handleTagPress","last_used","usage_count","tagsScrollView","tagRemoveButton","suggestionsContainer","suggestionsTitle","suggestionsContent","suggestionChip","suggestionText","helpText","counterContainer","counterText","onChangeTags","_ref$suggestions","suggestions","inputValue","setInputValue","showSuggestions","setShowSuggestions","filteredSuggestions","setFilteredSuggestions","inputRef","fadeAnim","memoizedSuggestions","currentTagNames","filtered","suggestion","handleAddTag","newTagName","_inputRef$current","focus","handleRemoveTag","indexToRemove","updatedTags","RecentTagsSelector","onSubmitEditing","onKeyPress","preventDefault","onFocus","onBlur","handleSuggestionPress","loadingContent","errorContent","errorTitle","errorButton","errorButtonText","floatingHeader","headerBackButton","floatingHeaderTitle","mainHeader","headerActions","headerActionButton","deleteHeaderButton","heroSection","dateText","fullDateText","timeContainer","audioText","entrySection","entryHeader","entryHeaderText","entryTitle","entryText","tagsSection","tagsHeader","tagsHeaderText","tagCount","tagCountText","tagsList","statsSection","statsTitle","statsGrid","statItem","floatingActions","editFab","deleteFab","editModeIndicator","titleSection","titleInput","contentSection","contentInput","recordSection","recordButton","recordButtonText","_entry$tags2","setEntry","isEditMode","setIsEditMode","editTitle","setEditTitle","editContent","setEditContent","editTags","setEditTags","slideAnim","scrollY","titleInputRef","contentInputRef","headerOpacity","extrapolate","headerScale","fetchEntryDetails","handleToggleEdit","handleSaveChanges","updateData","updatedEntry","handleBack","isToday","isYesterday","_titleInputRef$curren","_contentInputRef$curr","blur","TagInput","word","formGroup","textArea","dateDisplayContainer","dateControlsContainer","dateControls","controlButton","controlLabel","switchContainer","saveButton","saveButtonText","reminderId","note","setNote","reminderDate","setReminderDate","isEnabled","setIsEnabled","isFetchingReminder","setIsFetchingReminder","fetchReminderData","reminder","reminder_time","is_active","handleSave","reminderData","prevDate","addDays","addHours","handleConfirmDelete","MainTabNavigator","RecordScreen","presentation","TagManagementScreen","TagDeleteConfirmationScreen","JournalEntryDetailScreen","ReminderFormScreen","headerStyle","headerTintColor","DeleteConfirmationScreen","userExists","MainNavigator","AuthNavigator","ErrorBoundary","_React$Component","hasError","errorInfo","_this$state$error","errorHint","LogBox","ignoreLogs","AppContent","setIsInitialized","initializeApp","statusBarStyle","initialStyles","SafeAreaProvider","NavigationContainer","fallback","Navigation","StatusBar","App","GestureHandlerRootView","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","loaded","__webpack_modules__","call","m","deferred","O","chunkIds","fn","priority","notFulfilled","fulfilled","j","splice","r","n","getter","__esModule","d","a","leafPrototypes","getProto","getPrototypeOf","obj","ns","def","indexOf","getOwnPropertyNames","definition","o","defineProperty","enumerable","g","globalThis","Function","hmd","prop","hasOwnProperty","Symbol","toStringTag","nmd","paths","p","installedChunks","chunkId","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","chunkLoadingGlobal","self","bind","__webpack_exports__"],"sourceRoot":""}